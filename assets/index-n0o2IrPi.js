(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(a){if(a.ep)return;a.ep=!0;const o=r(a);fetch(a.href,o)}})();function cS(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Dg={exports:{}},ff={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iE;function O3(){if(iE)return ff;iE=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function r(n,a,o){var l=null;if(o!==void 0&&(l=""+o),a.key!==void 0&&(l=""+a.key),"key"in a){o={};for(var u in a)u!=="key"&&(o[u]=a[u])}else o=a;return a=o.ref,{$$typeof:t,type:n,key:l,ref:a!==void 0?a:null,props:o}}return ff.Fragment=e,ff.jsx=r,ff.jsxs=r,ff}var sE;function F3(){return sE||(sE=1,Dg.exports=O3()),Dg.exports}var A=F3(),Og={exports:{}},Et={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oE;function P3(){if(oE)return Et;oE=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),v=Symbol.iterator;function _(K){return K===null||typeof K!="object"?null:(K=v&&K[v]||K["@@iterator"],typeof K=="function"?K:null)}var E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,y={};function w(K,pe,V){this.props=K,this.context=pe,this.refs=y,this.updater=V||E}w.prototype.isReactComponent={},w.prototype.setState=function(K,pe){if(typeof K!="object"&&typeof K!="function"&&K!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,K,pe,"setState")},w.prototype.forceUpdate=function(K){this.updater.enqueueForceUpdate(this,K,"forceUpdate")};function P(){}P.prototype=w.prototype;function B(K,pe,V){this.props=K,this.context=pe,this.refs=y,this.updater=V||E}var N=B.prototype=new P;N.constructor=B,S(N,w.prototype),N.isPureReactComponent=!0;var z=Array.isArray,q={H:null,A:null,T:null,S:null,V:null},Z=Object.prototype.hasOwnProperty;function C(K,pe,V,X,ee,te){return V=te.ref,{$$typeof:t,type:K,key:pe,ref:V!==void 0?V:null,props:te}}function I(K,pe){return C(K.type,pe,void 0,void 0,void 0,K.props)}function b(K){return typeof K=="object"&&K!==null&&K.$$typeof===t}function O(K){var pe={"=":"=0",":":"=2"};return"$"+K.replace(/[=:]/g,function(V){return pe[V]})}var L=/\/+/g;function M(K,pe){return typeof K=="object"&&K!==null&&K.key!=null?O(""+K.key):pe.toString(36)}function D(){}function Ee(K){switch(K.status){case"fulfilled":return K.value;case"rejected":throw K.reason;default:switch(typeof K.status=="string"?K.then(D,D):(K.status="pending",K.then(function(pe){K.status==="pending"&&(K.status="fulfilled",K.value=pe)},function(pe){K.status==="pending"&&(K.status="rejected",K.reason=pe)})),K.status){case"fulfilled":return K.value;case"rejected":throw K.reason}}throw K}function Te(K,pe,V,X,ee){var te=typeof K;(te==="undefined"||te==="boolean")&&(K=null);var le=!1;if(K===null)le=!0;else switch(te){case"bigint":case"string":case"number":le=!0;break;case"object":switch(K.$$typeof){case t:case e:le=!0;break;case p:return le=K._init,Te(le(K._payload),pe,V,X,ee)}}if(le)return ee=ee(K),le=X===""?"."+M(K,0):X,z(ee)?(V="",le!=null&&(V=le.replace(L,"$&/")+"/"),Te(ee,pe,V,"",function(Oe){return Oe})):ee!=null&&(b(ee)&&(ee=I(ee,V+(ee.key==null||K&&K.key===ee.key?"":(""+ee.key).replace(L,"$&/")+"/")+le)),pe.push(ee)),1;le=0;var Ne=X===""?".":X+":";if(z(K))for(var ke=0;ke<K.length;ke++)X=K[ke],te=Ne+M(X,ke),le+=Te(X,pe,V,te,ee);else if(ke=_(K),typeof ke=="function")for(K=ke.call(K),ke=0;!(X=K.next()).done;)X=X.value,te=Ne+M(X,ke++),le+=Te(X,pe,V,te,ee);else if(te==="object"){if(typeof K.then=="function")return Te(Ee(K),pe,V,X,ee);throw pe=String(K),Error("Objects are not valid as a React child (found: "+(pe==="[object Object]"?"object with keys {"+Object.keys(K).join(", ")+"}":pe)+"). If you meant to render a collection of children, use an array instead.")}return le}function ne(K,pe,V){if(K==null)return K;var X=[],ee=0;return Te(K,X,"","",function(te){return pe.call(V,te,ee++)}),X}function ue(K){if(K._status===-1){var pe=K._result;pe=pe(),pe.then(function(V){(K._status===0||K._status===-1)&&(K._status=1,K._result=V)},function(V){(K._status===0||K._status===-1)&&(K._status=2,K._result=V)}),K._status===-1&&(K._status=0,K._result=pe)}if(K._status===1)return K._result.default;throw K._result}var Ue=typeof reportError=="function"?reportError:function(K){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var pe=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof K=="object"&&K!==null&&typeof K.message=="string"?String(K.message):String(K),error:K});if(!window.dispatchEvent(pe))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",K);return}console.error(K)};function ie(){}return Et.Children={map:ne,forEach:function(K,pe,V){ne(K,function(){pe.apply(this,arguments)},V)},count:function(K){var pe=0;return ne(K,function(){pe++}),pe},toArray:function(K){return ne(K,function(pe){return pe})||[]},only:function(K){if(!b(K))throw Error("React.Children.only expected to receive a single React element child.");return K}},Et.Component=w,Et.Fragment=r,Et.Profiler=a,Et.PureComponent=B,Et.StrictMode=n,Et.Suspense=h,Et.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=q,Et.__COMPILER_RUNTIME={__proto__:null,c:function(K){return q.H.useMemoCache(K)}},Et.cache=function(K){return function(){return K.apply(null,arguments)}},Et.cloneElement=function(K,pe,V){if(K==null)throw Error("The argument must be a React element, but you passed "+K+".");var X=S({},K.props),ee=K.key,te=void 0;if(pe!=null)for(le in pe.ref!==void 0&&(te=void 0),pe.key!==void 0&&(ee=""+pe.key),pe)!Z.call(pe,le)||le==="key"||le==="__self"||le==="__source"||le==="ref"&&pe.ref===void 0||(X[le]=pe[le]);var le=arguments.length-2;if(le===1)X.children=V;else if(1<le){for(var Ne=Array(le),ke=0;ke<le;ke++)Ne[ke]=arguments[ke+2];X.children=Ne}return C(K.type,ee,void 0,void 0,te,X)},Et.createContext=function(K){return K={$$typeof:l,_currentValue:K,_currentValue2:K,_threadCount:0,Provider:null,Consumer:null},K.Provider=K,K.Consumer={$$typeof:o,_context:K},K},Et.createElement=function(K,pe,V){var X,ee={},te=null;if(pe!=null)for(X in pe.key!==void 0&&(te=""+pe.key),pe)Z.call(pe,X)&&X!=="key"&&X!=="__self"&&X!=="__source"&&(ee[X]=pe[X]);var le=arguments.length-2;if(le===1)ee.children=V;else if(1<le){for(var Ne=Array(le),ke=0;ke<le;ke++)Ne[ke]=arguments[ke+2];ee.children=Ne}if(K&&K.defaultProps)for(X in le=K.defaultProps,le)ee[X]===void 0&&(ee[X]=le[X]);return C(K,te,void 0,void 0,null,ee)},Et.createRef=function(){return{current:null}},Et.forwardRef=function(K){return{$$typeof:u,render:K}},Et.isValidElement=b,Et.lazy=function(K){return{$$typeof:p,_payload:{_status:-1,_result:K},_init:ue}},Et.memo=function(K,pe){return{$$typeof:d,type:K,compare:pe===void 0?null:pe}},Et.startTransition=function(K){var pe=q.T,V={};q.T=V;try{var X=K(),ee=q.S;ee!==null&&ee(V,X),typeof X=="object"&&X!==null&&typeof X.then=="function"&&X.then(ie,Ue)}catch(te){Ue(te)}finally{q.T=pe}},Et.unstable_useCacheRefresh=function(){return q.H.useCacheRefresh()},Et.use=function(K){return q.H.use(K)},Et.useActionState=function(K,pe,V){return q.H.useActionState(K,pe,V)},Et.useCallback=function(K,pe){return q.H.useCallback(K,pe)},Et.useContext=function(K){return q.H.useContext(K)},Et.useDebugValue=function(){},Et.useDeferredValue=function(K,pe){return q.H.useDeferredValue(K,pe)},Et.useEffect=function(K,pe,V){var X=q.H;if(typeof V=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return X.useEffect(K,pe)},Et.useId=function(){return q.H.useId()},Et.useImperativeHandle=function(K,pe,V){return q.H.useImperativeHandle(K,pe,V)},Et.useInsertionEffect=function(K,pe){return q.H.useInsertionEffect(K,pe)},Et.useLayoutEffect=function(K,pe){return q.H.useLayoutEffect(K,pe)},Et.useMemo=function(K,pe){return q.H.useMemo(K,pe)},Et.useOptimistic=function(K,pe){return q.H.useOptimistic(K,pe)},Et.useReducer=function(K,pe,V){return q.H.useReducer(K,pe,V)},Et.useRef=function(K){return q.H.useRef(K)},Et.useState=function(K){return q.H.useState(K)},Et.useSyncExternalStore=function(K,pe,V){return q.H.useSyncExternalStore(K,pe,V)},Et.useTransition=function(){return q.H.useTransition()},Et.version="19.1.0",Et}var lE;function sx(){return lE||(lE=1,Og.exports=P3()),Og.exports}var Qe=sx();const M3=cS(Qe);var Fg={exports:{}},hf={},Pg={exports:{}},Mg={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cE;function L3(){return cE||(cE=1,function(t){function e(ne,ue){var Ue=ne.length;ne.push(ue);e:for(;0<Ue;){var ie=Ue-1>>>1,K=ne[ie];if(0<a(K,ue))ne[ie]=ue,ne[Ue]=K,Ue=ie;else break e}}function r(ne){return ne.length===0?null:ne[0]}function n(ne){if(ne.length===0)return null;var ue=ne[0],Ue=ne.pop();if(Ue!==ue){ne[0]=Ue;e:for(var ie=0,K=ne.length,pe=K>>>1;ie<pe;){var V=2*(ie+1)-1,X=ne[V],ee=V+1,te=ne[ee];if(0>a(X,Ue))ee<K&&0>a(te,X)?(ne[ie]=te,ne[ee]=Ue,ie=ee):(ne[ie]=X,ne[V]=Ue,ie=V);else if(ee<K&&0>a(te,Ue))ne[ie]=te,ne[ee]=Ue,ie=ee;else break e}}return ue}function a(ne,ue){var Ue=ne.sortIndex-ue.sortIndex;return Ue!==0?Ue:ne.id-ue.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var l=Date,u=l.now();t.unstable_now=function(){return l.now()-u}}var h=[],d=[],p=1,v=null,_=3,E=!1,S=!1,y=!1,w=!1,P=typeof setTimeout=="function"?setTimeout:null,B=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;function z(ne){for(var ue=r(d);ue!==null;){if(ue.callback===null)n(d);else if(ue.startTime<=ne)n(d),ue.sortIndex=ue.expirationTime,e(h,ue);else break;ue=r(d)}}function q(ne){if(y=!1,z(ne),!S)if(r(h)!==null)S=!0,Z||(Z=!0,M());else{var ue=r(d);ue!==null&&Te(q,ue.startTime-ne)}}var Z=!1,C=-1,I=5,b=-1;function O(){return w?!0:!(t.unstable_now()-b<I)}function L(){if(w=!1,Z){var ne=t.unstable_now();b=ne;var ue=!0;try{e:{S=!1,y&&(y=!1,B(C),C=-1),E=!0;var Ue=_;try{t:{for(z(ne),v=r(h);v!==null&&!(v.expirationTime>ne&&O());){var ie=v.callback;if(typeof ie=="function"){v.callback=null,_=v.priorityLevel;var K=ie(v.expirationTime<=ne);if(ne=t.unstable_now(),typeof K=="function"){v.callback=K,z(ne),ue=!0;break t}v===r(h)&&n(h),z(ne)}else n(h);v=r(h)}if(v!==null)ue=!0;else{var pe=r(d);pe!==null&&Te(q,pe.startTime-ne),ue=!1}}break e}finally{v=null,_=Ue,E=!1}ue=void 0}}finally{ue?M():Z=!1}}}var M;if(typeof N=="function")M=function(){N(L)};else if(typeof MessageChannel<"u"){var D=new MessageChannel,Ee=D.port2;D.port1.onmessage=L,M=function(){Ee.postMessage(null)}}else M=function(){P(L,0)};function Te(ne,ue){C=P(function(){ne(t.unstable_now())},ue)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ne){ne.callback=null},t.unstable_forceFrameRate=function(ne){0>ne||125<ne?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<ne?Math.floor(1e3/ne):5},t.unstable_getCurrentPriorityLevel=function(){return _},t.unstable_next=function(ne){switch(_){case 1:case 2:case 3:var ue=3;break;default:ue=_}var Ue=_;_=ue;try{return ne()}finally{_=Ue}},t.unstable_requestPaint=function(){w=!0},t.unstable_runWithPriority=function(ne,ue){switch(ne){case 1:case 2:case 3:case 4:case 5:break;default:ne=3}var Ue=_;_=ne;try{return ue()}finally{_=Ue}},t.unstable_scheduleCallback=function(ne,ue,Ue){var ie=t.unstable_now();switch(typeof Ue=="object"&&Ue!==null?(Ue=Ue.delay,Ue=typeof Ue=="number"&&0<Ue?ie+Ue:ie):Ue=ie,ne){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=Ue+K,ne={id:p++,callback:ue,priorityLevel:ne,startTime:Ue,expirationTime:K,sortIndex:-1},Ue>ie?(ne.sortIndex=Ue,e(d,ne),r(h)===null&&ne===r(d)&&(y?(B(C),C=-1):y=!0,Te(q,Ue-ie))):(ne.sortIndex=K,e(h,ne),S||E||(S=!0,Z||(Z=!0,M()))),ne},t.unstable_shouldYield=O,t.unstable_wrapCallback=function(ne){var ue=_;return function(){var Ue=_;_=ue;try{return ne.apply(this,arguments)}finally{_=Ue}}}}(Mg)),Mg}var uE;function U3(){return uE||(uE=1,Pg.exports=L3()),Pg.exports}var Lg={exports:{}},Sn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fE;function B3(){if(fE)return Sn;fE=1;var t=sx();function e(h){var d="https://react.dev/errors/"+h;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)d+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+h+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(e(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},a=Symbol.for("react.portal");function o(h,d,p){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:v==null?null:""+v,children:h,containerInfo:d,implementation:p}}var l=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,d){if(h==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return Sn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Sn.createPortal=function(h,d){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return o(h,d,null,p)},Sn.flushSync=function(h){var d=l.T,p=n.p;try{if(l.T=null,n.p=2,h)return h()}finally{l.T=d,n.p=p,n.d.f()}},Sn.preconnect=function(h,d){typeof h=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,n.d.C(h,d))},Sn.prefetchDNS=function(h){typeof h=="string"&&n.d.D(h)},Sn.preinit=function(h,d){if(typeof h=="string"&&d&&typeof d.as=="string"){var p=d.as,v=u(p,d.crossOrigin),_=typeof d.integrity=="string"?d.integrity:void 0,E=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;p==="style"?n.d.S(h,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:v,integrity:_,fetchPriority:E}):p==="script"&&n.d.X(h,{crossOrigin:v,integrity:_,fetchPriority:E,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},Sn.preinitModule=function(h,d){if(typeof h=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var p=u(d.as,d.crossOrigin);n.d.M(h,{crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&n.d.M(h)},Sn.preload=function(h,d){if(typeof h=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var p=d.as,v=u(p,d.crossOrigin);n.d.L(h,p,{crossOrigin:v,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},Sn.preloadModule=function(h,d){if(typeof h=="string")if(d){var p=u(d.as,d.crossOrigin);n.d.m(h,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else n.d.m(h)},Sn.requestFormReset=function(h){n.d.r(h)},Sn.unstable_batchedUpdates=function(h,d){return h(d)},Sn.useFormState=function(h,d,p){return l.H.useFormState(h,d,p)},Sn.useFormStatus=function(){return l.H.useHostTransitionStatus()},Sn.version="19.1.0",Sn}var hE;function V3(){if(hE)return Lg.exports;hE=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Lg.exports=B3(),Lg.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dE;function j3(){if(dE)return hf;dE=1;var t=U3(),e=sx(),r=V3();function n(i){var s="https://react.dev/errors/"+i;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)s+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+i+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function o(i){var s=i,c=i;if(i.alternate)for(;s.return;)s=s.return;else{i=s;do s=i,(s.flags&4098)!==0&&(c=s.return),i=s.return;while(i)}return s.tag===3?c:null}function l(i){if(i.tag===13){var s=i.memoizedState;if(s===null&&(i=i.alternate,i!==null&&(s=i.memoizedState)),s!==null)return s.dehydrated}return null}function u(i){if(o(i)!==i)throw Error(n(188))}function h(i){var s=i.alternate;if(!s){if(s=o(i),s===null)throw Error(n(188));return s!==i?null:i}for(var c=i,f=s;;){var g=c.return;if(g===null)break;var x=g.alternate;if(x===null){if(f=g.return,f!==null){c=f;continue}break}if(g.child===x.child){for(x=g.child;x;){if(x===c)return u(g),i;if(x===f)return u(g),s;x=x.sibling}throw Error(n(188))}if(c.return!==f.return)c=g,f=x;else{for(var R=!1,U=g.child;U;){if(U===c){R=!0,c=g,f=x;break}if(U===f){R=!0,f=g,c=x;break}U=U.sibling}if(!R){for(U=x.child;U;){if(U===c){R=!0,c=x,f=g;break}if(U===f){R=!0,f=x,c=g;break}U=U.sibling}if(!R)throw Error(n(189))}}if(c.alternate!==f)throw Error(n(190))}if(c.tag!==3)throw Error(n(188));return c.stateNode.current===c?i:s}function d(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i;for(i=i.child;i!==null;){if(s=d(i),s!==null)return s;i=i.sibling}return null}var p=Object.assign,v=Symbol.for("react.element"),_=Symbol.for("react.transitional.element"),E=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),y=Symbol.for("react.strict_mode"),w=Symbol.for("react.profiler"),P=Symbol.for("react.provider"),B=Symbol.for("react.consumer"),N=Symbol.for("react.context"),z=Symbol.for("react.forward_ref"),q=Symbol.for("react.suspense"),Z=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),I=Symbol.for("react.lazy"),b=Symbol.for("react.activity"),O=Symbol.for("react.memo_cache_sentinel"),L=Symbol.iterator;function M(i){return i===null||typeof i!="object"?null:(i=L&&i[L]||i["@@iterator"],typeof i=="function"?i:null)}var D=Symbol.for("react.client.reference");function Ee(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===D?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case S:return"Fragment";case w:return"Profiler";case y:return"StrictMode";case q:return"Suspense";case Z:return"SuspenseList";case b:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case E:return"Portal";case N:return(i.displayName||"Context")+".Provider";case B:return(i._context.displayName||"Context")+".Consumer";case z:var s=i.render;return i=i.displayName,i||(i=s.displayName||s.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case C:return s=i.displayName||null,s!==null?s:Ee(i.type)||"Memo";case I:s=i._payload,i=i._init;try{return Ee(i(s))}catch{}}return null}var Te=Array.isArray,ne=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ue=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ue={pending:!1,data:null,method:null,action:null},ie=[],K=-1;function pe(i){return{current:i}}function V(i){0>K||(i.current=ie[K],ie[K]=null,K--)}function X(i,s){K++,ie[K]=i.current,i.current=s}var ee=pe(null),te=pe(null),le=pe(null),Ne=pe(null);function ke(i,s){switch(X(le,s),X(te,i),X(ee,null),s.nodeType){case 9:case 11:i=(i=s.documentElement)&&(i=i.namespaceURI)?O2(i):0;break;default:if(i=s.tagName,s=s.namespaceURI)s=O2(s),i=F2(s,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}V(ee),X(ee,i)}function Oe(){V(ee),V(te),V(le)}function _e(i){i.memoizedState!==null&&X(Ne,i);var s=ee.current,c=F2(s,i.type);s!==c&&(X(te,i),X(ee,c))}function Be(i){te.current===i&&(V(ee),V(te)),Ne.current===i&&(V(Ne),sf._currentValue=Ue)}var W=Object.prototype.hasOwnProperty,nt=t.unstable_scheduleCallback,it=t.unstable_cancelCallback,wt=t.unstable_shouldYield,st=t.unstable_requestPaint,Le=t.unstable_now,ir=t.unstable_getCurrentPriorityLevel,Lr=t.unstable_ImmediatePriority,Kr=t.unstable_UserBlockingPriority,me=t.unstable_NormalPriority,We=t.unstable_LowPriority,je=t.unstable_IdlePriority,ot=t.log,Nt=t.unstable_setDisableYieldValue,mt=null,vt=null;function pt(i){if(typeof ot=="function"&&Nt(i),vt&&typeof vt.setStrictMode=="function")try{vt.setStrictMode(mt,i)}catch{}}var Ft=Math.clz32?Math.clz32:Ur,_t=Math.log,fr=Math.LN2;function Ur(i){return i>>>=0,i===0?32:31-(_t(i)/fr|0)|0}var sr=256,Ln=4194304;function Kn(i){var s=i&42;if(s!==0)return s;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function Ts(i,s,c){var f=i.pendingLanes;if(f===0)return 0;var g=0,x=i.suspendedLanes,R=i.pingedLanes;i=i.warmLanes;var U=f&134217727;return U!==0?(f=U&~x,f!==0?g=Kn(f):(R&=U,R!==0?g=Kn(R):c||(c=U&~i,c!==0&&(g=Kn(c))))):(U=f&~x,U!==0?g=Kn(U):R!==0?g=Kn(R):c||(c=f&~i,c!==0&&(g=Kn(c)))),g===0?0:s!==0&&s!==g&&(s&x)===0&&(x=g&-g,c=s&-s,x>=c||x===32&&(c&4194048)!==0)?s:g}function ji(i,s){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&s)===0}function ws(i,s){switch(i){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ss(){var i=sr;return sr<<=1,(sr&4194048)===0&&(sr=256),i}function As(){var i=Ln;return Ln<<=1,(Ln&62914560)===0&&(Ln=4194304),i}function Ga(i){for(var s=[],c=0;31>c;c++)s.push(i);return s}function qa(i,s){i.pendingLanes|=s,s!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function ii(i,s,c,f,g,x){var R=i.pendingLanes;i.pendingLanes=c,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=c,i.entangledLanes&=c,i.errorRecoveryDisabledLanes&=c,i.shellSuspendCounter=0;var U=i.entanglements,re=i.expirationTimes,de=i.hiddenUpdates;for(c=R&~c;0<c;){var be=31-Ft(c),Ie=1<<be;U[be]=0,re[be]=-1;var ve=de[be];if(ve!==null)for(de[be]=null,be=0;be<ve.length;be++){var ye=ve[be];ye!==null&&(ye.lane&=-536870913)}c&=~Ie}f!==0&&wa(i,f,0),x!==0&&g===0&&i.tag!==0&&(i.suspendedLanes|=x&~(R&~s))}function wa(i,s,c){i.pendingLanes|=s,i.suspendedLanes&=~s;var f=31-Ft(s);i.entangledLanes|=s,i.entanglements[f]=i.entanglements[f]|1073741824|c&4194090}function Oo(i,s){var c=i.entangledLanes|=s;for(i=i.entanglements;c;){var f=31-Ft(c),g=1<<f;g&s|i[f]&s&&(i[f]|=s),c&=~g}}function si(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function bs(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function oi(){var i=ue.p;return i!==0?i:(i=window.event,i===void 0?32:J2(i.type))}function jl(i,s){var c=ue.p;try{return ue.p=i,s()}finally{ue.p=c}}var lr=Math.random().toString(36).slice(2),Ir="__reactFiber$"+lr,gr="__reactProps$"+lr,Yn="__reactContainer$"+lr,Fo="__reactEvents$"+lr,hu="__reactListeners$"+lr,F="__reactHandles$"+lr,Q="__reactResources$"+lr,H="__reactMarker$"+lr;function G(i){delete i[Ir],delete i[gr],delete i[Fo],delete i[hu],delete i[F]}function Y(i){var s=i[Ir];if(s)return s;for(var c=i.parentNode;c;){if(s=c[Yn]||c[Ir]){if(c=s.alternate,s.child!==null||c!==null&&c.child!==null)for(i=U2(i);i!==null;){if(c=i[Ir])return c;i=U2(i)}return s}i=c,c=i.parentNode}return null}function J(i){if(i=i[Ir]||i[Yn]){var s=i.tag;if(s===5||s===6||s===13||s===26||s===27||s===3)return i}return null}function he(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i.stateNode;throw Error(n(33))}function we(i){var s=i[Q];return s||(s=i[Q]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function oe(i){i[H]=!0}var ge=new Set,xe={};function Pe(i,s){Ve(i,s),Ve(i+"Capture",s)}function Ve(i,s){for(xe[i]=s,i=0;i<s.length;i++)ge.add(s[i])}var Xe=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Me={},qe={};function ft(i){return W.call(qe,i)?!0:W.call(Me,i)?!1:Xe.test(i)?qe[i]=!0:(Me[i]=!0,!1)}function zt(i,s,c){if(ft(s))if(c===null)i.removeAttribute(s);else{switch(typeof c){case"undefined":case"function":case"symbol":i.removeAttribute(s);return;case"boolean":var f=s.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){i.removeAttribute(s);return}}i.setAttribute(s,""+c)}}function Pt(i,s,c){if(c===null)i.removeAttribute(s);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(s);return}i.setAttribute(s,""+c)}}function Mt(i,s,c,f){if(f===null)i.removeAttribute(c);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(c);return}i.setAttributeNS(s,c,""+f)}}var ia,li;function Un(i){if(ia===void 0)try{throw Error()}catch(c){var s=c.stack.trim().match(/\n( *(at )?)/);ia=s&&s[1]||"",li=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ia+i+li}var $n=!1;function ci(i,s){if(!i||$n)return"";$n=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(s){var Ie=function(){throw Error()};if(Object.defineProperty(Ie.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ie,[])}catch(ye){var ve=ye}Reflect.construct(i,[],Ie)}else{try{Ie.call()}catch(ye){ve=ye}i.call(Ie.prototype)}}else{try{throw Error()}catch(ye){ve=ye}(Ie=i())&&typeof Ie.catch=="function"&&Ie.catch(function(){})}}catch(ye){if(ye&&ve&&typeof ye.stack=="string")return[ye.stack,ve.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var x=f.DetermineComponentFrameRoot(),R=x[0],U=x[1];if(R&&U){var re=R.split(`
`),de=U.split(`
`);for(g=f=0;f<re.length&&!re[f].includes("DetermineComponentFrameRoot");)f++;for(;g<de.length&&!de[g].includes("DetermineComponentFrameRoot");)g++;if(f===re.length||g===de.length)for(f=re.length-1,g=de.length-1;1<=f&&0<=g&&re[f]!==de[g];)g--;for(;1<=f&&0<=g;f--,g--)if(re[f]!==de[g]){if(f!==1||g!==1)do if(f--,g--,0>g||re[f]!==de[g]){var be=`
`+re[f].replace(" at new "," at ");return i.displayName&&be.includes("<anonymous>")&&(be=be.replace("<anonymous>",i.displayName)),be}while(1<=f&&0<=g);break}}}finally{$n=!1,Error.prepareStackTrace=c}return(c=i?i.displayName||i.name:"")?Un(c):""}function Bn(i){switch(i.tag){case 26:case 27:case 5:return Un(i.type);case 16:return Un("Lazy");case 13:return Un("Suspense");case 19:return Un("SuspenseList");case 0:case 15:return ci(i.type,!1);case 11:return ci(i.type.render,!1);case 1:return ci(i.type,!0);case 31:return Un("Activity");default:return""}}function Hl(i){try{var s="";do s+=Bn(i),i=i.return;while(i);return s}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}function Vn(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function du(i){var s=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function Mm(i){var s=du(i)?"checked":"value",c=Object.getOwnPropertyDescriptor(i.constructor.prototype,s),f=""+i[s];if(!i.hasOwnProperty(s)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var g=c.get,x=c.set;return Object.defineProperty(i,s,{configurable:!0,get:function(){return g.call(this)},set:function(R){f=""+R,x.call(this,R)}}),Object.defineProperty(i,s,{enumerable:c.enumerable}),{getValue:function(){return f},setValue:function(R){f=""+R},stopTracking:function(){i._valueTracker=null,delete i[s]}}}}function zl(i){i._valueTracker||(i._valueTracker=Mm(i))}function mu(i){if(!i)return!1;var s=i._valueTracker;if(!s)return!0;var c=s.getValue(),f="";return i&&(f=du(i)?i.checked?"true":"false":i.value),i=f,i!==c?(s.setValue(i),!0):!1}function Po(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var Lm=/[\n"\\]/g;function Br(i){return i.replace(Lm,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function sa(i,s,c,f,g,x,R,U){i.name="",R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"?i.type=R:i.removeAttribute("type"),s!=null?R==="number"?(s===0&&i.value===""||i.value!=s)&&(i.value=""+Vn(s)):i.value!==""+Vn(s)&&(i.value=""+Vn(s)):R!=="submit"&&R!=="reset"||i.removeAttribute("value"),s!=null?ks(i,R,Vn(s)):c!=null?ks(i,R,Vn(c)):f!=null&&i.removeAttribute("value"),g==null&&x!=null&&(i.defaultChecked=!!x),g!=null&&(i.checked=g&&typeof g!="function"&&typeof g!="symbol"),U!=null&&typeof U!="function"&&typeof U!="symbol"&&typeof U!="boolean"?i.name=""+Vn(U):i.removeAttribute("name")}function Mo(i,s,c,f,g,x,R,U){if(x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(i.type=x),s!=null||c!=null){if(!(x!=="submit"&&x!=="reset"||s!=null))return;c=c!=null?""+Vn(c):"",s=s!=null?""+Vn(s):c,U||s===i.value||(i.value=s),i.defaultValue=s}f=f??g,f=typeof f!="function"&&typeof f!="symbol"&&!!f,i.checked=U?i.checked:!!f,i.defaultChecked=!!f,R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"&&(i.name=R)}function ks(i,s,c){s==="number"&&Po(i.ownerDocument)===i||i.defaultValue===""+c||(i.defaultValue=""+c)}function Hi(i,s,c,f){if(i=i.options,s){s={};for(var g=0;g<c.length;g++)s["$"+c[g]]=!0;for(c=0;c<i.length;c++)g=s.hasOwnProperty("$"+i[c].value),i[c].selected!==g&&(i[c].selected=g),g&&f&&(i[c].defaultSelected=!0)}else{for(c=""+Vn(c),s=null,g=0;g<i.length;g++){if(i[g].value===c){i[g].selected=!0,f&&(i[g].defaultSelected=!0);return}s!==null||i[g].disabled||(s=i[g])}s!==null&&(s.selected=!0)}}function er(i,s,c){if(s!=null&&(s=""+Vn(s),s!==i.value&&(i.value=s),c==null)){i.defaultValue!==s&&(i.defaultValue=s);return}i.defaultValue=c!=null?""+Vn(c):""}function Lo(i,s,c,f){if(s==null){if(f!=null){if(c!=null)throw Error(n(92));if(Te(f)){if(1<f.length)throw Error(n(93));f=f[0]}c=f}c==null&&(c=""),s=c}c=Vn(s),i.defaultValue=c,f=i.textContent,f===c&&f!==""&&f!==null&&(i.value=f)}function Sa(i,s){if(s){var c=i.firstChild;if(c&&c===i.lastChild&&c.nodeType===3){c.nodeValue=s;return}}i.textContent=s}var Uo=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function F0(i,s,c){var f=s.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?f?i.setProperty(s,""):s==="float"?i.cssFloat="":i[s]="":f?i.setProperty(s,c):typeof c!="number"||c===0||Uo.has(s)?s==="float"?i.cssFloat=c:i[s]=(""+c).trim():i[s]=c+"px"}function pu(i,s,c){if(s!=null&&typeof s!="object")throw Error(n(62));if(i=i.style,c!=null){for(var f in c)!c.hasOwnProperty(f)||s!=null&&s.hasOwnProperty(f)||(f.indexOf("--")===0?i.setProperty(f,""):f==="float"?i.cssFloat="":i[f]="");for(var g in s)f=s[g],s.hasOwnProperty(g)&&c[g]!==f&&F0(i,g,f)}else for(var x in s)s.hasOwnProperty(x)&&F0(i,x,s[x])}function gu(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Um=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Bm=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Gl(i){return Bm.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}var zi=null;function Aa(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Gi=null,qi=null;function xu(i){var s=J(i);if(s&&(i=s.stateNode)){var c=i[gr]||null;e:switch(i=s.stateNode,s.type){case"input":if(sa(i,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),s=c.name,c.type==="radio"&&s!=null){for(c=i;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+Br(""+s)+'"][type="radio"]'),s=0;s<c.length;s++){var f=c[s];if(f!==i&&f.form===i.form){var g=f[gr]||null;if(!g)throw Error(n(90));sa(f,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(s=0;s<c.length;s++)f=c[s],f.form===i.form&&mu(f)}break e;case"textarea":er(i,c.value,c.defaultValue);break e;case"select":s=c.value,s!=null&&Hi(i,!!c.multiple,s,!1)}}}var ui=!1;function P0(i,s,c){if(ui)return i(s,c);ui=!0;try{var f=i(s);return f}finally{if(ui=!1,(Gi!==null||qi!==null)&&(Ch(),Gi&&(s=Gi,i=qi,qi=Gi=null,xu(s),i)))for(s=0;s<i.length;s++)xu(i[s])}}function Bo(i,s){var c=i.stateNode;if(c===null)return null;var f=c[gr]||null;if(f===null)return null;c=f[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(i=i.type,f=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!f;break e;default:i=!1}if(i)return null;if(c&&typeof c!="function")throw Error(n(231,s,typeof c));return c}var Wa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ba=!1;if(Wa)try{var Vo={};Object.defineProperty(Vo,"passive",{get:function(){ba=!0}}),window.addEventListener("test",Vo,Vo),window.removeEventListener("test",Vo,Vo)}catch{ba=!1}var fi=null,Cs=null,Wi=null;function vu(){if(Wi)return Wi;var i,s=Cs,c=s.length,f,g="value"in fi?fi.value:fi.textContent,x=g.length;for(i=0;i<c&&s[i]===g[i];i++);var R=c-i;for(f=1;f<=R&&s[c-f]===g[x-f];f++);return Wi=g.slice(i,1<f?1-f:void 0)}function hi(i){var s=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&s===13&&(i=13)):i=s,i===10&&(i=13),32<=i||i===13?i:0}function di(){return!0}function _u(){return!1}function nn(i){function s(c,f,g,x,R){this._reactName=c,this._targetInst=g,this.type=f,this.nativeEvent=x,this.target=R,this.currentTarget=null;for(var U in i)i.hasOwnProperty(U)&&(c=i[U],this[U]=c?c(x):x[U]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?di:_u,this.isPropagationStopped=_u,this}return p(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=di)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=di)},persist:function(){},isPersistent:di}),s}var Xt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ql=nn(Xt),jo=p({},Xt,{view:0,detail:0}),M0=nn(jo),Wl,Xl,mi,Ho=p({},jo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:qo,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==mi&&(mi&&i.type==="mousemove"?(Wl=i.screenX-mi.screenX,Xl=i.screenY-mi.screenY):Xl=Wl=0,mi=i),Wl)},movementY:function(i){return"movementY"in i?i.movementY:Xl}}),ka=nn(Ho),L0=p({},Ho,{dataTransfer:0}),Vm=nn(L0),zo=p({},jo,{relatedTarget:0}),Kl=nn(zo),yu=p({},Xt,{animationName:0,elapsedTime:0,pseudoElement:0}),Yl=nn(yu),U0=p({},Xt,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),$l=nn(U0),jm=p({},Xt,{data:0}),Eu=nn(jm),Go={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},B0={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},V0={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Tu(i){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(i):(i=V0[i])?!!s[i]:!1}function qo(){return Tu}var j0=p({},jo,{key:function(i){if(i.key){var s=Go[i.key]||i.key;if(s!=="Unidentified")return s}return i.type==="keypress"?(i=hi(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?B0[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:qo,charCode:function(i){return i.type==="keypress"?hi(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?hi(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),Ql=nn(j0),H0=p({},Ho,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),wu=nn(H0),Xi=p({},jo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:qo}),z0=nn(Xi),G0=p({},Xt,{propertyName:0,elapsedTime:0,pseudoElement:0}),q0=nn(G0),W0=p({},Ho,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Zl=nn(W0),jn=p({},Xt,{newState:0,oldState:0}),X0=nn(jn),K0=[9,13,27,32],pi=Wa&&"CompositionEvent"in window,m=null;Wa&&"documentMode"in document&&(m=document.documentMode);var T=Wa&&"TextEvent"in window&&!m,k=Wa&&(!pi||m&&8<m&&11>=m),j=" ",ce=!1;function Se(i,s){switch(i){case"keyup":return K0.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ze(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Lt=!1;function Yr(i,s){switch(i){case"compositionend":return ze(s);case"keypress":return s.which!==32?null:(ce=!0,j);case"textInput":return i=s.data,i===j&&ce?null:i;default:return null}}function Ut(i,s){if(Lt)return i==="compositionend"||!pi&&Se(i,s)?(i=vu(),Wi=Cs=fi=null,Lt=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return k&&s.locale!=="ko"?null:s.data;default:return null}}var an={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $r(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s==="input"?!!an[i.type]:s==="textarea"}function Ki(i,s,c,f){Gi?qi?qi.push(f):qi=[f]:Gi=f,s=Fh(s,"onChange"),0<s.length&&(c=new ql("onChange","change",null,c,f),i.push({event:c,listeners:s}))}var dn=null,gi=null;function Su(i){C2(i,0)}function Y0(i){var s=he(i);if(mu(s))return i}function Yv(i,s){if(i==="change")return s}var $v=!1;if(Wa){var Hm;if(Wa){var zm="oninput"in document;if(!zm){var Qv=document.createElement("div");Qv.setAttribute("oninput","return;"),zm=typeof Qv.oninput=="function"}Hm=zm}else Hm=!1;$v=Hm&&(!document.documentMode||9<document.documentMode)}function Zv(){dn&&(dn.detachEvent("onpropertychange",Jv),gi=dn=null)}function Jv(i){if(i.propertyName==="value"&&Y0(gi)){var s=[];Ki(s,gi,i,Aa(i)),P0(Su,s)}}function cC(i,s,c){i==="focusin"?(Zv(),dn=s,gi=c,dn.attachEvent("onpropertychange",Jv)):i==="focusout"&&Zv()}function uC(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Y0(gi)}function fC(i,s){if(i==="click")return Y0(s)}function hC(i,s){if(i==="input"||i==="change")return Y0(s)}function dC(i,s){return i===s&&(i!==0||1/i===1/s)||i!==i&&s!==s}var oa=typeof Object.is=="function"?Object.is:dC;function Au(i,s){if(oa(i,s))return!0;if(typeof i!="object"||i===null||typeof s!="object"||s===null)return!1;var c=Object.keys(i),f=Object.keys(s);if(c.length!==f.length)return!1;for(f=0;f<c.length;f++){var g=c[f];if(!W.call(s,g)||!oa(i[g],s[g]))return!1}return!0}function e_(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function t_(i,s){var c=e_(i);i=0;for(var f;c;){if(c.nodeType===3){if(f=i+c.textContent.length,i<=s&&f>=s)return{node:c,offset:s-i};i=f}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=e_(c)}}function r_(i,s){return i&&s?i===s?!0:i&&i.nodeType===3?!1:s&&s.nodeType===3?r_(i,s.parentNode):"contains"in i?i.contains(s):i.compareDocumentPosition?!!(i.compareDocumentPosition(s)&16):!1:!1}function n_(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var s=Po(i.document);s instanceof i.HTMLIFrameElement;){try{var c=typeof s.contentWindow.location.href=="string"}catch{c=!1}if(c)i=s.contentWindow;else break;s=Po(i.document)}return s}function Gm(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s&&(s==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||s==="textarea"||i.contentEditable==="true")}var mC=Wa&&"documentMode"in document&&11>=document.documentMode,Jl=null,qm=null,bu=null,Wm=!1;function a_(i,s,c){var f=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Wm||Jl==null||Jl!==Po(f)||(f=Jl,"selectionStart"in f&&Gm(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),bu&&Au(bu,f)||(bu=f,f=Fh(qm,"onSelect"),0<f.length&&(s=new ql("onSelect","select",null,s,c),i.push({event:s,listeners:f}),s.target=Jl)))}function Wo(i,s){var c={};return c[i.toLowerCase()]=s.toLowerCase(),c["Webkit"+i]="webkit"+s,c["Moz"+i]="moz"+s,c}var ec={animationend:Wo("Animation","AnimationEnd"),animationiteration:Wo("Animation","AnimationIteration"),animationstart:Wo("Animation","AnimationStart"),transitionrun:Wo("Transition","TransitionRun"),transitionstart:Wo("Transition","TransitionStart"),transitioncancel:Wo("Transition","TransitionCancel"),transitionend:Wo("Transition","TransitionEnd")},Xm={},i_={};Wa&&(i_=document.createElement("div").style,"AnimationEvent"in window||(delete ec.animationend.animation,delete ec.animationiteration.animation,delete ec.animationstart.animation),"TransitionEvent"in window||delete ec.transitionend.transition);function Xo(i){if(Xm[i])return Xm[i];if(!ec[i])return i;var s=ec[i],c;for(c in s)if(s.hasOwnProperty(c)&&c in i_)return Xm[i]=s[c];return i}var s_=Xo("animationend"),o_=Xo("animationiteration"),l_=Xo("animationstart"),pC=Xo("transitionrun"),gC=Xo("transitionstart"),xC=Xo("transitioncancel"),c_=Xo("transitionend"),u_=new Map,Km="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Km.push("scrollEnd");function Xa(i,s){u_.set(i,s),Pe(s,[i])}var f_=new WeakMap;function Ca(i,s){if(typeof i=="object"&&i!==null){var c=f_.get(i);return c!==void 0?c:(s={value:i,source:s,stack:Hl(s)},f_.set(i,s),s)}return{value:i,source:s,stack:Hl(s)}}var Ra=[],tc=0,Ym=0;function $0(){for(var i=tc,s=Ym=tc=0;s<i;){var c=Ra[s];Ra[s++]=null;var f=Ra[s];Ra[s++]=null;var g=Ra[s];Ra[s++]=null;var x=Ra[s];if(Ra[s++]=null,f!==null&&g!==null){var R=f.pending;R===null?g.next=g:(g.next=R.next,R.next=g),f.pending=g}x!==0&&h_(c,g,x)}}function Q0(i,s,c,f){Ra[tc++]=i,Ra[tc++]=s,Ra[tc++]=c,Ra[tc++]=f,Ym|=f,i.lanes|=f,i=i.alternate,i!==null&&(i.lanes|=f)}function $m(i,s,c,f){return Q0(i,s,c,f),Z0(i)}function rc(i,s){return Q0(i,null,null,s),Z0(i)}function h_(i,s,c){i.lanes|=c;var f=i.alternate;f!==null&&(f.lanes|=c);for(var g=!1,x=i.return;x!==null;)x.childLanes|=c,f=x.alternate,f!==null&&(f.childLanes|=c),x.tag===22&&(i=x.stateNode,i===null||i._visibility&1||(g=!0)),i=x,x=x.return;return i.tag===3?(x=i.stateNode,g&&s!==null&&(g=31-Ft(c),i=x.hiddenUpdates,f=i[g],f===null?i[g]=[s]:f.push(s),s.lane=c|536870912),x):null}function Z0(i){if(50<Qu)throw Qu=0,rg=null,Error(n(185));for(var s=i.return;s!==null;)i=s,s=i.return;return i.tag===3?i.stateNode:null}var nc={};function vC(i,s,c,f){this.tag=i,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function la(i,s,c,f){return new vC(i,s,c,f)}function Qm(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Yi(i,s){var c=i.alternate;return c===null?(c=la(i.tag,s,i.key,i.mode),c.elementType=i.elementType,c.type=i.type,c.stateNode=i.stateNode,c.alternate=i,i.alternate=c):(c.pendingProps=s,c.type=i.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=i.flags&65011712,c.childLanes=i.childLanes,c.lanes=i.lanes,c.child=i.child,c.memoizedProps=i.memoizedProps,c.memoizedState=i.memoizedState,c.updateQueue=i.updateQueue,s=i.dependencies,c.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},c.sibling=i.sibling,c.index=i.index,c.ref=i.ref,c.refCleanup=i.refCleanup,c}function d_(i,s){i.flags&=65011714;var c=i.alternate;return c===null?(i.childLanes=0,i.lanes=s,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=c.childLanes,i.lanes=c.lanes,i.child=c.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=c.memoizedProps,i.memoizedState=c.memoizedState,i.updateQueue=c.updateQueue,i.type=c.type,s=c.dependencies,i.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),i}function J0(i,s,c,f,g,x){var R=0;if(f=i,typeof i=="function")Qm(i)&&(R=1);else if(typeof i=="string")R=y3(i,c,ee.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case b:return i=la(31,c,s,g),i.elementType=b,i.lanes=x,i;case S:return Ko(c.children,g,x,s);case y:R=8,g|=24;break;case w:return i=la(12,c,s,g|2),i.elementType=w,i.lanes=x,i;case q:return i=la(13,c,s,g),i.elementType=q,i.lanes=x,i;case Z:return i=la(19,c,s,g),i.elementType=Z,i.lanes=x,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case P:case N:R=10;break e;case B:R=9;break e;case z:R=11;break e;case C:R=14;break e;case I:R=16,f=null;break e}R=29,c=Error(n(130,i===null?"null":typeof i,"")),f=null}return s=la(R,c,s,g),s.elementType=i,s.type=f,s.lanes=x,s}function Ko(i,s,c,f){return i=la(7,i,f,s),i.lanes=c,i}function Zm(i,s,c){return i=la(6,i,null,s),i.lanes=c,i}function Jm(i,s,c){return s=la(4,i.children!==null?i.children:[],i.key,s),s.lanes=c,s.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},s}var ac=[],ic=0,eh=null,th=0,Ia=[],Na=0,Yo=null,$i=1,Qi="";function $o(i,s){ac[ic++]=th,ac[ic++]=eh,eh=i,th=s}function m_(i,s,c){Ia[Na++]=$i,Ia[Na++]=Qi,Ia[Na++]=Yo,Yo=i;var f=$i;i=Qi;var g=32-Ft(f)-1;f&=~(1<<g),c+=1;var x=32-Ft(s)+g;if(30<x){var R=g-g%5;x=(f&(1<<R)-1).toString(32),f>>=R,g-=R,$i=1<<32-Ft(s)+g|c<<g|f,Qi=x+i}else $i=1<<x|c<<g|f,Qi=i}function ep(i){i.return!==null&&($o(i,1),m_(i,1,0))}function tp(i){for(;i===eh;)eh=ac[--ic],ac[ic]=null,th=ac[--ic],ac[ic]=null;for(;i===Yo;)Yo=Ia[--Na],Ia[Na]=null,Qi=Ia[--Na],Ia[Na]=null,$i=Ia[--Na],Ia[Na]=null}var Hn=null,Tr=null,Wt=!1,Qo=null,xi=!1,rp=Error(n(519));function Zo(i){var s=Error(n(418,""));throw Ru(Ca(s,i)),rp}function p_(i){var s=i.stateNode,c=i.type,f=i.memoizedProps;switch(s[Ir]=i,s[gr]=f,c){case"dialog":It("cancel",s),It("close",s);break;case"iframe":case"object":case"embed":It("load",s);break;case"video":case"audio":for(c=0;c<Ju.length;c++)It(Ju[c],s);break;case"source":It("error",s);break;case"img":case"image":case"link":It("error",s),It("load",s);break;case"details":It("toggle",s);break;case"input":It("invalid",s),Mo(s,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0),zl(s);break;case"select":It("invalid",s);break;case"textarea":It("invalid",s),Lo(s,f.value,f.defaultValue,f.children),zl(s)}c=f.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||s.textContent===""+c||f.suppressHydrationWarning===!0||D2(s.textContent,c)?(f.popover!=null&&(It("beforetoggle",s),It("toggle",s)),f.onScroll!=null&&It("scroll",s),f.onScrollEnd!=null&&It("scrollend",s),f.onClick!=null&&(s.onclick=Ph),s=!0):s=!1,s||Zo(i)}function g_(i){for(Hn=i.return;Hn;)switch(Hn.tag){case 5:case 13:xi=!1;return;case 27:case 3:xi=!0;return;default:Hn=Hn.return}}function ku(i){if(i!==Hn)return!1;if(!Wt)return g_(i),Wt=!0,!1;var s=i.tag,c;if((c=s!==3&&s!==27)&&((c=s===5)&&(c=i.type,c=!(c!=="form"&&c!=="button")||vg(i.type,i.memoizedProps)),c=!c),c&&Tr&&Zo(i),g_(i),s===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(317));e:{for(i=i.nextSibling,s=0;i;){if(i.nodeType===8)if(c=i.data,c==="/$"){if(s===0){Tr=Ya(i.nextSibling);break e}s--}else c!=="$"&&c!=="$!"&&c!=="$?"||s++;i=i.nextSibling}Tr=null}}else s===27?(s=Tr,Gs(i.type)?(i=Tg,Tg=null,Tr=i):Tr=s):Tr=Hn?Ya(i.stateNode.nextSibling):null;return!0}function Cu(){Tr=Hn=null,Wt=!1}function x_(){var i=Qo;return i!==null&&(Jn===null?Jn=i:Jn.push.apply(Jn,i),Qo=null),i}function Ru(i){Qo===null?Qo=[i]:Qo.push(i)}var np=pe(null),Jo=null,Zi=null;function Rs(i,s,c){X(np,s._currentValue),s._currentValue=c}function Ji(i){i._currentValue=np.current,V(np)}function ap(i,s,c){for(;i!==null;){var f=i.alternate;if((i.childLanes&s)!==s?(i.childLanes|=s,f!==null&&(f.childLanes|=s)):f!==null&&(f.childLanes&s)!==s&&(f.childLanes|=s),i===c)break;i=i.return}}function ip(i,s,c,f){var g=i.child;for(g!==null&&(g.return=i);g!==null;){var x=g.dependencies;if(x!==null){var R=g.child;x=x.firstContext;e:for(;x!==null;){var U=x;x=g;for(var re=0;re<s.length;re++)if(U.context===s[re]){x.lanes|=c,U=x.alternate,U!==null&&(U.lanes|=c),ap(x.return,c,i),f||(R=null);break e}x=U.next}}else if(g.tag===18){if(R=g.return,R===null)throw Error(n(341));R.lanes|=c,x=R.alternate,x!==null&&(x.lanes|=c),ap(R,c,i),R=null}else R=g.child;if(R!==null)R.return=g;else for(R=g;R!==null;){if(R===i){R=null;break}if(g=R.sibling,g!==null){g.return=R.return,R=g;break}R=R.return}g=R}}function Iu(i,s,c,f){i=null;for(var g=s,x=!1;g!==null;){if(!x){if((g.flags&524288)!==0)x=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var R=g.alternate;if(R===null)throw Error(n(387));if(R=R.memoizedProps,R!==null){var U=g.type;oa(g.pendingProps.value,R.value)||(i!==null?i.push(U):i=[U])}}else if(g===Ne.current){if(R=g.alternate,R===null)throw Error(n(387));R.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(i!==null?i.push(sf):i=[sf])}g=g.return}i!==null&&ip(s,i,c,f),s.flags|=262144}function rh(i){for(i=i.firstContext;i!==null;){if(!oa(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function el(i){Jo=i,Zi=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function wn(i){return v_(Jo,i)}function nh(i,s){return Jo===null&&el(i),v_(i,s)}function v_(i,s){var c=s._currentValue;if(s={context:s,memoizedValue:c,next:null},Zi===null){if(i===null)throw Error(n(308));Zi=s,i.dependencies={lanes:0,firstContext:s},i.flags|=524288}else Zi=Zi.next=s;return c}var _C=typeof AbortController<"u"?AbortController:function(){var i=[],s=this.signal={aborted:!1,addEventListener:function(c,f){i.push(f)}};this.abort=function(){s.aborted=!0,i.forEach(function(c){return c()})}},yC=t.unstable_scheduleCallback,EC=t.unstable_NormalPriority,Qr={$$typeof:N,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function sp(){return{controller:new _C,data:new Map,refCount:0}}function Nu(i){i.refCount--,i.refCount===0&&yC(EC,function(){i.controller.abort()})}var Du=null,op=0,sc=0,oc=null;function TC(i,s){if(Du===null){var c=Du=[];op=0,sc=cg(),oc={status:"pending",value:void 0,then:function(f){c.push(f)}}}return op++,s.then(__,__),s}function __(){if(--op===0&&Du!==null){oc!==null&&(oc.status="fulfilled");var i=Du;Du=null,sc=0,oc=null;for(var s=0;s<i.length;s++)(0,i[s])()}}function wC(i,s){var c=[],f={status:"pending",value:null,reason:null,then:function(g){c.push(g)}};return i.then(function(){f.status="fulfilled",f.value=s;for(var g=0;g<c.length;g++)(0,c[g])(s)},function(g){for(f.status="rejected",f.reason=g,g=0;g<c.length;g++)(0,c[g])(void 0)}),f}var y_=ne.S;ne.S=function(i,s){typeof s=="object"&&s!==null&&typeof s.then=="function"&&TC(i,s),y_!==null&&y_(i,s)};var tl=pe(null);function lp(){var i=tl.current;return i!==null?i:cr.pooledCache}function ah(i,s){s===null?X(tl,tl.current):X(tl,s.pool)}function E_(){var i=lp();return i===null?null:{parent:Qr._currentValue,pool:i}}var Ou=Error(n(460)),T_=Error(n(474)),ih=Error(n(542)),cp={then:function(){}};function w_(i){return i=i.status,i==="fulfilled"||i==="rejected"}function sh(){}function S_(i,s,c){switch(c=i[c],c===void 0?i.push(s):c!==s&&(s.then(sh,sh),s=c),s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,b_(i),i;default:if(typeof s.status=="string")s.then(sh,sh);else{if(i=cr,i!==null&&100<i.shellSuspendCounter)throw Error(n(482));i=s,i.status="pending",i.then(function(f){if(s.status==="pending"){var g=s;g.status="fulfilled",g.value=f}},function(f){if(s.status==="pending"){var g=s;g.status="rejected",g.reason=f}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,b_(i),i}throw Fu=s,Ou}}var Fu=null;function A_(){if(Fu===null)throw Error(n(459));var i=Fu;return Fu=null,i}function b_(i){if(i===Ou||i===ih)throw Error(n(483))}var Is=!1;function up(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function fp(i,s){i=i.updateQueue,s.updateQueue===i&&(s.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function Ns(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function Ds(i,s,c){var f=i.updateQueue;if(f===null)return null;if(f=f.shared,(Yt&2)!==0){var g=f.pending;return g===null?s.next=s:(s.next=g.next,g.next=s),f.pending=s,s=Z0(i),h_(i,null,c),s}return Q0(i,f,s,c),Z0(i)}function Pu(i,s,c){if(s=s.updateQueue,s!==null&&(s=s.shared,(c&4194048)!==0)){var f=s.lanes;f&=i.pendingLanes,c|=f,s.lanes=c,Oo(i,c)}}function hp(i,s){var c=i.updateQueue,f=i.alternate;if(f!==null&&(f=f.updateQueue,c===f)){var g=null,x=null;if(c=c.firstBaseUpdate,c!==null){do{var R={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};x===null?g=x=R:x=x.next=R,c=c.next}while(c!==null);x===null?g=x=s:x=x.next=s}else g=x=s;c={baseState:f.baseState,firstBaseUpdate:g,lastBaseUpdate:x,shared:f.shared,callbacks:f.callbacks},i.updateQueue=c;return}i=c.lastBaseUpdate,i===null?c.firstBaseUpdate=s:i.next=s,c.lastBaseUpdate=s}var dp=!1;function Mu(){if(dp){var i=oc;if(i!==null)throw i}}function Lu(i,s,c,f){dp=!1;var g=i.updateQueue;Is=!1;var x=g.firstBaseUpdate,R=g.lastBaseUpdate,U=g.shared.pending;if(U!==null){g.shared.pending=null;var re=U,de=re.next;re.next=null,R===null?x=de:R.next=de,R=re;var be=i.alternate;be!==null&&(be=be.updateQueue,U=be.lastBaseUpdate,U!==R&&(U===null?be.firstBaseUpdate=de:U.next=de,be.lastBaseUpdate=re))}if(x!==null){var Ie=g.baseState;R=0,be=de=re=null,U=x;do{var ve=U.lane&-536870913,ye=ve!==U.lane;if(ye?(Bt&ve)===ve:(f&ve)===ve){ve!==0&&ve===sc&&(dp=!0),be!==null&&(be=be.next={lane:0,tag:U.tag,payload:U.payload,callback:null,next:null});e:{var ht=i,rt=U;ve=s;var nr=c;switch(rt.tag){case 1:if(ht=rt.payload,typeof ht=="function"){Ie=ht.call(nr,Ie,ve);break e}Ie=ht;break e;case 3:ht.flags=ht.flags&-65537|128;case 0:if(ht=rt.payload,ve=typeof ht=="function"?ht.call(nr,Ie,ve):ht,ve==null)break e;Ie=p({},Ie,ve);break e;case 2:Is=!0}}ve=U.callback,ve!==null&&(i.flags|=64,ye&&(i.flags|=8192),ye=g.callbacks,ye===null?g.callbacks=[ve]:ye.push(ve))}else ye={lane:ve,tag:U.tag,payload:U.payload,callback:U.callback,next:null},be===null?(de=be=ye,re=Ie):be=be.next=ye,R|=ve;if(U=U.next,U===null){if(U=g.shared.pending,U===null)break;ye=U,U=ye.next,ye.next=null,g.lastBaseUpdate=ye,g.shared.pending=null}}while(!0);be===null&&(re=Ie),g.baseState=re,g.firstBaseUpdate=de,g.lastBaseUpdate=be,x===null&&(g.shared.lanes=0),Vs|=R,i.lanes=R,i.memoizedState=Ie}}function k_(i,s){if(typeof i!="function")throw Error(n(191,i));i.call(s)}function C_(i,s){var c=i.callbacks;if(c!==null)for(i.callbacks=null,i=0;i<c.length;i++)k_(c[i],s)}var lc=pe(null),oh=pe(0);function R_(i,s){i=ss,X(oh,i),X(lc,s),ss=i|s.baseLanes}function mp(){X(oh,ss),X(lc,lc.current)}function pp(){ss=oh.current,V(lc),V(oh)}var Os=0,St=null,tr=null,Vr=null,lh=!1,cc=!1,rl=!1,ch=0,Uu=0,uc=null,SC=0;function Nr(){throw Error(n(321))}function gp(i,s){if(s===null)return!1;for(var c=0;c<s.length&&c<i.length;c++)if(!oa(i[c],s[c]))return!1;return!0}function xp(i,s,c,f,g,x){return Os=x,St=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,ne.H=i===null||i.memoizedState===null?hy:dy,rl=!1,x=c(f,g),rl=!1,cc&&(x=N_(s,c,f,g)),I_(i),x}function I_(i){ne.H=ph;var s=tr!==null&&tr.next!==null;if(Os=0,Vr=tr=St=null,lh=!1,Uu=0,uc=null,s)throw Error(n(300));i===null||sn||(i=i.dependencies,i!==null&&rh(i)&&(sn=!0))}function N_(i,s,c,f){St=i;var g=0;do{if(cc&&(uc=null),Uu=0,cc=!1,25<=g)throw Error(n(301));if(g+=1,Vr=tr=null,i.updateQueue!=null){var x=i.updateQueue;x.lastEffect=null,x.events=null,x.stores=null,x.memoCache!=null&&(x.memoCache.index=0)}ne.H=NC,x=s(c,f)}while(cc);return x}function AC(){var i=ne.H,s=i.useState()[0];return s=typeof s.then=="function"?Bu(s):s,i=i.useState()[0],(tr!==null?tr.memoizedState:null)!==i&&(St.flags|=1024),s}function vp(){var i=ch!==0;return ch=0,i}function _p(i,s,c){s.updateQueue=i.updateQueue,s.flags&=-2053,i.lanes&=~c}function yp(i){if(lh){for(i=i.memoizedState;i!==null;){var s=i.queue;s!==null&&(s.pending=null),i=i.next}lh=!1}Os=0,Vr=tr=St=null,cc=!1,Uu=ch=0,uc=null}function Qn(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Vr===null?St.memoizedState=Vr=i:Vr=Vr.next=i,Vr}function jr(){if(tr===null){var i=St.alternate;i=i!==null?i.memoizedState:null}else i=tr.next;var s=Vr===null?St.memoizedState:Vr.next;if(s!==null)Vr=s,tr=i;else{if(i===null)throw St.alternate===null?Error(n(467)):Error(n(310));tr=i,i={memoizedState:tr.memoizedState,baseState:tr.baseState,baseQueue:tr.baseQueue,queue:tr.queue,next:null},Vr===null?St.memoizedState=Vr=i:Vr=Vr.next=i}return Vr}function Ep(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Bu(i){var s=Uu;return Uu+=1,uc===null&&(uc=[]),i=S_(uc,i,s),s=St,(Vr===null?s.memoizedState:Vr.next)===null&&(s=s.alternate,ne.H=s===null||s.memoizedState===null?hy:dy),i}function uh(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return Bu(i);if(i.$$typeof===N)return wn(i)}throw Error(n(438,String(i)))}function Tp(i){var s=null,c=St.updateQueue;if(c!==null&&(s=c.memoCache),s==null){var f=St.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(s={data:f.data.map(function(g){return g.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),c===null&&(c=Ep(),St.updateQueue=c),c.memoCache=s,c=s.data[s.index],c===void 0)for(c=s.data[s.index]=Array(i),f=0;f<i;f++)c[f]=O;return s.index++,c}function es(i,s){return typeof s=="function"?s(i):s}function fh(i){var s=jr();return wp(s,tr,i)}function wp(i,s,c){var f=i.queue;if(f===null)throw Error(n(311));f.lastRenderedReducer=c;var g=i.baseQueue,x=f.pending;if(x!==null){if(g!==null){var R=g.next;g.next=x.next,x.next=R}s.baseQueue=g=x,f.pending=null}if(x=i.baseState,g===null)i.memoizedState=x;else{s=g.next;var U=R=null,re=null,de=s,be=!1;do{var Ie=de.lane&-536870913;if(Ie!==de.lane?(Bt&Ie)===Ie:(Os&Ie)===Ie){var ve=de.revertLane;if(ve===0)re!==null&&(re=re.next={lane:0,revertLane:0,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null}),Ie===sc&&(be=!0);else if((Os&ve)===ve){de=de.next,ve===sc&&(be=!0);continue}else Ie={lane:0,revertLane:de.revertLane,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null},re===null?(U=re=Ie,R=x):re=re.next=Ie,St.lanes|=ve,Vs|=ve;Ie=de.action,rl&&c(x,Ie),x=de.hasEagerState?de.eagerState:c(x,Ie)}else ve={lane:Ie,revertLane:de.revertLane,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null},re===null?(U=re=ve,R=x):re=re.next=ve,St.lanes|=Ie,Vs|=Ie;de=de.next}while(de!==null&&de!==s);if(re===null?R=x:re.next=U,!oa(x,i.memoizedState)&&(sn=!0,be&&(c=oc,c!==null)))throw c;i.memoizedState=x,i.baseState=R,i.baseQueue=re,f.lastRenderedState=x}return g===null&&(f.lanes=0),[i.memoizedState,f.dispatch]}function Sp(i){var s=jr(),c=s.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=i;var f=c.dispatch,g=c.pending,x=s.memoizedState;if(g!==null){c.pending=null;var R=g=g.next;do x=i(x,R.action),R=R.next;while(R!==g);oa(x,s.memoizedState)||(sn=!0),s.memoizedState=x,s.baseQueue===null&&(s.baseState=x),c.lastRenderedState=x}return[x,f]}function D_(i,s,c){var f=St,g=jr(),x=Wt;if(x){if(c===void 0)throw Error(n(407));c=c()}else c=s();var R=!oa((tr||g).memoizedState,c);R&&(g.memoizedState=c,sn=!0),g=g.queue;var U=P_.bind(null,f,g,i);if(Vu(2048,8,U,[i]),g.getSnapshot!==s||R||Vr!==null&&Vr.memoizedState.tag&1){if(f.flags|=2048,fc(9,hh(),F_.bind(null,f,g,c,s),null),cr===null)throw Error(n(349));x||(Os&124)!==0||O_(f,s,c)}return c}function O_(i,s,c){i.flags|=16384,i={getSnapshot:s,value:c},s=St.updateQueue,s===null?(s=Ep(),St.updateQueue=s,s.stores=[i]):(c=s.stores,c===null?s.stores=[i]:c.push(i))}function F_(i,s,c,f){s.value=c,s.getSnapshot=f,M_(s)&&L_(i)}function P_(i,s,c){return c(function(){M_(s)&&L_(i)})}function M_(i){var s=i.getSnapshot;i=i.value;try{var c=s();return!oa(i,c)}catch{return!0}}function L_(i){var s=rc(i,2);s!==null&&da(s,i,2)}function Ap(i){var s=Qn();if(typeof i=="function"){var c=i;if(i=c(),rl){pt(!0);try{c()}finally{pt(!1)}}}return s.memoizedState=s.baseState=i,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:es,lastRenderedState:i},s}function U_(i,s,c,f){return i.baseState=c,wp(i,tr,typeof f=="function"?f:es)}function bC(i,s,c,f,g){if(mh(i))throw Error(n(485));if(i=s.action,i!==null){var x={payload:g,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(R){x.listeners.push(R)}};ne.T!==null?c(!0):x.isTransition=!1,f(x),c=s.pending,c===null?(x.next=s.pending=x,B_(s,x)):(x.next=c.next,s.pending=c.next=x)}}function B_(i,s){var c=s.action,f=s.payload,g=i.state;if(s.isTransition){var x=ne.T,R={};ne.T=R;try{var U=c(g,f),re=ne.S;re!==null&&re(R,U),V_(i,s,U)}catch(de){bp(i,s,de)}finally{ne.T=x}}else try{x=c(g,f),V_(i,s,x)}catch(de){bp(i,s,de)}}function V_(i,s,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(f){j_(i,s,f)},function(f){return bp(i,s,f)}):j_(i,s,c)}function j_(i,s,c){s.status="fulfilled",s.value=c,H_(s),i.state=c,s=i.pending,s!==null&&(c=s.next,c===s?i.pending=null:(c=c.next,s.next=c,B_(i,c)))}function bp(i,s,c){var f=i.pending;if(i.pending=null,f!==null){f=f.next;do s.status="rejected",s.reason=c,H_(s),s=s.next;while(s!==f)}i.action=null}function H_(i){i=i.listeners;for(var s=0;s<i.length;s++)(0,i[s])()}function z_(i,s){return s}function G_(i,s){if(Wt){var c=cr.formState;if(c!==null){e:{var f=St;if(Wt){if(Tr){t:{for(var g=Tr,x=xi;g.nodeType!==8;){if(!x){g=null;break t}if(g=Ya(g.nextSibling),g===null){g=null;break t}}x=g.data,g=x==="F!"||x==="F"?g:null}if(g){Tr=Ya(g.nextSibling),f=g.data==="F!";break e}}Zo(f)}f=!1}f&&(s=c[0])}}return c=Qn(),c.memoizedState=c.baseState=s,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:z_,lastRenderedState:s},c.queue=f,c=cy.bind(null,St,f),f.dispatch=c,f=Ap(!1),x=Np.bind(null,St,!1,f.queue),f=Qn(),g={state:s,dispatch:null,action:i,pending:null},f.queue=g,c=bC.bind(null,St,g,x,c),g.dispatch=c,f.memoizedState=i,[s,c,!1]}function q_(i){var s=jr();return W_(s,tr,i)}function W_(i,s,c){if(s=wp(i,s,z_)[0],i=fh(es)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var f=Bu(s)}catch(R){throw R===Ou?ih:R}else f=s;s=jr();var g=s.queue,x=g.dispatch;return c!==s.memoizedState&&(St.flags|=2048,fc(9,hh(),kC.bind(null,g,c),null)),[f,x,i]}function kC(i,s){i.action=s}function X_(i){var s=jr(),c=tr;if(c!==null)return W_(s,c,i);jr(),s=s.memoizedState,c=jr();var f=c.queue.dispatch;return c.memoizedState=i,[s,f,!1]}function fc(i,s,c,f){return i={tag:i,create:c,deps:f,inst:s,next:null},s=St.updateQueue,s===null&&(s=Ep(),St.updateQueue=s),c=s.lastEffect,c===null?s.lastEffect=i.next=i:(f=c.next,c.next=i,i.next=f,s.lastEffect=i),i}function hh(){return{destroy:void 0,resource:void 0}}function K_(){return jr().memoizedState}function dh(i,s,c,f){var g=Qn();f=f===void 0?null:f,St.flags|=i,g.memoizedState=fc(1|s,hh(),c,f)}function Vu(i,s,c,f){var g=jr();f=f===void 0?null:f;var x=g.memoizedState.inst;tr!==null&&f!==null&&gp(f,tr.memoizedState.deps)?g.memoizedState=fc(s,x,c,f):(St.flags|=i,g.memoizedState=fc(1|s,x,c,f))}function Y_(i,s){dh(8390656,8,i,s)}function $_(i,s){Vu(2048,8,i,s)}function Q_(i,s){return Vu(4,2,i,s)}function Z_(i,s){return Vu(4,4,i,s)}function J_(i,s){if(typeof s=="function"){i=i();var c=s(i);return function(){typeof c=="function"?c():s(null)}}if(s!=null)return i=i(),s.current=i,function(){s.current=null}}function ey(i,s,c){c=c!=null?c.concat([i]):null,Vu(4,4,J_.bind(null,s,i),c)}function kp(){}function ty(i,s){var c=jr();s=s===void 0?null:s;var f=c.memoizedState;return s!==null&&gp(s,f[1])?f[0]:(c.memoizedState=[i,s],i)}function ry(i,s){var c=jr();s=s===void 0?null:s;var f=c.memoizedState;if(s!==null&&gp(s,f[1]))return f[0];if(f=i(),rl){pt(!0);try{i()}finally{pt(!1)}}return c.memoizedState=[f,s],f}function Cp(i,s,c){return c===void 0||(Os&1073741824)!==0?i.memoizedState=s:(i.memoizedState=c,i=i2(),St.lanes|=i,Vs|=i,c)}function ny(i,s,c,f){return oa(c,s)?c:lc.current!==null?(i=Cp(i,c,f),oa(i,s)||(sn=!0),i):(Os&42)===0?(sn=!0,i.memoizedState=c):(i=i2(),St.lanes|=i,Vs|=i,s)}function ay(i,s,c,f,g){var x=ue.p;ue.p=x!==0&&8>x?x:8;var R=ne.T,U={};ne.T=U,Np(i,!1,s,c);try{var re=g(),de=ne.S;if(de!==null&&de(U,re),re!==null&&typeof re=="object"&&typeof re.then=="function"){var be=wC(re,f);ju(i,s,be,ha(i))}else ju(i,s,f,ha(i))}catch(Ie){ju(i,s,{then:function(){},status:"rejected",reason:Ie},ha())}finally{ue.p=x,ne.T=R}}function CC(){}function Rp(i,s,c,f){if(i.tag!==5)throw Error(n(476));var g=iy(i).queue;ay(i,g,s,Ue,c===null?CC:function(){return sy(i),c(f)})}function iy(i){var s=i.memoizedState;if(s!==null)return s;s={memoizedState:Ue,baseState:Ue,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:es,lastRenderedState:Ue},next:null};var c={};return s.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:es,lastRenderedState:c},next:null},i.memoizedState=s,i=i.alternate,i!==null&&(i.memoizedState=s),s}function sy(i){var s=iy(i).next.queue;ju(i,s,{},ha())}function Ip(){return wn(sf)}function oy(){return jr().memoizedState}function ly(){return jr().memoizedState}function RC(i){for(var s=i.return;s!==null;){switch(s.tag){case 24:case 3:var c=ha();i=Ns(c);var f=Ds(s,i,c);f!==null&&(da(f,s,c),Pu(f,s,c)),s={cache:sp()},i.payload=s;return}s=s.return}}function IC(i,s,c){var f=ha();c={lane:f,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null},mh(i)?uy(s,c):(c=$m(i,s,c,f),c!==null&&(da(c,i,f),fy(c,s,f)))}function cy(i,s,c){var f=ha();ju(i,s,c,f)}function ju(i,s,c,f){var g={lane:f,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null};if(mh(i))uy(s,g);else{var x=i.alternate;if(i.lanes===0&&(x===null||x.lanes===0)&&(x=s.lastRenderedReducer,x!==null))try{var R=s.lastRenderedState,U=x(R,c);if(g.hasEagerState=!0,g.eagerState=U,oa(U,R))return Q0(i,s,g,0),cr===null&&$0(),!1}catch{}finally{}if(c=$m(i,s,g,f),c!==null)return da(c,i,f),fy(c,s,f),!0}return!1}function Np(i,s,c,f){if(f={lane:2,revertLane:cg(),action:f,hasEagerState:!1,eagerState:null,next:null},mh(i)){if(s)throw Error(n(479))}else s=$m(i,c,f,2),s!==null&&da(s,i,2)}function mh(i){var s=i.alternate;return i===St||s!==null&&s===St}function uy(i,s){cc=lh=!0;var c=i.pending;c===null?s.next=s:(s.next=c.next,c.next=s),i.pending=s}function fy(i,s,c){if((c&4194048)!==0){var f=s.lanes;f&=i.pendingLanes,c|=f,s.lanes=c,Oo(i,c)}}var ph={readContext:wn,use:uh,useCallback:Nr,useContext:Nr,useEffect:Nr,useImperativeHandle:Nr,useLayoutEffect:Nr,useInsertionEffect:Nr,useMemo:Nr,useReducer:Nr,useRef:Nr,useState:Nr,useDebugValue:Nr,useDeferredValue:Nr,useTransition:Nr,useSyncExternalStore:Nr,useId:Nr,useHostTransitionStatus:Nr,useFormState:Nr,useActionState:Nr,useOptimistic:Nr,useMemoCache:Nr,useCacheRefresh:Nr},hy={readContext:wn,use:uh,useCallback:function(i,s){return Qn().memoizedState=[i,s===void 0?null:s],i},useContext:wn,useEffect:Y_,useImperativeHandle:function(i,s,c){c=c!=null?c.concat([i]):null,dh(4194308,4,J_.bind(null,s,i),c)},useLayoutEffect:function(i,s){return dh(4194308,4,i,s)},useInsertionEffect:function(i,s){dh(4,2,i,s)},useMemo:function(i,s){var c=Qn();s=s===void 0?null:s;var f=i();if(rl){pt(!0);try{i()}finally{pt(!1)}}return c.memoizedState=[f,s],f},useReducer:function(i,s,c){var f=Qn();if(c!==void 0){var g=c(s);if(rl){pt(!0);try{c(s)}finally{pt(!1)}}}else g=s;return f.memoizedState=f.baseState=g,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:g},f.queue=i,i=i.dispatch=IC.bind(null,St,i),[f.memoizedState,i]},useRef:function(i){var s=Qn();return i={current:i},s.memoizedState=i},useState:function(i){i=Ap(i);var s=i.queue,c=cy.bind(null,St,s);return s.dispatch=c,[i.memoizedState,c]},useDebugValue:kp,useDeferredValue:function(i,s){var c=Qn();return Cp(c,i,s)},useTransition:function(){var i=Ap(!1);return i=ay.bind(null,St,i.queue,!0,!1),Qn().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,s,c){var f=St,g=Qn();if(Wt){if(c===void 0)throw Error(n(407));c=c()}else{if(c=s(),cr===null)throw Error(n(349));(Bt&124)!==0||O_(f,s,c)}g.memoizedState=c;var x={value:c,getSnapshot:s};return g.queue=x,Y_(P_.bind(null,f,x,i),[i]),f.flags|=2048,fc(9,hh(),F_.bind(null,f,x,c,s),null),c},useId:function(){var i=Qn(),s=cr.identifierPrefix;if(Wt){var c=Qi,f=$i;c=(f&~(1<<32-Ft(f)-1)).toString(32)+c,s=""+s+"R"+c,c=ch++,0<c&&(s+="H"+c.toString(32)),s+=""}else c=SC++,s=""+s+"r"+c.toString(32)+"";return i.memoizedState=s},useHostTransitionStatus:Ip,useFormState:G_,useActionState:G_,useOptimistic:function(i){var s=Qn();s.memoizedState=s.baseState=i;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=c,s=Np.bind(null,St,!0,c),c.dispatch=s,[i,s]},useMemoCache:Tp,useCacheRefresh:function(){return Qn().memoizedState=RC.bind(null,St)}},dy={readContext:wn,use:uh,useCallback:ty,useContext:wn,useEffect:$_,useImperativeHandle:ey,useInsertionEffect:Q_,useLayoutEffect:Z_,useMemo:ry,useReducer:fh,useRef:K_,useState:function(){return fh(es)},useDebugValue:kp,useDeferredValue:function(i,s){var c=jr();return ny(c,tr.memoizedState,i,s)},useTransition:function(){var i=fh(es)[0],s=jr().memoizedState;return[typeof i=="boolean"?i:Bu(i),s]},useSyncExternalStore:D_,useId:oy,useHostTransitionStatus:Ip,useFormState:q_,useActionState:q_,useOptimistic:function(i,s){var c=jr();return U_(c,tr,i,s)},useMemoCache:Tp,useCacheRefresh:ly},NC={readContext:wn,use:uh,useCallback:ty,useContext:wn,useEffect:$_,useImperativeHandle:ey,useInsertionEffect:Q_,useLayoutEffect:Z_,useMemo:ry,useReducer:Sp,useRef:K_,useState:function(){return Sp(es)},useDebugValue:kp,useDeferredValue:function(i,s){var c=jr();return tr===null?Cp(c,i,s):ny(c,tr.memoizedState,i,s)},useTransition:function(){var i=Sp(es)[0],s=jr().memoizedState;return[typeof i=="boolean"?i:Bu(i),s]},useSyncExternalStore:D_,useId:oy,useHostTransitionStatus:Ip,useFormState:X_,useActionState:X_,useOptimistic:function(i,s){var c=jr();return tr!==null?U_(c,tr,i,s):(c.baseState=i,[i,c.queue.dispatch])},useMemoCache:Tp,useCacheRefresh:ly},hc=null,Hu=0;function gh(i){var s=Hu;return Hu+=1,hc===null&&(hc=[]),S_(hc,i,s)}function zu(i,s){s=s.props.ref,i.ref=s!==void 0?s:null}function xh(i,s){throw s.$$typeof===v?Error(n(525)):(i=Object.prototype.toString.call(s),Error(n(31,i==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":i)))}function my(i){var s=i._init;return s(i._payload)}function py(i){function s(se,ae){if(i){var fe=se.deletions;fe===null?(se.deletions=[ae],se.flags|=16):fe.push(ae)}}function c(se,ae){if(!i)return null;for(;ae!==null;)s(se,ae),ae=ae.sibling;return null}function f(se){for(var ae=new Map;se!==null;)se.key!==null?ae.set(se.key,se):ae.set(se.index,se),se=se.sibling;return ae}function g(se,ae){return se=Yi(se,ae),se.index=0,se.sibling=null,se}function x(se,ae,fe){return se.index=fe,i?(fe=se.alternate,fe!==null?(fe=fe.index,fe<ae?(se.flags|=67108866,ae):fe):(se.flags|=67108866,ae)):(se.flags|=1048576,ae)}function R(se){return i&&se.alternate===null&&(se.flags|=67108866),se}function U(se,ae,fe,Ce){return ae===null||ae.tag!==6?(ae=Zm(fe,se.mode,Ce),ae.return=se,ae):(ae=g(ae,fe),ae.return=se,ae)}function re(se,ae,fe,Ce){var $e=fe.type;return $e===S?be(se,ae,fe.props.children,Ce,fe.key):ae!==null&&(ae.elementType===$e||typeof $e=="object"&&$e!==null&&$e.$$typeof===I&&my($e)===ae.type)?(ae=g(ae,fe.props),zu(ae,fe),ae.return=se,ae):(ae=J0(fe.type,fe.key,fe.props,null,se.mode,Ce),zu(ae,fe),ae.return=se,ae)}function de(se,ae,fe,Ce){return ae===null||ae.tag!==4||ae.stateNode.containerInfo!==fe.containerInfo||ae.stateNode.implementation!==fe.implementation?(ae=Jm(fe,se.mode,Ce),ae.return=se,ae):(ae=g(ae,fe.children||[]),ae.return=se,ae)}function be(se,ae,fe,Ce,$e){return ae===null||ae.tag!==7?(ae=Ko(fe,se.mode,Ce,$e),ae.return=se,ae):(ae=g(ae,fe),ae.return=se,ae)}function Ie(se,ae,fe){if(typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint")return ae=Zm(""+ae,se.mode,fe),ae.return=se,ae;if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case _:return fe=J0(ae.type,ae.key,ae.props,null,se.mode,fe),zu(fe,ae),fe.return=se,fe;case E:return ae=Jm(ae,se.mode,fe),ae.return=se,ae;case I:var Ce=ae._init;return ae=Ce(ae._payload),Ie(se,ae,fe)}if(Te(ae)||M(ae))return ae=Ko(ae,se.mode,fe,null),ae.return=se,ae;if(typeof ae.then=="function")return Ie(se,gh(ae),fe);if(ae.$$typeof===N)return Ie(se,nh(se,ae),fe);xh(se,ae)}return null}function ve(se,ae,fe,Ce){var $e=ae!==null?ae.key:null;if(typeof fe=="string"&&fe!==""||typeof fe=="number"||typeof fe=="bigint")return $e!==null?null:U(se,ae,""+fe,Ce);if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case _:return fe.key===$e?re(se,ae,fe,Ce):null;case E:return fe.key===$e?de(se,ae,fe,Ce):null;case I:return $e=fe._init,fe=$e(fe._payload),ve(se,ae,fe,Ce)}if(Te(fe)||M(fe))return $e!==null?null:be(se,ae,fe,Ce,null);if(typeof fe.then=="function")return ve(se,ae,gh(fe),Ce);if(fe.$$typeof===N)return ve(se,ae,nh(se,fe),Ce);xh(se,fe)}return null}function ye(se,ae,fe,Ce,$e){if(typeof Ce=="string"&&Ce!==""||typeof Ce=="number"||typeof Ce=="bigint")return se=se.get(fe)||null,U(ae,se,""+Ce,$e);if(typeof Ce=="object"&&Ce!==null){switch(Ce.$$typeof){case _:return se=se.get(Ce.key===null?fe:Ce.key)||null,re(ae,se,Ce,$e);case E:return se=se.get(Ce.key===null?fe:Ce.key)||null,de(ae,se,Ce,$e);case I:var kt=Ce._init;return Ce=kt(Ce._payload),ye(se,ae,fe,Ce,$e)}if(Te(Ce)||M(Ce))return se=se.get(fe)||null,be(ae,se,Ce,$e,null);if(typeof Ce.then=="function")return ye(se,ae,fe,gh(Ce),$e);if(Ce.$$typeof===N)return ye(se,ae,fe,nh(ae,Ce),$e);xh(ae,Ce)}return null}function ht(se,ae,fe,Ce){for(var $e=null,kt=null,Ze=ae,at=ae=0,ln=null;Ze!==null&&at<fe.length;at++){Ze.index>at?(ln=Ze,Ze=null):ln=Ze.sibling;var Gt=ve(se,Ze,fe[at],Ce);if(Gt===null){Ze===null&&(Ze=ln);break}i&&Ze&&Gt.alternate===null&&s(se,Ze),ae=x(Gt,ae,at),kt===null?$e=Gt:kt.sibling=Gt,kt=Gt,Ze=ln}if(at===fe.length)return c(se,Ze),Wt&&$o(se,at),$e;if(Ze===null){for(;at<fe.length;at++)Ze=Ie(se,fe[at],Ce),Ze!==null&&(ae=x(Ze,ae,at),kt===null?$e=Ze:kt.sibling=Ze,kt=Ze);return Wt&&$o(se,at),$e}for(Ze=f(Ze);at<fe.length;at++)ln=ye(Ze,se,at,fe[at],Ce),ln!==null&&(i&&ln.alternate!==null&&Ze.delete(ln.key===null?at:ln.key),ae=x(ln,ae,at),kt===null?$e=ln:kt.sibling=ln,kt=ln);return i&&Ze.forEach(function(Ys){return s(se,Ys)}),Wt&&$o(se,at),$e}function rt(se,ae,fe,Ce){if(fe==null)throw Error(n(151));for(var $e=null,kt=null,Ze=ae,at=ae=0,ln=null,Gt=fe.next();Ze!==null&&!Gt.done;at++,Gt=fe.next()){Ze.index>at?(ln=Ze,Ze=null):ln=Ze.sibling;var Ys=ve(se,Ze,Gt.value,Ce);if(Ys===null){Ze===null&&(Ze=ln);break}i&&Ze&&Ys.alternate===null&&s(se,Ze),ae=x(Ys,ae,at),kt===null?$e=Ys:kt.sibling=Ys,kt=Ys,Ze=ln}if(Gt.done)return c(se,Ze),Wt&&$o(se,at),$e;if(Ze===null){for(;!Gt.done;at++,Gt=fe.next())Gt=Ie(se,Gt.value,Ce),Gt!==null&&(ae=x(Gt,ae,at),kt===null?$e=Gt:kt.sibling=Gt,kt=Gt);return Wt&&$o(se,at),$e}for(Ze=f(Ze);!Gt.done;at++,Gt=fe.next())Gt=ye(Ze,se,at,Gt.value,Ce),Gt!==null&&(i&&Gt.alternate!==null&&Ze.delete(Gt.key===null?at:Gt.key),ae=x(Gt,ae,at),kt===null?$e=Gt:kt.sibling=Gt,kt=Gt);return i&&Ze.forEach(function(D3){return s(se,D3)}),Wt&&$o(se,at),$e}function nr(se,ae,fe,Ce){if(typeof fe=="object"&&fe!==null&&fe.type===S&&fe.key===null&&(fe=fe.props.children),typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case _:e:{for(var $e=fe.key;ae!==null;){if(ae.key===$e){if($e=fe.type,$e===S){if(ae.tag===7){c(se,ae.sibling),Ce=g(ae,fe.props.children),Ce.return=se,se=Ce;break e}}else if(ae.elementType===$e||typeof $e=="object"&&$e!==null&&$e.$$typeof===I&&my($e)===ae.type){c(se,ae.sibling),Ce=g(ae,fe.props),zu(Ce,fe),Ce.return=se,se=Ce;break e}c(se,ae);break}else s(se,ae);ae=ae.sibling}fe.type===S?(Ce=Ko(fe.props.children,se.mode,Ce,fe.key),Ce.return=se,se=Ce):(Ce=J0(fe.type,fe.key,fe.props,null,se.mode,Ce),zu(Ce,fe),Ce.return=se,se=Ce)}return R(se);case E:e:{for($e=fe.key;ae!==null;){if(ae.key===$e)if(ae.tag===4&&ae.stateNode.containerInfo===fe.containerInfo&&ae.stateNode.implementation===fe.implementation){c(se,ae.sibling),Ce=g(ae,fe.children||[]),Ce.return=se,se=Ce;break e}else{c(se,ae);break}else s(se,ae);ae=ae.sibling}Ce=Jm(fe,se.mode,Ce),Ce.return=se,se=Ce}return R(se);case I:return $e=fe._init,fe=$e(fe._payload),nr(se,ae,fe,Ce)}if(Te(fe))return ht(se,ae,fe,Ce);if(M(fe)){if($e=M(fe),typeof $e!="function")throw Error(n(150));return fe=$e.call(fe),rt(se,ae,fe,Ce)}if(typeof fe.then=="function")return nr(se,ae,gh(fe),Ce);if(fe.$$typeof===N)return nr(se,ae,nh(se,fe),Ce);xh(se,fe)}return typeof fe=="string"&&fe!==""||typeof fe=="number"||typeof fe=="bigint"?(fe=""+fe,ae!==null&&ae.tag===6?(c(se,ae.sibling),Ce=g(ae,fe),Ce.return=se,se=Ce):(c(se,ae),Ce=Zm(fe,se.mode,Ce),Ce.return=se,se=Ce),R(se)):c(se,ae)}return function(se,ae,fe,Ce){try{Hu=0;var $e=nr(se,ae,fe,Ce);return hc=null,$e}catch(Ze){if(Ze===Ou||Ze===ih)throw Ze;var kt=la(29,Ze,null,se.mode);return kt.lanes=Ce,kt.return=se,kt}finally{}}}var dc=py(!0),gy=py(!1),Da=pe(null),vi=null;function Fs(i){var s=i.alternate;X(Zr,Zr.current&1),X(Da,i),vi===null&&(s===null||lc.current!==null||s.memoizedState!==null)&&(vi=i)}function xy(i){if(i.tag===22){if(X(Zr,Zr.current),X(Da,i),vi===null){var s=i.alternate;s!==null&&s.memoizedState!==null&&(vi=i)}}else Ps()}function Ps(){X(Zr,Zr.current),X(Da,Da.current)}function ts(i){V(Da),vi===i&&(vi=null),V(Zr)}var Zr=pe(0);function vh(i){for(var s=i;s!==null;){if(s.tag===13){var c=s.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||Eg(c)))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}function Dp(i,s,c,f){s=i.memoizedState,c=c(f,s),c=c==null?s:p({},s,c),i.memoizedState=c,i.lanes===0&&(i.updateQueue.baseState=c)}var Op={enqueueSetState:function(i,s,c){i=i._reactInternals;var f=ha(),g=Ns(f);g.payload=s,c!=null&&(g.callback=c),s=Ds(i,g,f),s!==null&&(da(s,i,f),Pu(s,i,f))},enqueueReplaceState:function(i,s,c){i=i._reactInternals;var f=ha(),g=Ns(f);g.tag=1,g.payload=s,c!=null&&(g.callback=c),s=Ds(i,g,f),s!==null&&(da(s,i,f),Pu(s,i,f))},enqueueForceUpdate:function(i,s){i=i._reactInternals;var c=ha(),f=Ns(c);f.tag=2,s!=null&&(f.callback=s),s=Ds(i,f,c),s!==null&&(da(s,i,c),Pu(s,i,c))}};function vy(i,s,c,f,g,x,R){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(f,x,R):s.prototype&&s.prototype.isPureReactComponent?!Au(c,f)||!Au(g,x):!0}function _y(i,s,c,f){i=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(c,f),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(c,f),s.state!==i&&Op.enqueueReplaceState(s,s.state,null)}function nl(i,s){var c=s;if("ref"in s){c={};for(var f in s)f!=="ref"&&(c[f]=s[f])}if(i=i.defaultProps){c===s&&(c=p({},c));for(var g in i)c[g]===void 0&&(c[g]=i[g])}return c}var _h=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)};function yy(i){_h(i)}function Ey(i){console.error(i)}function Ty(i){_h(i)}function yh(i,s){try{var c=i.onUncaughtError;c(s.value,{componentStack:s.stack})}catch(f){setTimeout(function(){throw f})}}function wy(i,s,c){try{var f=i.onCaughtError;f(c.value,{componentStack:c.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function Fp(i,s,c){return c=Ns(c),c.tag=3,c.payload={element:null},c.callback=function(){yh(i,s)},c}function Sy(i){return i=Ns(i),i.tag=3,i}function Ay(i,s,c,f){var g=c.type.getDerivedStateFromError;if(typeof g=="function"){var x=f.value;i.payload=function(){return g(x)},i.callback=function(){wy(s,c,f)}}var R=c.stateNode;R!==null&&typeof R.componentDidCatch=="function"&&(i.callback=function(){wy(s,c,f),typeof g!="function"&&(js===null?js=new Set([this]):js.add(this));var U=f.stack;this.componentDidCatch(f.value,{componentStack:U!==null?U:""})})}function DC(i,s,c,f,g){if(c.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(s=c.alternate,s!==null&&Iu(s,c,g,!0),c=Da.current,c!==null){switch(c.tag){case 13:return vi===null?ag():c.alternate===null&&wr===0&&(wr=3),c.flags&=-257,c.flags|=65536,c.lanes=g,f===cp?c.flags|=16384:(s=c.updateQueue,s===null?c.updateQueue=new Set([f]):s.add(f),sg(i,f,g)),!1;case 22:return c.flags|=65536,f===cp?c.flags|=16384:(s=c.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([f])},c.updateQueue=s):(c=s.retryQueue,c===null?s.retryQueue=new Set([f]):c.add(f)),sg(i,f,g)),!1}throw Error(n(435,c.tag))}return sg(i,f,g),ag(),!1}if(Wt)return s=Da.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=g,f!==rp&&(i=Error(n(422),{cause:f}),Ru(Ca(i,c)))):(f!==rp&&(s=Error(n(423),{cause:f}),Ru(Ca(s,c))),i=i.current.alternate,i.flags|=65536,g&=-g,i.lanes|=g,f=Ca(f,c),g=Fp(i.stateNode,f,g),hp(i,g),wr!==4&&(wr=2)),!1;var x=Error(n(520),{cause:f});if(x=Ca(x,c),$u===null?$u=[x]:$u.push(x),wr!==4&&(wr=2),s===null)return!0;f=Ca(f,c),c=s;do{switch(c.tag){case 3:return c.flags|=65536,i=g&-g,c.lanes|=i,i=Fp(c.stateNode,f,i),hp(c,i),!1;case 1:if(s=c.type,x=c.stateNode,(c.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(js===null||!js.has(x))))return c.flags|=65536,g&=-g,c.lanes|=g,g=Sy(g),Ay(g,i,c,f),hp(c,g),!1}c=c.return}while(c!==null);return!1}var by=Error(n(461)),sn=!1;function mn(i,s,c,f){s.child=i===null?gy(s,null,c,f):dc(s,i.child,c,f)}function ky(i,s,c,f,g){c=c.render;var x=s.ref;if("ref"in f){var R={};for(var U in f)U!=="ref"&&(R[U]=f[U])}else R=f;return el(s),f=xp(i,s,c,R,x,g),U=vp(),i!==null&&!sn?(_p(i,s,g),rs(i,s,g)):(Wt&&U&&ep(s),s.flags|=1,mn(i,s,f,g),s.child)}function Cy(i,s,c,f,g){if(i===null){var x=c.type;return typeof x=="function"&&!Qm(x)&&x.defaultProps===void 0&&c.compare===null?(s.tag=15,s.type=x,Ry(i,s,x,f,g)):(i=J0(c.type,null,f,s,s.mode,g),i.ref=s.ref,i.return=s,s.child=i)}if(x=i.child,!Hp(i,g)){var R=x.memoizedProps;if(c=c.compare,c=c!==null?c:Au,c(R,f)&&i.ref===s.ref)return rs(i,s,g)}return s.flags|=1,i=Yi(x,f),i.ref=s.ref,i.return=s,s.child=i}function Ry(i,s,c,f,g){if(i!==null){var x=i.memoizedProps;if(Au(x,f)&&i.ref===s.ref)if(sn=!1,s.pendingProps=f=x,Hp(i,g))(i.flags&131072)!==0&&(sn=!0);else return s.lanes=i.lanes,rs(i,s,g)}return Pp(i,s,c,f,g)}function Iy(i,s,c){var f=s.pendingProps,g=f.children,x=i!==null?i.memoizedState:null;if(f.mode==="hidden"){if((s.flags&128)!==0){if(f=x!==null?x.baseLanes|c:c,i!==null){for(g=s.child=i.child,x=0;g!==null;)x=x|g.lanes|g.childLanes,g=g.sibling;s.childLanes=x&~f}else s.childLanes=0,s.child=null;return Ny(i,s,f,c)}if((c&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},i!==null&&ah(s,x!==null?x.cachePool:null),x!==null?R_(s,x):mp(),xy(s);else return s.lanes=s.childLanes=536870912,Ny(i,s,x!==null?x.baseLanes|c:c,c)}else x!==null?(ah(s,x.cachePool),R_(s,x),Ps(),s.memoizedState=null):(i!==null&&ah(s,null),mp(),Ps());return mn(i,s,g,c),s.child}function Ny(i,s,c,f){var g=lp();return g=g===null?null:{parent:Qr._currentValue,pool:g},s.memoizedState={baseLanes:c,cachePool:g},i!==null&&ah(s,null),mp(),xy(s),i!==null&&Iu(i,s,f,!0),null}function Eh(i,s){var c=s.ref;if(c===null)i!==null&&i.ref!==null&&(s.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(n(284));(i===null||i.ref!==c)&&(s.flags|=4194816)}}function Pp(i,s,c,f,g){return el(s),c=xp(i,s,c,f,void 0,g),f=vp(),i!==null&&!sn?(_p(i,s,g),rs(i,s,g)):(Wt&&f&&ep(s),s.flags|=1,mn(i,s,c,g),s.child)}function Dy(i,s,c,f,g,x){return el(s),s.updateQueue=null,c=N_(s,f,c,g),I_(i),f=vp(),i!==null&&!sn?(_p(i,s,x),rs(i,s,x)):(Wt&&f&&ep(s),s.flags|=1,mn(i,s,c,x),s.child)}function Oy(i,s,c,f,g){if(el(s),s.stateNode===null){var x=nc,R=c.contextType;typeof R=="object"&&R!==null&&(x=wn(R)),x=new c(f,x),s.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,x.updater=Op,s.stateNode=x,x._reactInternals=s,x=s.stateNode,x.props=f,x.state=s.memoizedState,x.refs={},up(s),R=c.contextType,x.context=typeof R=="object"&&R!==null?wn(R):nc,x.state=s.memoizedState,R=c.getDerivedStateFromProps,typeof R=="function"&&(Dp(s,c,R,f),x.state=s.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(R=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),R!==x.state&&Op.enqueueReplaceState(x,x.state,null),Lu(s,f,x,g),Mu(),x.state=s.memoizedState),typeof x.componentDidMount=="function"&&(s.flags|=4194308),f=!0}else if(i===null){x=s.stateNode;var U=s.memoizedProps,re=nl(c,U);x.props=re;var de=x.context,be=c.contextType;R=nc,typeof be=="object"&&be!==null&&(R=wn(be));var Ie=c.getDerivedStateFromProps;be=typeof Ie=="function"||typeof x.getSnapshotBeforeUpdate=="function",U=s.pendingProps!==U,be||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(U||de!==R)&&_y(s,x,f,R),Is=!1;var ve=s.memoizedState;x.state=ve,Lu(s,f,x,g),Mu(),de=s.memoizedState,U||ve!==de||Is?(typeof Ie=="function"&&(Dp(s,c,Ie,f),de=s.memoizedState),(re=Is||vy(s,c,re,f,ve,de,R))?(be||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(s.flags|=4194308)):(typeof x.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=f,s.memoizedState=de),x.props=f,x.state=de,x.context=R,f=re):(typeof x.componentDidMount=="function"&&(s.flags|=4194308),f=!1)}else{x=s.stateNode,fp(i,s),R=s.memoizedProps,be=nl(c,R),x.props=be,Ie=s.pendingProps,ve=x.context,de=c.contextType,re=nc,typeof de=="object"&&de!==null&&(re=wn(de)),U=c.getDerivedStateFromProps,(de=typeof U=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(R!==Ie||ve!==re)&&_y(s,x,f,re),Is=!1,ve=s.memoizedState,x.state=ve,Lu(s,f,x,g),Mu();var ye=s.memoizedState;R!==Ie||ve!==ye||Is||i!==null&&i.dependencies!==null&&rh(i.dependencies)?(typeof U=="function"&&(Dp(s,c,U,f),ye=s.memoizedState),(be=Is||vy(s,c,be,f,ve,ye,re)||i!==null&&i.dependencies!==null&&rh(i.dependencies))?(de||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(f,ye,re),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(f,ye,re)),typeof x.componentDidUpdate=="function"&&(s.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof x.componentDidUpdate!="function"||R===i.memoizedProps&&ve===i.memoizedState||(s.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||R===i.memoizedProps&&ve===i.memoizedState||(s.flags|=1024),s.memoizedProps=f,s.memoizedState=ye),x.props=f,x.state=ye,x.context=re,f=be):(typeof x.componentDidUpdate!="function"||R===i.memoizedProps&&ve===i.memoizedState||(s.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||R===i.memoizedProps&&ve===i.memoizedState||(s.flags|=1024),f=!1)}return x=f,Eh(i,s),f=(s.flags&128)!==0,x||f?(x=s.stateNode,c=f&&typeof c.getDerivedStateFromError!="function"?null:x.render(),s.flags|=1,i!==null&&f?(s.child=dc(s,i.child,null,g),s.child=dc(s,null,c,g)):mn(i,s,c,g),s.memoizedState=x.state,i=s.child):i=rs(i,s,g),i}function Fy(i,s,c,f){return Cu(),s.flags|=256,mn(i,s,c,f),s.child}var Mp={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Lp(i){return{baseLanes:i,cachePool:E_()}}function Up(i,s,c){return i=i!==null?i.childLanes&~c:0,s&&(i|=Oa),i}function Py(i,s,c){var f=s.pendingProps,g=!1,x=(s.flags&128)!==0,R;if((R=x)||(R=i!==null&&i.memoizedState===null?!1:(Zr.current&2)!==0),R&&(g=!0,s.flags&=-129),R=(s.flags&32)!==0,s.flags&=-33,i===null){if(Wt){if(g?Fs(s):Ps(),Wt){var U=Tr,re;if(re=U){e:{for(re=U,U=xi;re.nodeType!==8;){if(!U){U=null;break e}if(re=Ya(re.nextSibling),re===null){U=null;break e}}U=re}U!==null?(s.memoizedState={dehydrated:U,treeContext:Yo!==null?{id:$i,overflow:Qi}:null,retryLane:536870912,hydrationErrors:null},re=la(18,null,null,0),re.stateNode=U,re.return=s,s.child=re,Hn=s,Tr=null,re=!0):re=!1}re||Zo(s)}if(U=s.memoizedState,U!==null&&(U=U.dehydrated,U!==null))return Eg(U)?s.lanes=32:s.lanes=536870912,null;ts(s)}return U=f.children,f=f.fallback,g?(Ps(),g=s.mode,U=Th({mode:"hidden",children:U},g),f=Ko(f,g,c,null),U.return=s,f.return=s,U.sibling=f,s.child=U,g=s.child,g.memoizedState=Lp(c),g.childLanes=Up(i,R,c),s.memoizedState=Mp,f):(Fs(s),Bp(s,U))}if(re=i.memoizedState,re!==null&&(U=re.dehydrated,U!==null)){if(x)s.flags&256?(Fs(s),s.flags&=-257,s=Vp(i,s,c)):s.memoizedState!==null?(Ps(),s.child=i.child,s.flags|=128,s=null):(Ps(),g=f.fallback,U=s.mode,f=Th({mode:"visible",children:f.children},U),g=Ko(g,U,c,null),g.flags|=2,f.return=s,g.return=s,f.sibling=g,s.child=f,dc(s,i.child,null,c),f=s.child,f.memoizedState=Lp(c),f.childLanes=Up(i,R,c),s.memoizedState=Mp,s=g);else if(Fs(s),Eg(U)){if(R=U.nextSibling&&U.nextSibling.dataset,R)var de=R.dgst;R=de,f=Error(n(419)),f.stack="",f.digest=R,Ru({value:f,source:null,stack:null}),s=Vp(i,s,c)}else if(sn||Iu(i,s,c,!1),R=(c&i.childLanes)!==0,sn||R){if(R=cr,R!==null&&(f=c&-c,f=(f&42)!==0?1:si(f),f=(f&(R.suspendedLanes|c))!==0?0:f,f!==0&&f!==re.retryLane))throw re.retryLane=f,rc(i,f),da(R,i,f),by;U.data==="$?"||ag(),s=Vp(i,s,c)}else U.data==="$?"?(s.flags|=192,s.child=i.child,s=null):(i=re.treeContext,Tr=Ya(U.nextSibling),Hn=s,Wt=!0,Qo=null,xi=!1,i!==null&&(Ia[Na++]=$i,Ia[Na++]=Qi,Ia[Na++]=Yo,$i=i.id,Qi=i.overflow,Yo=s),s=Bp(s,f.children),s.flags|=4096);return s}return g?(Ps(),g=f.fallback,U=s.mode,re=i.child,de=re.sibling,f=Yi(re,{mode:"hidden",children:f.children}),f.subtreeFlags=re.subtreeFlags&65011712,de!==null?g=Yi(de,g):(g=Ko(g,U,c,null),g.flags|=2),g.return=s,f.return=s,f.sibling=g,s.child=f,f=g,g=s.child,U=i.child.memoizedState,U===null?U=Lp(c):(re=U.cachePool,re!==null?(de=Qr._currentValue,re=re.parent!==de?{parent:de,pool:de}:re):re=E_(),U={baseLanes:U.baseLanes|c,cachePool:re}),g.memoizedState=U,g.childLanes=Up(i,R,c),s.memoizedState=Mp,f):(Fs(s),c=i.child,i=c.sibling,c=Yi(c,{mode:"visible",children:f.children}),c.return=s,c.sibling=null,i!==null&&(R=s.deletions,R===null?(s.deletions=[i],s.flags|=16):R.push(i)),s.child=c,s.memoizedState=null,c)}function Bp(i,s){return s=Th({mode:"visible",children:s},i.mode),s.return=i,i.child=s}function Th(i,s){return i=la(22,i,null,s),i.lanes=0,i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},i}function Vp(i,s,c){return dc(s,i.child,null,c),i=Bp(s,s.pendingProps.children),i.flags|=2,s.memoizedState=null,i}function My(i,s,c){i.lanes|=s;var f=i.alternate;f!==null&&(f.lanes|=s),ap(i.return,s,c)}function jp(i,s,c,f,g){var x=i.memoizedState;x===null?i.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:f,tail:c,tailMode:g}:(x.isBackwards=s,x.rendering=null,x.renderingStartTime=0,x.last=f,x.tail=c,x.tailMode=g)}function Ly(i,s,c){var f=s.pendingProps,g=f.revealOrder,x=f.tail;if(mn(i,s,f.children,c),f=Zr.current,(f&2)!==0)f=f&1|2,s.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=s.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&My(i,c,s);else if(i.tag===19)My(i,c,s);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}f&=1}switch(X(Zr,f),g){case"forwards":for(c=s.child,g=null;c!==null;)i=c.alternate,i!==null&&vh(i)===null&&(g=c),c=c.sibling;c=g,c===null?(g=s.child,s.child=null):(g=c.sibling,c.sibling=null),jp(s,!1,g,c,x);break;case"backwards":for(c=null,g=s.child,s.child=null;g!==null;){if(i=g.alternate,i!==null&&vh(i)===null){s.child=g;break}i=g.sibling,g.sibling=c,c=g,g=i}jp(s,!0,c,null,x);break;case"together":jp(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function rs(i,s,c){if(i!==null&&(s.dependencies=i.dependencies),Vs|=s.lanes,(c&s.childLanes)===0)if(i!==null){if(Iu(i,s,c,!1),(c&s.childLanes)===0)return null}else return null;if(i!==null&&s.child!==i.child)throw Error(n(153));if(s.child!==null){for(i=s.child,c=Yi(i,i.pendingProps),s.child=c,c.return=s;i.sibling!==null;)i=i.sibling,c=c.sibling=Yi(i,i.pendingProps),c.return=s;c.sibling=null}return s.child}function Hp(i,s){return(i.lanes&s)!==0?!0:(i=i.dependencies,!!(i!==null&&rh(i)))}function OC(i,s,c){switch(s.tag){case 3:ke(s,s.stateNode.containerInfo),Rs(s,Qr,i.memoizedState.cache),Cu();break;case 27:case 5:_e(s);break;case 4:ke(s,s.stateNode.containerInfo);break;case 10:Rs(s,s.type,s.memoizedProps.value);break;case 13:var f=s.memoizedState;if(f!==null)return f.dehydrated!==null?(Fs(s),s.flags|=128,null):(c&s.child.childLanes)!==0?Py(i,s,c):(Fs(s),i=rs(i,s,c),i!==null?i.sibling:null);Fs(s);break;case 19:var g=(i.flags&128)!==0;if(f=(c&s.childLanes)!==0,f||(Iu(i,s,c,!1),f=(c&s.childLanes)!==0),g){if(f)return Ly(i,s,c);s.flags|=128}if(g=s.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),X(Zr,Zr.current),f)break;return null;case 22:case 23:return s.lanes=0,Iy(i,s,c);case 24:Rs(s,Qr,i.memoizedState.cache)}return rs(i,s,c)}function Uy(i,s,c){if(i!==null)if(i.memoizedProps!==s.pendingProps)sn=!0;else{if(!Hp(i,c)&&(s.flags&128)===0)return sn=!1,OC(i,s,c);sn=(i.flags&131072)!==0}else sn=!1,Wt&&(s.flags&1048576)!==0&&m_(s,th,s.index);switch(s.lanes=0,s.tag){case 16:e:{i=s.pendingProps;var f=s.elementType,g=f._init;if(f=g(f._payload),s.type=f,typeof f=="function")Qm(f)?(i=nl(f,i),s.tag=1,s=Oy(null,s,f,i,c)):(s.tag=0,s=Pp(null,s,f,i,c));else{if(f!=null){if(g=f.$$typeof,g===z){s.tag=11,s=ky(null,s,f,i,c);break e}else if(g===C){s.tag=14,s=Cy(null,s,f,i,c);break e}}throw s=Ee(f)||f,Error(n(306,s,""))}}return s;case 0:return Pp(i,s,s.type,s.pendingProps,c);case 1:return f=s.type,g=nl(f,s.pendingProps),Oy(i,s,f,g,c);case 3:e:{if(ke(s,s.stateNode.containerInfo),i===null)throw Error(n(387));f=s.pendingProps;var x=s.memoizedState;g=x.element,fp(i,s),Lu(s,f,null,c);var R=s.memoizedState;if(f=R.cache,Rs(s,Qr,f),f!==x.cache&&ip(s,[Qr],c,!0),Mu(),f=R.element,x.isDehydrated)if(x={element:f,isDehydrated:!1,cache:R.cache},s.updateQueue.baseState=x,s.memoizedState=x,s.flags&256){s=Fy(i,s,f,c);break e}else if(f!==g){g=Ca(Error(n(424)),s),Ru(g),s=Fy(i,s,f,c);break e}else{switch(i=s.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(Tr=Ya(i.firstChild),Hn=s,Wt=!0,Qo=null,xi=!0,c=gy(s,null,f,c),s.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(Cu(),f===g){s=rs(i,s,c);break e}mn(i,s,f,c)}s=s.child}return s;case 26:return Eh(i,s),i===null?(c=H2(s.type,null,s.pendingProps,null))?s.memoizedState=c:Wt||(c=s.type,i=s.pendingProps,f=Mh(le.current).createElement(c),f[Ir]=s,f[gr]=i,gn(f,c,i),oe(f),s.stateNode=f):s.memoizedState=H2(s.type,i.memoizedProps,s.pendingProps,i.memoizedState),null;case 27:return _e(s),i===null&&Wt&&(f=s.stateNode=B2(s.type,s.pendingProps,le.current),Hn=s,xi=!0,g=Tr,Gs(s.type)?(Tg=g,Tr=Ya(f.firstChild)):Tr=g),mn(i,s,s.pendingProps.children,c),Eh(i,s),i===null&&(s.flags|=4194304),s.child;case 5:return i===null&&Wt&&((g=f=Tr)&&(f=o3(f,s.type,s.pendingProps,xi),f!==null?(s.stateNode=f,Hn=s,Tr=Ya(f.firstChild),xi=!1,g=!0):g=!1),g||Zo(s)),_e(s),g=s.type,x=s.pendingProps,R=i!==null?i.memoizedProps:null,f=x.children,vg(g,x)?f=null:R!==null&&vg(g,R)&&(s.flags|=32),s.memoizedState!==null&&(g=xp(i,s,AC,null,null,c),sf._currentValue=g),Eh(i,s),mn(i,s,f,c),s.child;case 6:return i===null&&Wt&&((i=c=Tr)&&(c=l3(c,s.pendingProps,xi),c!==null?(s.stateNode=c,Hn=s,Tr=null,i=!0):i=!1),i||Zo(s)),null;case 13:return Py(i,s,c);case 4:return ke(s,s.stateNode.containerInfo),f=s.pendingProps,i===null?s.child=dc(s,null,f,c):mn(i,s,f,c),s.child;case 11:return ky(i,s,s.type,s.pendingProps,c);case 7:return mn(i,s,s.pendingProps,c),s.child;case 8:return mn(i,s,s.pendingProps.children,c),s.child;case 12:return mn(i,s,s.pendingProps.children,c),s.child;case 10:return f=s.pendingProps,Rs(s,s.type,f.value),mn(i,s,f.children,c),s.child;case 9:return g=s.type._context,f=s.pendingProps.children,el(s),g=wn(g),f=f(g),s.flags|=1,mn(i,s,f,c),s.child;case 14:return Cy(i,s,s.type,s.pendingProps,c);case 15:return Ry(i,s,s.type,s.pendingProps,c);case 19:return Ly(i,s,c);case 31:return f=s.pendingProps,c=s.mode,f={mode:f.mode,children:f.children},i===null?(c=Th(f,c),c.ref=s.ref,s.child=c,c.return=s,s=c):(c=Yi(i.child,f),c.ref=s.ref,s.child=c,c.return=s,s=c),s;case 22:return Iy(i,s,c);case 24:return el(s),f=wn(Qr),i===null?(g=lp(),g===null&&(g=cr,x=sp(),g.pooledCache=x,x.refCount++,x!==null&&(g.pooledCacheLanes|=c),g=x),s.memoizedState={parent:f,cache:g},up(s),Rs(s,Qr,g)):((i.lanes&c)!==0&&(fp(i,s),Lu(s,null,null,c),Mu()),g=i.memoizedState,x=s.memoizedState,g.parent!==f?(g={parent:f,cache:f},s.memoizedState=g,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=g),Rs(s,Qr,f)):(f=x.cache,Rs(s,Qr,f),f!==g.cache&&ip(s,[Qr],c,!0))),mn(i,s,s.pendingProps.children,c),s.child;case 29:throw s.pendingProps}throw Error(n(156,s.tag))}function ns(i){i.flags|=4}function By(i,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!X2(s)){if(s=Da.current,s!==null&&((Bt&4194048)===Bt?vi!==null:(Bt&62914560)!==Bt&&(Bt&536870912)===0||s!==vi))throw Fu=cp,T_;i.flags|=8192}}function wh(i,s){s!==null&&(i.flags|=4),i.flags&16384&&(s=i.tag!==22?As():536870912,i.lanes|=s,xc|=s)}function Gu(i,s){if(!Wt)switch(i.tailMode){case"hidden":s=i.tail;for(var c=null;s!==null;)s.alternate!==null&&(c=s),s=s.sibling;c===null?i.tail=null:c.sibling=null;break;case"collapsed":c=i.tail;for(var f=null;c!==null;)c.alternate!==null&&(f=c),c=c.sibling;f===null?s||i.tail===null?i.tail=null:i.tail.sibling=null:f.sibling=null}}function vr(i){var s=i.alternate!==null&&i.alternate.child===i.child,c=0,f=0;if(s)for(var g=i.child;g!==null;)c|=g.lanes|g.childLanes,f|=g.subtreeFlags&65011712,f|=g.flags&65011712,g.return=i,g=g.sibling;else for(g=i.child;g!==null;)c|=g.lanes|g.childLanes,f|=g.subtreeFlags,f|=g.flags,g.return=i,g=g.sibling;return i.subtreeFlags|=f,i.childLanes=c,s}function FC(i,s,c){var f=s.pendingProps;switch(tp(s),s.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return vr(s),null;case 1:return vr(s),null;case 3:return c=s.stateNode,f=null,i!==null&&(f=i.memoizedState.cache),s.memoizedState.cache!==f&&(s.flags|=2048),Ji(Qr),Oe(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(i===null||i.child===null)&&(ku(s)?ns(s):i===null||i.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,x_())),vr(s),null;case 26:return c=s.memoizedState,i===null?(ns(s),c!==null?(vr(s),By(s,c)):(vr(s),s.flags&=-16777217)):c?c!==i.memoizedState?(ns(s),vr(s),By(s,c)):(vr(s),s.flags&=-16777217):(i.memoizedProps!==f&&ns(s),vr(s),s.flags&=-16777217),null;case 27:Be(s),c=le.current;var g=s.type;if(i!==null&&s.stateNode!=null)i.memoizedProps!==f&&ns(s);else{if(!f){if(s.stateNode===null)throw Error(n(166));return vr(s),null}i=ee.current,ku(s)?p_(s):(i=B2(g,f,c),s.stateNode=i,ns(s))}return vr(s),null;case 5:if(Be(s),c=s.type,i!==null&&s.stateNode!=null)i.memoizedProps!==f&&ns(s);else{if(!f){if(s.stateNode===null)throw Error(n(166));return vr(s),null}if(i=ee.current,ku(s))p_(s);else{switch(g=Mh(le.current),i){case 1:i=g.createElementNS("http://www.w3.org/2000/svg",c);break;case 2:i=g.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;default:switch(c){case"svg":i=g.createElementNS("http://www.w3.org/2000/svg",c);break;case"math":i=g.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;case"script":i=g.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild);break;case"select":i=typeof f.is=="string"?g.createElement("select",{is:f.is}):g.createElement("select"),f.multiple?i.multiple=!0:f.size&&(i.size=f.size);break;default:i=typeof f.is=="string"?g.createElement(c,{is:f.is}):g.createElement(c)}}i[Ir]=s,i[gr]=f;e:for(g=s.child;g!==null;){if(g.tag===5||g.tag===6)i.appendChild(g.stateNode);else if(g.tag!==4&&g.tag!==27&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===s)break e;for(;g.sibling===null;){if(g.return===null||g.return===s)break e;g=g.return}g.sibling.return=g.return,g=g.sibling}s.stateNode=i;e:switch(gn(i,c,f),c){case"button":case"input":case"select":case"textarea":i=!!f.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&ns(s)}}return vr(s),s.flags&=-16777217,null;case 6:if(i&&s.stateNode!=null)i.memoizedProps!==f&&ns(s);else{if(typeof f!="string"&&s.stateNode===null)throw Error(n(166));if(i=le.current,ku(s)){if(i=s.stateNode,c=s.memoizedProps,f=null,g=Hn,g!==null)switch(g.tag){case 27:case 5:f=g.memoizedProps}i[Ir]=s,i=!!(i.nodeValue===c||f!==null&&f.suppressHydrationWarning===!0||D2(i.nodeValue,c)),i||Zo(s)}else i=Mh(i).createTextNode(f),i[Ir]=s,s.stateNode=i}return vr(s),null;case 13:if(f=s.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(g=ku(s),f!==null&&f.dehydrated!==null){if(i===null){if(!g)throw Error(n(318));if(g=s.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(n(317));g[Ir]=s}else Cu(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;vr(s),g=!1}else g=x_(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=g),g=!0;if(!g)return s.flags&256?(ts(s),s):(ts(s),null)}if(ts(s),(s.flags&128)!==0)return s.lanes=c,s;if(c=f!==null,i=i!==null&&i.memoizedState!==null,c){f=s.child,g=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(g=f.alternate.memoizedState.cachePool.pool);var x=null;f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(x=f.memoizedState.cachePool.pool),x!==g&&(f.flags|=2048)}return c!==i&&c&&(s.child.flags|=8192),wh(s,s.updateQueue),vr(s),null;case 4:return Oe(),i===null&&dg(s.stateNode.containerInfo),vr(s),null;case 10:return Ji(s.type),vr(s),null;case 19:if(V(Zr),g=s.memoizedState,g===null)return vr(s),null;if(f=(s.flags&128)!==0,x=g.rendering,x===null)if(f)Gu(g,!1);else{if(wr!==0||i!==null&&(i.flags&128)!==0)for(i=s.child;i!==null;){if(x=vh(i),x!==null){for(s.flags|=128,Gu(g,!1),i=x.updateQueue,s.updateQueue=i,wh(s,i),s.subtreeFlags=0,i=c,c=s.child;c!==null;)d_(c,i),c=c.sibling;return X(Zr,Zr.current&1|2),s.child}i=i.sibling}g.tail!==null&&Le()>bh&&(s.flags|=128,f=!0,Gu(g,!1),s.lanes=4194304)}else{if(!f)if(i=vh(x),i!==null){if(s.flags|=128,f=!0,i=i.updateQueue,s.updateQueue=i,wh(s,i),Gu(g,!0),g.tail===null&&g.tailMode==="hidden"&&!x.alternate&&!Wt)return vr(s),null}else 2*Le()-g.renderingStartTime>bh&&c!==536870912&&(s.flags|=128,f=!0,Gu(g,!1),s.lanes=4194304);g.isBackwards?(x.sibling=s.child,s.child=x):(i=g.last,i!==null?i.sibling=x:s.child=x,g.last=x)}return g.tail!==null?(s=g.tail,g.rendering=s,g.tail=s.sibling,g.renderingStartTime=Le(),s.sibling=null,i=Zr.current,X(Zr,f?i&1|2:i&1),s):(vr(s),null);case 22:case 23:return ts(s),pp(),f=s.memoizedState!==null,i!==null?i.memoizedState!==null!==f&&(s.flags|=8192):f&&(s.flags|=8192),f?(c&536870912)!==0&&(s.flags&128)===0&&(vr(s),s.subtreeFlags&6&&(s.flags|=8192)):vr(s),c=s.updateQueue,c!==null&&wh(s,c.retryQueue),c=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),f=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(f=s.memoizedState.cachePool.pool),f!==c&&(s.flags|=2048),i!==null&&V(tl),null;case 24:return c=null,i!==null&&(c=i.memoizedState.cache),s.memoizedState.cache!==c&&(s.flags|=2048),Ji(Qr),vr(s),null;case 25:return null;case 30:return null}throw Error(n(156,s.tag))}function PC(i,s){switch(tp(s),s.tag){case 1:return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 3:return Ji(Qr),Oe(),i=s.flags,(i&65536)!==0&&(i&128)===0?(s.flags=i&-65537|128,s):null;case 26:case 27:case 5:return Be(s),null;case 13:if(ts(s),i=s.memoizedState,i!==null&&i.dehydrated!==null){if(s.alternate===null)throw Error(n(340));Cu()}return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 19:return V(Zr),null;case 4:return Oe(),null;case 10:return Ji(s.type),null;case 22:case 23:return ts(s),pp(),i!==null&&V(tl),i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 24:return Ji(Qr),null;case 25:return null;default:return null}}function Vy(i,s){switch(tp(s),s.tag){case 3:Ji(Qr),Oe();break;case 26:case 27:case 5:Be(s);break;case 4:Oe();break;case 13:ts(s);break;case 19:V(Zr);break;case 10:Ji(s.type);break;case 22:case 23:ts(s),pp(),i!==null&&V(tl);break;case 24:Ji(Qr)}}function qu(i,s){try{var c=s.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var g=f.next;c=g;do{if((c.tag&i)===i){f=void 0;var x=c.create,R=c.inst;f=x(),R.destroy=f}c=c.next}while(c!==g)}}catch(U){or(s,s.return,U)}}function Ms(i,s,c){try{var f=s.updateQueue,g=f!==null?f.lastEffect:null;if(g!==null){var x=g.next;f=x;do{if((f.tag&i)===i){var R=f.inst,U=R.destroy;if(U!==void 0){R.destroy=void 0,g=s;var re=c,de=U;try{de()}catch(be){or(g,re,be)}}}f=f.next}while(f!==x)}}catch(be){or(s,s.return,be)}}function jy(i){var s=i.updateQueue;if(s!==null){var c=i.stateNode;try{C_(s,c)}catch(f){or(i,i.return,f)}}}function Hy(i,s,c){c.props=nl(i.type,i.memoizedProps),c.state=i.memoizedState;try{c.componentWillUnmount()}catch(f){or(i,s,f)}}function Wu(i,s){try{var c=i.ref;if(c!==null){switch(i.tag){case 26:case 27:case 5:var f=i.stateNode;break;case 30:f=i.stateNode;break;default:f=i.stateNode}typeof c=="function"?i.refCleanup=c(f):c.current=f}}catch(g){or(i,s,g)}}function _i(i,s){var c=i.ref,f=i.refCleanup;if(c!==null)if(typeof f=="function")try{f()}catch(g){or(i,s,g)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(g){or(i,s,g)}else c.current=null}function zy(i){var s=i.type,c=i.memoizedProps,f=i.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":c.autoFocus&&f.focus();break e;case"img":c.src?f.src=c.src:c.srcSet&&(f.srcset=c.srcSet)}}catch(g){or(i,i.return,g)}}function zp(i,s,c){try{var f=i.stateNode;r3(f,i.type,c,s),f[gr]=s}catch(g){or(i,i.return,g)}}function Gy(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&Gs(i.type)||i.tag===4}function Gp(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||Gy(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&Gs(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function qp(i,s,c){var f=i.tag;if(f===5||f===6)i=i.stateNode,s?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(i,s):(s=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,s.appendChild(i),c=c._reactRootContainer,c!=null||s.onclick!==null||(s.onclick=Ph));else if(f!==4&&(f===27&&Gs(i.type)&&(c=i.stateNode,s=null),i=i.child,i!==null))for(qp(i,s,c),i=i.sibling;i!==null;)qp(i,s,c),i=i.sibling}function Sh(i,s,c){var f=i.tag;if(f===5||f===6)i=i.stateNode,s?c.insertBefore(i,s):c.appendChild(i);else if(f!==4&&(f===27&&Gs(i.type)&&(c=i.stateNode),i=i.child,i!==null))for(Sh(i,s,c),i=i.sibling;i!==null;)Sh(i,s,c),i=i.sibling}function qy(i){var s=i.stateNode,c=i.memoizedProps;try{for(var f=i.type,g=s.attributes;g.length;)s.removeAttributeNode(g[0]);gn(s,f,c),s[Ir]=i,s[gr]=c}catch(x){or(i,i.return,x)}}var as=!1,Dr=!1,Wp=!1,Wy=typeof WeakSet=="function"?WeakSet:Set,on=null;function MC(i,s){if(i=i.containerInfo,gg=Hh,i=n_(i),Gm(i)){if("selectionStart"in i)var c={start:i.selectionStart,end:i.selectionEnd};else e:{c=(c=i.ownerDocument)&&c.defaultView||window;var f=c.getSelection&&c.getSelection();if(f&&f.rangeCount!==0){c=f.anchorNode;var g=f.anchorOffset,x=f.focusNode;f=f.focusOffset;try{c.nodeType,x.nodeType}catch{c=null;break e}var R=0,U=-1,re=-1,de=0,be=0,Ie=i,ve=null;t:for(;;){for(var ye;Ie!==c||g!==0&&Ie.nodeType!==3||(U=R+g),Ie!==x||f!==0&&Ie.nodeType!==3||(re=R+f),Ie.nodeType===3&&(R+=Ie.nodeValue.length),(ye=Ie.firstChild)!==null;)ve=Ie,Ie=ye;for(;;){if(Ie===i)break t;if(ve===c&&++de===g&&(U=R),ve===x&&++be===f&&(re=R),(ye=Ie.nextSibling)!==null)break;Ie=ve,ve=Ie.parentNode}Ie=ye}c=U===-1||re===-1?null:{start:U,end:re}}else c=null}c=c||{start:0,end:0}}else c=null;for(xg={focusedElem:i,selectionRange:c},Hh=!1,on=s;on!==null;)if(s=on,i=s.child,(s.subtreeFlags&1024)!==0&&i!==null)i.return=s,on=i;else for(;on!==null;){switch(s=on,x=s.alternate,i=s.flags,s.tag){case 0:break;case 11:case 15:break;case 1:if((i&1024)!==0&&x!==null){i=void 0,c=s,g=x.memoizedProps,x=x.memoizedState,f=c.stateNode;try{var ht=nl(c.type,g,c.elementType===c.type);i=f.getSnapshotBeforeUpdate(ht,x),f.__reactInternalSnapshotBeforeUpdate=i}catch(rt){or(c,c.return,rt)}}break;case 3:if((i&1024)!==0){if(i=s.stateNode.containerInfo,c=i.nodeType,c===9)yg(i);else if(c===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":yg(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(n(163))}if(i=s.sibling,i!==null){i.return=s.return,on=i;break}on=s.return}}function Xy(i,s,c){var f=c.flags;switch(c.tag){case 0:case 11:case 15:Ls(i,c),f&4&&qu(5,c);break;case 1:if(Ls(i,c),f&4)if(i=c.stateNode,s===null)try{i.componentDidMount()}catch(R){or(c,c.return,R)}else{var g=nl(c.type,s.memoizedProps);s=s.memoizedState;try{i.componentDidUpdate(g,s,i.__reactInternalSnapshotBeforeUpdate)}catch(R){or(c,c.return,R)}}f&64&&jy(c),f&512&&Wu(c,c.return);break;case 3:if(Ls(i,c),f&64&&(i=c.updateQueue,i!==null)){if(s=null,c.child!==null)switch(c.child.tag){case 27:case 5:s=c.child.stateNode;break;case 1:s=c.child.stateNode}try{C_(i,s)}catch(R){or(c,c.return,R)}}break;case 27:s===null&&f&4&&qy(c);case 26:case 5:Ls(i,c),s===null&&f&4&&zy(c),f&512&&Wu(c,c.return);break;case 12:Ls(i,c);break;case 13:Ls(i,c),f&4&&$y(i,c),f&64&&(i=c.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(c=qC.bind(null,c),c3(i,c))));break;case 22:if(f=c.memoizedState!==null||as,!f){s=s!==null&&s.memoizedState!==null||Dr,g=as;var x=Dr;as=f,(Dr=s)&&!x?Us(i,c,(c.subtreeFlags&8772)!==0):Ls(i,c),as=g,Dr=x}break;case 30:break;default:Ls(i,c)}}function Ky(i){var s=i.alternate;s!==null&&(i.alternate=null,Ky(s)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(s=i.stateNode,s!==null&&G(s)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var xr=null,Zn=!1;function is(i,s,c){for(c=c.child;c!==null;)Yy(i,s,c),c=c.sibling}function Yy(i,s,c){if(vt&&typeof vt.onCommitFiberUnmount=="function")try{vt.onCommitFiberUnmount(mt,c)}catch{}switch(c.tag){case 26:Dr||_i(c,s),is(i,s,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:Dr||_i(c,s);var f=xr,g=Zn;Gs(c.type)&&(xr=c.stateNode,Zn=!1),is(i,s,c),tf(c.stateNode),xr=f,Zn=g;break;case 5:Dr||_i(c,s);case 6:if(f=xr,g=Zn,xr=null,is(i,s,c),xr=f,Zn=g,xr!==null)if(Zn)try{(xr.nodeType===9?xr.body:xr.nodeName==="HTML"?xr.ownerDocument.body:xr).removeChild(c.stateNode)}catch(x){or(c,s,x)}else try{xr.removeChild(c.stateNode)}catch(x){or(c,s,x)}break;case 18:xr!==null&&(Zn?(i=xr,L2(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,c.stateNode),uf(i)):L2(xr,c.stateNode));break;case 4:f=xr,g=Zn,xr=c.stateNode.containerInfo,Zn=!0,is(i,s,c),xr=f,Zn=g;break;case 0:case 11:case 14:case 15:Dr||Ms(2,c,s),Dr||Ms(4,c,s),is(i,s,c);break;case 1:Dr||(_i(c,s),f=c.stateNode,typeof f.componentWillUnmount=="function"&&Hy(c,s,f)),is(i,s,c);break;case 21:is(i,s,c);break;case 22:Dr=(f=Dr)||c.memoizedState!==null,is(i,s,c),Dr=f;break;default:is(i,s,c)}}function $y(i,s){if(s.memoizedState===null&&(i=s.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{uf(i)}catch(c){or(s,s.return,c)}}function LC(i){switch(i.tag){case 13:case 19:var s=i.stateNode;return s===null&&(s=i.stateNode=new Wy),s;case 22:return i=i.stateNode,s=i._retryCache,s===null&&(s=i._retryCache=new Wy),s;default:throw Error(n(435,i.tag))}}function Xp(i,s){var c=LC(i);s.forEach(function(f){var g=WC.bind(null,i,f);c.has(f)||(c.add(f),f.then(g,g))})}function ca(i,s){var c=s.deletions;if(c!==null)for(var f=0;f<c.length;f++){var g=c[f],x=i,R=s,U=R;e:for(;U!==null;){switch(U.tag){case 27:if(Gs(U.type)){xr=U.stateNode,Zn=!1;break e}break;case 5:xr=U.stateNode,Zn=!1;break e;case 3:case 4:xr=U.stateNode.containerInfo,Zn=!0;break e}U=U.return}if(xr===null)throw Error(n(160));Yy(x,R,g),xr=null,Zn=!1,x=g.alternate,x!==null&&(x.return=null),g.return=null}if(s.subtreeFlags&13878)for(s=s.child;s!==null;)Qy(s,i),s=s.sibling}var Ka=null;function Qy(i,s){var c=i.alternate,f=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:ca(s,i),ua(i),f&4&&(Ms(3,i,i.return),qu(3,i),Ms(5,i,i.return));break;case 1:ca(s,i),ua(i),f&512&&(Dr||c===null||_i(c,c.return)),f&64&&as&&(i=i.updateQueue,i!==null&&(f=i.callbacks,f!==null&&(c=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=c===null?f:c.concat(f))));break;case 26:var g=Ka;if(ca(s,i),ua(i),f&512&&(Dr||c===null||_i(c,c.return)),f&4){var x=c!==null?c.memoizedState:null;if(f=i.memoizedState,c===null)if(f===null)if(i.stateNode===null){e:{f=i.type,c=i.memoizedProps,g=g.ownerDocument||g;t:switch(f){case"title":x=g.getElementsByTagName("title")[0],(!x||x[H]||x[Ir]||x.namespaceURI==="http://www.w3.org/2000/svg"||x.hasAttribute("itemprop"))&&(x=g.createElement(f),g.head.insertBefore(x,g.querySelector("head > title"))),gn(x,f,c),x[Ir]=i,oe(x),f=x;break e;case"link":var R=q2("link","href",g).get(f+(c.href||""));if(R){for(var U=0;U<R.length;U++)if(x=R[U],x.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&x.getAttribute("rel")===(c.rel==null?null:c.rel)&&x.getAttribute("title")===(c.title==null?null:c.title)&&x.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){R.splice(U,1);break t}}x=g.createElement(f),gn(x,f,c),g.head.appendChild(x);break;case"meta":if(R=q2("meta","content",g).get(f+(c.content||""))){for(U=0;U<R.length;U++)if(x=R[U],x.getAttribute("content")===(c.content==null?null:""+c.content)&&x.getAttribute("name")===(c.name==null?null:c.name)&&x.getAttribute("property")===(c.property==null?null:c.property)&&x.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&x.getAttribute("charset")===(c.charSet==null?null:c.charSet)){R.splice(U,1);break t}}x=g.createElement(f),gn(x,f,c),g.head.appendChild(x);break;default:throw Error(n(468,f))}x[Ir]=i,oe(x),f=x}i.stateNode=f}else W2(g,i.type,i.stateNode);else i.stateNode=G2(g,f,i.memoizedProps);else x!==f?(x===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):x.count--,f===null?W2(g,i.type,i.stateNode):G2(g,f,i.memoizedProps)):f===null&&i.stateNode!==null&&zp(i,i.memoizedProps,c.memoizedProps)}break;case 27:ca(s,i),ua(i),f&512&&(Dr||c===null||_i(c,c.return)),c!==null&&f&4&&zp(i,i.memoizedProps,c.memoizedProps);break;case 5:if(ca(s,i),ua(i),f&512&&(Dr||c===null||_i(c,c.return)),i.flags&32){g=i.stateNode;try{Sa(g,"")}catch(ye){or(i,i.return,ye)}}f&4&&i.stateNode!=null&&(g=i.memoizedProps,zp(i,g,c!==null?c.memoizedProps:g)),f&1024&&(Wp=!0);break;case 6:if(ca(s,i),ua(i),f&4){if(i.stateNode===null)throw Error(n(162));f=i.memoizedProps,c=i.stateNode;try{c.nodeValue=f}catch(ye){or(i,i.return,ye)}}break;case 3:if(Bh=null,g=Ka,Ka=Lh(s.containerInfo),ca(s,i),Ka=g,ua(i),f&4&&c!==null&&c.memoizedState.isDehydrated)try{uf(s.containerInfo)}catch(ye){or(i,i.return,ye)}Wp&&(Wp=!1,Zy(i));break;case 4:f=Ka,Ka=Lh(i.stateNode.containerInfo),ca(s,i),ua(i),Ka=f;break;case 12:ca(s,i),ua(i);break;case 13:ca(s,i),ua(i),i.child.flags&8192&&i.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(Jp=Le()),f&4&&(f=i.updateQueue,f!==null&&(i.updateQueue=null,Xp(i,f)));break;case 22:g=i.memoizedState!==null;var re=c!==null&&c.memoizedState!==null,de=as,be=Dr;if(as=de||g,Dr=be||re,ca(s,i),Dr=be,as=de,ua(i),f&8192)e:for(s=i.stateNode,s._visibility=g?s._visibility&-2:s._visibility|1,g&&(c===null||re||as||Dr||al(i)),c=null,s=i;;){if(s.tag===5||s.tag===26){if(c===null){re=c=s;try{if(x=re.stateNode,g)R=x.style,typeof R.setProperty=="function"?R.setProperty("display","none","important"):R.display="none";else{U=re.stateNode;var Ie=re.memoizedProps.style,ve=Ie!=null&&Ie.hasOwnProperty("display")?Ie.display:null;U.style.display=ve==null||typeof ve=="boolean"?"":(""+ve).trim()}}catch(ye){or(re,re.return,ye)}}}else if(s.tag===6){if(c===null){re=s;try{re.stateNode.nodeValue=g?"":re.memoizedProps}catch(ye){or(re,re.return,ye)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===i)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;c===s&&(c=null),s=s.return}c===s&&(c=null),s.sibling.return=s.return,s=s.sibling}f&4&&(f=i.updateQueue,f!==null&&(c=f.retryQueue,c!==null&&(f.retryQueue=null,Xp(i,c))));break;case 19:ca(s,i),ua(i),f&4&&(f=i.updateQueue,f!==null&&(i.updateQueue=null,Xp(i,f)));break;case 30:break;case 21:break;default:ca(s,i),ua(i)}}function ua(i){var s=i.flags;if(s&2){try{for(var c,f=i.return;f!==null;){if(Gy(f)){c=f;break}f=f.return}if(c==null)throw Error(n(160));switch(c.tag){case 27:var g=c.stateNode,x=Gp(i);Sh(i,x,g);break;case 5:var R=c.stateNode;c.flags&32&&(Sa(R,""),c.flags&=-33);var U=Gp(i);Sh(i,U,R);break;case 3:case 4:var re=c.stateNode.containerInfo,de=Gp(i);qp(i,de,re);break;default:throw Error(n(161))}}catch(be){or(i,i.return,be)}i.flags&=-3}s&4096&&(i.flags&=-4097)}function Zy(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var s=i;Zy(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),i=i.sibling}}function Ls(i,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)Xy(i,s.alternate,s),s=s.sibling}function al(i){for(i=i.child;i!==null;){var s=i;switch(s.tag){case 0:case 11:case 14:case 15:Ms(4,s,s.return),al(s);break;case 1:_i(s,s.return);var c=s.stateNode;typeof c.componentWillUnmount=="function"&&Hy(s,s.return,c),al(s);break;case 27:tf(s.stateNode);case 26:case 5:_i(s,s.return),al(s);break;case 22:s.memoizedState===null&&al(s);break;case 30:al(s);break;default:al(s)}i=i.sibling}}function Us(i,s,c){for(c=c&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var f=s.alternate,g=i,x=s,R=x.flags;switch(x.tag){case 0:case 11:case 15:Us(g,x,c),qu(4,x);break;case 1:if(Us(g,x,c),f=x,g=f.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(de){or(f,f.return,de)}if(f=x,g=f.updateQueue,g!==null){var U=f.stateNode;try{var re=g.shared.hiddenCallbacks;if(re!==null)for(g.shared.hiddenCallbacks=null,g=0;g<re.length;g++)k_(re[g],U)}catch(de){or(f,f.return,de)}}c&&R&64&&jy(x),Wu(x,x.return);break;case 27:qy(x);case 26:case 5:Us(g,x,c),c&&f===null&&R&4&&zy(x),Wu(x,x.return);break;case 12:Us(g,x,c);break;case 13:Us(g,x,c),c&&R&4&&$y(g,x);break;case 22:x.memoizedState===null&&Us(g,x,c),Wu(x,x.return);break;case 30:break;default:Us(g,x,c)}s=s.sibling}}function Kp(i,s){var c=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),i=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(i=s.memoizedState.cachePool.pool),i!==c&&(i!=null&&i.refCount++,c!=null&&Nu(c))}function Yp(i,s){i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&Nu(i))}function yi(i,s,c,f){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Jy(i,s,c,f),s=s.sibling}function Jy(i,s,c,f){var g=s.flags;switch(s.tag){case 0:case 11:case 15:yi(i,s,c,f),g&2048&&qu(9,s);break;case 1:yi(i,s,c,f);break;case 3:yi(i,s,c,f),g&2048&&(i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&Nu(i)));break;case 12:if(g&2048){yi(i,s,c,f),i=s.stateNode;try{var x=s.memoizedProps,R=x.id,U=x.onPostCommit;typeof U=="function"&&U(R,s.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(re){or(s,s.return,re)}}else yi(i,s,c,f);break;case 13:yi(i,s,c,f);break;case 23:break;case 22:x=s.stateNode,R=s.alternate,s.memoizedState!==null?x._visibility&2?yi(i,s,c,f):Xu(i,s):x._visibility&2?yi(i,s,c,f):(x._visibility|=2,mc(i,s,c,f,(s.subtreeFlags&10256)!==0)),g&2048&&Kp(R,s);break;case 24:yi(i,s,c,f),g&2048&&Yp(s.alternate,s);break;default:yi(i,s,c,f)}}function mc(i,s,c,f,g){for(g=g&&(s.subtreeFlags&10256)!==0,s=s.child;s!==null;){var x=i,R=s,U=c,re=f,de=R.flags;switch(R.tag){case 0:case 11:case 15:mc(x,R,U,re,g),qu(8,R);break;case 23:break;case 22:var be=R.stateNode;R.memoizedState!==null?be._visibility&2?mc(x,R,U,re,g):Xu(x,R):(be._visibility|=2,mc(x,R,U,re,g)),g&&de&2048&&Kp(R.alternate,R);break;case 24:mc(x,R,U,re,g),g&&de&2048&&Yp(R.alternate,R);break;default:mc(x,R,U,re,g)}s=s.sibling}}function Xu(i,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var c=i,f=s,g=f.flags;switch(f.tag){case 22:Xu(c,f),g&2048&&Kp(f.alternate,f);break;case 24:Xu(c,f),g&2048&&Yp(f.alternate,f);break;default:Xu(c,f)}s=s.sibling}}var Ku=8192;function pc(i){if(i.subtreeFlags&Ku)for(i=i.child;i!==null;)e2(i),i=i.sibling}function e2(i){switch(i.tag){case 26:pc(i),i.flags&Ku&&i.memoizedState!==null&&T3(Ka,i.memoizedState,i.memoizedProps);break;case 5:pc(i);break;case 3:case 4:var s=Ka;Ka=Lh(i.stateNode.containerInfo),pc(i),Ka=s;break;case 22:i.memoizedState===null&&(s=i.alternate,s!==null&&s.memoizedState!==null?(s=Ku,Ku=16777216,pc(i),Ku=s):pc(i));break;default:pc(i)}}function t2(i){var s=i.alternate;if(s!==null&&(i=s.child,i!==null)){s.child=null;do s=i.sibling,i.sibling=null,i=s;while(i!==null)}}function Yu(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var c=0;c<s.length;c++){var f=s[c];on=f,n2(f,i)}t2(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)r2(i),i=i.sibling}function r2(i){switch(i.tag){case 0:case 11:case 15:Yu(i),i.flags&2048&&Ms(9,i,i.return);break;case 3:Yu(i);break;case 12:Yu(i);break;case 22:var s=i.stateNode;i.memoizedState!==null&&s._visibility&2&&(i.return===null||i.return.tag!==13)?(s._visibility&=-3,Ah(i)):Yu(i);break;default:Yu(i)}}function Ah(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var c=0;c<s.length;c++){var f=s[c];on=f,n2(f,i)}t2(i)}for(i=i.child;i!==null;){switch(s=i,s.tag){case 0:case 11:case 15:Ms(8,s,s.return),Ah(s);break;case 22:c=s.stateNode,c._visibility&2&&(c._visibility&=-3,Ah(s));break;default:Ah(s)}i=i.sibling}}function n2(i,s){for(;on!==null;){var c=on;switch(c.tag){case 0:case 11:case 15:Ms(8,c,s);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var f=c.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:Nu(c.memoizedState.cache)}if(f=c.child,f!==null)f.return=c,on=f;else e:for(c=i;on!==null;){f=on;var g=f.sibling,x=f.return;if(Ky(f),f===c){on=null;break e}if(g!==null){g.return=x,on=g;break e}on=x}}}var UC={getCacheForType:function(i){var s=wn(Qr),c=s.data.get(i);return c===void 0&&(c=i(),s.data.set(i,c)),c}},BC=typeof WeakMap=="function"?WeakMap:Map,Yt=0,cr=null,Rt=null,Bt=0,$t=0,fa=null,Bs=!1,gc=!1,$p=!1,ss=0,wr=0,Vs=0,il=0,Qp=0,Oa=0,xc=0,$u=null,Jn=null,Zp=!1,Jp=0,bh=1/0,kh=null,js=null,pn=0,Hs=null,vc=null,_c=0,eg=0,tg=null,a2=null,Qu=0,rg=null;function ha(){if((Yt&2)!==0&&Bt!==0)return Bt&-Bt;if(ne.T!==null){var i=sc;return i!==0?i:cg()}return oi()}function i2(){Oa===0&&(Oa=(Bt&536870912)===0||Wt?Ss():536870912);var i=Da.current;return i!==null&&(i.flags|=32),Oa}function da(i,s,c){(i===cr&&($t===2||$t===9)||i.cancelPendingCommit!==null)&&(yc(i,0),zs(i,Bt,Oa,!1)),qa(i,c),((Yt&2)===0||i!==cr)&&(i===cr&&((Yt&2)===0&&(il|=c),wr===4&&zs(i,Bt,Oa,!1)),Ei(i))}function s2(i,s,c){if((Yt&6)!==0)throw Error(n(327));var f=!c&&(s&124)===0&&(s&i.expiredLanes)===0||ji(i,s),g=f?HC(i,s):ig(i,s,!0),x=f;do{if(g===0){gc&&!f&&zs(i,s,0,!1);break}else{if(c=i.current.alternate,x&&!VC(c)){g=ig(i,s,!1),x=!1;continue}if(g===2){if(x=s,i.errorRecoveryDisabledLanes&x)var R=0;else R=i.pendingLanes&-536870913,R=R!==0?R:R&536870912?536870912:0;if(R!==0){s=R;e:{var U=i;g=$u;var re=U.current.memoizedState.isDehydrated;if(re&&(yc(U,R).flags|=256),R=ig(U,R,!1),R!==2){if($p&&!re){U.errorRecoveryDisabledLanes|=x,il|=x,g=4;break e}x=Jn,Jn=g,x!==null&&(Jn===null?Jn=x:Jn.push.apply(Jn,x))}g=R}if(x=!1,g!==2)continue}}if(g===1){yc(i,0),zs(i,s,0,!0);break}e:{switch(f=i,x=g,x){case 0:case 1:throw Error(n(345));case 4:if((s&4194048)!==s)break;case 6:zs(f,s,Oa,!Bs);break e;case 2:Jn=null;break;case 3:case 5:break;default:throw Error(n(329))}if((s&62914560)===s&&(g=Jp+300-Le(),10<g)){if(zs(f,s,Oa,!Bs),Ts(f,0,!0)!==0)break e;f.timeoutHandle=P2(o2.bind(null,f,c,Jn,kh,Zp,s,Oa,il,xc,Bs,x,2,-0,0),g);break e}o2(f,c,Jn,kh,Zp,s,Oa,il,xc,Bs,x,0,-0,0)}}break}while(!0);Ei(i)}function o2(i,s,c,f,g,x,R,U,re,de,be,Ie,ve,ye){if(i.timeoutHandle=-1,Ie=s.subtreeFlags,(Ie&8192||(Ie&16785408)===16785408)&&(af={stylesheets:null,count:0,unsuspend:E3},e2(s),Ie=w3(),Ie!==null)){i.cancelPendingCommit=Ie(m2.bind(null,i,s,x,c,f,g,R,U,re,be,1,ve,ye)),zs(i,x,R,!de);return}m2(i,s,x,c,f,g,R,U,re)}function VC(i){for(var s=i;;){var c=s.tag;if((c===0||c===11||c===15)&&s.flags&16384&&(c=s.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var f=0;f<c.length;f++){var g=c[f],x=g.getSnapshot;g=g.value;try{if(!oa(x(),g))return!1}catch{return!1}}if(c=s.child,s.subtreeFlags&16384&&c!==null)c.return=s,s=c;else{if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function zs(i,s,c,f){s&=~Qp,s&=~il,i.suspendedLanes|=s,i.pingedLanes&=~s,f&&(i.warmLanes|=s),f=i.expirationTimes;for(var g=s;0<g;){var x=31-Ft(g),R=1<<x;f[x]=-1,g&=~R}c!==0&&wa(i,c,s)}function Ch(){return(Yt&6)===0?(Zu(0),!1):!0}function ng(){if(Rt!==null){if($t===0)var i=Rt.return;else i=Rt,Zi=Jo=null,yp(i),hc=null,Hu=0,i=Rt;for(;i!==null;)Vy(i.alternate,i),i=i.return;Rt=null}}function yc(i,s){var c=i.timeoutHandle;c!==-1&&(i.timeoutHandle=-1,a3(c)),c=i.cancelPendingCommit,c!==null&&(i.cancelPendingCommit=null,c()),ng(),cr=i,Rt=c=Yi(i.current,null),Bt=s,$t=0,fa=null,Bs=!1,gc=ji(i,s),$p=!1,xc=Oa=Qp=il=Vs=wr=0,Jn=$u=null,Zp=!1,(s&8)!==0&&(s|=s&32);var f=i.entangledLanes;if(f!==0)for(i=i.entanglements,f&=s;0<f;){var g=31-Ft(f),x=1<<g;s|=i[g],f&=~x}return ss=s,$0(),c}function l2(i,s){St=null,ne.H=ph,s===Ou||s===ih?(s=A_(),$t=3):s===T_?(s=A_(),$t=4):$t=s===by?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,fa=s,Rt===null&&(wr=1,yh(i,Ca(s,i.current)))}function c2(){var i=ne.H;return ne.H=ph,i===null?ph:i}function u2(){var i=ne.A;return ne.A=UC,i}function ag(){wr=4,Bs||(Bt&4194048)!==Bt&&Da.current!==null||(gc=!0),(Vs&134217727)===0&&(il&134217727)===0||cr===null||zs(cr,Bt,Oa,!1)}function ig(i,s,c){var f=Yt;Yt|=2;var g=c2(),x=u2();(cr!==i||Bt!==s)&&(kh=null,yc(i,s)),s=!1;var R=wr;e:do try{if($t!==0&&Rt!==null){var U=Rt,re=fa;switch($t){case 8:ng(),R=6;break e;case 3:case 2:case 9:case 6:Da.current===null&&(s=!0);var de=$t;if($t=0,fa=null,Ec(i,U,re,de),c&&gc){R=0;break e}break;default:de=$t,$t=0,fa=null,Ec(i,U,re,de)}}jC(),R=wr;break}catch(be){l2(i,be)}while(!0);return s&&i.shellSuspendCounter++,Zi=Jo=null,Yt=f,ne.H=g,ne.A=x,Rt===null&&(cr=null,Bt=0,$0()),R}function jC(){for(;Rt!==null;)f2(Rt)}function HC(i,s){var c=Yt;Yt|=2;var f=c2(),g=u2();cr!==i||Bt!==s?(kh=null,bh=Le()+500,yc(i,s)):gc=ji(i,s);e:do try{if($t!==0&&Rt!==null){s=Rt;var x=fa;t:switch($t){case 1:$t=0,fa=null,Ec(i,s,x,1);break;case 2:case 9:if(w_(x)){$t=0,fa=null,h2(s);break}s=function(){$t!==2&&$t!==9||cr!==i||($t=7),Ei(i)},x.then(s,s);break e;case 3:$t=7;break e;case 4:$t=5;break e;case 7:w_(x)?($t=0,fa=null,h2(s)):($t=0,fa=null,Ec(i,s,x,7));break;case 5:var R=null;switch(Rt.tag){case 26:R=Rt.memoizedState;case 5:case 27:var U=Rt;if(!R||X2(R)){$t=0,fa=null;var re=U.sibling;if(re!==null)Rt=re;else{var de=U.return;de!==null?(Rt=de,Rh(de)):Rt=null}break t}}$t=0,fa=null,Ec(i,s,x,5);break;case 6:$t=0,fa=null,Ec(i,s,x,6);break;case 8:ng(),wr=6;break e;default:throw Error(n(462))}}zC();break}catch(be){l2(i,be)}while(!0);return Zi=Jo=null,ne.H=f,ne.A=g,Yt=c,Rt!==null?0:(cr=null,Bt=0,$0(),wr)}function zC(){for(;Rt!==null&&!wt();)f2(Rt)}function f2(i){var s=Uy(i.alternate,i,ss);i.memoizedProps=i.pendingProps,s===null?Rh(i):Rt=s}function h2(i){var s=i,c=s.alternate;switch(s.tag){case 15:case 0:s=Dy(c,s,s.pendingProps,s.type,void 0,Bt);break;case 11:s=Dy(c,s,s.pendingProps,s.type.render,s.ref,Bt);break;case 5:yp(s);default:Vy(c,s),s=Rt=d_(s,ss),s=Uy(c,s,ss)}i.memoizedProps=i.pendingProps,s===null?Rh(i):Rt=s}function Ec(i,s,c,f){Zi=Jo=null,yp(s),hc=null,Hu=0;var g=s.return;try{if(DC(i,g,s,c,Bt)){wr=1,yh(i,Ca(c,i.current)),Rt=null;return}}catch(x){if(g!==null)throw Rt=g,x;wr=1,yh(i,Ca(c,i.current)),Rt=null;return}s.flags&32768?(Wt||f===1?i=!0:gc||(Bt&536870912)!==0?i=!1:(Bs=i=!0,(f===2||f===9||f===3||f===6)&&(f=Da.current,f!==null&&f.tag===13&&(f.flags|=16384))),d2(s,i)):Rh(s)}function Rh(i){var s=i;do{if((s.flags&32768)!==0){d2(s,Bs);return}i=s.return;var c=FC(s.alternate,s,ss);if(c!==null){Rt=c;return}if(s=s.sibling,s!==null){Rt=s;return}Rt=s=i}while(s!==null);wr===0&&(wr=5)}function d2(i,s){do{var c=PC(i.alternate,i);if(c!==null){c.flags&=32767,Rt=c;return}if(c=i.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!s&&(i=i.sibling,i!==null)){Rt=i;return}Rt=i=c}while(i!==null);wr=6,Rt=null}function m2(i,s,c,f,g,x,R,U,re){i.cancelPendingCommit=null;do Ih();while(pn!==0);if((Yt&6)!==0)throw Error(n(327));if(s!==null){if(s===i.current)throw Error(n(177));if(x=s.lanes|s.childLanes,x|=Ym,ii(i,c,x,R,U,re),i===cr&&(Rt=cr=null,Bt=0),vc=s,Hs=i,_c=c,eg=x,tg=g,a2=f,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,XC(me,function(){return _2(),null})):(i.callbackNode=null,i.callbackPriority=0),f=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||f){f=ne.T,ne.T=null,g=ue.p,ue.p=2,R=Yt,Yt|=4;try{MC(i,s,c)}finally{Yt=R,ue.p=g,ne.T=f}}pn=1,p2(),g2(),x2()}}function p2(){if(pn===1){pn=0;var i=Hs,s=vc,c=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||c){c=ne.T,ne.T=null;var f=ue.p;ue.p=2;var g=Yt;Yt|=4;try{Qy(s,i);var x=xg,R=n_(i.containerInfo),U=x.focusedElem,re=x.selectionRange;if(R!==U&&U&&U.ownerDocument&&r_(U.ownerDocument.documentElement,U)){if(re!==null&&Gm(U)){var de=re.start,be=re.end;if(be===void 0&&(be=de),"selectionStart"in U)U.selectionStart=de,U.selectionEnd=Math.min(be,U.value.length);else{var Ie=U.ownerDocument||document,ve=Ie&&Ie.defaultView||window;if(ve.getSelection){var ye=ve.getSelection(),ht=U.textContent.length,rt=Math.min(re.start,ht),nr=re.end===void 0?rt:Math.min(re.end,ht);!ye.extend&&rt>nr&&(R=nr,nr=rt,rt=R);var se=t_(U,rt),ae=t_(U,nr);if(se&&ae&&(ye.rangeCount!==1||ye.anchorNode!==se.node||ye.anchorOffset!==se.offset||ye.focusNode!==ae.node||ye.focusOffset!==ae.offset)){var fe=Ie.createRange();fe.setStart(se.node,se.offset),ye.removeAllRanges(),rt>nr?(ye.addRange(fe),ye.extend(ae.node,ae.offset)):(fe.setEnd(ae.node,ae.offset),ye.addRange(fe))}}}}for(Ie=[],ye=U;ye=ye.parentNode;)ye.nodeType===1&&Ie.push({element:ye,left:ye.scrollLeft,top:ye.scrollTop});for(typeof U.focus=="function"&&U.focus(),U=0;U<Ie.length;U++){var Ce=Ie[U];Ce.element.scrollLeft=Ce.left,Ce.element.scrollTop=Ce.top}}Hh=!!gg,xg=gg=null}finally{Yt=g,ue.p=f,ne.T=c}}i.current=s,pn=2}}function g2(){if(pn===2){pn=0;var i=Hs,s=vc,c=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||c){c=ne.T,ne.T=null;var f=ue.p;ue.p=2;var g=Yt;Yt|=4;try{Xy(i,s.alternate,s)}finally{Yt=g,ue.p=f,ne.T=c}}pn=3}}function x2(){if(pn===4||pn===3){pn=0,st();var i=Hs,s=vc,c=_c,f=a2;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?pn=5:(pn=0,vc=Hs=null,v2(i,i.pendingLanes));var g=i.pendingLanes;if(g===0&&(js=null),bs(c),s=s.stateNode,vt&&typeof vt.onCommitFiberRoot=="function")try{vt.onCommitFiberRoot(mt,s,void 0,(s.current.flags&128)===128)}catch{}if(f!==null){s=ne.T,g=ue.p,ue.p=2,ne.T=null;try{for(var x=i.onRecoverableError,R=0;R<f.length;R++){var U=f[R];x(U.value,{componentStack:U.stack})}}finally{ne.T=s,ue.p=g}}(_c&3)!==0&&Ih(),Ei(i),g=i.pendingLanes,(c&4194090)!==0&&(g&42)!==0?i===rg?Qu++:(Qu=0,rg=i):Qu=0,Zu(0)}}function v2(i,s){(i.pooledCacheLanes&=s)===0&&(s=i.pooledCache,s!=null&&(i.pooledCache=null,Nu(s)))}function Ih(i){return p2(),g2(),x2(),_2()}function _2(){if(pn!==5)return!1;var i=Hs,s=eg;eg=0;var c=bs(_c),f=ne.T,g=ue.p;try{ue.p=32>c?32:c,ne.T=null,c=tg,tg=null;var x=Hs,R=_c;if(pn=0,vc=Hs=null,_c=0,(Yt&6)!==0)throw Error(n(331));var U=Yt;if(Yt|=4,r2(x.current),Jy(x,x.current,R,c),Yt=U,Zu(0,!1),vt&&typeof vt.onPostCommitFiberRoot=="function")try{vt.onPostCommitFiberRoot(mt,x)}catch{}return!0}finally{ue.p=g,ne.T=f,v2(i,s)}}function y2(i,s,c){s=Ca(c,s),s=Fp(i.stateNode,s,2),i=Ds(i,s,2),i!==null&&(qa(i,2),Ei(i))}function or(i,s,c){if(i.tag===3)y2(i,i,c);else for(;s!==null;){if(s.tag===3){y2(s,i,c);break}else if(s.tag===1){var f=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(js===null||!js.has(f))){i=Ca(c,i),c=Sy(2),f=Ds(s,c,2),f!==null&&(Ay(c,f,s,i),qa(f,2),Ei(f));break}}s=s.return}}function sg(i,s,c){var f=i.pingCache;if(f===null){f=i.pingCache=new BC;var g=new Set;f.set(s,g)}else g=f.get(s),g===void 0&&(g=new Set,f.set(s,g));g.has(c)||($p=!0,g.add(c),i=GC.bind(null,i,s,c),s.then(i,i))}function GC(i,s,c){var f=i.pingCache;f!==null&&f.delete(s),i.pingedLanes|=i.suspendedLanes&c,i.warmLanes&=~c,cr===i&&(Bt&c)===c&&(wr===4||wr===3&&(Bt&62914560)===Bt&&300>Le()-Jp?(Yt&2)===0&&yc(i,0):Qp|=c,xc===Bt&&(xc=0)),Ei(i)}function E2(i,s){s===0&&(s=As()),i=rc(i,s),i!==null&&(qa(i,s),Ei(i))}function qC(i){var s=i.memoizedState,c=0;s!==null&&(c=s.retryLane),E2(i,c)}function WC(i,s){var c=0;switch(i.tag){case 13:var f=i.stateNode,g=i.memoizedState;g!==null&&(c=g.retryLane);break;case 19:f=i.stateNode;break;case 22:f=i.stateNode._retryCache;break;default:throw Error(n(314))}f!==null&&f.delete(s),E2(i,c)}function XC(i,s){return nt(i,s)}var Nh=null,Tc=null,og=!1,Dh=!1,lg=!1,sl=0;function Ei(i){i!==Tc&&i.next===null&&(Tc===null?Nh=Tc=i:Tc=Tc.next=i),Dh=!0,og||(og=!0,YC())}function Zu(i,s){if(!lg&&Dh){lg=!0;do for(var c=!1,f=Nh;f!==null;){if(i!==0){var g=f.pendingLanes;if(g===0)var x=0;else{var R=f.suspendedLanes,U=f.pingedLanes;x=(1<<31-Ft(42|i)+1)-1,x&=g&~(R&~U),x=x&201326741?x&201326741|1:x?x|2:0}x!==0&&(c=!0,A2(f,x))}else x=Bt,x=Ts(f,f===cr?x:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(x&3)===0||ji(f,x)||(c=!0,A2(f,x));f=f.next}while(c);lg=!1}}function KC(){T2()}function T2(){Dh=og=!1;var i=0;sl!==0&&(n3()&&(i=sl),sl=0);for(var s=Le(),c=null,f=Nh;f!==null;){var g=f.next,x=w2(f,s);x===0?(f.next=null,c===null?Nh=g:c.next=g,g===null&&(Tc=c)):(c=f,(i!==0||(x&3)!==0)&&(Dh=!0)),f=g}Zu(i)}function w2(i,s){for(var c=i.suspendedLanes,f=i.pingedLanes,g=i.expirationTimes,x=i.pendingLanes&-62914561;0<x;){var R=31-Ft(x),U=1<<R,re=g[R];re===-1?((U&c)===0||(U&f)!==0)&&(g[R]=ws(U,s)):re<=s&&(i.expiredLanes|=U),x&=~U}if(s=cr,c=Bt,c=Ts(i,i===s?c:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),f=i.callbackNode,c===0||i===s&&($t===2||$t===9)||i.cancelPendingCommit!==null)return f!==null&&f!==null&&it(f),i.callbackNode=null,i.callbackPriority=0;if((c&3)===0||ji(i,c)){if(s=c&-c,s===i.callbackPriority)return s;switch(f!==null&&it(f),bs(c)){case 2:case 8:c=Kr;break;case 32:c=me;break;case 268435456:c=je;break;default:c=me}return f=S2.bind(null,i),c=nt(c,f),i.callbackPriority=s,i.callbackNode=c,s}return f!==null&&f!==null&&it(f),i.callbackPriority=2,i.callbackNode=null,2}function S2(i,s){if(pn!==0&&pn!==5)return i.callbackNode=null,i.callbackPriority=0,null;var c=i.callbackNode;if(Ih()&&i.callbackNode!==c)return null;var f=Bt;return f=Ts(i,i===cr?f:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),f===0?null:(s2(i,f,s),w2(i,Le()),i.callbackNode!=null&&i.callbackNode===c?S2.bind(null,i):null)}function A2(i,s){if(Ih())return null;s2(i,s,!0)}function YC(){i3(function(){(Yt&6)!==0?nt(Lr,KC):T2()})}function cg(){return sl===0&&(sl=Ss()),sl}function b2(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:Gl(""+i)}function k2(i,s){var c=s.ownerDocument.createElement("input");return c.name=s.name,c.value=s.value,i.id&&c.setAttribute("form",i.id),s.parentNode.insertBefore(c,s),i=new FormData(i),c.parentNode.removeChild(c),i}function $C(i,s,c,f,g){if(s==="submit"&&c&&c.stateNode===g){var x=b2((g[gr]||null).action),R=f.submitter;R&&(s=(s=R[gr]||null)?b2(s.formAction):R.getAttribute("formAction"),s!==null&&(x=s,R=null));var U=new ql("action","action",null,f,g);i.push({event:U,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(sl!==0){var re=R?k2(g,R):new FormData(g);Rp(c,{pending:!0,data:re,method:g.method,action:x},null,re)}}else typeof x=="function"&&(U.preventDefault(),re=R?k2(g,R):new FormData(g),Rp(c,{pending:!0,data:re,method:g.method,action:x},x,re))},currentTarget:g}]})}}for(var ug=0;ug<Km.length;ug++){var fg=Km[ug],QC=fg.toLowerCase(),ZC=fg[0].toUpperCase()+fg.slice(1);Xa(QC,"on"+ZC)}Xa(s_,"onAnimationEnd"),Xa(o_,"onAnimationIteration"),Xa(l_,"onAnimationStart"),Xa("dblclick","onDoubleClick"),Xa("focusin","onFocus"),Xa("focusout","onBlur"),Xa(pC,"onTransitionRun"),Xa(gC,"onTransitionStart"),Xa(xC,"onTransitionCancel"),Xa(c_,"onTransitionEnd"),Ve("onMouseEnter",["mouseout","mouseover"]),Ve("onMouseLeave",["mouseout","mouseover"]),Ve("onPointerEnter",["pointerout","pointerover"]),Ve("onPointerLeave",["pointerout","pointerover"]),Pe("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Pe("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Pe("onBeforeInput",["compositionend","keypress","textInput","paste"]),Pe("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Pe("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Pe("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ju="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),JC=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ju));function C2(i,s){s=(s&4)!==0;for(var c=0;c<i.length;c++){var f=i[c],g=f.event;f=f.listeners;e:{var x=void 0;if(s)for(var R=f.length-1;0<=R;R--){var U=f[R],re=U.instance,de=U.currentTarget;if(U=U.listener,re!==x&&g.isPropagationStopped())break e;x=U,g.currentTarget=de;try{x(g)}catch(be){_h(be)}g.currentTarget=null,x=re}else for(R=0;R<f.length;R++){if(U=f[R],re=U.instance,de=U.currentTarget,U=U.listener,re!==x&&g.isPropagationStopped())break e;x=U,g.currentTarget=de;try{x(g)}catch(be){_h(be)}g.currentTarget=null,x=re}}}}function It(i,s){var c=s[Fo];c===void 0&&(c=s[Fo]=new Set);var f=i+"__bubble";c.has(f)||(R2(s,i,2,!1),c.add(f))}function hg(i,s,c){var f=0;s&&(f|=4),R2(c,i,f,s)}var Oh="_reactListening"+Math.random().toString(36).slice(2);function dg(i){if(!i[Oh]){i[Oh]=!0,ge.forEach(function(c){c!=="selectionchange"&&(JC.has(c)||hg(c,!1,i),hg(c,!0,i))});var s=i.nodeType===9?i:i.ownerDocument;s===null||s[Oh]||(s[Oh]=!0,hg("selectionchange",!1,s))}}function R2(i,s,c,f){switch(J2(s)){case 2:var g=b3;break;case 8:g=k3;break;default:g=kg}c=g.bind(null,s,c,i),g=void 0,!ba||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(g=!0),f?g!==void 0?i.addEventListener(s,c,{capture:!0,passive:g}):i.addEventListener(s,c,!0):g!==void 0?i.addEventListener(s,c,{passive:g}):i.addEventListener(s,c,!1)}function mg(i,s,c,f,g){var x=f;if((s&1)===0&&(s&2)===0&&f!==null)e:for(;;){if(f===null)return;var R=f.tag;if(R===3||R===4){var U=f.stateNode.containerInfo;if(U===g)break;if(R===4)for(R=f.return;R!==null;){var re=R.tag;if((re===3||re===4)&&R.stateNode.containerInfo===g)return;R=R.return}for(;U!==null;){if(R=Y(U),R===null)return;if(re=R.tag,re===5||re===6||re===26||re===27){f=x=R;continue e}U=U.parentNode}}f=f.return}P0(function(){var de=x,be=Aa(c),Ie=[];e:{var ve=u_.get(i);if(ve!==void 0){var ye=ql,ht=i;switch(i){case"keypress":if(hi(c)===0)break e;case"keydown":case"keyup":ye=Ql;break;case"focusin":ht="focus",ye=Kl;break;case"focusout":ht="blur",ye=Kl;break;case"beforeblur":case"afterblur":ye=Kl;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ye=ka;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ye=Vm;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ye=z0;break;case s_:case o_:case l_:ye=Yl;break;case c_:ye=q0;break;case"scroll":case"scrollend":ye=M0;break;case"wheel":ye=Zl;break;case"copy":case"cut":case"paste":ye=$l;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ye=wu;break;case"toggle":case"beforetoggle":ye=X0}var rt=(s&4)!==0,nr=!rt&&(i==="scroll"||i==="scrollend"),se=rt?ve!==null?ve+"Capture":null:ve;rt=[];for(var ae=de,fe;ae!==null;){var Ce=ae;if(fe=Ce.stateNode,Ce=Ce.tag,Ce!==5&&Ce!==26&&Ce!==27||fe===null||se===null||(Ce=Bo(ae,se),Ce!=null&&rt.push(ef(ae,Ce,fe))),nr)break;ae=ae.return}0<rt.length&&(ve=new ye(ve,ht,null,c,be),Ie.push({event:ve,listeners:rt}))}}if((s&7)===0){e:{if(ve=i==="mouseover"||i==="pointerover",ye=i==="mouseout"||i==="pointerout",ve&&c!==zi&&(ht=c.relatedTarget||c.fromElement)&&(Y(ht)||ht[Yn]))break e;if((ye||ve)&&(ve=be.window===be?be:(ve=be.ownerDocument)?ve.defaultView||ve.parentWindow:window,ye?(ht=c.relatedTarget||c.toElement,ye=de,ht=ht?Y(ht):null,ht!==null&&(nr=o(ht),rt=ht.tag,ht!==nr||rt!==5&&rt!==27&&rt!==6)&&(ht=null)):(ye=null,ht=de),ye!==ht)){if(rt=ka,Ce="onMouseLeave",se="onMouseEnter",ae="mouse",(i==="pointerout"||i==="pointerover")&&(rt=wu,Ce="onPointerLeave",se="onPointerEnter",ae="pointer"),nr=ye==null?ve:he(ye),fe=ht==null?ve:he(ht),ve=new rt(Ce,ae+"leave",ye,c,be),ve.target=nr,ve.relatedTarget=fe,Ce=null,Y(be)===de&&(rt=new rt(se,ae+"enter",ht,c,be),rt.target=fe,rt.relatedTarget=nr,Ce=rt),nr=Ce,ye&&ht)t:{for(rt=ye,se=ht,ae=0,fe=rt;fe;fe=wc(fe))ae++;for(fe=0,Ce=se;Ce;Ce=wc(Ce))fe++;for(;0<ae-fe;)rt=wc(rt),ae--;for(;0<fe-ae;)se=wc(se),fe--;for(;ae--;){if(rt===se||se!==null&&rt===se.alternate)break t;rt=wc(rt),se=wc(se)}rt=null}else rt=null;ye!==null&&I2(Ie,ve,ye,rt,!1),ht!==null&&nr!==null&&I2(Ie,nr,ht,rt,!0)}}e:{if(ve=de?he(de):window,ye=ve.nodeName&&ve.nodeName.toLowerCase(),ye==="select"||ye==="input"&&ve.type==="file")var $e=Yv;else if($r(ve))if($v)$e=hC;else{$e=uC;var kt=cC}else ye=ve.nodeName,!ye||ye.toLowerCase()!=="input"||ve.type!=="checkbox"&&ve.type!=="radio"?de&&gu(de.elementType)&&($e=Yv):$e=fC;if($e&&($e=$e(i,de))){Ki(Ie,$e,c,be);break e}kt&&kt(i,ve,de),i==="focusout"&&de&&ve.type==="number"&&de.memoizedProps.value!=null&&ks(ve,"number",ve.value)}switch(kt=de?he(de):window,i){case"focusin":($r(kt)||kt.contentEditable==="true")&&(Jl=kt,qm=de,bu=null);break;case"focusout":bu=qm=Jl=null;break;case"mousedown":Wm=!0;break;case"contextmenu":case"mouseup":case"dragend":Wm=!1,a_(Ie,c,be);break;case"selectionchange":if(mC)break;case"keydown":case"keyup":a_(Ie,c,be)}var Ze;if(pi)e:{switch(i){case"compositionstart":var at="onCompositionStart";break e;case"compositionend":at="onCompositionEnd";break e;case"compositionupdate":at="onCompositionUpdate";break e}at=void 0}else Lt?Se(i,c)&&(at="onCompositionEnd"):i==="keydown"&&c.keyCode===229&&(at="onCompositionStart");at&&(k&&c.locale!=="ko"&&(Lt||at!=="onCompositionStart"?at==="onCompositionEnd"&&Lt&&(Ze=vu()):(fi=be,Cs="value"in fi?fi.value:fi.textContent,Lt=!0)),kt=Fh(de,at),0<kt.length&&(at=new Eu(at,i,null,c,be),Ie.push({event:at,listeners:kt}),Ze?at.data=Ze:(Ze=ze(c),Ze!==null&&(at.data=Ze)))),(Ze=T?Yr(i,c):Ut(i,c))&&(at=Fh(de,"onBeforeInput"),0<at.length&&(kt=new Eu("onBeforeInput","beforeinput",null,c,be),Ie.push({event:kt,listeners:at}),kt.data=Ze)),$C(Ie,i,de,c,be)}C2(Ie,s)})}function ef(i,s,c){return{instance:i,listener:s,currentTarget:c}}function Fh(i,s){for(var c=s+"Capture",f=[];i!==null;){var g=i,x=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||x===null||(g=Bo(i,c),g!=null&&f.unshift(ef(i,g,x)),g=Bo(i,s),g!=null&&f.push(ef(i,g,x))),i.tag===3)return f;i=i.return}return[]}function wc(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function I2(i,s,c,f,g){for(var x=s._reactName,R=[];c!==null&&c!==f;){var U=c,re=U.alternate,de=U.stateNode;if(U=U.tag,re!==null&&re===f)break;U!==5&&U!==26&&U!==27||de===null||(re=de,g?(de=Bo(c,x),de!=null&&R.unshift(ef(c,de,re))):g||(de=Bo(c,x),de!=null&&R.push(ef(c,de,re)))),c=c.return}R.length!==0&&i.push({event:s,listeners:R})}var e3=/\r\n?/g,t3=/\u0000|\uFFFD/g;function N2(i){return(typeof i=="string"?i:""+i).replace(e3,`
`).replace(t3,"")}function D2(i,s){return s=N2(s),N2(i)===s}function Ph(){}function rr(i,s,c,f,g,x){switch(c){case"children":typeof f=="string"?s==="body"||s==="textarea"&&f===""||Sa(i,f):(typeof f=="number"||typeof f=="bigint")&&s!=="body"&&Sa(i,""+f);break;case"className":Pt(i,"class",f);break;case"tabIndex":Pt(i,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":Pt(i,c,f);break;case"style":pu(i,f,x);break;case"data":if(s!=="object"){Pt(i,"data",f);break}case"src":case"href":if(f===""&&(s!=="a"||c!=="href")){i.removeAttribute(c);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){i.removeAttribute(c);break}f=Gl(""+f),i.setAttribute(c,f);break;case"action":case"formAction":if(typeof f=="function"){i.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof x=="function"&&(c==="formAction"?(s!=="input"&&rr(i,s,"name",g.name,g,null),rr(i,s,"formEncType",g.formEncType,g,null),rr(i,s,"formMethod",g.formMethod,g,null),rr(i,s,"formTarget",g.formTarget,g,null)):(rr(i,s,"encType",g.encType,g,null),rr(i,s,"method",g.method,g,null),rr(i,s,"target",g.target,g,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){i.removeAttribute(c);break}f=Gl(""+f),i.setAttribute(c,f);break;case"onClick":f!=null&&(i.onclick=Ph);break;case"onScroll":f!=null&&It("scroll",i);break;case"onScrollEnd":f!=null&&It("scrollend",i);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(c=f.__html,c!=null){if(g.children!=null)throw Error(n(60));i.innerHTML=c}}break;case"multiple":i.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":i.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){i.removeAttribute("xlink:href");break}c=Gl(""+f),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?i.setAttribute(c,""+f):i.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?i.setAttribute(c,""):i.removeAttribute(c);break;case"capture":case"download":f===!0?i.setAttribute(c,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?i.setAttribute(c,f):i.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?i.setAttribute(c,f):i.removeAttribute(c);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?i.removeAttribute(c):i.setAttribute(c,f);break;case"popover":It("beforetoggle",i),It("toggle",i),zt(i,"popover",f);break;case"xlinkActuate":Mt(i,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":Mt(i,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":Mt(i,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":Mt(i,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":Mt(i,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":Mt(i,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":Mt(i,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":Mt(i,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":Mt(i,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":zt(i,"is",f);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=Um.get(c)||c,zt(i,c,f))}}function pg(i,s,c,f,g,x){switch(c){case"style":pu(i,f,x);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(c=f.__html,c!=null){if(g.children!=null)throw Error(n(60));i.innerHTML=c}}break;case"children":typeof f=="string"?Sa(i,f):(typeof f=="number"||typeof f=="bigint")&&Sa(i,""+f);break;case"onScroll":f!=null&&It("scroll",i);break;case"onScrollEnd":f!=null&&It("scrollend",i);break;case"onClick":f!=null&&(i.onclick=Ph);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!xe.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(g=c.endsWith("Capture"),s=c.slice(2,g?c.length-7:void 0),x=i[gr]||null,x=x!=null?x[c]:null,typeof x=="function"&&i.removeEventListener(s,x,g),typeof f=="function")){typeof x!="function"&&x!==null&&(c in i?i[c]=null:i.hasAttribute(c)&&i.removeAttribute(c)),i.addEventListener(s,f,g);break e}c in i?i[c]=f:f===!0?i.setAttribute(c,""):zt(i,c,f)}}}function gn(i,s,c){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":It("error",i),It("load",i);var f=!1,g=!1,x;for(x in c)if(c.hasOwnProperty(x)){var R=c[x];if(R!=null)switch(x){case"src":f=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,s));default:rr(i,s,x,R,c,null)}}g&&rr(i,s,"srcSet",c.srcSet,c,null),f&&rr(i,s,"src",c.src,c,null);return;case"input":It("invalid",i);var U=x=R=g=null,re=null,de=null;for(f in c)if(c.hasOwnProperty(f)){var be=c[f];if(be!=null)switch(f){case"name":g=be;break;case"type":R=be;break;case"checked":re=be;break;case"defaultChecked":de=be;break;case"value":x=be;break;case"defaultValue":U=be;break;case"children":case"dangerouslySetInnerHTML":if(be!=null)throw Error(n(137,s));break;default:rr(i,s,f,be,c,null)}}Mo(i,x,U,re,de,R,g,!1),zl(i);return;case"select":It("invalid",i),f=R=x=null;for(g in c)if(c.hasOwnProperty(g)&&(U=c[g],U!=null))switch(g){case"value":x=U;break;case"defaultValue":R=U;break;case"multiple":f=U;default:rr(i,s,g,U,c,null)}s=x,c=R,i.multiple=!!f,s!=null?Hi(i,!!f,s,!1):c!=null&&Hi(i,!!f,c,!0);return;case"textarea":It("invalid",i),x=g=f=null;for(R in c)if(c.hasOwnProperty(R)&&(U=c[R],U!=null))switch(R){case"value":f=U;break;case"defaultValue":g=U;break;case"children":x=U;break;case"dangerouslySetInnerHTML":if(U!=null)throw Error(n(91));break;default:rr(i,s,R,U,c,null)}Lo(i,f,g,x),zl(i);return;case"option":for(re in c)if(c.hasOwnProperty(re)&&(f=c[re],f!=null))switch(re){case"selected":i.selected=f&&typeof f!="function"&&typeof f!="symbol";break;default:rr(i,s,re,f,c,null)}return;case"dialog":It("beforetoggle",i),It("toggle",i),It("cancel",i),It("close",i);break;case"iframe":case"object":It("load",i);break;case"video":case"audio":for(f=0;f<Ju.length;f++)It(Ju[f],i);break;case"image":It("error",i),It("load",i);break;case"details":It("toggle",i);break;case"embed":case"source":case"link":It("error",i),It("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(de in c)if(c.hasOwnProperty(de)&&(f=c[de],f!=null))switch(de){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,s));default:rr(i,s,de,f,c,null)}return;default:if(gu(s)){for(be in c)c.hasOwnProperty(be)&&(f=c[be],f!==void 0&&pg(i,s,be,f,c,void 0));return}}for(U in c)c.hasOwnProperty(U)&&(f=c[U],f!=null&&rr(i,s,U,f,c,null))}function r3(i,s,c,f){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,x=null,R=null,U=null,re=null,de=null,be=null;for(ye in c){var Ie=c[ye];if(c.hasOwnProperty(ye)&&Ie!=null)switch(ye){case"checked":break;case"value":break;case"defaultValue":re=Ie;default:f.hasOwnProperty(ye)||rr(i,s,ye,null,f,Ie)}}for(var ve in f){var ye=f[ve];if(Ie=c[ve],f.hasOwnProperty(ve)&&(ye!=null||Ie!=null))switch(ve){case"type":x=ye;break;case"name":g=ye;break;case"checked":de=ye;break;case"defaultChecked":be=ye;break;case"value":R=ye;break;case"defaultValue":U=ye;break;case"children":case"dangerouslySetInnerHTML":if(ye!=null)throw Error(n(137,s));break;default:ye!==Ie&&rr(i,s,ve,ye,f,Ie)}}sa(i,R,U,re,de,be,x,g);return;case"select":ye=R=U=ve=null;for(x in c)if(re=c[x],c.hasOwnProperty(x)&&re!=null)switch(x){case"value":break;case"multiple":ye=re;default:f.hasOwnProperty(x)||rr(i,s,x,null,f,re)}for(g in f)if(x=f[g],re=c[g],f.hasOwnProperty(g)&&(x!=null||re!=null))switch(g){case"value":ve=x;break;case"defaultValue":U=x;break;case"multiple":R=x;default:x!==re&&rr(i,s,g,x,f,re)}s=U,c=R,f=ye,ve!=null?Hi(i,!!c,ve,!1):!!f!=!!c&&(s!=null?Hi(i,!!c,s,!0):Hi(i,!!c,c?[]:"",!1));return;case"textarea":ye=ve=null;for(U in c)if(g=c[U],c.hasOwnProperty(U)&&g!=null&&!f.hasOwnProperty(U))switch(U){case"value":break;case"children":break;default:rr(i,s,U,null,f,g)}for(R in f)if(g=f[R],x=c[R],f.hasOwnProperty(R)&&(g!=null||x!=null))switch(R){case"value":ve=g;break;case"defaultValue":ye=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(n(91));break;default:g!==x&&rr(i,s,R,g,f,x)}er(i,ve,ye);return;case"option":for(var ht in c)if(ve=c[ht],c.hasOwnProperty(ht)&&ve!=null&&!f.hasOwnProperty(ht))switch(ht){case"selected":i.selected=!1;break;default:rr(i,s,ht,null,f,ve)}for(re in f)if(ve=f[re],ye=c[re],f.hasOwnProperty(re)&&ve!==ye&&(ve!=null||ye!=null))switch(re){case"selected":i.selected=ve&&typeof ve!="function"&&typeof ve!="symbol";break;default:rr(i,s,re,ve,f,ye)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var rt in c)ve=c[rt],c.hasOwnProperty(rt)&&ve!=null&&!f.hasOwnProperty(rt)&&rr(i,s,rt,null,f,ve);for(de in f)if(ve=f[de],ye=c[de],f.hasOwnProperty(de)&&ve!==ye&&(ve!=null||ye!=null))switch(de){case"children":case"dangerouslySetInnerHTML":if(ve!=null)throw Error(n(137,s));break;default:rr(i,s,de,ve,f,ye)}return;default:if(gu(s)){for(var nr in c)ve=c[nr],c.hasOwnProperty(nr)&&ve!==void 0&&!f.hasOwnProperty(nr)&&pg(i,s,nr,void 0,f,ve);for(be in f)ve=f[be],ye=c[be],!f.hasOwnProperty(be)||ve===ye||ve===void 0&&ye===void 0||pg(i,s,be,ve,f,ye);return}}for(var se in c)ve=c[se],c.hasOwnProperty(se)&&ve!=null&&!f.hasOwnProperty(se)&&rr(i,s,se,null,f,ve);for(Ie in f)ve=f[Ie],ye=c[Ie],!f.hasOwnProperty(Ie)||ve===ye||ve==null&&ye==null||rr(i,s,Ie,ve,f,ye)}var gg=null,xg=null;function Mh(i){return i.nodeType===9?i:i.ownerDocument}function O2(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function F2(i,s){if(i===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&s==="foreignObject"?0:i}function vg(i,s){return i==="textarea"||i==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var _g=null;function n3(){var i=window.event;return i&&i.type==="popstate"?i===_g?!1:(_g=i,!0):(_g=null,!1)}var P2=typeof setTimeout=="function"?setTimeout:void 0,a3=typeof clearTimeout=="function"?clearTimeout:void 0,M2=typeof Promise=="function"?Promise:void 0,i3=typeof queueMicrotask=="function"?queueMicrotask:typeof M2<"u"?function(i){return M2.resolve(null).then(i).catch(s3)}:P2;function s3(i){setTimeout(function(){throw i})}function Gs(i){return i==="head"}function L2(i,s){var c=s,f=0,g=0;do{var x=c.nextSibling;if(i.removeChild(c),x&&x.nodeType===8)if(c=x.data,c==="/$"){if(0<f&&8>f){c=f;var R=i.ownerDocument;if(c&1&&tf(R.documentElement),c&2&&tf(R.body),c&4)for(c=R.head,tf(c),R=c.firstChild;R;){var U=R.nextSibling,re=R.nodeName;R[H]||re==="SCRIPT"||re==="STYLE"||re==="LINK"&&R.rel.toLowerCase()==="stylesheet"||c.removeChild(R),R=U}}if(g===0){i.removeChild(x),uf(s);return}g--}else c==="$"||c==="$?"||c==="$!"?g++:f=c.charCodeAt(0)-48;else f=0;c=x}while(c);uf(s)}function yg(i){var s=i.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var c=s;switch(s=s.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":yg(c),G(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}i.removeChild(c)}}function o3(i,s,c,f){for(;i.nodeType===1;){var g=c;if(i.nodeName.toLowerCase()!==s.toLowerCase()){if(!f&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(f){if(!i[H])switch(s){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(x=i.getAttribute("rel"),x==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(x!==g.rel||i.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||i.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||i.getAttribute("title")!==(g.title==null?null:g.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(x=i.getAttribute("src"),(x!==(g.src==null?null:g.src)||i.getAttribute("type")!==(g.type==null?null:g.type)||i.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&x&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(s==="input"&&i.type==="hidden"){var x=g.name==null?null:""+g.name;if(g.type==="hidden"&&i.getAttribute("name")===x)return i}else return i;if(i=Ya(i.nextSibling),i===null)break}return null}function l3(i,s,c){if(s==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!c||(i=Ya(i.nextSibling),i===null))return null;return i}function Eg(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState==="complete"}function c3(i,s){var c=i.ownerDocument;if(i.data!=="$?"||c.readyState==="complete")s();else{var f=function(){s(),c.removeEventListener("DOMContentLoaded",f)};c.addEventListener("DOMContentLoaded",f),i._reactRetry=f}}function Ya(i){for(;i!=null;i=i.nextSibling){var s=i.nodeType;if(s===1||s===3)break;if(s===8){if(s=i.data,s==="$"||s==="$!"||s==="$?"||s==="F!"||s==="F")break;if(s==="/$")return null}}return i}var Tg=null;function U2(i){i=i.previousSibling;for(var s=0;i;){if(i.nodeType===8){var c=i.data;if(c==="$"||c==="$!"||c==="$?"){if(s===0)return i;s--}else c==="/$"&&s++}i=i.previousSibling}return null}function B2(i,s,c){switch(s=Mh(c),i){case"html":if(i=s.documentElement,!i)throw Error(n(452));return i;case"head":if(i=s.head,!i)throw Error(n(453));return i;case"body":if(i=s.body,!i)throw Error(n(454));return i;default:throw Error(n(451))}}function tf(i){for(var s=i.attributes;s.length;)i.removeAttributeNode(s[0]);G(i)}var Fa=new Map,V2=new Set;function Lh(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var os=ue.d;ue.d={f:u3,r:f3,D:h3,C:d3,L:m3,m:p3,X:x3,S:g3,M:v3};function u3(){var i=os.f(),s=Ch();return i||s}function f3(i){var s=J(i);s!==null&&s.tag===5&&s.type==="form"?sy(s):os.r(i)}var Sc=typeof document>"u"?null:document;function j2(i,s,c){var f=Sc;if(f&&typeof s=="string"&&s){var g=Br(s);g='link[rel="'+i+'"][href="'+g+'"]',typeof c=="string"&&(g+='[crossorigin="'+c+'"]'),V2.has(g)||(V2.add(g),i={rel:i,crossOrigin:c,href:s},f.querySelector(g)===null&&(s=f.createElement("link"),gn(s,"link",i),oe(s),f.head.appendChild(s)))}}function h3(i){os.D(i),j2("dns-prefetch",i,null)}function d3(i,s){os.C(i,s),j2("preconnect",i,s)}function m3(i,s,c){os.L(i,s,c);var f=Sc;if(f&&i&&s){var g='link[rel="preload"][as="'+Br(s)+'"]';s==="image"&&c&&c.imageSrcSet?(g+='[imagesrcset="'+Br(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(g+='[imagesizes="'+Br(c.imageSizes)+'"]')):g+='[href="'+Br(i)+'"]';var x=g;switch(s){case"style":x=Ac(i);break;case"script":x=bc(i)}Fa.has(x)||(i=p({rel:"preload",href:s==="image"&&c&&c.imageSrcSet?void 0:i,as:s},c),Fa.set(x,i),f.querySelector(g)!==null||s==="style"&&f.querySelector(rf(x))||s==="script"&&f.querySelector(nf(x))||(s=f.createElement("link"),gn(s,"link",i),oe(s),f.head.appendChild(s)))}}function p3(i,s){os.m(i,s);var c=Sc;if(c&&i){var f=s&&typeof s.as=="string"?s.as:"script",g='link[rel="modulepreload"][as="'+Br(f)+'"][href="'+Br(i)+'"]',x=g;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":x=bc(i)}if(!Fa.has(x)&&(i=p({rel:"modulepreload",href:i},s),Fa.set(x,i),c.querySelector(g)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(nf(x)))return}f=c.createElement("link"),gn(f,"link",i),oe(f),c.head.appendChild(f)}}}function g3(i,s,c){os.S(i,s,c);var f=Sc;if(f&&i){var g=we(f).hoistableStyles,x=Ac(i);s=s||"default";var R=g.get(x);if(!R){var U={loading:0,preload:null};if(R=f.querySelector(rf(x)))U.loading=5;else{i=p({rel:"stylesheet",href:i,"data-precedence":s},c),(c=Fa.get(x))&&wg(i,c);var re=R=f.createElement("link");oe(re),gn(re,"link",i),re._p=new Promise(function(de,be){re.onload=de,re.onerror=be}),re.addEventListener("load",function(){U.loading|=1}),re.addEventListener("error",function(){U.loading|=2}),U.loading|=4,Uh(R,s,f)}R={type:"stylesheet",instance:R,count:1,state:U},g.set(x,R)}}}function x3(i,s){os.X(i,s);var c=Sc;if(c&&i){var f=we(c).hoistableScripts,g=bc(i),x=f.get(g);x||(x=c.querySelector(nf(g)),x||(i=p({src:i,async:!0},s),(s=Fa.get(g))&&Sg(i,s),x=c.createElement("script"),oe(x),gn(x,"link",i),c.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},f.set(g,x))}}function v3(i,s){os.M(i,s);var c=Sc;if(c&&i){var f=we(c).hoistableScripts,g=bc(i),x=f.get(g);x||(x=c.querySelector(nf(g)),x||(i=p({src:i,async:!0,type:"module"},s),(s=Fa.get(g))&&Sg(i,s),x=c.createElement("script"),oe(x),gn(x,"link",i),c.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},f.set(g,x))}}function H2(i,s,c,f){var g=(g=le.current)?Lh(g):null;if(!g)throw Error(n(446));switch(i){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(s=Ac(c.href),c=we(g).hoistableStyles,f=c.get(s),f||(f={type:"style",instance:null,count:0,state:null},c.set(s,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){i=Ac(c.href);var x=we(g).hoistableStyles,R=x.get(i);if(R||(g=g.ownerDocument||g,R={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},x.set(i,R),(x=g.querySelector(rf(i)))&&!x._p&&(R.instance=x,R.state.loading=5),Fa.has(i)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},Fa.set(i,c),x||_3(g,i,c,R.state))),s&&f===null)throw Error(n(528,""));return R}if(s&&f!==null)throw Error(n(529,""));return null;case"script":return s=c.async,c=c.src,typeof c=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=bc(c),c=we(g).hoistableScripts,f=c.get(s),f||(f={type:"script",instance:null,count:0,state:null},c.set(s,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,i))}}function Ac(i){return'href="'+Br(i)+'"'}function rf(i){return'link[rel="stylesheet"]['+i+"]"}function z2(i){return p({},i,{"data-precedence":i.precedence,precedence:null})}function _3(i,s,c,f){i.querySelector('link[rel="preload"][as="style"]['+s+"]")?f.loading=1:(s=i.createElement("link"),f.preload=s,s.addEventListener("load",function(){return f.loading|=1}),s.addEventListener("error",function(){return f.loading|=2}),gn(s,"link",c),oe(s),i.head.appendChild(s))}function bc(i){return'[src="'+Br(i)+'"]'}function nf(i){return"script[async]"+i}function G2(i,s,c){if(s.count++,s.instance===null)switch(s.type){case"style":var f=i.querySelector('style[data-href~="'+Br(c.href)+'"]');if(f)return s.instance=f,oe(f),f;var g=p({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return f=(i.ownerDocument||i).createElement("style"),oe(f),gn(f,"style",g),Uh(f,c.precedence,i),s.instance=f;case"stylesheet":g=Ac(c.href);var x=i.querySelector(rf(g));if(x)return s.state.loading|=4,s.instance=x,oe(x),x;f=z2(c),(g=Fa.get(g))&&wg(f,g),x=(i.ownerDocument||i).createElement("link"),oe(x);var R=x;return R._p=new Promise(function(U,re){R.onload=U,R.onerror=re}),gn(x,"link",f),s.state.loading|=4,Uh(x,c.precedence,i),s.instance=x;case"script":return x=bc(c.src),(g=i.querySelector(nf(x)))?(s.instance=g,oe(g),g):(f=c,(g=Fa.get(x))&&(f=p({},c),Sg(f,g)),i=i.ownerDocument||i,g=i.createElement("script"),oe(g),gn(g,"link",f),i.head.appendChild(g),s.instance=g);case"void":return null;default:throw Error(n(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(f=s.instance,s.state.loading|=4,Uh(f,c.precedence,i));return s.instance}function Uh(i,s,c){for(var f=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=f.length?f[f.length-1]:null,x=g,R=0;R<f.length;R++){var U=f[R];if(U.dataset.precedence===s)x=U;else if(x!==g)break}x?x.parentNode.insertBefore(i,x.nextSibling):(s=c.nodeType===9?c.head:c,s.insertBefore(i,s.firstChild))}function wg(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.title==null&&(i.title=s.title)}function Sg(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.integrity==null&&(i.integrity=s.integrity)}var Bh=null;function q2(i,s,c){if(Bh===null){var f=new Map,g=Bh=new Map;g.set(c,f)}else g=Bh,f=g.get(c),f||(f=new Map,g.set(c,f));if(f.has(i))return f;for(f.set(i,null),c=c.getElementsByTagName(i),g=0;g<c.length;g++){var x=c[g];if(!(x[H]||x[Ir]||i==="link"&&x.getAttribute("rel")==="stylesheet")&&x.namespaceURI!=="http://www.w3.org/2000/svg"){var R=x.getAttribute(s)||"";R=i+R;var U=f.get(R);U?U.push(x):f.set(R,[x])}}return f}function W2(i,s,c){i=i.ownerDocument||i,i.head.insertBefore(c,s==="title"?i.querySelector("head > title"):null)}function y3(i,s,c){if(c===1||s.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;switch(s.rel){case"stylesheet":return i=s.disabled,typeof s.precedence=="string"&&i==null;default:return!0}case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function X2(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}var af=null;function E3(){}function T3(i,s,c){if(af===null)throw Error(n(475));var f=af;if(s.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(s.state.loading&4)===0){if(s.instance===null){var g=Ac(c.href),x=i.querySelector(rf(g));if(x){i=x._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(f.count++,f=Vh.bind(f),i.then(f,f)),s.state.loading|=4,s.instance=x,oe(x);return}x=i.ownerDocument||i,c=z2(c),(g=Fa.get(g))&&wg(c,g),x=x.createElement("link"),oe(x);var R=x;R._p=new Promise(function(U,re){R.onload=U,R.onerror=re}),gn(x,"link",c),s.instance=x}f.stylesheets===null&&(f.stylesheets=new Map),f.stylesheets.set(s,i),(i=s.state.preload)&&(s.state.loading&3)===0&&(f.count++,s=Vh.bind(f),i.addEventListener("load",s),i.addEventListener("error",s))}}function w3(){if(af===null)throw Error(n(475));var i=af;return i.stylesheets&&i.count===0&&Ag(i,i.stylesheets),0<i.count?function(s){var c=setTimeout(function(){if(i.stylesheets&&Ag(i,i.stylesheets),i.unsuspend){var f=i.unsuspend;i.unsuspend=null,f()}},6e4);return i.unsuspend=s,function(){i.unsuspend=null,clearTimeout(c)}}:null}function Vh(){if(this.count--,this.count===0){if(this.stylesheets)Ag(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var jh=null;function Ag(i,s){i.stylesheets=null,i.unsuspend!==null&&(i.count++,jh=new Map,s.forEach(S3,i),jh=null,Vh.call(i))}function S3(i,s){if(!(s.state.loading&4)){var c=jh.get(i);if(c)var f=c.get(null);else{c=new Map,jh.set(i,c);for(var g=i.querySelectorAll("link[data-precedence],style[data-precedence]"),x=0;x<g.length;x++){var R=g[x];(R.nodeName==="LINK"||R.getAttribute("media")!=="not all")&&(c.set(R.dataset.precedence,R),f=R)}f&&c.set(null,f)}g=s.instance,R=g.getAttribute("data-precedence"),x=c.get(R)||f,x===f&&c.set(null,g),c.set(R,g),this.count++,f=Vh.bind(this),g.addEventListener("load",f),g.addEventListener("error",f),x?x.parentNode.insertBefore(g,x.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(g,i.firstChild)),s.state.loading|=4}}var sf={$$typeof:N,Provider:null,Consumer:null,_currentValue:Ue,_currentValue2:Ue,_threadCount:0};function A3(i,s,c,f,g,x,R,U){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ga(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ga(0),this.hiddenUpdates=Ga(null),this.identifierPrefix=f,this.onUncaughtError=g,this.onCaughtError=x,this.onRecoverableError=R,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=U,this.incompleteTransitions=new Map}function K2(i,s,c,f,g,x,R,U,re,de,be,Ie){return i=new A3(i,s,c,R,U,re,de,Ie),s=1,x===!0&&(s|=24),x=la(3,null,null,s),i.current=x,x.stateNode=i,s=sp(),s.refCount++,i.pooledCache=s,s.refCount++,x.memoizedState={element:f,isDehydrated:c,cache:s},up(x),i}function Y2(i){return i?(i=nc,i):nc}function $2(i,s,c,f,g,x){g=Y2(g),f.context===null?f.context=g:f.pendingContext=g,f=Ns(s),f.payload={element:c},x=x===void 0?null:x,x!==null&&(f.callback=x),c=Ds(i,f,s),c!==null&&(da(c,i,s),Pu(c,i,s))}function Q2(i,s){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var c=i.retryLane;i.retryLane=c!==0&&c<s?c:s}}function bg(i,s){Q2(i,s),(i=i.alternate)&&Q2(i,s)}function Z2(i){if(i.tag===13){var s=rc(i,67108864);s!==null&&da(s,i,67108864),bg(i,67108864)}}var Hh=!0;function b3(i,s,c,f){var g=ne.T;ne.T=null;var x=ue.p;try{ue.p=2,kg(i,s,c,f)}finally{ue.p=x,ne.T=g}}function k3(i,s,c,f){var g=ne.T;ne.T=null;var x=ue.p;try{ue.p=8,kg(i,s,c,f)}finally{ue.p=x,ne.T=g}}function kg(i,s,c,f){if(Hh){var g=Cg(f);if(g===null)mg(i,s,f,zh,c),eE(i,f);else if(R3(g,i,s,c,f))f.stopPropagation();else if(eE(i,f),s&4&&-1<C3.indexOf(i)){for(;g!==null;){var x=J(g);if(x!==null)switch(x.tag){case 3:if(x=x.stateNode,x.current.memoizedState.isDehydrated){var R=Kn(x.pendingLanes);if(R!==0){var U=x;for(U.pendingLanes|=2,U.entangledLanes|=2;R;){var re=1<<31-Ft(R);U.entanglements[1]|=re,R&=~re}Ei(x),(Yt&6)===0&&(bh=Le()+500,Zu(0))}}break;case 13:U=rc(x,2),U!==null&&da(U,x,2),Ch(),bg(x,2)}if(x=Cg(f),x===null&&mg(i,s,f,zh,c),x===g)break;g=x}g!==null&&f.stopPropagation()}else mg(i,s,f,null,c)}}function Cg(i){return i=Aa(i),Rg(i)}var zh=null;function Rg(i){if(zh=null,i=Y(i),i!==null){var s=o(i);if(s===null)i=null;else{var c=s.tag;if(c===13){if(i=l(s),i!==null)return i;i=null}else if(c===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;i=null}else s!==i&&(i=null)}}return zh=i,null}function J2(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ir()){case Lr:return 2;case Kr:return 8;case me:case We:return 32;case je:return 268435456;default:return 32}default:return 32}}var Ig=!1,qs=null,Ws=null,Xs=null,of=new Map,lf=new Map,Ks=[],C3="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function eE(i,s){switch(i){case"focusin":case"focusout":qs=null;break;case"dragenter":case"dragleave":Ws=null;break;case"mouseover":case"mouseout":Xs=null;break;case"pointerover":case"pointerout":of.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":lf.delete(s.pointerId)}}function cf(i,s,c,f,g,x){return i===null||i.nativeEvent!==x?(i={blockedOn:s,domEventName:c,eventSystemFlags:f,nativeEvent:x,targetContainers:[g]},s!==null&&(s=J(s),s!==null&&Z2(s)),i):(i.eventSystemFlags|=f,s=i.targetContainers,g!==null&&s.indexOf(g)===-1&&s.push(g),i)}function R3(i,s,c,f,g){switch(s){case"focusin":return qs=cf(qs,i,s,c,f,g),!0;case"dragenter":return Ws=cf(Ws,i,s,c,f,g),!0;case"mouseover":return Xs=cf(Xs,i,s,c,f,g),!0;case"pointerover":var x=g.pointerId;return of.set(x,cf(of.get(x)||null,i,s,c,f,g)),!0;case"gotpointercapture":return x=g.pointerId,lf.set(x,cf(lf.get(x)||null,i,s,c,f,g)),!0}return!1}function tE(i){var s=Y(i.target);if(s!==null){var c=o(s);if(c!==null){if(s=c.tag,s===13){if(s=l(c),s!==null){i.blockedOn=s,jl(i.priority,function(){if(c.tag===13){var f=ha();f=si(f);var g=rc(c,f);g!==null&&da(g,c,f),bg(c,f)}});return}}else if(s===3&&c.stateNode.current.memoizedState.isDehydrated){i.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Gh(i){if(i.blockedOn!==null)return!1;for(var s=i.targetContainers;0<s.length;){var c=Cg(i.nativeEvent);if(c===null){c=i.nativeEvent;var f=new c.constructor(c.type,c);zi=f,c.target.dispatchEvent(f),zi=null}else return s=J(c),s!==null&&Z2(s),i.blockedOn=c,!1;s.shift()}return!0}function rE(i,s,c){Gh(i)&&c.delete(s)}function I3(){Ig=!1,qs!==null&&Gh(qs)&&(qs=null),Ws!==null&&Gh(Ws)&&(Ws=null),Xs!==null&&Gh(Xs)&&(Xs=null),of.forEach(rE),lf.forEach(rE)}function qh(i,s){i.blockedOn===s&&(i.blockedOn=null,Ig||(Ig=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,I3)))}var Wh=null;function nE(i){Wh!==i&&(Wh=i,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){Wh===i&&(Wh=null);for(var s=0;s<i.length;s+=3){var c=i[s],f=i[s+1],g=i[s+2];if(typeof f!="function"){if(Rg(f||c)===null)continue;break}var x=J(c);x!==null&&(i.splice(s,3),s-=3,Rp(x,{pending:!0,data:g,method:c.method,action:f},f,g))}}))}function uf(i){function s(re){return qh(re,i)}qs!==null&&qh(qs,i),Ws!==null&&qh(Ws,i),Xs!==null&&qh(Xs,i),of.forEach(s),lf.forEach(s);for(var c=0;c<Ks.length;c++){var f=Ks[c];f.blockedOn===i&&(f.blockedOn=null)}for(;0<Ks.length&&(c=Ks[0],c.blockedOn===null);)tE(c),c.blockedOn===null&&Ks.shift();if(c=(i.ownerDocument||i).$$reactFormReplay,c!=null)for(f=0;f<c.length;f+=3){var g=c[f],x=c[f+1],R=g[gr]||null;if(typeof x=="function")R||nE(c);else if(R){var U=null;if(x&&x.hasAttribute("formAction")){if(g=x,R=x[gr]||null)U=R.formAction;else if(Rg(g)!==null)continue}else U=R.action;typeof U=="function"?c[f+1]=U:(c.splice(f,3),f-=3),nE(c)}}}function Ng(i){this._internalRoot=i}Xh.prototype.render=Ng.prototype.render=function(i){var s=this._internalRoot;if(s===null)throw Error(n(409));var c=s.current,f=ha();$2(c,f,i,s,null,null)},Xh.prototype.unmount=Ng.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var s=i.containerInfo;$2(i.current,2,null,i,null,null),Ch(),s[Yn]=null}};function Xh(i){this._internalRoot=i}Xh.prototype.unstable_scheduleHydration=function(i){if(i){var s=oi();i={blockedOn:null,target:i,priority:s};for(var c=0;c<Ks.length&&s!==0&&s<Ks[c].priority;c++);Ks.splice(c,0,i),c===0&&tE(i)}};var aE=e.version;if(aE!=="19.1.0")throw Error(n(527,aE,"19.1.0"));ue.findDOMNode=function(i){var s=i._reactInternals;if(s===void 0)throw typeof i.render=="function"?Error(n(188)):(i=Object.keys(i).join(","),Error(n(268,i)));return i=h(s),i=i!==null?d(i):null,i=i===null?null:i.stateNode,i};var N3={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:ne,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Kh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Kh.isDisabled&&Kh.supportsFiber)try{mt=Kh.inject(N3),vt=Kh}catch{}}return hf.createRoot=function(i,s){if(!a(i))throw Error(n(299));var c=!1,f="",g=yy,x=Ey,R=Ty,U=null;return s!=null&&(s.unstable_strictMode===!0&&(c=!0),s.identifierPrefix!==void 0&&(f=s.identifierPrefix),s.onUncaughtError!==void 0&&(g=s.onUncaughtError),s.onCaughtError!==void 0&&(x=s.onCaughtError),s.onRecoverableError!==void 0&&(R=s.onRecoverableError),s.unstable_transitionCallbacks!==void 0&&(U=s.unstable_transitionCallbacks)),s=K2(i,1,!1,null,null,c,f,g,x,R,U,null),i[Yn]=s.current,dg(i),new Ng(s)},hf.hydrateRoot=function(i,s,c){if(!a(i))throw Error(n(299));var f=!1,g="",x=yy,R=Ey,U=Ty,re=null,de=null;return c!=null&&(c.unstable_strictMode===!0&&(f=!0),c.identifierPrefix!==void 0&&(g=c.identifierPrefix),c.onUncaughtError!==void 0&&(x=c.onUncaughtError),c.onCaughtError!==void 0&&(R=c.onCaughtError),c.onRecoverableError!==void 0&&(U=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(re=c.unstable_transitionCallbacks),c.formState!==void 0&&(de=c.formState)),s=K2(i,1,!0,s,c??null,f,g,x,R,U,re,de),s.context=Y2(null),c=s.current,f=ha(),f=si(f),g=Ns(f),g.callback=null,Ds(c,g,f),c=f,s.current.lanes=c,qa(s,c),Ei(s),i[Yn]=s.current,dg(i),new Xh(s)},hf.version="19.1.0",hf}var mE;function H3(){if(mE)return Fg.exports;mE=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Fg.exports=j3(),Fg.exports}var z3=H3();const G3=cS(z3),q3=()=>{};var pE={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uS=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let a=t.charCodeAt(n);a<128?e[r++]=a:a<2048?(e[r++]=a>>6|192,e[r++]=a&63|128):(a&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(a=65536+((a&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=a>>18|240,e[r++]=a>>12&63|128,e[r++]=a>>6&63|128,e[r++]=a&63|128):(e[r++]=a>>12|224,e[r++]=a>>6&63|128,e[r++]=a&63|128)}return e},W3=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const a=t[r++];if(a<128)e[n++]=String.fromCharCode(a);else if(a>191&&a<224){const o=t[r++];e[n++]=String.fromCharCode((a&31)<<6|o&63)}else if(a>239&&a<365){const o=t[r++],l=t[r++],u=t[r++],h=((a&7)<<18|(o&63)<<12|(l&63)<<6|u&63)-65536;e[n++]=String.fromCharCode(55296+(h>>10)),e[n++]=String.fromCharCode(56320+(h&1023))}else{const o=t[r++],l=t[r++];e[n++]=String.fromCharCode((a&15)<<12|(o&63)<<6|l&63)}}return e.join("")},fS={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let a=0;a<t.length;a+=3){const o=t[a],l=a+1<t.length,u=l?t[a+1]:0,h=a+2<t.length,d=h?t[a+2]:0,p=o>>2,v=(o&3)<<4|u>>4;let _=(u&15)<<2|d>>6,E=d&63;h||(E=64,l||(_=64)),n.push(r[p],r[v],r[_],r[E])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(uS(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):W3(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let a=0;a<t.length;){const o=r[t.charAt(a++)],u=a<t.length?r[t.charAt(a)]:0;++a;const d=a<t.length?r[t.charAt(a)]:64;++a;const v=a<t.length?r[t.charAt(a)]:64;if(++a,o==null||u==null||d==null||v==null)throw new X3;const _=o<<2|u>>4;if(n.push(_),d!==64){const E=u<<4&240|d>>2;if(n.push(E),v!==64){const S=d<<6&192|v;n.push(S)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class X3 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const K3=function(t){const e=uS(t);return fS.encodeByteArray(e,!0)},kd=function(t){return K3(t).replace(/\./g,"")},hS=function(t){try{return fS.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y3(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $3=()=>Y3().__FIREBASE_DEFAULTS__,Q3=()=>{if(typeof process>"u"||typeof pE>"u")return;const t=pE.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},Z3=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&hS(t[1]);return e&&JSON.parse(e)},im=()=>{try{return q3()||$3()||Q3()||Z3()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},dS=t=>{var e,r;return(r=(e=im())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},mS=t=>{const e=dS(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},pS=()=>{var t;return(t=im())===null||t===void 0?void 0:t.config},gS=t=>{var e;return(e=im())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J3{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ao(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function ox(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xS(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",a=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:a,exp:a+3600,auth_time:a,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},t);return[kd(JSON.stringify(r)),kd(JSON.stringify(l)),""].join(".")}const Af={};function eR(){const t={prod:[],emulator:[]};for(const e of Object.keys(Af))Af[e]?t.emulator.push(e):t.prod.push(e);return t}function tR(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let gE=!1;function lx(t,e){if(typeof window>"u"||typeof document>"u"||!Ao(window.location.host)||Af[t]===e||Af[t]||gE)return;Af[t]=e;function r(_){return`__firebase__banner__${_}`}const n="__firebase__banner",o=eR().prod.length>0;function l(){const _=document.getElementById(n);_&&_.remove()}function u(_){_.style.display="flex",_.style.background="#7faaf0",_.style.position="fixed",_.style.bottom="5px",_.style.left="5px",_.style.padding=".5em",_.style.borderRadius="5px",_.style.alignItems="center"}function h(_,E){_.setAttribute("width","24"),_.setAttribute("id",E),_.setAttribute("height","24"),_.setAttribute("viewBox","0 0 24 24"),_.setAttribute("fill","none"),_.style.marginLeft="-6px"}function d(){const _=document.createElement("span");return _.style.cursor="pointer",_.style.marginLeft="16px",_.style.fontSize="24px",_.innerHTML=" &times;",_.onclick=()=>{gE=!0,l()},_}function p(_,E){_.setAttribute("id",E),_.innerText="Learn more",_.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",_.setAttribute("target","__blank"),_.style.paddingLeft="5px",_.style.textDecoration="underline"}function v(){const _=tR(n),E=r("text"),S=document.getElementById(E)||document.createElement("span"),y=r("learnmore"),w=document.getElementById(y)||document.createElement("a"),P=r("preprendIcon"),B=document.getElementById(P)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(_.created){const N=_.element;u(N),p(w,y);const z=d();h(B,P),N.append(B,S,w,z),document.body.appendChild(N)}o?(S.innerText="Preview backend disconnected.",B.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(B.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,S.innerText="Preview backend running in this workspace."),S.setAttribute("id",E)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",v):v()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function rR(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Fn())}function nR(){var t;const e=(t=im())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function aR(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function iR(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function sR(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function oR(){const t=Fn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function lR(){return!nR()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function cR(){try{return typeof indexedDB=="object"}catch{return!1}}function uR(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(n);a.onsuccess=()=>{a.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},a.onupgradeneeded=()=>{r=!1},a.onerror=()=>{var o;e(((o=a.error)===null||o===void 0?void 0:o.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fR="FirebaseError";class Ui extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=fR,Object.setPrototypeOf(this,Ui.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,u0.prototype.create)}}class u0{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},a=`${this.service}/${e}`,o=this.errors[e],l=o?hR(o,n):"Error",u=`${this.serviceName}: ${l} (${a}).`;return new Ui(a,u,n)}}function hR(t,e){return t.replace(dR,(r,n)=>{const a=e[n];return a!=null?String(a):`<${n}?>`})}const dR=/\{\$([^}]+)}/g;function mR(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function gl(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const a of r){if(!n.includes(a))return!1;const o=t[a],l=e[a];if(xE(o)&&xE(l)){if(!gl(o,l))return!1}else if(o!==l)return!1}for(const a of n)if(!r.includes(a))return!1;return!0}function xE(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f0(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(a=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function pf(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[a,o]=n.split("=");e[decodeURIComponent(a)]=decodeURIComponent(o)}}),e}function gf(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function pR(t,e){const r=new gR(t,e);return r.subscribe.bind(r)}class gR{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let a;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");xR(e,["next","error","complete"])?a=e:a={next:e,error:r,complete:n},a.next===void 0&&(a.next=Ug),a.error===void 0&&(a.error=Ug),a.complete===void 0&&(a.complete=Ug);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function xR(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function Ug(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function br(t){return t&&t._delegate?t._delegate:t}class ho{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ol="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vR{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new J3;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:r});a&&n.resolve(a)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),a=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(o){if(a)return null;throw o}else{if(a)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(yR(e))try{this.getOrInitializeService({instanceIdentifier:ol})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);try{const o=this.getOrInitializeService({instanceIdentifier:a});n.resolve(o)}catch{}}}}clearInstance(e=ol){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ol){return this.instances.has(e)}getOptions(e=ol){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[o,l]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(o);n===u&&l.resolve(a)}return a}onInit(e,r){var n;const a=this.normalizeInstanceIdentifier(r),o=(n=this.onInitCallbacks.get(a))!==null&&n!==void 0?n:new Set;o.add(e),this.onInitCallbacks.set(a,o);const l=this.instances.get(a);return l&&e(l,a),()=>{o.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const a of n)try{a(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:_R(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=ol){return this.component?this.component.multipleInstances?e:ol:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function _R(t){return t===ol?void 0:t}function yR(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ER{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new vR(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Dt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Dt||(Dt={}));const TR={debug:Dt.DEBUG,verbose:Dt.VERBOSE,info:Dt.INFO,warn:Dt.WARN,error:Dt.ERROR,silent:Dt.SILENT},wR=Dt.INFO,SR={[Dt.DEBUG]:"log",[Dt.VERBOSE]:"log",[Dt.INFO]:"info",[Dt.WARN]:"warn",[Dt.ERROR]:"error"},AR=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),a=SR[e];if(a)console[a](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class cx{constructor(e){this.name=e,this._logLevel=wR,this._logHandler=AR,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Dt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?TR[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Dt.DEBUG,...e),this._logHandler(this,Dt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Dt.VERBOSE,...e),this._logHandler(this,Dt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Dt.INFO,...e),this._logHandler(this,Dt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Dt.WARN,...e),this._logHandler(this,Dt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Dt.ERROR,...e),this._logHandler(this,Dt.ERROR,...e)}}const bR=(t,e)=>e.some(r=>t instanceof r);let vE,_E;function kR(){return vE||(vE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function CR(){return _E||(_E=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const vS=new WeakMap,g1=new WeakMap,_S=new WeakMap,Bg=new WeakMap,ux=new WeakMap;function RR(t){const e=new Promise((r,n)=>{const a=()=>{t.removeEventListener("success",o),t.removeEventListener("error",l)},o=()=>{r(oo(t.result)),a()},l=()=>{n(t.error),a()};t.addEventListener("success",o),t.addEventListener("error",l)});return e.then(r=>{r instanceof IDBCursor&&vS.set(r,t)}).catch(()=>{}),ux.set(e,t),e}function IR(t){if(g1.has(t))return;const e=new Promise((r,n)=>{const a=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",l),t.removeEventListener("abort",l)},o=()=>{r(),a()},l=()=>{n(t.error||new DOMException("AbortError","AbortError")),a()};t.addEventListener("complete",o),t.addEventListener("error",l),t.addEventListener("abort",l)});g1.set(t,e)}let x1={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return g1.get(t);if(e==="objectStoreNames")return t.objectStoreNames||_S.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return oo(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function NR(t){x1=t(x1)}function DR(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(Vg(this),e,...r);return _S.set(n,e.sort?e.sort():[e]),oo(n)}:CR().includes(t)?function(...e){return t.apply(Vg(this),e),oo(vS.get(this))}:function(...e){return oo(t.apply(Vg(this),e))}}function OR(t){return typeof t=="function"?DR(t):(t instanceof IDBTransaction&&IR(t),bR(t,kR())?new Proxy(t,x1):t)}function oo(t){if(t instanceof IDBRequest)return RR(t);if(Bg.has(t))return Bg.get(t);const e=OR(t);return e!==t&&(Bg.set(t,e),ux.set(e,t)),e}const Vg=t=>ux.get(t);function FR(t,e,{blocked:r,upgrade:n,blocking:a,terminated:o}={}){const l=indexedDB.open(t,e),u=oo(l);return n&&l.addEventListener("upgradeneeded",h=>{n(oo(l.result),h.oldVersion,h.newVersion,oo(l.transaction),h)}),r&&l.addEventListener("blocked",h=>r(h.oldVersion,h.newVersion,h)),u.then(h=>{o&&h.addEventListener("close",()=>o()),a&&h.addEventListener("versionchange",d=>a(d.oldVersion,d.newVersion,d))}).catch(()=>{}),u}const PR=["get","getKey","getAll","getAllKeys","count"],MR=["put","add","delete","clear"],jg=new Map;function yE(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(jg.get(e))return jg.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,a=MR.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(a||PR.includes(r)))return;const o=async function(l,...u){const h=this.transaction(l,a?"readwrite":"readonly");let d=h.store;return n&&(d=d.index(u.shift())),(await Promise.all([d[r](...u),a&&h.done]))[0]};return jg.set(e,o),o}NR(t=>({...t,get:(e,r,n)=>yE(e,r)||t.get(e,r,n),has:(e,r)=>!!yE(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LR{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(UR(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function UR(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const v1="@firebase/app",EE="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ms=new cx("@firebase/app"),BR="@firebase/app-compat",VR="@firebase/analytics-compat",jR="@firebase/analytics",HR="@firebase/app-check-compat",zR="@firebase/app-check",GR="@firebase/auth",qR="@firebase/auth-compat",WR="@firebase/database",XR="@firebase/data-connect",KR="@firebase/database-compat",YR="@firebase/functions",$R="@firebase/functions-compat",QR="@firebase/installations",ZR="@firebase/installations-compat",JR="@firebase/messaging",eI="@firebase/messaging-compat",tI="@firebase/performance",rI="@firebase/performance-compat",nI="@firebase/remote-config",aI="@firebase/remote-config-compat",iI="@firebase/storage",sI="@firebase/storage-compat",oI="@firebase/firestore",lI="@firebase/ai",cI="@firebase/firestore-compat",uI="firebase",fI="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _1="[DEFAULT]",hI={[v1]:"fire-core",[BR]:"fire-core-compat",[jR]:"fire-analytics",[VR]:"fire-analytics-compat",[zR]:"fire-app-check",[HR]:"fire-app-check-compat",[GR]:"fire-auth",[qR]:"fire-auth-compat",[WR]:"fire-rtdb",[XR]:"fire-data-connect",[KR]:"fire-rtdb-compat",[YR]:"fire-fn",[$R]:"fire-fn-compat",[QR]:"fire-iid",[ZR]:"fire-iid-compat",[JR]:"fire-fcm",[eI]:"fire-fcm-compat",[tI]:"fire-perf",[rI]:"fire-perf-compat",[nI]:"fire-rc",[aI]:"fire-rc-compat",[iI]:"fire-gcs",[sI]:"fire-gcs-compat",[oI]:"fire-fst",[cI]:"fire-fst-compat",[lI]:"fire-vertex","fire-js":"fire-js",[uI]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xc=new Map,y1=new Map,E1=new Map;function TE(t,e){try{t.container.addComponent(e)}catch(r){ms.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function xl(t){const e=t.name;if(E1.has(e))return ms.debug(`There were multiple attempts to register component ${e}.`),!1;E1.set(e,t);for(const r of Xc.values())TE(r,t);for(const r of y1.values())TE(r,t);return!0}function sm(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function ga(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dI={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},lo=new u0("app","Firebase",dI);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mI{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new ho("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw lo.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Il=fI;function fx(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:_1,automaticDataCollectionEnabled:!0},e),a=n.name;if(typeof a!="string"||!a)throw lo.create("bad-app-name",{appName:String(a)});if(r||(r=pS()),!r)throw lo.create("no-options");const o=Xc.get(a);if(o){if(gl(r,o.options)&&gl(n,o.config))return o;throw lo.create("duplicate-app",{appName:a})}const l=new ER(a);for(const h of E1.values())l.addComponent(h);const u=new mI(r,n,l);return Xc.set(a,u),u}function hx(t=_1){const e=Xc.get(t);if(!e&&t===_1&&pS())return fx();if(!e)throw lo.create("no-app",{appName:t});return e}async function pI(t){let e=!1;const r=t.name;Xc.has(r)?(e=!0,Xc.delete(r)):y1.has(r)&&t.decRefCount()<=0&&(y1.delete(r),e=!0),e&&(await Promise.all(t.container.getProviders().map(n=>n.delete())),t.isDeleted=!0)}function Ri(t,e,r){var n;let a=(n=hI[t])!==null&&n!==void 0?n:t;r&&(a+=`-${r}`);const o=a.match(/\s|\//),l=e.match(/\s|\//);if(o||l){const u=[`Unable to register library "${a}" with version "${e}":`];o&&u.push(`library name "${a}" contains illegal characters (whitespace or "/")`),o&&l&&u.push("and"),l&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ms.warn(u.join(" "));return}xl(new ho(`${a}-version`,()=>({library:a,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gI="firebase-heartbeat-database",xI=1,jf="firebase-heartbeat-store";let Hg=null;function yS(){return Hg||(Hg=FR(gI,xI,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(jf)}catch(r){console.warn(r)}}}}).catch(t=>{throw lo.create("idb-open",{originalErrorMessage:t.message})})),Hg}async function vI(t){try{const r=(await yS()).transaction(jf),n=await r.objectStore(jf).get(ES(t));return await r.done,n}catch(e){if(e instanceof Ui)ms.warn(e.message);else{const r=lo.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ms.warn(r.message)}}}async function wE(t,e){try{const n=(await yS()).transaction(jf,"readwrite");await n.objectStore(jf).put(e,ES(t)),await n.done}catch(r){if(r instanceof Ui)ms.warn(r.message);else{const n=lo.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});ms.warn(n.message)}}}function ES(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _I=1024,yI=30;class EI{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new wI(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=SE();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(l=>l.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:a}),this._heartbeatsCache.heartbeats.length>yI){const l=SI(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){ms.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=SE(),{heartbeatsToSend:n,unsentEntries:a}=TI(this._heartbeatsCache.heartbeats),o=kd(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(r){return ms.warn(r),""}}}function SE(){return new Date().toISOString().substring(0,10)}function TI(t,e=_I){const r=[];let n=t.slice();for(const a of t){const o=r.find(l=>l.agent===a.agent);if(o){if(o.dates.push(a.date),AE(r)>e){o.dates.pop();break}}else if(r.push({agent:a.agent,dates:[a.date]}),AE(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class wI{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return cR()?uR().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await vI(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const a=await this.read();return wE(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:a.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const a=await this.read();return wE(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...e.heartbeats]})}else return}}function AE(t){return kd(JSON.stringify({version:2,heartbeats:t})).length}function SI(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AI(t){xl(new ho("platform-logger",e=>new LR(e),"PRIVATE")),xl(new ho("heartbeat",e=>new EI(e),"PRIVATE")),Ri(v1,EE,t),Ri(v1,EE,"esm2017"),Ri("fire-js","")}AI("");var bI="firebase",kI="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ri(bI,kI,"app");var bE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var co,TS;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(C,I){function b(){}b.prototype=I.prototype,C.D=I.prototype,C.prototype=new b,C.prototype.constructor=C,C.C=function(O,L,M){for(var D=Array(arguments.length-2),Ee=2;Ee<arguments.length;Ee++)D[Ee-2]=arguments[Ee];return I.prototype[L].apply(O,D)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(C,I,b){b||(b=0);var O=Array(16);if(typeof I=="string")for(var L=0;16>L;++L)O[L]=I.charCodeAt(b++)|I.charCodeAt(b++)<<8|I.charCodeAt(b++)<<16|I.charCodeAt(b++)<<24;else for(L=0;16>L;++L)O[L]=I[b++]|I[b++]<<8|I[b++]<<16|I[b++]<<24;I=C.g[0],b=C.g[1],L=C.g[2];var M=C.g[3],D=I+(M^b&(L^M))+O[0]+3614090360&4294967295;I=b+(D<<7&4294967295|D>>>25),D=M+(L^I&(b^L))+O[1]+3905402710&4294967295,M=I+(D<<12&4294967295|D>>>20),D=L+(b^M&(I^b))+O[2]+606105819&4294967295,L=M+(D<<17&4294967295|D>>>15),D=b+(I^L&(M^I))+O[3]+3250441966&4294967295,b=L+(D<<22&4294967295|D>>>10),D=I+(M^b&(L^M))+O[4]+4118548399&4294967295,I=b+(D<<7&4294967295|D>>>25),D=M+(L^I&(b^L))+O[5]+1200080426&4294967295,M=I+(D<<12&4294967295|D>>>20),D=L+(b^M&(I^b))+O[6]+2821735955&4294967295,L=M+(D<<17&4294967295|D>>>15),D=b+(I^L&(M^I))+O[7]+4249261313&4294967295,b=L+(D<<22&4294967295|D>>>10),D=I+(M^b&(L^M))+O[8]+1770035416&4294967295,I=b+(D<<7&4294967295|D>>>25),D=M+(L^I&(b^L))+O[9]+2336552879&4294967295,M=I+(D<<12&4294967295|D>>>20),D=L+(b^M&(I^b))+O[10]+4294925233&4294967295,L=M+(D<<17&4294967295|D>>>15),D=b+(I^L&(M^I))+O[11]+2304563134&4294967295,b=L+(D<<22&4294967295|D>>>10),D=I+(M^b&(L^M))+O[12]+1804603682&4294967295,I=b+(D<<7&4294967295|D>>>25),D=M+(L^I&(b^L))+O[13]+4254626195&4294967295,M=I+(D<<12&4294967295|D>>>20),D=L+(b^M&(I^b))+O[14]+2792965006&4294967295,L=M+(D<<17&4294967295|D>>>15),D=b+(I^L&(M^I))+O[15]+1236535329&4294967295,b=L+(D<<22&4294967295|D>>>10),D=I+(L^M&(b^L))+O[1]+4129170786&4294967295,I=b+(D<<5&4294967295|D>>>27),D=M+(b^L&(I^b))+O[6]+3225465664&4294967295,M=I+(D<<9&4294967295|D>>>23),D=L+(I^b&(M^I))+O[11]+643717713&4294967295,L=M+(D<<14&4294967295|D>>>18),D=b+(M^I&(L^M))+O[0]+3921069994&4294967295,b=L+(D<<20&4294967295|D>>>12),D=I+(L^M&(b^L))+O[5]+3593408605&4294967295,I=b+(D<<5&4294967295|D>>>27),D=M+(b^L&(I^b))+O[10]+38016083&4294967295,M=I+(D<<9&4294967295|D>>>23),D=L+(I^b&(M^I))+O[15]+3634488961&4294967295,L=M+(D<<14&4294967295|D>>>18),D=b+(M^I&(L^M))+O[4]+3889429448&4294967295,b=L+(D<<20&4294967295|D>>>12),D=I+(L^M&(b^L))+O[9]+568446438&4294967295,I=b+(D<<5&4294967295|D>>>27),D=M+(b^L&(I^b))+O[14]+3275163606&4294967295,M=I+(D<<9&4294967295|D>>>23),D=L+(I^b&(M^I))+O[3]+4107603335&4294967295,L=M+(D<<14&4294967295|D>>>18),D=b+(M^I&(L^M))+O[8]+1163531501&4294967295,b=L+(D<<20&4294967295|D>>>12),D=I+(L^M&(b^L))+O[13]+2850285829&4294967295,I=b+(D<<5&4294967295|D>>>27),D=M+(b^L&(I^b))+O[2]+4243563512&4294967295,M=I+(D<<9&4294967295|D>>>23),D=L+(I^b&(M^I))+O[7]+1735328473&4294967295,L=M+(D<<14&4294967295|D>>>18),D=b+(M^I&(L^M))+O[12]+2368359562&4294967295,b=L+(D<<20&4294967295|D>>>12),D=I+(b^L^M)+O[5]+4294588738&4294967295,I=b+(D<<4&4294967295|D>>>28),D=M+(I^b^L)+O[8]+2272392833&4294967295,M=I+(D<<11&4294967295|D>>>21),D=L+(M^I^b)+O[11]+1839030562&4294967295,L=M+(D<<16&4294967295|D>>>16),D=b+(L^M^I)+O[14]+4259657740&4294967295,b=L+(D<<23&4294967295|D>>>9),D=I+(b^L^M)+O[1]+2763975236&4294967295,I=b+(D<<4&4294967295|D>>>28),D=M+(I^b^L)+O[4]+1272893353&4294967295,M=I+(D<<11&4294967295|D>>>21),D=L+(M^I^b)+O[7]+4139469664&4294967295,L=M+(D<<16&4294967295|D>>>16),D=b+(L^M^I)+O[10]+3200236656&4294967295,b=L+(D<<23&4294967295|D>>>9),D=I+(b^L^M)+O[13]+681279174&4294967295,I=b+(D<<4&4294967295|D>>>28),D=M+(I^b^L)+O[0]+3936430074&4294967295,M=I+(D<<11&4294967295|D>>>21),D=L+(M^I^b)+O[3]+3572445317&4294967295,L=M+(D<<16&4294967295|D>>>16),D=b+(L^M^I)+O[6]+76029189&4294967295,b=L+(D<<23&4294967295|D>>>9),D=I+(b^L^M)+O[9]+3654602809&4294967295,I=b+(D<<4&4294967295|D>>>28),D=M+(I^b^L)+O[12]+3873151461&4294967295,M=I+(D<<11&4294967295|D>>>21),D=L+(M^I^b)+O[15]+530742520&4294967295,L=M+(D<<16&4294967295|D>>>16),D=b+(L^M^I)+O[2]+3299628645&4294967295,b=L+(D<<23&4294967295|D>>>9),D=I+(L^(b|~M))+O[0]+4096336452&4294967295,I=b+(D<<6&4294967295|D>>>26),D=M+(b^(I|~L))+O[7]+1126891415&4294967295,M=I+(D<<10&4294967295|D>>>22),D=L+(I^(M|~b))+O[14]+2878612391&4294967295,L=M+(D<<15&4294967295|D>>>17),D=b+(M^(L|~I))+O[5]+4237533241&4294967295,b=L+(D<<21&4294967295|D>>>11),D=I+(L^(b|~M))+O[12]+1700485571&4294967295,I=b+(D<<6&4294967295|D>>>26),D=M+(b^(I|~L))+O[3]+2399980690&4294967295,M=I+(D<<10&4294967295|D>>>22),D=L+(I^(M|~b))+O[10]+4293915773&4294967295,L=M+(D<<15&4294967295|D>>>17),D=b+(M^(L|~I))+O[1]+2240044497&4294967295,b=L+(D<<21&4294967295|D>>>11),D=I+(L^(b|~M))+O[8]+1873313359&4294967295,I=b+(D<<6&4294967295|D>>>26),D=M+(b^(I|~L))+O[15]+4264355552&4294967295,M=I+(D<<10&4294967295|D>>>22),D=L+(I^(M|~b))+O[6]+2734768916&4294967295,L=M+(D<<15&4294967295|D>>>17),D=b+(M^(L|~I))+O[13]+1309151649&4294967295,b=L+(D<<21&4294967295|D>>>11),D=I+(L^(b|~M))+O[4]+4149444226&4294967295,I=b+(D<<6&4294967295|D>>>26),D=M+(b^(I|~L))+O[11]+3174756917&4294967295,M=I+(D<<10&4294967295|D>>>22),D=L+(I^(M|~b))+O[2]+718787259&4294967295,L=M+(D<<15&4294967295|D>>>17),D=b+(M^(L|~I))+O[9]+3951481745&4294967295,C.g[0]=C.g[0]+I&4294967295,C.g[1]=C.g[1]+(L+(D<<21&4294967295|D>>>11))&4294967295,C.g[2]=C.g[2]+L&4294967295,C.g[3]=C.g[3]+M&4294967295}n.prototype.u=function(C,I){I===void 0&&(I=C.length);for(var b=I-this.blockSize,O=this.B,L=this.h,M=0;M<I;){if(L==0)for(;M<=b;)a(this,C,M),M+=this.blockSize;if(typeof C=="string"){for(;M<I;)if(O[L++]=C.charCodeAt(M++),L==this.blockSize){a(this,O),L=0;break}}else for(;M<I;)if(O[L++]=C[M++],L==this.blockSize){a(this,O),L=0;break}}this.h=L,this.o+=I},n.prototype.v=function(){var C=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);C[0]=128;for(var I=1;I<C.length-8;++I)C[I]=0;var b=8*this.o;for(I=C.length-8;I<C.length;++I)C[I]=b&255,b/=256;for(this.u(C),C=Array(16),I=b=0;4>I;++I)for(var O=0;32>O;O+=8)C[b++]=this.g[I]>>>O&255;return C};function o(C,I){var b=u;return Object.prototype.hasOwnProperty.call(b,C)?b[C]:b[C]=I(C)}function l(C,I){this.h=I;for(var b=[],O=!0,L=C.length-1;0<=L;L--){var M=C[L]|0;O&&M==I||(b[L]=M,O=!1)}this.g=b}var u={};function h(C){return-128<=C&&128>C?o(C,function(I){return new l([I|0],0>I?-1:0)}):new l([C|0],0>C?-1:0)}function d(C){if(isNaN(C)||!isFinite(C))return v;if(0>C)return w(d(-C));for(var I=[],b=1,O=0;C>=b;O++)I[O]=C/b|0,b*=4294967296;return new l(I,0)}function p(C,I){if(C.length==0)throw Error("number format error: empty string");if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(C.charAt(0)=="-")return w(p(C.substring(1),I));if(0<=C.indexOf("-"))throw Error('number format error: interior "-" character');for(var b=d(Math.pow(I,8)),O=v,L=0;L<C.length;L+=8){var M=Math.min(8,C.length-L),D=parseInt(C.substring(L,L+M),I);8>M?(M=d(Math.pow(I,M)),O=O.j(M).add(d(D))):(O=O.j(b),O=O.add(d(D)))}return O}var v=h(0),_=h(1),E=h(16777216);t=l.prototype,t.m=function(){if(y(this))return-w(this).m();for(var C=0,I=1,b=0;b<this.g.length;b++){var O=this.i(b);C+=(0<=O?O:4294967296+O)*I,I*=4294967296}return C},t.toString=function(C){if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if(S(this))return"0";if(y(this))return"-"+w(this).toString(C);for(var I=d(Math.pow(C,6)),b=this,O="";;){var L=z(b,I).g;b=P(b,L.j(I));var M=((0<b.g.length?b.g[0]:b.h)>>>0).toString(C);if(b=L,S(b))return M+O;for(;6>M.length;)M="0"+M;O=M+O}},t.i=function(C){return 0>C?0:C<this.g.length?this.g[C]:this.h};function S(C){if(C.h!=0)return!1;for(var I=0;I<C.g.length;I++)if(C.g[I]!=0)return!1;return!0}function y(C){return C.h==-1}t.l=function(C){return C=P(this,C),y(C)?-1:S(C)?0:1};function w(C){for(var I=C.g.length,b=[],O=0;O<I;O++)b[O]=~C.g[O];return new l(b,~C.h).add(_)}t.abs=function(){return y(this)?w(this):this},t.add=function(C){for(var I=Math.max(this.g.length,C.g.length),b=[],O=0,L=0;L<=I;L++){var M=O+(this.i(L)&65535)+(C.i(L)&65535),D=(M>>>16)+(this.i(L)>>>16)+(C.i(L)>>>16);O=D>>>16,M&=65535,D&=65535,b[L]=D<<16|M}return new l(b,b[b.length-1]&-2147483648?-1:0)};function P(C,I){return C.add(w(I))}t.j=function(C){if(S(this)||S(C))return v;if(y(this))return y(C)?w(this).j(w(C)):w(w(this).j(C));if(y(C))return w(this.j(w(C)));if(0>this.l(E)&&0>C.l(E))return d(this.m()*C.m());for(var I=this.g.length+C.g.length,b=[],O=0;O<2*I;O++)b[O]=0;for(O=0;O<this.g.length;O++)for(var L=0;L<C.g.length;L++){var M=this.i(O)>>>16,D=this.i(O)&65535,Ee=C.i(L)>>>16,Te=C.i(L)&65535;b[2*O+2*L]+=D*Te,B(b,2*O+2*L),b[2*O+2*L+1]+=M*Te,B(b,2*O+2*L+1),b[2*O+2*L+1]+=D*Ee,B(b,2*O+2*L+1),b[2*O+2*L+2]+=M*Ee,B(b,2*O+2*L+2)}for(O=0;O<I;O++)b[O]=b[2*O+1]<<16|b[2*O];for(O=I;O<2*I;O++)b[O]=0;return new l(b,0)};function B(C,I){for(;(C[I]&65535)!=C[I];)C[I+1]+=C[I]>>>16,C[I]&=65535,I++}function N(C,I){this.g=C,this.h=I}function z(C,I){if(S(I))throw Error("division by zero");if(S(C))return new N(v,v);if(y(C))return I=z(w(C),I),new N(w(I.g),w(I.h));if(y(I))return I=z(C,w(I)),new N(w(I.g),I.h);if(30<C.g.length){if(y(C)||y(I))throw Error("slowDivide_ only works with positive integers.");for(var b=_,O=I;0>=O.l(C);)b=q(b),O=q(O);var L=Z(b,1),M=Z(O,1);for(O=Z(O,2),b=Z(b,2);!S(O);){var D=M.add(O);0>=D.l(C)&&(L=L.add(b),M=D),O=Z(O,1),b=Z(b,1)}return I=P(C,L.j(I)),new N(L,I)}for(L=v;0<=C.l(I);){for(b=Math.max(1,Math.floor(C.m()/I.m())),O=Math.ceil(Math.log(b)/Math.LN2),O=48>=O?1:Math.pow(2,O-48),M=d(b),D=M.j(I);y(D)||0<D.l(C);)b-=O,M=d(b),D=M.j(I);S(M)&&(M=_),L=L.add(M),C=P(C,D)}return new N(L,C)}t.A=function(C){return z(this,C).h},t.and=function(C){for(var I=Math.max(this.g.length,C.g.length),b=[],O=0;O<I;O++)b[O]=this.i(O)&C.i(O);return new l(b,this.h&C.h)},t.or=function(C){for(var I=Math.max(this.g.length,C.g.length),b=[],O=0;O<I;O++)b[O]=this.i(O)|C.i(O);return new l(b,this.h|C.h)},t.xor=function(C){for(var I=Math.max(this.g.length,C.g.length),b=[],O=0;O<I;O++)b[O]=this.i(O)^C.i(O);return new l(b,this.h^C.h)};function q(C){for(var I=C.g.length+1,b=[],O=0;O<I;O++)b[O]=C.i(O)<<1|C.i(O-1)>>>31;return new l(b,C.h)}function Z(C,I){var b=I>>5;I%=32;for(var O=C.g.length-b,L=[],M=0;M<O;M++)L[M]=0<I?C.i(M+b)>>>I|C.i(M+b+1)<<32-I:C.i(M+b);return new l(L,C.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,TS=n,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.A,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=d,l.fromString=p,co=l}).apply(typeof bE<"u"?bE:typeof self<"u"?self:typeof window<"u"?window:{});var Yh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var wS,xf,SS,gd,T1,AS,bS,kS;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(m,T,k){return m==Array.prototype||m==Object.prototype||(m[T]=k.value),m};function r(m){m=[typeof globalThis=="object"&&globalThis,m,typeof window=="object"&&window,typeof self=="object"&&self,typeof Yh=="object"&&Yh];for(var T=0;T<m.length;++T){var k=m[T];if(k&&k.Math==Math)return k}throw Error("Cannot find global object")}var n=r(this);function a(m,T){if(T)e:{var k=n;m=m.split(".");for(var j=0;j<m.length-1;j++){var ce=m[j];if(!(ce in k))break e;k=k[ce]}m=m[m.length-1],j=k[m],T=T(j),T!=j&&T!=null&&e(k,m,{configurable:!0,writable:!0,value:T})}}function o(m,T){m instanceof String&&(m+="");var k=0,j=!1,ce={next:function(){if(!j&&k<m.length){var Se=k++;return{value:T(Se,m[Se]),done:!1}}return j=!0,{done:!0,value:void 0}}};return ce[Symbol.iterator]=function(){return ce},ce}a("Array.prototype.values",function(m){return m||function(){return o(this,function(T,k){return k})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var l=l||{},u=this||self;function h(m){var T=typeof m;return T=T!="object"?T:m?Array.isArray(m)?"array":T:"null",T=="array"||T=="object"&&typeof m.length=="number"}function d(m){var T=typeof m;return T=="object"&&m!=null||T=="function"}function p(m,T,k){return m.call.apply(m.bind,arguments)}function v(m,T,k){if(!m)throw Error();if(2<arguments.length){var j=Array.prototype.slice.call(arguments,2);return function(){var ce=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ce,j),m.apply(T,ce)}}return function(){return m.apply(T,arguments)}}function _(m,T,k){return _=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:v,_.apply(null,arguments)}function E(m,T){var k=Array.prototype.slice.call(arguments,1);return function(){var j=k.slice();return j.push.apply(j,arguments),m.apply(this,j)}}function S(m,T){function k(){}k.prototype=T.prototype,m.aa=T.prototype,m.prototype=new k,m.prototype.constructor=m,m.Qb=function(j,ce,Se){for(var ze=Array(arguments.length-2),Lt=2;Lt<arguments.length;Lt++)ze[Lt-2]=arguments[Lt];return T.prototype[ce].apply(j,ze)}}function y(m){const T=m.length;if(0<T){const k=Array(T);for(let j=0;j<T;j++)k[j]=m[j];return k}return[]}function w(m,T){for(let k=1;k<arguments.length;k++){const j=arguments[k];if(h(j)){const ce=m.length||0,Se=j.length||0;m.length=ce+Se;for(let ze=0;ze<Se;ze++)m[ce+ze]=j[ze]}else m.push(j)}}class P{constructor(T,k){this.i=T,this.j=k,this.h=0,this.g=null}get(){let T;return 0<this.h?(this.h--,T=this.g,this.g=T.next,T.next=null):T=this.i(),T}}function B(m){return/^[\s\xa0]*$/.test(m)}function N(){var m=u.navigator;return m&&(m=m.userAgent)?m:""}function z(m){return z[" "](m),m}z[" "]=function(){};var q=N().indexOf("Gecko")!=-1&&!(N().toLowerCase().indexOf("webkit")!=-1&&N().indexOf("Edge")==-1)&&!(N().indexOf("Trident")!=-1||N().indexOf("MSIE")!=-1)&&N().indexOf("Edge")==-1;function Z(m,T,k){for(const j in m)T.call(k,m[j],j,m)}function C(m,T){for(const k in m)T.call(void 0,m[k],k,m)}function I(m){const T={};for(const k in m)T[k]=m[k];return T}const b="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function O(m,T){let k,j;for(let ce=1;ce<arguments.length;ce++){j=arguments[ce];for(k in j)m[k]=j[k];for(let Se=0;Se<b.length;Se++)k=b[Se],Object.prototype.hasOwnProperty.call(j,k)&&(m[k]=j[k])}}function L(m){var T=1;m=m.split(":");const k=[];for(;0<T&&m.length;)k.push(m.shift()),T--;return m.length&&k.push(m.join(":")),k}function M(m){u.setTimeout(()=>{throw m},0)}function D(){var m=ie;let T=null;return m.g&&(T=m.g,m.g=m.g.next,m.g||(m.h=null),T.next=null),T}class Ee{constructor(){this.h=this.g=null}add(T,k){const j=Te.get();j.set(T,k),this.h?this.h.next=j:this.g=j,this.h=j}}var Te=new P(()=>new ne,m=>m.reset());class ne{constructor(){this.next=this.g=this.h=null}set(T,k){this.h=T,this.g=k,this.next=null}reset(){this.next=this.g=this.h=null}}let ue,Ue=!1,ie=new Ee,K=()=>{const m=u.Promise.resolve(void 0);ue=()=>{m.then(pe)}};var pe=()=>{for(var m;m=D();){try{m.h.call(m.g)}catch(k){M(k)}var T=Te;T.j(m),100>T.h&&(T.h++,m.next=T.g,T.g=m)}Ue=!1};function V(){this.s=this.s,this.C=this.C}V.prototype.s=!1,V.prototype.ma=function(){this.s||(this.s=!0,this.N())},V.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function X(m,T){this.type=m,this.g=this.target=T,this.defaultPrevented=!1}X.prototype.h=function(){this.defaultPrevented=!0};var ee=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var m=!1,T=Object.defineProperty({},"passive",{get:function(){m=!0}});try{const k=()=>{};u.addEventListener("test",k,T),u.removeEventListener("test",k,T)}catch{}return m}();function te(m,T){if(X.call(this,m?m.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,m){var k=this.type=m.type,j=m.changedTouches&&m.changedTouches.length?m.changedTouches[0]:null;if(this.target=m.target||m.srcElement,this.g=T,T=m.relatedTarget){if(q){e:{try{z(T.nodeName);var ce=!0;break e}catch{}ce=!1}ce||(T=null)}}else k=="mouseover"?T=m.fromElement:k=="mouseout"&&(T=m.toElement);this.relatedTarget=T,j?(this.clientX=j.clientX!==void 0?j.clientX:j.pageX,this.clientY=j.clientY!==void 0?j.clientY:j.pageY,this.screenX=j.screenX||0,this.screenY=j.screenY||0):(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0),this.button=m.button,this.key=m.key||"",this.ctrlKey=m.ctrlKey,this.altKey=m.altKey,this.shiftKey=m.shiftKey,this.metaKey=m.metaKey,this.pointerId=m.pointerId||0,this.pointerType=typeof m.pointerType=="string"?m.pointerType:le[m.pointerType]||"",this.state=m.state,this.i=m,m.defaultPrevented&&te.aa.h.call(this)}}S(te,X);var le={2:"touch",3:"pen",4:"mouse"};te.prototype.h=function(){te.aa.h.call(this);var m=this.i;m.preventDefault?m.preventDefault():m.returnValue=!1};var Ne="closure_listenable_"+(1e6*Math.random()|0),ke=0;function Oe(m,T,k,j,ce){this.listener=m,this.proxy=null,this.src=T,this.type=k,this.capture=!!j,this.ha=ce,this.key=++ke,this.da=this.fa=!1}function _e(m){m.da=!0,m.listener=null,m.proxy=null,m.src=null,m.ha=null}function Be(m){this.src=m,this.g={},this.h=0}Be.prototype.add=function(m,T,k,j,ce){var Se=m.toString();m=this.g[Se],m||(m=this.g[Se]=[],this.h++);var ze=nt(m,T,j,ce);return-1<ze?(T=m[ze],k||(T.fa=!1)):(T=new Oe(T,this.src,Se,!!j,ce),T.fa=k,m.push(T)),T};function W(m,T){var k=T.type;if(k in m.g){var j=m.g[k],ce=Array.prototype.indexOf.call(j,T,void 0),Se;(Se=0<=ce)&&Array.prototype.splice.call(j,ce,1),Se&&(_e(T),m.g[k].length==0&&(delete m.g[k],m.h--))}}function nt(m,T,k,j){for(var ce=0;ce<m.length;++ce){var Se=m[ce];if(!Se.da&&Se.listener==T&&Se.capture==!!k&&Se.ha==j)return ce}return-1}var it="closure_lm_"+(1e6*Math.random()|0),wt={};function st(m,T,k,j,ce){if(Array.isArray(T)){for(var Se=0;Se<T.length;Se++)st(m,T[Se],k,j,ce);return null}return k=Nt(k),m&&m[Ne]?m.K(T,k,d(j)?!!j.capture:!1,ce):Le(m,T,k,!1,j,ce)}function Le(m,T,k,j,ce,Se){if(!T)throw Error("Invalid event type");var ze=d(ce)?!!ce.capture:!!ce,Lt=je(m);if(Lt||(m[it]=Lt=new Be(m)),k=Lt.add(T,k,j,ze,Se),k.proxy)return k;if(j=ir(),k.proxy=j,j.src=m,j.listener=k,m.addEventListener)ee||(ce=ze),ce===void 0&&(ce=!1),m.addEventListener(T.toString(),j,ce);else if(m.attachEvent)m.attachEvent(me(T.toString()),j);else if(m.addListener&&m.removeListener)m.addListener(j);else throw Error("addEventListener and attachEvent are unavailable.");return k}function ir(){function m(k){return T.call(m.src,m.listener,k)}const T=We;return m}function Lr(m,T,k,j,ce){if(Array.isArray(T))for(var Se=0;Se<T.length;Se++)Lr(m,T[Se],k,j,ce);else j=d(j)?!!j.capture:!!j,k=Nt(k),m&&m[Ne]?(m=m.i,T=String(T).toString(),T in m.g&&(Se=m.g[T],k=nt(Se,k,j,ce),-1<k&&(_e(Se[k]),Array.prototype.splice.call(Se,k,1),Se.length==0&&(delete m.g[T],m.h--)))):m&&(m=je(m))&&(T=m.g[T.toString()],m=-1,T&&(m=nt(T,k,j,ce)),(k=-1<m?T[m]:null)&&Kr(k))}function Kr(m){if(typeof m!="number"&&m&&!m.da){var T=m.src;if(T&&T[Ne])W(T.i,m);else{var k=m.type,j=m.proxy;T.removeEventListener?T.removeEventListener(k,j,m.capture):T.detachEvent?T.detachEvent(me(k),j):T.addListener&&T.removeListener&&T.removeListener(j),(k=je(T))?(W(k,m),k.h==0&&(k.src=null,T[it]=null)):_e(m)}}}function me(m){return m in wt?wt[m]:wt[m]="on"+m}function We(m,T){if(m.da)m=!0;else{T=new te(T,this);var k=m.listener,j=m.ha||m.src;m.fa&&Kr(m),m=k.call(j,T)}return m}function je(m){return m=m[it],m instanceof Be?m:null}var ot="__closure_events_fn_"+(1e9*Math.random()>>>0);function Nt(m){return typeof m=="function"?m:(m[ot]||(m[ot]=function(T){return m.handleEvent(T)}),m[ot])}function mt(){V.call(this),this.i=new Be(this),this.M=this,this.F=null}S(mt,V),mt.prototype[Ne]=!0,mt.prototype.removeEventListener=function(m,T,k,j){Lr(this,m,T,k,j)};function vt(m,T){var k,j=m.F;if(j)for(k=[];j;j=j.F)k.push(j);if(m=m.M,j=T.type||T,typeof T=="string")T=new X(T,m);else if(T instanceof X)T.target=T.target||m;else{var ce=T;T=new X(j,m),O(T,ce)}if(ce=!0,k)for(var Se=k.length-1;0<=Se;Se--){var ze=T.g=k[Se];ce=pt(ze,j,!0,T)&&ce}if(ze=T.g=m,ce=pt(ze,j,!0,T)&&ce,ce=pt(ze,j,!1,T)&&ce,k)for(Se=0;Se<k.length;Se++)ze=T.g=k[Se],ce=pt(ze,j,!1,T)&&ce}mt.prototype.N=function(){if(mt.aa.N.call(this),this.i){var m=this.i,T;for(T in m.g){for(var k=m.g[T],j=0;j<k.length;j++)_e(k[j]);delete m.g[T],m.h--}}this.F=null},mt.prototype.K=function(m,T,k,j){return this.i.add(String(m),T,!1,k,j)},mt.prototype.L=function(m,T,k,j){return this.i.add(String(m),T,!0,k,j)};function pt(m,T,k,j){if(T=m.i.g[String(T)],!T)return!0;T=T.concat();for(var ce=!0,Se=0;Se<T.length;++Se){var ze=T[Se];if(ze&&!ze.da&&ze.capture==k){var Lt=ze.listener,Yr=ze.ha||ze.src;ze.fa&&W(m.i,ze),ce=Lt.call(Yr,j)!==!1&&ce}}return ce&&!j.defaultPrevented}function Ft(m,T,k){if(typeof m=="function")k&&(m=_(m,k));else if(m&&typeof m.handleEvent=="function")m=_(m.handleEvent,m);else throw Error("Invalid listener argument");return 2147483647<Number(T)?-1:u.setTimeout(m,T||0)}function _t(m){m.g=Ft(()=>{m.g=null,m.i&&(m.i=!1,_t(m))},m.l);const T=m.h;m.h=null,m.m.apply(null,T)}class fr extends V{constructor(T,k){super(),this.m=T,this.l=k,this.h=null,this.i=!1,this.g=null}j(T){this.h=arguments,this.g?this.i=!0:_t(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ur(m){V.call(this),this.h=m,this.g={}}S(Ur,V);var sr=[];function Ln(m){Z(m.g,function(T,k){this.g.hasOwnProperty(k)&&Kr(T)},m),m.g={}}Ur.prototype.N=function(){Ur.aa.N.call(this),Ln(this)},Ur.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Kn=u.JSON.stringify,Ts=u.JSON.parse,ji=class{stringify(m){return u.JSON.stringify(m,void 0)}parse(m){return u.JSON.parse(m,void 0)}};function ws(){}ws.prototype.h=null;function Ss(m){return m.h||(m.h=m.i())}function As(){}var Ga={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function qa(){X.call(this,"d")}S(qa,X);function ii(){X.call(this,"c")}S(ii,X);var wa={},Oo=null;function si(){return Oo=Oo||new mt}wa.La="serverreachability";function bs(m){X.call(this,wa.La,m)}S(bs,X);function oi(m){const T=si();vt(T,new bs(T))}wa.STAT_EVENT="statevent";function jl(m,T){X.call(this,wa.STAT_EVENT,m),this.stat=T}S(jl,X);function lr(m){const T=si();vt(T,new jl(T,m))}wa.Ma="timingevent";function Ir(m,T){X.call(this,wa.Ma,m),this.size=T}S(Ir,X);function gr(m,T){if(typeof m!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){m()},T)}function Yn(){this.g=!0}Yn.prototype.xa=function(){this.g=!1};function Fo(m,T,k,j,ce,Se){m.info(function(){if(m.g)if(Se)for(var ze="",Lt=Se.split("&"),Yr=0;Yr<Lt.length;Yr++){var Ut=Lt[Yr].split("=");if(1<Ut.length){var an=Ut[0];Ut=Ut[1];var $r=an.split("_");ze=2<=$r.length&&$r[1]=="type"?ze+(an+"="+Ut+"&"):ze+(an+"=redacted&")}}else ze=null;else ze=Se;return"XMLHTTP REQ ("+j+") [attempt "+ce+"]: "+T+`
`+k+`
`+ze})}function hu(m,T,k,j,ce,Se,ze){m.info(function(){return"XMLHTTP RESP ("+j+") [ attempt "+ce+"]: "+T+`
`+k+`
`+Se+" "+ze})}function F(m,T,k,j){m.info(function(){return"XMLHTTP TEXT ("+T+"): "+H(m,k)+(j?" "+j:"")})}function Q(m,T){m.info(function(){return"TIMEOUT: "+T})}Yn.prototype.info=function(){};function H(m,T){if(!m.g)return T;if(!T)return null;try{var k=JSON.parse(T);if(k){for(m=0;m<k.length;m++)if(Array.isArray(k[m])){var j=k[m];if(!(2>j.length)){var ce=j[1];if(Array.isArray(ce)&&!(1>ce.length)){var Se=ce[0];if(Se!="noop"&&Se!="stop"&&Se!="close")for(var ze=1;ze<ce.length;ze++)ce[ze]=""}}}}return Kn(k)}catch{return T}}var G={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Y={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},J;function he(){}S(he,ws),he.prototype.g=function(){return new XMLHttpRequest},he.prototype.i=function(){return{}},J=new he;function we(m,T,k,j){this.j=m,this.i=T,this.l=k,this.R=j||1,this.U=new Ur(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new oe}function oe(){this.i=null,this.g="",this.h=!1}var ge={},xe={};function Pe(m,T,k){m.L=1,m.v=Lo(sa(T)),m.m=k,m.P=!0,Ve(m,null)}function Ve(m,T){m.F=Date.now(),qe(m),m.A=sa(m.v);var k=m.A,j=m.R;Array.isArray(j)||(j=[String(j)]),xu(k.i,"t",j),m.C=0,k=m.j.J,m.h=new oe,m.g=q0(m.j,k?T:null,!m.m),0<m.O&&(m.M=new fr(_(m.Y,m,m.g),m.O)),T=m.U,k=m.g,j=m.ca;var ce="readystatechange";Array.isArray(ce)||(ce&&(sr[0]=ce.toString()),ce=sr);for(var Se=0;Se<ce.length;Se++){var ze=st(k,ce[Se],j||T.handleEvent,!1,T.h||T);if(!ze)break;T.g[ze.key]=ze}T=m.H?I(m.H):{},m.m?(m.u||(m.u="POST"),T["Content-Type"]="application/x-www-form-urlencoded",m.g.ea(m.A,m.u,m.m,T)):(m.u="GET",m.g.ea(m.A,m.u,null,T)),oi(),Fo(m.i,m.u,m.A,m.l,m.R,m.m)}we.prototype.ca=function(m){m=m.target;const T=this.M;T&&ka(m)==3?T.j():this.Y(m)},we.prototype.Y=function(m){try{if(m==this.g)e:{const $r=ka(this.g);var T=this.g.Ba();const Ki=this.g.Z();if(!(3>$r)&&($r!=3||this.g&&(this.h.h||this.g.oa()||L0(this.g)))){this.J||$r!=4||T==7||(T==8||0>=Ki?oi(3):oi(2)),zt(this);var k=this.g.Z();this.X=k;t:if(Xe(this)){var j=L0(this.g);m="";var ce=j.length,Se=ka(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Mt(this),Pt(this);var ze="";break t}this.h.i=new u.TextDecoder}for(T=0;T<ce;T++)this.h.h=!0,m+=this.h.i.decode(j[T],{stream:!(Se&&T==ce-1)});j.length=0,this.h.g+=m,this.C=0,ze=this.h.g}else ze=this.g.oa();if(this.o=k==200,hu(this.i,this.u,this.A,this.l,this.R,$r,k),this.o){if(this.T&&!this.K){t:{if(this.g){var Lt,Yr=this.g;if((Lt=Yr.g?Yr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!B(Lt)){var Ut=Lt;break t}}Ut=null}if(k=Ut)F(this.i,this.l,k,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ia(this,k);else{this.o=!1,this.s=3,lr(12),Mt(this),Pt(this);break e}}if(this.P){k=!0;let dn;for(;!this.J&&this.C<ze.length;)if(dn=Me(this,ze),dn==xe){$r==4&&(this.s=4,lr(14),k=!1),F(this.i,this.l,null,"[Incomplete Response]");break}else if(dn==ge){this.s=4,lr(15),F(this.i,this.l,ze,"[Invalid Chunk]"),k=!1;break}else F(this.i,this.l,dn,null),ia(this,dn);if(Xe(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),$r!=4||ze.length!=0||this.h.h||(this.s=1,lr(16),k=!1),this.o=this.o&&k,!k)F(this.i,this.l,ze,"[Invalid Chunked Response]"),Mt(this),Pt(this);else if(0<ze.length&&!this.W){this.W=!0;var an=this.j;an.g==this&&an.ba&&!an.M&&(an.j.info("Great, no buffering proxy detected. Bytes received: "+ze.length),qo(an),an.M=!0,lr(11))}}else F(this.i,this.l,ze,null),ia(this,ze);$r==4&&Mt(this),this.o&&!this.J&&($r==4?H0(this.j,this):(this.o=!1,qe(this)))}else Vm(this.g),k==400&&0<ze.indexOf("Unknown SID")?(this.s=3,lr(12)):(this.s=0,lr(13)),Mt(this),Pt(this)}}}catch{}finally{}};function Xe(m){return m.g?m.u=="GET"&&m.L!=2&&m.j.Ca:!1}function Me(m,T){var k=m.C,j=T.indexOf(`
`,k);return j==-1?xe:(k=Number(T.substring(k,j)),isNaN(k)?ge:(j+=1,j+k>T.length?xe:(T=T.slice(j,j+k),m.C=j+k,T)))}we.prototype.cancel=function(){this.J=!0,Mt(this)};function qe(m){m.S=Date.now()+m.I,ft(m,m.I)}function ft(m,T){if(m.B!=null)throw Error("WatchDog timer not null");m.B=gr(_(m.ba,m),T)}function zt(m){m.B&&(u.clearTimeout(m.B),m.B=null)}we.prototype.ba=function(){this.B=null;const m=Date.now();0<=m-this.S?(Q(this.i,this.A),this.L!=2&&(oi(),lr(17)),Mt(this),this.s=2,Pt(this)):ft(this,this.S-m)};function Pt(m){m.j.G==0||m.J||H0(m.j,m)}function Mt(m){zt(m);var T=m.M;T&&typeof T.ma=="function"&&T.ma(),m.M=null,Ln(m.U),m.g&&(T=m.g,m.g=null,T.abort(),T.ma())}function ia(m,T){try{var k=m.j;if(k.G!=0&&(k.g==m||Bn(k.h,m))){if(!m.K&&Bn(k.h,m)&&k.G==3){try{var j=k.Da.g.parse(T)}catch{j=null}if(Array.isArray(j)&&j.length==3){var ce=j;if(ce[0]==0){e:if(!k.u){if(k.g)if(k.g.F+3e3<m.F)Ql(k),Yl(k);else break e;Tu(k),lr(18)}}else k.za=ce[1],0<k.za-k.T&&37500>ce[2]&&k.F&&k.v==0&&!k.C&&(k.C=gr(_(k.Za,k),6e3));if(1>=ci(k.h)&&k.ca){try{k.ca()}catch{}k.ca=void 0}}else Xi(k,11)}else if((m.K||k.g==m)&&Ql(k),!B(T))for(ce=k.Da.g.parse(T),T=0;T<ce.length;T++){let Ut=ce[T];if(k.T=Ut[0],Ut=Ut[1],k.G==2)if(Ut[0]=="c"){k.K=Ut[1],k.ia=Ut[2];const an=Ut[3];an!=null&&(k.la=an,k.j.info("VER="+k.la));const $r=Ut[4];$r!=null&&(k.Aa=$r,k.j.info("SVER="+k.Aa));const Ki=Ut[5];Ki!=null&&typeof Ki=="number"&&0<Ki&&(j=1.5*Ki,k.L=j,k.j.info("backChannelRequestTimeoutMs_="+j)),j=k;const dn=m.g;if(dn){const gi=dn.g?dn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(gi){var Se=j.h;Se.g||gi.indexOf("spdy")==-1&&gi.indexOf("quic")==-1&&gi.indexOf("h2")==-1||(Se.j=Se.l,Se.g=new Set,Se.h&&(Hl(Se,Se.h),Se.h=null))}if(j.D){const Su=dn.g?dn.g.getResponseHeader("X-HTTP-Session-Id"):null;Su&&(j.ya=Su,er(j.I,j.D,Su))}}k.G=3,k.l&&k.l.ua(),k.ba&&(k.R=Date.now()-m.F,k.j.info("Handshake RTT: "+k.R+"ms")),j=k;var ze=m;if(j.qa=G0(j,j.J?j.ia:null,j.W),ze.K){Vn(j.h,ze);var Lt=ze,Yr=j.L;Yr&&(Lt.I=Yr),Lt.B&&(zt(Lt),qe(Lt)),j.g=ze}else V0(j);0<k.i.length&&$l(k)}else Ut[0]!="stop"&&Ut[0]!="close"||Xi(k,7);else k.G==3&&(Ut[0]=="stop"||Ut[0]=="close"?Ut[0]=="stop"?Xi(k,7):yu(k):Ut[0]!="noop"&&k.l&&k.l.ta(Ut),k.v=0)}}oi(4)}catch{}}var li=class{constructor(m,T){this.g=m,this.map=T}};function Un(m){this.l=m||10,u.PerformanceNavigationTiming?(m=u.performance.getEntriesByType("navigation"),m=0<m.length&&(m[0].nextHopProtocol=="hq"||m[0].nextHopProtocol=="h2")):m=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=m?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function $n(m){return m.h?!0:m.g?m.g.size>=m.j:!1}function ci(m){return m.h?1:m.g?m.g.size:0}function Bn(m,T){return m.h?m.h==T:m.g?m.g.has(T):!1}function Hl(m,T){m.g?m.g.add(T):m.h=T}function Vn(m,T){m.h&&m.h==T?m.h=null:m.g&&m.g.has(T)&&m.g.delete(T)}Un.prototype.cancel=function(){if(this.i=du(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const m of this.g.values())m.cancel();this.g.clear()}};function du(m){if(m.h!=null)return m.i.concat(m.h.D);if(m.g!=null&&m.g.size!==0){let T=m.i;for(const k of m.g.values())T=T.concat(k.D);return T}return y(m.i)}function Mm(m){if(m.V&&typeof m.V=="function")return m.V();if(typeof Map<"u"&&m instanceof Map||typeof Set<"u"&&m instanceof Set)return Array.from(m.values());if(typeof m=="string")return m.split("");if(h(m)){for(var T=[],k=m.length,j=0;j<k;j++)T.push(m[j]);return T}T=[],k=0;for(j in m)T[k++]=m[j];return T}function zl(m){if(m.na&&typeof m.na=="function")return m.na();if(!m.V||typeof m.V!="function"){if(typeof Map<"u"&&m instanceof Map)return Array.from(m.keys());if(!(typeof Set<"u"&&m instanceof Set)){if(h(m)||typeof m=="string"){var T=[];m=m.length;for(var k=0;k<m;k++)T.push(k);return T}T=[],k=0;for(const j in m)T[k++]=j;return T}}}function mu(m,T){if(m.forEach&&typeof m.forEach=="function")m.forEach(T,void 0);else if(h(m)||typeof m=="string")Array.prototype.forEach.call(m,T,void 0);else for(var k=zl(m),j=Mm(m),ce=j.length,Se=0;Se<ce;Se++)T.call(void 0,j[Se],k&&k[Se],m)}var Po=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Lm(m,T){if(m){m=m.split("&");for(var k=0;k<m.length;k++){var j=m[k].indexOf("="),ce=null;if(0<=j){var Se=m[k].substring(0,j);ce=m[k].substring(j+1)}else Se=m[k];T(Se,ce?decodeURIComponent(ce.replace(/\+/g," ")):"")}}}function Br(m){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,m instanceof Br){this.h=m.h,Mo(this,m.j),this.o=m.o,this.g=m.g,ks(this,m.s),this.l=m.l;var T=m.i,k=new zi;k.i=T.i,T.g&&(k.g=new Map(T.g),k.h=T.h),Hi(this,k),this.m=m.m}else m&&(T=String(m).match(Po))?(this.h=!1,Mo(this,T[1]||"",!0),this.o=Sa(T[2]||""),this.g=Sa(T[3]||"",!0),ks(this,T[4]),this.l=Sa(T[5]||"",!0),Hi(this,T[6]||"",!0),this.m=Sa(T[7]||"")):(this.h=!1,this.i=new zi(null,this.h))}Br.prototype.toString=function(){var m=[],T=this.j;T&&m.push(Uo(T,pu,!0),":");var k=this.g;return(k||T=="file")&&(m.push("//"),(T=this.o)&&m.push(Uo(T,pu,!0),"@"),m.push(encodeURIComponent(String(k)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),k=this.s,k!=null&&m.push(":",String(k))),(k=this.l)&&(this.g&&k.charAt(0)!="/"&&m.push("/"),m.push(Uo(k,k.charAt(0)=="/"?Um:gu,!0))),(k=this.i.toString())&&m.push("?",k),(k=this.m)&&m.push("#",Uo(k,Gl)),m.join("")};function sa(m){return new Br(m)}function Mo(m,T,k){m.j=k?Sa(T,!0):T,m.j&&(m.j=m.j.replace(/:$/,""))}function ks(m,T){if(T){if(T=Number(T),isNaN(T)||0>T)throw Error("Bad port number "+T);m.s=T}else m.s=null}function Hi(m,T,k){T instanceof zi?(m.i=T,P0(m.i,m.h)):(k||(T=Uo(T,Bm)),m.i=new zi(T,m.h))}function er(m,T,k){m.i.set(T,k)}function Lo(m){return er(m,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),m}function Sa(m,T){return m?T?decodeURI(m.replace(/%25/g,"%2525")):decodeURIComponent(m):""}function Uo(m,T,k){return typeof m=="string"?(m=encodeURI(m).replace(T,F0),k&&(m=m.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m):null}function F0(m){return m=m.charCodeAt(0),"%"+(m>>4&15).toString(16)+(m&15).toString(16)}var pu=/[#\/\?@]/g,gu=/[#\?:]/g,Um=/[#\?]/g,Bm=/[#\?@]/g,Gl=/#/g;function zi(m,T){this.h=this.g=null,this.i=m||null,this.j=!!T}function Aa(m){m.g||(m.g=new Map,m.h=0,m.i&&Lm(m.i,function(T,k){m.add(decodeURIComponent(T.replace(/\+/g," ")),k)}))}t=zi.prototype,t.add=function(m,T){Aa(this),this.i=null,m=ui(this,m);var k=this.g.get(m);return k||this.g.set(m,k=[]),k.push(T),this.h+=1,this};function Gi(m,T){Aa(m),T=ui(m,T),m.g.has(T)&&(m.i=null,m.h-=m.g.get(T).length,m.g.delete(T))}function qi(m,T){return Aa(m),T=ui(m,T),m.g.has(T)}t.forEach=function(m,T){Aa(this),this.g.forEach(function(k,j){k.forEach(function(ce){m.call(T,ce,j,this)},this)},this)},t.na=function(){Aa(this);const m=Array.from(this.g.values()),T=Array.from(this.g.keys()),k=[];for(let j=0;j<T.length;j++){const ce=m[j];for(let Se=0;Se<ce.length;Se++)k.push(T[j])}return k},t.V=function(m){Aa(this);let T=[];if(typeof m=="string")qi(this,m)&&(T=T.concat(this.g.get(ui(this,m))));else{m=Array.from(this.g.values());for(let k=0;k<m.length;k++)T=T.concat(m[k])}return T},t.set=function(m,T){return Aa(this),this.i=null,m=ui(this,m),qi(this,m)&&(this.h-=this.g.get(m).length),this.g.set(m,[T]),this.h+=1,this},t.get=function(m,T){return m?(m=this.V(m),0<m.length?String(m[0]):T):T};function xu(m,T,k){Gi(m,T),0<k.length&&(m.i=null,m.g.set(ui(m,T),y(k)),m.h+=k.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const m=[],T=Array.from(this.g.keys());for(var k=0;k<T.length;k++){var j=T[k];const Se=encodeURIComponent(String(j)),ze=this.V(j);for(j=0;j<ze.length;j++){var ce=Se;ze[j]!==""&&(ce+="="+encodeURIComponent(String(ze[j]))),m.push(ce)}}return this.i=m.join("&")};function ui(m,T){return T=String(T),m.j&&(T=T.toLowerCase()),T}function P0(m,T){T&&!m.j&&(Aa(m),m.i=null,m.g.forEach(function(k,j){var ce=j.toLowerCase();j!=ce&&(Gi(this,j),xu(this,ce,k))},m)),m.j=T}function Bo(m,T){const k=new Yn;if(u.Image){const j=new Image;j.onload=E(ba,k,"TestLoadImage: loaded",!0,T,j),j.onerror=E(ba,k,"TestLoadImage: error",!1,T,j),j.onabort=E(ba,k,"TestLoadImage: abort",!1,T,j),j.ontimeout=E(ba,k,"TestLoadImage: timeout",!1,T,j),u.setTimeout(function(){j.ontimeout&&j.ontimeout()},1e4),j.src=m}else T(!1)}function Wa(m,T){const k=new Yn,j=new AbortController,ce=setTimeout(()=>{j.abort(),ba(k,"TestPingServer: timeout",!1,T)},1e4);fetch(m,{signal:j.signal}).then(Se=>{clearTimeout(ce),Se.ok?ba(k,"TestPingServer: ok",!0,T):ba(k,"TestPingServer: server error",!1,T)}).catch(()=>{clearTimeout(ce),ba(k,"TestPingServer: error",!1,T)})}function ba(m,T,k,j,ce){try{ce&&(ce.onload=null,ce.onerror=null,ce.onabort=null,ce.ontimeout=null),j(k)}catch{}}function Vo(){this.g=new ji}function fi(m,T,k){const j=k||"";try{mu(m,function(ce,Se){let ze=ce;d(ce)&&(ze=Kn(ce)),T.push(j+Se+"="+encodeURIComponent(ze))})}catch(ce){throw T.push(j+"type="+encodeURIComponent("_badmap")),ce}}function Cs(m){this.l=m.Ub||null,this.j=m.eb||!1}S(Cs,ws),Cs.prototype.g=function(){return new Wi(this.l,this.j)},Cs.prototype.i=function(m){return function(){return m}}({});function Wi(m,T){mt.call(this),this.D=m,this.o=T,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}S(Wi,mt),t=Wi.prototype,t.open=function(m,T){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=m,this.A=T,this.readyState=1,di(this)},t.send=function(m){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const T={headers:this.u,method:this.B,credentials:this.m,cache:void 0};m&&(T.body=m),(this.D||u).fetch(new Request(this.A,T)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,hi(this)),this.readyState=0},t.Sa=function(m){if(this.g&&(this.l=m,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=m.headers,this.readyState=2,di(this)),this.g&&(this.readyState=3,di(this),this.g)))if(this.responseType==="arraybuffer")m.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in m){if(this.j=m.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;vu(this)}else m.text().then(this.Ra.bind(this),this.ga.bind(this))};function vu(m){m.j.read().then(m.Pa.bind(m)).catch(m.ga.bind(m))}t.Pa=function(m){if(this.g){if(this.o&&m.value)this.response.push(m.value);else if(!this.o){var T=m.value?m.value:new Uint8Array(0);(T=this.v.decode(T,{stream:!m.done}))&&(this.response=this.responseText+=T)}m.done?hi(this):di(this),this.readyState==3&&vu(this)}},t.Ra=function(m){this.g&&(this.response=this.responseText=m,hi(this))},t.Qa=function(m){this.g&&(this.response=m,hi(this))},t.ga=function(){this.g&&hi(this)};function hi(m){m.readyState=4,m.l=null,m.j=null,m.v=null,di(m)}t.setRequestHeader=function(m,T){this.u.append(m,T)},t.getResponseHeader=function(m){return this.h&&this.h.get(m.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const m=[],T=this.h.entries();for(var k=T.next();!k.done;)k=k.value,m.push(k[0]+": "+k[1]),k=T.next();return m.join(`\r
`)};function di(m){m.onreadystatechange&&m.onreadystatechange.call(m)}Object.defineProperty(Wi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(m){this.m=m?"include":"same-origin"}});function _u(m){let T="";return Z(m,function(k,j){T+=j,T+=":",T+=k,T+=`\r
`}),T}function nn(m,T,k){e:{for(j in k){var j=!1;break e}j=!0}j||(k=_u(k),typeof m=="string"?k!=null&&encodeURIComponent(String(k)):er(m,T,k))}function Xt(m){mt.call(this),this.headers=new Map,this.o=m||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}S(Xt,mt);var ql=/^https?$/i,jo=["POST","PUT"];t=Xt.prototype,t.Ha=function(m){this.J=m},t.ea=function(m,T,k,j){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+m);T=T?T.toUpperCase():"GET",this.D=m,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():J.g(),this.v=this.o?Ss(this.o):Ss(J),this.g.onreadystatechange=_(this.Ea,this);try{this.B=!0,this.g.open(T,String(m),!0),this.B=!1}catch(Se){M0(this,Se);return}if(m=k||"",k=new Map(this.headers),j)if(Object.getPrototypeOf(j)===Object.prototype)for(var ce in j)k.set(ce,j[ce]);else if(typeof j.keys=="function"&&typeof j.get=="function")for(const Se of j.keys())k.set(Se,j.get(Se));else throw Error("Unknown input type for opt_headers: "+String(j));j=Array.from(k.keys()).find(Se=>Se.toLowerCase()=="content-type"),ce=u.FormData&&m instanceof u.FormData,!(0<=Array.prototype.indexOf.call(jo,T,void 0))||j||ce||k.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Se,ze]of k)this.g.setRequestHeader(Se,ze);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Ho(this),this.u=!0,this.g.send(m),this.u=!1}catch(Se){M0(this,Se)}};function M0(m,T){m.h=!1,m.g&&(m.j=!0,m.g.abort(),m.j=!1),m.l=T,m.m=5,Wl(m),mi(m)}function Wl(m){m.A||(m.A=!0,vt(m,"complete"),vt(m,"error"))}t.abort=function(m){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=m||7,vt(this,"complete"),vt(this,"abort"),mi(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),mi(this,!0)),Xt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Xl(this):this.bb())},t.bb=function(){Xl(this)};function Xl(m){if(m.h&&typeof l<"u"&&(!m.v[1]||ka(m)!=4||m.Z()!=2)){if(m.u&&ka(m)==4)Ft(m.Ea,0,m);else if(vt(m,"readystatechange"),ka(m)==4){m.h=!1;try{const ze=m.Z();e:switch(ze){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var T=!0;break e;default:T=!1}var k;if(!(k=T)){var j;if(j=ze===0){var ce=String(m.D).match(Po)[1]||null;!ce&&u.self&&u.self.location&&(ce=u.self.location.protocol.slice(0,-1)),j=!ql.test(ce?ce.toLowerCase():"")}k=j}if(k)vt(m,"complete"),vt(m,"success");else{m.m=6;try{var Se=2<ka(m)?m.g.statusText:""}catch{Se=""}m.l=Se+" ["+m.Z()+"]",Wl(m)}}finally{mi(m)}}}}function mi(m,T){if(m.g){Ho(m);const k=m.g,j=m.v[0]?()=>{}:null;m.g=null,m.v=null,T||vt(m,"ready");try{k.onreadystatechange=j}catch{}}}function Ho(m){m.I&&(u.clearTimeout(m.I),m.I=null)}t.isActive=function(){return!!this.g};function ka(m){return m.g?m.g.readyState:0}t.Z=function(){try{return 2<ka(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(m){if(this.g){var T=this.g.responseText;return m&&T.indexOf(m)==0&&(T=T.substring(m.length)),Ts(T)}};function L0(m){try{if(!m.g)return null;if("response"in m.g)return m.g.response;switch(m.H){case"":case"text":return m.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in m.g)return m.g.mozResponseArrayBuffer}return null}catch{return null}}function Vm(m){const T={};m=(m.g&&2<=ka(m)&&m.g.getAllResponseHeaders()||"").split(`\r
`);for(let j=0;j<m.length;j++){if(B(m[j]))continue;var k=L(m[j]);const ce=k[0];if(k=k[1],typeof k!="string")continue;k=k.trim();const Se=T[ce]||[];T[ce]=Se,Se.push(k)}C(T,function(j){return j.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function zo(m,T,k){return k&&k.internalChannelParams&&k.internalChannelParams[m]||T}function Kl(m){this.Aa=0,this.i=[],this.j=new Yn,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=zo("failFast",!1,m),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=zo("baseRetryDelayMs",5e3,m),this.cb=zo("retryDelaySeedMs",1e4,m),this.Wa=zo("forwardChannelMaxRetries",2,m),this.wa=zo("forwardChannelRequestTimeoutMs",2e4,m),this.pa=m&&m.xmlHttpFactory||void 0,this.Xa=m&&m.Tb||void 0,this.Ca=m&&m.useFetchStreams||!1,this.L=void 0,this.J=m&&m.supportsCrossDomainXhr||!1,this.K="",this.h=new Un(m&&m.concurrentRequestLimit),this.Da=new Vo,this.P=m&&m.fastHandshake||!1,this.O=m&&m.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=m&&m.Rb||!1,m&&m.xa&&this.j.xa(),m&&m.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&m&&m.detectBufferingProxy||!1,this.ja=void 0,m&&m.longPollingTimeout&&0<m.longPollingTimeout&&(this.ja=m.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Kl.prototype,t.la=8,t.G=1,t.connect=function(m,T,k,j){lr(0),this.W=m,this.H=T||{},k&&j!==void 0&&(this.H.OSID=k,this.H.OAID=j),this.F=this.X,this.I=G0(this,null,this.W),$l(this)};function yu(m){if(U0(m),m.G==3){var T=m.U++,k=sa(m.I);if(er(k,"SID",m.K),er(k,"RID",T),er(k,"TYPE","terminate"),Go(m,k),T=new we(m,m.j,T),T.L=2,T.v=Lo(sa(k)),k=!1,u.navigator&&u.navigator.sendBeacon)try{k=u.navigator.sendBeacon(T.v.toString(),"")}catch{}!k&&u.Image&&(new Image().src=T.v,k=!0),k||(T.g=q0(T.j,null),T.g.ea(T.v)),T.F=Date.now(),qe(T)}z0(m)}function Yl(m){m.g&&(qo(m),m.g.cancel(),m.g=null)}function U0(m){Yl(m),m.u&&(u.clearTimeout(m.u),m.u=null),Ql(m),m.h.cancel(),m.s&&(typeof m.s=="number"&&u.clearTimeout(m.s),m.s=null)}function $l(m){if(!$n(m.h)&&!m.s){m.s=!0;var T=m.Ga;ue||K(),Ue||(ue(),Ue=!0),ie.add(T,m),m.B=0}}function jm(m,T){return ci(m.h)>=m.h.j-(m.s?1:0)?!1:m.s?(m.i=T.D.concat(m.i),!0):m.G==1||m.G==2||m.B>=(m.Va?0:m.Wa)?!1:(m.s=gr(_(m.Ga,m,T),wu(m,m.B)),m.B++,!0)}t.Ga=function(m){if(this.s)if(this.s=null,this.G==1){if(!m){this.U=Math.floor(1e5*Math.random()),m=this.U++;const ce=new we(this,this.j,m);let Se=this.o;if(this.S&&(Se?(Se=I(Se),O(Se,this.S)):Se=this.S),this.m!==null||this.O||(ce.H=Se,Se=null),this.P)e:{for(var T=0,k=0;k<this.i.length;k++){t:{var j=this.i[k];if("__data__"in j.map&&(j=j.map.__data__,typeof j=="string")){j=j.length;break t}j=void 0}if(j===void 0)break;if(T+=j,4096<T){T=k;break e}if(T===4096||k===this.i.length-1){T=k+1;break e}}T=1e3}else T=1e3;T=B0(this,ce,T),k=sa(this.I),er(k,"RID",m),er(k,"CVER",22),this.D&&er(k,"X-HTTP-Session-Id",this.D),Go(this,k),Se&&(this.O?T="headers="+encodeURIComponent(String(_u(Se)))+"&"+T:this.m&&nn(k,this.m,Se)),Hl(this.h,ce),this.Ua&&er(k,"TYPE","init"),this.P?(er(k,"$req",T),er(k,"SID","null"),ce.T=!0,Pe(ce,k,null)):Pe(ce,k,T),this.G=2}}else this.G==3&&(m?Eu(this,m):this.i.length==0||$n(this.h)||Eu(this))};function Eu(m,T){var k;T?k=T.l:k=m.U++;const j=sa(m.I);er(j,"SID",m.K),er(j,"RID",k),er(j,"AID",m.T),Go(m,j),m.m&&m.o&&nn(j,m.m,m.o),k=new we(m,m.j,k,m.B+1),m.m===null&&(k.H=m.o),T&&(m.i=T.D.concat(m.i)),T=B0(m,k,1e3),k.I=Math.round(.5*m.wa)+Math.round(.5*m.wa*Math.random()),Hl(m.h,k),Pe(k,j,T)}function Go(m,T){m.H&&Z(m.H,function(k,j){er(T,j,k)}),m.l&&mu({},function(k,j){er(T,j,k)})}function B0(m,T,k){k=Math.min(m.i.length,k);var j=m.l?_(m.l.Na,m.l,m):null;e:{var ce=m.i;let Se=-1;for(;;){const ze=["count="+k];Se==-1?0<k?(Se=ce[0].g,ze.push("ofs="+Se)):Se=0:ze.push("ofs="+Se);let Lt=!0;for(let Yr=0;Yr<k;Yr++){let Ut=ce[Yr].g;const an=ce[Yr].map;if(Ut-=Se,0>Ut)Se=Math.max(0,ce[Yr].g-100),Lt=!1;else try{fi(an,ze,"req"+Ut+"_")}catch{j&&j(an)}}if(Lt){j=ze.join("&");break e}}}return m=m.i.splice(0,k),T.D=m,j}function V0(m){if(!m.g&&!m.u){m.Y=1;var T=m.Fa;ue||K(),Ue||(ue(),Ue=!0),ie.add(T,m),m.v=0}}function Tu(m){return m.g||m.u||3<=m.v?!1:(m.Y++,m.u=gr(_(m.Fa,m),wu(m,m.v)),m.v++,!0)}t.Fa=function(){if(this.u=null,j0(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var m=2*this.R;this.j.info("BP detection timer enabled: "+m),this.A=gr(_(this.ab,this),m)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,lr(10),Yl(this),j0(this))};function qo(m){m.A!=null&&(u.clearTimeout(m.A),m.A=null)}function j0(m){m.g=new we(m,m.j,"rpc",m.Y),m.m===null&&(m.g.H=m.o),m.g.O=0;var T=sa(m.qa);er(T,"RID","rpc"),er(T,"SID",m.K),er(T,"AID",m.T),er(T,"CI",m.F?"0":"1"),!m.F&&m.ja&&er(T,"TO",m.ja),er(T,"TYPE","xmlhttp"),Go(m,T),m.m&&m.o&&nn(T,m.m,m.o),m.L&&(m.g.I=m.L);var k=m.g;m=m.ia,k.L=1,k.v=Lo(sa(T)),k.m=null,k.P=!0,Ve(k,m)}t.Za=function(){this.C!=null&&(this.C=null,Yl(this),Tu(this),lr(19))};function Ql(m){m.C!=null&&(u.clearTimeout(m.C),m.C=null)}function H0(m,T){var k=null;if(m.g==T){Ql(m),qo(m),m.g=null;var j=2}else if(Bn(m.h,T))k=T.D,Vn(m.h,T),j=1;else return;if(m.G!=0){if(T.o)if(j==1){k=T.m?T.m.length:0,T=Date.now()-T.F;var ce=m.B;j=si(),vt(j,new Ir(j,k)),$l(m)}else V0(m);else if(ce=T.s,ce==3||ce==0&&0<T.X||!(j==1&&jm(m,T)||j==2&&Tu(m)))switch(k&&0<k.length&&(T=m.h,T.i=T.i.concat(k)),ce){case 1:Xi(m,5);break;case 4:Xi(m,10);break;case 3:Xi(m,6);break;default:Xi(m,2)}}}function wu(m,T){let k=m.Ta+Math.floor(Math.random()*m.cb);return m.isActive()||(k*=2),k*T}function Xi(m,T){if(m.j.info("Error code "+T),T==2){var k=_(m.fb,m),j=m.Xa;const ce=!j;j=new Br(j||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||Mo(j,"https"),Lo(j),ce?Bo(j.toString(),k):Wa(j.toString(),k)}else lr(2);m.G=0,m.l&&m.l.sa(T),z0(m),U0(m)}t.fb=function(m){m?(this.j.info("Successfully pinged google.com"),lr(2)):(this.j.info("Failed to ping google.com"),lr(1))};function z0(m){if(m.G=0,m.ka=[],m.l){const T=du(m.h);(T.length!=0||m.i.length!=0)&&(w(m.ka,T),w(m.ka,m.i),m.h.i.length=0,y(m.i),m.i.length=0),m.l.ra()}}function G0(m,T,k){var j=k instanceof Br?sa(k):new Br(k);if(j.g!="")T&&(j.g=T+"."+j.g),ks(j,j.s);else{var ce=u.location;j=ce.protocol,T=T?T+"."+ce.hostname:ce.hostname,ce=+ce.port;var Se=new Br(null);j&&Mo(Se,j),T&&(Se.g=T),ce&&ks(Se,ce),k&&(Se.l=k),j=Se}return k=m.D,T=m.ya,k&&T&&er(j,k,T),er(j,"VER",m.la),Go(m,j),j}function q0(m,T,k){if(T&&!m.J)throw Error("Can't create secondary domain capable XhrIo object.");return T=m.Ca&&!m.pa?new Xt(new Cs({eb:k})):new Xt(m.pa),T.Ha(m.J),T}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function W0(){}t=W0.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Zl(){}Zl.prototype.g=function(m,T){return new jn(m,T)};function jn(m,T){mt.call(this),this.g=new Kl(T),this.l=m,this.h=T&&T.messageUrlParams||null,m=T&&T.messageHeaders||null,T&&T.clientProtocolHeaderRequired&&(m?m["X-Client-Protocol"]="webchannel":m={"X-Client-Protocol":"webchannel"}),this.g.o=m,m=T&&T.initMessageHeaders||null,T&&T.messageContentType&&(m?m["X-WebChannel-Content-Type"]=T.messageContentType:m={"X-WebChannel-Content-Type":T.messageContentType}),T&&T.va&&(m?m["X-WebChannel-Client-Profile"]=T.va:m={"X-WebChannel-Client-Profile":T.va}),this.g.S=m,(m=T&&T.Sb)&&!B(m)&&(this.g.m=m),this.v=T&&T.supportsCrossDomainXhr||!1,this.u=T&&T.sendRawJson||!1,(T=T&&T.httpSessionIdParam)&&!B(T)&&(this.g.D=T,m=this.h,m!==null&&T in m&&(m=this.h,T in m&&delete m[T])),this.j=new pi(this)}S(jn,mt),jn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},jn.prototype.close=function(){yu(this.g)},jn.prototype.o=function(m){var T=this.g;if(typeof m=="string"){var k={};k.__data__=m,m=k}else this.u&&(k={},k.__data__=Kn(m),m=k);T.i.push(new li(T.Ya++,m)),T.G==3&&$l(T)},jn.prototype.N=function(){this.g.l=null,delete this.j,yu(this.g),delete this.g,jn.aa.N.call(this)};function X0(m){qa.call(this),m.__headers__&&(this.headers=m.__headers__,this.statusCode=m.__status__,delete m.__headers__,delete m.__status__);var T=m.__sm__;if(T){e:{for(const k in T){m=k;break e}m=void 0}(this.i=m)&&(m=this.i,T=T!==null&&m in T?T[m]:void 0),this.data=T}else this.data=m}S(X0,qa);function K0(){ii.call(this),this.status=1}S(K0,ii);function pi(m){this.g=m}S(pi,W0),pi.prototype.ua=function(){vt(this.g,"a")},pi.prototype.ta=function(m){vt(this.g,new X0(m))},pi.prototype.sa=function(m){vt(this.g,new K0)},pi.prototype.ra=function(){vt(this.g,"b")},Zl.prototype.createWebChannel=Zl.prototype.g,jn.prototype.send=jn.prototype.o,jn.prototype.open=jn.prototype.m,jn.prototype.close=jn.prototype.close,kS=function(){return new Zl},bS=function(){return si()},AS=wa,T1={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},G.NO_ERROR=0,G.TIMEOUT=8,G.HTTP_ERROR=6,gd=G,Y.COMPLETE="complete",SS=Y,As.EventType=Ga,Ga.OPEN="a",Ga.CLOSE="b",Ga.ERROR="c",Ga.MESSAGE="d",mt.prototype.listen=mt.prototype.K,xf=As,Xt.prototype.listenOnce=Xt.prototype.L,Xt.prototype.getLastError=Xt.prototype.Ka,Xt.prototype.getLastErrorCode=Xt.prototype.Ba,Xt.prototype.getStatus=Xt.prototype.Z,Xt.prototype.getResponseJson=Xt.prototype.Oa,Xt.prototype.getResponseText=Xt.prototype.oa,Xt.prototype.send=Xt.prototype.ea,Xt.prototype.setWithCredentials=Xt.prototype.Ha,wS=Xt}).apply(typeof Yh<"u"?Yh:typeof self<"u"?self:typeof window<"u"?window:{});const kE="@firebase/firestore",CE="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}kn.UNAUTHENTICATED=new kn(null),kn.GOOGLE_CREDENTIALS=new kn("google-credentials-uid"),kn.FIRST_PARTY=new kn("first-party-uid"),kn.MOCK_USER=new kn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ru="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vl=new cx("@firebase/firestore");function Ic(){return vl.logLevel}function Ke(t,...e){if(vl.logLevel<=Dt.DEBUG){const r=e.map(dx);vl.debug(`Firestore (${ru}): ${t}`,...r)}}function ps(t,...e){if(vl.logLevel<=Dt.ERROR){const r=e.map(dx);vl.error(`Firestore (${ru}): ${t}`,...r)}}function mo(t,...e){if(vl.logLevel<=Dt.WARN){const r=e.map(dx);vl.warn(`Firestore (${ru}): ${t}`,...r)}}function dx(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ut(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,CS(t,n,r)}function CS(t,e,r){let n=`FIRESTORE (${ru}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw ps(n),new Error(n)}function Kt(t,e,r,n){let a="Unexpected state";typeof r=="string"?a=r:n=r,t||CS(e,a,n)}function xt(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Re={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ye extends Ui{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uo{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RS{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class CI{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(kn.UNAUTHENTICATED))}shutdown(){}}class RI{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class II{constructor(e){this.t=e,this.currentUser=kn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Kt(this.o===void 0,42304);let n=this.i;const a=h=>this.i!==n?(n=this.i,r(h)):Promise.resolve();let o=new uo;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new uo,e.enqueueRetryable(()=>a(this.currentUser))};const l=()=>{const h=o;e.enqueueRetryable(async()=>{await h.promise,await a(this.currentUser)})},u=h=>{Ke("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit(h=>u(h)),setTimeout(()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?u(h):(Ke("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new uo)}},0),l()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Ke("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Kt(typeof n.accessToken=="string",31837,{l:n}),new RS(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Kt(e===null||typeof e=="string",2055,{h:e}),new kn(e)}}class NI{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=kn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class DI{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new NI(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(kn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class RE{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class OI{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ga(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){Kt(this.o===void 0,3512);const n=o=>{o.error!=null&&Ke("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const l=o.token!==this.m;return this.m=o.token,Ke("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?r(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>n(o))};const a=o=>{Ke("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>a(o)),setTimeout(()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?a(o):Ke("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new RE(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(Kt(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new RE(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FI(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IS(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mx{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const a=FI(40);for(let o=0;o<a.length;++o)n.length<20&&a[o]<r&&(n+=e.charAt(a[o]%62))}return n}}function At(t,e){return t<e?-1:t>e?1:0}function w1(t,e){let r=0;for(;r<t.length&&r<e.length;){const n=t.codePointAt(r),a=e.codePointAt(r);if(n!==a){if(n<128&&a<128)return At(n,a);{const o=IS(),l=PI(o.encode(IE(t,r)),o.encode(IE(e,r)));return l!==0?l:At(n,a)}}r+=n>65535?2:1}return At(t.length,e.length)}function IE(t,e){return t.codePointAt(e)>65535?t.substring(e,e+2):t.substring(e,e+1)}function PI(t,e){for(let r=0;r<t.length&&r<e.length;++r)if(t[r]!==e[r])return At(t[r],e[r]);return At(t.length,e.length)}function Kc(t,e,r){return t.length===e.length&&t.every((n,a)=>r(n,e[a]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NE="__name__";class Ai{constructor(e,r,n){r===void 0?r=0:r>e.length&&ut(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&ut(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Ai.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Ai?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let a=0;a<n;a++){const o=Ai.compareSegments(e.get(a),r.get(a));if(o!==0)return o}return At(e.length,r.length)}static compareSegments(e,r){const n=Ai.isNumericId(e),a=Ai.isNumericId(r);return n&&!a?-1:!n&&a?1:n&&a?Ai.extractNumericId(e).compare(Ai.extractNumericId(r)):w1(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return co.fromString(e.substring(4,e.length-2))}}class ur extends Ai{construct(e,r,n){return new ur(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Ye(Re.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(a=>a.length>0))}return new ur(r)}static emptyPath(){return new ur([])}}const MI=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class yn extends Ai{construct(e,r,n){return new yn(e,r,n)}static isValidIdentifier(e){return MI.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),yn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===NE}static keyField(){return new yn([NE])}static fromServerFormat(e){const r=[];let n="",a=0;const o=()=>{if(n.length===0)throw new Ye(Re.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let l=!1;for(;a<e.length;){const u=e[a];if(u==="\\"){if(a+1===e.length)throw new Ye(Re.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const h=e[a+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new Ye(Re.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=h,a+=2}else u==="`"?(l=!l,a++):u!=="."||l?(n+=u,a++):(o(),a++)}if(o(),l)throw new Ye(Re.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new yn(r)}static emptyPath(){return new yn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class et{constructor(e){this.path=e}static fromPath(e){return new et(ur.fromString(e))}static fromName(e){return new et(ur.fromString(e).popFirst(5))}static empty(){return new et(ur.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ur.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return ur.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new et(new ur(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NS(t,e,r){if(!r)throw new Ye(Re.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function LI(t,e,r,n){if(e===!0&&n===!0)throw new Ye(Re.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function DE(t){if(!et.isDocumentKey(t))throw new Ye(Re.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function OE(t){if(et.isDocumentKey(t))throw new Ye(Re.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function DS(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function om(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ut(12329,{type:typeof t})}function _l(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Ye(Re.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=om(t);throw new Ye(Re.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xr(t,e){const r={typeString:t};return e&&(r.value=e),r}function h0(t,e){if(!DS(t))throw new Ye(Re.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const a=e[n].typeString,o="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const l=t[n];if(a&&typeof l!==a){r=`JSON field '${n}' must be a ${a}.`;break}if(o!==void 0&&l!==o.value){r=`Expected '${n}' field to equal '${o.value}'`;break}}if(r)throw new Ye(Re.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FE=-62135596800,PE=1e6;class dr{static now(){return dr.fromMillis(Date.now())}static fromDate(e){return dr.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*PE);return new dr(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Ye(Re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Ye(Re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<FE)throw new Ye(Re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ye(Re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/PE}_compareTo(e){return this.seconds===e.seconds?At(this.nanoseconds,e.nanoseconds):At(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:dr._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(h0(e,dr._jsonSchema))return new dr(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-FE;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}dr._jsonSchemaVersion="firestore/timestamp/1.0",dr._jsonSchema={type:Xr("string",dr._jsonSchemaVersion),seconds:Xr("number"),nanoseconds:Xr("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gt{static fromTimestamp(e){return new gt(e)}static min(){return new gt(new dr(0,0))}static max(){return new gt(new dr(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hf=-1;function UI(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,a=gt.fromTimestamp(n===1e9?new dr(r+1,0):new dr(r,n));return new po(a,et.empty(),e)}function BI(t){return new po(t.readTime,t.key,Hf)}class po{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new po(gt.min(),et.empty(),Hf)}static max(){return new po(gt.max(),et.empty(),Hf)}}function VI(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=et.comparator(t.documentKey,e.documentKey),r!==0?r:At(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jI="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class HI{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nu(t){if(t.code!==Re.FAILED_PRECONDITION||t.message!==jI)throw t;Ke("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class De{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&ut(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new De((n,a)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(n,a)},this.catchCallback=o=>{this.wrapFailure(r,o).next(n,a)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof De?r:De.resolve(r)}catch(r){return De.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):De.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):De.reject(r)}static resolve(e){return new De((r,n)=>{r(e)})}static reject(e){return new De((r,n)=>{n(e)})}static waitFor(e){return new De((r,n)=>{let a=0,o=0,l=!1;e.forEach(u=>{++a,u.next(()=>{++o,l&&o===a&&r()},h=>n(h))}),l=!0,o===a&&r()})}static or(e){let r=De.resolve(!1);for(const n of e)r=r.next(a=>a?De.resolve(a):n());return r}static forEach(e,r){const n=[];return e.forEach((a,o)=>{n.push(r.call(this,a,o))}),this.waitFor(n)}static mapArray(e,r){return new De((n,a)=>{const o=e.length,l=new Array(o);let u=0;for(let h=0;h<o;h++){const d=h;r(e[d]).next(p=>{l[d]=p,++u,u===o&&n(l)},p=>a(p))}})}static doWhile(e,r){return new De((n,a)=>{const o=()=>{e()===!0?r().next(()=>{o()},a):n()};o()})}}function zI(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function au(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lm{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this._e(n),this.ae=n=>r.writeSequenceNumber(n))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}lm.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const px=-1;function cm(t){return t==null}function Cd(t){return t===0&&1/t==-1/0}function GI(t){return typeof t=="number"&&Number.isInteger(t)&&!Cd(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OS="";function qI(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=ME(e)),e=WI(t.get(r),e);return ME(e)}function WI(t,e){let r=e;const n=t.length;for(let a=0;a<n;a++){const o=t.charAt(a);switch(o){case"\0":r+="";break;case OS:r+="";break;default:r+=o}}return r}function ME(t){return t+OS+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LE(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function bo(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function FS(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Er{constructor(e,r){this.comparator=e,this.root=r||vn.EMPTY}insert(e,r){return new Er(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,vn.BLACK,null,null))}remove(e){return new Er(this.comparator,this.root.remove(e,this.comparator).copy(null,null,vn.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const a=this.comparator(e,n.key);if(a===0)return r+n.left.size;a<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new $h(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new $h(this.root,e,this.comparator,!1)}getReverseIterator(){return new $h(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new $h(this.root,e,this.comparator,!0)}}class $h{constructor(e,r,n,a){this.isReverse=a,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=r?n(e.key,r):1,r&&a&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class vn{constructor(e,r,n,a,o){this.key=e,this.value=r,this.color=n??vn.RED,this.left=a??vn.EMPTY,this.right=o??vn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,a,o){return new vn(e??this.key,r??this.value,n??this.color,a??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let a=this;const o=n(e,a.key);return a=o<0?a.copy(null,null,null,a.left.insert(e,r,n),null):o===0?a.copy(null,r,null,null,null):a.copy(null,null,null,null,a.right.insert(e,r,n)),a.fixUp()}removeMin(){if(this.left.isEmpty())return vn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,a=this;if(r(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,r),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),r(e,a.key)===0){if(a.right.isEmpty())return vn.EMPTY;n=a.right.min(),a=a.copy(n.key,n.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,r))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,vn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,vn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ut(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ut(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ut(27949);return e+(this.isRed()?0:1)}}vn.EMPTY=null,vn.RED=!0,vn.BLACK=!1;vn.EMPTY=new class{constructor(){this.size=0}get key(){throw ut(57766)}get value(){throw ut(16141)}get color(){throw ut(16727)}get left(){throw ut(29726)}get right(){throw ut(36894)}copy(e,r,n,a,o){return this}insert(e,r,n){return new vn(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tn{constructor(e){this.comparator=e,this.data=new Er(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const a=n.getNext();if(this.comparator(a.key,e[1])>=0)return;r(a.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new UE(this.data.getIterator())}getIteratorFrom(e){return new UE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof tn)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const a=r.getNext().key,o=n.getNext().key;if(this.comparator(a,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new tn(this.comparator);return r.data=e,r}}class UE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _a{constructor(e){this.fields=e,e.sort(yn.comparator)}static empty(){return new _a([])}unionWith(e){let r=new tn(yn.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new _a(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Kc(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PS extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tn{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(a){try{return atob(a)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new PS("Invalid base64 string: "+o):o}}(e);return new Tn(r)}static fromUint8Array(e){const r=function(a){let o="";for(let l=0;l<a.length;++l)o+=String.fromCharCode(a[l]);return o}(e);return new Tn(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let a=0;a<r.length;a++)n[a]=r.charCodeAt(a);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return At(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Tn.EMPTY_BYTE_STRING=new Tn("");const XI=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function go(t){if(Kt(!!t,39018),typeof t=="string"){let e=0;const r=XI.exec(t);if(Kt(!!r,46558,{timestamp:t}),r[1]){let a=r[1];a=(a+"000000000").substr(0,9),e=Number(a)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Fr(t.seconds),nanos:Fr(t.nanos)}}function Fr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function xo(t){return typeof t=="string"?Tn.fromBase64String(t):Tn.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MS="server_timestamp",LS="__type__",US="__previous_value__",BS="__local_write_time__";function gx(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[LS])===null||r===void 0?void 0:r.stringValue)===MS}function um(t){const e=t.mapValue.fields[US];return gx(e)?um(e):e}function zf(t){const e=go(t.mapValue.fields[BS].timestampValue);return new dr(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KI{constructor(e,r,n,a,o,l,u,h,d,p){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=a,this.ssl=o,this.forceLongPolling=l,this.autoDetectLongPolling=u,this.longPollingOptions=h,this.useFetchStreams=d,this.isUsingEmulator=p}}const Rd="(default)";class Gf{constructor(e,r){this.projectId=e,this.database=r||Rd}static empty(){return new Gf("","")}get isDefaultDatabase(){return this.database===Rd}isEqual(e){return e instanceof Gf&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VS="__type__",YI="__max__",Qh={mapValue:{}},jS="__vector__",Id="value";function vo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?gx(t)?4:QI(t)?9007199254740991:$I(t)?10:11:ut(28295,{value:t})}function Li(t,e){if(t===e)return!0;const r=vo(t);if(r!==vo(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return zf(t).isEqual(zf(e));case 3:return function(a,o){if(typeof a.timestampValue=="string"&&typeof o.timestampValue=="string"&&a.timestampValue.length===o.timestampValue.length)return a.timestampValue===o.timestampValue;const l=go(a.timestampValue),u=go(o.timestampValue);return l.seconds===u.seconds&&l.nanos===u.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(a,o){return xo(a.bytesValue).isEqual(xo(o.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(a,o){return Fr(a.geoPointValue.latitude)===Fr(o.geoPointValue.latitude)&&Fr(a.geoPointValue.longitude)===Fr(o.geoPointValue.longitude)}(t,e);case 2:return function(a,o){if("integerValue"in a&&"integerValue"in o)return Fr(a.integerValue)===Fr(o.integerValue);if("doubleValue"in a&&"doubleValue"in o){const l=Fr(a.doubleValue),u=Fr(o.doubleValue);return l===u?Cd(l)===Cd(u):isNaN(l)&&isNaN(u)}return!1}(t,e);case 9:return Kc(t.arrayValue.values||[],e.arrayValue.values||[],Li);case 10:case 11:return function(a,o){const l=a.mapValue.fields||{},u=o.mapValue.fields||{};if(LE(l)!==LE(u))return!1;for(const h in l)if(l.hasOwnProperty(h)&&(u[h]===void 0||!Li(l[h],u[h])))return!1;return!0}(t,e);default:return ut(52216,{left:t})}}function qf(t,e){return(t.values||[]).find(r=>Li(r,e))!==void 0}function Yc(t,e){if(t===e)return 0;const r=vo(t),n=vo(e);if(r!==n)return At(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return At(t.booleanValue,e.booleanValue);case 2:return function(o,l){const u=Fr(o.integerValue||o.doubleValue),h=Fr(l.integerValue||l.doubleValue);return u<h?-1:u>h?1:u===h?0:isNaN(u)?isNaN(h)?0:-1:1}(t,e);case 3:return BE(t.timestampValue,e.timestampValue);case 4:return BE(zf(t),zf(e));case 5:return w1(t.stringValue,e.stringValue);case 6:return function(o,l){const u=xo(o),h=xo(l);return u.compareTo(h)}(t.bytesValue,e.bytesValue);case 7:return function(o,l){const u=o.split("/"),h=l.split("/");for(let d=0;d<u.length&&d<h.length;d++){const p=At(u[d],h[d]);if(p!==0)return p}return At(u.length,h.length)}(t.referenceValue,e.referenceValue);case 8:return function(o,l){const u=At(Fr(o.latitude),Fr(l.latitude));return u!==0?u:At(Fr(o.longitude),Fr(l.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return VE(t.arrayValue,e.arrayValue);case 10:return function(o,l){var u,h,d,p;const v=o.fields||{},_=l.fields||{},E=(u=v[Id])===null||u===void 0?void 0:u.arrayValue,S=(h=_[Id])===null||h===void 0?void 0:h.arrayValue,y=At(((d=E==null?void 0:E.values)===null||d===void 0?void 0:d.length)||0,((p=S==null?void 0:S.values)===null||p===void 0?void 0:p.length)||0);return y!==0?y:VE(E,S)}(t.mapValue,e.mapValue);case 11:return function(o,l){if(o===Qh.mapValue&&l===Qh.mapValue)return 0;if(o===Qh.mapValue)return 1;if(l===Qh.mapValue)return-1;const u=o.fields||{},h=Object.keys(u),d=l.fields||{},p=Object.keys(d);h.sort(),p.sort();for(let v=0;v<h.length&&v<p.length;++v){const _=w1(h[v],p[v]);if(_!==0)return _;const E=Yc(u[h[v]],d[p[v]]);if(E!==0)return E}return At(h.length,p.length)}(t.mapValue,e.mapValue);default:throw ut(23264,{le:r})}}function BE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return At(t,e);const r=go(t),n=go(e),a=At(r.seconds,n.seconds);return a!==0?a:At(r.nanos,n.nanos)}function VE(t,e){const r=t.values||[],n=e.values||[];for(let a=0;a<r.length&&a<n.length;++a){const o=Yc(r[a],n[a]);if(o)return o}return At(r.length,n.length)}function $c(t){return S1(t)}function S1(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=go(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return xo(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return et.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",a=!0;for(const o of r.values||[])a?a=!1:n+=",",n+=S1(o);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let a="{",o=!0;for(const l of n)o?o=!1:a+=",",a+=`${l}:${S1(r.fields[l])}`;return a+"}"}(t.mapValue):ut(61005,{value:t})}function xd(t){switch(vo(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=um(t);return e?16+xd(e):16;case 5:return 2*t.stringValue.length;case 6:return xo(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((a,o)=>a+xd(o),0)}(t.arrayValue);case 10:case 11:return function(n){let a=0;return bo(n.fields,(o,l)=>{a+=o.length+xd(l)}),a}(t.mapValue);default:throw ut(13486,{value:t})}}function jE(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function A1(t){return!!t&&"integerValue"in t}function xx(t){return!!t&&"arrayValue"in t}function HE(t){return!!t&&"nullValue"in t}function zE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function vd(t){return!!t&&"mapValue"in t}function $I(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[VS])===null||r===void 0?void 0:r.stringValue)===jS}function bf(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return bo(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=bf(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=bf(t.arrayValue.values[r]);return e}return Object.assign({},t)}function QI(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===YI}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ra{constructor(e){this.value=e}static empty(){return new ra({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!vd(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=bf(r)}setAll(e){let r=yn.emptyPath(),n={},a=[];e.forEach((l,u)=>{if(!r.isImmediateParentOf(u)){const h=this.getFieldsMap(r);this.applyChanges(h,n,a),n={},a=[],r=u.popLast()}l?n[u.lastSegment()]=bf(l):a.push(u.lastSegment())});const o=this.getFieldsMap(r);this.applyChanges(o,n,a)}delete(e){const r=this.field(e.popLast());vd(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return Li(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let a=r.mapValue.fields[e.get(n)];vd(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=a),r=a}return r.mapValue.fields}applyChanges(e,r,n){bo(r,(a,o)=>e[a]=o);for(const a of n)delete e[a]}clone(){return new ra(bf(this.value))}}function HS(t){const e=[];return bo(t.fields,(r,n)=>{const a=new yn([r]);if(vd(n)){const o=HS(n.mapValue).fields;if(o.length===0)e.push(a);else for(const l of o)e.push(a.child(l))}else e.push(a)}),new _a(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class In{constructor(e,r,n,a,o,l,u){this.key=e,this.documentType=r,this.version=n,this.readTime=a,this.createTime=o,this.data=l,this.documentState=u}static newInvalidDocument(e){return new In(e,0,gt.min(),gt.min(),gt.min(),ra.empty(),0)}static newFoundDocument(e,r,n,a){return new In(e,1,r,gt.min(),n,a,0)}static newNoDocument(e,r){return new In(e,2,r,gt.min(),gt.min(),ra.empty(),0)}static newUnknownDocument(e,r){return new In(e,3,r,gt.min(),gt.min(),ra.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(gt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ra.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ra.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=gt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof In&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new In(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nd{constructor(e,r){this.position=e,this.inclusive=r}}function GE(t,e,r){let n=0;for(let a=0;a<t.position.length;a++){const o=e[a],l=t.position[a];if(o.field.isKeyField()?n=et.comparator(et.fromName(l.referenceValue),r.key):n=Yc(l,r.data.field(o.field)),o.dir==="desc"&&(n*=-1),n!==0)break}return n}function qE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Li(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dd{constructor(e,r="asc"){this.field=e,this.dir=r}}function ZI(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zS{}class Wr extends zS{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new eN(e,r,n):r==="array-contains"?new nN(e,n):r==="in"?new aN(e,n):r==="not-in"?new iN(e,n):r==="array-contains-any"?new sN(e,n):new Wr(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new tN(e,n):new rN(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(Yc(r,this.value)):r!==null&&vo(this.value)===vo(r)&&this.matchesComparison(Yc(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ut(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ni extends zS{constructor(e,r){super(),this.filters=e,this.op=r,this.he=null}static create(e,r){return new ni(e,r)}matches(e){return GS(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function GS(t){return t.op==="and"}function qS(t){return JI(t)&&GS(t)}function JI(t){for(const e of t.filters)if(e instanceof ni)return!1;return!0}function b1(t){if(t instanceof Wr)return t.field.canonicalString()+t.op.toString()+$c(t.value);if(qS(t))return t.filters.map(e=>b1(e)).join(",");{const e=t.filters.map(r=>b1(r)).join(",");return`${t.op}(${e})`}}function WS(t,e){return t instanceof Wr?function(n,a){return a instanceof Wr&&n.op===a.op&&n.field.isEqual(a.field)&&Li(n.value,a.value)}(t,e):t instanceof ni?function(n,a){return a instanceof ni&&n.op===a.op&&n.filters.length===a.filters.length?n.filters.reduce((o,l,u)=>o&&WS(l,a.filters[u]),!0):!1}(t,e):void ut(19439)}function XS(t){return t instanceof Wr?function(r){return`${r.field.canonicalString()} ${r.op} ${$c(r.value)}`}(t):t instanceof ni?function(r){return r.op.toString()+" {"+r.getFilters().map(XS).join(" ,")+"}"}(t):"Filter"}class eN extends Wr{constructor(e,r,n){super(e,r,n),this.key=et.fromName(n.referenceValue)}matches(e){const r=et.comparator(e.key,this.key);return this.matchesComparison(r)}}class tN extends Wr{constructor(e,r){super(e,"in",r),this.keys=KS("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class rN extends Wr{constructor(e,r){super(e,"not-in",r),this.keys=KS("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function KS(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>et.fromName(n.referenceValue))}class nN extends Wr{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return xx(r)&&qf(r.arrayValue,this.value)}}class aN extends Wr{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&qf(this.value.arrayValue,r)}}class iN extends Wr{constructor(e,r){super(e,"not-in",r)}matches(e){if(qf(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!qf(this.value.arrayValue,r)}}class sN extends Wr{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!xx(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>qf(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oN{constructor(e,r=null,n=[],a=[],o=null,l=null,u=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=a,this.limit=o,this.startAt=l,this.endAt=u,this.Pe=null}}function WE(t,e=null,r=[],n=[],a=null,o=null,l=null){return new oN(t,e,r,n,a,o,l)}function vx(t){const e=xt(t);if(e.Pe===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>b1(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(o){return o.field.canonicalString()+o.dir}(n)).join(","),cm(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>$c(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>$c(n)).join(",")),e.Pe=r}return e.Pe}function _x(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!ZI(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!WS(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!qE(t.startAt,e.startAt)&&qE(t.endAt,e.endAt)}function k1(t){return et.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d0{constructor(e,r=null,n=[],a=[],o=null,l="F",u=null,h=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=a,this.limit=o,this.limitType=l,this.startAt=u,this.endAt=h,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function lN(t,e,r,n,a,o,l,u){return new d0(t,e,r,n,a,o,l,u)}function YS(t){return new d0(t)}function XE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function $S(t){return t.collectionGroup!==null}function kf(t){const e=xt(t);if(e.Te===null){e.Te=[];const r=new Set;for(const o of e.explicitOrderBy)e.Te.push(o),r.add(o.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(l){let u=new tn(yn.comparator);return l.filters.forEach(h=>{h.getFlattenedFilters().forEach(d=>{d.isInequality()&&(u=u.add(d.field))})}),u})(e).forEach(o=>{r.has(o.canonicalString())||o.isKeyField()||e.Te.push(new Dd(o,n))}),r.has(yn.keyField().canonicalString())||e.Te.push(new Dd(yn.keyField(),n))}return e.Te}function Ii(t){const e=xt(t);return e.Ie||(e.Ie=cN(e,kf(t))),e.Ie}function cN(t,e){if(t.limitType==="F")return WE(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(a=>{const o=a.dir==="desc"?"asc":"desc";return new Dd(a.field,o)});const r=t.endAt?new Nd(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Nd(t.startAt.position,t.startAt.inclusive):null;return WE(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function C1(t,e){const r=t.filters.concat([e]);return new d0(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function R1(t,e,r){return new d0(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function fm(t,e){return _x(Ii(t),Ii(e))&&t.limitType===e.limitType}function QS(t){return`${vx(Ii(t))}|lt:${t.limitType}`}function Nc(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(a=>XS(a)).join(", ")}]`),cm(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(a=>function(l){return`${l.field.canonicalString()} (${l.dir})`}(a)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(a=>$c(a)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(a=>$c(a)).join(",")),`Target(${n})`}(Ii(t))}; limitType=${t.limitType})`}function hm(t,e){return e.isFoundDocument()&&function(n,a){const o=a.key.path;return n.collectionGroup!==null?a.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(o):et.isDocumentKey(n.path)?n.path.isEqual(o):n.path.isImmediateParentOf(o)}(t,e)&&function(n,a){for(const o of kf(n))if(!o.field.isKeyField()&&a.data.field(o.field)===null)return!1;return!0}(t,e)&&function(n,a){for(const o of n.filters)if(!o.matches(a))return!1;return!0}(t,e)&&function(n,a){return!(n.startAt&&!function(l,u,h){const d=GE(l,u,h);return l.inclusive?d<=0:d<0}(n.startAt,kf(n),a)||n.endAt&&!function(l,u,h){const d=GE(l,u,h);return l.inclusive?d>=0:d>0}(n.endAt,kf(n),a))}(t,e)}function uN(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function ZS(t){return(e,r)=>{let n=!1;for(const a of kf(t)){const o=fN(a,e,r);if(o!==0)return o;n=n||a.field.isKeyField()}return 0}}function fN(t,e,r){const n=t.field.isKeyField()?et.comparator(e.key,r.key):function(o,l,u){const h=l.data.field(o),d=u.data.field(o);return h!==null&&d!==null?Yc(h,d):ut(42886)}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return ut(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nl{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[a,o]of n)if(this.equalsFn(a,e))return o}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),a=this.inner[n];if(a===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let o=0;o<a.length;o++)if(this.equalsFn(a[o][0],e))return void(a[o]=[e,r]);a.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let a=0;a<n.length;a++)if(this.equalsFn(n[a][0],e))return n.length===1?delete this.inner[r]:n.splice(a,1),this.innerSize--,!0;return!1}forEach(e){bo(this.inner,(r,n)=>{for(const[a,o]of n)e(a,o)})}isEmpty(){return FS(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hN=new Er(et.comparator);function gs(){return hN}const JS=new Er(et.comparator);function vf(...t){let e=JS;for(const r of t)e=e.insert(r.key,r);return e}function eA(t){let e=JS;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function ul(){return Cf()}function tA(){return Cf()}function Cf(){return new Nl(t=>t.toString(),(t,e)=>t.isEqual(e))}const dN=new Er(et.comparator),mN=new tn(et.comparator);function Ot(...t){let e=mN;for(const r of t)e=e.add(r);return e}const pN=new tn(At);function gN(){return pN}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yx(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Cd(e)?"-0":e}}function rA(t){return{integerValue:""+t}}function xN(t,e){return GI(e)?rA(e):yx(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dm{constructor(){this._=void 0}}function vN(t,e,r){return t instanceof Od?function(a,o){const l={fields:{[LS]:{stringValue:MS},[BS]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return o&&gx(o)&&(o=um(o)),o&&(l.fields[US]=o),{mapValue:l}}(r,e):t instanceof Wf?aA(t,e):t instanceof Xf?iA(t,e):function(a,o){const l=nA(a,o),u=KE(l)+KE(a.Ee);return A1(l)&&A1(a.Ee)?rA(u):yx(a.serializer,u)}(t,e)}function _N(t,e,r){return t instanceof Wf?aA(t,e):t instanceof Xf?iA(t,e):r}function nA(t,e){return t instanceof Fd?function(n){return A1(n)||function(o){return!!o&&"doubleValue"in o}(n)}(e)?e:{integerValue:0}:null}class Od extends dm{}class Wf extends dm{constructor(e){super(),this.elements=e}}function aA(t,e){const r=sA(e);for(const n of t.elements)r.some(a=>Li(a,n))||r.push(n);return{arrayValue:{values:r}}}class Xf extends dm{constructor(e){super(),this.elements=e}}function iA(t,e){let r=sA(e);for(const n of t.elements)r=r.filter(a=>!Li(a,n));return{arrayValue:{values:r}}}class Fd extends dm{constructor(e,r){super(),this.serializer=e,this.Ee=r}}function KE(t){return Fr(t.integerValue||t.doubleValue)}function sA(t){return xx(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function yN(t,e){return t.field.isEqual(e.field)&&function(n,a){return n instanceof Wf&&a instanceof Wf||n instanceof Xf&&a instanceof Xf?Kc(n.elements,a.elements,Li):n instanceof Fd&&a instanceof Fd?Li(n.Ee,a.Ee):n instanceof Od&&a instanceof Od}(t.transform,e.transform)}class EN{constructor(e,r){this.version=e,this.transformResults=r}}class ei{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new ei}static exists(e){return new ei(void 0,e)}static updateTime(e){return new ei(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function _d(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class mm{}function oA(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Ex(t.key,ei.none()):new m0(t.key,t.data,ei.none());{const r=t.data,n=ra.empty();let a=new tn(yn.comparator);for(let o of e.fields)if(!a.has(o)){let l=r.field(o);l===null&&o.length>1&&(o=o.popLast(),l=r.field(o)),l===null?n.delete(o):n.set(o,l),a=a.add(o)}return new ko(t.key,n,new _a(a.toArray()),ei.none())}}function TN(t,e,r){t instanceof m0?function(a,o,l){const u=a.value.clone(),h=$E(a.fieldTransforms,o,l.transformResults);u.setAll(h),o.convertToFoundDocument(l.version,u).setHasCommittedMutations()}(t,e,r):t instanceof ko?function(a,o,l){if(!_d(a.precondition,o))return void o.convertToUnknownDocument(l.version);const u=$E(a.fieldTransforms,o,l.transformResults),h=o.data;h.setAll(lA(a)),h.setAll(u),o.convertToFoundDocument(l.version,h).setHasCommittedMutations()}(t,e,r):function(a,o,l){o.convertToNoDocument(l.version).setHasCommittedMutations()}(0,e,r)}function Rf(t,e,r,n){return t instanceof m0?function(o,l,u,h){if(!_d(o.precondition,l))return u;const d=o.value.clone(),p=QE(o.fieldTransforms,h,l);return d.setAll(p),l.convertToFoundDocument(l.version,d).setHasLocalMutations(),null}(t,e,r,n):t instanceof ko?function(o,l,u,h){if(!_d(o.precondition,l))return u;const d=QE(o.fieldTransforms,h,l),p=l.data;return p.setAll(lA(o)),p.setAll(d),l.convertToFoundDocument(l.version,p).setHasLocalMutations(),u===null?null:u.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(v=>v.field))}(t,e,r,n):function(o,l,u){return _d(o.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):u}(t,e,r)}function wN(t,e){let r=null;for(const n of t.fieldTransforms){const a=e.data.field(n.field),o=nA(n.transform,a||null);o!=null&&(r===null&&(r=ra.empty()),r.set(n.field,o))}return r||null}function YE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,a){return n===void 0&&a===void 0||!(!n||!a)&&Kc(n,a,(o,l)=>yN(o,l))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class m0 extends mm{constructor(e,r,n,a=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class ko extends mm{constructor(e,r,n,a,o=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=a,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function lA(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function $E(t,e,r){const n=new Map;Kt(t.length===r.length,32656,{Ae:r.length,Re:t.length});for(let a=0;a<r.length;a++){const o=t[a],l=o.transform,u=e.data.field(o.field);n.set(o.field,_N(l,u,r[a]))}return n}function QE(t,e,r){const n=new Map;for(const a of t){const o=a.transform,l=r.data.field(a.field);n.set(a.field,vN(o,l,e))}return n}class Ex extends mm{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class SN extends mm{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AN{constructor(e,r,n,a){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=a}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let a=0;a<this.mutations.length;a++){const o=this.mutations[a];o.key.isEqual(e.key)&&TN(o,e,n[a])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Rf(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Rf(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=tA();return this.mutations.forEach(a=>{const o=e.get(a.key),l=o.overlayedDocument;let u=this.applyToLocalView(l,o.mutatedFields);u=r.has(a.key)?null:u;const h=oA(l,u);h!==null&&n.set(a.key,h),l.isValidDocument()||l.convertToNoDocument(gt.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),Ot())}isEqual(e){return this.batchId===e.batchId&&Kc(this.mutations,e.mutations,(r,n)=>YE(r,n))&&Kc(this.baseMutations,e.baseMutations,(r,n)=>YE(r,n))}}class Tx{constructor(e,r,n,a){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=a}static from(e,r,n){Kt(e.mutations.length===n.length,58842,{Ve:e.mutations.length,me:n.length});let a=function(){return dN}();const o=e.mutations;for(let l=0;l<o.length;l++)a=a.insert(o[l].key,n[l].version);return new Tx(e,r,n,a)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bN{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kN{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var zr,Vt;function CN(t){switch(t){case Re.OK:return ut(64938);case Re.CANCELLED:case Re.UNKNOWN:case Re.DEADLINE_EXCEEDED:case Re.RESOURCE_EXHAUSTED:case Re.INTERNAL:case Re.UNAVAILABLE:case Re.UNAUTHENTICATED:return!1;case Re.INVALID_ARGUMENT:case Re.NOT_FOUND:case Re.ALREADY_EXISTS:case Re.PERMISSION_DENIED:case Re.FAILED_PRECONDITION:case Re.ABORTED:case Re.OUT_OF_RANGE:case Re.UNIMPLEMENTED:case Re.DATA_LOSS:return!0;default:return ut(15467,{code:t})}}function cA(t){if(t===void 0)return ps("GRPC error has no .code"),Re.UNKNOWN;switch(t){case zr.OK:return Re.OK;case zr.CANCELLED:return Re.CANCELLED;case zr.UNKNOWN:return Re.UNKNOWN;case zr.DEADLINE_EXCEEDED:return Re.DEADLINE_EXCEEDED;case zr.RESOURCE_EXHAUSTED:return Re.RESOURCE_EXHAUSTED;case zr.INTERNAL:return Re.INTERNAL;case zr.UNAVAILABLE:return Re.UNAVAILABLE;case zr.UNAUTHENTICATED:return Re.UNAUTHENTICATED;case zr.INVALID_ARGUMENT:return Re.INVALID_ARGUMENT;case zr.NOT_FOUND:return Re.NOT_FOUND;case zr.ALREADY_EXISTS:return Re.ALREADY_EXISTS;case zr.PERMISSION_DENIED:return Re.PERMISSION_DENIED;case zr.FAILED_PRECONDITION:return Re.FAILED_PRECONDITION;case zr.ABORTED:return Re.ABORTED;case zr.OUT_OF_RANGE:return Re.OUT_OF_RANGE;case zr.UNIMPLEMENTED:return Re.UNIMPLEMENTED;case zr.DATA_LOSS:return Re.DATA_LOSS;default:return ut(39323,{code:t})}}(Vt=zr||(zr={}))[Vt.OK=0]="OK",Vt[Vt.CANCELLED=1]="CANCELLED",Vt[Vt.UNKNOWN=2]="UNKNOWN",Vt[Vt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Vt[Vt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Vt[Vt.NOT_FOUND=5]="NOT_FOUND",Vt[Vt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Vt[Vt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Vt[Vt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Vt[Vt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Vt[Vt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Vt[Vt.ABORTED=10]="ABORTED",Vt[Vt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Vt[Vt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Vt[Vt.INTERNAL=13]="INTERNAL",Vt[Vt.UNAVAILABLE=14]="UNAVAILABLE",Vt[Vt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RN=new co([4294967295,4294967295],0);function ZE(t){const e=IS().encode(t),r=new TS;return r.update(e),new Uint8Array(r.digest())}function JE(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),a=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new co([r,n],0),new co([a,o],0)]}class wx{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new _f(`Invalid padding: ${r}`);if(n<0)throw new _f(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new _f(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new _f(`Invalid padding when bitmap length is 0: ${r}`);this.fe=8*e.length-r,this.ge=co.fromNumber(this.fe)}pe(e,r,n){let a=e.add(r.multiply(co.fromNumber(n)));return a.compare(RN)===1&&(a=new co([a.getBits(0),a.getBits(1)],0)),a.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;const r=ZE(e),[n,a]=JE(r);for(let o=0;o<this.hashCount;o++){const l=this.pe(n,a,o);if(!this.ye(l))return!1}return!0}static create(e,r,n){const a=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),l=new wx(o,a,r);return n.forEach(u=>l.insert(u)),l}insert(e){if(this.fe===0)return;const r=ZE(e),[n,a]=JE(r);for(let o=0;o<this.hashCount;o++){const l=this.pe(n,a,o);this.we(l)}}we(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class _f extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pm{constructor(e,r,n,a,o){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=a,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const a=new Map;return a.set(e,p0.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new pm(gt.min(),a,new Er(At),gs(),Ot())}}class p0{constructor(e,r,n,a,o){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=a,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new p0(n,r,Ot(),Ot(),Ot())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yd{constructor(e,r,n,a){this.Se=e,this.removedTargetIds=r,this.key=n,this.be=a}}class uA{constructor(e,r){this.targetId=e,this.De=r}}class fA{constructor(e,r,n=Tn.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=a}}class eT{constructor(){this.ve=0,this.Ce=tT(),this.Fe=Tn.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=Ot(),r=Ot(),n=Ot();return this.Ce.forEach((a,o)=>{switch(o){case 0:e=e.add(a);break;case 2:r=r.add(a);break;case 1:n=n.add(a);break;default:ut(38017,{changeType:o})}}),new p0(this.Fe,this.Me,e,r,n)}ke(){this.xe=!1,this.Ce=tT()}qe(e,r){this.xe=!0,this.Ce=this.Ce.insert(e,r)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,Kt(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class IN{constructor(e){this.We=e,this.Ge=new Map,this.ze=gs(),this.je=Zh(),this.Je=Zh(),this.He=new Er(At)}Ye(e){for(const r of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(r,e.be):this.Xe(r,e.key,e.be);for(const r of e.removedTargetIds)this.Xe(r,e.key,e.be)}et(e){this.forEachTarget(e,r=>{const n=this.tt(r);switch(e.state){case 0:this.nt(r)&&n.Be(e.resumeToken);break;case 1:n.Ue(),n.Oe||n.ke(),n.Be(e.resumeToken);break;case 2:n.Ue(),n.Oe||this.removeTarget(r);break;case 3:this.nt(r)&&(n.Ke(),n.Be(e.resumeToken));break;case 4:this.nt(r)&&(this.rt(r),n.Be(e.resumeToken));break;default:ut(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Ge.forEach((n,a)=>{this.nt(a)&&r(a)})}it(e){const r=e.targetId,n=e.De.count,a=this.st(r);if(a){const o=a.target;if(k1(o))if(n===0){const l=new et(o.path);this.Xe(r,l,In.newNoDocument(l,gt.min()))}else Kt(n===1,20013,{expectedCount:n});else{const l=this.ot(r);if(l!==n){const u=this._t(e),h=u?this.ut(u,e,l):1;if(h!==0){this.rt(r);const d=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(r,d)}}}}}_t(e){const r=e.De.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:a=0},hashCount:o=0}=r;let l,u;try{l=xo(n).toUint8Array()}catch(h){if(h instanceof PS)return mo("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{u=new wx(l,a,o)}catch(h){return mo(h instanceof _f?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return u.fe===0?null:u}ut(e,r,n){return r.De.count===n-this.ht(e,r.targetId)?0:2}ht(e,r){const n=this.We.getRemoteKeysForTarget(r);let a=0;return n.forEach(o=>{const l=this.We.lt(),u=`projects/${l.projectId}/databases/${l.database}/documents/${o.path.canonicalString()}`;e.mightContain(u)||(this.Xe(r,o,null),a++)}),a}Pt(e){const r=new Map;this.Ge.forEach((o,l)=>{const u=this.st(l);if(u){if(o.current&&k1(u.target)){const h=new et(u.target.path);this.Tt(h).has(l)||this.It(l,h)||this.Xe(l,h,In.newNoDocument(h,e))}o.Ne&&(r.set(l,o.Le()),o.ke())}});let n=Ot();this.Je.forEach((o,l)=>{let u=!0;l.forEachWhile(h=>{const d=this.st(h);return!d||d.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(n=n.add(o))}),this.ze.forEach((o,l)=>l.setReadTime(e));const a=new pm(e,r,this.He,this.ze,n);return this.ze=gs(),this.je=Zh(),this.Je=Zh(),this.He=new Er(At),a}Ze(e,r){if(!this.nt(e))return;const n=this.It(e,r.key)?2:0;this.tt(e).qe(r.key,n),this.ze=this.ze.insert(r.key,r),this.je=this.je.insert(r.key,this.Tt(r.key).add(e)),this.Je=this.Je.insert(r.key,this.dt(r.key).add(e))}Xe(e,r,n){if(!this.nt(e))return;const a=this.tt(e);this.It(e,r)?a.qe(r,1):a.Qe(r),this.Je=this.Je.insert(r,this.dt(r).delete(e)),this.Je=this.Je.insert(r,this.dt(r).add(e)),n&&(this.ze=this.ze.insert(r,n))}removeTarget(e){this.Ge.delete(e)}ot(e){const r=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let r=this.Ge.get(e);return r||(r=new eT,this.Ge.set(e,r)),r}dt(e){let r=this.Je.get(e);return r||(r=new tn(At),this.Je=this.Je.insert(e,r)),r}Tt(e){let r=this.je.get(e);return r||(r=new tn(At),this.je=this.je.insert(e,r)),r}nt(e){const r=this.st(e)!==null;return r||Ke("WatchChangeAggregator","Detected inactive target",e),r}st(e){const r=this.Ge.get(e);return r&&r.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new eT),this.We.getRemoteKeysForTarget(e).forEach(r=>{this.Xe(e,r,null)})}It(e,r){return this.We.getRemoteKeysForTarget(e).has(r)}}function Zh(){return new Er(et.comparator)}function tT(){return new Er(et.comparator)}const NN={asc:"ASCENDING",desc:"DESCENDING"},DN={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ON={and:"AND",or:"OR"};class FN{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function I1(t,e){return t.useProto3Json||cm(e)?e:{value:e}}function Pd(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function hA(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function PN(t,e){return Pd(t,e.toTimestamp())}function Ni(t){return Kt(!!t,49232),gt.fromTimestamp(function(r){const n=go(r);return new dr(n.seconds,n.nanos)}(t))}function Sx(t,e){return N1(t,e).canonicalString()}function N1(t,e){const r=function(a){return new ur(["projects",a.projectId,"databases",a.database])}(t).child("documents");return e===void 0?r:r.child(e)}function dA(t){const e=ur.fromString(t);return Kt(vA(e),10190,{key:e.toString()}),e}function D1(t,e){return Sx(t.databaseId,e.path)}function zg(t,e){const r=dA(e);if(r.get(1)!==t.databaseId.projectId)throw new Ye(Re.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Ye(Re.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new et(pA(r))}function mA(t,e){return Sx(t.databaseId,e)}function MN(t){const e=dA(t);return e.length===4?ur.emptyPath():pA(e)}function O1(t){return new ur(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function pA(t){return Kt(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function rT(t,e,r){return{name:D1(t,e),fields:r.value.mapValue.fields}}function LN(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:ut(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],o=function(d,p){return d.useProto3Json?(Kt(p===void 0||typeof p=="string",58123),Tn.fromBase64String(p||"")):(Kt(p===void 0||p instanceof Buffer||p instanceof Uint8Array,16193),Tn.fromUint8Array(p||new Uint8Array))}(t,e.targetChange.resumeToken),l=e.targetChange.cause,u=l&&function(d){const p=d.code===void 0?Re.UNKNOWN:cA(d.code);return new Ye(p,d.message||"")}(l);r=new fA(n,a,o,u||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const a=zg(t,n.document.name),o=Ni(n.document.updateTime),l=n.document.createTime?Ni(n.document.createTime):gt.min(),u=new ra({mapValue:{fields:n.document.fields}}),h=In.newFoundDocument(a,o,l,u),d=n.targetIds||[],p=n.removedTargetIds||[];r=new yd(d,p,h.key,h)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const a=zg(t,n.document),o=n.readTime?Ni(n.readTime):gt.min(),l=In.newNoDocument(a,o),u=n.removedTargetIds||[];r=new yd([],u,l.key,l)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const a=zg(t,n.document),o=n.removedTargetIds||[];r=new yd([],o,a,null)}else{if(!("filter"in e))return ut(11601,{At:e});{e.filter;const n=e.filter;n.targetId;const{count:a=0,unchangedNames:o}=n,l=new kN(a,o),u=n.targetId;r=new uA(u,l)}}return r}function UN(t,e){let r;if(e instanceof m0)r={update:rT(t,e.key,e.value)};else if(e instanceof Ex)r={delete:D1(t,e.key)};else if(e instanceof ko)r={update:rT(t,e.key,e.data),updateMask:XN(e.fieldMask)};else{if(!(e instanceof SN))return ut(16599,{Rt:e.type});r={verify:D1(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(o,l){const u=l.transform;if(u instanceof Od)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof Wf)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof Xf)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof Fd)return{fieldPath:l.field.canonicalString(),increment:u.Ee};throw ut(20930,{transform:l.transform})}(0,n))),e.precondition.isNone||(r.currentDocument=function(a,o){return o.updateTime!==void 0?{updateTime:PN(a,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:ut(27497)}(t,e.precondition)),r}function BN(t,e){return t&&t.length>0?(Kt(e!==void 0,14353),t.map(r=>function(a,o){let l=a.updateTime?Ni(a.updateTime):Ni(o);return l.isEqual(gt.min())&&(l=Ni(o)),new EN(l,a.transformResults||[])}(r,e))):[]}function VN(t,e){return{documents:[mA(t,e.path)]}}function jN(t,e){const r={structuredQuery:{}},n=e.path;let a;e.collectionGroup!==null?(a=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=mA(t,a);const o=function(d){if(d.length!==0)return xA(ni.create(d,"and"))}(e.filters);o&&(r.structuredQuery.where=o);const l=function(d){if(d.length!==0)return d.map(p=>function(_){return{field:Dc(_.field),direction:GN(_.dir)}}(p))}(e.orderBy);l&&(r.structuredQuery.orderBy=l);const u=I1(t,e.limit);return u!==null&&(r.structuredQuery.limit=u),e.startAt&&(r.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{Vt:r,parent:a}}function HN(t){let e=MN(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let a=null;if(n>0){Kt(n===1,65062);const p=r.from[0];p.allDescendants?a=p.collectionId:e=e.child(p.collectionId)}let o=[];r.where&&(o=function(v){const _=gA(v);return _ instanceof ni&&qS(_)?_.getFilters():[_]}(r.where));let l=[];r.orderBy&&(l=function(v){return v.map(_=>function(S){return new Dd(Oc(S.field),function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(S.direction))}(_))}(r.orderBy));let u=null;r.limit&&(u=function(v){let _;return _=typeof v=="object"?v.value:v,cm(_)?null:_}(r.limit));let h=null;r.startAt&&(h=function(v){const _=!!v.before,E=v.values||[];return new Nd(E,_)}(r.startAt));let d=null;return r.endAt&&(d=function(v){const _=!v.before,E=v.values||[];return new Nd(E,_)}(r.endAt)),lN(e,a,l,o,u,"F",h,d)}function zN(t,e){const r=function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ut(28987,{purpose:a})}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function gA(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Oc(r.unaryFilter.field);return Wr.create(n,"==",{doubleValue:NaN});case"IS_NULL":const a=Oc(r.unaryFilter.field);return Wr.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=Oc(r.unaryFilter.field);return Wr.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=Oc(r.unaryFilter.field);return Wr.create(l,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ut(61313);default:return ut(60726)}}(t):t.fieldFilter!==void 0?function(r){return Wr.create(Oc(r.fieldFilter.field),function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ut(58110);default:return ut(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return ni.create(r.compositeFilter.filters.map(n=>gA(n)),function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return ut(1026)}}(r.compositeFilter.op))}(t):ut(30097,{filter:t})}function GN(t){return NN[t]}function qN(t){return DN[t]}function WN(t){return ON[t]}function Dc(t){return{fieldPath:t.canonicalString()}}function Oc(t){return yn.fromServerFormat(t.fieldPath)}function xA(t){return t instanceof Wr?function(r){if(r.op==="=="){if(zE(r.value))return{unaryFilter:{field:Dc(r.field),op:"IS_NAN"}};if(HE(r.value))return{unaryFilter:{field:Dc(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(zE(r.value))return{unaryFilter:{field:Dc(r.field),op:"IS_NOT_NAN"}};if(HE(r.value))return{unaryFilter:{field:Dc(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Dc(r.field),op:qN(r.op),value:r.value}}}(t):t instanceof ni?function(r){const n=r.getFilters().map(a=>xA(a));return n.length===1?n[0]:{compositeFilter:{op:WN(r.op),filters:n}}}(t):ut(54877,{filter:t})}function XN(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function vA(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class no{constructor(e,r,n,a,o=gt.min(),l=gt.min(),u=Tn.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=a,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=u,this.expectedCount=h}withSequenceNumber(e){return new no(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new no(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new no(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new no(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KN{constructor(e){this.gt=e}}function YN(t){const e=HN({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?R1(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $N{constructor(){this.Dn=new QN}addToCollectionParentIndex(e,r){return this.Dn.add(r),De.resolve()}getCollectionParents(e,r){return De.resolve(this.Dn.getEntries(r))}addFieldIndex(e,r){return De.resolve()}deleteFieldIndex(e,r){return De.resolve()}deleteAllFieldIndexes(e){return De.resolve()}createTargetIndexes(e,r){return De.resolve()}getDocumentsMatchingTarget(e,r){return De.resolve(null)}getIndexType(e,r){return De.resolve(0)}getFieldIndexes(e,r){return De.resolve([])}getNextCollectionGroupToUpdate(e){return De.resolve(null)}getMinOffset(e,r){return De.resolve(po.min())}getMinOffsetFromCollectionGroup(e,r){return De.resolve(po.min())}updateCollectionGroup(e,r,n){return De.resolve()}updateIndexEntries(e,r){return De.resolve()}}class QN{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),a=this.index[r]||new tn(ur.comparator),o=!a.has(n);return this.index[r]=a.add(n),o}has(e){const r=e.lastSegment(),n=e.popLast(),a=this.index[r];return a&&a.has(n)}getEntries(e){return(this.index[e]||new tn(ur.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nT={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},_A=41943040;class ta{static withCacheSize(e){return new ta(e,ta.DEFAULT_COLLECTION_PERCENTILE,ta.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ta.DEFAULT_COLLECTION_PERCENTILE=10,ta.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ta.DEFAULT=new ta(_A,ta.DEFAULT_COLLECTION_PERCENTILE,ta.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ta.DISABLED=new ta(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qc{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new Qc(0)}static ur(){return new Qc(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aT="LruGarbageCollector",ZN=1048576;function iT([t,e],[r,n]){const a=At(t,r);return a===0?At(e,n):a}class JN{constructor(e){this.Tr=e,this.buffer=new tn(iT),this.Ir=0}dr(){return++this.Ir}Er(e){const r=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();iT(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class eD{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){Ke(aT,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){au(r)?Ke(aT,"Ignoring IndexedDB error during garbage collection: ",r):await nu(r)}await this.Rr(3e5)})}}class tD{constructor(e,r){this.Vr=e,this.params=r}calculateTargetCount(e,r){return this.Vr.mr(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return De.resolve(lm.ue);const n=new JN(r);return this.Vr.forEachTarget(e,a=>n.Er(a.sequenceNumber)).next(()=>this.Vr.gr(e,a=>n.Er(a))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.Vr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.Vr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(Ke("LruGarbageCollector","Garbage collection skipped; disabled"),De.resolve(nT)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Ke("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),nT):this.pr(e,r))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,r){let n,a,o,l,u,h,d;const p=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(v=>(v>this.params.maximumSequenceNumbersToCollect?(Ke("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),a=this.params.maximumSequenceNumbersToCollect):a=v,l=Date.now(),this.nthSequenceNumber(e,a))).next(v=>(n=v,u=Date.now(),this.removeTargets(e,n,r))).next(v=>(o=v,h=Date.now(),this.removeOrphanedDocuments(e,n))).next(v=>(d=Date.now(),Ic()<=Dt.DEBUG&&Ke("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${l-p}ms
	Determined least recently used ${a} in `+(u-l)+`ms
	Removed ${o} targets in `+(h-u)+`ms
	Removed ${v} documents in `+(d-h)+`ms
Total Duration: ${d-p}ms`),De.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:o,documentsRemoved:v})))}}function rD(t,e){return new tD(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nD{constructor(){this.changes=new Nl(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,In.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?De.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aD{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iD{constructor(e,r,n,a){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=a}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(a=>(n=a,this.remoteDocumentCache.getEntry(e,r))).next(a=>(n!==null&&Rf(n.mutation,a,_a.empty(),dr.now()),a))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,Ot()).next(()=>n))}getLocalViewOfDocuments(e,r,n=Ot()){const a=ul();return this.populateOverlays(e,a,r).next(()=>this.computeViews(e,r,a,n).next(o=>{let l=vf();return o.forEach((u,h)=>{l=l.insert(u,h.overlayedDocument)}),l}))}getOverlayedDocuments(e,r){const n=ul();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,Ot()))}populateOverlays(e,r,n){const a=[];return n.forEach(o=>{r.has(o)||a.push(o)}),this.documentOverlayCache.getOverlays(e,a).next(o=>{o.forEach((l,u)=>{r.set(l,u)})})}computeViews(e,r,n,a){let o=gs();const l=Cf(),u=function(){return Cf()}();return r.forEach((h,d)=>{const p=n.get(d.key);a.has(d.key)&&(p===void 0||p.mutation instanceof ko)?o=o.insert(d.key,d):p!==void 0?(l.set(d.key,p.mutation.getFieldMask()),Rf(p.mutation,d,p.mutation.getFieldMask(),dr.now())):l.set(d.key,_a.empty())}),this.recalculateAndSaveOverlays(e,o).next(h=>(h.forEach((d,p)=>l.set(d,p)),r.forEach((d,p)=>{var v;return u.set(d,new aD(p,(v=l.get(d))!==null&&v!==void 0?v:null))}),u))}recalculateAndSaveOverlays(e,r){const n=Cf();let a=new Er((l,u)=>l-u),o=Ot();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(l=>{for(const u of l)u.keys().forEach(h=>{const d=r.get(h);if(d===null)return;let p=n.get(h)||_a.empty();p=u.applyToLocalView(d,p),n.set(h,p);const v=(a.get(u.batchId)||Ot()).add(h);a=a.insert(u.batchId,v)})}).next(()=>{const l=[],u=a.getReverseIterator();for(;u.hasNext();){const h=u.getNext(),d=h.key,p=h.value,v=tA();p.forEach(_=>{if(!o.has(_)){const E=oA(r.get(_),n.get(_));E!==null&&v.set(_,E),o=o.add(_)}}),l.push(this.documentOverlayCache.saveOverlays(e,d,v))}return De.waitFor(l)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,a){return function(l){return et.isDocumentKey(l.path)&&l.collectionGroup===null&&l.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):$S(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,a):this.getDocumentsMatchingCollectionQuery(e,r,n,a)}getNextDocuments(e,r,n,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,a).next(o=>{const l=a-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,a-o.size):De.resolve(ul());let u=Hf,h=o;return l.next(d=>De.forEach(d,(p,v)=>(u<v.largestBatchId&&(u=v.largestBatchId),o.get(p)?De.resolve():this.remoteDocumentCache.getEntry(e,p).next(_=>{h=h.insert(p,_)}))).next(()=>this.populateOverlays(e,d,o)).next(()=>this.computeViews(e,h,d,Ot())).next(p=>({batchId:u,changes:eA(p)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new et(r)).next(n=>{let a=vf();return n.isFoundDocument()&&(a=a.insert(n.key,n)),a})}getDocumentsMatchingCollectionGroupQuery(e,r,n,a){const o=r.collectionGroup;let l=vf();return this.indexManager.getCollectionParents(e,o).next(u=>De.forEach(u,h=>{const d=function(v,_){return new d0(_,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)}(r,h.child(o));return this.getDocumentsMatchingCollectionQuery(e,d,n,a).next(p=>{p.forEach((v,_)=>{l=l.insert(v,_)})})}).next(()=>l))}getDocumentsMatchingCollectionQuery(e,r,n,a){let o;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(l=>(o=l,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,o,a))).next(l=>{o.forEach((h,d)=>{const p=d.getKey();l.get(p)===null&&(l=l.insert(p,In.newInvalidDocument(p)))});let u=vf();return l.forEach((h,d)=>{const p=o.get(h);p!==void 0&&Rf(p.mutation,d,_a.empty(),dr.now()),hm(r,d)&&(u=u.insert(h,d))}),u})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sD{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,r){return De.resolve(this.Br.get(r))}saveBundleMetadata(e,r){return this.Br.set(r.id,function(a){return{id:a.id,version:a.version,createTime:Ni(a.createTime)}}(r)),De.resolve()}getNamedQuery(e,r){return De.resolve(this.Lr.get(r))}saveNamedQuery(e,r){return this.Lr.set(r.name,function(a){return{name:a.name,query:YN(a.bundledQuery),readTime:Ni(a.readTime)}}(r)),De.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oD{constructor(){this.overlays=new Er(et.comparator),this.kr=new Map}getOverlay(e,r){return De.resolve(this.overlays.get(r))}getOverlays(e,r){const n=ul();return De.forEach(r,a=>this.getOverlay(e,a).next(o=>{o!==null&&n.set(a,o)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((a,o)=>{this.wt(e,r,o)}),De.resolve()}removeOverlaysForBatchId(e,r,n){const a=this.kr.get(n);return a!==void 0&&(a.forEach(o=>this.overlays=this.overlays.remove(o)),this.kr.delete(n)),De.resolve()}getOverlaysForCollection(e,r,n){const a=ul(),o=r.length+1,l=new et(r.child("")),u=this.overlays.getIteratorFrom(l);for(;u.hasNext();){const h=u.getNext().value,d=h.getKey();if(!r.isPrefixOf(d.path))break;d.path.length===o&&h.largestBatchId>n&&a.set(h.getKey(),h)}return De.resolve(a)}getOverlaysForCollectionGroup(e,r,n,a){let o=new Er((d,p)=>d-p);const l=this.overlays.getIterator();for(;l.hasNext();){const d=l.getNext().value;if(d.getKey().getCollectionGroup()===r&&d.largestBatchId>n){let p=o.get(d.largestBatchId);p===null&&(p=ul(),o=o.insert(d.largestBatchId,p)),p.set(d.getKey(),d)}}const u=ul(),h=o.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach((d,p)=>u.set(d,p)),!(u.size()>=a)););return De.resolve(u)}wt(e,r,n){const a=this.overlays.get(n.key);if(a!==null){const l=this.kr.get(a.largestBatchId).delete(n.key);this.kr.set(a.largestBatchId,l)}this.overlays=this.overlays.insert(n.key,new bN(r,n));let o=this.kr.get(r);o===void 0&&(o=Ot(),this.kr.set(r,o)),this.kr.set(r,o.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lD{constructor(){this.sessionToken=Tn.EMPTY_BYTE_STRING}getSessionToken(e){return De.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,De.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ax{constructor(){this.qr=new tn(cn.Qr),this.$r=new tn(cn.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,r){const n=new cn(e,r);this.qr=this.qr.add(n),this.$r=this.$r.add(n)}Kr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Wr(new cn(e,r))}Gr(e,r){e.forEach(n=>this.removeReference(n,r))}zr(e){const r=new et(new ur([])),n=new cn(r,e),a=new cn(r,e+1),o=[];return this.$r.forEachInRange([n,a],l=>{this.Wr(l),o.push(l.key)}),o}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const r=new et(new ur([])),n=new cn(r,e),a=new cn(r,e+1);let o=Ot();return this.$r.forEachInRange([n,a],l=>{o=o.add(l.key)}),o}containsKey(e){const r=new cn(e,0),n=this.qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class cn{constructor(e,r){this.key=e,this.Hr=r}static Qr(e,r){return et.comparator(e.key,r.key)||At(e.Hr,r.Hr)}static Ur(e,r){return At(e.Hr,r.Hr)||et.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cD{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.er=1,this.Yr=new tn(cn.Qr)}checkEmpty(e){return De.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,a){const o=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new AN(o,r,n,a);this.mutationQueue.push(l);for(const u of a)this.Yr=this.Yr.add(new cn(u.key,o)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return De.resolve(l)}lookupMutationBatch(e,r){return De.resolve(this.Zr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,a=this.Xr(n),o=a<0?0:a;return De.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return De.resolve(this.mutationQueue.length===0?px:this.er-1)}getAllMutationBatches(e){return De.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new cn(r,0),a=new cn(r,Number.POSITIVE_INFINITY),o=[];return this.Yr.forEachInRange([n,a],l=>{const u=this.Zr(l.Hr);o.push(u)}),De.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new tn(At);return r.forEach(a=>{const o=new cn(a,0),l=new cn(a,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([o,l],u=>{n=n.add(u.Hr)})}),De.resolve(this.ei(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,a=n.length+1;let o=n;et.isDocumentKey(o)||(o=o.child(""));const l=new cn(new et(o),0);let u=new tn(At);return this.Yr.forEachWhile(h=>{const d=h.key.path;return!!n.isPrefixOf(d)&&(d.length===a&&(u=u.add(h.Hr)),!0)},l),De.resolve(this.ei(u))}ei(e){const r=[];return e.forEach(n=>{const a=this.Zr(n);a!==null&&r.push(a)}),r}removeMutationBatch(e,r){Kt(this.ti(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Yr;return De.forEach(r.mutations,a=>{const o=new cn(a.key,r.batchId);return n=n.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)}).next(()=>{this.Yr=n})}rr(e){}containsKey(e,r){const n=new cn(r,0),a=this.Yr.firstAfterOrEqual(n);return De.resolve(r.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,De.resolve()}ti(e,r){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const r=this.Xr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uD{constructor(e){this.ni=e,this.docs=function(){return new Er(et.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,a=this.docs.get(n),o=a?a.size:0,l=this.ni(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:l}),this.size+=l-o,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return De.resolve(n?n.document.mutableCopy():In.newInvalidDocument(r))}getEntries(e,r){let n=gs();return r.forEach(a=>{const o=this.docs.get(a);n=n.insert(a,o?o.document.mutableCopy():In.newInvalidDocument(a))}),De.resolve(n)}getDocumentsMatchingQuery(e,r,n,a){let o=gs();const l=r.path,u=new et(l.child("__id-9223372036854775808__")),h=this.docs.getIteratorFrom(u);for(;h.hasNext();){const{key:d,value:{document:p}}=h.getNext();if(!l.isPrefixOf(d.path))break;d.path.length>l.length+1||VI(BI(p),n)<=0||(a.has(p.key)||hm(r,p))&&(o=o.insert(p.key,p.mutableCopy()))}return De.resolve(o)}getAllFromCollectionGroup(e,r,n,a){ut(9500)}ri(e,r){return De.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new fD(this)}getSize(e){return De.resolve(this.size)}}class fD extends nD{constructor(e){super(),this.Or=e}applyChanges(e){const r=[];return this.changes.forEach((n,a)=>{a.isValidDocument()?r.push(this.Or.addEntry(e,a)):this.Or.removeEntry(n)}),De.waitFor(r)}getFromCache(e,r){return this.Or.getEntry(e,r)}getAllFromCache(e,r){return this.Or.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hD{constructor(e){this.persistence=e,this.ii=new Nl(r=>vx(r),_x),this.lastRemoteSnapshotVersion=gt.min(),this.highestTargetId=0,this.si=0,this.oi=new Ax,this.targetCount=0,this._i=Qc.ar()}forEachTarget(e,r){return this.ii.forEach((n,a)=>r(a)),De.resolve()}getLastRemoteSnapshotVersion(e){return De.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return De.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),De.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.si&&(this.si=r),De.resolve()}hr(e){this.ii.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this._i=new Qc(r),this.highestTargetId=r),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,r){return this.hr(r),this.targetCount+=1,De.resolve()}updateTargetData(e,r){return this.hr(r),De.resolve()}removeTargetData(e,r){return this.ii.delete(r.target),this.oi.zr(r.targetId),this.targetCount-=1,De.resolve()}removeTargets(e,r,n){let a=0;const o=[];return this.ii.forEach((l,u)=>{u.sequenceNumber<=r&&n.get(u.targetId)===null&&(this.ii.delete(l),o.push(this.removeMatchingKeysForTargetId(e,u.targetId)),a++)}),De.waitFor(o).next(()=>a)}getTargetCount(e){return De.resolve(this.targetCount)}getTargetData(e,r){const n=this.ii.get(r)||null;return De.resolve(n)}addMatchingKeys(e,r,n){return this.oi.Kr(r,n),De.resolve()}removeMatchingKeys(e,r,n){this.oi.Gr(r,n);const a=this.persistence.referenceDelegate,o=[];return a&&r.forEach(l=>{o.push(a.markPotentiallyOrphaned(e,l))}),De.waitFor(o)}removeMatchingKeysForTargetId(e,r){return this.oi.zr(r),De.resolve()}getMatchingKeysForTargetId(e,r){const n=this.oi.Jr(r);return De.resolve(n)}containsKey(e,r){return De.resolve(this.oi.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yA{constructor(e,r){this.ai={},this.overlays={},this.ui=new lm(0),this.ci=!1,this.ci=!0,this.li=new lD,this.referenceDelegate=e(this),this.hi=new hD(this),this.indexManager=new $N,this.remoteDocumentCache=function(a){return new uD(a)}(n=>this.referenceDelegate.Pi(n)),this.serializer=new KN(r),this.Ti=new sD(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new oD,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ai[e.toKey()];return n||(n=new cD(r,this.referenceDelegate),this.ai[e.toKey()]=n),n}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,r,n){Ke("MemoryPersistence","Starting transaction:",e);const a=new dD(this.ui.next());return this.referenceDelegate.Ii(),n(a).next(o=>this.referenceDelegate.di(a).next(()=>o)).toPromise().then(o=>(a.raiseOnCommittedEvent(),o))}Ei(e,r){return De.or(Object.values(this.ai).map(n=>()=>n.containsKey(e,r)))}}class dD extends HI{constructor(e){super(),this.currentSequenceNumber=e}}class bx{constructor(e){this.persistence=e,this.Ai=new Ax,this.Ri=null}static Vi(e){return new bx(e)}get mi(){if(this.Ri)return this.Ri;throw ut(60996)}addReference(e,r,n){return this.Ai.addReference(n,r),this.mi.delete(n.toString()),De.resolve()}removeReference(e,r,n){return this.Ai.removeReference(n,r),this.mi.add(n.toString()),De.resolve()}markPotentiallyOrphaned(e,r){return this.mi.add(r.toString()),De.resolve()}removeTarget(e,r){this.Ai.zr(r.targetId).forEach(a=>this.mi.add(a.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(a=>{a.forEach(o=>this.mi.add(o.toString()))}).next(()=>n.removeTargetData(e,r))}Ii(){this.Ri=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return De.forEach(this.mi,n=>{const a=et.fromPath(n);return this.fi(e,a).next(o=>{o||r.removeEntry(a,gt.min())})}).next(()=>(this.Ri=null,r.apply(e)))}updateLimboDocument(e,r){return this.fi(e,r).next(n=>{n?this.mi.delete(r.toString()):this.mi.add(r.toString())})}Pi(e){return 0}fi(e,r){return De.or([()=>De.resolve(this.Ai.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ei(e,r)])}}class Md{constructor(e,r){this.persistence=e,this.gi=new Nl(n=>qI(n.path),(n,a)=>n.isEqual(a)),this.garbageCollector=rD(this,r)}static Vi(e,r){return new Md(e,r)}Ii(){}di(e){return De.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}mr(e){const r=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(a=>n+a))}yr(e){let r=0;return this.gr(e,n=>{r++}).next(()=>r)}gr(e,r){return De.forEach(this.gi,(n,a)=>this.Sr(e,n,a).next(o=>o?De.resolve():r(a)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const a=this.persistence.getRemoteDocumentCache(),o=a.newChangeBuffer();return a.ri(e,l=>this.Sr(e,l,r).next(u=>{u||(n++,o.removeEntry(l,gt.min()))})).next(()=>o.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.gi.set(r,e.currentSequenceNumber),De.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.gi.set(n,e.currentSequenceNumber),De.resolve()}removeReference(e,r,n){return this.gi.set(n,e.currentSequenceNumber),De.resolve()}updateLimboDocument(e,r){return this.gi.set(r,e.currentSequenceNumber),De.resolve()}Pi(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=xd(e.data.value)),r}Sr(e,r,n){return De.or([()=>this.persistence.Ei(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const a=this.gi.get(r);return De.resolve(a!==void 0&&a>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kx{constructor(e,r,n,a){this.targetId=e,this.fromCache=r,this.Is=n,this.ds=a}static Es(e,r){let n=Ot(),a=Ot();for(const o of r.docChanges)switch(o.type){case 0:n=n.add(o.doc.key);break;case 1:a=a.add(o.doc.key)}return new kx(e,r.fromCache,n,a)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mD{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pD{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=function(){return lR()?8:zI(Fn())>0?6:4}()}initialize(e,r){this.gs=e,this.indexManager=r,this.As=!0}getDocumentsMatchingQuery(e,r,n,a){const o={result:null};return this.ps(e,r).next(l=>{o.result=l}).next(()=>{if(!o.result)return this.ys(e,r,a,n).next(l=>{o.result=l})}).next(()=>{if(o.result)return;const l=new mD;return this.ws(e,r,l).next(u=>{if(o.result=u,this.Rs)return this.Ss(e,r,l,u.size)})}).next(()=>o.result)}Ss(e,r,n,a){return n.documentReadCount<this.Vs?(Ic()<=Dt.DEBUG&&Ke("QueryEngine","SDK will not create cache indexes for query:",Nc(r),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),De.resolve()):(Ic()<=Dt.DEBUG&&Ke("QueryEngine","Query:",Nc(r),"scans",n.documentReadCount,"local documents and returns",a,"documents as results."),n.documentReadCount>this.fs*a?(Ic()<=Dt.DEBUG&&Ke("QueryEngine","The SDK decides to create cache indexes for query:",Nc(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ii(r))):De.resolve())}ps(e,r){if(XE(r))return De.resolve(null);let n=Ii(r);return this.indexManager.getIndexType(e,n).next(a=>a===0?null:(r.limit!==null&&a===1&&(r=R1(r,null,"F"),n=Ii(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(o=>{const l=Ot(...o);return this.gs.getDocuments(e,l).next(u=>this.indexManager.getMinOffset(e,n).next(h=>{const d=this.bs(r,u);return this.Ds(r,d,l,h.readTime)?this.ps(e,R1(r,null,"F")):this.vs(e,d,r,h)}))})))}ys(e,r,n,a){return XE(r)||a.isEqual(gt.min())?De.resolve(null):this.gs.getDocuments(e,n).next(o=>{const l=this.bs(r,o);return this.Ds(r,l,n,a)?De.resolve(null):(Ic()<=Dt.DEBUG&&Ke("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),Nc(r)),this.vs(e,l,r,UI(a,Hf)).next(u=>u))})}bs(e,r){let n=new tn(ZS(e));return r.forEach((a,o)=>{hm(e,o)&&(n=n.add(o))}),n}Ds(e,r,n,a){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const o=e.limitType==="F"?r.last():r.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(a)>0)}ws(e,r,n){return Ic()<=Dt.DEBUG&&Ke("QueryEngine","Using full collection scan to execute query:",Nc(r)),this.gs.getDocumentsMatchingQuery(e,r,po.min(),n)}vs(e,r,n,a){return this.gs.getDocumentsMatchingQuery(e,n,a).next(o=>(r.forEach(l=>{o=o.insert(l.key,l)}),o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cx="LocalStore",gD=3e8;class xD{constructor(e,r,n,a){this.persistence=e,this.Cs=r,this.serializer=a,this.Fs=new Er(At),this.Ms=new Nl(o=>vx(o),_x),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(n)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new iD(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.Fs))}}function vD(t,e,r,n){return new xD(t,e,r,n)}async function EA(t,e){const r=xt(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let a;return r.mutationQueue.getAllMutationBatches(n).next(o=>(a=o,r.Ns(e),r.mutationQueue.getAllMutationBatches(n))).next(o=>{const l=[],u=[];let h=Ot();for(const d of a){l.push(d.batchId);for(const p of d.mutations)h=h.add(p.key)}for(const d of o){u.push(d.batchId);for(const p of d.mutations)h=h.add(p.key)}return r.localDocuments.getDocuments(n,h).next(d=>({Bs:d,removedBatchIds:l,addedBatchIds:u}))})})}function _D(t,e){const r=xt(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const a=e.batch.keys(),o=r.Os.newChangeBuffer({trackRemovals:!0});return function(u,h,d,p){const v=d.batch,_=v.keys();let E=De.resolve();return _.forEach(S=>{E=E.next(()=>p.getEntry(h,S)).next(y=>{const w=d.docVersions.get(S);Kt(w!==null,48541),y.version.compareTo(w)<0&&(v.applyToRemoteDocument(y,d),y.isValidDocument()&&(y.setReadTime(d.commitVersion),p.addEntry(y)))})}),E.next(()=>u.mutationQueue.removeMutationBatch(h,v))}(r,n,e,o).next(()=>o.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,a,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(u){let h=Ot();for(let d=0;d<u.mutationResults.length;++d)u.mutationResults[d].transformResults.length>0&&(h=h.add(u.batch.mutations[d].key));return h}(e))).next(()=>r.localDocuments.getDocuments(n,a))})}function TA(t){const e=xt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.hi.getLastRemoteSnapshotVersion(r))}function yD(t,e){const r=xt(t),n=e.snapshotVersion;let a=r.Fs;return r.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const l=r.Os.newChangeBuffer({trackRemovals:!0});a=r.Fs;const u=[];e.targetChanges.forEach((p,v)=>{const _=a.get(v);if(!_)return;u.push(r.hi.removeMatchingKeys(o,p.removedDocuments,v).next(()=>r.hi.addMatchingKeys(o,p.addedDocuments,v)));let E=_.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(v)!==null?E=E.withResumeToken(Tn.EMPTY_BYTE_STRING,gt.min()).withLastLimboFreeSnapshotVersion(gt.min()):p.resumeToken.approximateByteSize()>0&&(E=E.withResumeToken(p.resumeToken,n)),a=a.insert(v,E),function(y,w,P){return y.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-y.snapshotVersion.toMicroseconds()>=gD?!0:P.addedDocuments.size+P.modifiedDocuments.size+P.removedDocuments.size>0}(_,E,p)&&u.push(r.hi.updateTargetData(o,E))});let h=gs(),d=Ot();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&u.push(r.persistence.referenceDelegate.updateLimboDocument(o,p))}),u.push(ED(o,l,e.documentUpdates).next(p=>{h=p.Ls,d=p.ks})),!n.isEqual(gt.min())){const p=r.hi.getLastRemoteSnapshotVersion(o).next(v=>r.hi.setTargetsMetadata(o,o.currentSequenceNumber,n));u.push(p)}return De.waitFor(u).next(()=>l.apply(o)).next(()=>r.localDocuments.getLocalViewOfDocuments(o,h,d)).next(()=>h)}).then(o=>(r.Fs=a,o))}function ED(t,e,r){let n=Ot(),a=Ot();return r.forEach(o=>n=n.add(o)),e.getEntries(t,n).next(o=>{let l=gs();return r.forEach((u,h)=>{const d=o.get(u);h.isFoundDocument()!==d.isFoundDocument()&&(a=a.add(u)),h.isNoDocument()&&h.version.isEqual(gt.min())?(e.removeEntry(u,h.readTime),l=l.insert(u,h)):!d.isValidDocument()||h.version.compareTo(d.version)>0||h.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(h),l=l.insert(u,h)):Ke(Cx,"Ignoring outdated watch update for ",u,". Current version:",d.version," Watch version:",h.version)}),{Ls:l,ks:a}})}function TD(t,e){const r=xt(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=px),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function wD(t,e){const r=xt(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let a;return r.hi.getTargetData(n,e).next(o=>o?(a=o,De.resolve(a)):r.hi.allocateTargetId(n).next(l=>(a=new no(e,l,"TargetPurposeListen",n.currentSequenceNumber),r.hi.addTargetData(n,a).next(()=>a))))}).then(n=>{const a=r.Fs.get(n.targetId);return(a===null||n.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(r.Fs=r.Fs.insert(n.targetId,n),r.Ms.set(e,n.targetId)),n})}async function F1(t,e,r){const n=xt(t),a=n.Fs.get(e),o=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",o,l=>n.persistence.referenceDelegate.removeTarget(l,a))}catch(l){if(!au(l))throw l;Ke(Cx,`Failed to update sequence numbers for target ${e}: ${l}`)}n.Fs=n.Fs.remove(e),n.Ms.delete(a.target)}function sT(t,e,r){const n=xt(t);let a=gt.min(),o=Ot();return n.persistence.runTransaction("Execute query","readwrite",l=>function(h,d,p){const v=xt(h),_=v.Ms.get(p);return _!==void 0?De.resolve(v.Fs.get(_)):v.hi.getTargetData(d,p)}(n,l,Ii(e)).next(u=>{if(u)return a=u.lastLimboFreeSnapshotVersion,n.hi.getMatchingKeysForTargetId(l,u.targetId).next(h=>{o=h})}).next(()=>n.Cs.getDocumentsMatchingQuery(l,e,r?a:gt.min(),r?o:Ot())).next(u=>(SD(n,uN(e),u),{documents:u,qs:o})))}function SD(t,e,r){let n=t.xs.get(e)||gt.min();r.forEach((a,o)=>{o.readTime.compareTo(n)>0&&(n=o.readTime)}),t.xs.set(e,n)}class oT{constructor(){this.activeTargetIds=gN()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class AD{constructor(){this.Fo=new oT,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,r,n){this.Mo[e]=r}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new oT,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bD{xo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lT="ConnectivityMonitor";class cT{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){Ke(lT,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){Ke(lT,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Jh=null;function P1(){return Jh===null?Jh=function(){return 268435456+Math.round(2147483648*Math.random())}():Jh++,"0x"+Jh.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gg="RestConnection",kD={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class CD{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.$o=r+"://"+e.host,this.Uo=`projects/${n}/databases/${a}`,this.Ko=this.databaseId.database===Rd?`project_id=${n}`:`project_id=${n}&database_id=${a}`}Wo(e,r,n,a,o){const l=P1(),u=this.Go(e,r.toUriEncodedString());Ke(Gg,`Sending RPC '${e}' ${l}:`,u,n);const h={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(h,a,o);const{host:d}=new URL(u),p=Ao(d);return this.jo(e,u,h,n,p).then(v=>(Ke(Gg,`Received RPC '${e}' ${l}: `,v),v),v=>{throw mo(Gg,`RPC '${e}' ${l} failed with error: `,v,"url: ",u,"request:",n),v})}Jo(e,r,n,a,o,l){return this.Wo(e,r,n,a,o)}zo(e,r,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ru}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((a,o)=>e[o]=a),n&&n.headers.forEach((a,o)=>e[o]=a)}Go(e,r){const n=kD[e];return`${this.$o}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RD{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const An="WebChannelConnection";class ID extends CD{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,r,n,a,o){const l=P1();return new Promise((u,h)=>{const d=new wS;d.setWithCredentials(!0),d.listenOnce(SS.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case gd.NO_ERROR:const v=d.getResponseJson();Ke(An,`XHR for RPC '${e}' ${l} received:`,JSON.stringify(v)),u(v);break;case gd.TIMEOUT:Ke(An,`RPC '${e}' ${l} timed out`),h(new Ye(Re.DEADLINE_EXCEEDED,"Request time out"));break;case gd.HTTP_ERROR:const _=d.getStatus();if(Ke(An,`RPC '${e}' ${l} failed with status:`,_,"response text:",d.getResponseText()),_>0){let E=d.getResponseJson();Array.isArray(E)&&(E=E[0]);const S=E==null?void 0:E.error;if(S&&S.status&&S.message){const y=function(P){const B=P.toLowerCase().replace(/_/g,"-");return Object.values(Re).indexOf(B)>=0?B:Re.UNKNOWN}(S.status);h(new Ye(y,S.message))}else h(new Ye(Re.UNKNOWN,"Server responded with status "+d.getStatus()))}else h(new Ye(Re.UNAVAILABLE,"Connection failed."));break;default:ut(9055,{c_:e,streamId:l,l_:d.getLastErrorCode(),h_:d.getLastError()})}}finally{Ke(An,`RPC '${e}' ${l} completed.`)}});const p=JSON.stringify(a);Ke(An,`RPC '${e}' ${l} sending request:`,a),d.send(r,"POST",p,n,15)})}P_(e,r,n){const a=P1(),o=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],l=kS(),u=bS(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(h.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(h.useFetchStreams=!0),this.zo(h.initMessageHeaders,r,n),h.encodeInitMessageHeaders=!0;const p=o.join("");Ke(An,`Creating RPC '${e}' stream ${a}: ${p}`,h);const v=l.createWebChannel(p,h);this.T_(v);let _=!1,E=!1;const S=new RD({Ho:w=>{E?Ke(An,`Not sending because RPC '${e}' stream ${a} is closed:`,w):(_||(Ke(An,`Opening RPC '${e}' stream ${a} transport.`),v.open(),_=!0),Ke(An,`RPC '${e}' stream ${a} sending:`,w),v.send(w))},Yo:()=>v.close()}),y=(w,P,B)=>{w.listen(P,N=>{try{B(N)}catch(z){setTimeout(()=>{throw z},0)}})};return y(v,xf.EventType.OPEN,()=>{E||(Ke(An,`RPC '${e}' stream ${a} transport opened.`),S.s_())}),y(v,xf.EventType.CLOSE,()=>{E||(E=!0,Ke(An,`RPC '${e}' stream ${a} transport closed`),S.__(),this.I_(v))}),y(v,xf.EventType.ERROR,w=>{E||(E=!0,mo(An,`RPC '${e}' stream ${a} transport errored. Name:`,w.name,"Message:",w.message),S.__(new Ye(Re.UNAVAILABLE,"The operation could not be completed")))}),y(v,xf.EventType.MESSAGE,w=>{var P;if(!E){const B=w.data[0];Kt(!!B,16349);const N=B,z=(N==null?void 0:N.error)||((P=N[0])===null||P===void 0?void 0:P.error);if(z){Ke(An,`RPC '${e}' stream ${a} received error:`,z);const q=z.status;let Z=function(b){const O=zr[b];if(O!==void 0)return cA(O)}(q),C=z.message;Z===void 0&&(Z=Re.INTERNAL,C="Unknown error status: "+q+" with message "+z.message),E=!0,S.__(new Ye(Z,C)),v.close()}else Ke(An,`RPC '${e}' stream ${a} received:`,B),S.a_(B)}}),y(u,AS.STAT_EVENT,w=>{w.stat===T1.PROXY?Ke(An,`RPC '${e}' stream ${a} detected buffering proxy`):w.stat===T1.NOPROXY&&Ke(An,`RPC '${e}' stream ${a} detected no buffering proxy`)}),setTimeout(()=>{S.o_()},0),S}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(r=>r===e)}}function qg(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gm(t){return new FN(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wA{constructor(e,r,n=1e3,a=1.5,o=6e4){this.Fi=e,this.timerId=r,this.d_=n,this.E_=a,this.A_=o,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const r=Math.floor(this.R_+this.p_()),n=Math.max(0,Date.now()-this.m_),a=Math.max(0,r-n);a>0&&Ke("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.R_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,a,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uT="PersistentStream";class SA{constructor(e,r,n,a,o,l,u,h){this.Fi=e,this.w_=n,this.S_=a,this.connection=o,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=u,this.listener=h,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new wA(e,r)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():r&&r.code===Re.RESOURCE_EXHAUSTED?(ps(r.toString()),ps("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):r&&r.code===Re.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(r)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),r=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,a])=>{this.b_===r&&this.W_(n,a)},n=>{e(()=>{const a=new Ye(Re.UNKNOWN,"Fetching auth token failed: "+n.message);return this.G_(a)})})}W_(e,r){const n=this.K_(this.b_);this.stream=this.z_(e,r),this.stream.Zo(()=>{n(()=>this.listener.Zo())}),this.stream.e_(()=>{n(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(a=>{n(()=>this.G_(a))}),this.stream.onMessage(a=>{n(()=>++this.C_==1?this.j_(a):this.onNext(a))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(e){return Ke(uT,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return r=>{this.Fi.enqueueAndForget(()=>this.b_===e?r():(Ke(uT,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class ND extends SA{constructor(e,r,n,a,o,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,a,l),this.serializer=o}z_(e,r){return this.connection.P_("Listen",e,r)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const r=LN(this.serializer,e),n=function(o){if(!("targetChange"in o))return gt.min();const l=o.targetChange;return l.targetIds&&l.targetIds.length?gt.min():l.readTime?Ni(l.readTime):gt.min()}(e);return this.listener.J_(r,n)}H_(e){const r={};r.database=O1(this.serializer),r.addTarget=function(o,l){let u;const h=l.target;if(u=k1(h)?{documents:VN(o,h)}:{query:jN(o,h).Vt},u.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){u.resumeToken=hA(o,l.resumeToken);const d=I1(o,l.expectedCount);d!==null&&(u.expectedCount=d)}else if(l.snapshotVersion.compareTo(gt.min())>0){u.readTime=Pd(o,l.snapshotVersion.toTimestamp());const d=I1(o,l.expectedCount);d!==null&&(u.expectedCount=d)}return u}(this.serializer,e);const n=zN(this.serializer,e);n&&(r.labels=n),this.k_(r)}Y_(e){const r={};r.database=O1(this.serializer),r.removeTarget=e,this.k_(r)}}class DD extends SA{constructor(e,r,n,a,o,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,a,l),this.serializer=o}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,r){return this.connection.P_("Write",e,r)}j_(e){return Kt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Kt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){Kt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const r=BN(e.writeResults,e.commitTime),n=Ni(e.commitTime);return this.listener.ta(n,r)}na(){const e={};e.database=O1(this.serializer),this.k_(e)}X_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>UN(this.serializer,n))};this.k_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OD{}class FD extends OD{constructor(e,r,n,a){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=a,this.ra=!1}ia(){if(this.ra)throw new Ye(Re.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,r,n,a){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Wo(e,N1(r,n),a,o,l)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Ye(Re.UNKNOWN,o.toString())})}Jo(e,r,n,a,o){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([l,u])=>this.connection.Jo(e,N1(r,n),a,l,u,o)).catch(l=>{throw l.name==="FirebaseError"?(l.code===Re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new Ye(Re.UNKNOWN,l.toString())})}terminate(){this.ra=!0,this.connection.terminate()}}class PD{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(ps(r),this._a=!1):Ke("OnlineStateTracker",r)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yl="RemoteStore";class MD{constructor(e,r,n,a,o){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=o,this.Ea.xo(l=>{n.enqueueAndForget(async()=>{Dl(this)&&(Ke(yl,"Restarting streams for network reachability change."),await async function(h){const d=xt(h);d.Ia.add(4),await g0(d),d.Aa.set("Unknown"),d.Ia.delete(4),await xm(d)}(this))})}),this.Aa=new PD(n,a)}}async function xm(t){if(Dl(t))for(const e of t.da)await e(!0)}async function g0(t){for(const e of t.da)await e(!1)}function AA(t,e){const r=xt(t);r.Ta.has(e.targetId)||(r.Ta.set(e.targetId,e),Dx(r)?Nx(r):iu(r).x_()&&Ix(r,e))}function Rx(t,e){const r=xt(t),n=iu(r);r.Ta.delete(e),n.x_()&&bA(r,e),r.Ta.size===0&&(n.x_()?n.B_():Dl(r)&&r.Aa.set("Unknown"))}function Ix(t,e){if(t.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(gt.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}iu(t).H_(e)}function bA(t,e){t.Ra.$e(e),iu(t).Y_(e)}function Nx(t){t.Ra=new IN({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>t.Ta.get(e)||null,lt:()=>t.datastore.serializer.databaseId}),iu(t).start(),t.Aa.aa()}function Dx(t){return Dl(t)&&!iu(t).M_()&&t.Ta.size>0}function Dl(t){return xt(t).Ia.size===0}function kA(t){t.Ra=void 0}async function LD(t){t.Aa.set("Online")}async function UD(t){t.Ta.forEach((e,r)=>{Ix(t,e)})}async function BD(t,e){kA(t),Dx(t)?(t.Aa.la(e),Nx(t)):t.Aa.set("Unknown")}async function VD(t,e,r){if(t.Aa.set("Online"),e instanceof fA&&e.state===2&&e.cause)try{await async function(a,o){const l=o.cause;for(const u of o.targetIds)a.Ta.has(u)&&(await a.remoteSyncer.rejectListen(u,l),a.Ta.delete(u),a.Ra.removeTarget(u))}(t,e)}catch(n){Ke(yl,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Ld(t,n)}else if(e instanceof yd?t.Ra.Ye(e):e instanceof uA?t.Ra.it(e):t.Ra.et(e),!r.isEqual(gt.min()))try{const n=await TA(t.localStore);r.compareTo(n)>=0&&await function(o,l){const u=o.Ra.Pt(l);return u.targetChanges.forEach((h,d)=>{if(h.resumeToken.approximateByteSize()>0){const p=o.Ta.get(d);p&&o.Ta.set(d,p.withResumeToken(h.resumeToken,l))}}),u.targetMismatches.forEach((h,d)=>{const p=o.Ta.get(h);if(!p)return;o.Ta.set(h,p.withResumeToken(Tn.EMPTY_BYTE_STRING,p.snapshotVersion)),bA(o,h);const v=new no(p.target,h,d,p.sequenceNumber);Ix(o,v)}),o.remoteSyncer.applyRemoteEvent(u)}(t,r)}catch(n){Ke(yl,"Failed to raise snapshot:",n),await Ld(t,n)}}async function Ld(t,e,r){if(!au(e))throw e;t.Ia.add(1),await g0(t),t.Aa.set("Offline"),r||(r=()=>TA(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Ke(yl,"Retrying IndexedDB access"),await r(),t.Ia.delete(1),await xm(t)})}function CA(t,e){return e().catch(r=>Ld(t,r,e))}async function vm(t){const e=xt(t),r=_o(e);let n=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:px;for(;jD(e);)try{const a=await TD(e.localStore,n);if(a===null){e.Pa.length===0&&r.B_();break}n=a.batchId,HD(e,a)}catch(a){await Ld(e,a)}RA(e)&&IA(e)}function jD(t){return Dl(t)&&t.Pa.length<10}function HD(t,e){t.Pa.push(e);const r=_o(t);r.x_()&&r.Z_&&r.X_(e.mutations)}function RA(t){return Dl(t)&&!_o(t).M_()&&t.Pa.length>0}function IA(t){_o(t).start()}async function zD(t){_o(t).na()}async function GD(t){const e=_o(t);for(const r of t.Pa)e.X_(r.mutations)}async function qD(t,e,r){const n=t.Pa.shift(),a=Tx.from(n,e,r);await CA(t,()=>t.remoteSyncer.applySuccessfulWrite(a)),await vm(t)}async function WD(t,e){e&&_o(t).Z_&&await async function(n,a){if(function(l){return CN(l)&&l!==Re.ABORTED}(a.code)){const o=n.Pa.shift();_o(n).N_(),await CA(n,()=>n.remoteSyncer.rejectFailedWrite(o.batchId,a)),await vm(n)}}(t,e),RA(t)&&IA(t)}async function fT(t,e){const r=xt(t);r.asyncQueue.verifyOperationInProgress(),Ke(yl,"RemoteStore received new credentials");const n=Dl(r);r.Ia.add(3),await g0(r),n&&r.Aa.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ia.delete(3),await xm(r)}async function XD(t,e){const r=xt(t);e?(r.Ia.delete(2),await xm(r)):e||(r.Ia.add(2),await g0(r),r.Aa.set("Unknown"))}function iu(t){return t.Va||(t.Va=function(r,n,a){const o=xt(r);return o.ia(),new ND(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,a)}(t.datastore,t.asyncQueue,{Zo:LD.bind(null,t),e_:UD.bind(null,t),n_:BD.bind(null,t),J_:VD.bind(null,t)}),t.da.push(async e=>{e?(t.Va.N_(),Dx(t)?Nx(t):t.Aa.set("Unknown")):(await t.Va.stop(),kA(t))})),t.Va}function _o(t){return t.ma||(t.ma=function(r,n,a){const o=xt(r);return o.ia(),new DD(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,a)}(t.datastore,t.asyncQueue,{Zo:()=>Promise.resolve(),e_:zD.bind(null,t),n_:WD.bind(null,t),ea:GD.bind(null,t),ta:qD.bind(null,t)}),t.da.push(async e=>{e?(t.ma.N_(),await vm(t)):(await t.ma.stop(),t.Pa.length>0&&(Ke(yl,`Stopping write stream with ${t.Pa.length} pending writes`),t.Pa=[]))})),t.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ox{constructor(e,r,n,a,o){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=a,this.removalCallback=o,this.deferred=new uo,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(l=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,a,o){const l=Date.now()+n,u=new Ox(e,r,l,a,o);return u.start(n),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ye(Re.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Fx(t,e){if(ps("AsyncQueue",`${e}: ${t}`),au(t))return new Ye(Re.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lc{static emptySet(e){return new Lc(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||et.comparator(r.key,n.key):(r,n)=>et.comparator(r.key,n.key),this.keyedMap=vf(),this.sortedSet=new Er(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof Lc)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const a=r.getNext().key,o=n.getNext().key;if(!a.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new Lc;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hT{constructor(){this.fa=new Er(et.comparator)}track(e){const r=e.doc.key,n=this.fa.get(r);n?e.type!==0&&n.type===3?this.fa=this.fa.insert(r,e):e.type===3&&n.type!==1?this.fa=this.fa.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.fa=this.fa.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.fa=this.fa.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.fa=this.fa.remove(r):e.type===1&&n.type===2?this.fa=this.fa.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.fa=this.fa.insert(r,{type:2,doc:e.doc}):ut(63341,{At:e,ga:n}):this.fa=this.fa.insert(r,e)}pa(){const e=[];return this.fa.inorderTraversal((r,n)=>{e.push(n)}),e}}class Zc{constructor(e,r,n,a,o,l,u,h,d){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=a,this.mutatedKeys=o,this.fromCache=l,this.syncStateChanged=u,this.excludesMetadataChanges=h,this.hasCachedResults=d}static fromInitialDocuments(e,r,n,a,o){const l=[];return r.forEach(u=>{l.push({type:0,doc:u})}),new Zc(e,r,Lc.emptySet(r),l,n,a,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&fm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let a=0;a<r.length;a++)if(r[a].type!==n[a].type||!r[a].doc.isEqual(n[a].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KD{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(e=>e.ba())}}class YD{constructor(){this.queries=dT(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(r,n){const a=xt(r),o=a.queries;a.queries=dT(),o.forEach((l,u)=>{for(const h of u.wa)h.onError(n)})})(this,new Ye(Re.ABORTED,"Firestore shutting down"))}}function dT(){return new Nl(t=>QS(t),fm)}async function $D(t,e){const r=xt(t);let n=3;const a=e.query;let o=r.queries.get(a);o?!o.Sa()&&e.ba()&&(n=2):(o=new KD,n=e.ba()?0:1);try{switch(n){case 0:o.ya=await r.onListen(a,!0);break;case 1:o.ya=await r.onListen(a,!1);break;case 2:await r.onFirstRemoteStoreListen(a)}}catch(l){const u=Fx(l,`Initialization of query '${Nc(e.query)}' failed`);return void e.onError(u)}r.queries.set(a,o),o.wa.push(e),e.va(r.onlineState),o.ya&&e.Ca(o.ya)&&Px(r)}async function QD(t,e){const r=xt(t),n=e.query;let a=3;const o=r.queries.get(n);if(o){const l=o.wa.indexOf(e);l>=0&&(o.wa.splice(l,1),o.wa.length===0?a=e.ba()?0:1:!o.Sa()&&e.ba()&&(a=2))}switch(a){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function ZD(t,e){const r=xt(t);let n=!1;for(const a of e){const o=a.query,l=r.queries.get(o);if(l){for(const u of l.wa)u.Ca(a)&&(n=!0);l.ya=a}}n&&Px(r)}function JD(t,e,r){const n=xt(t),a=n.queries.get(e);if(a)for(const o of a.wa)o.onError(r);n.queries.delete(e)}function Px(t){t.Da.forEach(e=>{e.next()})}var M1,mT;(mT=M1||(M1={})).Fa="default",mT.Cache="cache";class e6{constructor(e,r,n){this.query=e,this.Ma=r,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=n||{}}Ca(e){if(!this.options.includeMetadataChanges){const n=[];for(const a of e.docChanges)a.type!==3&&n.push(a);e=new Zc(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),r=!0):this.Ba(e,this.onlineState)&&(this.La(e),r=!0),this.Oa=e,r}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let r=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),r=!0),r}Ba(e,r){if(!e.fromCache||!this.ba())return!0;const n=r!=="Offline";return(!this.options.ka||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Na(e){if(e.docChanges.length>0)return!0;const r=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}La(e){e=Zc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==M1.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NA{constructor(e){this.key=e}}class DA{constructor(e){this.key=e}}class t6{constructor(e,r){this.query=e,this.Ha=r,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=Ot(),this.mutatedKeys=Ot(),this.Xa=ZS(e),this.eu=new Lc(this.Xa)}get tu(){return this.Ha}nu(e,r){const n=r?r.ru:new hT,a=r?r.eu:this.eu;let o=r?r.mutatedKeys:this.mutatedKeys,l=a,u=!1;const h=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,d=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal((p,v)=>{const _=a.get(p),E=hm(this.query,v)?v:null,S=!!_&&this.mutatedKeys.has(_.key),y=!!E&&(E.hasLocalMutations||this.mutatedKeys.has(E.key)&&E.hasCommittedMutations);let w=!1;_&&E?_.data.isEqual(E.data)?S!==y&&(n.track({type:3,doc:E}),w=!0):this.iu(_,E)||(n.track({type:2,doc:E}),w=!0,(h&&this.Xa(E,h)>0||d&&this.Xa(E,d)<0)&&(u=!0)):!_&&E?(n.track({type:0,doc:E}),w=!0):_&&!E&&(n.track({type:1,doc:_}),w=!0,(h||d)&&(u=!0)),w&&(E?(l=l.add(E),o=y?o.add(p):o.delete(p)):(l=l.delete(p),o=o.delete(p)))}),this.query.limit!==null)for(;l.size>this.query.limit;){const p=this.query.limitType==="F"?l.last():l.first();l=l.delete(p.key),o=o.delete(p.key),n.track({type:1,doc:p})}return{eu:l,ru:n,Ds:u,mutatedKeys:o}}iu(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,a){const o=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const l=e.ru.pa();l.sort((p,v)=>function(E,S){const y=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ut(20277,{At:w})}};return y(E)-y(S)}(p.type,v.type)||this.Xa(p.doc,v.doc)),this.su(n),a=a!=null&&a;const u=r&&!a?this.ou():[],h=this.Za.size===0&&this.current&&!a?1:0,d=h!==this.Ya;return this.Ya=h,l.length!==0||d?{snapshot:new Zc(this.query,e.eu,o,l,e.mutatedKeys,h===0,d,!1,!!n&&n.resumeToken.approximateByteSize()>0),_u:u}:{_u:u}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new hT,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach(r=>this.Ha=this.Ha.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ha=this.Ha.delete(r)),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=Ot(),this.eu.forEach(n=>{this.au(n.key)&&(this.Za=this.Za.add(n.key))});const r=[];return e.forEach(n=>{this.Za.has(n)||r.push(new DA(n))}),this.Za.forEach(n=>{e.has(n)||r.push(new NA(n))}),r}uu(e){this.Ha=e.qs,this.Za=Ot();const r=this.nu(e.documents);return this.applyChanges(r,!0)}cu(){return Zc.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const Mx="SyncEngine";class r6{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class n6{constructor(e){this.key=e,this.lu=!1}}class a6{constructor(e,r,n,a,o,l){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=a,this.currentUser=o,this.maxConcurrentLimboResolutions=l,this.hu={},this.Pu=new Nl(u=>QS(u),fm),this.Tu=new Map,this.Iu=new Set,this.du=new Er(et.comparator),this.Eu=new Map,this.Au=new Ax,this.Ru={},this.Vu=new Map,this.mu=Qc.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function i6(t,e,r=!0){const n=UA(t);let a;const o=n.Pu.get(e);return o?(n.sharedClientState.addLocalQueryTarget(o.targetId),a=o.view.cu()):a=await OA(n,e,r,!0),a}async function s6(t,e){const r=UA(t);await OA(r,e,!0,!1)}async function OA(t,e,r,n){const a=await wD(t.localStore,Ii(e)),o=a.targetId,l=t.sharedClientState.addLocalQueryTarget(o,r);let u;return n&&(u=await o6(t,e,o,l==="current",a.resumeToken)),t.isPrimaryClient&&r&&AA(t.remoteStore,a),u}async function o6(t,e,r,n,a){t.gu=(v,_,E)=>async function(y,w,P,B){let N=w.view.nu(P);N.Ds&&(N=await sT(y.localStore,w.query,!1).then(({documents:C})=>w.view.nu(C,N)));const z=B&&B.targetChanges.get(w.targetId),q=B&&B.targetMismatches.get(w.targetId)!=null,Z=w.view.applyChanges(N,y.isPrimaryClient,z,q);return gT(y,w.targetId,Z._u),Z.snapshot}(t,v,_,E);const o=await sT(t.localStore,e,!0),l=new t6(e,o.qs),u=l.nu(o.documents),h=p0.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",a),d=l.applyChanges(u,t.isPrimaryClient,h);gT(t,r,d._u);const p=new r6(e,r,l);return t.Pu.set(e,p),t.Tu.has(r)?t.Tu.get(r).push(e):t.Tu.set(r,[e]),d.snapshot}async function l6(t,e,r){const n=xt(t),a=n.Pu.get(e),o=n.Tu.get(a.targetId);if(o.length>1)return n.Tu.set(a.targetId,o.filter(l=>!fm(l,e))),void n.Pu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(a.targetId),n.sharedClientState.isActiveQueryTarget(a.targetId)||await F1(n.localStore,a.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(a.targetId),r&&Rx(n.remoteStore,a.targetId),L1(n,a.targetId)}).catch(nu)):(L1(n,a.targetId),await F1(n.localStore,a.targetId,!0))}async function c6(t,e){const r=xt(t),n=r.Pu.get(e),a=r.Tu.get(n.targetId);r.isPrimaryClient&&a.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Rx(r.remoteStore,n.targetId))}async function u6(t,e,r){const n=x6(t);try{const a=await function(l,u){const h=xt(l),d=dr.now(),p=u.reduce((E,S)=>E.add(S.key),Ot());let v,_;return h.persistence.runTransaction("Locally write mutations","readwrite",E=>{let S=gs(),y=Ot();return h.Os.getEntries(E,p).next(w=>{S=w,S.forEach((P,B)=>{B.isValidDocument()||(y=y.add(P))})}).next(()=>h.localDocuments.getOverlayedDocuments(E,S)).next(w=>{v=w;const P=[];for(const B of u){const N=wN(B,v.get(B.key).overlayedDocument);N!=null&&P.push(new ko(B.key,N,HS(N.value.mapValue),ei.exists(!0)))}return h.mutationQueue.addMutationBatch(E,d,P,u)}).next(w=>{_=w;const P=w.applyToLocalDocumentSet(v,y);return h.documentOverlayCache.saveOverlays(E,w.batchId,P)})}).then(()=>({batchId:_.batchId,changes:eA(v)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(a.batchId),function(l,u,h){let d=l.Ru[l.currentUser.toKey()];d||(d=new Er(At)),d=d.insert(u,h),l.Ru[l.currentUser.toKey()]=d}(n,a.batchId,r),await x0(n,a.changes),await vm(n.remoteStore)}catch(a){const o=Fx(a,"Failed to persist write");r.reject(o)}}async function FA(t,e){const r=xt(t);try{const n=await yD(r.localStore,e);e.targetChanges.forEach((a,o)=>{const l=r.Eu.get(o);l&&(Kt(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?l.lu=!0:a.modifiedDocuments.size>0?Kt(l.lu,14607):a.removedDocuments.size>0&&(Kt(l.lu,42227),l.lu=!1))}),await x0(r,n,e)}catch(n){await nu(n)}}function pT(t,e,r){const n=xt(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const a=[];n.Pu.forEach((o,l)=>{const u=l.view.va(e);u.snapshot&&a.push(u.snapshot)}),function(l,u){const h=xt(l);h.onlineState=u;let d=!1;h.queries.forEach((p,v)=>{for(const _ of v.wa)_.va(u)&&(d=!0)}),d&&Px(h)}(n.eventManager,e),a.length&&n.hu.J_(a),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function f6(t,e,r){const n=xt(t);n.sharedClientState.updateQueryState(e,"rejected",r);const a=n.Eu.get(e),o=a&&a.key;if(o){let l=new Er(et.comparator);l=l.insert(o,In.newNoDocument(o,gt.min()));const u=Ot().add(o),h=new pm(gt.min(),new Map,new Er(At),l,u);await FA(n,h),n.du=n.du.remove(o),n.Eu.delete(e),Lx(n)}else await F1(n.localStore,e,!1).then(()=>L1(n,e,r)).catch(nu)}async function h6(t,e){const r=xt(t),n=e.batch.batchId;try{const a=await _D(r.localStore,e);MA(r,n,null),PA(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await x0(r,a)}catch(a){await nu(a)}}async function d6(t,e,r){const n=xt(t);try{const a=await function(l,u){const h=xt(l);return h.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let p;return h.mutationQueue.lookupMutationBatch(d,u).next(v=>(Kt(v!==null,37113),p=v.keys(),h.mutationQueue.removeMutationBatch(d,v))).next(()=>h.mutationQueue.performConsistencyCheck(d)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(d,p,u)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,p)).next(()=>h.localDocuments.getDocuments(d,p))})}(n.localStore,e);MA(n,e,r),PA(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await x0(n,a)}catch(a){await nu(a)}}function PA(t,e){(t.Vu.get(e)||[]).forEach(r=>{r.resolve()}),t.Vu.delete(e)}function MA(t,e,r){const n=xt(t);let a=n.Ru[n.currentUser.toKey()];if(a){const o=a.get(e);o&&(r?o.reject(r):o.resolve(),a=a.remove(e)),n.Ru[n.currentUser.toKey()]=a}}function L1(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Tu.get(e))t.Pu.delete(n),r&&t.hu.pu(n,r);t.Tu.delete(e),t.isPrimaryClient&&t.Au.zr(e).forEach(n=>{t.Au.containsKey(n)||LA(t,n)})}function LA(t,e){t.Iu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(Rx(t.remoteStore,r),t.du=t.du.remove(e),t.Eu.delete(r),Lx(t))}function gT(t,e,r){for(const n of r)n instanceof NA?(t.Au.addReference(n.key,e),m6(t,n)):n instanceof DA?(Ke(Mx,"Document no longer in limbo: "+n.key),t.Au.removeReference(n.key,e),t.Au.containsKey(n.key)||LA(t,n.key)):ut(19791,{yu:n})}function m6(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Iu.has(n)||(Ke(Mx,"New document in limbo: "+r),t.Iu.add(n),Lx(t))}function Lx(t){for(;t.Iu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Iu.values().next().value;t.Iu.delete(e);const r=new et(ur.fromString(e)),n=t.mu.next();t.Eu.set(n,new n6(r)),t.du=t.du.insert(r,n),AA(t.remoteStore,new no(Ii(YS(r.path)),n,"TargetPurposeLimboResolution",lm.ue))}}async function x0(t,e,r){const n=xt(t),a=[],o=[],l=[];n.Pu.isEmpty()||(n.Pu.forEach((u,h)=>{l.push(n.gu(h,e,r).then(d=>{var p;if((d||r)&&n.isPrimaryClient){const v=d?!d.fromCache:(p=r==null?void 0:r.targetChanges.get(h.targetId))===null||p===void 0?void 0:p.current;n.sharedClientState.updateQueryState(h.targetId,v?"current":"not-current")}if(d){a.push(d);const v=kx.Es(h.targetId,d);o.push(v)}}))}),await Promise.all(l),n.hu.J_(a),await async function(h,d){const p=xt(h);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",v=>De.forEach(d,_=>De.forEach(_.Is,E=>p.persistence.referenceDelegate.addReference(v,_.targetId,E)).next(()=>De.forEach(_.ds,E=>p.persistence.referenceDelegate.removeReference(v,_.targetId,E)))))}catch(v){if(!au(v))throw v;Ke(Cx,"Failed to update sequence numbers: "+v)}for(const v of d){const _=v.targetId;if(!v.fromCache){const E=p.Fs.get(_),S=E.snapshotVersion,y=E.withLastLimboFreeSnapshotVersion(S);p.Fs=p.Fs.insert(_,y)}}}(n.localStore,o))}async function p6(t,e){const r=xt(t);if(!r.currentUser.isEqual(e)){Ke(Mx,"User change. New user:",e.toKey());const n=await EA(r.localStore,e);r.currentUser=e,function(o,l){o.Vu.forEach(u=>{u.forEach(h=>{h.reject(new Ye(Re.CANCELLED,l))})}),o.Vu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await x0(r,n.Bs)}}function g6(t,e){const r=xt(t),n=r.Eu.get(e);if(n&&n.lu)return Ot().add(n.key);{let a=Ot();const o=r.Tu.get(e);if(!o)return a;for(const l of o){const u=r.Pu.get(l);a=a.unionWith(u.view.tu)}return a}}function UA(t){const e=xt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=FA.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=g6.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=f6.bind(null,e),e.hu.J_=ZD.bind(null,e.eventManager),e.hu.pu=JD.bind(null,e.eventManager),e}function x6(t){const e=xt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=h6.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=d6.bind(null,e),e}class Ud{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=gm(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,r){return null}Fu(e,r){return null}vu(e){return vD(this.persistence,new pD,e.initialUser,this.serializer)}Du(e){return new yA(bx.Vi,this.serializer)}bu(e){return new AD}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ud.provider={build:()=>new Ud};class v6 extends Ud{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,r){Kt(this.persistence.referenceDelegate instanceof Md,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new eD(n,e.asyncQueue,r)}Du(e){const r=this.cacheSizeBytes!==void 0?ta.withCacheSize(this.cacheSizeBytes):ta.DEFAULT;return new yA(n=>Md.Vi(n,r),this.serializer)}}class U1{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>pT(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=p6.bind(null,this.syncEngine),await XD(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new YD}()}createDatastore(e){const r=gm(e.databaseInfo.databaseId),n=function(o){return new ID(o)}(e.databaseInfo);return function(o,l,u,h){return new FD(o,l,u,h)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,a,o,l,u){return new MD(n,a,o,l,u)}(this.localStore,this.datastore,e.asyncQueue,r=>pT(this.syncEngine,r,0),function(){return cT.C()?new cT:new bD}())}createSyncEngine(e,r){return function(a,o,l,u,h,d,p){const v=new a6(a,o,l,u,h,d);return p&&(v.fu=!0),v}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(a){const o=xt(a);Ke(yl,"RemoteStore shutting down."),o.Ia.add(5),await g0(o),o.Ea.shutdown(),o.Aa.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}U1.provider={build:()=>new U1};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _6{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):ps("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yo="FirestoreClient";class y6{constructor(e,r,n,a,o){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=a,this.user=kn.UNAUTHENTICATED,this.clientId=mx.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(n,async l=>{Ke(yo,"Received user=",l.uid),await this.authCredentialListener(l),this.user=l}),this.appCheckCredentials.start(n,l=>(Ke(yo,"Received new app check token=",l),this.appCheckCredentialListener(l,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new uo;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=Fx(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Wg(t,e){t.asyncQueue.verifyOperationInProgress(),Ke(yo,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async a=>{n.isEqual(a)||(await EA(e.localStore,a),n=a)}),e.persistence.setDatabaseDeletedListener(()=>{mo("Terminating Firestore due to IndexedDb database deletion"),t.terminate().then(()=>{Ke("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(a=>{mo("Terminating Firestore due to IndexedDb database deletion failed",a)})}),t._offlineComponents=e}async function xT(t,e){t.asyncQueue.verifyOperationInProgress();const r=await E6(t);Ke(yo,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>fT(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,a)=>fT(e.remoteStore,a)),t._onlineComponents=e}async function E6(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ke(yo,"Using user provided OfflineComponentProvider");try{await Wg(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(a){return a.name==="FirebaseError"?a.code===Re.FAILED_PRECONDITION||a.code===Re.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11}(r))throw r;mo("Error using user provided cache. Falling back to memory cache: "+r),await Wg(t,new Ud)}}else Ke(yo,"Using default OfflineComponentProvider"),await Wg(t,new v6(void 0));return t._offlineComponents}async function BA(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ke(yo,"Using user provided OnlineComponentProvider"),await xT(t,t._uninitializedComponentsProvider._online)):(Ke(yo,"Using default OnlineComponentProvider"),await xT(t,new U1))),t._onlineComponents}function T6(t){return BA(t).then(e=>e.syncEngine)}async function w6(t){const e=await BA(t),r=e.eventManager;return r.onListen=i6.bind(null,e.syncEngine),r.onUnlisten=l6.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=s6.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=c6.bind(null,e.syncEngine),r}function S6(t,e,r={}){const n=new uo;return t.asyncQueue.enqueueAndForget(async()=>function(o,l,u,h,d){const p=new _6({next:_=>{p.Ou(),l.enqueueAndForget(()=>QD(o,v)),_.fromCache&&h.source==="server"?d.reject(new Ye(Re.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(_)},error:_=>d.reject(_)}),v=new e6(u,p,{includeMetadataChanges:!0,ka:!0});return $D(o,v)}(await w6(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VA(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vT=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jA="firestore.googleapis.com",_T=!0;class yT{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new Ye(Re.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=jA,this.ssl=_T}else this.host=e.host,this.ssl=(r=e.ssl)!==null&&r!==void 0?r:_T;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=_A;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<ZN)throw new Ye(Re.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}LI("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=VA((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new Ye(Re.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new Ye(Re.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new Ye(Re.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,a){return n.timeoutSeconds===a.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class _m{constructor(e,r,n,a){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new yT({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ye(Re.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ye(Re.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new yT(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new CI;switch(n.type){case"firstParty":return new DI(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Ye(Re.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=vT.get(r);n&&(Ke("ComponentProvider","Removing Datastore"),vT.delete(r),n.terminate())}(this),Promise.resolve()}}function A6(t,e,r,n={}){var a;t=_l(t,_m);const o=Ao(e),l=t._getSettings(),u=Object.assign(Object.assign({},l),{emulatorOptions:t._getEmulatorOptions()}),h=`${e}:${r}`;o&&(ox(`https://${h}`),lx("Firestore",!0)),l.host!==jA&&l.host!==h&&mo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const d=Object.assign(Object.assign({},l),{host:h,ssl:o,emulatorOptions:n});if(!gl(d,u)&&(t._setSettings(d),n.mockUserToken)){let p,v;if(typeof n.mockUserToken=="string")p=n.mockUserToken,v=kn.MOCK_USER;else{p=xS(n.mockUserToken,(a=t._app)===null||a===void 0?void 0:a.options.projectId);const _=n.mockUserToken.sub||n.mockUserToken.user_id;if(!_)throw new Ye(Re.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");v=new kn(_)}t._authCredentials=new RI(new RS(p,v))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class su{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new su(this.firestore,e,this._query)}}class en{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new fo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new en(this.firestore,e,this._key)}toJSON(){return{type:en._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(h0(r,en._jsonSchema))return new en(e,n||null,new et(ur.fromString(r.referencePath)))}}en._jsonSchemaVersion="firestore/documentReference/1.0",en._jsonSchema={type:Xr("string",en._jsonSchemaVersion),referencePath:Xr("string")};class fo extends su{constructor(e,r,n){super(e,r,YS(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new en(this.firestore,null,new et(e))}withConverter(e){return new fo(this.firestore,e,this._path)}}function ou(t,e,...r){if(t=br(t),NS("collection","path",e),t instanceof _m){const n=ur.fromString(e,...r);return OE(n),new fo(t,null,n)}{if(!(t instanceof en||t instanceof fo))throw new Ye(Re.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(ur.fromString(e,...r));return OE(n),new fo(t.firestore,null,n)}}function bi(t,e,...r){if(t=br(t),arguments.length===1&&(e=mx.newId()),NS("doc","path",e),t instanceof _m){const n=ur.fromString(e,...r);return DE(n),new en(t,null,new et(n))}{if(!(t instanceof en||t instanceof fo))throw new Ye(Re.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(ur.fromString(e,...r));return DE(n),new en(t.firestore,t instanceof fo?t.converter:null,new et(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ET="AsyncQueue";class TT{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new wA(this,"async_queue_retry"),this.oc=()=>{const n=qg();n&&Ke(ET,"Visibility state changed to "+n.visibilityState),this.F_.y_()},this._c=e;const r=qg();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const r=qg();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});const r=new uo;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!au(e))throw e;Ke(ET,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(e){const r=this._c.then(()=>(this.nc=!0,e().catch(n=>{throw this.tc=n,this.nc=!1,ps("INTERNAL UNHANDLED ERROR: ",wT(n)),n}).then(n=>(this.nc=!1,n))));return this._c=r,r}enqueueAfterDelay(e,r,n){this.ac(),this.sc.indexOf(e)>-1&&(r=0);const a=Ox.createAndSchedule(this,e,r,n,o=>this.lc(o));return this.ec.push(a),a}ac(){this.tc&&ut(47125,{hc:wT(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(const r of this.ec)if(r.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{this.ec.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.ec)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){const r=this.ec.indexOf(e);this.ec.splice(r,1)}}function wT(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class v0 extends _m{constructor(e,r,n,a){super(e,r,n,a),this.type="firestore",this._queue=new TT,this._persistenceKey=(a==null?void 0:a.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new TT(e),this._firestoreClient=void 0,await e}}}function b6(t,e){const r=typeof t=="object"?t:hx(),n=typeof t=="string"?t:Rd,a=sm(r,"firestore").getImmediate({identifier:n});if(!a._initialized){const o=mS("firestore");o&&A6(a,...o)}return a}function HA(t){if(t._terminated)throw new Ye(Re.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||k6(t),t._firestoreClient}function k6(t){var e,r,n;const a=t._freezeSettings(),o=function(u,h,d,p){return new KI(u,h,d,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,VA(p.experimentalLongPollingOptions),p.useFetchStreams,p.isUsingEmulator)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,a);t._componentsProvider||!((r=a.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=a.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:a.localCache._offlineComponentProvider,_online:a.localCache._onlineComponentProvider}),t._firestoreClient=new y6(t._authCredentials,t._appCheckCredentials,t._queue,o,t._componentsProvider&&function(u){const h=u==null?void 0:u._online.build();return{_offline:u==null?void 0:u._offline.build(h),_online:h}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ja{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ja(Tn.fromBase64String(e))}catch(r){throw new Ye(Re.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new ja(Tn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ja._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(h0(e,ja._jsonSchema))return ja.fromBase64String(e.bytes)}}ja._jsonSchemaVersion="firestore/bytes/1.0",ja._jsonSchema={type:Xr("string",ja._jsonSchemaVersion),bytes:Xr("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ym{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Ye(Re.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new yn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ux{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Di{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Ye(Re.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Ye(Re.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return At(this._lat,e._lat)||At(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Di._jsonSchemaVersion}}static fromJSON(e){if(h0(e,Di._jsonSchema))return new Di(e.latitude,e.longitude)}}Di._jsonSchemaVersion="firestore/geoPoint/1.0",Di._jsonSchema={type:Xr("string",Di._jsonSchemaVersion),latitude:Xr("number"),longitude:Xr("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oi{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,a){if(n.length!==a.length)return!1;for(let o=0;o<n.length;++o)if(n[o]!==a[o])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Oi._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(h0(e,Oi._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(r=>typeof r=="number"))return new Oi(e.vectorValues);throw new Ye(Re.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Oi._jsonSchemaVersion="firestore/vectorValue/1.0",Oi._jsonSchema={type:Xr("string",Oi._jsonSchemaVersion),vectorValues:Xr("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C6=/^__.*__$/;class R6{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new ko(e,this.data,this.fieldMask,r,this.fieldTransforms):new m0(e,this.data,r,this.fieldTransforms)}}class zA{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new ko(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function GA(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ut(40011,{Ec:t})}}class Bx{constructor(e,r,n,a,o,l){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=a,o===void 0&&this.Ac(),this.fieldTransforms=o||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new Bx(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),a=this.Rc({path:n,mc:!1});return a.fc(e),a}gc(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),a=this.Rc({path:n,mc:!1});return a.Ac(),a}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return Bd(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(GA(this.Ec)&&C6.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class I6{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||gm(e)}Dc(e,r,n,a=!1){return new Bx({Ec:e,methodName:r,bc:n,path:yn.emptyPath(),mc:!1,Sc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Vx(t){const e=t._freezeSettings(),r=gm(t._databaseId);return new I6(t._databaseId,!!e.ignoreUndefinedProperties,r)}function N6(t,e,r,n,a,o={}){const l=t.Dc(o.merge||o.mergeFields?2:0,e,r,a);jx("Data must be an object, but it was:",l,n);const u=qA(n,l);let h,d;if(o.merge)h=new _a(l.fieldMask),d=l.fieldTransforms;else if(o.mergeFields){const p=[];for(const v of o.mergeFields){const _=B1(e,v,r);if(!l.contains(_))throw new Ye(Re.INVALID_ARGUMENT,`Field '${_}' is specified in your field mask but missing from your input data.`);XA(p,_)||p.push(_)}h=new _a(p),d=l.fieldTransforms.filter(v=>h.covers(v.field))}else h=null,d=l.fieldTransforms;return new R6(new ra(u),h,d)}class Em extends Ux{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Em}}function D6(t,e,r,n){const a=t.Dc(1,e,r);jx("Data must be an object, but it was:",a,n);const o=[],l=ra.empty();bo(n,(h,d)=>{const p=Hx(e,h,r);d=br(d);const v=a.gc(p);if(d instanceof Em)o.push(p);else{const _=_0(d,v);_!=null&&(o.push(p),l.set(p,_))}});const u=new _a(o);return new zA(l,u,a.fieldTransforms)}function O6(t,e,r,n,a,o){const l=t.Dc(1,e,r),u=[B1(e,n,r)],h=[a];if(o.length%2!=0)throw new Ye(Re.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let _=0;_<o.length;_+=2)u.push(B1(e,o[_])),h.push(o[_+1]);const d=[],p=ra.empty();for(let _=u.length-1;_>=0;--_)if(!XA(d,u[_])){const E=u[_];let S=h[_];S=br(S);const y=l.gc(E);if(S instanceof Em)d.push(E);else{const w=_0(S,y);w!=null&&(d.push(E),p.set(E,w))}}const v=new _a(d);return new zA(p,v,l.fieldTransforms)}function F6(t,e,r,n=!1){return _0(r,t.Dc(n?4:3,e))}function _0(t,e){if(WA(t=br(t)))return jx("Unsupported field value:",e,t),qA(t,e);if(t instanceof Ux)return function(n,a){if(!GA(a.Ec))throw a.wc(`${n._methodName}() can only be used with update() and set()`);if(!a.path)throw a.wc(`${n._methodName}() is not currently supported inside arrays`);const o=n._toFieldTransform(a);o&&a.fieldTransforms.push(o)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return function(n,a){const o=[];let l=0;for(const u of n){let h=_0(u,a.yc(l));h==null&&(h={nullValue:"NULL_VALUE"}),o.push(h),l++}return{arrayValue:{values:o}}}(t,e)}return function(n,a){if((n=br(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return xN(a.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const o=dr.fromDate(n);return{timestampValue:Pd(a.serializer,o)}}if(n instanceof dr){const o=new dr(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Pd(a.serializer,o)}}if(n instanceof Di)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof ja)return{bytesValue:hA(a.serializer,n._byteString)};if(n instanceof en){const o=a.databaseId,l=n.firestore._databaseId;if(!l.isEqual(o))throw a.wc(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:Sx(n.firestore._databaseId||a.databaseId,n._key.path)}}if(n instanceof Oi)return function(l,u){return{mapValue:{fields:{[VS]:{stringValue:jS},[Id]:{arrayValue:{values:l.toArray().map(d=>{if(typeof d!="number")throw u.wc("VectorValues must only contain numeric values.");return yx(u.serializer,d)})}}}}}}(n,a);throw a.wc(`Unsupported field value: ${om(n)}`)}(t,e)}function qA(t,e){const r={};return FS(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):bo(t,(n,a)=>{const o=_0(a,e.Vc(n));o!=null&&(r[n]=o)}),{mapValue:{fields:r}}}function WA(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof dr||t instanceof Di||t instanceof ja||t instanceof en||t instanceof Ux||t instanceof Oi)}function jx(t,e,r){if(!WA(r)||!DS(r)){const n=om(r);throw n==="an object"?e.wc(t+" a custom object"):e.wc(t+" "+n)}}function B1(t,e,r){if((e=br(e))instanceof ym)return e._internalPath;if(typeof e=="string")return Hx(t,e);throw Bd("Field path arguments must be of type string or ",t,!1,void 0,r)}const P6=new RegExp("[~\\*/\\[\\]]");function Hx(t,e,r){if(e.search(P6)>=0)throw Bd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new ym(...e.split("."))._internalPath}catch{throw Bd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Bd(t,e,r,n,a){const o=n&&!n.isEmpty(),l=a!==void 0;let u=`Function ${e}() called with invalid data`;r&&(u+=" (via `toFirestore()`)"),u+=". ";let h="";return(o||l)&&(h+=" (found",o&&(h+=` in field ${n}`),l&&(h+=` in document ${a}`),h+=")"),new Ye(Re.INVALID_ARGUMENT,u+t+h)}function XA(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KA{constructor(e,r,n,a,o){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=a,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new en(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new M6(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(zx("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class M6 extends KA{data(){return super.data()}}function zx(t,e){return typeof e=="string"?Hx(t,e):e instanceof ym?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L6(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Ye(Re.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Gx{}class U6 extends Gx{}function B6(t,e,...r){let n=[];e instanceof Gx&&n.push(e),n=n.concat(r),function(o){const l=o.filter(h=>h instanceof qx).length,u=o.filter(h=>h instanceof Tm).length;if(l>1||l>0&&u>0)throw new Ye(Re.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const a of n)t=a._apply(t);return t}class Tm extends U6{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new Tm(e,r,n)}_apply(e){const r=this._parse(e);return YA(e._query,r),new su(e.firestore,e.converter,C1(e._query,r))}_parse(e){const r=Vx(e.firestore);return function(o,l,u,h,d,p,v){let _;if(d.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new Ye(Re.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){AT(v,p);const S=[];for(const y of v)S.push(ST(h,o,y));_={arrayValue:{values:S}}}else _=ST(h,o,v)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||AT(v,p),_=F6(u,l,v,p==="in"||p==="not-in");return Wr.create(d,p,_)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function V6(t,e,r){const n=e,a=zx("where",t);return Tm._create(a,n,r)}class qx extends Gx{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new qx(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:ni.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(a,o){let l=a;const u=o.getFlattenedFilters();for(const h of u)YA(l,h),l=C1(l,h)}(e._query,r),new su(e.firestore,e.converter,C1(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function ST(t,e,r){if(typeof(r=br(r))=="string"){if(r==="")throw new Ye(Re.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!$S(e)&&r.indexOf("/")!==-1)throw new Ye(Re.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(ur.fromString(r));if(!et.isDocumentKey(n))throw new Ye(Re.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return jE(t,new et(n))}if(r instanceof en)return jE(t,r._key);throw new Ye(Re.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${om(r)}.`)}function AT(t,e){if(!Array.isArray(t)||t.length===0)throw new Ye(Re.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function YA(t,e){const r=function(a,o){for(const l of a)for(const u of l.getFlattenedFilters())if(o.indexOf(u.op)>=0)return u.op;return null}(t.filters,function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new Ye(Re.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ye(Re.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class j6{convertValue(e,r="none"){switch(vo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Fr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(xo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw ut(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return bo(e,(a,o)=>{n[a]=this.convertValue(o,r)}),n}convertVectorValue(e){var r,n,a;const o=(a=(n=(r=e.fields)===null||r===void 0?void 0:r[Id].arrayValue)===null||n===void 0?void 0:n.values)===null||a===void 0?void 0:a.map(l=>Fr(l.doubleValue));return new Oi(o)}convertGeoPoint(e){return new Di(Fr(e.latitude),Fr(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=um(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(zf(e));default:return null}}convertTimestamp(e){const r=go(e);return new dr(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=ur.fromString(e);Kt(vA(n),9688,{name:e});const a=new Gf(n.get(1),n.get(3)),o=new et(n.popFirst(5));return a.isEqual(r)||ps(`Document ${o} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H6(t,e,r){let n;return n=t?t.toFirestore(e):e,n}class ed{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Uc extends KA{constructor(e,r,n,a,o,l){super(e,r,n,a,l),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new Ed(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(zx("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ye(Re.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=Uc._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}Uc._jsonSchemaVersion="firestore/documentSnapshot/1.0",Uc._jsonSchema={type:Xr("string",Uc._jsonSchemaVersion),bundleSource:Xr("string","DocumentSnapshot"),bundleName:Xr("string"),bundle:Xr("string")};class Ed extends Uc{data(e={}){return super.data(e)}}class Bc{constructor(e,r,n,a){this._firestore=e,this._userDataWriter=r,this._snapshot=a,this.metadata=new ed(a.hasPendingWrites,a.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new Ed(this._firestore,this._userDataWriter,n.key,n,new ed(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Ye(Re.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(a,o){if(a._snapshot.oldDocs.isEmpty()){let l=0;return a._snapshot.docChanges.map(u=>{const h=new Ed(a._firestore,a._userDataWriter,u.doc.key,u.doc,new ed(a._snapshot.mutatedKeys.has(u.doc.key),a._snapshot.fromCache),a.query.converter);return u.doc,{type:"added",doc:h,oldIndex:-1,newIndex:l++}})}{let l=a._snapshot.oldDocs;return a._snapshot.docChanges.filter(u=>o||u.type!==3).map(u=>{const h=new Ed(a._firestore,a._userDataWriter,u.doc.key,u.doc,new ed(a._snapshot.mutatedKeys.has(u.doc.key),a._snapshot.fromCache),a.query.converter);let d=-1,p=-1;return u.type!==0&&(d=l.indexOf(u.doc.key),l=l.delete(u.doc.key)),u.type!==1&&(l=l.add(u.doc),p=l.indexOf(u.doc.key)),{type:z6(u.type),doc:h,oldIndex:d,newIndex:p}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ye(Re.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Bc._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=mx.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],a=[];return this.docs.forEach(o=>{o._document!==null&&(r.push(o._document),n.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),a.push(o.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function z6(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ut(61501,{type:t})}}Bc._jsonSchemaVersion="firestore/querySnapshot/1.0",Bc._jsonSchema={type:Xr("string",Bc._jsonSchemaVersion),bundleSource:Xr("string","QuerySnapshot"),bundleName:Xr("string"),bundle:Xr("string")};class G6 extends j6{constructor(e){super(),this.firestore=e}convertBytes(e){return new ja(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new en(this.firestore,null,r)}}function ll(t){t=_l(t,su);const e=_l(t.firestore,v0),r=HA(e),n=new G6(e);return L6(t._query),S6(r,t._query).then(a=>new Bc(e,n,t,a))}function If(t,e,r,...n){t=_l(t,en);const a=_l(t.firestore,v0),o=Vx(a);let l;return l=typeof(e=br(e))=="string"||e instanceof ym?O6(o,"updateDoc",t._key,e,r,n):D6(o,"updateDoc",t._key,e),Wx(a,[l.toMutation(t._key,ei.exists(!0))])}function Td(t){return Wx(_l(t.firestore,v0),[new Ex(t._key,ei.none())])}function yf(t,e){const r=_l(t.firestore,v0),n=bi(t),a=H6(t.converter,e);return Wx(r,[N6(Vx(t.firestore),"addDoc",n._key,a,t.converter!==null,{}).toMutation(n._key,ei.exists(!1))]).then(()=>n)}function Wx(t,e){return function(n,a){const o=new uo;return n.asyncQueue.enqueueAndForget(async()=>u6(await T6(n),a,o)),o.promise}(HA(t),e)}(function(e,r=!0){(function(a){ru=a})(Il),xl(new ho("firestore",(n,{instanceIdentifier:a,options:o})=>{const l=n.getProvider("app").getImmediate(),u=new v0(new II(n.getProvider("auth-internal")),new OI(l,n.getProvider("app-check-internal")),function(d,p){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new Ye(Re.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Gf(d.options.projectId,p)}(l,a),l);return o=Object.assign({useFetchStreams:r},o),u._setSettings(o),u},"PUBLIC").setMultipleInstances(!0)),Ri(kE,CE,e),Ri(kE,CE,"esm2017")})();function Xx(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(t);a<n.length;a++)e.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(t,n[a])&&(r[n[a]]=t[n[a]]);return r}function $A(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const q6=$A,QA=new u0("auth","Firebase",$A());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vd=new cx("@firebase/auth");function W6(t,...e){Vd.logLevel<=Dt.WARN&&Vd.warn(`Auth (${Il}): ${t}`,...e)}function wd(t,...e){Vd.logLevel<=Dt.ERROR&&Vd.error(`Auth (${Il}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ai(t,...e){throw Kx(t,...e)}function Fi(t,...e){return Kx(t,...e)}function ZA(t,e,r){const n=Object.assign(Object.assign({},q6()),{[e]:r});return new u0("auth","Firebase",n).create(e,{appName:t.name})}function fs(t){return ZA(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Kx(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return QA.create(t,...e)}function ct(t,e,...r){if(!t)throw Kx(e,...r)}function ls(t){const e="INTERNAL ASSERTION FAILED: "+t;throw wd(e),new Error(e)}function xs(t,e){t||ls(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V1(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function X6(){return bT()==="http:"||bT()==="https:"}function bT(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K6(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(X6()||iR()||"connection"in navigator)?navigator.onLine:!0}function Y6(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y0{constructor(e,r){this.shortDelay=e,this.longDelay=r,xs(r>e,"Short delay should be less than long delay!"),this.isMobile=rR()||sR()}get(){return K6()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yx(t,e){xs(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JA{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ls("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ls("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ls("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $6={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q6=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Z6=new y0(3e4,6e4);function Co(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Ro(t,e,r,n,a={}){return eb(t,a,async()=>{let o={},l={};n&&(e==="GET"?l=n:o={body:JSON.stringify(n)});const u=f0(Object.assign({key:t.config.apiKey},l)).slice(1),h=await t._getAdditionalHeaders();h["Content-Type"]="application/json",t.languageCode&&(h["X-Firebase-Locale"]=t.languageCode);const d=Object.assign({method:e,headers:h},o);return aR()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&Ao(t.emulatorConfig.host)&&(d.credentials="include"),JA.fetch()(await tb(t,t.config.apiHost,r,u),d)})}async function eb(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},$6),e);try{const a=new eO(t),o=await Promise.race([r(),a.promise]);a.clearNetworkTimeout();const l=await o.json();if("needConfirmation"in l)throw td(t,"account-exists-with-different-credential",l);if(o.ok&&!("errorMessage"in l))return l;{const u=o.ok?l.errorMessage:l.error.message,[h,d]=u.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw td(t,"credential-already-in-use",l);if(h==="EMAIL_EXISTS")throw td(t,"email-already-in-use",l);if(h==="USER_DISABLED")throw td(t,"user-disabled",l);const p=n[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw ZA(t,p,d);ai(t,p)}}catch(a){if(a instanceof Ui)throw a;ai(t,"network-request-failed",{message:String(a)})}}async function E0(t,e,r,n,a={}){const o=await Ro(t,e,r,n,a);return"mfaPendingCredential"in o&&ai(t,"multi-factor-auth-required",{_serverResponse:o}),o}async function tb(t,e,r,n){const a=`${e}${r}?${n}`,o=t,l=o.config.emulator?Yx(t.config,a):`${t.config.apiScheme}://${a}`;return Q6.includes(r)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(l).toString():l}function J6(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class eO{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Fi(this.auth,"network-request-failed")),Z6.get())})}}function td(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const a=Fi(t,e,n);return a.customData._tokenResponse=r,a}function kT(t){return t!==void 0&&t.enterprise!==void 0}class tO{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return J6(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function rO(t,e){return Ro(t,"GET","/v2/recaptchaConfig",Co(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nO(t,e){return Ro(t,"POST","/v1/accounts:delete",e)}async function jd(t,e){return Ro(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nf(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function aO(t,e=!1){const r=br(t),n=await r.getIdToken(e),a=$x(n);ct(a&&a.exp&&a.auth_time&&a.iat,r.auth,"internal-error");const o=typeof a.firebase=="object"?a.firebase:void 0,l=o==null?void 0:o.sign_in_provider;return{claims:a,token:n,authTime:Nf(Xg(a.auth_time)),issuedAtTime:Nf(Xg(a.iat)),expirationTime:Nf(Xg(a.exp)),signInProvider:l||null,signInSecondFactor:(o==null?void 0:o.sign_in_second_factor)||null}}function Xg(t){return Number(t)*1e3}function $x(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return wd("JWT malformed, contained fewer than 3 sections"),null;try{const a=hS(r);return a?JSON.parse(a):(wd("Failed to decode base64 JWT payload"),null)}catch(a){return wd("Caught error parsing JWT payload as JSON",a==null?void 0:a.toString()),null}}function CT(t){const e=$x(t);return ct(e,"internal-error"),ct(typeof e.exp<"u","internal-error"),ct(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kf(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof Ui&&iO(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function iO({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sO{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const a=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,a)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j1{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Nf(this.lastLoginAt),this.creationTime=Nf(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hd(t){var e;const r=t.auth,n=await t.getIdToken(),a=await Kf(t,jd(r,{idToken:n}));ct(a==null?void 0:a.users.length,r,"internal-error");const o=a.users[0];t._notifyReloadListener(o);const l=!((e=o.providerUserInfo)===null||e===void 0)&&e.length?rb(o.providerUserInfo):[],u=lO(t.providerData,l),h=t.isAnonymous,d=!(t.email&&o.passwordHash)&&!(u!=null&&u.length),p=h?d:!1,v={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new j1(o.createdAt,o.lastLoginAt),isAnonymous:p};Object.assign(t,v)}async function oO(t){const e=br(t);await Hd(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function lO(t,e){return[...t.filter(n=>!e.some(a=>a.providerId===n.providerId)),...e]}function rb(t){return t.map(e=>{var{providerId:r}=e,n=Xx(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cO(t,e){const r=await eb(t,{},async()=>{const n=f0({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:o}=t.config,l=await tb(t,a,"/v1/token",`key=${o}`),u=await t._getAdditionalHeaders();u["Content-Type"]="application/x-www-form-urlencoded";const h={method:"POST",headers:u,body:n};return t.emulatorConfig&&Ao(t.emulatorConfig.host)&&(h.credentials="include"),JA.fetch()(l,h)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function uO(t,e){return Ro(t,"POST","/v2/accounts:revokeToken",Co(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ct(e.idToken,"internal-error"),ct(typeof e.idToken<"u","internal-error"),ct(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):CT(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){ct(e.length!==0,"internal-error");const r=CT(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(ct(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:a,expiresIn:o}=await cO(e,r);this.updateTokensAndExpiration(n,a,Number(o))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:a,expirationTime:o}=r,l=new Vc;return n&&(ct(typeof n=="string","internal-error",{appName:e}),l.refreshToken=n),a&&(ct(typeof a=="string","internal-error",{appName:e}),l.accessToken=a),o&&(ct(typeof o=="number","internal-error",{appName:e}),l.expirationTime=o),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Vc,this.toJSON())}_performRefresh(){return ls("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $s(t,e){ct(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Qa{constructor(e){var{uid:r,auth:n,stsTokenManager:a}=e,o=Xx(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new sO(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new j1(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const r=await Kf(this,this.stsTokenManager.getToken(this.auth,e));return ct(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return aO(this,e)}reload(){return oO(this)}_assign(e){this!==e&&(ct(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Qa(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){ct(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await Hd(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ga(this.auth.app))return Promise.reject(fs(this.auth));const e=await this.getIdToken();return await Kf(this,nO(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,a,o,l,u,h,d,p;const v=(n=r.displayName)!==null&&n!==void 0?n:void 0,_=(a=r.email)!==null&&a!==void 0?a:void 0,E=(o=r.phoneNumber)!==null&&o!==void 0?o:void 0,S=(l=r.photoURL)!==null&&l!==void 0?l:void 0,y=(u=r.tenantId)!==null&&u!==void 0?u:void 0,w=(h=r._redirectEventId)!==null&&h!==void 0?h:void 0,P=(d=r.createdAt)!==null&&d!==void 0?d:void 0,B=(p=r.lastLoginAt)!==null&&p!==void 0?p:void 0,{uid:N,emailVerified:z,isAnonymous:q,providerData:Z,stsTokenManager:C}=r;ct(N&&C,e,"internal-error");const I=Vc.fromJSON(this.name,C);ct(typeof N=="string",e,"internal-error"),$s(v,e.name),$s(_,e.name),ct(typeof z=="boolean",e,"internal-error"),ct(typeof q=="boolean",e,"internal-error"),$s(E,e.name),$s(S,e.name),$s(y,e.name),$s(w,e.name),$s(P,e.name),$s(B,e.name);const b=new Qa({uid:N,auth:e,email:_,emailVerified:z,displayName:v,isAnonymous:q,photoURL:S,phoneNumber:E,tenantId:y,stsTokenManager:I,createdAt:P,lastLoginAt:B});return Z&&Array.isArray(Z)&&(b.providerData=Z.map(O=>Object.assign({},O))),w&&(b._redirectEventId=w),b}static async _fromIdTokenResponse(e,r,n=!1){const a=new Vc;a.updateFromServerResponse(r);const o=new Qa({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:n});return await Hd(o),o}static async _fromGetAccountInfoResponse(e,r,n){const a=r.users[0];ct(a.localId!==void 0,"internal-error");const o=a.providerUserInfo!==void 0?rb(a.providerUserInfo):[],l=!(a.email&&a.passwordHash)&&!(o!=null&&o.length),u=new Vc;u.updateFromIdToken(n);const h=new Qa({uid:a.localId,auth:e,stsTokenManager:u,isAnonymous:l}),d={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:o,metadata:new j1(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!(o!=null&&o.length)};return Object.assign(h,d),h}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RT=new Map;function cs(t){xs(t instanceof Function,"Expected a class definition");let e=RT.get(t);return e?(xs(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,RT.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nb{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}nb.type="NONE";const IT=nb;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sd(t,e,r){return`firebase:${t}:${e}:${r}`}class jc{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:a,name:o}=this.auth;this.fullUserKey=Sd(this.userKey,a.apiKey,o),this.fullPersistenceKey=Sd("persistence",a.apiKey,o),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await jd(this.auth,{idToken:e}).catch(()=>{});return r?Qa._fromGetAccountInfoResponse(this.auth,r,e):null}return Qa._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new jc(cs(IT),e,n);const a=(await Promise.all(r.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let o=a[0]||cs(IT);const l=Sd(n,e.config.apiKey,e.name);let u=null;for(const d of r)try{const p=await d._get(l);if(p){let v;if(typeof p=="string"){const _=await jd(e,{idToken:p}).catch(()=>{});if(!_)break;v=await Qa._fromGetAccountInfoResponse(e,_,p)}else v=Qa._fromJSON(e,p);d!==o&&(u=v),o=d;break}}catch{}const h=a.filter(d=>d._shouldAllowMigration);return!o._shouldAllowMigration||!h.length?new jc(o,e,n):(o=h[0],u&&await o._set(l,u.toJSON()),await Promise.all(r.map(async d=>{if(d!==o)try{await d._remove(l)}catch{}})),new jc(o,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NT(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(ob(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(ab(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(cb(e))return"Blackberry";if(ub(e))return"Webos";if(ib(e))return"Safari";if((e.includes("chrome/")||sb(e))&&!e.includes("edge/"))return"Chrome";if(lb(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function ab(t=Fn()){return/firefox\//i.test(t)}function ib(t=Fn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function sb(t=Fn()){return/crios\//i.test(t)}function ob(t=Fn()){return/iemobile/i.test(t)}function lb(t=Fn()){return/android/i.test(t)}function cb(t=Fn()){return/blackberry/i.test(t)}function ub(t=Fn()){return/webos/i.test(t)}function Qx(t=Fn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function fO(t=Fn()){var e;return Qx(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function hO(){return oR()&&document.documentMode===10}function fb(t=Fn()){return Qx(t)||lb(t)||ub(t)||cb(t)||/windows phone/i.test(t)||ob(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hb(t,e=[]){let r;switch(t){case"Browser":r=NT(Fn());break;case"Worker":r=`${NT(Fn())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Il}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dO{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=o=>new Promise((l,u)=>{try{const h=e(o);l(h)}catch(h){u(h)}});n.onAbort=r,this.queue.push(n);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const a of r)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mO(t,e={}){return Ro(t,"GET","/v2/passwordPolicy",Co(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pO=6;class gO{constructor(e){var r,n,a,o;const l=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=l.minPasswordLength)!==null&&r!==void 0?r:pO,l.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=l.maxPasswordLength),l.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=l.containsLowercaseCharacter),l.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=l.containsUppercaseCharacter),l.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=l.containsNumericCharacter),l.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=l.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(a=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&a!==void 0?a:"",this.forceUpgradeOnSignin=(o=e.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,a,o,l,u;const h={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,h),this.validatePasswordCharacterOptions(e,h),h.isValid&&(h.isValid=(r=h.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),h.isValid&&(h.isValid=(n=h.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),h.isValid&&(h.isValid=(a=h.containsLowercaseLetter)!==null&&a!==void 0?a:!0),h.isValid&&(h.isValid=(o=h.containsUppercaseLetter)!==null&&o!==void 0?o:!0),h.isValid&&(h.isValid=(l=h.containsNumericCharacter)!==null&&l!==void 0?l:!0),h.isValid&&(h.isValid=(u=h.containsNonAlphanumericCharacter)!==null&&u!==void 0?u:!0),h}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),a&&(r.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let a=0;a<e.length;a++)n=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,a,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xO{constructor(e,r,n,a){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new DT(this),this.idTokenSubscription=new DT(this),this.beforeStateQueue=new dO(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=QA,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=cs(r)),this._initializationPromise=this.queue(async()=>{var n,a,o;if(!this._deleted&&(this.persistenceManager=await jc.create(this,e),(n=this._resolvePersistenceManagerAvailable)===null||n===void 0||n.call(this),!this._deleted)){if(!((a=this._popupRedirectResolver)===null||a===void 0)&&a._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((o=this.currentUser)===null||o===void 0?void 0:o.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await jd(this,{idToken:e}),n=await Qa._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(ga(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(u,u))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let a=n,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,u=a==null?void 0:a._redirectEventId,h=await this.tryRedirectSignIn(e);(!l||l===u)&&(h!=null&&h.user)&&(a=h.user,o=!0)}if(!a)return this.directlySetCurrentUser(null);if(!a._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(a)}catch(l){a=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return a?this.reloadAndSetCurrentUserOrClear(a):this.directlySetCurrentUser(null)}return ct(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===a._redirectEventId?this.directlySetCurrentUser(a):this.reloadAndSetCurrentUserOrClear(a)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await Hd(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Y6()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ga(this.app))return Promise.reject(fs(this));const r=e?br(e):null;return r&&ct(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&ct(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ga(this.app)?Promise.reject(fs(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ga(this.app)?Promise.reject(fs(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(cs(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await mO(this),r=new gO(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new u0("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await uO(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&cs(e)||this._popupRedirectResolver;ct(r,this,"argument-error"),this.redirectPersistenceManager=await jc.create(this,[cs(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,a){if(this._deleted)return()=>{};const o=typeof r=="function"?r:r.next.bind(r);let l=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(ct(u,this,"internal-error"),u.then(()=>{l||o(this.currentUser)}),typeof r=="function"){const h=e.addObserver(r,n,a);return()=>{l=!0,h()}}else{const h=e.addObserver(r);return()=>{l=!0,h()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ct(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=hb(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const a=await this._getAppCheckToken();return a&&(r["X-Firebase-AppCheck"]=a),r}async _getAppCheckToken(){var e;if(ga(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&W6(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function Ol(t){return br(t)}class DT{constructor(e){this.auth=e,this.observer=null,this.addObserver=pR(r=>this.observer=r)}get next(){return ct(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wm={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function vO(t){wm=t}function db(t){return wm.loadJS(t)}function _O(){return wm.recaptchaEnterpriseScript}function yO(){return wm.gapiScript}function EO(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class TO{constructor(){this.enterprise=new wO}ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}class wO{ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}const SO="recaptcha-enterprise",mb="NO_RECAPTCHA";class AO{constructor(e){this.type=SO,this.auth=Ol(e)}async verify(e="verify",r=!1){async function n(o){if(!r){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(l,u)=>{rO(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(h=>{if(h.recaptchaKey===void 0)u(new Error("recaptcha Enterprise site key undefined"));else{const d=new tO(h);return o.tenantId==null?o._agentRecaptchaConfig=d:o._tenantRecaptchaConfigs[o.tenantId]=d,l(d.siteKey)}}).catch(h=>{u(h)})})}function a(o,l,u){const h=window.grecaptcha;kT(h)?h.enterprise.ready(()=>{h.enterprise.execute(o,{action:e}).then(d=>{l(d)}).catch(()=>{l(mb)})}):u(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new TO().execute("siteKey",{action:"verify"}):new Promise((o,l)=>{n(this.auth).then(u=>{if(!r&&kT(window.grecaptcha))a(u,o,l);else{if(typeof window>"u"){l(new Error("RecaptchaVerifier is only supported in browser"));return}let h=_O();h.length!==0&&(h+=u),db(h).then(()=>{a(u,o,l)}).catch(d=>{l(d)})}}).catch(u=>{l(u)})})}}async function OT(t,e,r,n=!1,a=!1){const o=new AO(t);let l;if(a)l=mb;else try{l=await o.verify(r)}catch{l=await o.verify(r,!0)}const u=Object.assign({},e);if(r==="mfaSmsEnrollment"||r==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in u){const h=u.phoneEnrollmentInfo.phoneNumber,d=u.phoneEnrollmentInfo.recaptchaToken;Object.assign(u,{phoneEnrollmentInfo:{phoneNumber:h,recaptchaToken:d,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in u){const h=u.phoneSignInInfo.recaptchaToken;Object.assign(u,{phoneSignInInfo:{recaptchaToken:h,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return u}return n?Object.assign(u,{captchaResp:l}):Object.assign(u,{captchaResponse:l}),Object.assign(u,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(u,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),u}async function H1(t,e,r,n,a){var o;if(!((o=t._getRecaptchaConfig())===null||o===void 0)&&o.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const l=await OT(t,e,r,r==="getOobCode");return n(t,l)}else return n(t,e).catch(async l=>{if(l.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const u=await OT(t,e,r,r==="getOobCode");return n(t,u)}else return Promise.reject(l)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bO(t,e){const r=sm(t,"auth");if(r.isInitialized()){const a=r.getImmediate(),o=r.getOptions();if(gl(o,e??{}))return a;ai(a,"already-initialized")}return r.initialize({options:e})}function kO(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(cs);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function CO(t,e,r){const n=Ol(t);ct(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const a=!1,o=pb(e),{host:l,port:u}=RO(e),h=u===null?"":`:${u}`,d={url:`${o}//${l}${h}/`},p=Object.freeze({host:l,port:u,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!n._canInitEmulator){ct(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),ct(gl(d,n.config.emulator)&&gl(p,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=d,n.emulatorConfig=p,n.settings.appVerificationDisabledForTesting=!0,Ao(l)?(ox(`${o}//${l}${h}`),lx("Auth",!0)):IO()}function pb(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function RO(t){const e=pb(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(n);if(a){const o=a[1];return{host:o,port:FT(n.substr(o.length+1))}}else{const[o,l]=n.split(":");return{host:o,port:FT(l)}}}function FT(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function IO(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zx{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return ls("not implemented")}_getIdTokenResponse(e){return ls("not implemented")}_linkToIdToken(e,r){return ls("not implemented")}_getReauthenticationResolver(e){return ls("not implemented")}}async function NO(t,e){return Ro(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DO(t,e){return E0(t,"POST","/v1/accounts:signInWithPassword",Co(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OO(t,e){return E0(t,"POST","/v1/accounts:signInWithEmailLink",Co(t,e))}async function FO(t,e){return E0(t,"POST","/v1/accounts:signInWithEmailLink",Co(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yf extends Zx{constructor(e,r,n,a=null){super("password",n),this._email=e,this._password=r,this._tenantId=a}static _fromEmailAndPassword(e,r){return new Yf(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new Yf(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r!=null&&r.email&&(r!=null&&r.password)){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return H1(e,r,"signInWithPassword",DO);case"emailLink":return OO(e,{email:this._email,oobCode:this._password});default:ai(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return H1(e,n,"signUpPassword",NO);case"emailLink":return FO(e,{idToken:r,email:this._email,oobCode:this._password});default:ai(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hc(t,e){return E0(t,"POST","/v1/accounts:signInWithIdp",Co(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PO="http://localhost";class El extends Zx{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new El(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):ai("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:a}=r,o=Xx(r,["providerId","signInMethod"]);if(!n||!a)return null;const l=new El(n,a);return l.idToken=o.idToken||void 0,l.accessToken=o.accessToken||void 0,l.secret=o.secret,l.nonce=o.nonce,l.pendingToken=o.pendingToken||null,l}_getIdTokenResponse(e){const r=this.buildRequest();return Hc(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,Hc(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,Hc(e,r)}buildRequest(){const e={requestUri:PO,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=f0(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MO(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function LO(t){const e=pf(gf(t)).link,r=e?pf(gf(e)).deep_link_id:null,n=pf(gf(t)).deep_link_id;return(n?pf(gf(n)).link:null)||n||r||e||t}class Jx{constructor(e){var r,n,a,o,l,u;const h=pf(gf(e)),d=(r=h.apiKey)!==null&&r!==void 0?r:null,p=(n=h.oobCode)!==null&&n!==void 0?n:null,v=MO((a=h.mode)!==null&&a!==void 0?a:null);ct(d&&p&&v,"argument-error"),this.apiKey=d,this.operation=v,this.code=p,this.continueUrl=(o=h.continueUrl)!==null&&o!==void 0?o:null,this.languageCode=(l=h.lang)!==null&&l!==void 0?l:null,this.tenantId=(u=h.tenantId)!==null&&u!==void 0?u:null}static parseLink(e){const r=LO(e);try{return new Jx(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lu{constructor(){this.providerId=lu.PROVIDER_ID}static credential(e,r){return Yf._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=Jx.parseLink(r);return ct(n,"argument-error"),Yf._fromEmailAndCode(e,n.code,n.tenantId)}}lu.PROVIDER_ID="password";lu.EMAIL_PASSWORD_SIGN_IN_METHOD="password";lu.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gb{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T0 extends gb{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zs extends T0{constructor(){super("facebook.com")}static credential(e){return El._fromParams({providerId:Zs.PROVIDER_ID,signInMethod:Zs.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Zs.credentialFromTaggedObject(e)}static credentialFromError(e){return Zs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Zs.credential(e.oauthAccessToken)}catch{return null}}}Zs.FACEBOOK_SIGN_IN_METHOD="facebook.com";Zs.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Js extends T0{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return El._fromParams({providerId:Js.PROVIDER_ID,signInMethod:Js.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return Js.credentialFromTaggedObject(e)}static credentialFromError(e){return Js.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return Js.credential(r,n)}catch{return null}}}Js.GOOGLE_SIGN_IN_METHOD="google.com";Js.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eo extends T0{constructor(){super("github.com")}static credential(e){return El._fromParams({providerId:eo.PROVIDER_ID,signInMethod:eo.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return eo.credentialFromTaggedObject(e)}static credentialFromError(e){return eo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return eo.credential(e.oauthAccessToken)}catch{return null}}}eo.GITHUB_SIGN_IN_METHOD="github.com";eo.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class to extends T0{constructor(){super("twitter.com")}static credential(e,r){return El._fromParams({providerId:to.PROVIDER_ID,signInMethod:to.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return to.credentialFromTaggedObject(e)}static credentialFromError(e){return to.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return to.credential(r,n)}catch{return null}}}to.TWITTER_SIGN_IN_METHOD="twitter.com";to.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UO(t,e){return E0(t,"POST","/v1/accounts:signUp",Co(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,a=!1){const o=await Qa._fromIdTokenResponse(e,n,a),l=PT(n);return new Tl({user:o,providerId:l,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const a=PT(n);return new Tl({user:e,providerId:a,_tokenResponse:n,operationType:r})}}function PT(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zd extends Ui{constructor(e,r,n,a){var o;super(r.code,r.message),this.operationType=n,this.user=a,Object.setPrototypeOf(this,zd.prototype),this.customData={appName:e.name,tenantId:(o=e.tenantId)!==null&&o!==void 0?o:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,a){return new zd(e,r,n,a)}}function xb(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?zd._fromErrorAndOperation(t,o,e,n):o})}async function BO(t,e,r=!1){const n=await Kf(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Tl._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VO(t,e,r=!1){const{auth:n}=t;if(ga(n.app))return Promise.reject(fs(n));const a="reauthenticate";try{const o=await Kf(t,xb(n,a,e,t),r);ct(o.idToken,n,"internal-error");const l=$x(o.idToken);ct(l,n,"internal-error");const{sub:u}=l;return ct(t.uid===u,n,"user-mismatch"),Tl._forOperation(t,a,o)}catch(o){throw(o==null?void 0:o.code)==="auth/user-not-found"&&ai(n,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vb(t,e,r=!1){if(ga(t.app))return Promise.reject(fs(t));const n="signIn",a=await xb(t,n,e),o=await Tl._fromIdTokenResponse(t,n,a);return r||await t._updateCurrentUser(o.user),o}async function jO(t,e){return vb(Ol(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _b(t){const e=Ol(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function HO(t,e,r){if(ga(t.app))return Promise.reject(fs(t));const n=Ol(t),l=await H1(n,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",UO).catch(h=>{throw h.code==="auth/password-does-not-meet-requirements"&&_b(t),h}),u=await Tl._fromIdTokenResponse(n,"signIn",l);return await n._updateCurrentUser(u.user),u}function zO(t,e,r){return ga(t.app)?Promise.reject(fs(t)):jO(br(t),lu.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&_b(t),n})}function GO(t,e,r,n){return br(t).onIdTokenChanged(e,r,n)}function qO(t,e,r){return br(t).beforeAuthStateChanged(e,r)}function WO(t,e,r,n){return br(t).onAuthStateChanged(e,r,n)}function z1(t){return br(t).signOut()}const Gd="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yb{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(Gd,"1"),this.storage.removeItem(Gd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XO=1e3,KO=10;class Eb extends yb{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=fb(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),a=this.localCache[r];n!==a&&e(r,a,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((l,u,h)=>{this.notifyListeners(l,h)});return}const n=e.key;r?this.detachListener():this.stopPolling();const a=()=>{const l=this.storage.getItem(n);!r&&this.localCache[n]===l||this.notifyListeners(n,l)},o=this.storage.getItem(n);hO()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,KO):a()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},XO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}Eb.type="LOCAL";const YO=Eb;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tb extends yb{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}Tb.type="SESSION";const wb=Tb;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $O(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sm{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(a=>a.isListeningto(e));if(r)return r;const n=new Sm(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:a,data:o}=r.data,l=this.handlersMap[a];if(!(l!=null&&l.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:a});const u=Array.from(l).map(async d=>d(r.origin,o)),h=await $O(u);r.ports[0].postMessage({status:"done",eventId:n,eventType:a,response:h})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Sm.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ev(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QO{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let o,l;return new Promise((u,h)=>{const d=ev("",20);a.port1.start();const p=setTimeout(()=>{h(new Error("unsupported_event"))},n);l={messageChannel:a,onMessage(v){const _=v;if(_.data.eventId===d)switch(_.data.status){case"ack":clearTimeout(p),o=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),u(_.data.response);break;default:clearTimeout(p),clearTimeout(o),h(new Error("invalid_response"));break}}},this.handlers.add(l),a.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:e,eventId:d,data:r},[a.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pi(){return window}function ZO(t){Pi().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sb(){return typeof Pi().WorkerGlobalScope<"u"&&typeof Pi().importScripts=="function"}async function JO(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function eF(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function tF(){return Sb()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ab="firebaseLocalStorageDb",rF=1,qd="firebaseLocalStorage",bb="fbase_key";class w0{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function Am(t,e){return t.transaction([qd],e?"readwrite":"readonly").objectStore(qd)}function nF(){const t=indexedDB.deleteDatabase(Ab);return new w0(t).toPromise()}function G1(){const t=indexedDB.open(Ab,rF);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(qd,{keyPath:bb})}catch(a){r(a)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(qd)?e(n):(n.close(),await nF(),e(await G1()))})})}async function MT(t,e,r){const n=Am(t,!0).put({[bb]:e,value:r});return new w0(n).toPromise()}async function aF(t,e){const r=Am(t,!1).get(e),n=await new w0(r).toPromise();return n===void 0?null:n.value}function LT(t,e){const r=Am(t,!0).delete(e);return new w0(r).toPromise()}const iF=800,sF=3;class kb{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await G1(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>sF)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Sb()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Sm._getInstance(tF()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await JO(),!this.activeServiceWorker)return;this.sender=new QO(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||eF()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await G1();return await MT(e,Gd,"1"),await LT(e,Gd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>MT(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>aF(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>LT(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const o=Am(a,!1).getAll();return new w0(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:a,value:o}of e)n.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(o)&&(this.notifyListeners(a,o),r.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!n.has(a)&&(this.notifyListeners(a,null),r.push(a));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),iF)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}kb.type="LOCAL";const oF=kb;new y0(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lF(t,e){return e?cs(e):(ct(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tv extends Zx{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Hc(e,this._buildIdpRequest())}_linkToIdToken(e,r){return Hc(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return Hc(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function cF(t){return vb(t.auth,new tv(t),t.bypassAuthState)}function uF(t){const{auth:e,user:r}=t;return ct(r,e,"internal-error"),VO(r,new tv(t),t.bypassAuthState)}async function fF(t){const{auth:e,user:r}=t;return ct(r,e,"internal-error"),BO(r,new tv(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cb{constructor(e,r,n,a,o=!1){this.auth=e,this.resolver=n,this.user=a,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:a,tenantId:o,error:l,type:u}=e;if(l){this.reject(l);return}const h={auth:this.auth,requestUri:r,sessionId:n,tenantId:o||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(h))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return cF;case"linkViaPopup":case"linkViaRedirect":return fF;case"reauthViaPopup":case"reauthViaRedirect":return uF;default:ai(this.auth,"internal-error")}}resolve(e){xs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){xs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hF=new y0(2e3,1e4);class Pc extends Cb{constructor(e,r,n,a,o){super(e,r,a,o),this.provider=n,this.authWindow=null,this.pollId=null,Pc.currentPopupAction&&Pc.currentPopupAction.cancel(),Pc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ct(e,this.auth,"internal-error"),e}async onExecution(){xs(this.filter.length===1,"Popup operations only handle one event");const e=ev();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Fi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Fi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Pc.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Fi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,hF.get())};e()}}Pc.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dF="pendingRedirect",Ad=new Map;class mF extends Cb{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=Ad.get(this.auth._key());if(!e){try{const n=await pF(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}Ad.set(this.auth._key(),e)}return this.bypassAuthState||Ad.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function pF(t,e){const r=vF(e),n=xF(t);if(!await n._isAvailable())return!1;const a=await n._get(r)==="true";return await n._remove(r),a}function gF(t,e){Ad.set(t._key(),e)}function xF(t){return cs(t._redirectPersistence)}function vF(t){return Sd(dF,t.config.apiKey,t.name)}async function _F(t,e,r=!1){if(ga(t.app))return Promise.reject(fs(t));const n=Ol(t),a=lF(n,e),l=await new mF(n,a,r).execute();return l&&!r&&(delete l.user._redirectEventId,await n._persistUserIfCurrent(l.user),await n._setRedirectUser(null,e)),l}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yF=10*60*1e3;class EF{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!TF(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!Rb(e)){const a=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(Fi(this.auth,a))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=yF&&this.cachedEventUids.clear(),this.cachedEventUids.has(UT(e))}saveEventToCache(e){this.cachedEventUids.add(UT(e)),this.lastProcessedEventTime=Date.now()}}function UT(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function Rb({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function TF(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Rb(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wF(t,e={}){return Ro(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SF=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,AF=/^https?/;async function bF(t){if(t.config.emulator)return;const{authorizedDomains:e}=await wF(t);for(const r of e)try{if(kF(r))return}catch{}ai(t,"unauthorized-domain")}function kF(t){const e=V1(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const l=new URL(t);return l.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&l.hostname===n}if(!AF.test(r))return!1;if(SF.test(t))return n===t;const a=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CF=new y0(3e4,6e4);function BT(){const t=Pi().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function RF(t){return new Promise((e,r)=>{var n,a,o;function l(){BT(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{BT(),r(Fi(t,"network-request-failed"))},timeout:CF.get()})}if(!((a=(n=Pi().gapi)===null||n===void 0?void 0:n.iframes)===null||a===void 0)&&a.Iframe)e(gapi.iframes.getContext());else if(!((o=Pi().gapi)===null||o===void 0)&&o.load)l();else{const u=EO("iframefcb");return Pi()[u]=()=>{gapi.load?l():r(Fi(t,"network-request-failed"))},db(`${yO()}?onload=${u}`).catch(h=>r(h))}}).catch(e=>{throw bd=null,e})}let bd=null;function IF(t){return bd=bd||RF(t),bd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NF=new y0(5e3,15e3),DF="__/auth/iframe",OF="emulator/auth/iframe",FF={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},PF=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function MF(t){const e=t.config;ct(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?Yx(e,OF):`https://${t.config.authDomain}/${DF}`,n={apiKey:e.apiKey,appName:t.name,v:Il},a=PF.get(t.config.apiHost);a&&(n.eid=a);const o=t._getFrameworks();return o.length&&(n.fw=o.join(",")),`${r}?${f0(n).slice(1)}`}async function LF(t){const e=await IF(t),r=Pi().gapi;return ct(r,t,"internal-error"),e.open({where:document.body,url:MF(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:FF,dontclear:!0},n=>new Promise(async(a,o)=>{await n.restyle({setHideOnLeave:!1});const l=Fi(t,"network-request-failed"),u=Pi().setTimeout(()=>{o(l)},NF.get());function h(){Pi().clearTimeout(u),a(n)}n.ping(h).then(h,()=>{o(l)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UF={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},BF=500,VF=600,jF="_blank",HF="http://localhost";class VT{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function zF(t,e,r,n=BF,a=VF){const o=Math.max((window.screen.availHeight-a)/2,0).toString(),l=Math.max((window.screen.availWidth-n)/2,0).toString();let u="";const h=Object.assign(Object.assign({},UF),{width:n.toString(),height:a.toString(),top:o,left:l}),d=Fn().toLowerCase();r&&(u=sb(d)?jF:r),ab(d)&&(e=e||HF,h.scrollbars="yes");const p=Object.entries(h).reduce((_,[E,S])=>`${_}${E}=${S},`,"");if(fO(d)&&u!=="_self")return GF(e||"",u),new VT(null);const v=window.open(e||"",u,p);ct(v,t,"popup-blocked");try{v.focus()}catch{}return new VT(v)}function GF(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qF="__/auth/handler",WF="emulator/auth/handler",XF=encodeURIComponent("fac");async function jT(t,e,r,n,a,o){ct(t.config.authDomain,t,"auth-domain-config-required"),ct(t.config.apiKey,t,"invalid-api-key");const l={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Il,eventId:a};if(e instanceof gb){e.setDefaultLanguage(t.languageCode),l.providerId=e.providerId||"",mR(e.getCustomParameters())||(l.customParameters=JSON.stringify(e.getCustomParameters()));for(const[p,v]of Object.entries({}))l[p]=v}if(e instanceof T0){const p=e.getScopes().filter(v=>v!=="");p.length>0&&(l.scopes=p.join(","))}t.tenantId&&(l.tid=t.tenantId);const u=l;for(const p of Object.keys(u))u[p]===void 0&&delete u[p];const h=await t._getAppCheckToken(),d=h?`#${XF}=${encodeURIComponent(h)}`:"";return`${KF(t)}?${f0(u).slice(1)}${d}`}function KF({config:t}){return t.emulator?Yx(t,WF):`https://${t.authDomain}/${qF}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kg="webStorageSupport";class YF{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=wb,this._completeRedirectFn=_F,this._overrideRedirectResult=gF}async _openPopup(e,r,n,a){var o;xs((o=this.eventManagers[e._key()])===null||o===void 0?void 0:o.manager,"_initialize() not called before _openPopup()");const l=await jT(e,r,n,V1(),a);return zF(e,l,ev())}async _openRedirect(e,r,n,a){await this._originValidation(e);const o=await jT(e,r,n,V1(),a);return ZO(o),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:a,promise:o}=this.eventManagers[r];return a?Promise.resolve(a):(xs(o,"If manager is not set, promise should be"),o)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await LF(e),n=new EF(e);return r.register("authEvent",a=>(ct(a==null?void 0:a.authEvent,e,"invalid-auth-event"),{status:n.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(Kg,{type:Kg},a=>{var o;const l=(o=a==null?void 0:a[0])===null||o===void 0?void 0:o[Kg];l!==void 0&&r(!!l),ai(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=bF(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return fb()||ib()||Qx()}}const $F=YF;var HT="@firebase/auth",zT="1.10.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QF{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){ct(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZF(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function JF(t){xl(new ho("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:l,authDomain:u}=n.options;ct(l&&!l.includes(":"),"invalid-api-key",{appName:n.name});const h={apiKey:l,authDomain:u,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:hb(t)},d=new xO(n,a,o,h);return kO(d,r),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),xl(new ho("auth-internal",e=>{const r=Ol(e.getProvider("auth").getImmediate());return(n=>new QF(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ri(HT,zT,ZF(t)),Ri(HT,zT,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e8=5*60,t8=gS("authIdTokenMaxAge")||e8;let GT=null;const r8=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>t8)return;const a=r==null?void 0:r.token;GT!==a&&(GT=a,await fetch(t,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function Ib(t=hx()){const e=sm(t,"auth");if(e.isInitialized())return e.getImmediate();const r=bO(t,{popupRedirectResolver:$F,persistence:[oF,YO,wb]}),n=gS("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(n,location.origin);if(location.origin===o.origin){const l=r8(o.toString());qO(r,l,()=>l(r.currentUser)),GO(r,u=>l(u))}}const a=dS("auth");return a&&CO(r,`http://${a}`),r}function n8(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}vO({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=a=>{const o=Fi("internal-error");o.customData=a,r(o)},n.type="text/javascript",n.charset="UTF-8",n8().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});JF("Browser");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nb="firebasestorage.googleapis.com",Db="storageBucket",a8=2*60*1e3,i8=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rr extends Ui{constructor(e,r,n=0){super(Yg(e),`Firebase Storage: ${r} (${Yg(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Rr.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Yg(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var kr;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(kr||(kr={}));function Yg(t){return"storage/"+t}function rv(){const t="An unknown error occurred, please check the error payload for server response.";return new Rr(kr.UNKNOWN,t)}function s8(t){return new Rr(kr.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function o8(t){return new Rr(kr.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function l8(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Rr(kr.UNAUTHENTICATED,t)}function c8(){return new Rr(kr.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function u8(t){return new Rr(kr.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function f8(){return new Rr(kr.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function h8(){return new Rr(kr.CANCELED,"User canceled the upload/download.")}function d8(t){return new Rr(kr.INVALID_URL,"Invalid URL '"+t+"'.")}function m8(t){return new Rr(kr.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function p8(){return new Rr(kr.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Db+"' property when initializing the app?")}function g8(){return new Rr(kr.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function x8(){return new Rr(kr.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function v8(t){return new Rr(kr.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function q1(t){return new Rr(kr.INVALID_ARGUMENT,t)}function Ob(){return new Rr(kr.APP_DELETED,"The Firebase app was deleted.")}function _8(t){return new Rr(kr.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Df(t,e){return new Rr(kr.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function df(t){throw new Rr(kr.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ya{constructor(e,r){this.bucket=e,this.path_=r}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,r){let n;try{n=ya.makeFromUrl(e,r)}catch{return new ya(e,"")}if(n.path==="")return n;throw m8(e)}static makeFromUrl(e,r){let n=null;const a="([A-Za-z0-9.\\-_]+)";function o(z){z.path.charAt(z.path.length-1)==="/"&&(z.path_=z.path_.slice(0,-1))}const l="(/(.*))?$",u=new RegExp("^gs://"+a+l,"i"),h={bucket:1,path:3};function d(z){z.path_=decodeURIComponent(z.path)}const p="v[A-Za-z0-9_]+",v=r.replace(/[.]/g,"\\."),_="(/([^?#]*).*)?$",E=new RegExp(`^https?://${v}/${p}/b/${a}/o${_}`,"i"),S={bucket:1,path:3},y=r===Nb?"(?:storage.googleapis.com|storage.cloud.google.com)":r,w="([^?#]*)",P=new RegExp(`^https?://${y}/${a}/${w}`,"i"),N=[{regex:u,indices:h,postModify:o},{regex:E,indices:S,postModify:d},{regex:P,indices:{bucket:1,path:2},postModify:d}];for(let z=0;z<N.length;z++){const q=N[z],Z=q.regex.exec(e);if(Z){const C=Z[q.indices.bucket];let I=Z[q.indices.path];I||(I=""),n=new ya(C,I),q.postModify(n);break}}if(n==null)throw d8(e);return n}}class y8{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E8(t,e,r){let n=1,a=null,o=null,l=!1,u=0;function h(){return u===2}let d=!1;function p(...w){d||(d=!0,e.apply(null,w))}function v(w){a=setTimeout(()=>{a=null,t(E,h())},w)}function _(){o&&clearTimeout(o)}function E(w,...P){if(d){_();return}if(w){_(),p.call(null,w,...P);return}if(h()||l){_(),p.call(null,w,...P);return}n<64&&(n*=2);let N;u===1?(u=2,N=0):N=(n+Math.random())*1e3,v(N)}let S=!1;function y(w){S||(S=!0,_(),!d&&(a!==null?(w||(u=2),clearTimeout(a),v(0)):w||(u=1)))}return v(0),o=setTimeout(()=>{l=!0,y(!0)},r),y}function T8(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w8(t){return t!==void 0}function S8(t){return typeof t=="object"&&!Array.isArray(t)}function nv(t){return typeof t=="string"||t instanceof String}function qT(t){return av()&&t instanceof Blob}function av(){return typeof Blob<"u"}function WT(t,e,r,n){if(n<e)throw q1(`Invalid value for '${t}'. Expected ${e} or greater.`);if(n>r)throw q1(`Invalid value for '${t}'. Expected ${r} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iv(t,e,r){let n=e;return r==null&&(n=`https://${e}`),`${r}://${n}/v0${t}`}function Fb(t){const e=encodeURIComponent;let r="?";for(const n in t)if(t.hasOwnProperty(n)){const a=e(n)+"="+e(t[n]);r=r+a+"&"}return r=r.slice(0,-1),r}var fl;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(fl||(fl={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A8(t,e){const r=t>=500&&t<600,a=[408,429].indexOf(t)!==-1,o=e.indexOf(t)!==-1;return r||a||o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b8{constructor(e,r,n,a,o,l,u,h,d,p,v,_=!0,E=!1){this.url_=e,this.method_=r,this.headers_=n,this.body_=a,this.successCodes_=o,this.additionalRetryCodes_=l,this.callback_=u,this.errorCallback_=h,this.timeout_=d,this.progressCallback_=p,this.connectionFactory_=v,this.retry=_,this.isUsingEmulator=E,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((S,y)=>{this.resolve_=S,this.reject_=y,this.start_()})}start_(){const e=(n,a)=>{if(a){n(!1,new rd(!1,null,!0));return}const o=this.connectionFactory_();this.pendingConnection_=o;const l=u=>{const h=u.loaded,d=u.lengthComputable?u.total:-1;this.progressCallback_!==null&&this.progressCallback_(h,d)};this.progressCallback_!==null&&o.addUploadProgressListener(l),o.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&o.removeUploadProgressListener(l),this.pendingConnection_=null;const u=o.getErrorCode()===fl.NO_ERROR,h=o.getStatus();if(!u||A8(h,this.additionalRetryCodes_)&&this.retry){const p=o.getErrorCode()===fl.ABORT;n(!1,new rd(!1,null,p));return}const d=this.successCodes_.indexOf(h)!==-1;n(!0,new rd(d,o))})},r=(n,a)=>{const o=this.resolve_,l=this.reject_,u=a.connection;if(a.wasSuccessCode)try{const h=this.callback_(u,u.getResponse());w8(h)?o(h):o()}catch(h){l(h)}else if(u!==null){const h=rv();h.serverResponse=u.getErrorText(),this.errorCallback_?l(this.errorCallback_(u,h)):l(h)}else if(a.canceled){const h=this.appDelete_?Ob():h8();l(h)}else{const h=f8();l(h)}};this.canceled_?r(!1,new rd(!1,null,!0)):this.backoffId_=E8(e,r,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&T8(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class rd{constructor(e,r,n){this.wasSuccessCode=e,this.connection=r,this.canceled=!!n}}function k8(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function C8(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function R8(t,e){e&&(t["X-Firebase-GMPID"]=e)}function I8(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function N8(t,e,r,n,a,o,l=!0,u=!1){const h=Fb(t.urlParams),d=t.url+h,p=Object.assign({},t.headers);return R8(p,e),k8(p,r),C8(p,o),I8(p,n),new b8(d,t.method,p,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,a,l,u)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D8(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function O8(...t){const e=D8();if(e!==void 0){const r=new e;for(let n=0;n<t.length;n++)r.append(t[n]);return r.getBlob()}else{if(av())return new Blob(t);throw new Rr(kr.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function F8(t,e,r){return t.webkitSlice?t.webkitSlice(e,r):t.mozSlice?t.mozSlice(e,r):t.slice?t.slice(e,r):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P8(t){if(typeof atob>"u")throw v8("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ki={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class $g{constructor(e,r){this.data=e,this.contentType=r||null}}function M8(t,e){switch(t){case ki.RAW:return new $g(Pb(e));case ki.BASE64:case ki.BASE64URL:return new $g(Mb(t,e));case ki.DATA_URL:return new $g(U8(e),B8(e))}throw rv()}function Pb(t){const e=[];for(let r=0;r<t.length;r++){let n=t.charCodeAt(r);if(n<=127)e.push(n);else if(n<=2047)e.push(192|n>>6,128|n&63);else if((n&64512)===55296)if(!(r<t.length-1&&(t.charCodeAt(r+1)&64512)===56320))e.push(239,191,189);else{const o=n,l=t.charCodeAt(++r);n=65536|(o&1023)<<10|l&1023,e.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|n&63)}else(n&64512)===56320?e.push(239,191,189):e.push(224|n>>12,128|n>>6&63,128|n&63)}return new Uint8Array(e)}function L8(t){let e;try{e=decodeURIComponent(t)}catch{throw Df(ki.DATA_URL,"Malformed data URL.")}return Pb(e)}function Mb(t,e){switch(t){case ki.BASE64:{const a=e.indexOf("-")!==-1,o=e.indexOf("_")!==-1;if(a||o)throw Df(t,"Invalid character '"+(a?"-":"_")+"' found: is it base64url encoded?");break}case ki.BASE64URL:{const a=e.indexOf("+")!==-1,o=e.indexOf("/")!==-1;if(a||o)throw Df(t,"Invalid character '"+(a?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let r;try{r=P8(e)}catch(a){throw a.message.includes("polyfill")?a:Df(t,"Invalid character found")}const n=new Uint8Array(r.length);for(let a=0;a<r.length;a++)n[a]=r.charCodeAt(a);return n}class Lb{constructor(e){this.base64=!1,this.contentType=null;const r=e.match(/^data:([^,]+)?,/);if(r===null)throw Df(ki.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=r[1]||null;n!=null&&(this.base64=V8(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=e.substring(e.indexOf(",")+1)}}function U8(t){const e=new Lb(t);return e.base64?Mb(ki.BASE64,e.rest):L8(e.rest)}function B8(t){return new Lb(t).contentType}function V8(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ro{constructor(e,r){let n=0,a="";qT(e)?(this.data_=e,n=e.size,a=e.type):e instanceof ArrayBuffer?(r?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(r?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=a}size(){return this.size_}type(){return this.type_}slice(e,r){if(qT(this.data_)){const n=this.data_,a=F8(n,e,r);return a===null?null:new ro(a)}else{const n=new Uint8Array(this.data_.buffer,e,r-e);return new ro(n,!0)}}static getBlob(...e){if(av()){const r=e.map(n=>n instanceof ro?n.data_:n);return new ro(O8.apply(null,r))}else{const r=e.map(l=>nv(l)?M8(ki.RAW,l).data:l.data_);let n=0;r.forEach(l=>{n+=l.byteLength});const a=new Uint8Array(n);let o=0;return r.forEach(l=>{for(let u=0;u<l.length;u++)a[o++]=l[u]}),new ro(a,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ub(t){let e;try{e=JSON.parse(t)}catch{return null}return S8(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j8(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function H8(t,e){const r=e.split("/").filter(n=>n.length>0).join("/");return t.length===0?r:t+"/"+r}function Bb(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z8(t,e){return e}class zn{constructor(e,r,n,a){this.server=e,this.local=r||e,this.writable=!!n,this.xform=a||z8}}let nd=null;function G8(t){return!nv(t)||t.length<2?t:Bb(t)}function Vb(){if(nd)return nd;const t=[];t.push(new zn("bucket")),t.push(new zn("generation")),t.push(new zn("metageneration")),t.push(new zn("name","fullPath",!0));function e(o,l){return G8(l)}const r=new zn("name");r.xform=e,t.push(r);function n(o,l){return l!==void 0?Number(l):l}const a=new zn("size");return a.xform=n,t.push(a),t.push(new zn("timeCreated")),t.push(new zn("updated")),t.push(new zn("md5Hash",null,!0)),t.push(new zn("cacheControl",null,!0)),t.push(new zn("contentDisposition",null,!0)),t.push(new zn("contentEncoding",null,!0)),t.push(new zn("contentLanguage",null,!0)),t.push(new zn("contentType",null,!0)),t.push(new zn("metadata","customMetadata",!0)),nd=t,nd}function q8(t,e){function r(){const n=t.bucket,a=t.fullPath,o=new ya(n,a);return e._makeStorageReference(o)}Object.defineProperty(t,"ref",{get:r})}function W8(t,e,r){const n={};n.type="file";const a=r.length;for(let o=0;o<a;o++){const l=r[o];n[l.local]=l.xform(n,e[l.server])}return q8(n,t),n}function jb(t,e,r){const n=Ub(e);return n===null?null:W8(t,n,r)}function X8(t,e,r,n){const a=Ub(e);if(a===null||!nv(a.downloadTokens))return null;const o=a.downloadTokens;if(o.length===0)return null;const l=encodeURIComponent;return o.split(",").map(d=>{const p=t.bucket,v=t.fullPath,_="/b/"+l(p)+"/o/"+l(v),E=iv(_,r,n),S=Fb({alt:"media",token:d});return E+S})[0]}function K8(t,e){const r={},n=e.length;for(let a=0;a<n;a++){const o=e[a];o.writable&&(r[o.server]=t[o.local])}return JSON.stringify(r)}class Hb{constructor(e,r,n,a){this.url=e,this.method=r,this.handler=n,this.timeout=a,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zb(t){if(!t)throw rv()}function Y8(t,e){function r(n,a){const o=jb(t,a,e);return zb(o!==null),o}return r}function $8(t,e){function r(n,a){const o=jb(t,a,e);return zb(o!==null),X8(o,a,t.host,t._protocol)}return r}function Gb(t){function e(r,n){let a;return r.getStatus()===401?r.getErrorText().includes("Firebase App Check token is invalid")?a=c8():a=l8():r.getStatus()===402?a=o8(t.bucket):r.getStatus()===403?a=u8(t.path):a=n,a.status=r.getStatus(),a.serverResponse=n.serverResponse,a}return e}function Q8(t){const e=Gb(t);function r(n,a){let o=e(n,a);return n.getStatus()===404&&(o=s8(t.path)),o.serverResponse=a.serverResponse,o}return r}function Z8(t,e,r){const n=e.fullServerUrl(),a=iv(n,t.host,t._protocol),o="GET",l=t.maxOperationRetryTime,u=new Hb(a,o,$8(t,r),l);return u.errorHandler=Q8(e),u}function J8(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function e5(t,e,r){const n=Object.assign({},r);return n.fullPath=t.path,n.size=e.size(),n.contentType||(n.contentType=J8(null,e)),n}function t5(t,e,r,n,a){const o=e.bucketOnlyServerUrl(),l={"X-Goog-Upload-Protocol":"multipart"};function u(){let N="";for(let z=0;z<2;z++)N=N+Math.random().toString().slice(2);return N}const h=u();l["Content-Type"]="multipart/related; boundary="+h;const d=e5(e,n,a),p=K8(d,r),v="--"+h+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+p+`\r
--`+h+`\r
Content-Type: `+d.contentType+`\r
\r
`,_=`\r
--`+h+"--",E=ro.getBlob(v,n,_);if(E===null)throw g8();const S={name:d.fullPath},y=iv(o,t.host,t._protocol),w="POST",P=t.maxUploadRetryTime,B=new Hb(y,w,Y8(t,r),P);return B.urlParams=S,B.headers=l,B.body=E.uploadData(),B.errorHandler=Gb(e),B}class r5{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=fl.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=fl.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=fl.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,r,n,a,o){if(this.sent_)throw df("cannot .send() more than once");if(Ao(e)&&n&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(r,e,!0),o!==void 0)for(const l in o)o.hasOwnProperty(l)&&this.xhr_.setRequestHeader(l,o[l].toString());return a!==void 0?this.xhr_.send(a):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw df("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw df("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw df("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw df("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class n5 extends r5{initXhr(){this.xhr_.responseType="text"}}function qb(){return new n5}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wl{constructor(e,r){this._service=e,r instanceof ya?this._location=r:this._location=ya.makeFromUrl(r,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,r){return new wl(e,r)}get root(){const e=new ya(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Bb(this._location.path)}get storage(){return this._service}get parent(){const e=j8(this._location.path);if(e===null)return null;const r=new ya(this._location.bucket,e);return new wl(this._service,r)}_throwIfRoot(e){if(this._location.path==="")throw _8(e)}}function a5(t,e,r){t._throwIfRoot("uploadBytes");const n=t5(t.storage,t._location,Vb(),new ro(e,!0),r);return t.storage.makeRequestWithTokens(n,qb).then(a=>({metadata:a,ref:t}))}function i5(t){t._throwIfRoot("getDownloadURL");const e=Z8(t.storage,t._location,Vb());return t.storage.makeRequestWithTokens(e,qb).then(r=>{if(r===null)throw x8();return r})}function s5(t,e){const r=H8(t._location.path,e),n=new ya(t._location.bucket,r);return new wl(t.storage,n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o5(t){return/^[A-Za-z]+:\/\//.test(t)}function l5(t,e){return new wl(t,e)}function Wb(t,e){if(t instanceof sv){const r=t;if(r._bucket==null)throw p8();const n=new wl(r,r._bucket);return e!=null?Wb(n,e):n}else return e!==void 0?s5(t,e):t}function c5(t,e){if(e&&o5(e)){if(t instanceof sv)return l5(t,e);throw q1("To use ref(service, url), the first argument must be a Storage instance.")}else return Wb(t,e)}function XT(t,e){const r=e==null?void 0:e[Db];return r==null?null:ya.makeFromBucketSpec(r,t)}function u5(t,e,r,n={}){t.host=`${e}:${r}`;const a=Ao(e);a&&(ox(`https://${t.host}/b`),lx("Storage",!0)),t._isUsingEmulator=!0,t._protocol=a?"https":"http";const{mockUserToken:o}=n;o&&(t._overrideAuthToken=typeof o=="string"?o:xS(o,t.app.options.projectId))}class sv{constructor(e,r,n,a,o,l=!1){this.app=e,this._authProvider=r,this._appCheckProvider=n,this._url=a,this._firebaseVersion=o,this._isUsingEmulator=l,this._bucket=null,this._host=Nb,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=a8,this._maxUploadRetryTime=i8,this._requests=new Set,a!=null?this._bucket=ya.makeFromBucketSpec(a,this._host):this._bucket=XT(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=ya.makeFromBucketSpec(this._url,e):this._bucket=XT(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){WT("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){WT("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const r=await e.getToken();if(r!==null)return r.accessToken}return null}async _getAppCheckToken(){if(ga(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new wl(this,e)}_makeRequest(e,r,n,a,o=!0){if(this._deleted)return new y8(Ob());{const l=N8(e,this._appId,n,a,r,this._firebaseVersion,o,this._isUsingEmulator);return this._requests.add(l),l.getPromise().then(()=>this._requests.delete(l),()=>this._requests.delete(l)),l}}async makeRequestWithTokens(e,r){const[n,a]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,r,n,a).getPromise()}}const KT="@firebase/storage",YT="0.13.14";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xb="storage";function f5(t,e,r){return t=br(t),a5(t,e,r)}function h5(t){return t=br(t),i5(t)}function d5(t,e){return t=br(t),c5(t,e)}function m5(t=hx(),e){t=br(t);const n=sm(t,Xb).getImmediate({identifier:e}),a=mS("storage");return a&&p5(n,...a),n}function p5(t,e,r,n={}){u5(t,e,r,n)}function g5(t,{instanceIdentifier:e}){const r=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),a=t.getProvider("app-check-internal");return new sv(r,n,a,e,Il)}function x5(){xl(new ho(Xb,g5,"PUBLIC").setMultipleInstances(!0)),Ri(KT,YT,""),Ri(KT,YT,"esm2017")}x5();const Kb={apiKey:"AIzaSyA1pcLUIXvnOO3Zgn9FQ5J02nOkjVpxYXU",authDomain:"licencas-a47f9.firebaseapp.com",projectId:"licencas-a47f9",storageBucket:"licencas-a47f9.firebasestorage.app",messagingSenderId:"738531068737",appId:"1:738531068737:web:0cc6a20e42a7e118e72fc0",measurementId:"G-JGXM1WF3P4"},ov=fx(Kb),Wn=b6(ov),Ef=Ib(ov),v5=m5(ov),bm=({className:t="h-6 w-6"})=>A.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})}),km=({className:t="h-5 w-5"})=>A.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),S0=({className:t="h-5 w-5"})=>A.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),Yb=({className:t="h-6 w-6"})=>A.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2a1 1 0 01-.293.707l-6.414 6.414A1 1 0 0013 13.414V19a1 1 0 01-1.447.894l-4-2A1 1 0 017 17v-3.586a1 1 0 00-.293-.707L3.293 6.707A1 1 0 013 6V4z"})}),_5=({className:t="h-6 w-6"})=>A.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 17v2a2 2 0 002 2h12a2 2 0 002-2v-2"}),A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 12l4-4m0 0l4 4m-4-4v9"})]}),y5=({className:t="h-6 w-6"})=>A.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[A.jsx("rect",{x:"3",y:"4",width:"4",height:"16",rx:"1"}),A.jsx("rect",{x:"9",y:"4",width:"4",height:"16",rx:"1"}),A.jsx("rect",{x:"15",y:"4",width:"4",height:"16",rx:"1"})]});/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Wd={};Wd.version="0.18.5";var $b=1252,E5=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],lv={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},cv=function(t){E5.indexOf(t)!=-1&&($b=lv[0]=t)};function T5(){cv(1252)}var Za=function(t){cv(t)};function uv(){Za(1200),T5()}function $T(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function w5(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function Qb(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var Tf=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?w5(t.slice(2)):e==254&&r==255?Qb(t.slice(2)):e==65279?t.slice(1):t},ad=function(e){return String.fromCharCode(e)},QT=function(e){return String.fromCharCode(e)},$f,ao="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Qf(t){for(var e="",r=0,n=0,a=0,o=0,l=0,u=0,h=0,d=0;d<t.length;)r=t.charCodeAt(d++),o=r>>2,n=t.charCodeAt(d++),l=(r&3)<<4|n>>4,a=t.charCodeAt(d++),u=(n&15)<<2|a>>6,h=a&63,isNaN(n)?u=h=64:isNaN(a)&&(h=64),e+=ao.charAt(o)+ao.charAt(l)+ao.charAt(u)+ao.charAt(h);return e}function Ea(t){var e="",r=0,n=0,a=0,o=0,l=0,u=0,h=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<t.length;)o=ao.indexOf(t.charAt(d++)),l=ao.indexOf(t.charAt(d++)),r=o<<2|l>>4,e+=String.fromCharCode(r),u=ao.indexOf(t.charAt(d++)),n=(l&15)<<4|u>>2,u!==64&&(e+=String.fromCharCode(n)),h=ao.indexOf(t.charAt(d++)),a=(u&3)<<6|h,h!==64&&(e+=String.fromCharCode(a));return e}var bt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),_s=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Eo(t){return bt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function ZT(t){return bt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var xa=function(e){return bt?_s(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Cm(t){if(typeof ArrayBuffer>"u")return xa(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function Io(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function S5(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function fv(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return fv(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var fn=bt?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:_s(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),a=0;for(e=0,r=0;e<t.length;r+=a,++e)if(a=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function A5(t){for(var e=[],r=0,n=t.length+250,a=Eo(t.length+255),o=0;o<t.length;++o){var l=t.charCodeAt(o);if(l<128)a[r++]=l;else if(l<2048)a[r++]=192|l>>6&31,a[r++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var u=t.charCodeAt(++o)&1023;a[r++]=240|l>>8&7,a[r++]=128|l>>2&63,a[r++]=128|u>>6&15|(l&3)<<4,a[r++]=128|u&63}else a[r++]=224|l>>12&15,a[r++]=128|l>>6&63,a[r++]=128|l&63;r>n&&(e.push(a.slice(0,r)),r=0,a=Eo(65535),n=65530)}return e.push(a.slice(0,r)),fn(e)}var Xn=/\u0000/g,wf=/[\u0001-\u0006]/g;function zc(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Ja(t,e){var r=""+t;return r.length>=e?r:Sr("0",e-r.length)+r}function hv(t,e){var r=""+t;return r.length>=e?r:Sr(" ",e-r.length)+r}function Xd(t,e){var r=""+t;return r.length>=e?r:r+Sr(" ",e-r.length)}function b5(t,e){var r=""+Math.round(t);return r.length>=e?r:Sr("0",e-r.length)+r}function k5(t,e){var r=""+t;return r.length>=e?r:Sr("0",e-r.length)+r}var JT=Math.pow(2,32);function kc(t,e){if(t>JT||t<-JT)return b5(t,e);var r=Math.round(t);return k5(r,e)}function Kd(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var ew=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Qg=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function C5(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var tt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},tw={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},R5={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Yd(t,e,r){for(var n=t<0?-1:1,a=t*n,o=0,l=1,u=0,h=1,d=0,p=0,v=Math.floor(a);d<e&&(v=Math.floor(a),u=v*l+o,p=v*d+h,!(a-v<5e-8));)a=1/(a-v),o=l,l=u,h=d,d=p;if(p>e&&(d>e?(p=h,u=o):(p=d,u=l)),!r)return[0,n*u,p];var _=Math.floor(n*u/p);return[_,n*u-_*p,p]}function io(t,e,r){if(t>2958465||t<0)return null;var n=t|0,a=Math.floor(86400*(t-n)),o=0,l=[],u={D:n,T:a,u:86400*(t-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),e&&e.date1904&&(n+=1462),u.u>.9999&&(u.u=0,++a==86400&&(u.T=a=0,++n,++u.D)),n===60)l=r?[1317,10,29]:[1900,2,29],o=3;else if(n===0)l=r?[1317,8,29]:[1900,1,0],o=6;else{n>60&&--n;var h=new Date(1900,0,1);h.setDate(h.getDate()+n-1),l=[h.getFullYear(),h.getMonth()+1,h.getDate()],o=h.getDay(),n<60&&(o=(o+6)%7),r&&(o=P5(h,l))}return u.y=l[0],u.m=l[1],u.d=l[2],u.S=a%60,a=Math.floor(a/60),u.M=a%60,a=Math.floor(a/60),u.H=a,u.q=o,u}var Zb=new Date(1899,11,31,0,0,0),I5=Zb.getTime(),N5=new Date(1900,2,1,0,0,0);function Jb(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=N5&&(r+=24*60*60*1e3),(r-(I5+(t.getTimezoneOffset()-Zb.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function dv(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function D5(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function O5(t){var e=t<0?12:11,r=dv(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function F5(t){var e=dv(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function Zf(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=O5(t):e===10?r=t.toFixed(10).substr(0,12):r=F5(t),dv(D5(r.toUpperCase()))}function Sl(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):Zf(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Ta(14,Jb(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function P5(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function M5(t,e,r,n){var a="",o=0,l=0,u=r.y,h,d=0;switch(t){case 98:u=r.y+543;case 121:switch(e.length){case 1:case 2:h=u%100,d=2;break;default:h=u%1e4,d=4;break}break;case 109:switch(e.length){case 1:case 2:h=r.m,d=e.length;break;case 3:return Qg[r.m-1][1];case 5:return Qg[r.m-1][0];default:return Qg[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:h=r.d,d=e.length;break;case 3:return ew[r.q][0];default:return ew[r.q][1]}break;case 104:switch(e.length){case 1:case 2:h=1+(r.H+11)%12,d=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:h=r.H,d=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:h=r.M,d=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Ja(r.S,e.length):(n>=2?l=n===3?1e3:100:l=n===1?10:1,o=Math.round(l*(r.S+r.u)),o>=60*l&&(o=0),e==="s"?o===0?"0":""+o/l:(a=Ja(o,2+n),e==="ss"?a.substr(0,2):"."+a.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":h=r.D*24+r.H;break;case"[m]":case"[mm]":h=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":h=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}d=e.length===3?1:2;break;case 101:h=u,d=1;break}var p=d>0?Ja(h,d):"";return p}function so(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var ek=/%/g;function L5(t,e,r){var n=e.replace(ek,""),a=e.length-n.length;return hs(t,n,r*Math.pow(10,2*a))+Sr("%",a)}function U5(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return hs(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function tk(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+tk(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var o=Math.floor(Math.log(e)*Math.LOG10E)%a;if(o<0&&(o+=a),r=(e/Math.pow(10,o)).toPrecision(n+1+(a+o)%a),r.indexOf("e")===-1){var l=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+o):r+="E+"+(l-o);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,d,p){return h+d+p.substr(0,(a+o)%a)+"."+p.substr(o)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var rk=/# (\?+)( ?)\/( ?)(\d+)/;function B5(t,e,r){var n=parseInt(t[4],10),a=Math.round(e*n),o=Math.floor(a/n),l=a-o*n,u=n;return r+(o===0?"":""+o)+" "+(l===0?Sr(" ",t[1].length+1+t[4].length):hv(l,t[1].length)+t[2]+"/"+t[3]+Ja(u,t[4].length))}function V5(t,e,r){return r+(e===0?"":""+e)+Sr(" ",t[1].length+2+t[4].length)}var nk=/^#*0*\.([0#]+)/,ak=/\).*[0#]/,ik=/\(###\) ###\\?-####/;function Gn(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function rw(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function nw(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function j5(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function H5(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Ma(t,e,r){if(t.charCodeAt(0)===40&&!e.match(ak)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ma("n",n,r):"("+Ma("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return U5(t,e,r);if(e.indexOf("%")!==-1)return L5(t,e,r);if(e.indexOf("E")!==-1)return tk(e,r);if(e.charCodeAt(0)===36)return"$"+Ma(t,e.substr(e.charAt(1)==" "?2:1),r);var a,o,l,u,h=Math.abs(r),d=r<0?"-":"";if(e.match(/^00+$/))return d+kc(h,e.length);if(e.match(/^[#?]+$/))return a=kc(r,0),a==="0"&&(a=""),a.length>e.length?a:Gn(e.substr(0,e.length-a.length))+a;if(o=e.match(rk))return B5(o,h,d);if(e.match(/^#+0+$/))return d+kc(h,e.length-e.indexOf("0"));if(o=e.match(nk))return a=rw(r,o[1].length).replace(/^([^\.]+)$/,"$1."+Gn(o[1])).replace(/\.$/,"."+Gn(o[1])).replace(/\.(\d*)$/,function(S,y){return"."+y+Sr("0",Gn(o[1]).length-y.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),o=e.match(/^(0*)\.(#*)$/))return d+rw(h,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=e.match(/^#{1,3},##0(\.?)$/))return d+so(kc(h,0));if(o=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ma(t,e,-r):so(""+(Math.floor(r)+j5(r,o[1].length)))+"."+Ja(nw(r,o[1].length),o[1].length);if(o=e.match(/^#,#*,#0/))return Ma(t,e.replace(/^#,#*,/,""),r);if(o=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=zc(Ma(t,e.replace(/[\\-]/g,""),r)),l=0,zc(zc(e.replace(/\\/g,"")).replace(/[0#]/g,function(S){return l<a.length?a.charAt(l++):S==="0"?"0":""}));if(e.match(ik))return a=Ma(t,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var p="";if(o=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),u=Yd(h,Math.pow(10,l)-1,!1),a=""+d,p=hs("n",o[1],u[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),a+=p+o[2]+"/"+o[3],p=Xd(u[2],l),p.length<o[4].length&&(p=Gn(o[4].substr(o[4].length-p.length))+p),a+=p,a;if(o=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),u=Yd(h,Math.pow(10,l)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?hv(u[1],l)+o[2]+"/"+o[3]+Xd(u[2],l):Sr(" ",2*l+1+o[2].length+o[3].length));if(o=e.match(/^[#0?]+$/))return a=kc(r,0),e.length<=a.length?a:Gn(e.substr(0,e.length-a.length))+a;if(o=e.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var v=e.indexOf(".")-l,_=e.length-a.length-v;return Gn(e.substr(0,v)+a+e.substr(e.length-_))}if(o=e.match(/^00,000\.([#0]*0)$/))return l=nw(r,o[1].length),r<0?"-"+Ma(t,e,-r):so(H5(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(S){return"00,"+(S.length<3?Ja(0,3-S.length):"")+S})+"."+Ja(l,o[1].length);switch(e){case"###,##0.00":return Ma(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var E=so(kc(h,0));return E!=="0"?d+E:"";case"###,###.00":return Ma(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Ma(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function z5(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return hs(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function G5(t,e,r){var n=e.replace(ek,""),a=e.length-n.length;return hs(t,n,r*Math.pow(10,2*a))+Sr("%",a)}function sk(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+sk(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var o=Math.floor(Math.log(e)*Math.LOG10E)%a;if(o<0&&(o+=a),r=(e/Math.pow(10,o)).toPrecision(n+1+(a+o)%a),!r.match(/[Ee]/)){var l=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+o):r+="E+"+(l-o),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,d,p){return h+d+p.substr(0,(a+o)%a)+"."+p.substr(o)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function wi(t,e,r){if(t.charCodeAt(0)===40&&!e.match(ak)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?wi("n",n,r):"("+wi("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return z5(t,e,r);if(e.indexOf("%")!==-1)return G5(t,e,r);if(e.indexOf("E")!==-1)return sk(e,r);if(e.charCodeAt(0)===36)return"$"+wi(t,e.substr(e.charAt(1)==" "?2:1),r);var a,o,l,u,h=Math.abs(r),d=r<0?"-":"";if(e.match(/^00+$/))return d+Ja(h,e.length);if(e.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>e.length?a:Gn(e.substr(0,e.length-a.length))+a;if(o=e.match(rk))return V5(o,h,d);if(e.match(/^#+0+$/))return d+Ja(h,e.length-e.indexOf("0"));if(o=e.match(nk))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Gn(o[1])).replace(/\.$/,"."+Gn(o[1])),a=a.replace(/\.(\d*)$/,function(S,y){return"."+y+Sr("0",Gn(o[1]).length-y.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),o=e.match(/^(0*)\.(#*)$/))return d+(""+h).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=e.match(/^#{1,3},##0(\.?)$/))return d+so(""+h);if(o=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+wi(t,e,-r):so(""+r)+"."+Sr("0",o[1].length);if(o=e.match(/^#,#*,#0/))return wi(t,e.replace(/^#,#*,/,""),r);if(o=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=zc(wi(t,e.replace(/[\\-]/g,""),r)),l=0,zc(zc(e.replace(/\\/g,"")).replace(/[0#]/g,function(S){return l<a.length?a.charAt(l++):S==="0"?"0":""}));if(e.match(ik))return a=wi(t,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var p="";if(o=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),u=Yd(h,Math.pow(10,l)-1,!1),a=""+d,p=hs("n",o[1],u[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),a+=p+o[2]+"/"+o[3],p=Xd(u[2],l),p.length<o[4].length&&(p=Gn(o[4].substr(o[4].length-p.length))+p),a+=p,a;if(o=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),u=Yd(h,Math.pow(10,l)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?hv(u[1],l)+o[2]+"/"+o[3]+Xd(u[2],l):Sr(" ",2*l+1+o[2].length+o[3].length));if(o=e.match(/^[#0?]+$/))return a=""+r,e.length<=a.length?a:Gn(e.substr(0,e.length-a.length))+a;if(o=e.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var v=e.indexOf(".")-l,_=e.length-a.length-v;return Gn(e.substr(0,v)+a+e.substr(e.length-_))}if(o=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+wi(t,e,-r):so(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(S){return"00,"+(S.length<3?Ja(0,3-S.length):"")+S})+"."+Ja(0,o[1].length);switch(e){case"###,###":case"##,###":case"#,###":var E=so(""+h);return E!=="0"?d+E:"";default:if(e.match(/\.[0#?]*$/))return wi(t,e.slice(0,e.lastIndexOf(".")),r)+Gn(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function hs(t,e,r){return(r|0)===r?wi(t,e,r):Ma(t,e,r)}function q5(t){for(var e=[],r=!1,n=0,a=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(a,n-a),a=n+1}if(e[e.length]=t.substr(a),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var ok=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Fl(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Kd(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(ok))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function W5(t,e,r,n){for(var a=[],o="",l=0,u="",h="t",d,p,v,_="H";l<t.length;)switch(u=t.charAt(l)){case"G":if(!Kd(t,l))throw new Error("unrecognized character "+u+" in "+t);a[a.length]={t:"G",v:"General"},l+=7;break;case'"':for(o="";(v=t.charCodeAt(++l))!==34&&l<t.length;)o+=String.fromCharCode(v);a[a.length]={t:"t",v:o},++l;break;case"\\":var E=t.charAt(++l),S=E==="("||E===")"?E:"t";a[a.length]={t:S,v:E},++l;break;case"_":a[a.length]={t:"t",v:" "},l+=2;break;case"@":a[a.length]={t:"T",v:e},++l;break;case"B":case"b":if(t.charAt(l+1)==="1"||t.charAt(l+1)==="2"){if(d==null&&(d=io(e,r,t.charAt(l+1)==="2"),d==null))return"";a[a.length]={t:"X",v:t.substr(l,2)},h=u,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||d==null&&(d=io(e,r),d==null))return"";for(o=u;++l<t.length&&t.charAt(l).toLowerCase()===u;)o+=u;u==="m"&&h.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=_),a[a.length]={t:u,v:o},h=u;break;case"A":case"a":case"":var y={t:u,v:u};if(d==null&&(d=io(e,r)),t.substr(l,3).toUpperCase()==="A/P"?(d!=null&&(y.v=d.H>=12?"P":"A"),y.t="T",_="h",l+=3):t.substr(l,5).toUpperCase()==="AM/PM"?(d!=null&&(y.v=d.H>=12?"PM":"AM"),y.t="T",l+=5,_="h"):t.substr(l,5).toUpperCase()==="/"?(d!=null&&(y.v=d.H>=12?"":""),y.t="T",l+=5,_="h"):(y.t="t",++l),d==null&&y.t==="T")return"";a[a.length]=y,h=u;break;case"[":for(o=u;t.charAt(l++)!=="]"&&l<t.length;)o+=t.charAt(l);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(ok)){if(d==null&&(d=io(e,r),d==null))return"";a[a.length]={t:"Z",v:o.toLowerCase()},h=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",Fl(t)||(a[a.length]={t:"t",v:o}));break;case".":if(d!=null){for(o=u;++l<t.length&&(u=t.charAt(l))==="0";)o+=u;a[a.length]={t:"s",v:o};break}case"0":case"#":for(o=u;++l<t.length&&"0#?.,E+-%".indexOf(u=t.charAt(l))>-1;)o+=u;a[a.length]={t:"n",v:o};break;case"?":for(o=u;t.charAt(++l)===u;)o+=u;a[a.length]={t:u,v:o},h=u;break;case"*":++l,(t.charAt(l)==" "||t.charAt(l)=="*")&&++l;break;case"(":case")":a[a.length]={t:n===1?"t":u,v:u},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=u;l<t.length&&"0123456789".indexOf(t.charAt(++l))>-1;)o+=t.charAt(l);a[a.length]={t:"D",v:o};break;case" ":a[a.length]={t:u,v:u},++l;break;case"$":a[a.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+t);a[a.length]={t:"t",v:u},++l;break}var w=0,P=0,B;for(l=a.length-1,h="t";l>=0;--l)switch(a[l].t){case"h":case"H":a[l].t=_,h="h",w<1&&(w=1);break;case"s":(B=a[l].v.match(/\.0+$/))&&(P=Math.max(P,B[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":h=a[l].t;break;case"m":h==="s"&&(a[l].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&a[l].v.match(/[Hh]/)&&(w=1),w<2&&a[l].v.match(/[Mm]/)&&(w=2),w<3&&a[l].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var N="",z;for(l=0;l<a.length;++l)switch(a[l].t){case"t":case"T":case" ":case"D":break;case"X":a[l].v="",a[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[l].v=M5(a[l].t.charCodeAt(0),a[l].v,d,P),a[l].t="t";break;case"n":case"?":for(z=l+1;a[z]!=null&&((u=a[z].t)==="?"||u==="D"||(u===" "||u==="t")&&a[z+1]!=null&&(a[z+1].t==="?"||a[z+1].t==="t"&&a[z+1].v==="/")||a[l].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(a[z].v==="/"||a[z].v===" "&&a[z+1]!=null&&a[z+1].t=="?"));)a[l].v+=a[z].v,a[z]={v:"",t:";"},++z;N+=a[l].v,l=z-1;break;case"G":a[l].t="t",a[l].v=Sl(e,r);break}var q="",Z,C;if(N.length>0){N.charCodeAt(0)==40?(Z=e<0&&N.charCodeAt(0)===45?-e:e,C=hs("n",N,Z)):(Z=e<0&&n>1?-e:e,C=hs("n",N,Z),Z<0&&a[0]&&a[0].t=="t"&&(C=C.substr(1),a[0].v="-"+a[0].v)),z=C.length-1;var I=a.length;for(l=0;l<a.length;++l)if(a[l]!=null&&a[l].t!="t"&&a[l].v.indexOf(".")>-1){I=l;break}var b=a.length;if(I===a.length&&C.indexOf("E")===-1){for(l=a.length-1;l>=0;--l)a[l]==null||"n?".indexOf(a[l].t)===-1||(z>=a[l].v.length-1?(z-=a[l].v.length,a[l].v=C.substr(z+1,a[l].v.length)):z<0?a[l].v="":(a[l].v=C.substr(0,z+1),z=-1),a[l].t="t",b=l);z>=0&&b<a.length&&(a[b].v=C.substr(0,z+1)+a[b].v)}else if(I!==a.length&&C.indexOf("E")===-1){for(z=C.indexOf(".")-1,l=I;l>=0;--l)if(!(a[l]==null||"n?".indexOf(a[l].t)===-1)){for(p=a[l].v.indexOf(".")>-1&&l===I?a[l].v.indexOf(".")-1:a[l].v.length-1,q=a[l].v.substr(p+1);p>=0;--p)z>=0&&(a[l].v.charAt(p)==="0"||a[l].v.charAt(p)==="#")&&(q=C.charAt(z--)+q);a[l].v=q,a[l].t="t",b=l}for(z>=0&&b<a.length&&(a[b].v=C.substr(0,z+1)+a[b].v),z=C.indexOf(".")+1,l=I;l<a.length;++l)if(!(a[l]==null||"n?(".indexOf(a[l].t)===-1&&l!==I)){for(p=a[l].v.indexOf(".")>-1&&l===I?a[l].v.indexOf(".")+1:0,q=a[l].v.substr(0,p);p<a[l].v.length;++p)z<C.length&&(q+=C.charAt(z++));a[l].v=q,a[l].t="t",b=l}}}for(l=0;l<a.length;++l)a[l]!=null&&"n?".indexOf(a[l].t)>-1&&(Z=n>1&&e<0&&l>0&&a[l-1].v==="-"?-e:e,a[l].v=hs(a[l].t,a[l].v,Z),a[l].t="t");var O="";for(l=0;l!==a.length;++l)a[l]!=null&&(O+=a[l].v);return O}var aw=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function iw(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function X5(t,e){var r=q5(t),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var o=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,o];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var l=r[0].match(aw),u=r[1].match(aw);return iw(e,l)?[n,r[0]]:iw(e,u)?[n,r[1]]:[n,r[l!=null&&u!=null?2:1]]}return[n,o]}function Ta(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:tt)[t],n==null&&(n=r.table&&r.table[tw[t]]||tt[tw[t]]),n==null&&(n=R5[t]||"General");break}if(Kd(n,0))return Sl(e,r);e instanceof Date&&(e=Jb(e,r.date1904));var a=X5(n,e);if(Kd(a[1]))return Sl(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return W5(a[1],e,r,a[0])}function Mi(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(tt[r]==null){e<0&&(e=r);continue}if(tt[r]==t){e=r;break}}e<0&&(e=391)}return tt[e]=t,e}function A0(t){for(var e=0;e!=392;++e)t[e]!==void 0&&Mi(t[e],e)}function cu(){tt=C5()}var lk={format:Ta,load:Mi,_table:tt,load_table:A0,parse_date_code:io,is_date:Fl,get_table:function(){return lk._table=tt}},K5={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},ck=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Y5(t){var e=typeof t=="number"?tt[t]:t;return e=e.replace(ck,"(\\d+)"),new RegExp("^"+e+"$")}function $5(t,e,r){var n=-1,a=-1,o=-1,l=-1,u=-1,h=-1;(e.match(ck)||[]).forEach(function(v,_){var E=parseInt(r[_+1],10);switch(v.toLowerCase().charAt(0)){case"y":n=E;break;case"d":o=E;break;case"h":l=E;break;case"s":h=E;break;case"m":l>=0?u=E:a=E;break}}),h>=0&&u==-1&&a>=0&&(u=a,a=-1);var d=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var p=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2);return l==-1&&u==-1&&h==-1?d:n==-1&&a==-1&&o==-1?p:d+"T"+p}var Q5=function(){var t={};t.version="1.2.0";function e(){for(var C=0,I=new Array(256),b=0;b!=256;++b)C=b,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,I[b]=C;return typeof Int32Array<"u"?new Int32Array(I):I}var r=e();function n(C){var I=0,b=0,O=0,L=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(O=0;O!=256;++O)L[O]=C[O];for(O=0;O!=256;++O)for(b=C[O],I=256+O;I<4096;I+=256)b=L[I]=b>>>8^C[b&255];var M=[];for(O=1;O!=16;++O)M[O-1]=typeof Int32Array<"u"?L.subarray(O*256,O*256+256):L.slice(O*256,O*256+256);return M}var a=n(r),o=a[0],l=a[1],u=a[2],h=a[3],d=a[4],p=a[5],v=a[6],_=a[7],E=a[8],S=a[9],y=a[10],w=a[11],P=a[12],B=a[13],N=a[14];function z(C,I){for(var b=I^-1,O=0,L=C.length;O<L;)b=b>>>8^r[(b^C.charCodeAt(O++))&255];return~b}function q(C,I){for(var b=I^-1,O=C.length-15,L=0;L<O;)b=N[C[L++]^b&255]^B[C[L++]^b>>8&255]^P[C[L++]^b>>16&255]^w[C[L++]^b>>>24]^y[C[L++]]^S[C[L++]]^E[C[L++]]^_[C[L++]]^v[C[L++]]^p[C[L++]]^d[C[L++]]^h[C[L++]]^u[C[L++]]^l[C[L++]]^o[C[L++]]^r[C[L++]];for(O+=15;L<O;)b=b>>>8^r[(b^C[L++])&255];return~b}function Z(C,I){for(var b=I^-1,O=0,L=C.length,M=0,D=0;O<L;)M=C.charCodeAt(O++),M<128?b=b>>>8^r[(b^M)&255]:M<2048?(b=b>>>8^r[(b^(192|M>>6&31))&255],b=b>>>8^r[(b^(128|M&63))&255]):M>=55296&&M<57344?(M=(M&1023)+64,D=C.charCodeAt(O++)&1023,b=b>>>8^r[(b^(240|M>>8&7))&255],b=b>>>8^r[(b^(128|M>>2&63))&255],b=b>>>8^r[(b^(128|D>>6&15|(M&3)<<4))&255],b=b>>>8^r[(b^(128|D&63))&255]):(b=b>>>8^r[(b^(224|M>>12&15))&255],b=b>>>8^r[(b^(128|M>>6&63))&255],b=b>>>8^r[(b^(128|M&63))&255]);return~b}return t.table=r,t.bstr=z,t.buf=q,t.str=Z,t}(),Je=function(){var e={};e.version="1.2.1";function r(F,Q){for(var H=F.split("/"),G=Q.split("/"),Y=0,J=0,he=Math.min(H.length,G.length);Y<he;++Y){if(J=H[Y].length-G[Y].length)return J;if(H[Y]!=G[Y])return H[Y]<G[Y]?-1:1}return H.length-G.length}function n(F){if(F.charAt(F.length-1)=="/")return F.slice(0,-1).indexOf("/")===-1?F:n(F.slice(0,-1));var Q=F.lastIndexOf("/");return Q===-1?F:F.slice(0,Q+1)}function a(F){if(F.charAt(F.length-1)=="/")return a(F.slice(0,-1));var Q=F.lastIndexOf("/");return Q===-1?F:F.slice(Q+1)}function o(F,Q){typeof Q=="string"&&(Q=new Date(Q));var H=Q.getHours();H=H<<6|Q.getMinutes(),H=H<<5|Q.getSeconds()>>>1,F.write_shift(2,H);var G=Q.getFullYear()-1980;G=G<<4|Q.getMonth()+1,G=G<<5|Q.getDate(),F.write_shift(2,G)}function l(F){var Q=F.read_shift(2)&65535,H=F.read_shift(2)&65535,G=new Date,Y=H&31;H>>>=5;var J=H&15;H>>>=4,G.setMilliseconds(0),G.setFullYear(H+1980),G.setMonth(J-1),G.setDate(Y);var he=Q&31;Q>>>=5;var we=Q&63;return Q>>>=6,G.setHours(Q),G.setMinutes(we),G.setSeconds(he<<1),G}function u(F){_n(F,0);for(var Q={},H=0;F.l<=F.length-4;){var G=F.read_shift(2),Y=F.read_shift(2),J=F.l+Y,he={};switch(G){case 21589:H=F.read_shift(1),H&1&&(he.mtime=F.read_shift(4)),Y>5&&(H&2&&(he.atime=F.read_shift(4)),H&4&&(he.ctime=F.read_shift(4))),he.mtime&&(he.mt=new Date(he.mtime*1e3));break}F.l=J,Q[G]=he}return Q}var h;function d(){return h||(h={})}function p(F,Q){if(F[0]==80&&F[1]==75)return As(F,Q);if((F[0]|32)==109&&(F[1]|32)==105)return jl(F,Q);if(F.length<512)throw new Error("CFB file size "+F.length+" < 512");var H=3,G=512,Y=0,J=0,he=0,we=0,oe=0,ge=[],xe=F.slice(0,512);_n(xe,0);var Pe=v(xe);switch(H=Pe[0],H){case 3:G=512;break;case 4:G=4096;break;case 0:if(Pe[1]==0)return As(F,Q);default:throw new Error("Major Version: Expected 3 or 4 saw "+H)}G!==512&&(xe=F.slice(0,G),_n(xe,28));var Ve=F.slice(0,G);_(xe,H);var Xe=xe.read_shift(4,"i");if(H===3&&Xe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Xe);xe.l+=4,he=xe.read_shift(4,"i"),xe.l+=4,xe.chk("00100000","Mini Stream Cutoff Size: "),we=xe.read_shift(4,"i"),Y=xe.read_shift(4,"i"),oe=xe.read_shift(4,"i"),J=xe.read_shift(4,"i");for(var Me=-1,qe=0;qe<109&&(Me=xe.read_shift(4,"i"),!(Me<0));++qe)ge[qe]=Me;var ft=E(F,G);w(oe,J,ft,G,ge);var zt=B(ft,he,ge,G);zt[he].name="!Directory",Y>0&&we!==D&&(zt[we].name="!MiniFAT"),zt[ge[0]].name="!FAT",zt.fat_addrs=ge,zt.ssz=G;var Pt={},Mt=[],ia=[],li=[];N(he,zt,ft,Mt,Y,Pt,ia,we),S(ia,li,Mt),Mt.shift();var Un={FileIndex:ia,FullPaths:li};return Q&&Q.raw&&(Un.raw={header:Ve,sectors:ft}),Un}function v(F){if(F[F.l]==80&&F[F.l+1]==75)return[0,0];F.chk(Ee,"Header Signature: "),F.l+=16;var Q=F.read_shift(2,"u");return[F.read_shift(2,"u"),Q]}function _(F,Q){var H=9;switch(F.l+=2,H=F.read_shift(2)){case 9:if(Q!=3)throw new Error("Sector Shift: Expected 9 saw "+H);break;case 12:if(Q!=4)throw new Error("Sector Shift: Expected 12 saw "+H);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+H)}F.chk("0600","Mini Sector Shift: "),F.chk("000000000000","Reserved: ")}function E(F,Q){for(var H=Math.ceil(F.length/Q)-1,G=[],Y=1;Y<H;++Y)G[Y-1]=F.slice(Y*Q,(Y+1)*Q);return G[H-1]=F.slice(H*Q),G}function S(F,Q,H){for(var G=0,Y=0,J=0,he=0,we=0,oe=H.length,ge=[],xe=[];G<oe;++G)ge[G]=xe[G]=G,Q[G]=H[G];for(;we<xe.length;++we)G=xe[we],Y=F[G].L,J=F[G].R,he=F[G].C,ge[G]===G&&(Y!==-1&&ge[Y]!==Y&&(ge[G]=ge[Y]),J!==-1&&ge[J]!==J&&(ge[G]=ge[J])),he!==-1&&(ge[he]=G),Y!==-1&&G!=ge[G]&&(ge[Y]=ge[G],xe.lastIndexOf(Y)<we&&xe.push(Y)),J!==-1&&G!=ge[G]&&(ge[J]=ge[G],xe.lastIndexOf(J)<we&&xe.push(J));for(G=1;G<oe;++G)ge[G]===G&&(J!==-1&&ge[J]!==J?ge[G]=ge[J]:Y!==-1&&ge[Y]!==Y&&(ge[G]=ge[Y]));for(G=1;G<oe;++G)if(F[G].type!==0){if(we=G,we!=ge[we])do we=ge[we],Q[G]=Q[we]+"/"+Q[G];while(we!==0&&ge[we]!==-1&&we!=ge[we]);ge[G]=-1}for(Q[0]+="/",G=1;G<oe;++G)F[G].type!==2&&(Q[G]+="/")}function y(F,Q,H){for(var G=F.start,Y=F.size,J=[],he=G;H&&Y>0&&he>=0;)J.push(Q.slice(he*M,he*M+M)),Y-=M,he=cl(H,he*4);return J.length===0?Ae(0):fn(J).slice(0,F.size)}function w(F,Q,H,G,Y){var J=D;if(F===D){if(Q!==0)throw new Error("DIFAT chain shorter than expected")}else if(F!==-1){var he=H[F],we=(G>>>2)-1;if(!he)return;for(var oe=0;oe<we&&(J=cl(he,oe*4))!==D;++oe)Y.push(J);w(cl(he,G-4),Q-1,H,G,Y)}}function P(F,Q,H,G,Y){var J=[],he=[];Y||(Y=[]);var we=G-1,oe=0,ge=0;for(oe=Q;oe>=0;){Y[oe]=!0,J[J.length]=oe,he.push(F[oe]);var xe=H[Math.floor(oe*4/G)];if(ge=oe*4&we,G<4+ge)throw new Error("FAT boundary crossed: "+oe+" 4 "+G);if(!F[xe])break;oe=cl(F[xe],ge)}return{nodes:J,data:xw([he])}}function B(F,Q,H,G){var Y=F.length,J=[],he=[],we=[],oe=[],ge=G-1,xe=0,Pe=0,Ve=0,Xe=0;for(xe=0;xe<Y;++xe)if(we=[],Ve=xe+Q,Ve>=Y&&(Ve-=Y),!he[Ve]){oe=[];var Me=[];for(Pe=Ve;Pe>=0;){Me[Pe]=!0,he[Pe]=!0,we[we.length]=Pe,oe.push(F[Pe]);var qe=H[Math.floor(Pe*4/G)];if(Xe=Pe*4&ge,G<4+Xe)throw new Error("FAT boundary crossed: "+Pe+" 4 "+G);if(!F[qe]||(Pe=cl(F[qe],Xe),Me[Pe]))break}J[Ve]={nodes:we,data:xw([oe])}}return J}function N(F,Q,H,G,Y,J,he,we){for(var oe=0,ge=G.length?2:0,xe=Q[F].data,Pe=0,Ve=0,Xe;Pe<xe.length;Pe+=128){var Me=xe.slice(Pe,Pe+128);_n(Me,64),Ve=Me.read_shift(2),Xe=yv(Me,0,Ve-ge),G.push(Xe);var qe={name:Xe,type:Me.read_shift(1),color:Me.read_shift(1),L:Me.read_shift(4,"i"),R:Me.read_shift(4,"i"),C:Me.read_shift(4,"i"),clsid:Me.read_shift(16),state:Me.read_shift(4,"i"),start:0,size:0},ft=Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2);ft!==0&&(qe.ct=z(Me,Me.l-8));var zt=Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2);zt!==0&&(qe.mt=z(Me,Me.l-8)),qe.start=Me.read_shift(4,"i"),qe.size=Me.read_shift(4,"i"),qe.size<0&&qe.start<0&&(qe.size=qe.type=0,qe.start=D,qe.name=""),qe.type===5?(oe=qe.start,Y>0&&oe!==D&&(Q[oe].name="!StreamData")):qe.size>=4096?(qe.storage="fat",Q[qe.start]===void 0&&(Q[qe.start]=P(H,qe.start,Q.fat_addrs,Q.ssz)),Q[qe.start].name=qe.name,qe.content=Q[qe.start].data.slice(0,qe.size)):(qe.storage="minifat",qe.size<0?qe.size=0:oe!==D&&qe.start!==D&&Q[oe]&&(qe.content=y(qe,Q[oe].data,(Q[we]||{}).data))),qe.content&&_n(qe.content,0),J[Xe]=qe,he.push(qe)}}function z(F,Q){return new Date((pa(F,Q+4)/1e7*Math.pow(2,32)+pa(F,Q)/1e7-11644473600)*1e3)}function q(F,Q){return d(),p(h.readFileSync(F),Q)}function Z(F,Q){var H=Q&&Q.type;switch(H||bt&&Buffer.isBuffer(F)&&(H="buffer"),H||"base64"){case"file":return q(F,Q);case"base64":return p(xa(Ea(F)),Q);case"binary":return p(xa(F),Q)}return p(F,Q)}function C(F,Q){var H=Q||{},G=H.root||"Root Entry";if(F.FullPaths||(F.FullPaths=[]),F.FileIndex||(F.FileIndex=[]),F.FullPaths.length!==F.FileIndex.length)throw new Error("inconsistent CFB structure");F.FullPaths.length===0&&(F.FullPaths[0]=G+"/",F.FileIndex[0]={name:G,type:5}),H.CLSID&&(F.FileIndex[0].clsid=H.CLSID),I(F)}function I(F){var Q="Sh33tJ5";if(!Je.find(F,"/"+Q)){var H=Ae(4);H[0]=55,H[1]=H[3]=50,H[2]=54,F.FileIndex.push({name:Q,type:2,content:H,size:4,L:69,R:69,C:69}),F.FullPaths.push(F.FullPaths[0]+Q),b(F)}}function b(F,Q){C(F);for(var H=!1,G=!1,Y=F.FullPaths.length-1;Y>=0;--Y){var J=F.FileIndex[Y];switch(J.type){case 0:G?H=!0:(F.FileIndex.pop(),F.FullPaths.pop());break;case 1:case 2:case 5:G=!0,isNaN(J.R*J.L*J.C)&&(H=!0),J.R>-1&&J.L>-1&&J.R==J.L&&(H=!0);break;default:H=!0;break}}if(!(!H&&!Q)){var he=new Date(1987,1,19),we=0,oe=Object.create?Object.create(null):{},ge=[];for(Y=0;Y<F.FullPaths.length;++Y)oe[F.FullPaths[Y]]=!0,F.FileIndex[Y].type!==0&&ge.push([F.FullPaths[Y],F.FileIndex[Y]]);for(Y=0;Y<ge.length;++Y){var xe=n(ge[Y][0]);G=oe[xe],G||(ge.push([xe,{name:a(xe).replace("/",""),type:1,clsid:ne,ct:he,mt:he,content:null}]),oe[xe]=!0)}for(ge.sort(function(Xe,Me){return r(Xe[0],Me[0])}),F.FullPaths=[],F.FileIndex=[],Y=0;Y<ge.length;++Y)F.FullPaths[Y]=ge[Y][0],F.FileIndex[Y]=ge[Y][1];for(Y=0;Y<ge.length;++Y){var Pe=F.FileIndex[Y],Ve=F.FullPaths[Y];if(Pe.name=a(Ve).replace("/",""),Pe.L=Pe.R=Pe.C=-(Pe.color=1),Pe.size=Pe.content?Pe.content.length:0,Pe.start=0,Pe.clsid=Pe.clsid||ne,Y===0)Pe.C=ge.length>1?1:-1,Pe.size=0,Pe.type=5;else if(Ve.slice(-1)=="/"){for(we=Y+1;we<ge.length&&n(F.FullPaths[we])!=Ve;++we);for(Pe.C=we>=ge.length?-1:we,we=Y+1;we<ge.length&&n(F.FullPaths[we])!=n(Ve);++we);Pe.R=we>=ge.length?-1:we,Pe.type=1}else n(F.FullPaths[Y+1]||"")==n(Ve)&&(Pe.R=Y+1),Pe.type=2}}}function O(F,Q){var H=Q||{};if(H.fileType=="mad")return lr(F,H);switch(b(F),H.fileType){case"zip":return qa(F,H)}var G=function(Xe){for(var Me=0,qe=0,ft=0;ft<Xe.FileIndex.length;++ft){var zt=Xe.FileIndex[ft];if(zt.content){var Pt=zt.content.length;Pt>0&&(Pt<4096?Me+=Pt+63>>6:qe+=Pt+511>>9)}}for(var Mt=Xe.FullPaths.length+3>>2,ia=Me+7>>3,li=Me+127>>7,Un=ia+qe+Mt+li,$n=Un+127>>7,ci=$n<=109?0:Math.ceil(($n-109)/127);Un+$n+ci+127>>7>$n;)ci=++$n<=109?0:Math.ceil(($n-109)/127);var Bn=[1,ci,$n,li,Mt,qe,Me,0];return Xe.FileIndex[0].size=Me<<6,Bn[7]=(Xe.FileIndex[0].start=Bn[0]+Bn[1]+Bn[2]+Bn[3]+Bn[4]+Bn[5])+(Bn[6]+7>>3),Bn}(F),Y=Ae(G[7]<<9),J=0,he=0;{for(J=0;J<8;++J)Y.write_shift(1,Te[J]);for(J=0;J<8;++J)Y.write_shift(2,0);for(Y.write_shift(2,62),Y.write_shift(2,3),Y.write_shift(2,65534),Y.write_shift(2,9),Y.write_shift(2,6),J=0;J<3;++J)Y.write_shift(2,0);for(Y.write_shift(4,0),Y.write_shift(4,G[2]),Y.write_shift(4,G[0]+G[1]+G[2]+G[3]-1),Y.write_shift(4,0),Y.write_shift(4,4096),Y.write_shift(4,G[3]?G[0]+G[1]+G[2]-1:D),Y.write_shift(4,G[3]),Y.write_shift(-4,G[1]?G[0]-1:D),Y.write_shift(4,G[1]),J=0;J<109;++J)Y.write_shift(-4,J<G[2]?G[1]+J:-1)}if(G[1])for(he=0;he<G[1];++he){for(;J<236+he*127;++J)Y.write_shift(-4,J<G[2]?G[1]+J:-1);Y.write_shift(-4,he===G[1]-1?D:he+1)}var we=function(Xe){for(he+=Xe;J<he-1;++J)Y.write_shift(-4,J+1);Xe&&(++J,Y.write_shift(-4,D))};for(he=J=0,he+=G[1];J<he;++J)Y.write_shift(-4,ue.DIFSECT);for(he+=G[2];J<he;++J)Y.write_shift(-4,ue.FATSECT);we(G[3]),we(G[4]);for(var oe=0,ge=0,xe=F.FileIndex[0];oe<F.FileIndex.length;++oe)xe=F.FileIndex[oe],xe.content&&(ge=xe.content.length,!(ge<4096)&&(xe.start=he,we(ge+511>>9)));for(we(G[6]+7>>3);Y.l&511;)Y.write_shift(-4,ue.ENDOFCHAIN);for(he=J=0,oe=0;oe<F.FileIndex.length;++oe)xe=F.FileIndex[oe],xe.content&&(ge=xe.content.length,!(!ge||ge>=4096)&&(xe.start=he,we(ge+63>>6)));for(;Y.l&511;)Y.write_shift(-4,ue.ENDOFCHAIN);for(J=0;J<G[4]<<2;++J){var Pe=F.FullPaths[J];if(!Pe||Pe.length===0){for(oe=0;oe<17;++oe)Y.write_shift(4,0);for(oe=0;oe<3;++oe)Y.write_shift(4,-1);for(oe=0;oe<12;++oe)Y.write_shift(4,0);continue}xe=F.FileIndex[J],J===0&&(xe.start=xe.size?xe.start-1:D);var Ve=J===0&&H.root||xe.name;if(ge=2*(Ve.length+1),Y.write_shift(64,Ve,"utf16le"),Y.write_shift(2,ge),Y.write_shift(1,xe.type),Y.write_shift(1,xe.color),Y.write_shift(-4,xe.L),Y.write_shift(-4,xe.R),Y.write_shift(-4,xe.C),xe.clsid)Y.write_shift(16,xe.clsid,"hex");else for(oe=0;oe<4;++oe)Y.write_shift(4,0);Y.write_shift(4,xe.state||0),Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(4,xe.start),Y.write_shift(4,xe.size),Y.write_shift(4,0)}for(J=1;J<F.FileIndex.length;++J)if(xe=F.FileIndex[J],xe.size>=4096)if(Y.l=xe.start+1<<9,bt&&Buffer.isBuffer(xe.content))xe.content.copy(Y,Y.l,0,xe.size),Y.l+=xe.size+511&-512;else{for(oe=0;oe<xe.size;++oe)Y.write_shift(1,xe.content[oe]);for(;oe&511;++oe)Y.write_shift(1,0)}for(J=1;J<F.FileIndex.length;++J)if(xe=F.FileIndex[J],xe.size>0&&xe.size<4096)if(bt&&Buffer.isBuffer(xe.content))xe.content.copy(Y,Y.l,0,xe.size),Y.l+=xe.size+63&-64;else{for(oe=0;oe<xe.size;++oe)Y.write_shift(1,xe.content[oe]);for(;oe&63;++oe)Y.write_shift(1,0)}if(bt)Y.l=Y.length;else for(;Y.l<Y.length;)Y.write_shift(1,0);return Y}function L(F,Q){var H=F.FullPaths.map(function(oe){return oe.toUpperCase()}),G=H.map(function(oe){var ge=oe.split("/");return ge[ge.length-(oe.slice(-1)=="/"?2:1)]}),Y=!1;Q.charCodeAt(0)===47?(Y=!0,Q=H[0].slice(0,-1)+Q):Y=Q.indexOf("/")!==-1;var J=Q.toUpperCase(),he=Y===!0?H.indexOf(J):G.indexOf(J);if(he!==-1)return F.FileIndex[he];var we=!J.match(wf);for(J=J.replace(Xn,""),we&&(J=J.replace(wf,"!")),he=0;he<H.length;++he)if((we?H[he].replace(wf,"!"):H[he]).replace(Xn,"")==J||(we?G[he].replace(wf,"!"):G[he]).replace(Xn,"")==J)return F.FileIndex[he];return null}var M=64,D=-2,Ee="d0cf11e0a1b11ae1",Te=[208,207,17,224,161,177,26,225],ne="00000000000000000000000000000000",ue={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:D,FREESECT:-1,HEADER_SIGNATURE:Ee,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ne,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Ue(F,Q,H){d();var G=O(F,H);h.writeFileSync(Q,G)}function ie(F){for(var Q=new Array(F.length),H=0;H<F.length;++H)Q[H]=String.fromCharCode(F[H]);return Q.join("")}function K(F,Q){var H=O(F,Q);switch(Q&&Q.type||"buffer"){case"file":return d(),h.writeFileSync(Q.filename,H),H;case"binary":return typeof H=="string"?H:ie(H);case"base64":return Qf(typeof H=="string"?H:ie(H));case"buffer":if(bt)return Buffer.isBuffer(H)?H:_s(H);case"array":return typeof H=="string"?xa(H):H}return H}var pe;function V(F){try{var Q=F.InflateRaw,H=new Q;if(H._processChunk(new Uint8Array([3,0]),H._finishFlushFlag),H.bytesRead)pe=F;else throw new Error("zlib does not expose bytesRead")}catch(G){console.error("cannot use native zlib: "+(G.message||G))}}function X(F,Q){if(!pe)return ws(F,Q);var H=pe.InflateRaw,G=new H,Y=G._processChunk(F.slice(F.l),G._finishFlushFlag);return F.l+=G.bytesRead,Y}function ee(F){return pe?pe.deflateRawSync(F):_t(F)}var te=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],le=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Ne=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ke(F){var Q=(F<<1|F<<11)&139536|(F<<5|F<<15)&558144;return(Q>>16|Q>>8|Q)&255}for(var Oe=typeof Uint8Array<"u",_e=Oe?new Uint8Array(256):[],Be=0;Be<256;++Be)_e[Be]=ke(Be);function W(F,Q){var H=_e[F&255];return Q<=8?H>>>8-Q:(H=H<<8|_e[F>>8&255],Q<=16?H>>>16-Q:(H=H<<8|_e[F>>16&255],H>>>24-Q))}function nt(F,Q){var H=Q&7,G=Q>>>3;return(F[G]|(H<=6?0:F[G+1]<<8))>>>H&3}function it(F,Q){var H=Q&7,G=Q>>>3;return(F[G]|(H<=5?0:F[G+1]<<8))>>>H&7}function wt(F,Q){var H=Q&7,G=Q>>>3;return(F[G]|(H<=4?0:F[G+1]<<8))>>>H&15}function st(F,Q){var H=Q&7,G=Q>>>3;return(F[G]|(H<=3?0:F[G+1]<<8))>>>H&31}function Le(F,Q){var H=Q&7,G=Q>>>3;return(F[G]|(H<=1?0:F[G+1]<<8))>>>H&127}function ir(F,Q,H){var G=Q&7,Y=Q>>>3,J=(1<<H)-1,he=F[Y]>>>G;return H<8-G||(he|=F[Y+1]<<8-G,H<16-G)||(he|=F[Y+2]<<16-G,H<24-G)||(he|=F[Y+3]<<24-G),he&J}function Lr(F,Q,H){var G=Q&7,Y=Q>>>3;return G<=5?F[Y]|=(H&7)<<G:(F[Y]|=H<<G&255,F[Y+1]=(H&7)>>8-G),Q+3}function Kr(F,Q,H){var G=Q&7,Y=Q>>>3;return H=(H&1)<<G,F[Y]|=H,Q+1}function me(F,Q,H){var G=Q&7,Y=Q>>>3;return H<<=G,F[Y]|=H&255,H>>>=8,F[Y+1]=H,Q+8}function We(F,Q,H){var G=Q&7,Y=Q>>>3;return H<<=G,F[Y]|=H&255,H>>>=8,F[Y+1]=H&255,F[Y+2]=H>>>8,Q+16}function je(F,Q){var H=F.length,G=2*H>Q?2*H:Q+5,Y=0;if(H>=Q)return F;if(bt){var J=ZT(G);if(F.copy)F.copy(J);else for(;Y<F.length;++Y)J[Y]=F[Y];return J}else if(Oe){var he=new Uint8Array(G);if(he.set)he.set(F);else for(;Y<H;++Y)he[Y]=F[Y];return he}return F.length=G,F}function ot(F){for(var Q=new Array(F),H=0;H<F;++H)Q[H]=0;return Q}function Nt(F,Q,H){var G=1,Y=0,J=0,he=0,we=0,oe=F.length,ge=Oe?new Uint16Array(32):ot(32);for(J=0;J<32;++J)ge[J]=0;for(J=oe;J<H;++J)F[J]=0;oe=F.length;var xe=Oe?new Uint16Array(oe):ot(oe);for(J=0;J<oe;++J)ge[Y=F[J]]++,G<Y&&(G=Y),xe[J]=0;for(ge[0]=0,J=1;J<=G;++J)ge[J+16]=we=we+ge[J-1]<<1;for(J=0;J<oe;++J)we=F[J],we!=0&&(xe[J]=ge[we+16]++);var Pe=0;for(J=0;J<oe;++J)if(Pe=F[J],Pe!=0)for(we=W(xe[J],G)>>G-Pe,he=(1<<G+4-Pe)-1;he>=0;--he)Q[we|he<<Pe]=Pe&15|J<<4;return G}var mt=Oe?new Uint16Array(512):ot(512),vt=Oe?new Uint16Array(32):ot(32);if(!Oe){for(var pt=0;pt<512;++pt)mt[pt]=0;for(pt=0;pt<32;++pt)vt[pt]=0}(function(){for(var F=[],Q=0;Q<32;Q++)F.push(5);Nt(F,vt,32);var H=[];for(Q=0;Q<=143;Q++)H.push(8);for(;Q<=255;Q++)H.push(9);for(;Q<=279;Q++)H.push(7);for(;Q<=287;Q++)H.push(8);Nt(H,mt,288)})();var Ft=function(){for(var Q=Oe?new Uint8Array(32768):[],H=0,G=0;H<Ne.length-1;++H)for(;G<Ne[H+1];++G)Q[G]=H;for(;G<32768;++G)Q[G]=29;var Y=Oe?new Uint8Array(259):[];for(H=0,G=0;H<le.length-1;++H)for(;G<le[H+1];++G)Y[G]=H;function J(we,oe){for(var ge=0;ge<we.length;){var xe=Math.min(65535,we.length-ge),Pe=ge+xe==we.length;for(oe.write_shift(1,+Pe),oe.write_shift(2,xe),oe.write_shift(2,~xe&65535);xe-- >0;)oe[oe.l++]=we[ge++]}return oe.l}function he(we,oe){for(var ge=0,xe=0,Pe=Oe?new Uint16Array(32768):[];xe<we.length;){var Ve=Math.min(65535,we.length-xe);if(Ve<10){for(ge=Lr(oe,ge,+(xe+Ve==we.length)),ge&7&&(ge+=8-(ge&7)),oe.l=ge/8|0,oe.write_shift(2,Ve),oe.write_shift(2,~Ve&65535);Ve-- >0;)oe[oe.l++]=we[xe++];ge=oe.l*8;continue}ge=Lr(oe,ge,+(xe+Ve==we.length)+2);for(var Xe=0;Ve-- >0;){var Me=we[xe];Xe=(Xe<<5^Me)&32767;var qe=-1,ft=0;if((qe=Pe[Xe])&&(qe|=xe&-32768,qe>xe&&(qe-=32768),qe<xe))for(;we[qe+ft]==we[xe+ft]&&ft<250;)++ft;if(ft>2){Me=Y[ft],Me<=22?ge=me(oe,ge,_e[Me+1]>>1)-1:(me(oe,ge,3),ge+=5,me(oe,ge,_e[Me-23]>>5),ge+=3);var zt=Me<8?0:Me-4>>2;zt>0&&(We(oe,ge,ft-le[Me]),ge+=zt),Me=Q[xe-qe],ge=me(oe,ge,_e[Me]>>3),ge-=3;var Pt=Me<4?0:Me-2>>1;Pt>0&&(We(oe,ge,xe-qe-Ne[Me]),ge+=Pt);for(var Mt=0;Mt<ft;++Mt)Pe[Xe]=xe&32767,Xe=(Xe<<5^we[xe])&32767,++xe;Ve-=ft-1}else Me<=143?Me=Me+48:ge=Kr(oe,ge,1),ge=me(oe,ge,_e[Me]),Pe[Xe]=xe&32767,++xe}ge=me(oe,ge,0)-1}return oe.l=(ge+7)/8|0,oe.l}return function(oe,ge){return oe.length<8?J(oe,ge):he(oe,ge)}}();function _t(F){var Q=Ae(50+Math.floor(F.length*1.1)),H=Ft(F,Q);return Q.slice(0,H)}var fr=Oe?new Uint16Array(32768):ot(32768),Ur=Oe?new Uint16Array(32768):ot(32768),sr=Oe?new Uint16Array(128):ot(128),Ln=1,Kn=1;function Ts(F,Q){var H=st(F,Q)+257;Q+=5;var G=st(F,Q)+1;Q+=5;var Y=wt(F,Q)+4;Q+=4;for(var J=0,he=Oe?new Uint8Array(19):ot(19),we=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],oe=1,ge=Oe?new Uint8Array(8):ot(8),xe=Oe?new Uint8Array(8):ot(8),Pe=he.length,Ve=0;Ve<Y;++Ve)he[te[Ve]]=J=it(F,Q),oe<J&&(oe=J),ge[J]++,Q+=3;var Xe=0;for(ge[0]=0,Ve=1;Ve<=oe;++Ve)xe[Ve]=Xe=Xe+ge[Ve-1]<<1;for(Ve=0;Ve<Pe;++Ve)(Xe=he[Ve])!=0&&(we[Ve]=xe[Xe]++);var Me=0;for(Ve=0;Ve<Pe;++Ve)if(Me=he[Ve],Me!=0){Xe=_e[we[Ve]]>>8-Me;for(var qe=(1<<7-Me)-1;qe>=0;--qe)sr[Xe|qe<<Me]=Me&7|Ve<<3}var ft=[];for(oe=1;ft.length<H+G;)switch(Xe=sr[Le(F,Q)],Q+=Xe&7,Xe>>>=3){case 16:for(J=3+nt(F,Q),Q+=2,Xe=ft[ft.length-1];J-- >0;)ft.push(Xe);break;case 17:for(J=3+it(F,Q),Q+=3;J-- >0;)ft.push(0);break;case 18:for(J=11+Le(F,Q),Q+=7;J-- >0;)ft.push(0);break;default:ft.push(Xe),oe<Xe&&(oe=Xe);break}var zt=ft.slice(0,H),Pt=ft.slice(H);for(Ve=H;Ve<286;++Ve)zt[Ve]=0;for(Ve=G;Ve<30;++Ve)Pt[Ve]=0;return Ln=Nt(zt,fr,286),Kn=Nt(Pt,Ur,30),Q}function ji(F,Q){if(F[0]==3&&!(F[1]&3))return[Eo(Q),2];for(var H=0,G=0,Y=ZT(Q||1<<18),J=0,he=Y.length>>>0,we=0,oe=0;(G&1)==0;){if(G=it(F,H),H+=3,G>>>1)G>>1==1?(we=9,oe=5):(H=Ts(F,H),we=Ln,oe=Kn);else{H&7&&(H+=8-(H&7));var ge=F[H>>>3]|F[(H>>>3)+1]<<8;if(H+=32,ge>0)for(!Q&&he<J+ge&&(Y=je(Y,J+ge),he=Y.length);ge-- >0;)Y[J++]=F[H>>>3],H+=8;continue}for(;;){!Q&&he<J+32767&&(Y=je(Y,J+32767),he=Y.length);var xe=ir(F,H,we),Pe=G>>>1==1?mt[xe]:fr[xe];if(H+=Pe&15,Pe>>>=4,(Pe>>>8&255)===0)Y[J++]=Pe;else{if(Pe==256)break;Pe-=257;var Ve=Pe<8?0:Pe-4>>2;Ve>5&&(Ve=0);var Xe=J+le[Pe];Ve>0&&(Xe+=ir(F,H,Ve),H+=Ve),xe=ir(F,H,oe),Pe=G>>>1==1?vt[xe]:Ur[xe],H+=Pe&15,Pe>>>=4;var Me=Pe<4?0:Pe-2>>1,qe=Ne[Pe];for(Me>0&&(qe+=ir(F,H,Me),H+=Me),!Q&&he<Xe&&(Y=je(Y,Xe+100),he=Y.length);J<Xe;)Y[J]=Y[J-qe],++J}}}return Q?[Y,H+7>>>3]:[Y.slice(0,J),H+7>>>3]}function ws(F,Q){var H=F.slice(F.l||0),G=ji(H,Q);return F.l+=G[1],G[0]}function Ss(F,Q){if(F)typeof console<"u"&&console.error(Q);else throw new Error(Q)}function As(F,Q){var H=F;_n(H,0);var G=[],Y=[],J={FileIndex:G,FullPaths:Y};C(J,{root:Q.root});for(var he=H.length-4;(H[he]!=80||H[he+1]!=75||H[he+2]!=5||H[he+3]!=6)&&he>=0;)--he;H.l=he+4,H.l+=4;var we=H.read_shift(2);H.l+=6;var oe=H.read_shift(4);for(H.l=oe,he=0;he<we;++he){H.l+=20;var ge=H.read_shift(4),xe=H.read_shift(4),Pe=H.read_shift(2),Ve=H.read_shift(2),Xe=H.read_shift(2);H.l+=8;var Me=H.read_shift(4),qe=u(H.slice(H.l+Pe,H.l+Pe+Ve));H.l+=Pe+Ve+Xe;var ft=H.l;H.l=Me+4,Ga(H,ge,xe,J,qe),H.l=ft}return J}function Ga(F,Q,H,G,Y){F.l+=2;var J=F.read_shift(2),he=F.read_shift(2),we=l(F);if(J&8257)throw new Error("Unsupported ZIP encryption");for(var oe=F.read_shift(4),ge=F.read_shift(4),xe=F.read_shift(4),Pe=F.read_shift(2),Ve=F.read_shift(2),Xe="",Me=0;Me<Pe;++Me)Xe+=String.fromCharCode(F[F.l++]);if(Ve){var qe=u(F.slice(F.l,F.l+Ve));(qe[21589]||{}).mt&&(we=qe[21589].mt),((Y||{})[21589]||{}).mt&&(we=Y[21589].mt)}F.l+=Ve;var ft=F.slice(F.l,F.l+ge);switch(he){case 8:ft=X(F,xe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+he)}var zt=!1;J&8&&(oe=F.read_shift(4),oe==134695760&&(oe=F.read_shift(4),zt=!0),ge=F.read_shift(4),xe=F.read_shift(4)),ge!=Q&&Ss(zt,"Bad compressed size: "+Q+" != "+ge),xe!=H&&Ss(zt,"Bad uncompressed size: "+H+" != "+xe),gr(G,Xe,ft,{unsafe:!0,mt:we})}function qa(F,Q){var H=Q||{},G=[],Y=[],J=Ae(1),he=H.compression?8:0,we=0,oe=0,ge=0,xe=0,Pe=0,Ve=F.FullPaths[0],Xe=Ve,Me=F.FileIndex[0],qe=[],ft=0;for(oe=1;oe<F.FullPaths.length;++oe)if(Xe=F.FullPaths[oe].slice(Ve.length),Me=F.FileIndex[oe],!(!Me.size||!Me.content||Xe=="Sh33tJ5")){var zt=xe,Pt=Ae(Xe.length);for(ge=0;ge<Xe.length;++ge)Pt.write_shift(1,Xe.charCodeAt(ge)&127);Pt=Pt.slice(0,Pt.l),qe[Pe]=Q5.buf(Me.content,0);var Mt=Me.content;he==8&&(Mt=ee(Mt)),J=Ae(30),J.write_shift(4,67324752),J.write_shift(2,20),J.write_shift(2,we),J.write_shift(2,he),Me.mt?o(J,Me.mt):J.write_shift(4,0),J.write_shift(-4,qe[Pe]),J.write_shift(4,Mt.length),J.write_shift(4,Me.content.length),J.write_shift(2,Pt.length),J.write_shift(2,0),xe+=J.length,G.push(J),xe+=Pt.length,G.push(Pt),xe+=Mt.length,G.push(Mt),J=Ae(46),J.write_shift(4,33639248),J.write_shift(2,0),J.write_shift(2,20),J.write_shift(2,we),J.write_shift(2,he),J.write_shift(4,0),J.write_shift(-4,qe[Pe]),J.write_shift(4,Mt.length),J.write_shift(4,Me.content.length),J.write_shift(2,Pt.length),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(4,0),J.write_shift(4,zt),ft+=J.l,Y.push(J),ft+=Pt.length,Y.push(Pt),++Pe}return J=Ae(22),J.write_shift(4,101010256),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(2,Pe),J.write_shift(2,Pe),J.write_shift(4,ft),J.write_shift(4,xe),J.write_shift(2,0),fn([fn(G),fn(Y),J])}var ii={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function wa(F,Q){if(F.ctype)return F.ctype;var H=F.name||"",G=H.match(/\.([^\.]+)$/);return G&&ii[G[1]]||Q&&(G=(H=Q).match(/[\.\\]([^\.\\])+$/),G&&ii[G[1]])?ii[G[1]]:"application/octet-stream"}function Oo(F){for(var Q=Qf(F),H=[],G=0;G<Q.length;G+=76)H.push(Q.slice(G,G+76));return H.join(`\r
`)+`\r
`}function si(F){var Q=F.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ge){var xe=ge.charCodeAt(0).toString(16).toUpperCase();return"="+(xe.length==1?"0"+xe:xe)});Q=Q.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Q.charAt(0)==`
`&&(Q="=0D"+Q.slice(1)),Q=Q.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var H=[],G=Q.split(`\r
`),Y=0;Y<G.length;++Y){var J=G[Y];if(J.length==0){H.push("");continue}for(var he=0;he<J.length;){var we=76,oe=J.slice(he,he+we);oe.charAt(we-1)=="="?we--:oe.charAt(we-2)=="="?we-=2:oe.charAt(we-3)=="="&&(we-=3),oe=J.slice(he,he+we),he+=we,he<J.length&&(oe+="="),H.push(oe)}}return H.join(`\r
`)}function bs(F){for(var Q=[],H=0;H<F.length;++H){for(var G=F[H];H<=F.length&&G.charAt(G.length-1)=="=";)G=G.slice(0,G.length-1)+F[++H];Q.push(G)}for(var Y=0;Y<Q.length;++Y)Q[Y]=Q[Y].replace(/[=][0-9A-Fa-f]{2}/g,function(J){return String.fromCharCode(parseInt(J.slice(1),16))});return xa(Q.join(`\r
`))}function oi(F,Q,H){for(var G="",Y="",J="",he,we=0;we<10;++we){var oe=Q[we];if(!oe||oe.match(/^\s*$/))break;var ge=oe.match(/^(.*?):\s*([^\s].*)$/);if(ge)switch(ge[1].toLowerCase()){case"content-location":G=ge[2].trim();break;case"content-type":J=ge[2].trim();break;case"content-transfer-encoding":Y=ge[2].trim();break}}switch(++we,Y.toLowerCase()){case"base64":he=xa(Ea(Q.slice(we).join("")));break;case"quoted-printable":he=bs(Q.slice(we));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Y)}var xe=gr(F,G.slice(H.length),he,{unsafe:!0});J&&(xe.ctype=J)}function jl(F,Q){if(ie(F.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var H=Q&&Q.root||"",G=(bt&&Buffer.isBuffer(F)?F.toString("binary"):ie(F)).split(`\r
`),Y=0,J="";for(Y=0;Y<G.length;++Y)if(J=G[Y],!!/^Content-Location:/i.test(J)&&(J=J.slice(J.indexOf("file")),H||(H=J.slice(0,J.lastIndexOf("/")+1)),J.slice(0,H.length)!=H))for(;H.length>0&&(H=H.slice(0,H.length-1),H=H.slice(0,H.lastIndexOf("/")+1),J.slice(0,H.length)!=H););var he=(G[1]||"").match(/boundary="(.*?)"/);if(!he)throw new Error("MAD cannot find boundary");var we="--"+(he[1]||""),oe=[],ge=[],xe={FileIndex:oe,FullPaths:ge};C(xe);var Pe,Ve=0;for(Y=0;Y<G.length;++Y){var Xe=G[Y];Xe!==we&&Xe!==we+"--"||(Ve++&&oi(xe,G.slice(Pe,Y),H),Pe=Y)}return xe}function lr(F,Q){var H=Q||{},G=H.boundary||"SheetJS";G="------="+G;for(var Y=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+G.slice(2)+'"',"","",""],J=F.FullPaths[0],he=J,we=F.FileIndex[0],oe=1;oe<F.FullPaths.length;++oe)if(he=F.FullPaths[oe].slice(J.length),we=F.FileIndex[oe],!(!we.size||!we.content||he=="Sh33tJ5")){he=he.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ft){return"_x"+ft.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ft){return"_u"+ft.charCodeAt(0).toString(16)+"_"});for(var ge=we.content,xe=bt&&Buffer.isBuffer(ge)?ge.toString("binary"):ie(ge),Pe=0,Ve=Math.min(1024,xe.length),Xe=0,Me=0;Me<=Ve;++Me)(Xe=xe.charCodeAt(Me))>=32&&Xe<128&&++Pe;var qe=Pe>=Ve*4/5;Y.push(G),Y.push("Content-Location: "+(H.root||"file:///C:/SheetJS/")+he),Y.push("Content-Transfer-Encoding: "+(qe?"quoted-printable":"base64")),Y.push("Content-Type: "+wa(we,he)),Y.push(""),Y.push(qe?si(xe):Oo(xe))}return Y.push(G+`--\r
`),Y.join(`\r
`)}function Ir(F){var Q={};return C(Q,F),Q}function gr(F,Q,H,G){var Y=G&&G.unsafe;Y||C(F);var J=!Y&&Je.find(F,Q);if(!J){var he=F.FullPaths[0];Q.slice(0,he.length)==he?he=Q:(he.slice(-1)!="/"&&(he+="/"),he=(he+Q).replace("//","/")),J={name:a(Q),type:2},F.FileIndex.push(J),F.FullPaths.push(he),Y||Je.utils.cfb_gc(F)}return J.content=H,J.size=H?H.length:0,G&&(G.CLSID&&(J.clsid=G.CLSID),G.mt&&(J.mt=G.mt),G.ct&&(J.ct=G.ct)),J}function Yn(F,Q){C(F);var H=Je.find(F,Q);if(H){for(var G=0;G<F.FileIndex.length;++G)if(F.FileIndex[G]==H)return F.FileIndex.splice(G,1),F.FullPaths.splice(G,1),!0}return!1}function Fo(F,Q,H){C(F);var G=Je.find(F,Q);if(G){for(var Y=0;Y<F.FileIndex.length;++Y)if(F.FileIndex[Y]==G)return F.FileIndex[Y].name=a(H),F.FullPaths[Y]=H,!0}return!1}function hu(F){b(F,!0)}return e.find=L,e.read=Z,e.parse=p,e.write=K,e.writeFile=Ue,e.utils={cfb_new:Ir,cfb_add:gr,cfb_del:Yn,cfb_mov:Fo,cfb_gc:hu,ReadShift:Of,CheckField:Nk,prep_blob:_n,bconcat:fn,use_zlib:V,_deflateRaw:_t,_inflateRaw:ws,consts:ue},e}();function Z5(t){return typeof t=="string"?Cm(t):Array.isArray(t)?S5(t):t}function b0(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=Cm(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?Ci(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var a=new Blob([Z5(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,t);if(typeof saveAs<"u")return saveAs(a,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var o=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),chrome.downloads.download({url:o,filename:t,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=t,l.href=o,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),o}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(t);return u.open("w"),u.encoding="binary",Array.isArray(e)&&(e=Io(e)),u.write(e),u.close(),e}catch(h){if(!h.message||!h.message.match(/onstruct/))throw h}throw new Error("cannot save file "+t)}function J5(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Cr(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function sw(t,e){for(var r=[],n=Cr(t),a=0;a!==n.length;++a)r[t[n[a]][e]]==null&&(r[t[n[a]][e]]=n[a]);return r}function Rm(t){for(var e=[],r=Cr(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function Im(t){for(var e=[],r=Cr(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function eP(t){for(var e=[],r=Cr(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var $d=new Date(1899,11,30,0,0,0);function rn(t,e){var r=t.getTime(),n=$d.getTime()+(t.getTimezoneOffset()-$d.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var uk=new Date,tP=$d.getTime()+(uk.getTimezoneOffset()-$d.getTimezoneOffset())*6e4,ow=uk.getTimezoneOffset();function Nm(t){var e=new Date;return e.setTime(t*24*60*60*1e3+tP),e.getTimezoneOffset()!==ow&&e.setTime(e.getTime()+(e.getTimezoneOffset()-ow)*6e4),e}function rP(t){var e=0,r=0,n=!1,a=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var o=1;o!=a.length;++o)if(a[o]){switch(r=1,o>3&&(n=!0),a[o].slice(a[o].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[o].slice(a[o].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(a[o],10)}return e}var lw=new Date("2017-02-19T19:06:09.000Z"),fk=isNaN(lw.getFullYear())?new Date("2/19/17"):lw,nP=fk.getFullYear()==2017;function mr(t,e){var r=new Date(t);if(nP)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(fk.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=t.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return t.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function Al(t,e){if(bt&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return Ci(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return Ci(Qb(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return Ci(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return Ci(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(o){return r[o]||o})}catch{}for(var n=[],a=0;a!=t.length;++a)n.push(String.fromCharCode(t[a]));return n.join("")}function pr(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=pr(t[r]));return e}function Sr(t,e){for(var r="";r.length<e;)r+=t;return r}function ti(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,o){return r=-r,o}),!isNaN(e=Number(n)))?e/r:e}var aP=["january","february","march","april","may","june","july","august","september","october","november","december"];function Jc(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),a=e.getMonth(),o=e.getDate();if(isNaN(o))return r;var l=t.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&aP.indexOf(l)==-1)return r}else if(l.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||o>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var iP=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(t||typeof n=="string")return r.split(n);for(var o=r.split(n),l=[o[0]],u=1;u<o.length;++u)l.push(a),l.push(o[u]);return l}}();function hk(t){return t?t.content&&t.type?Al(t.content,!0):t.data?Tf(t.data):t.asNodeBuffer&&bt?Tf(t.asNodeBuffer().toString("binary")):t.asBinary?Tf(t.asBinary()):t._data&&t._data.getContent?Tf(Al(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function dk(t){if(!t)return null;if(t.data)return $T(t.data);if(t.asNodeBuffer&&bt)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?$T(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function sP(t){return t&&t.name.slice(-4)===".bin"?dk(t):hk(t)}function Ba(t,e){for(var r=t.FullPaths||Cr(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),o=0;o<r.length;++o){var l=r[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==l||a==l)return t.files?t.files[r[o]]:t.FileIndex[o]}return null}function mv(t,e){var r=Ba(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function Gr(t,e,r){if(!r)return sP(mv(t,e));if(!e)return null;try{return Gr(t,e)}catch{return null}}function va(t,e,r){if(!r)return hk(mv(t,e));if(!e)return null;try{return va(t,e)}catch{return null}}function oP(t,e,r){return dk(mv(t,e))}function cw(t){for(var e=t.FullPaths||Cr(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Tt(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return bt?n=_s(r):n=A5(r),Je.utils.cfb_add(t,e,n)}Je.utils.cfb_add(t,e,r)}else t.file(e,r)}function pv(){return Je.utils.cfb_new()}function mk(t,e){switch(e.type){case"base64":return Je.read(t,{type:"base64"});case"binary":return Je.read(t,{type:"binary"});case"buffer":case"array":return Je.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Sf(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var Mr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,lP=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,uw=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,cP=/<[^>]*>/g,Mn=Mr.match(uw)?uw:cP,uP=/<\w*:/,fP=/<(\/?)\w+:/;function dt(t,e,r){for(var n={},a=0,o=0;a!==t.length&&!((o=t.charCodeAt(a))===32||o===10||o===13);++a);if(e||(n[0]=t.slice(0,a)),a===t.length)return n;var l=t.match(lP),u=0,h="",d=0,p="",v="",_=1;if(l)for(d=0;d!=l.length;++d){for(v=l[d],o=0;o!=v.length&&v.charCodeAt(o)!==61;++o);for(p=v.slice(0,o).trim();v.charCodeAt(o+1)==32;)++o;for(_=(a=v.charCodeAt(o+1))==34||a==39?1:0,h=v.slice(o+1+_,v.length-_),u=0;u!=p.length&&p.charCodeAt(u)!==58;++u);if(u===p.length)p.indexOf("_")>0&&(p=p.slice(0,p.indexOf("_"))),n[p]=h,n[p.toLowerCase()]=h;else{var E=(u===5&&p.slice(0,5)==="xmlns"?"xmlns":"")+p.slice(u+1);if(n[E]&&p.slice(u-3,u)=="ext")continue;n[E]=h,n[E.toLowerCase()]=h}}return n}function Bi(t){return t.replace(fP,"<$1")}var pk={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},gv=Rm(pk),jt=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",o=a.indexOf("<![CDATA[");if(o==-1)return a.replace(t,function(u,h){return pk[u]||String.fromCharCode(parseInt(h,u.indexOf("x")>-1?16:10))||u}).replace(e,function(u,h){return String.fromCharCode(parseInt(h,16))});var l=a.indexOf("]]>");return r(a.slice(0,o))+a.slice(o+9,l)+r(a.slice(l+3))}}(),xv=/[&<>'"]/g,hP=/[\u0000-\u0008\u000b-\u001f]/g;function Jt(t){var e=t+"";return e.replace(xv,function(r){return gv[r]}).replace(hP,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function fw(t){return Jt(t).replace(/ /g,"_x0020_")}var gk=/[\u0000-\u001f]/g;function vv(t){var e=t+"";return e.replace(xv,function(r){return gv[r]}).replace(/\n/g,"<br/>").replace(gk,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function dP(t){var e=t+"";return e.replace(xv,function(r){return gv[r]}).replace(gk,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var hw=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function mP(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function hr(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Zg(t){for(var e="",r=0,n=0,a=0,o=0,l=0,u=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(a=t.charCodeAt(r++),n>191&&n<224){l=(n&31)<<6,l|=a&63,e+=String.fromCharCode(l);continue}if(o=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(a&63)<<6|o&63);continue}l=t.charCodeAt(r++),u=((n&7)<<18|(a&63)<<12|(o&63)<<6|l&63)-65536,e+=String.fromCharCode(55296+(u>>>10&1023)),e+=String.fromCharCode(56320+(u&1023))}return e}function dw(t){var e=Eo(2*t.length),r,n,a=1,o=0,l=0,u;for(n=0;n<t.length;n+=a)a=1,(u=t.charCodeAt(n))<128?r=u:u<224?(r=(u&31)*64+(t.charCodeAt(n+1)&63),a=2):u<240?(r=(u&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),a=3):(a=4,r=(u&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,l=55296+(r>>>10&1023),r=56320+(r&1023)),l!==0&&(e[o++]=l&255,e[o++]=l>>>8,l=0),e[o++]=r%256,e[o++]=r>>>8;return e.slice(0,o).toString("ucs2")}function mw(t){return _s(t,"binary").toString("utf8")}var id="foo bar baz",ar=bt&&(mw(id)==Zg(id)&&mw||dw(id)==Zg(id)&&dw)||Zg,Ci=bt?function(t){return _s(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,a=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(a>>18&7))),e.push(String.fromCharCode(144+(a>>12&63))),e.push(String.fromCharCode(128+(a>>6&63))),e.push(String.fromCharCode(128+(a&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},Jf=function(){var t={};return function(r,n){var a=r+"|"+(n||"");return t[a]?t[a]:t[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),xk=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<t.length;++a)n=n.replace(t[a][0],t[a][1]);return n}}(),pP=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),gP=/<\/?(?:vt:)?variant>/g,xP=/<(?:vt:)([^>]*)>([\s\S]*)</;function pw(t,e){var r=dt(t),n=t.match(pP(r.baseType))||[],a=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(o){var l=o.replace(gP,"").match(xP);l&&a.push({v:ar(l[2]),t:l[1]})}),a}var vk=/(^\s|\s$|\n)/;function En(t,e){return"<"+t+(e.match(vk)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function e0(t){return Cr(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function He(t,e,r){return"<"+t+(r!=null?e0(r):"")+(e!=null?(e.match(vk)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function W1(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function vP(t,e){switch(typeof t){case"string":var r=He("vt:lpwstr",Jt(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return He((t|0)==t?"vt:i4":"vt:r8",Jt(String(t)));case"boolean":return He("vt:bool",t?"true":"false")}if(t instanceof Date)return He("vt:filetime",W1(t));throw new Error("Unable to serialize "+t)}function _v(t){if(bt&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return ar(Io(fv(t)));throw new Error("Bad input format: expected Buffer or string")}var t0=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Jr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Pl=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],ma={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function _P(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),a=t[e+6]&15,o=5;o>=0;--o)a=a*256+t[e+o];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function yP(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,a=0,o=0,l=n?-e:e;isFinite(l)?l==0?a=o=0:(a=Math.floor(Math.log(l)/Math.LN2),o=l*Math.pow(2,52-a),a<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?a=-1022:(o-=Math.pow(2,52),a+=1023)):(a=2047,o=isNaN(e)?26985:0);for(var u=0;u<=5;++u,o/=256)t[r+u]=o&255;t[r+6]=(a&15)<<4|o&15,t[r+7]=a>>4|n}var gw=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var a=0,o=t[0][n].length;a<o;a+=r)e.push.apply(e,t[0][n].slice(a,a+r));return e},xw=bt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:_s(e)})):gw(t)}:gw,vw=function(t,e,r){for(var n=[],a=e;a<r;a+=2)n.push(String.fromCharCode(us(t,a)));return n.join("").replace(Xn,"")},yv=bt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Xn,""):vw(t,e,r)}:vw,_w=function(t,e,r){for(var n=[],a=e;a<e+r;++a)n.push(("0"+t[a].toString(16)).slice(-2));return n.join("")},_k=bt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):_w(t,e,r)}:_w,yw=function(t,e,r){for(var n=[],a=e;a<r;a++)n.push(String.fromCharCode(Fc(t,a)));return n.join("")},k0=bt?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):yw(e,r,n)}:yw,yk=function(t,e){var r=pa(t,e);return r>0?k0(t,e+4,e+4+r-1):""},Ek=yk,Tk=function(t,e){var r=pa(t,e);return r>0?k0(t,e+4,e+4+r-1):""},wk=Tk,Sk=function(t,e){var r=2*pa(t,e);return r>0?k0(t,e+4,e+4+r-1):""},Ak=Sk,bk=function(e,r){var n=pa(e,r);return n>0?yv(e,r+4,r+4+n):""},kk=bk,Ck=function(t,e){var r=pa(t,e);return r>0?k0(t,e+4,e+4+r):""},Rk=Ck,Ik=function(t,e){return _P(t,e)},Qd=Ik,Ev=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};bt&&(Ek=function(e,r){if(!Buffer.isBuffer(e))return yk(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},wk=function(e,r){if(!Buffer.isBuffer(e))return Tk(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},Ak=function(e,r){if(!Buffer.isBuffer(e))return Sk(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},kk=function(e,r){if(!Buffer.isBuffer(e))return bk(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},Rk=function(e,r){if(!Buffer.isBuffer(e))return Ck(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},Qd=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):Ik(e,r)},Ev=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Fc=function(t,e){return t[e]},us=function(t,e){return t[e+1]*256+t[e]},EP=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},pa=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},cl=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},TP=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Of(t,e){var r="",n,a,o=[],l,u,h,d;switch(e){case"dbcs":if(d=this.l,bt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(h=0;h<t;++h)r+=String.fromCharCode(us(this,d)),d+=2;t*=2;break;case"utf8":r=k0(this,this.l,this.l+t);break;case"utf16le":t*=2,r=yv(this,this.l,this.l+t);break;case"wstr":return Of.call(this,t,"dbcs");case"lpstr-ansi":r=Ek(this,this.l),t=4+pa(this,this.l);break;case"lpstr-cp":r=wk(this,this.l),t=4+pa(this,this.l);break;case"lpwstr":r=Ak(this,this.l),t=4+2*pa(this,this.l);break;case"lpp4":t=4+pa(this,this.l),r=kk(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+pa(this,this.l),r=Rk(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(l=Fc(this,this.l+t++))!==0;)o.push(ad(l));r=o.join("");break;case"_wstr":for(t=0,r="";(l=us(this,this.l+t))!==0;)o.push(ad(l)),t+=2;t+=2,r=o.join("");break;case"dbcs-cont":for(r="",d=this.l,h=0;h<t;++h){if(this.lens&&this.lens.indexOf(d)!==-1)return l=Fc(this,d),this.l=d+1,u=Of.call(this,t-h,l?"dbcs-cont":"sbcs-cont"),o.join("")+u;o.push(ad(us(this,d))),d+=2}r=o.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,h=0;h!=t;++h){if(this.lens&&this.lens.indexOf(d)!==-1)return l=Fc(this,d),this.l=d+1,u=Of.call(this,t-h,l?"dbcs-cont":"sbcs-cont"),o.join("")+u;o.push(ad(Fc(this,d))),d+=1}r=o.join("");break;default:switch(t){case 1:return n=Fc(this,this.l),this.l++,n;case 2:return n=(e==="i"?EP:us)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(n=(t>0?cl:TP)(this,this.l),this.l+=4,n):(a=pa(this,this.l),this.l+=4,a);case 8:case-8:if(e==="f")return t==8?a=Qd(this,this.l):a=Qd([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;t=8;case 16:r=_k(this,this.l,t);break}}return this.l+=t,r}var wP=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},SP=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},AP=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function bP(t,e,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=e.length;++a)AP(this,e.charCodeAt(a),this.l+2*a);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=e.length;++a)this[this.l+a]=e.charCodeAt(a)&255;n=e.length}else if(r==="hex"){for(;a<t;++a)this[this.l++]=parseInt(e.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var o=Math.min(this.l+t,this.length);for(a=0;a<Math.min(e.length,t);++a){var l=e.charCodeAt(a);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,wP(this,e,this.l);break;case 8:if(n=8,r==="f"){yP(this,e,this.l);break}case 16:break;case-4:n=4,SP(this,e,this.l);break}return this.l+=n,this}function Nk(t,e){var r=_k(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function _n(t,e){t.l=e,t.read_shift=Of,t.chk=Nk,t.write_shift=bP}function Pn(t,e){t.l+=e}function Ae(t){var e=Eo(t);return _n(e,0),e}function ys(t,e,r){if(t){var n,a,o;_n(t,t.l||0);for(var l=t.length,u=0,h=0;t.l<l;){u=t.read_shift(1),u&128&&(u=(u&127)+((t.read_shift(1)&127)<<7));var d=o0[u]||o0[65535];for(n=t.read_shift(1),o=n&127,a=1;a<4&&n&128;++a)o+=((n=t.read_shift(1))&127)<<7*a;h=t.l+o;var p=d.f&&d.f(t,o,r);if(t.l=h,e(p,d,u))return}}}function na(){var t=[],e=bt?256:2048,r=function(d){var p=Ae(d);return _n(p,0),p},n=r(e),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},o=function(d){return n&&d<n.length-n.l?n:(a(),n=r(Math.max(d+1,e)))},l=function(){return a(),fn(t)},u=function(d){a(),n=d,n.l==null&&(n.l=n.length),o(e)};return{next:o,push:u,end:l,_bufs:t}}function Fe(t,e,r,n){var a=+e,o;if(!isNaN(a)){n||(n=o0[a].p||(r||[]).length||0),o=1+(a>=128?1:0)+1,n>=128&&++o,n>=16384&&++o,n>=2097152&&++o;var l=t.next(o);a<=127?l.write_shift(1,a):(l.write_shift(1,(a&127)+128),l.write_shift(1,a>>7));for(var u=0;u!=4;++u)if(n>=128)l.write_shift(1,(n&127)+128),n>>=7;else{l.write_shift(1,n);break}n>0&&Ev(r)&&t.push(r)}}function Ff(t,e,r){var n=pr(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Ew(t,e,r){var n=pr(t);return n.s=Ff(n.s,e.s,r),n.e=Ff(n.e,e.s,r),n}function Pf(t,e){if(t.cRel&&t.c<0)for(t=pr(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=pr(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=lt(t);return!t.cRel&&t.cRel!=null&&(r=RP(r)),!t.rRel&&t.rRel!=null&&(r=kP(r)),r}function Jg(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+_r(t.s.c)+":"+(t.e.cRel?"":"$")+_r(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Pr(t.s.r)+":"+(t.e.rRel?"":"$")+Pr(t.e.r):Pf(t.s,e.biff)+":"+Pf(t.e,e.biff)}function Tv(t){return parseInt(CP(t),10)-1}function Pr(t){return""+(t+1)}function kP(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function CP(t){return t.replace(/\$(\d+)$/,"$1")}function wv(t){for(var e=IP(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function _r(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function RP(t){return t.replace(/^([A-Z])/,"$$$1")}function IP(t){return t.replace(/^\$([A-Z])/,"$1")}function NP(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function yr(t){for(var e=0,r=0,n=0;n<t.length;++n){var a=t.charCodeAt(n);a>=48&&a<=57?e=10*e+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:e-1}}function lt(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function aa(t){var e=t.indexOf(":");return e==-1?{s:yr(t),e:yr(t)}:{s:yr(t.slice(0,e)),e:yr(t.slice(e+1))}}function yt(t,e){return typeof e>"u"||typeof e=="number"?yt(t.s,t.e):(typeof t!="string"&&(t=lt(t)),typeof e!="string"&&(e=lt(e)),t==e?t:t+":"+e)}function Ht(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,o=t.length;for(r=0;n<o&&!((a=t.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(e.s.c=--r,r=0;n<o&&!((a=t.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(e.s.r=--r,n===o||a!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=o&&!((a=t.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(e.e.c=--r,r=0;n!=o&&!((a=t.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return e.e.r=--r,e}function Tw(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Ta(t.z,r?rn(e):e)}catch{}try{return t.w=Ta((t.XF||{}).numFmtId||(r?14:0),r?rn(e):e)}catch{return""+e}}function vs(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?Es[t.v]||t.v:e==null?Tw(t,t.v):Tw(t,e))}function No(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function Dk(t,e,r){var n=r||{},a=t?Array.isArray(t):n.dense,o=t||(a?[]:{}),l=0,u=0;if(o&&n.origin!=null){if(typeof n.origin=="number")l=n.origin;else{var h=typeof n.origin=="string"?yr(n.origin):n.origin;l=h.r,u=h.c}o["!ref"]||(o["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var p=Ht(o["!ref"]);d.s.c=p.s.c,d.s.r=p.s.r,d.e.c=Math.max(d.e.c,p.e.c),d.e.r=Math.max(d.e.r,p.e.r),l==-1&&(d.e.r=l=p.e.r+1)}for(var v=0;v!=e.length;++v)if(e[v]){if(!Array.isArray(e[v]))throw new Error("aoa_to_sheet expects an array of arrays");for(var _=0;_!=e[v].length;++_)if(!(typeof e[v][_]>"u")){var E={v:e[v][_]},S=l+v,y=u+_;if(d.s.r>S&&(d.s.r=S),d.s.c>y&&(d.s.c=y),d.e.r<S&&(d.e.r=S),d.e.c<y&&(d.e.c=y),e[v][_]&&typeof e[v][_]=="object"&&!Array.isArray(e[v][_])&&!(e[v][_]instanceof Date))E=e[v][_];else if(Array.isArray(E.v)&&(E.f=e[v][_][1],E.v=E.v[0]),E.v===null)if(E.f)E.t="n";else if(n.nullError)E.t="e",E.v=0;else if(n.sheetStubs)E.t="z";else continue;else typeof E.v=="number"?E.t="n":typeof E.v=="boolean"?E.t="b":E.v instanceof Date?(E.z=n.dateNF||tt[14],n.cellDates?(E.t="d",E.w=Ta(E.z,rn(E.v))):(E.t="n",E.v=rn(E.v),E.w=Ta(E.z,E.v))):E.t="s";if(a)o[S]||(o[S]=[]),o[S][y]&&o[S][y].z&&(E.z=o[S][y].z),o[S][y]=E;else{var w=lt({c:y,r:S});o[w]&&o[w].z&&(E.z=o[w].z),o[w]=E}}}return d.s.c<1e7&&(o["!ref"]=yt(d)),o}function uu(t,e){return Dk(null,t,e)}function DP(t){return t.read_shift(4,"i")}function ri(t,e){return e||(e=Ae(4)),e.write_shift(4,t),e}function On(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function hn(t,e){var r=!1;return e==null&&(r=!0,e=Ae(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function OP(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function FP(t,e){return e||(e=Ae(4)),e.write_shift(2,0),e.write_shift(2,0),e}function Sv(t,e){var r=t.l,n=t.read_shift(1),a=On(t),o=[],l={t:a,h:a};if((n&1)!==0){for(var u=t.read_shift(4),h=0;h!=u;++h)o.push(OP(t));l.r=o}else l.r=[{ich:0,ifnt:0}];return t.l=r+e,l}function PP(t,e){var r=!1;return e==null&&(r=!0,e=Ae(15+4*t.t.length)),e.write_shift(1,0),hn(t.t,e),r?e.slice(0,e.l):e}var MP=Sv;function LP(t,e){var r=!1;return e==null&&(r=!0,e=Ae(23+4*t.t.length)),e.write_shift(1,1),hn(t.t,e),e.write_shift(4,1),FP({},e),r?e.slice(0,e.l):e}function za(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Ml(t,e){return e==null&&(e=Ae(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function Ll(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function Ul(t,e){return e==null&&(e=Ae(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var UP=On,Ok=hn;function Av(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function Zd(t,e){var r=!1;return e==null&&(r=!0,e=Ae(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var BP=On,X1=Av,bv=Zd;function kv(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var a=n===0?Qd([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):cl(e,0)>>2;return r?a/100:a}function Fk(t,e){e==null&&(e=Ae(4));var r=0,n=0,a=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?a:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function Pk(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function VP(t,e){return e||(e=Ae(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var Bl=Pk,fu=VP;function Dn(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function bl(t,e){return(e||Ae(8)).write_shift(8,t,"f")}function jP(t){var e={},r=t.read_shift(1),n=r>>>1,a=t.read_shift(1),o=t.read_shift(2,"i"),l=t.read_shift(1),u=t.read_shift(1),h=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=a;var d=hl[a];d&&(e.rgb=n0(d));break;case 2:e.rgb=n0([l,u,h]);break;case 3:e.theme=a;break}return o!=0&&(e.tint=o>0?o/32767:o/32768),e}function Jd(t,e){if(e||(e=Ae(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function HP(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function zP(t,e){e||(e=Ae(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function Mk(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function GP(t){return Mk(t,1)}function qP(t){return Mk(t,2)}var Cv=2,ea=3,sd=11,ww=12,em=19,od=64,WP=65,XP=71,KP=4108,YP=4126,un=80,Lk=81,$P=[un,Lk],K1={1:{n:"CodePage",t:Cv},2:{n:"Category",t:un},3:{n:"PresentationFormat",t:un},4:{n:"ByteCount",t:ea},5:{n:"LineCount",t:ea},6:{n:"ParagraphCount",t:ea},7:{n:"SlideCount",t:ea},8:{n:"NoteCount",t:ea},9:{n:"HiddenCount",t:ea},10:{n:"MultimediaClipCount",t:ea},11:{n:"ScaleCrop",t:sd},12:{n:"HeadingPairs",t:KP},13:{n:"TitlesOfParts",t:YP},14:{n:"Manager",t:un},15:{n:"Company",t:un},16:{n:"LinksUpToDate",t:sd},17:{n:"CharacterCount",t:ea},19:{n:"SharedDoc",t:sd},22:{n:"HyperlinksChanged",t:sd},23:{n:"AppVersion",t:ea,p:"version"},24:{n:"DigSig",t:WP},26:{n:"ContentType",t:un},27:{n:"ContentStatus",t:un},28:{n:"Language",t:un},29:{n:"Version",t:un},255:{},2147483648:{n:"Locale",t:em},2147483651:{n:"Behavior",t:em},1919054434:{}},Y1={1:{n:"CodePage",t:Cv},2:{n:"Title",t:un},3:{n:"Subject",t:un},4:{n:"Author",t:un},5:{n:"Keywords",t:un},6:{n:"Comments",t:un},7:{n:"Template",t:un},8:{n:"LastAuthor",t:un},9:{n:"RevNumber",t:un},10:{n:"EditTime",t:od},11:{n:"LastPrinted",t:od},12:{n:"CreatedDate",t:od},13:{n:"ModifiedDate",t:od},14:{n:"PageCount",t:ea},15:{n:"WordCount",t:ea},16:{n:"CharCount",t:ea},17:{n:"Thumbnail",t:XP},18:{n:"Application",t:un},19:{n:"DocSecurity",t:ea},255:{},2147483648:{n:"Locale",t:em},2147483651:{n:"Behavior",t:em},1919054434:{}},Sw={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},QP=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function ZP(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var JP=ZP([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),hl=pr(JP),Es={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Uk={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},$1={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},ld={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Rv(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function eM(t){var e=Rv();if(!t||!t.match)return e;var r={};if((t.match(Mn)||[]).forEach(function(n){var a=dt(n);switch(a[0].replace(uP,"<")){case"<?xml":break;case"<Types":e.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":e[$1[a.ContentType]]!==void 0&&e[$1[a.ContentType]].push(a.PartName);break}}),e.xmlns!==Jr.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function Bk(t,e){var r=eP($1),n=[],a;n[n.length]=Mr,n[n.length]=He("Types",null,{xmlns:Jr.CT,"xmlns:xsd":Jr.xsd,"xmlns:xsi":Jr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(h){return He("Default",null,{Extension:h[0],ContentType:h[1]})}));var o=function(h){t[h]&&t[h].length>0&&(a=t[h][0],n[n.length]=He("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:ld[h][e.bookType]||ld[h].xlsx}))},l=function(h){(t[h]||[]).forEach(function(d){n[n.length]=He("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:ld[h][e.bookType]||ld[h].xlsx})})},u=function(h){(t[h]||[]).forEach(function(d){n[n.length]=He("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[h][0]})})};return o("workbooks"),l("sheets"),l("charts"),u("themes"),["strs","styles"].forEach(o),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),l("metadata"),u("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Ct={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function r0(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Mf(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(Mn)||[]).forEach(function(a){var o=dt(a);if(o[0]==="<Relationship"){var l={};l.Type=o.Type,l.Target=o.Target,l.Id=o.Id,o.TargetMode&&(l.TargetMode=o.TargetMode);var u=o.TargetMode==="External"?o.Target:Sf(o.Target,e);r[u]=l,n[o.Id]=l}}),r["!id"]=n,r}function Gc(t){var e=[Mr,He("Relationships",null,{xmlns:Jr.RELS})];return Cr(t["!id"]).forEach(function(r){e[e.length]=He("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Zt(t,e,r,n,a,o){if(a||(a={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,a.Id="rId"+e,a.Type=n,a.Target=r,[Ct.HLINK,Ct.XPATH,Ct.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),t["!id"][a.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][a.Id]=a,t[("/"+a.Target).replace("//","/")]=a,e}var tM="application/vnd.oasis.opendocument.spreadsheet";function rM(t,e){for(var r=_v(t),n,a;n=t0.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=dt(n[0],!1),a.path=="/"&&a.type!==tM)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function nM(t){var e=[Mr];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function Aw(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function aM(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function iM(t){var e=[Mr];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(Aw(t[r][0],t[r][1])),e.push(aM("",t[r][0]));return e.push(Aw("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function Vk(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Wd.version+"</meta:generator></office:meta></office:document-meta>"}var Ha=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],sM=function(){for(var t=new Array(Ha.length),e=0;e<Ha.length;++e){var r=Ha[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function jk(t){var e={};t=ar(t);for(var r=0;r<Ha.length;++r){var n=Ha[r],a=t.match(sM[r]);a!=null&&a.length>0&&(e[n[1]]=jt(a[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=mr(e[n[1]]))}return e}function e1(t,e,r,n,a){a[t]!=null||e==null||e===""||(a[t]=e,e=Jt(e),n[n.length]=r?He(t,e,r):En(t,e))}function Hk(t,e){var r=e||{},n=[Mr,He("cp:coreProperties",null,{"xmlns:cp":Jr.CORE_PROPS,"xmlns:dc":Jr.dc,"xmlns:dcterms":Jr.dcterms,"xmlns:dcmitype":Jr.dcmitype,"xmlns:xsi":Jr.xsi})],a={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&e1("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:W1(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),t.ModifiedDate!=null&&e1("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:W1(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var o=0;o!=Ha.length;++o){var l=Ha[o],u=r.Props&&r.Props[l[1]]!=null?r.Props[l[1]]:t?t[l[1]]:null;u===!0?u="1":u===!1?u="0":typeof u=="number"&&(u=String(u)),u!=null&&e1(l[0],u,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var dl=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],zk=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Gk(t,e,r,n){var a=[];if(typeof t=="string")a=pw(t,n);else for(var o=0;o<t.length;++o)a=a.concat(t[o].map(function(p){return{v:p}}));var l=typeof e=="string"?pw(e,n).map(function(p){return p.v}):e,u=0,h=0;if(l.length>0)for(var d=0;d!==a.length;d+=2){switch(h=+a[d+1].v,a[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=h,r.SheetNames=l.slice(u,u+h);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=h,r.DefinedNames=l.slice(u,u+h);break;case"Charts":case"Diagramme":r.Chartsheets=h,r.ChartNames=l.slice(u,u+h);break}u+=h}}function oM(t,e,r){var n={};return e||(e={}),t=ar(t),dl.forEach(function(a){var o=(t.match(Jf(a[0]))||[])[1];switch(a[2]){case"string":o&&(e[a[1]]=jt(o));break;case"bool":e[a[1]]=o==="true";break;case"raw":var l=t.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));l&&l.length>0&&(n[a[1]]=l[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&Gk(n.HeadingPairs,n.TitlesOfParts,e,r),e}function qk(t){var e=[],r=He;return t||(t={}),t.Application="SheetJS",e[e.length]=Mr,e[e.length]=He("Properties",null,{xmlns:Jr.EXT_PROPS,"xmlns:vt":Jr.vt}),dl.forEach(function(n){if(t[n[1]]!==void 0){var a;switch(n[2]){case"string":a=Jt(String(t[n[1]]));break;case"bool":a=t[n[1]]?"true":"false";break}a!==void 0&&(e[e.length]=r(n[0],a))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+Jt(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var lM=/<[^>]+>[^<]*/g;function cM(t,e){var r={},n="",a=t.match(lM);if(a)for(var o=0;o!=a.length;++o){var l=a[o],u=dt(l);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":n=jt(u.name);break;case"</property>":n=null;break;default:if(l.indexOf("<vt:")===0){var h=l.split(">"),d=h[0].slice(4),p=h[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[n]=jt(p);break;case"bool":r[n]=hr(p);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(p,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(p);break;case"filetime":case"date":r[n]=mr(p);break;case"cy":case"error":r[n]=jt(p);break;default:if(d.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",l,d,h)}}else if(l.slice(0,2)!=="</"){if(e.WTF)throw new Error(l)}}}return r}function Wk(t){var e=[Mr,He("Properties",null,{xmlns:Jr.CUST_PROPS,"xmlns:vt":Jr.vt})];if(!t)return e.join("");var r=1;return Cr(t).forEach(function(a){++r,e[e.length]=He("property",vP(t[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Jt(a)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var Q1={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},t1;function uM(t,e,r){t1||(t1=Rm(Q1)),e=t1[e]||e,t[e]=r}function fM(t,e){var r=[];return Cr(Q1).map(function(n){for(var a=0;a<Ha.length;++a)if(Ha[a][1]==n)return Ha[a];for(a=0;a<dl.length;++a)if(dl[a][1]==n)return dl[a];throw n}).forEach(function(n){if(t[n[1]]!=null){var a=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(En(Q1[n[1]]||n[1],a))}}),He("DocumentProperties",r.join(""),{xmlns:ma.o})}function hM(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return t&&Cr(t).forEach(function(o){if(Object.prototype.hasOwnProperty.call(t,o)){for(var l=0;l<Ha.length;++l)if(o==Ha[l][1])return;for(l=0;l<dl.length;++l)if(o==dl[l][1])return;for(l=0;l<r.length;++l)if(o==r[l])return;var u=t[o],h="string";typeof u=="number"?(h="float",u=String(u)):u===!0||u===!1?(h="boolean",u=u?"1":"0"):u=String(u),a.push(He(fw(o),u,{"dt:dt":h}))}}),e&&Cr(e).forEach(function(o){if(Object.prototype.hasOwnProperty.call(e,o)&&!(t&&Object.prototype.hasOwnProperty.call(t,o))){var l=e[o],u="string";typeof l=="number"?(u="float",l=String(l)):l===!0||l===!1?(u="boolean",l=l?"1":"0"):l instanceof Date?(u="dateTime.tz",l=l.toISOString()):l=String(l),a.push(He(fw(o),l,{"dt:dt":u}))}}),"<"+n+' xmlns="'+ma.o+'">'+a.join("")+"</"+n+">"}function Iv(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function dM(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var o=n/Math.pow(2,32)|0;o>0&&(n=n%Math.pow(2,32),a+=o);var l=Ae(8);return l.write_shift(4,n),l.write_shift(4,a),l}function Xk(t,e,r){var n=t.l,a=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return a}function Kk(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function Yk(t,e,r){return e===31?Kk(t):Xk(t,e,r)}function Z1(t,e,r){return Yk(t,e,r===!1?0:4)}function mM(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return Yk(t,e,0)}function pM(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var a=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Xn,""),t.l-a&2&&(t.l+=2)}return r}function gM(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Xn,"");return r}function xM(t){var e=t.l,r=tm(t,Lk);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=tm(t,ea);return[r,n]}function vM(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(xM(t));return r}function bw(t,e){for(var r=t.read_shift(4),n={},a=0;a!=r;++a){var o=t.read_shift(4),l=t.read_shift(4);n[o]=t.read_shift(l,e===1200?"utf16le":"utf8").replace(Xn,"").replace(wf,"!"),e===1200&&l%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function $k(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function _M(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function tm(t,e,r){var n=t.read_shift(2),a,o=r||{};if(t.l+=2,e!==ww&&n!==e&&$P.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===ww?n:e){case 2:return a=t.read_shift(2,"i"),o.raw||(t.l+=2),a;case 3:return a=t.read_shift(4,"i"),a;case 11:return t.read_shift(4)!==0;case 19:return a=t.read_shift(4),a;case 30:return Xk(t,n,4).replace(Xn,"");case 31:return Kk(t);case 64:return Iv(t);case 65:return $k(t);case 71:return _M(t);case 80:return Z1(t,n,!o.raw).replace(Xn,"");case 81:return mM(t,n).replace(Xn,"");case 4108:return vM(t);case 4126:case 4127:return n==4127?pM(t):gM(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function kw(t,e){var r=Ae(4),n=Ae(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=Ae(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=dM(e);break;case 31:case 80:for(n=Ae(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return fn([r,n])}function Cw(t,e){var r=t.l,n=t.read_shift(4),a=t.read_shift(4),o=[],l=0,u=0,h=-1,d={};for(l=0;l!=a;++l){var p=t.read_shift(4),v=t.read_shift(4);o[l]=[p,v+r]}o.sort(function(B,N){return B[1]-N[1]});var _={};for(l=0;l!=a;++l){if(t.l!==o[l][1]){var E=!0;if(l>0&&e)switch(e[o[l-1][0]].t){case 2:t.l+2===o[l][1]&&(t.l+=2,E=!1);break;case 80:t.l<=o[l][1]&&(t.l=o[l][1],E=!1);break;case 4108:t.l<=o[l][1]&&(t.l=o[l][1],E=!1);break}if((!e||l==0)&&t.l<=o[l][1]&&(E=!1,t.l=o[l][1]),E)throw new Error("Read Error: Expected address "+o[l][1]+" at "+t.l+" :"+l)}if(e){var S=e[o[l][0]];if(_[S.n]=tm(t,S.t,{raw:!0}),S.p==="version"&&(_[S.n]=String(_[S.n]>>16)+"."+("0000"+String(_[S.n]&65535)).slice(-4)),S.n=="CodePage")switch(_[S.n]){case 0:_[S.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Za(u=_[S.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+_[S.n])}}else if(o[l][0]===1){if(u=_.CodePage=tm(t,Cv),Za(u),h!==-1){var y=t.l;t.l=o[h][1],d=bw(t,u),t.l=y}}else if(o[l][0]===0){if(u===0){h=l,t.l=o[l+1][1];continue}d=bw(t,u)}else{var w=d[o[l][0]],P;switch(t[t.l]){case 65:t.l+=4,P=$k(t);break;case 30:t.l+=4,P=Z1(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,P=Z1(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,P=t.read_shift(4,"i");break;case 19:t.l+=4,P=t.read_shift(4);break;case 5:t.l+=4,P=t.read_shift(8,"f");break;case 11:t.l+=4,P=Or(t,4);break;case 64:t.l+=4,P=mr(Iv(t));break;default:throw new Error("unparsed value: "+t[t.l])}_[w]=P}}return t.l=r+n,_}var Qk=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function yM(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function Rw(t,e,r){var n=Ae(8),a=[],o=[],l=8,u=0,h=Ae(8),d=Ae(8);if(h.write_shift(4,2),h.write_shift(4,1200),d.write_shift(4,1),o.push(h),a.push(d),l+=8+h.length,!e){d=Ae(8),d.write_shift(4,0),a.unshift(d);var p=[Ae(4)];for(p[0].write_shift(4,t.length),u=0;u<t.length;++u){var v=t[u][0];for(h=Ae(8+2*(v.length+1)+(v.length%2?0:2)),h.write_shift(4,u+2),h.write_shift(4,v.length+1),h.write_shift(0,v,"dbcs");h.l!=h.length;)h.write_shift(1,0);p.push(h)}h=fn(p),o.unshift(h),l+=8+h.length}for(u=0;u<t.length;++u)if(!(e&&!e[t[u][0]])&&!(Qk.indexOf(t[u][0])>-1||zk.indexOf(t[u][0])>-1)&&t[u][1]!=null){var _=t[u][1],E=0;if(e){E=+e[t[u][0]];var S=r[E];if(S.p=="version"&&typeof _=="string"){var y=_.split(".");_=(+y[0]<<16)+(+y[1]||0)}h=kw(S.t,_)}else{var w=yM(_);w==-1&&(w=31,_=String(_)),h=kw(w,_)}o.push(h),d=Ae(8),d.write_shift(4,e?E:2+u),a.push(d),l+=8+h.length}var P=8*(o.length+1);for(u=0;u<o.length;++u)a[u].write_shift(4,P),P+=o[u].length;return n.write_shift(4,l),n.write_shift(4,o.length),fn([n].concat(a).concat(o))}function Iw(t,e,r){var n=t.content;if(!n)return{};_n(n,0);var a,o,l,u,h=0;n.chk("feff","Byte Order: "),n.read_shift(2);var d=n.read_shift(4),p=n.read_shift(16);if(p!==Je.utils.consts.HEADER_CLSID&&p!==r)throw new Error("Bad PropertySet CLSID "+p);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(o=n.read_shift(16),u=n.read_shift(4),a===1&&u!==n.l)throw new Error("Length mismatch: "+u+" !== "+n.l);a===2&&(l=n.read_shift(16),h=n.read_shift(4));var v=Cw(n,e),_={SystemIdentifier:d};for(var E in v)_[E]=v[E];if(_.FMTID=o,a===1)return _;if(h-n.l==2&&(n.l+=2),n.l!==h)throw new Error("Length mismatch 2: "+n.l+" !== "+h);var S;try{S=Cw(n,null)}catch{}for(E in S)_[E]=S[E];return _.FMTID=[o,l],_}function Nw(t,e,r,n,a,o){var l=Ae(a?68:48),u=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,Je.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,a?2:1),l.write_shift(16,e,"hex"),l.write_shift(4,a?68:48);var h=Rw(t,r,n);if(u.push(h),a){var d=Rw(a,null,null);l.write_shift(16,o,"hex"),l.write_shift(4,68+h.length),u.push(d)}return fn(u)}function Qs(t,e){return t.read_shift(e),null}function EM(t,e){e||(e=Ae(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function TM(t,e,r){for(var n=[],a=t.l+e;t.l<a;)n.push(r(t,a-t.l));if(a!==t.l)throw new Error("Slurp error");return n}function Or(t,e){return t.read_shift(e)===1}function qn(t,e){return e||(e=Ae(2)),e.write_shift(2,+!!t),e}function qr(t){return t.read_shift(2,"u")}function Va(t,e){return e||(e=Ae(2)),e.write_shift(2,t),e}function Zk(t,e){return TM(t,e,qr)}function wM(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function Jk(t,e,r){return r||(r=Ae(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function C0(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var o=t.read_shift(1);o&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var l=n?t.read_shift(n,a):"";return l}function SM(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,a=r&8,o=1+(r&1),l=0,u,h={};a&&(l=t.read_shift(2)),n&&(u=t.read_shift(4));var d=o==2?"dbcs-cont":"sbcs-cont",p=e===0?"":t.read_shift(e,d);return a&&(t.l+=4*l),n&&(t.l+=u),h.t=p,a||(h.raw="<t>"+h.t+"</t>",h.r=h.t),h}function AM(t){var e=t.t||"",r=Ae(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=Ae(2*e.length);n.write_shift(2*e.length,e,"utf16le");var a=[r,n];return fn(a)}function kl(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var a=t.read_shift(1);return a===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function R0(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):kl(t,n,r)}function Vl(t,e,r){if(r.biff>5)return R0(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function e4(t,e,r){return r||(r=Ae(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function bM(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function kM(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var a=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Xn,"");return n&&(t.l+=24),a}function CM(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=t.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var o=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=t.read_shift(o>>1,"utf16le").replace(Xn,"");return r+l}function RM(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return kM(t);case"0303000000000000c000000000000046":return CM(t);default:throw new Error("Unsupported Moniker "+r)}}function cd(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Xn,""):"";return r}function Dw(t,e){e||(e=Ae(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function IM(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=t.read_shift(2);t.l+=2;var o,l,u,h,d="",p,v;a&16&&(o=cd(t,r-t.l)),a&128&&(l=cd(t,r-t.l)),(a&257)===257&&(u=cd(t,r-t.l)),(a&257)===1&&(h=RM(t,r-t.l)),a&8&&(d=cd(t,r-t.l)),a&32&&(p=t.read_shift(16)),a&64&&(v=Iv(t)),t.l=r;var _=l||u||h||"";_&&d&&(_+="#"+d),_||(_="#"+d),a&2&&_.charAt(0)=="/"&&_.charAt(1)!="/"&&(_="file://"+_);var E={Target:_};return p&&(E.guid=p),v&&(E.time=v),o&&(E.Tooltip=o),E}function NM(t){var e=Ae(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),o=a>-1?31:23;switch(n.charAt(0)){case"#":o=28;break;case".":o&=-3;break}e.write_shift(4,2),e.write_shift(4,o);var l=[8,6815827,6619237,4849780,83];for(r=0;r<l.length;++r)e.write_shift(4,l[r]);if(o==28)n=n.slice(1),Dw(n,e);else if(o&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<l.length;++r)e.write_shift(1,parseInt(l[r],16));var u=a>-1?n.slice(0,a):n;for(e.write_shift(4,2*(u.length+1)),r=0;r<u.length;++r)e.write_shift(2,u.charCodeAt(r));e.write_shift(2,0),o&8&&Dw(a>-1?n.slice(a+1):"",e)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<l.length;++r)e.write_shift(1,parseInt(l[r],16));for(var h=0;n.slice(h*3,h*3+3)=="../"||n.slice(h*3,h*3+3)=="..\\";)++h;for(e.write_shift(2,h),e.write_shift(4,n.length-3*h+1),r=0;r<n.length-3*h;++r)e.write_shift(1,n.charCodeAt(r+3*h)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function t4(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),a=t.read_shift(1);return[e,r,n,a]}function r4(t,e){var r=t4(t);return r[3]=0,r}function Vi(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function Cl(t,e,r,n){return n||(n=Ae(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function DM(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function OM(t,e,r){return e===0?"":Vl(t,e,r)}function FM(t,e,r){var n=r.biff>8?4:2,a=t.read_shift(n),o=t.read_shift(n,"i"),l=t.read_shift(n,"i");return[a,o,l]}function n4(t){var e=t.read_shift(2),r=kv(t);return[e,r]}function PM(t,e,r){t.l+=4,e-=4;var n=t.l+e,a=C0(t,e,r),o=t.read_shift(2);if(n-=t.l,o!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+o);return t.l+=o,a}function Dm(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),a=t.read_shift(2);return{s:{c:n,r:e},e:{c:a,r}}}function a4(t,e){return e||(e=Ae(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function i4(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),a=t.read_shift(1);return{s:{c:n,r:e},e:{c:a,r}}}var MM=i4;function s4(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function LM(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function UM(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function bn(t){t.l+=2,t.l+=t.read_shift(2)}var BM={0:bn,4:bn,5:bn,6:bn,7:UM,8:bn,9:bn,10:bn,11:bn,12:bn,13:LM,14:bn,15:bn,16:bn,17:bn,18:bn,19:bn,20:bn,21:s4};function VM(t,e){for(var r=t.l+e,n=[];t.l<r;){var a=t.read_shift(2);t.l-=2;try{n.push(BM[a](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function ud(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function Nv(t,e,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var o=Ae(a);return o.write_shift(2,n),o.write_shift(2,e),a>4&&o.write_shift(2,29282),a>6&&o.write_shift(2,1997),a>8&&(o.write_shift(2,49161),o.write_shift(2,1),o.write_shift(2,1798),o.write_shift(2,0)),o}function jM(t,e){return e===0||t.read_shift(2),1200}function HM(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,a=Vl(t,0,r);return t.read_shift(e+n-t.l),a}function zM(t,e){var r=!e||e.biff==8,n=Ae(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function GM(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function qM(t,e,r){var n=t.read_shift(4),a=t.read_shift(1)&3,o=t.read_shift(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule";break}var l=C0(t,0,r);return l.length===0&&(l="Sheet1"),{pos:n,hs:a,dt:o,name:l}}function WM(t,e){var r=!e||e.biff>=8?2:1,n=Ae(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function XM(t,e){for(var r=t.l+e,n=t.read_shift(4),a=t.read_shift(4),o=[],l=0;l!=a&&t.l<r;++l)o.push(SM(t));return o.Count=n,o.Unique=a,o}function KM(t,e){var r=Ae(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],a=0;a<t.length;++a)n[a]=AM(t[a]);var o=fn([r].concat(n));return o.parts=[r.length].concat(n.map(function(l){return l.length})),o}function YM(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function $M(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function QM(t){var e=DM(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function ZM(t){return t.read_shift(2),t.read_shift(4)}function Ow(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var a=t.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var o={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[o,a]}function JM(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),u=t.read_shift(2),h=t.read_shift(2),d=t.read_shift(2);return{Pos:[e,r],Dim:[n,a],Flags:o,CurTab:l,FirstTab:u,Selected:h,TabRatio:d}}function eL(){var t=Ae(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function tL(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function rL(t){var e=Ae(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function nL(){}function aL(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=C0(t,0,r),n}function iL(t,e){var r=t.name||"Arial",n=e&&e.biff==5,a=n?15+r.length:16+2*r.length,o=Ae(a);return o.write_shift(2,t.sz*20),o.write_shift(4,0),o.write_shift(2,400),o.write_shift(4,0),o.write_shift(2,0),o.write_shift(1,r.length),n||o.write_shift(1,1),o.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),o}function sL(t){var e=Vi(t);return e.isst=t.read_shift(4),e}function oL(t,e,r,n){var a=Ae(10);return Cl(t,e,n,a),a.write_shift(4,r),a}function lL(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,a=Vi(t);r.biff==2&&t.l++;var o=R0(t,n-t.l,r);return a.val=o,a}function cL(t,e,r,n,a){var o=!a||a.biff==8,l=Ae(8+ +o+(1+o)*r.length);return Cl(t,e,n,l),l.write_shift(2,r.length),o&&l.write_shift(1,1),l.write_shift((1+o)*r.length,r,o?"utf16le":"sbcs"),l}function uL(t,e,r){var n=t.read_shift(2),a=Vl(t,0,r);return[n,a]}function fL(t,e,r,n){var a=r&&r.biff==5;n||(n=Ae(a?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(a?1:2,e.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*e.length,e,a?"sbcs":"utf16le");var o=n.length>n.l?n.slice(0,n.l):n;return o.l==null&&(o.l=o.length),o}var hL=Vl;function Fw(t,e,r){var n=t.l+e,a=r.biff==8||!r.biff?4:2,o=t.read_shift(a),l=t.read_shift(a),u=t.read_shift(2),h=t.read_shift(2);return t.l=n,{s:{r:o,c:u},e:{r:l,c:h}}}function dL(t,e){var r=e.biff==8||!e.biff?4:2,n=Ae(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function mL(t){var e=t.read_shift(2),r=t.read_shift(2),n=n4(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function pL(t,e){for(var r=t.l+e-2,n=t.read_shift(2),a=t.read_shift(2),o=[];t.l<r;)o.push(n4(t));if(t.l!==r)throw new Error("MulRK read error");var l=t.read_shift(2);if(o.length!=l-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:l,rkrec:o}}function gL(t,e){for(var r=t.l+e-2,n=t.read_shift(2),a=t.read_shift(2),o=[];t.l<r;)o.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var l=t.read_shift(2);if(o.length!=l-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:l,ixfe:o}}function xL(t,e,r,n){var a={},o=t.read_shift(4),l=t.read_shift(4),u=t.read_shift(4),h=t.read_shift(2);return a.patternType=QP[u>>26],n.cellStyles&&(a.alc=o&7,a.fWrap=o>>3&1,a.alcV=o>>4&7,a.fJustLast=o>>7&1,a.trot=o>>8&255,a.cIndent=o>>16&15,a.fShrinkToFit=o>>20&1,a.iReadOrder=o>>22&2,a.fAtrNum=o>>26&1,a.fAtrFnt=o>>27&1,a.fAtrAlc=o>>28&1,a.fAtrBdr=o>>29&1,a.fAtrPat=o>>30&1,a.fAtrProt=o>>31&1,a.dgLeft=l&15,a.dgRight=l>>4&15,a.dgTop=l>>8&15,a.dgBottom=l>>12&15,a.icvLeft=l>>16&127,a.icvRight=l>>23&127,a.grbitDiag=l>>30&3,a.icvTop=u&127,a.icvBottom=u>>7&127,a.icvDiag=u>>14&127,a.dgDiag=u>>21&15,a.icvFore=h&127,a.icvBack=h>>7&127,a.fsxButton=h>>14&1),a}function vL(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=xL(t,e,n.fStyle,r),n}function Pw(t,e,r,n){var a=r&&r.biff==5;n||(n=Ae(a?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var o=0;return t.numFmtId>0&&a&&(o|=1024),n.write_shift(4,o),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function _L(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function yL(t){var e=Ae(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function Mw(t,e,r){var n=Vi(t);(r.biff==2||e==9)&&++t.l;var a=wM(t);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function EL(t,e,r,n,a,o){var l=Ae(8);return Cl(t,e,n,l),Jk(r,o,l),l}function TL(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Vi(t),a=Dn(t);return n.val=a,n}function wL(t,e,r,n){var a=Ae(14);return Cl(t,e,n,a),bl(r,a),a}var Lw=OM;function SL(t,e,r){var n=t.l+e,a=t.read_shift(2),o=t.read_shift(2);if(r.sbcch=o,o==1025||o==14849)return[o,a];if(o<1||o>255)throw new Error("Unexpected SupBook type: "+o);for(var l=kl(t,o),u=[];n>t.l;)u.push(R0(t));return[o,a,l,u]}function Uw(t,e,r){var n=t.read_shift(2),a,o={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=PM(t,e-2,r)),o.body=a||t.read_shift(e-2),typeof a=="string"&&(o.Name=a),o}var AL=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Bw(t,e,r){var n=t.l+e,a=t.read_shift(2),o=t.read_shift(1),l=t.read_shift(1),u=t.read_shift(r&&r.biff==2?1:2),h=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),h=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var d=kl(t,l,r);a&32&&(d=AL[d.charCodeAt(0)]);var p=n-t.l;r&&r.biff==2&&--p;var v=n==t.l||u===0||!(p>0)?[]:VB(t,p,r,u);return{chKey:o,Name:d,itab:h,rgce:v}}function o4(t,e,r){if(r.biff<8)return bL(t,e,r);for(var n=[],a=t.l+e,o=t.read_shift(r.biff>8?4:2);o--!==0;)n.push(FM(t,r.biff>8?12:6,r));if(t.l!=a)throw new Error("Bad ExternSheet: "+t.l+" != "+a);return n}function bL(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=C0(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function kL(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),a=t.read_shift(2),o=kl(t,n,r),l=kl(t,a,r);return[o,l]}function CL(t,e,r){var n=i4(t);t.l++;var a=t.read_shift(1);return e-=8,[jB(t,e,r),a,n]}function Vw(t,e,r){var n=MM(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,UB(t,e,r)]}function RL(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function IL(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),u=Vl(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:a},u,l,o]}}function NL(t,e,r){return IL(t,e,r)}function DL(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Dm(t));return r}function OL(t){var e=Ae(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)a4(t[r],e);return e}function FL(t,e,r){if(r&&r.biff<8)return ML(t,e,r);var n=s4(t),a=VM(t,e-22,n[1]);return{cmo:n,ft:a}}var PL={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var a=t.read_shift(1);return t.l+=a,t.l=r,{fmt:n}}};function ML(t,e,r){t.l+=4;var n=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var l=[];return l.push((PL[n]||Pn)(t,e,r)),{cmo:[a,n,o],ft:l}}function LL(t,e,r){var n=t.l,a="";try{t.l+=4;var o=(r.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(o)==-1?t.l+=6:l=bM(t,6,r);var u=t.read_shift(2);t.read_shift(2),qr(t,2);var h=t.read_shift(2);t.l+=h;for(var d=1;d<t.lens.length-1;++d){if(t.l-n!=t.lens[d])throw new Error("TxO: bad continue record");var p=t[t.l],v=kl(t,t.lens[d+1]-t.lens[d]-1);if(a+=v,a.length>=(p?u:2*u))break}if(a.length!==u&&a.length!==u*2)throw new Error("cchText: "+u+" != "+a.length);return t.l=n+e,{t:a}}catch{return t.l=n+e,{t:a}}}function UL(t,e){var r=Dm(t);t.l+=16;var n=IM(t,e-24);return[r,n]}function BL(t){var e=Ae(24),r=yr(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)e.write_shift(1,parseInt(n[a],16));return fn([e,NM(t[1])])}function VL(t,e){t.read_shift(2);var r=Dm(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Xn,""),[r,n]}function jL(t){var e=t[1].Tooltip,r=Ae(10+2*(e.length+1));r.write_shift(2,2048);var n=yr(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<e.length;++a)r.write_shift(2,e.charCodeAt(a));return r.write_shift(2,0),r}function HL(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=Sw[r]||r,r=t.read_shift(2),e[1]=Sw[r]||r,e}function zL(t){return t||(t=Ae(4)),t.write_shift(2,1),t.write_shift(2,1),t}function GL(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(r4(t));return r}function qL(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(r4(t));return r}function WL(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function l4(t,e,r){if(!r.cellStyles)return Pn(t,e);var n=r&&r.biff>=12?4:2,a=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(n),u=t.read_shift(n),h=t.read_shift(2);n==2&&(t.l+=2);var d={s:a,e:o,w:l,ixfe:u,flags:h};return(r.biff>=5||!r.biff)&&(d.level=h>>8&7),d}function XL(t,e){var r=Ae(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function KL(t,e){var r={};return e<32||(t.l+=16,r.header=Dn(t),r.footer=Dn(t),t.l+=2),r}function YL(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var a=t.read_shift(1);return t.l+=3,a&16&&(n.area=!0),n}function $L(t){for(var e=Ae(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var QL=Vi,ZL=Zk,JL=R0;function e9(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),a={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,a}function t9(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Vi(t);++t.l;var a=Vl(t,e-7,r);return n.t="str",n.val=a,n}function r9(t){var e=Vi(t);++t.l;var r=Dn(t);return e.t="n",e.val=r,e}function n9(t,e,r){var n=Ae(15);return O0(n,t,e),n.write_shift(8,r,"f"),n}function a9(t){var e=Vi(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function i9(t,e,r){var n=Ae(9);return O0(n,t,e),n.write_shift(2,r),n}function s9(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function o9(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function l9(t,e,r){var n=t.l+e,a=Vi(t),o=t.read_shift(2),l=kl(t,o,r);return t.l=n,a.t="str",a.val=l,a}var c9=[2,3,48,49,131,139,140,245],J1=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Rm({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(u,h){var d=[],p=Eo(1);switch(h.type){case"base64":p=xa(Ea(u));break;case"binary":p=xa(u);break;case"buffer":case"array":p=u;break}_n(p,0);var v=p.read_shift(1),_=!!(v&136),E=!1,S=!1;switch(v){case 2:break;case 3:break;case 48:E=!0,_=!0;break;case 49:E=!0,_=!0;break;case 131:break;case 139:break;case 140:S=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+v.toString(16))}var y=0,w=521;v==2&&(y=p.read_shift(2)),p.l+=3,v!=2&&(y=p.read_shift(4)),y>1048576&&(y=1e6),v!=2&&(w=p.read_shift(2));var P=p.read_shift(2),B=h.codepage||1252;v!=2&&(p.l+=16,p.read_shift(1),p[p.l]!==0&&(B=t[p[p.l]]),p.l+=1,p.l+=2),S&&(p.l+=36);for(var N=[],z={},q=Math.min(p.length,v==2?521:w-10-(E?264:0)),Z=S?32:11;p.l<q&&p[p.l]!=13;)switch(z={},z.name=$f.utils.decode(B,p.slice(p.l,p.l+Z)).replace(/[\u0000\r\n].*$/g,""),p.l+=Z,z.type=String.fromCharCode(p.read_shift(1)),v!=2&&!S&&(z.offset=p.read_shift(4)),z.len=p.read_shift(1),v==2&&(z.offset=p.read_shift(2)),z.dec=p.read_shift(1),z.name.length&&N.push(z),v!=2&&(p.l+=S?13:14),z.type){case"B":(!E||z.len!=8)&&h.WTF&&console.log("Skipping "+z.name+":"+z.type);break;case"G":case"P":h.WTF&&console.log("Skipping "+z.name+":"+z.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+z.type)}if(p[p.l]!==13&&(p.l=w-1),p.read_shift(1)!==13)throw new Error("DBF Terminator not found "+p.l+" "+p[p.l]);p.l=w;var C=0,I=0;for(d[0]=[],I=0;I!=N.length;++I)d[0][I]=N[I].name;for(;y-- >0;){if(p[p.l]===42){p.l+=P;continue}for(++p.l,d[++C]=[],I=0,I=0;I!=N.length;++I){var b=p.slice(p.l,p.l+N[I].len);p.l+=N[I].len,_n(b,0);var O=$f.utils.decode(B,b);switch(N[I].type){case"C":O.trim().length&&(d[C][I]=O.replace(/\s+$/,""));break;case"D":O.length===8?d[C][I]=new Date(+O.slice(0,4),+O.slice(4,6)-1,+O.slice(6,8)):d[C][I]=O;break;case"F":d[C][I]=parseFloat(O.trim());break;case"+":case"I":d[C][I]=S?b.read_shift(-4,"i")^2147483648:b.read_shift(4,"i");break;case"L":switch(O.trim().toUpperCase()){case"Y":case"T":d[C][I]=!0;break;case"N":case"F":d[C][I]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+O+"|")}break;case"M":if(!_)throw new Error("DBF Unexpected MEMO for type "+v.toString(16));d[C][I]="##MEMO##"+(S?parseInt(O.trim(),10):b.read_shift(4));break;case"N":O=O.replace(/\u0000/g,"").trim(),O&&O!="."&&(d[C][I]=+O||0);break;case"@":d[C][I]=new Date(b.read_shift(-8,"f")-621356832e5);break;case"T":d[C][I]=new Date((b.read_shift(4)-2440588)*864e5+b.read_shift(4));break;case"Y":d[C][I]=b.read_shift(4,"i")/1e4+b.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[C][I]=-b.read_shift(-8,"f");break;case"B":if(E&&N[I].len==8){d[C][I]=b.read_shift(8,"f");break}case"G":case"P":b.l+=N[I].len;break;case"0":if(N[I].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+N[I].type)}}}if(v!=2&&p.l<p.length&&p[p.l++]!=26)throw new Error("DBF EOF Marker missing "+(p.l-1)+" of "+p.length+" "+p[p.l-1].toString(16));return h&&h.sheetRows&&(d=d.slice(0,h.sheetRows)),h.DBF=N,d}function n(u,h){var d=h||{};d.dateNF||(d.dateNF="yyyymmdd");var p=uu(r(u,d),d);return p["!cols"]=d.DBF.map(function(v){return{wch:v.len,DBF:v}}),delete d.DBF,p}function a(u,h){try{return No(n(u,h),h)}catch(d){if(h&&h.WTF)throw d}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function l(u,h){var d=h||{};if(+d.codepage>=0&&Za(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var p=na(),v=am(u,{header:1,raw:!0,cellDates:!0}),_=v[0],E=v.slice(1),S=u["!cols"]||[],y=0,w=0,P=0,B=1;for(y=0;y<_.length;++y){if(((S[y]||{}).DBF||{}).name){_[y]=S[y].DBF.name,++P;continue}if(_[y]!=null){if(++P,typeof _[y]=="number"&&(_[y]=_[y].toString(10)),typeof _[y]!="string")throw new Error("DBF Invalid column name "+_[y]+" |"+typeof _[y]+"|");if(_.indexOf(_[y])!==y){for(w=0;w<1024;++w)if(_.indexOf(_[y]+"_"+w)==-1){_[y]+="_"+w;break}}}}var N=Ht(u["!ref"]),z=[],q=[],Z=[];for(y=0;y<=N.e.c-N.s.c;++y){var C="",I="",b=0,O=[];for(w=0;w<E.length;++w)E[w][y]!=null&&O.push(E[w][y]);if(O.length==0||_[y]==null){z[y]="?";continue}for(w=0;w<O.length;++w){switch(typeof O[w]){case"number":I="B";break;case"string":I="C";break;case"boolean":I="L";break;case"object":I=O[w]instanceof Date?"D":"C";break;default:I="C"}b=Math.max(b,String(O[w]).length),C=C&&C!=I?"C":I}b>250&&(b=250),I=((S[y]||{}).DBF||{}).type,I=="C"&&S[y].DBF.len>b&&(b=S[y].DBF.len),C=="B"&&I=="N"&&(C="N",Z[y]=S[y].DBF.dec,b=S[y].DBF.len),q[y]=C=="C"||I=="N"?b:o[C]||0,B+=q[y],z[y]=C}var L=p.next(32);for(L.write_shift(4,318902576),L.write_shift(4,E.length),L.write_shift(2,296+32*P),L.write_shift(2,B),y=0;y<4;++y)L.write_shift(4,0);for(L.write_shift(4,0|(+e[$b]||3)<<8),y=0,w=0;y<_.length;++y)if(_[y]!=null){var M=p.next(32),D=(_[y].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);M.write_shift(1,D,"sbcs"),M.write_shift(1,z[y]=="?"?"C":z[y],"sbcs"),M.write_shift(4,w),M.write_shift(1,q[y]||o[z[y]]||0),M.write_shift(1,Z[y]||0),M.write_shift(1,2),M.write_shift(4,0),M.write_shift(1,0),M.write_shift(4,0),M.write_shift(4,0),w+=q[y]||o[z[y]]||0}var Ee=p.next(264);for(Ee.write_shift(4,13),y=0;y<65;++y)Ee.write_shift(4,0);for(y=0;y<E.length;++y){var Te=p.next(B);for(Te.write_shift(1,0),w=0;w<_.length;++w)if(_[w]!=null)switch(z[w]){case"L":Te.write_shift(1,E[y][w]==null?63:E[y][w]?84:70);break;case"B":Te.write_shift(8,E[y][w]||0,"f");break;case"N":var ne="0";for(typeof E[y][w]=="number"&&(ne=E[y][w].toFixed(Z[w]||0)),P=0;P<q[w]-ne.length;++P)Te.write_shift(1,32);Te.write_shift(1,ne,"sbcs");break;case"D":E[y][w]?(Te.write_shift(4,("0000"+E[y][w].getFullYear()).slice(-4),"sbcs"),Te.write_shift(2,("00"+(E[y][w].getMonth()+1)).slice(-2),"sbcs"),Te.write_shift(2,("00"+E[y][w].getDate()).slice(-2),"sbcs")):Te.write_shift(8,"00000000","sbcs");break;case"C":var ue=String(E[y][w]!=null?E[y][w]:"").slice(0,q[w]);for(Te.write_shift(1,ue,"sbcs"),P=0;P<q[w]-ue.length;++P)Te.write_shift(1,32);break}}return p.next(1).write_shift(1,26),p.end()}return{to_workbook:a,to_sheet:n,from_sheet:l}}(),c4=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Cr(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(_,E){var S=t[E];return typeof S=="number"?QT(S):S},n=function(_,E,S){var y=E.charCodeAt(0)-32<<4|S.charCodeAt(0)-48;return y==59?_:QT(y)};t["|"]=254;function a(_,E){switch(E.type){case"base64":return o(Ea(_),E);case"binary":return o(_,E);case"buffer":return o(bt&&Buffer.isBuffer(_)?_.toString("binary"):Io(_),E);case"array":return o(Al(_),E)}throw new Error("Unrecognized type "+E.type)}function o(_,E){var S=_.split(/[\n\r]+/),y=-1,w=-1,P=0,B=0,N=[],z=[],q=null,Z={},C=[],I=[],b=[],O=0,L;for(+E.codepage>=0&&Za(+E.codepage);P!==S.length;++P){O=0;var M=S[P].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),D=M.replace(/;;/g,"\0").split(";").map(function(te){return te.replace(/\u0000/g,";")}),Ee=D[0],Te;if(M.length>0)switch(Ee){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":D[1].charAt(0)=="P"&&z.push(M.slice(3).replace(/;;/g,";"));break;case"C":var ne=!1,ue=!1,Ue=!1,ie=!1,K=-1,pe=-1;for(B=1;B<D.length;++B)switch(D[B].charAt(0)){case"A":break;case"X":w=parseInt(D[B].slice(1))-1,ue=!0;break;case"Y":for(y=parseInt(D[B].slice(1))-1,ue||(w=0),L=N.length;L<=y;++L)N[L]=[];break;case"K":Te=D[B].slice(1),Te.charAt(0)==='"'?Te=Te.slice(1,Te.length-1):Te==="TRUE"?Te=!0:Te==="FALSE"?Te=!1:isNaN(ti(Te))?isNaN(Jc(Te).getDate())||(Te=mr(Te)):(Te=ti(Te),q!==null&&Fl(q)&&(Te=Nm(Te))),ne=!0;break;case"E":ie=!0;var V=qc(D[B].slice(1),{r:y,c:w});N[y][w]=[N[y][w],V];break;case"S":Ue=!0,N[y][w]=[N[y][w],"S5S"];break;case"G":break;case"R":K=parseInt(D[B].slice(1))-1;break;case"C":pe=parseInt(D[B].slice(1))-1;break;default:if(E&&E.WTF)throw new Error("SYLK bad record "+M)}if(ne&&(N[y][w]&&N[y][w].length==2?N[y][w][0]=Te:N[y][w]=Te,q=null),Ue){if(ie)throw new Error("SYLK shared formula cannot have own formula");var X=K>-1&&N[K][pe];if(!X||!X[1])throw new Error("SYLK shared formula cannot find base");N[y][w][1]=k4(X[1],{r:y-K,c:w-pe})}break;case"F":var ee=0;for(B=1;B<D.length;++B)switch(D[B].charAt(0)){case"X":w=parseInt(D[B].slice(1))-1,++ee;break;case"Y":for(y=parseInt(D[B].slice(1))-1,L=N.length;L<=y;++L)N[L]=[];break;case"M":O=parseInt(D[B].slice(1))/20;break;case"F":break;case"G":break;case"P":q=z[parseInt(D[B].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(b=D[B].slice(1).split(" "),L=parseInt(b[0],10);L<=parseInt(b[1],10);++L)O=parseInt(b[2],10),I[L-1]=O===0?{hidden:!0}:{wch:O},To(I[L-1]);break;case"C":w=parseInt(D[B].slice(1))-1,I[w]||(I[w]={});break;case"R":y=parseInt(D[B].slice(1))-1,C[y]||(C[y]={}),O>0?(C[y].hpt=O,C[y].hpx=tu(O)):O===0&&(C[y].hidden=!0);break;default:if(E&&E.WTF)throw new Error("SYLK bad record "+M)}ee<1&&(q=null);break;default:if(E&&E.WTF)throw new Error("SYLK bad record "+M)}}return C.length>0&&(Z["!rows"]=C),I.length>0&&(Z["!cols"]=I),E&&E.sheetRows&&(N=N.slice(0,E.sheetRows)),[N,Z]}function l(_,E){var S=a(_,E),y=S[0],w=S[1],P=uu(y,E);return Cr(w).forEach(function(B){P[B]=w[B]}),P}function u(_,E){return No(l(_,E),E)}function h(_,E,S,y){var w="C;Y"+(S+1)+";X"+(y+1)+";K";switch(_.t){case"n":w+=_.v||0,_.f&&!_.F&&(w+=";E"+Lv(_.f,{r:S,c:y}));break;case"b":w+=_.v?"TRUE":"FALSE";break;case"e":w+=_.w||_.v;break;case"d":w+='"'+(_.w||_.v)+'"';break;case"s":w+='"'+_.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function d(_,E){E.forEach(function(S,y){var w="F;W"+(y+1)+" "+(y+1)+" ";S.hidden?w+="0":(typeof S.width=="number"&&!S.wpx&&(S.wpx=a0(S.width)),typeof S.wpx=="number"&&!S.wch&&(S.wch=i0(S.wpx)),typeof S.wch=="number"&&(w+=Math.round(S.wch))),w.charAt(w.length-1)!=" "&&_.push(w)})}function p(_,E){E.forEach(function(S,y){var w="F;";S.hidden?w+="M0;":S.hpt?w+="M"+20*S.hpt+";":S.hpx&&(w+="M"+20*s0(S.hpx)+";"),w.length>2&&_.push(w+"R"+(y+1))})}function v(_,E){var S=["ID;PWXL;N;E"],y=[],w=Ht(_["!ref"]),P,B=Array.isArray(_),N=`\r
`;S.push("P;PGeneral"),S.push("F;P0;DG0G8;M255"),_["!cols"]&&d(S,_["!cols"]),_["!rows"]&&p(S,_["!rows"]),S.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var z=w.s.r;z<=w.e.r;++z)for(var q=w.s.c;q<=w.e.c;++q){var Z=lt({r:z,c:q});P=B?(_[z]||[])[q]:_[Z],!(!P||P.v==null&&(!P.f||P.F))&&y.push(h(P,_,z,q))}return S.join(N)+N+y.join(N)+N+"E"+N}return{to_workbook:u,to_sheet:l,from_sheet:v}}(),u4=function(){function t(o,l){switch(l.type){case"base64":return e(Ea(o),l);case"binary":return e(o,l);case"buffer":return e(bt&&Buffer.isBuffer(o)?o.toString("binary"):Io(o),l);case"array":return e(Al(o),l)}throw new Error("Unrecognized type "+l.type)}function e(o,l){for(var u=o.split(`
`),h=-1,d=-1,p=0,v=[];p!==u.length;++p){if(u[p].trim()==="BOT"){v[++h]=[],d=0;continue}if(!(h<0)){var _=u[p].trim().split(","),E=_[0],S=_[1];++p;for(var y=u[p]||"";(y.match(/["]/g)||[]).length&1&&p<u.length-1;)y+=`
`+u[++p];switch(y=y.trim(),+E){case-1:if(y==="BOT"){v[++h]=[],d=0;continue}else if(y!=="EOD")throw new Error("Unrecognized DIF special command "+y);break;case 0:y==="TRUE"?v[h][d]=!0:y==="FALSE"?v[h][d]=!1:isNaN(ti(S))?isNaN(Jc(S).getDate())?v[h][d]=S:v[h][d]=mr(S):v[h][d]=ti(S),++d;break;case 1:y=y.slice(1,y.length-1),y=y.replace(/""/g,'"'),y&&y.match(/^=".*"$/)&&(y=y.slice(2,-1)),v[h][d++]=y!==""?y:null;break}if(y==="EOD")break}}return l&&l.sheetRows&&(v=v.slice(0,l.sheetRows)),v}function r(o,l){return uu(t(o,l),l)}function n(o,l){return No(r(o,l),l)}var a=function(){var o=function(h,d,p,v,_){h.push(d),h.push(p+","+v),h.push('"'+_.replace(/"/g,'""')+'"')},l=function(h,d,p,v){h.push(d+","+p),h.push(d==1?'"'+v.replace(/"/g,'""')+'"':v)};return function(h){var d=[],p=Ht(h["!ref"]),v,_=Array.isArray(h);o(d,"TABLE",0,1,"sheetjs"),o(d,"VECTORS",0,p.e.r-p.s.r+1,""),o(d,"TUPLES",0,p.e.c-p.s.c+1,""),o(d,"DATA",0,0,"");for(var E=p.s.r;E<=p.e.r;++E){l(d,-1,0,"BOT");for(var S=p.s.c;S<=p.e.c;++S){var y=lt({r:E,c:S});if(v=_?(h[E]||[])[S]:h[y],!v){l(d,1,0,"");continue}switch(v.t){case"n":var w=v.w;!w&&v.v!=null&&(w=v.v),w==null?v.f&&!v.F?l(d,1,0,"="+v.f):l(d,1,0,""):l(d,0,w,"V");break;case"b":l(d,0,v.v?1:0,v.v?"TRUE":"FALSE");break;case"s":l(d,1,0,isNaN(v.v)?v.v:'="'+v.v+'"');break;case"d":v.w||(v.w=Ta(v.z||tt[14],rn(mr(v.v)))),l(d,0,v.w,"V");break;default:l(d,1,0,"")}}}l(d,-1,0,"EOD");var P=`\r
`,B=d.join(P);return B}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),f4=function(){function t(v){return v.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(v){return v.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(v,_){for(var E=v.split(`
`),S=-1,y=-1,w=0,P=[];w!==E.length;++w){var B=E[w].trim().split(":");if(B[0]==="cell"){var N=yr(B[1]);if(P.length<=N.r)for(S=P.length;S<=N.r;++S)P[S]||(P[S]=[]);switch(S=N.r,y=N.c,B[2]){case"t":P[S][y]=t(B[3]);break;case"v":P[S][y]=+B[3];break;case"vtf":var z=B[B.length-1];case"vtc":switch(B[3]){case"nl":P[S][y]=!!+B[4];break;default:P[S][y]=+B[4];break}B[2]=="vtf"&&(P[S][y]=[P[S][y],z])}}}return _&&_.sheetRows&&(P=P.slice(0,_.sheetRows)),P}function n(v,_){return uu(r(v,_),_)}function a(v,_){return No(n(v,_),_)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),h="--SocialCalcSpreadsheetControlSave--";function d(v){if(!v||!v["!ref"])return"";for(var _=[],E=[],S,y="",w=aa(v["!ref"]),P=Array.isArray(v),B=w.s.r;B<=w.e.r;++B)for(var N=w.s.c;N<=w.e.c;++N)if(y=lt({r:B,c:N}),S=P?(v[B]||[])[N]:v[y],!(!S||S.v==null||S.t==="z")){switch(E=["cell",y,"t"],S.t){case"s":case"str":E.push(e(S.v));break;case"n":S.f?(E[2]="vtf",E[3]="n",E[4]=S.v,E[5]=e(S.f)):(E[2]="v",E[3]=S.v);break;case"b":E[2]="vt"+(S.f?"f":"c"),E[3]="nl",E[4]=S.v?"1":"0",E[5]=e(S.f||(S.v?"TRUE":"FALSE"));break;case"d":var z=rn(mr(S.v));E[2]="vtc",E[3]="nd",E[4]=""+z,E[5]=S.w||Ta(S.z||tt[14],z);break;case"e":continue}_.push(E.join(":"))}return _.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),_.push("valueformat:1:text-wiki"),_.join(`
`)}function p(v){return[o,l,u,l,d(v),h].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:p}}(),eu=function(){function t(p,v,_,E,S){S.raw?v[_][E]=p:p===""||(p==="TRUE"?v[_][E]=!0:p==="FALSE"?v[_][E]=!1:isNaN(ti(p))?isNaN(Jc(p).getDate())?v[_][E]=p:v[_][E]=mr(p):v[_][E]=ti(p))}function e(p,v){var _=v||{},E=[];if(!p||p.length===0)return E;for(var S=p.split(/[\r\n]/),y=S.length-1;y>=0&&S[y].length===0;)--y;for(var w=10,P=0,B=0;B<=y;++B)P=S[B].indexOf(" "),P==-1?P=S[B].length:P++,w=Math.max(w,P);for(B=0;B<=y;++B){E[B]=[];var N=0;for(t(S[B].slice(0,w).trim(),E,B,N,_),N=1;N<=(S[B].length-w)/10+1;++N)t(S[B].slice(w+(N-1)*10,w+N*10).trim(),E,B,N,_)}return _.sheetRows&&(E=E.slice(0,_.sheetRows)),E}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(p){for(var v={},_=!1,E=0,S=0;E<p.length;++E)(S=p.charCodeAt(E))==34?_=!_:!_&&S in r&&(v[S]=(v[S]||0)+1);S=[];for(E in v)Object.prototype.hasOwnProperty.call(v,E)&&S.push([v[E],E]);if(!S.length){v=n;for(E in v)Object.prototype.hasOwnProperty.call(v,E)&&S.push([v[E],E])}return S.sort(function(y,w){return y[0]-w[0]||n[y[1]]-n[w[1]]}),r[S.pop()[1]]||44}function o(p,v){var _=v||{},E="",S=_.dense?[]:{},y={s:{c:0,r:0},e:{c:0,r:0}};p.slice(0,4)=="sep="?p.charCodeAt(5)==13&&p.charCodeAt(6)==10?(E=p.charAt(4),p=p.slice(7)):p.charCodeAt(5)==13||p.charCodeAt(5)==10?(E=p.charAt(4),p=p.slice(6)):E=a(p.slice(0,1024)):_&&_.FS?E=_.FS:E=a(p.slice(0,1024));var w=0,P=0,B=0,N=0,z=0,q=E.charCodeAt(0),Z=!1,C=0,I=p.charCodeAt(0);p=p.replace(/\r\n/mg,`
`);var b=_.dateNF!=null?Y5(_.dateNF):null;function O(){var L=p.slice(N,z),M={};if(L.charAt(0)=='"'&&L.charAt(L.length-1)=='"'&&(L=L.slice(1,-1).replace(/""/g,'"')),L.length===0)M.t="z";else if(_.raw)M.t="s",M.v=L;else if(L.trim().length===0)M.t="s",M.v=L;else if(L.charCodeAt(0)==61)L.charCodeAt(1)==34&&L.charCodeAt(L.length-1)==34?(M.t="s",M.v=L.slice(2,-1).replace(/""/g,'"')):SU(L)?(M.t="n",M.f=L.slice(1)):(M.t="s",M.v=L);else if(L=="TRUE")M.t="b",M.v=!0;else if(L=="FALSE")M.t="b",M.v=!1;else if(!isNaN(B=ti(L)))M.t="n",_.cellText!==!1&&(M.w=L),M.v=B;else if(!isNaN(Jc(L).getDate())||b&&L.match(b)){M.z=_.dateNF||tt[14];var D=0;b&&L.match(b)&&(L=$5(L,_.dateNF,L.match(b)||[]),D=1),_.cellDates?(M.t="d",M.v=mr(L,D)):(M.t="n",M.v=rn(mr(L,D))),_.cellText!==!1&&(M.w=Ta(M.z,M.v instanceof Date?rn(M.v):M.v)),_.cellNF||delete M.z}else M.t="s",M.v=L;if(M.t=="z"||(_.dense?(S[w]||(S[w]=[]),S[w][P]=M):S[lt({c:P,r:w})]=M),N=z+1,I=p.charCodeAt(N),y.e.c<P&&(y.e.c=P),y.e.r<w&&(y.e.r=w),C==q)++P;else if(P=0,++w,_.sheetRows&&_.sheetRows<=w)return!0}e:for(;z<p.length;++z)switch(C=p.charCodeAt(z)){case 34:I===34&&(Z=!Z);break;case q:case 10:case 13:if(!Z&&O())break e;break}return z-N>0&&O(),S["!ref"]=yt(y),S}function l(p,v){return!(v&&v.PRN)||v.FS||p.slice(0,4)=="sep="||p.indexOf("	")>=0||p.indexOf(",")>=0||p.indexOf(";")>=0?o(p,v):uu(e(p,v),v)}function u(p,v){var _="",E=v.type=="string"?[0,0,0,0]:qv(p,v);switch(v.type){case"base64":_=Ea(p);break;case"binary":_=p;break;case"buffer":v.codepage==65001?_=p.toString("utf8"):v.codepage&&typeof $f<"u"||(_=bt&&Buffer.isBuffer(p)?p.toString("binary"):Io(p));break;case"array":_=Al(p);break;case"string":_=p;break;default:throw new Error("Unrecognized type "+v.type)}return E[0]==239&&E[1]==187&&E[2]==191?_=ar(_.slice(3)):v.type!="string"&&v.type!="buffer"&&v.codepage==65001?_=ar(_):v.type=="binary"&&typeof $f<"u",_.slice(0,19)=="socialcalc:version:"?f4.to_sheet(v.type=="string"?_:ar(_),v):l(_,v)}function h(p,v){return No(u(p,v),v)}function d(p){for(var v=[],_=Ht(p["!ref"]),E,S=Array.isArray(p),y=_.s.r;y<=_.e.r;++y){for(var w=[],P=_.s.c;P<=_.e.c;++P){var B=lt({r:y,c:P});if(E=S?(p[y]||[])[P]:p[B],!E||E.v==null){w.push("          ");continue}for(var N=(E.w||(vs(E),E.w)||"").slice(0,10);N.length<10;)N+=" ";w.push(N+(P===0?" ":""))}v.push(w.join(""))}return v.join(`
`)}return{to_workbook:h,to_sheet:u,from_sheet:d}}();function u9(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var a=c4.to_workbook(t,r);return r.WTF=n,a}catch(o){if(r.WTF=n,!o.message.match(/SYLK bad record ID/)&&n)throw o;return eu.to_workbook(t,e)}}var ml=function(){function t(V,X,ee){if(V){_n(V,V.l||0);for(var te=ee.Enum||K;V.l<V.length;){var le=V.read_shift(2),Ne=te[le]||te[65535],ke=V.read_shift(2),Oe=V.l+ke,_e=Ne.f&&Ne.f(V,ke,ee);if(V.l=Oe,X(_e,Ne,le))return}}}function e(V,X){switch(X.type){case"base64":return r(xa(Ea(V)),X);case"binary":return r(xa(V),X);case"buffer":case"array":return r(V,X)}throw"Unsupported type "+X.type}function r(V,X){if(!V)return V;var ee=X||{},te=ee.dense?[]:{},le="Sheet1",Ne="",ke=0,Oe={},_e=[],Be=[],W={s:{r:0,c:0},e:{r:0,c:0}},nt=ee.sheetRows||0;if(V[2]==0&&(V[3]==8||V[3]==9)&&V.length>=16&&V[14]==5&&V[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(V[2]==2)ee.Enum=K,t(V,function(Le,ir,Lr){switch(Lr){case 0:ee.vers=Le,Le>=4096&&(ee.qpro=!0);break;case 6:W=Le;break;case 204:Le&&(Ne=Le);break;case 222:Ne=Le;break;case 15:case 51:ee.qpro||(Le[1].v=Le[1].v.slice(1));case 13:case 14:case 16:Lr==14&&(Le[2]&112)==112&&(Le[2]&15)>1&&(Le[2]&15)<15&&(Le[1].z=ee.dateNF||tt[14],ee.cellDates&&(Le[1].t="d",Le[1].v=Nm(Le[1].v))),ee.qpro&&Le[3]>ke&&(te["!ref"]=yt(W),Oe[le]=te,_e.push(le),te=ee.dense?[]:{},W={s:{r:0,c:0},e:{r:0,c:0}},ke=Le[3],le=Ne||"Sheet"+(ke+1),Ne="");var Kr=ee.dense?(te[Le[0].r]||[])[Le[0].c]:te[lt(Le[0])];if(Kr){Kr.t=Le[1].t,Kr.v=Le[1].v,Le[1].z!=null&&(Kr.z=Le[1].z),Le[1].f!=null&&(Kr.f=Le[1].f);break}ee.dense?(te[Le[0].r]||(te[Le[0].r]=[]),te[Le[0].r][Le[0].c]=Le[1]):te[lt(Le[0])]=Le[1];break}},ee);else if(V[2]==26||V[2]==14)ee.Enum=pe,V[2]==14&&(ee.qpro=!0,V.l=0),t(V,function(Le,ir,Lr){switch(Lr){case 204:le=Le;break;case 22:Le[1].v=Le[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Le[3]>ke&&(te["!ref"]=yt(W),Oe[le]=te,_e.push(le),te=ee.dense?[]:{},W={s:{r:0,c:0},e:{r:0,c:0}},ke=Le[3],le="Sheet"+(ke+1)),nt>0&&Le[0].r>=nt)break;ee.dense?(te[Le[0].r]||(te[Le[0].r]=[]),te[Le[0].r][Le[0].c]=Le[1]):te[lt(Le[0])]=Le[1],W.e.c<Le[0].c&&(W.e.c=Le[0].c),W.e.r<Le[0].r&&(W.e.r=Le[0].r);break;case 27:Le[14e3]&&(Be[Le[14e3][0]]=Le[14e3][1]);break;case 1537:Be[Le[0]]=Le[1],Le[0]==ke&&(le=Le[1]);break}},ee);else throw new Error("Unrecognized LOTUS BOF "+V[2]);if(te["!ref"]=yt(W),Oe[Ne||le]=te,_e.push(Ne||le),!Be.length)return{SheetNames:_e,Sheets:Oe};for(var it={},wt=[],st=0;st<Be.length;++st)Oe[_e[st]]?(wt.push(Be[st]||_e[st]),it[Be[st]]=Oe[Be[st]]||Oe[_e[st]]):(wt.push(Be[st]),it[Be[st]]={"!ref":"A1"});return{SheetNames:wt,Sheets:it}}function n(V,X){var ee=X||{};if(+ee.codepage>=0&&Za(+ee.codepage),ee.type=="string")throw new Error("Cannot write WK1 to JS string");var te=na(),le=Ht(V["!ref"]),Ne=Array.isArray(V),ke=[];Ge(te,0,o(1030)),Ge(te,6,h(le));for(var Oe=Math.min(le.e.r,8191),_e=le.s.r;_e<=Oe;++_e)for(var Be=Pr(_e),W=le.s.c;W<=le.e.c;++W){_e===le.s.r&&(ke[W]=_r(W));var nt=ke[W]+Be,it=Ne?(V[_e]||[])[W]:V[nt];if(!(!it||it.t=="z"))if(it.t=="n")(it.v|0)==it.v&&it.v>=-32768&&it.v<=32767?Ge(te,13,E(_e,W,it.v)):Ge(te,14,y(_e,W,it.v));else{var wt=vs(it);Ge(te,15,v(_e,W,wt.slice(0,239)))}}return Ge(te,1),te.end()}function a(V,X){var ee=X||{};if(+ee.codepage>=0&&Za(+ee.codepage),ee.type=="string")throw new Error("Cannot write WK3 to JS string");var te=na();Ge(te,0,l(V));for(var le=0,Ne=0;le<V.SheetNames.length;++le)(V.Sheets[V.SheetNames[le]]||{})["!ref"]&&Ge(te,27,ie(V.SheetNames[le],Ne++));var ke=0;for(le=0;le<V.SheetNames.length;++le){var Oe=V.Sheets[V.SheetNames[le]];if(!(!Oe||!Oe["!ref"])){for(var _e=Ht(Oe["!ref"]),Be=Array.isArray(Oe),W=[],nt=Math.min(_e.e.r,8191),it=_e.s.r;it<=nt;++it)for(var wt=Pr(it),st=_e.s.c;st<=_e.e.c;++st){it===_e.s.r&&(W[st]=_r(st));var Le=W[st]+wt,ir=Be?(Oe[it]||[])[st]:Oe[Le];if(!(!ir||ir.t=="z"))if(ir.t=="n")Ge(te,23,O(it,st,ke,ir.v));else{var Lr=vs(ir);Ge(te,22,C(it,st,ke,Lr.slice(0,239)))}}++ke}}return Ge(te,1),te.end()}function o(V){var X=Ae(2);return X.write_shift(2,V),X}function l(V){var X=Ae(26);X.write_shift(2,4096),X.write_shift(2,4),X.write_shift(4,0);for(var ee=0,te=0,le=0,Ne=0;Ne<V.SheetNames.length;++Ne){var ke=V.SheetNames[Ne],Oe=V.Sheets[ke];if(!(!Oe||!Oe["!ref"])){++le;var _e=aa(Oe["!ref"]);ee<_e.e.r&&(ee=_e.e.r),te<_e.e.c&&(te=_e.e.c)}}return ee>8191&&(ee=8191),X.write_shift(2,ee),X.write_shift(1,le),X.write_shift(1,te),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(1,1),X.write_shift(1,2),X.write_shift(4,0),X.write_shift(4,0),X}function u(V,X,ee){var te={s:{c:0,r:0},e:{c:0,r:0}};return X==8&&ee.qpro?(te.s.c=V.read_shift(1),V.l++,te.s.r=V.read_shift(2),te.e.c=V.read_shift(1),V.l++,te.e.r=V.read_shift(2),te):(te.s.c=V.read_shift(2),te.s.r=V.read_shift(2),X==12&&ee.qpro&&(V.l+=2),te.e.c=V.read_shift(2),te.e.r=V.read_shift(2),X==12&&ee.qpro&&(V.l+=2),te.s.c==65535&&(te.s.c=te.e.c=te.s.r=te.e.r=0),te)}function h(V){var X=Ae(8);return X.write_shift(2,V.s.c),X.write_shift(2,V.s.r),X.write_shift(2,V.e.c),X.write_shift(2,V.e.r),X}function d(V,X,ee){var te=[{c:0,r:0},{t:"n",v:0},0,0];return ee.qpro&&ee.vers!=20768?(te[0].c=V.read_shift(1),te[3]=V.read_shift(1),te[0].r=V.read_shift(2),V.l+=2):(te[2]=V.read_shift(1),te[0].c=V.read_shift(2),te[0].r=V.read_shift(2)),te}function p(V,X,ee){var te=V.l+X,le=d(V,X,ee);if(le[1].t="s",ee.vers==20768){V.l++;var Ne=V.read_shift(1);return le[1].v=V.read_shift(Ne,"utf8"),le}return ee.qpro&&V.l++,le[1].v=V.read_shift(te-V.l,"cstr"),le}function v(V,X,ee){var te=Ae(7+ee.length);te.write_shift(1,255),te.write_shift(2,X),te.write_shift(2,V),te.write_shift(1,39);for(var le=0;le<te.length;++le){var Ne=ee.charCodeAt(le);te.write_shift(1,Ne>=128?95:Ne)}return te.write_shift(1,0),te}function _(V,X,ee){var te=d(V,X,ee);return te[1].v=V.read_shift(2,"i"),te}function E(V,X,ee){var te=Ae(7);return te.write_shift(1,255),te.write_shift(2,X),te.write_shift(2,V),te.write_shift(2,ee,"i"),te}function S(V,X,ee){var te=d(V,X,ee);return te[1].v=V.read_shift(8,"f"),te}function y(V,X,ee){var te=Ae(13);return te.write_shift(1,255),te.write_shift(2,X),te.write_shift(2,V),te.write_shift(8,ee,"f"),te}function w(V,X,ee){var te=V.l+X,le=d(V,X,ee);if(le[1].v=V.read_shift(8,"f"),ee.qpro)V.l=te;else{var Ne=V.read_shift(2);z(V.slice(V.l,V.l+Ne),le),V.l+=Ne}return le}function P(V,X,ee){var te=X&32768;return X&=-32769,X=(te?V:0)+(X>=8192?X-16384:X),(te?"":"$")+(ee?_r(X):Pr(X))}var B={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},N=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function z(V,X){_n(V,0);for(var ee=[],te=0,le="",Ne="",ke="",Oe="";V.l<V.length;){var _e=V[V.l++];switch(_e){case 0:ee.push(V.read_shift(8,"f"));break;case 1:Ne=P(X[0].c,V.read_shift(2),!0),le=P(X[0].r,V.read_shift(2),!1),ee.push(Ne+le);break;case 2:{var Be=P(X[0].c,V.read_shift(2),!0),W=P(X[0].r,V.read_shift(2),!1);Ne=P(X[0].c,V.read_shift(2),!0),le=P(X[0].r,V.read_shift(2),!1),ee.push(Be+W+":"+Ne+le)}break;case 3:if(V.l<V.length){console.error("WK1 premature formula end");return}break;case 4:ee.push("("+ee.pop()+")");break;case 5:ee.push(V.read_shift(2));break;case 6:{for(var nt="";_e=V[V.l++];)nt+=String.fromCharCode(_e);ee.push('"'+nt.replace(/"/g,'""')+'"')}break;case 8:ee.push("-"+ee.pop());break;case 23:ee.push("+"+ee.pop());break;case 22:ee.push("NOT("+ee.pop()+")");break;case 20:case 21:Oe=ee.pop(),ke=ee.pop(),ee.push(["AND","OR"][_e-20]+"("+ke+","+Oe+")");break;default:if(_e<32&&N[_e])Oe=ee.pop(),ke=ee.pop(),ee.push(ke+N[_e]+Oe);else if(B[_e]){if(te=B[_e][1],te==69&&(te=V[V.l++]),te>ee.length){console.error("WK1 bad formula parse 0x"+_e.toString(16)+":|"+ee.join("|")+"|");return}var it=ee.slice(-te);ee.length-=te,ee.push(B[_e][0]+"("+it.join(",")+")")}else return _e<=7?console.error("WK1 invalid opcode "+_e.toString(16)):_e<=24?console.error("WK1 unsupported op "+_e.toString(16)):_e<=30?console.error("WK1 invalid opcode "+_e.toString(16)):_e<=115?console.error("WK1 unsupported function opcode "+_e.toString(16)):console.error("WK1 unrecognized opcode "+_e.toString(16))}}ee.length==1?X[1].f=""+ee[0]:console.error("WK1 bad formula parse |"+ee.join("|")+"|")}function q(V){var X=[{c:0,r:0},{t:"n",v:0},0];return X[0].r=V.read_shift(2),X[3]=V[V.l++],X[0].c=V[V.l++],X}function Z(V,X){var ee=q(V);return ee[1].t="s",ee[1].v=V.read_shift(X-4,"cstr"),ee}function C(V,X,ee,te){var le=Ae(6+te.length);le.write_shift(2,V),le.write_shift(1,ee),le.write_shift(1,X),le.write_shift(1,39);for(var Ne=0;Ne<te.length;++Ne){var ke=te.charCodeAt(Ne);le.write_shift(1,ke>=128?95:ke)}return le.write_shift(1,0),le}function I(V,X){var ee=q(V);ee[1].v=V.read_shift(2);var te=ee[1].v>>1;if(ee[1].v&1)switch(te&7){case 0:te=(te>>3)*5e3;break;case 1:te=(te>>3)*500;break;case 2:te=(te>>3)/20;break;case 3:te=(te>>3)/200;break;case 4:te=(te>>3)/2e3;break;case 5:te=(te>>3)/2e4;break;case 6:te=(te>>3)/16;break;case 7:te=(te>>3)/64;break}return ee[1].v=te,ee}function b(V,X){var ee=q(V),te=V.read_shift(4),le=V.read_shift(4),Ne=V.read_shift(2);if(Ne==65535)return te===0&&le===3221225472?(ee[1].t="e",ee[1].v=15):te===0&&le===3489660928?(ee[1].t="e",ee[1].v=42):ee[1].v=0,ee;var ke=Ne&32768;return Ne=(Ne&32767)-16446,ee[1].v=(1-ke*2)*(le*Math.pow(2,Ne+32)+te*Math.pow(2,Ne)),ee}function O(V,X,ee,te){var le=Ae(14);if(le.write_shift(2,V),le.write_shift(1,ee),le.write_shift(1,X),te==0)return le.write_shift(4,0),le.write_shift(4,0),le.write_shift(2,65535),le;var Ne=0,ke=0,Oe=0,_e=0;return te<0&&(Ne=1,te=-te),ke=Math.log2(te)|0,te/=Math.pow(2,ke-31),_e=te>>>0,(_e&2147483648)==0&&(te/=2,++ke,_e=te>>>0),te-=_e,_e|=2147483648,_e>>>=0,te*=Math.pow(2,32),Oe=te>>>0,le.write_shift(4,Oe),le.write_shift(4,_e),ke+=16383+(Ne?32768:0),le.write_shift(2,ke),le}function L(V,X){var ee=b(V);return V.l+=X-14,ee}function M(V,X){var ee=q(V),te=V.read_shift(4);return ee[1].v=te>>6,ee}function D(V,X){var ee=q(V),te=V.read_shift(8,"f");return ee[1].v=te,ee}function Ee(V,X){var ee=D(V);return V.l+=X-10,ee}function Te(V,X){return V[V.l+X-1]==0?V.read_shift(X,"cstr"):""}function ne(V,X){var ee=V[V.l++];ee>X-1&&(ee=X-1);for(var te="";te.length<ee;)te+=String.fromCharCode(V[V.l++]);return te}function ue(V,X,ee){if(!(!ee.qpro||X<21)){var te=V.read_shift(1);V.l+=17,V.l+=1,V.l+=2;var le=V.read_shift(X-21,"cstr");return[te,le]}}function Ue(V,X){for(var ee={},te=V.l+X;V.l<te;){var le=V.read_shift(2);if(le==14e3){for(ee[le]=[0,""],ee[le][0]=V.read_shift(2);V[V.l];)ee[le][1]+=String.fromCharCode(V[V.l]),V.l++;V.l++}}return ee}function ie(V,X){var ee=Ae(5+V.length);ee.write_shift(2,14e3),ee.write_shift(2,X);for(var te=0;te<V.length;++te){var le=V.charCodeAt(te);ee[ee.l++]=le>127?95:le}return ee[ee.l++]=0,ee}var K={0:{n:"BOF",f:qr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:_},14:{n:"NUMBER",f:S},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:p},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Te},222:{n:"SHEETNAMELP",f:ne},65535:{n:""}},pe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:Z},23:{n:"NUMBER17",f:b},24:{n:"NUMBER18",f:I},25:{n:"FORMULA19",f:L},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Ue},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:M},38:{n:"??"},39:{n:"NUMBER27",f:D},40:{n:"FORMULA28",f:Ee},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Te},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ue},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:e}}();function f9(t){var e={},r=t.match(Mn),n=0,a=!1;if(r)for(;n!=r.length;++n){var o=dt(r[n]);switch(o[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(o.val=="1")break;e.cp=lv[parseInt(o.val,10)];break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=o.val;break;case"<sz":e.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(o.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(o.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":o.rgb&&(e.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(o[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+o[0])}}return e}var h9=function(){var t=Jf("t"),e=Jf("rPr");function r(o){var l=o.match(t);if(!l)return{t:"s",v:""};var u={t:"s",v:jt(l[1])},h=o.match(e);return h&&(u.s=f9(h[1])),u}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(l){return l.replace(n,"").split(a).map(r).filter(function(u){return u.v})}}(),d9=function(){var e=/(\r\n|\n)/g;function r(a,o,l){var u=[];a.u&&u.push("text-decoration: underline;"),a.uval&&u.push("text-underline-style:"+a.uval+";"),a.sz&&u.push("font-size:"+a.sz+"pt;"),a.outline&&u.push("text-effect: outline;"),a.shadow&&u.push("text-shadow: auto;"),o.push('<span style="'+u.join("")+'">'),a.b&&(o.push("<b>"),l.push("</b>")),a.i&&(o.push("<i>"),l.push("</i>")),a.strike&&(o.push("<s>"),l.push("</s>"));var h=a.valign||"";return h=="superscript"||h=="super"?h="sup":h=="subscript"&&(h="sub"),h!=""&&(o.push("<"+h+">"),l.push("</"+h+">")),l.push("</span>"),a}function n(a){var o=[[],a.v,[]];return a.v?(a.s&&r(a.s,o[0],o[2]),o[0].join("")+o[1].replace(e,"<br/>")+o[2].join("")):""}return function(o){return o.map(n).join("")}}(),m9=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,p9=/<(?:\w+:)?r>/,g9=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Dv(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=jt(ar(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=ar(t),r&&(n.h=vv(n.t))):t.match(p9)&&(n.r=ar(t),n.t=jt(ar((t.replace(g9,"").match(m9)||[]).join("").replace(Mn,""))),r&&(n.h=d9(h9(n.r)))),n):{t:""}}var x9=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,v9=/<(?:\w+:)?(?:si|sstItem)>/g,_9=/<\/(?:\w+:)?(?:si|sstItem)>/;function y9(t,e){var r=[],n="";if(!t)return r;var a=t.match(x9);if(a){n=a[2].replace(v9,"").split(_9);for(var o=0;o!=n.length;++o){var l=Dv(n[o].trim(),e);l!=null&&(r[r.length]=l)}a=dt(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var E9=/^\s|\s$|[\t\n\r]/;function h4(t,e){if(!e.bookSST)return"";var r=[Mr];r[r.length]=He("sst",null,{xmlns:Pl[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var a=t[n],o="<si>";a.r?o+=a.r:(o+="<t",a.t||(a.t=""),a.t.match(E9)&&(o+=' xml:space="preserve"'),o+=">"+Jt(a.t)+"</t>"),o+="</si>",r[r.length]=o}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function T9(t){return[t.read_shift(4),t.read_shift(4)]}function w9(t,e){var r=[],n=!1;return ys(t,function(o,l,u){switch(u){case 159:r.Count=o[0],r.Unique=o[1];break;case 19:r.push(o);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(l.T,!n||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function S9(t,e){return e||(e=Ae(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var A9=PP;function b9(t){var e=na();Fe(e,159,S9(t));for(var r=0;r<t.length;++r)Fe(e,19,A9(t[r]));return Fe(e,160),e.end()}function d4(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function ds(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function k9(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=ds(t,4),e.U=ds(t,4),e.W=ds(t,4),e}function C9(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},a=t.read_shift(4),o=[];a-- >0;)o.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=o,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function R9(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(C9(t));return e}function I9(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function N9(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=ds(t,4),e.U=ds(t,4),e.W=ds(t,4),e}function D9(t){var e=N9(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function m4(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function p4(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function O9(t){var e=ds(t);switch(e.Minor){case 2:return[e.Minor,F9(t)];case 3:return[e.Minor,P9()];case 4:return[e.Minor,M9(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function F9(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=m4(t,r),a=p4(t,t.length-t.l);return{t:"Std",h:n,v:a}}function P9(){throw new Error("File is password-protected: ECMA-376 Extensible")}function M9(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(Mn,function(o){var l=dt(o);switch(Bi(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(u){n[u]=l[u]});break;case"<dataIntegrity":n.encryptedHmacKey=l.encryptedHmacKey,n.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(l);break;default:throw l[0]}}),n}function L9(t,e){var r={},n=r.EncryptionVersionInfo=ds(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var a=t.read_shift(4);return e-=4,r.EncryptionHeader=m4(t,a),e-=a,r.EncryptionVerifier=p4(t,e),r}function U9(t){var e={},r=e.EncryptionVersionInfo=ds(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function Ov(t){var e=0,r,n=d4(t),a=n.length+1,o,l,u,h,d;for(r=Eo(a),r[0]=n.length,o=1;o!=a;++o)r[o]=n[o-1];for(o=a-1;o>=0;--o)l=r[o],u=(e&16384)===0?0:1,h=e<<1&32767,d=u|h,e=d^l;return e^52811}var g4=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(l){return(l/2|l*128)&255},a=function(l,u){return n(l^u)},o=function(l){for(var u=e[l.length-1],h=104,d=l.length-1;d>=0;--d)for(var p=l[d],v=0;v!=7;++v)p&64&&(u^=r[h]),p*=2,--h;return u};return function(l){for(var u=d4(l),h=o(u),d=u.length,p=Eo(16),v=0;v!=16;++v)p[v]=0;var _,E,S;for((d&1)===1&&(_=h>>8,p[d]=a(t[0],_),--d,_=h&255,E=u[u.length-1],p[d]=a(E,_));d>0;)--d,_=h>>8,p[d]=a(u[d],_),--d,_=h&255,p[d]=a(u[d],_);for(d=15,S=15-u.length;S>0;)_=h>>8,p[d]=a(t[S],_),--d,--S,_=h&255,p[d]=a(u[d],_),--d,--S;return p}}(),B9=function(t,e,r,n,a){a||(a=e),n||(n=g4(t));var o,l;for(o=0;o!=e.length;++o)l=e[o],l^=n[r],l=(l>>5|l<<3)&255,a[o]=l,++r;return[a,r,n]},V9=function(t){var e=0,r=g4(t);return function(n){var a=B9("",n,e,r);return e=a[1],a[0]}};function j9(t,e,r,n){var a={key:qr(t),verificationBytes:qr(t)};return r.password&&(a.verifier=Ov(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=V9(r.password)),a}function H9(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=U9(t):n.Data=L9(t,e),n}function z9(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?H9(t,e-2,n):j9(t,r.biff>=8?e:e-2,r,n),n}var x4=function(){function t(a,o){switch(o.type){case"base64":return e(Ea(a),o);case"binary":return e(a,o);case"buffer":return e(bt&&Buffer.isBuffer(a)?a.toString("binary"):Io(a),o);case"array":return e(Al(a),o)}throw new Error("Unrecognized type "+o.type)}function e(a,o){var l=o||{},u=l.dense?[]:{},h=a.match(/\\trowd.*?\\row\b/g);if(!h.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:h.length-1}};return h.forEach(function(p,v){Array.isArray(u)&&(u[v]=[]);for(var _=/\\\w+\b/g,E=0,S,y=-1;S=_.exec(p);){switch(S[0]){case"\\cell":var w=p.slice(E,_.lastIndex-S[0].length);if(w[0]==" "&&(w=w.slice(1)),++y,w.length){var P={v:w,t:"s"};Array.isArray(u)?u[v][y]=P:u[lt({r:v,c:y})]=P}break}E=_.lastIndex}y>d.e.c&&(d.e.c=y)}),u["!ref"]=yt(d),u}function r(a,o){return No(t(a,o),o)}function n(a){for(var o=["{\\rtf1\\ansi"],l=Ht(a["!ref"]),u,h=Array.isArray(a),d=l.s.r;d<=l.e.r;++d){o.push("\\trowd\\trautofit1");for(var p=l.s.c;p<=l.e.c;++p)o.push("\\cellx"+(p+1));for(o.push("\\pard\\intbl"),p=l.s.c;p<=l.e.c;++p){var v=lt({r:d,c:p});u=h?(a[d]||[])[p]:a[v],!(!u||u.v==null&&(!u.f||u.F))&&(o.push(" "+(u.w||(vs(u),u.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function G9(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function n0(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function q9(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,a=Math.max(e,r,n),o=Math.min(e,r,n),l=a-o;if(l===0)return[0,0,e];var u=0,h=0,d=a+o;switch(h=l/(d>1?2-d:d),a){case e:u=((r-n)/l+6)%6;break;case r:u=(n-e)/l+2;break;case n:u=(e-r)/l+4;break}return[u/6,h,d/2]}function W9(t){var e=t[0],r=t[1],n=t[2],a=r*2*(n<.5?n:1-n),o=n-a/2,l=[o,o,o],u=6*e,h;if(r!==0)switch(u|0){case 0:case 6:h=a*u,l[0]+=a,l[1]+=h;break;case 1:h=a*(2-u),l[0]+=h,l[1]+=a;break;case 2:h=a*(u-2),l[1]+=a,l[2]+=h;break;case 3:h=a*(4-u),l[1]+=h,l[2]+=a;break;case 4:h=a*(u-4),l[2]+=a,l[0]+=h;break;case 5:h=a*(6-u),l[2]+=h,l[0]+=a;break}for(var d=0;d!=3;++d)l[d]=Math.round(l[d]*255);return l}function rm(t,e){if(e===0)return t;var r=q9(G9(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),n0(W9(r))}var v4=6,X9=15,K9=1,Nn=v4;function a0(t){return Math.floor((t+Math.round(128/Nn)/256)*Nn)}function i0(t){return Math.floor((t-5)/Nn*100+.5)/100}function nm(t){return Math.round((t*Nn+5)/Nn*256)/256}function r1(t){return nm(i0(a0(t)))}function Fv(t){var e=Math.abs(t-r1(t)),r=Nn;if(e>.005)for(Nn=K9;Nn<X9;++Nn)Math.abs(t-r1(t))<=e&&(e=Math.abs(t-r1(t)),r=Nn);Nn=r}function To(t){t.width?(t.wpx=a0(t.width),t.wch=i0(t.wpx),t.MDW=Nn):t.wpx?(t.wch=i0(t.wpx),t.width=nm(t.wch),t.MDW=Nn):typeof t.wch=="number"&&(t.width=nm(t.wch),t.wpx=a0(t.width),t.MDW=Nn),t.customWidth&&delete t.customWidth}var Y9=96,_4=Y9;function s0(t){return t*96/_4}function tu(t){return t*_4/96}var $9={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Q9(t,e,r,n){e.Borders=[];var a={},o=!1;(t[0].match(Mn)||[]).forEach(function(l){var u=dt(l);switch(Bi(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},u.diagonalUp&&(a.diagonalUp=hr(u.diagonalUp)),u.diagonalDown&&(a.diagonalDown=hr(u.diagonalDown)),e.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+u[0]+" in borders")}})}function Z9(t,e,r,n){e.Fills=[];var a={},o=!1;(t[0].match(Mn)||[]).forEach(function(l){var u=dt(l);switch(Bi(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},e.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":u.patternType&&(a.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),u.indexed&&(a.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(a.bgColor.theme=parseInt(u.theme,10)),u.tint&&(a.bgColor.tint=parseFloat(u.tint)),u.rgb&&(a.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),u.theme&&(a.fgColor.theme=parseInt(u.theme,10)),u.tint&&(a.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(a.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+u[0]+" in fills")}})}function J9(t,e,r,n){e.Fonts=[];var a={},o=!1;(t[0].match(Mn)||[]).forEach(function(l){var u=dt(l);switch(Bi(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(a),a={};break;case"<name":u.val&&(a.name=ar(u.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=u.val?hr(u.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=u.val?hr(u.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(u.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=u.val?hr(u.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=u.val?hr(u.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=u.val?hr(u.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=u.val?hr(u.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=u.val?hr(u.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":u.val&&(a.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(a.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(a.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(a.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=lv[parseInt(u.val,10)];break;case"<color":if(a.color||(a.color={}),u.auto&&(a.color.auto=hr(u.auto)),u.rgb)a.color.rgb=u.rgb.slice(-6);else if(u.indexed){a.color.index=parseInt(u.indexed,10);var h=hl[a.color.index];a.color.index==81&&(h=hl[1]),h||(h=hl[1]),a.color.rgb=h[0].toString(16)+h[1].toString(16)+h[2].toString(16)}else u.theme&&(a.color.theme=parseInt(u.theme,10),u.tint&&(a.color.tint=parseFloat(u.tint)),u.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=rm(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":o=!0;break;case"</AlternateContent>":o=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+u[0]+" in fonts")}})}function e7(t,e,r){e.NumberFmt=[];for(var n=Cr(tt),a=0;a<n.length;++a)e.NumberFmt[n[a]]=tt[n[a]];var o=t[0].match(Mn);if(o)for(a=0;a<o.length;++a){var l=dt(o[a]);switch(Bi(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=jt(ar(l.formatCode)),h=parseInt(l.numFmtId,10);if(e.NumberFmt[h]=u,h>0){if(h>392){for(h=392;h>60&&e.NumberFmt[h]!=null;--h);e.NumberFmt[h]=u}Mi(u,h)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}function t7(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=He("numFmt",null,{numFmtId:n,formatCode:Jt(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=He("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var fd=["numFmtId","fillId","fontId","borderId","xfId"],hd=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function r7(t,e,r){e.CellXf=[];var n,a=!1;(t[0].match(Mn)||[]).forEach(function(o){var l=dt(o),u=0;switch(Bi(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=l,delete n[0],u=0;u<fd.length;++u)n[fd[u]]&&(n[fd[u]]=parseInt(n[fd[u]],10));for(u=0;u<hd.length;++u)n[hd[u]]&&(n[hd[u]]=hr(n[hd[u]]));if(e.NumberFmt&&n.numFmtId>392){for(u=392;u>60;--u)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[u]){n.numFmtId=u;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var h={};l.vertical&&(h.vertical=l.vertical),l.horizontal&&(h.horizontal=l.horizontal),l.textRotation!=null&&(h.textRotation=l.textRotation),l.indent&&(h.indent=l.indent),l.wrapText&&(h.wrapText=hr(l.wrapText)),n.alignment=h;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}function n7(t){var e=[];return e[e.length]=He("cellXfs",null),t.forEach(function(r){e[e.length]=He("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=He("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var a7=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,o=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,h,d){var p={};if(!u)return p;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var v;return(v=u.match(e))&&e7(v,p,d),(v=u.match(a))&&J9(v,p,h,d),(v=u.match(n))&&Z9(v,p,h,d),(v=u.match(o))&&Q9(v,p,h,d),(v=u.match(r))&&r7(v,p,d),p}}();function y4(t,e){var r=[Mr,He("styleSheet",null,{xmlns:Pl[0],"xmlns:vt":Jr.vt})],n;return t.SSF&&(n=t7(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=n7(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function i7(t,e){var r=t.read_shift(2),n=On(t);return[r,n]}function s7(t,e,r){r||(r=Ae(6+4*e.length)),r.write_shift(2,t),hn(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function o7(t,e,r){var n={};n.sz=t.read_shift(2)/20;var a=HP(t);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var o=t.read_shift(2);switch(o===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var l=t.read_shift(1);l!=0&&(n.underline=l);var u=t.read_shift(1);u>0&&(n.family=u);var h=t.read_shift(1);switch(h>0&&(n.charset=h),t.l++,n.color=jP(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=On(t),n}function l7(t,e){e||(e=Ae(25+4*32)),e.write_shift(2,t.sz*20),zP(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),Jd(t.color,e);var n=0;return n=2,e.write_shift(1,n),hn(t.name,e),e.length>e.l?e.slice(0,e.l):e}var c7=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],n1,u7=Pn;function jw(t,e){e||(e=Ae(4*3+8*7+16*1)),n1||(n1=Rm(c7));var r=n1[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(Jd({auto:1},e),Jd({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function f7(t,e){var r=t.l+e,n=t.read_shift(2),a=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:a}}function E4(t,e,r){r||(r=Ae(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function mf(t,e){return e||(e=Ae(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var h7=Pn;function d7(t,e){return e||(e=Ae(51)),e.write_shift(1,0),mf(null,e),mf(null,e),mf(null,e),mf(null,e),mf(null,e),e.length>e.l?e.slice(0,e.l):e}function m7(t,e){return e||(e=Ae(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),Zd(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function p7(t,e,r){var n=Ae(2052);return n.write_shift(4,t),Zd(e,n),Zd(r,n),n.length>n.l?n.slice(0,n.l):n}function g7(t,e,r){var n={};n.NumberFmt=[];for(var a in tt)n.NumberFmt[a]=tt[a];n.CellXf=[],n.Fonts=[];var o=[],l=!1;return ys(t,function(h,d,p){switch(p){case 44:n.NumberFmt[h[0]]=h[1],Mi(h[1],h[0]);break;case 43:n.Fonts.push(h),h.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(h.color.rgb=rm(e.themeElements.clrScheme[h.color.theme].rgb,h.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:o[o.length-1]==617&&n.CellXf.push(h);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:o.push(p),l=!0;break;case 38:o.pop(),l=!1;break;default:if(d.T>0)o.push(p);else if(d.T<0)o.pop();else if(!l||r.WTF&&o[o.length-1]!=37)throw new Error("Unexpected record 0x"+p.toString(16))}}),n}function x7(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&++r}),r!=0&&(Fe(t,615,ri(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&Fe(t,44,s7(a,e[a]))}),Fe(t,616))}}function v7(t){var e=1;Fe(t,611,ri(e)),Fe(t,43,l7({sz:12,color:{theme:1},name:"Calibri",family:2})),Fe(t,612)}function _7(t){var e=2;Fe(t,603,ri(e)),Fe(t,45,jw({patternType:"none"})),Fe(t,45,jw({patternType:"gray125"})),Fe(t,604)}function y7(t){var e=1;Fe(t,613,ri(e)),Fe(t,46,d7()),Fe(t,614)}function E7(t){var e=1;Fe(t,626,ri(e)),Fe(t,47,E4({numFmtId:0},65535)),Fe(t,627)}function T7(t,e){Fe(t,617,ri(e.length)),e.forEach(function(r){Fe(t,47,E4(r,0))}),Fe(t,618)}function w7(t){var e=1;Fe(t,619,ri(e)),Fe(t,48,m7({xfId:0,name:"Normal"})),Fe(t,620)}function S7(t){var e=0;Fe(t,505,ri(e)),Fe(t,506)}function A7(t){var e=0;Fe(t,508,p7(e,"TableStyleMedium9","PivotStyleMedium4")),Fe(t,509)}function b7(t,e){var r=na();return Fe(r,278),x7(r,t.SSF),v7(r),_7(r),y7(r),E7(r),T7(r,e.cellXfs),w7(r),S7(r),A7(r),Fe(r,279),r.end()}var k7=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function C7(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(Mn)||[]).forEach(function(a){var o=dt(a);switch(o[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=o.val;break;case"<a:sysClr":n.rgb=o.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":o[0].charAt(1)==="/"?(e.themeElements.clrScheme[k7.indexOf(o[0])]=n,n={}):n.name=o[0].slice(3,o[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+o[0]+" in clrScheme")}})}function R7(){}function I7(){}var N7=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,D7=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,O7=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function F7(t,e,r){e.themeElements={};var n;[["clrScheme",N7,C7],["fontScheme",D7,R7],["fmtScheme",O7,I7]].forEach(function(a){if(!(n=t.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,e,r)})}var P7=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function T4(t,e){(!t||t.length===0)&&(t=Pv());var r,n={};if(!(r=t.match(P7)))throw new Error("themeElements not found in theme");return F7(r[0],n,e),n.raw=t,n}function Pv(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[Mr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function M7(t,e,r){var n=t.l+e,a=t.read_shift(4);if(a!==124226){if(!r.cellStyles){t.l=n;return}var o=t.slice(t.l);t.l=n;var l;try{l=mk(o,{type:"array"})}catch{return}var u=va(l,"theme/theme/theme1.xml",!0);if(u)return T4(u,r)}}function L7(t){return t.read_shift(4)}function U7(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=B7(t,4);break;case 2:e.xclrValue=t4(t);break;case 3:e.xclrValue=L7(t);break;case 4:t.l+=4;break}return t.l+=8,e}function B7(t,e){return Pn(t,e)}function V7(t,e){return Pn(t,e)}function j7(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=U7(t);break;case 6:n[1]=V7(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function H7(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var a=t.read_shift(2),o=[];a-- >0;)o.push(j7(t,r-t.l));return{ixfe:n,ext:o}}function z7(t,e){e.forEach(function(r){r[0]})}function G7(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:On(t)}}function q7(t){var e=Ae(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),hn(t.name,e),e.slice(0,e.l)}function W7(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function X7(t){var e=Ae(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function K7(t,e){var r=Ae(8+2*e.length);return r.write_shift(4,t),hn(e,r),r.slice(0,r.l)}function Y7(t){return t.l+=4,t.read_shift(4)!=0}function $7(t,e){var r=Ae(8);return r.write_shift(4,t),r.write_shift(4,1),r}function Q7(t,e,r){var n={Types:[],Cell:[],Value:[]},a=r||{},o=[],l=!1,u=2;return ys(t,function(h,d,p){switch(p){case 335:n.Types.push({name:h.name});break;case 51:h.forEach(function(v){u==1?n.Cell.push({type:n.Types[v[0]-1].name,index:v[1]}):u==0&&n.Value.push({type:n.Types[v[0]-1].name,index:v[1]})});break;case 337:u=h?1:0;break;case 338:u=2;break;case 35:o.push(p),l=!0;break;case 36:o.pop(),l=!1;break;default:if(!d.T){if(!l||a.WTF&&o[o.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}}),n}function Z7(){var t=na();return Fe(t,332),Fe(t,334,ri(1)),Fe(t,335,q7({name:"XLDAPR",version:12e4,flags:3496657072})),Fe(t,336),Fe(t,339,K7(1,"XLDAPR")),Fe(t,52),Fe(t,35,ri(514)),Fe(t,4096,ri(0)),Fe(t,4097,Va(1)),Fe(t,36),Fe(t,53),Fe(t,340),Fe(t,337,$7(1)),Fe(t,51,X7([[1,0]])),Fe(t,338),Fe(t,333),t.end()}function J7(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var a=!1,o=2,l;return t.replace(Mn,function(u){var h=dt(u);switch(Bi(h[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:h.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<n.Types.length;++d)n.Types[d].name==h.name&&(l=n.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":o==1?n.Cell.push({type:n.Types[h.t-1].name,index:+h.v}):o==0&&n.Value.push({type:n.Types[h.t-1].name,index:+h.v});break;case"</rc>":break;case"<cellMetadata":o=1;break;case"</cellMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"</valueMetadata>":o=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+h.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+h[0]+" in metadata")}return u}),n}function w4(){var t=[Mr];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function eU(t){var e=[];if(!t)return e;var r=1;return(t.match(Mn)||[]).forEach(function(n){var a=dt(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,e.push(a);break}}),e}function tU(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=lt(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function rU(t,e,r){var n=[];return ys(t,function(o,l,u){switch(u){case 63:n.push(o);break;default:if(!l.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function nU(t,e,r,n){if(!t)return t;var a=n||{},o=!1;ys(t,function(u,h,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!h.T){if(!o||a.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},a)}function aU(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var Mc=1024;function S4(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[He("xml",null,{"xmlns:v":ma.v,"xmlns:o":ma.o,"xmlns:x":ma.x,"xmlns:mv":ma.mv}).replace(/\/>/,">"),He("o:shapelayout",He("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),He("v:shapetype",[He("v:stroke",null,{joinstyle:"miter"}),He("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Mc<t*1e3;)Mc+=1e3;return e.forEach(function(o){var l=yr(o[0]),u={color2:"#BEFF82",type:"gradient"};u.type=="gradient"&&(u.angle="-180");var h=u.type=="gradient"?He("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=He("v:fill",h,u),p={on:"t",obscured:"t"};++Mc,a=a.concat(["<v:shape"+e0({id:"_x0000_s"+Mc,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(o[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,He("v:shadow",null,p),He("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",En("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),En("x:AutoFill","False"),En("x:Row",String(l.r)),En("x:Column",String(l.c)),o[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function Hw(t,e,r,n){var a=Array.isArray(t),o;e.forEach(function(l){var u=yr(l.ref);if(a?(t[u.r]||(t[u.r]=[]),o=t[u.r][u.c]):o=t[l.ref],!o){o={t:"z"},a?t[u.r][u.c]=o:t[l.ref]=o;var h=Ht(t["!ref"]||"BDWGO1000001:A1");h.s.r>u.r&&(h.s.r=u.r),h.e.r<u.r&&(h.e.r=u.r),h.s.c>u.c&&(h.s.c=u.c),h.e.c<u.c&&(h.e.c=u.c);var d=yt(h);d!==t["!ref"]&&(t["!ref"]=d)}o.c||(o.c=[]);var p={a:l.author,t:l.t,r:l.r,T:r};l.h&&(p.h=l.h);for(var v=o.c.length-1;v>=0;--v){if(!r&&o.c[v].T)return;r&&!o.c[v].T&&o.c.splice(v,1)}if(r&&n){for(v=0;v<n.length;++v)if(p.a==n[v].id){p.a=n[v].name||p.a;break}}o.c.push(p)})}function iU(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var u=l.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&r.push(u[1])}});var o=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return o&&o[1]&&o[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var u=l.match(/<(?:\w+:)?comment[^>]*>/);if(u){var h=dt(u[0]),d={author:h.authorId&&r[h.authorId]||"sheetjsghost",ref:h.ref,guid:h.guid},p=yr(h.ref);if(!(e.sheetRows&&e.sheetRows<=p.r)){var v=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),_=!!v&&!!v[1]&&Dv(v[1])||{r:"",t:"",h:""};d.r=_.r,_.r=="<t></t>"&&(_.t=_.h=""),d.t=(_.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(d.h=_.h),n.push(d)}}}}),n}function A4(t){var e=[Mr,He("comments",null,{xmlns:Pl[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(a){var o=Jt(a.a);r.indexOf(o)==-1&&(r.push(o),e.push("<author>"+o+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),e.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var a=0,o=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(h){h.a&&(a=r.indexOf(Jt(h.a))),o.push(h.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),o.length<=1)e.push(En("t",Jt(o[0]||"")));else{for(var l=`Comment:
    `+o[0]+`
`,u=1;u<o.length;++u)l+=`Reply:
    `+o[u]+`
`;e.push(En("t",Jt(l)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function sU(t,e){var r=[],n=!1,a={},o=0;return t.replace(Mn,function(u,h){var d=dt(u);switch(Bi(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":o=h+u.length;break;case"</text>":a.t=t.slice(o,h).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return u}),r}function oU(t,e,r){var n=[Mr,He("ThreadedComments",null,{xmlns:Jr.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(a){var o="";(a[1]||[]).forEach(function(l,u){if(!l.T){delete l.ID;return}l.a&&e.indexOf(l.a)==-1&&e.push(l.a);var h={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};u==0?o=h.id:h.parentId=o,l.ID=h.id,l.a&&(h.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(l.a)).slice(-12)+"}"),n.push(He("threadedComment",En("text",l.t||""),h))})}),n.push("</ThreadedComments>"),n.join("")}function lU(t,e){var r=[],n=!1;return t.replace(Mn,function(o){var l=dt(o);switch(Bi(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return o}),r}function cU(t){var e=[Mr,He("personList",null,{xmlns:Jr.TCMNT,"xmlns:x":Pl[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(He("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function uU(t){var e={};e.iauthor=t.read_shift(4);var r=Bl(t);return e.rfx=r.s,e.ref=lt(r.s),t.l+=16,e}function fU(t,e){return e==null&&(e=Ae(36)),e.write_shift(4,t[1].iauthor),fu(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var hU=On;function dU(t){return hn(t.slice(0,54))}function mU(t,e){var r=[],n=[],a={},o=!1;return ys(t,function(u,h,d){switch(d){case 632:n.push(u);break;case 635:a=u;break;case 637:a.t=u.t,a.h=u.h,a.r=u.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,e.sheetRows&&a.rfx&&e.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!h.T){if(!o||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function pU(t){var e=na(),r=[];return Fe(e,628),Fe(e,630),t.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),Fe(e,632,dU(a.a)))})}),Fe(e,631),Fe(e,633),t.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var o={s:yr(n[0]),e:yr(n[0])};Fe(e,635,fU([o,a])),a.t&&a.t.length>0&&Fe(e,637,LP(a)),Fe(e,636),delete a.iauthor})}),Fe(e,634),Fe(e,629),e.end()}var gU="application/vnd.ms-office.vbaProject";function xU(t){var e=Je.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Je.utils.cfb_add(e,a,t.FileIndex[n].content)}}),Je.write(e)}function vU(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&Je.utils.cfb_add(t,a,e.FileIndex[n].content)}})}var b4=["xlsb","xlsm","xlam","biff8","xla"];function _U(){return{"!type":"dialog"}}function yU(){return{"!type":"dialog"}}function EU(){return{"!type":"macro"}}function TU(){return{"!type":"macro"}}var qc=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,a,o,l){var u=!1,h=!1;o.length==0?h=!0:o.charAt(0)=="["&&(h=!0,o=o.slice(1,-1)),l.length==0?u=!0:l.charAt(0)=="["&&(u=!0,l=l.slice(1,-1));var d=o.length>0?parseInt(o,10)|0:0,p=l.length>0?parseInt(l,10)|0:0;return u?p+=e.c:--p,h?d+=e.r:--d,a+(u?"":"$")+_r(p)+(h?"":"$")+Pr(d)}return function(a,o){return e=o,a.replace(t,r)}}(),Mv=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Lv=function(){return function(e,r){return e.replace(Mv,function(n,a,o,l,u,h){var d=wv(l)-(o?0:r.c),p=Tv(h)-(u?0:r.r),v=p==0?"":u?p+1:"["+p+"]",_=d==0?"":o?d+1:"["+d+"]";return a+"R"+v+"C"+_})}}();function k4(t,e){return t.replace(Mv,function(r,n,a,o,l,u){return n+(a=="$"?a+o:_r(wv(o)+e.c))+(l=="$"?l+u:Pr(Tv(u)+e.r))})}function wU(t,e,r){var n=aa(e),a=n.s,o=yr(r),l={r:o.r-a.r,c:o.c-a.c};return k4(t,l)}function SU(t){return t.length!=1}function zw(t){return t.replace(/_xlfn\./g,"")}function Hr(t){t.l+=1}function wo(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function C4(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return R4(t);r.biff==12&&(n=4)}var a=t.read_shift(n),o=t.read_shift(n),l=wo(t),u=wo(t);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:o,c:u[0],cRel:u[1],rRel:u[2]}}}function R4(t){var e=wo(t),r=wo(t),n=t.read_shift(1),a=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function AU(t,e,r){if(r.biff<8)return R4(t);var n=t.read_shift(r.biff==12?4:2),a=t.read_shift(r.biff==12?4:2),o=wo(t),l=wo(t);return{s:{r:n,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function I4(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return bU(t);var n=t.read_shift(r&&r.biff==12?4:2),a=wo(t);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function bU(t){var e=wo(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function kU(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function CU(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return RU(t);var a=t.read_shift(n>=12?4:2),o=t.read_shift(2),l=(o&16384)>>14,u=(o&32768)>>15;if(o&=16383,u==1)for(;a>524287;)a-=1048576;if(l==1)for(;o>8191;)o=o-16384;return{r:a,c:o,cRel:l,rRel:u}}function RU(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,a=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),a==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:a,rRel:n}}function IU(t,e,r){var n=(t[t.l++]&96)>>5,a=C4(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function NU(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2,"i"),o=8;if(r)switch(r.biff){case 5:t.l+=12,o=6;break;case 12:o=12;break}var l=C4(t,o,r);return[n,a,l]}function DU(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function OU(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2),o=8;if(r)switch(r.biff){case 5:t.l+=12,o=6;break;case 12:o=12;break}return t.l+=o,[n,a]}function FU(t,e,r){var n=(t[t.l++]&96)>>5,a=AU(t,e-1,r);return[n,a]}function PU(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Gw(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function MU(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),a=[],o=0;o<=n;++o)a.push(t.read_shift(r&&r.biff==2?1:2));return a}function LU(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function UU(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function BU(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function VU(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function N4(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function jU(t){return t.read_shift(2),N4(t)}function HU(t){return t.read_shift(2),N4(t)}function zU(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=I4(t,0,r);return[n,a]}function GU(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=CU(t,0,r);return[n,a]}function qU(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var o=I4(t,0,r);return[n,a,o]}function WU(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(r&&r.biff<=3?1:2);return[YB[a],F4[a],n]}function XU(t,e,r){var n=t[t.l++],a=t.read_shift(1),o=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:KU(t);return[a,(o[0]===0?F4:KB)[o[1]]]}function KU(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function YU(t,e,r){t.l+=r&&r.biff==2?3:4}function $U(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function QU(t){return t.l++,Es[t.read_shift(1)]}function ZU(t){return t.l++,t.read_shift(2)}function JU(t){return t.l++,t.read_shift(1)!==0}function eB(t){return t.l++,Dn(t)}function tB(t,e,r){return t.l++,C0(t,e-1,r)}function rB(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Or(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=Es[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Dn(t);break;case 2:r[1]=Vl(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function nB(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),a=[],o=0;o!=n;++o)a.push((r.biff==12?Bl:Dm)(t));return a}function aB(t,e,r){var n=0,a=0;r.biff==12?(n=t.read_shift(4),a=t.read_shift(4)):(a=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var o=0,l=[];o!=n&&(l[o]=[]);++o)for(var u=0;u!=a;++u)l[o][u]=rB(t,r.biff);return l}function iB(t,e,r){var n=t.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,o=t.read_shift(a);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,o]}function sB(t,e,r){if(r.biff==5)return oB(t);var n=t.read_shift(1)>>>5&3,a=t.read_shift(2),o=t.read_shift(4);return[n,a,o]}function oB(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function lB(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function cB(t,e,r){var n=t.read_shift(1)>>>5&3,a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function uB(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function fB(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2),o=4;if(r)switch(r.biff){case 5:o=15;break;case 12:o=6;break}return t.l+=o,[n,a]}var hB=Pn,dB=Pn,mB=Pn;function I0(t,e,r){return t.l+=2,[kU(t)]}function Uv(t){return t.l+=6,[]}var pB=I0,gB=Uv,xB=Uv,vB=I0;function D4(t){return t.l+=2,[qr(t),t.read_shift(2)&1]}var _B=I0,yB=D4,EB=Uv,TB=I0,wB=I0,SB=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function AB(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),a=t.read_shift(2),o=t.read_shift(2),l=SB[r>>2&31];return{ixti:e,coltype:r&3,rt:l,idx:n,c:a,C:o}}function bB(t){return t.l+=2,[t.read_shift(4)]}function kB(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function CB(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function RB(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function IB(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function NB(t){return t.l+=4,[0,0]}var qw={1:{n:"PtgExp",f:$U},2:{n:"PtgTbl",f:mB},3:{n:"PtgAdd",f:Hr},4:{n:"PtgSub",f:Hr},5:{n:"PtgMul",f:Hr},6:{n:"PtgDiv",f:Hr},7:{n:"PtgPower",f:Hr},8:{n:"PtgConcat",f:Hr},9:{n:"PtgLt",f:Hr},10:{n:"PtgLe",f:Hr},11:{n:"PtgEq",f:Hr},12:{n:"PtgGe",f:Hr},13:{n:"PtgGt",f:Hr},14:{n:"PtgNe",f:Hr},15:{n:"PtgIsect",f:Hr},16:{n:"PtgUnion",f:Hr},17:{n:"PtgRange",f:Hr},18:{n:"PtgUplus",f:Hr},19:{n:"PtgUminus",f:Hr},20:{n:"PtgPercent",f:Hr},21:{n:"PtgParen",f:Hr},22:{n:"PtgMissArg",f:Hr},23:{n:"PtgStr",f:tB},26:{n:"PtgSheet",f:kB},27:{n:"PtgEndSheet",f:CB},28:{n:"PtgErr",f:QU},29:{n:"PtgBool",f:JU},30:{n:"PtgInt",f:ZU},31:{n:"PtgNum",f:eB},32:{n:"PtgArray",f:PU},33:{n:"PtgFunc",f:WU},34:{n:"PtgFuncVar",f:XU},35:{n:"PtgName",f:iB},36:{n:"PtgRef",f:zU},37:{n:"PtgArea",f:IU},38:{n:"PtgMemArea",f:lB},39:{n:"PtgMemErr",f:hB},40:{n:"PtgMemNoMem",f:dB},41:{n:"PtgMemFunc",f:cB},42:{n:"PtgRefErr",f:uB},43:{n:"PtgAreaErr",f:DU},44:{n:"PtgRefN",f:GU},45:{n:"PtgAreaN",f:FU},46:{n:"PtgMemAreaN",f:RB},47:{n:"PtgMemNoMemN",f:IB},57:{n:"PtgNameX",f:sB},58:{n:"PtgRef3d",f:qU},59:{n:"PtgArea3d",f:NU},60:{n:"PtgRefErr3d",f:fB},61:{n:"PtgAreaErr3d",f:OU},255:{}},DB={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},OB={1:{n:"PtgElfLel",f:D4},2:{n:"PtgElfRw",f:TB},3:{n:"PtgElfCol",f:pB},6:{n:"PtgElfRwV",f:wB},7:{n:"PtgElfColV",f:vB},10:{n:"PtgElfRadical",f:_B},11:{n:"PtgElfRadicalS",f:EB},13:{n:"PtgElfColS",f:gB},15:{n:"PtgElfColSV",f:xB},16:{n:"PtgElfRadicalLel",f:yB},25:{n:"PtgList",f:AB},29:{n:"PtgSxName",f:bB},255:{}},FB={0:{n:"PtgAttrNoop",f:NB},1:{n:"PtgAttrSemi",f:VU},2:{n:"PtgAttrIf",f:UU},4:{n:"PtgAttrChoose",f:MU},8:{n:"PtgAttrGoto",f:LU},16:{n:"PtgAttrSum",f:YU},32:{n:"PtgAttrBaxcel",f:Gw},33:{n:"PtgAttrBaxcel",f:Gw},64:{n:"PtgAttrSpace",f:jU},65:{n:"PtgAttrSpaceSemi",f:HU},128:{n:"PtgAttrIfError",f:BU},255:{}};function N0(t,e,r,n){if(n.biff<8)return Pn(t,e);for(var a=t.l+e,o=[],l=0;l!==r.length;++l)switch(r[l][0]){case"PtgArray":r[l][1]=aB(t,0,n),o.push(r[l][1]);break;case"PtgMemArea":r[l][2]=nB(t,r[l][1],n),o.push(r[l][2]);break;case"PtgExp":n&&n.biff==12&&(r[l][1][1]=t.read_shift(4),o.push(r[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[l][0]}return e=a-t.l,e!==0&&o.push(Pn(t,e)),o}function D0(t,e,r){for(var n=t.l+e,a,o,l=[];n!=t.l;)e=n-t.l,o=t[t.l],a=qw[o]||qw[DB[o]],(o===24||o===25)&&(a=(o===24?OB:FB)[t[t.l+1]]),!a||!a.f?Pn(t,e):l.push([a.n,a.f(t,e,r)]);return l}function PB(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],a=[],o=0;o<n.length;++o){var l=n[o];if(l)switch(l[0]){case 2:a.push('"'+l[1].replace(/"/g,'""')+'"');break;default:a.push(l[1])}else a.push("")}e.push(a.join(","))}return e.join(";")}var MB={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function LB(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function O4(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(t[n[0]][0]){case 357:return a=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?a:a+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return t[n[0]][0][3]?(a=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Ww(t,e,r){var n=O4(t,e,r);return n=="#REF"?n:LB(n,r)}function Rn(t,e,r,n,a){var o=a&&a.biff||8,l={s:{c:0,r:0}},u=[],h,d,p,v=0,_=0,E,S="";if(!t[0]||!t[0][0])return"";for(var y=-1,w="",P=0,B=t[0].length;P<B;++P){var N=t[0][P];switch(N[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(h=u.pop(),d=u.pop(),y>=0){switch(t[0][y][1][0]){case 0:w=Sr(" ",t[0][y][1][1]);break;case 1:w=Sr("\r",t[0][y][1][1]);break;default:if(w="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][y][1][0])}d=d+w,y=-1}u.push(d+MB[N[0]]+h);break;case"PtgIsect":h=u.pop(),d=u.pop(),u.push(d+" "+h);break;case"PtgUnion":h=u.pop(),d=u.pop(),u.push(d+","+h);break;case"PtgRange":h=u.pop(),d=u.pop(),u.push(d+":"+h);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":p=Ff(N[1][1],l,a),u.push(Pf(p,o));break;case"PtgRefN":p=r?Ff(N[1][1],r,a):N[1][1],u.push(Pf(p,o));break;case"PtgRef3d":v=N[1][1],p=Ff(N[1][2],l,a),S=Ww(n,v,a),u.push(S+"!"+Pf(p,o));break;case"PtgFunc":case"PtgFuncVar":var z=N[1][0],q=N[1][1];z||(z=0),z&=127;var Z=z==0?[]:u.slice(-z);u.length-=z,q==="User"&&(q=Z.shift()),u.push(q+"("+Z.join(",")+")");break;case"PtgBool":u.push(N[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(N[1]);break;case"PtgNum":u.push(String(N[1]));break;case"PtgStr":u.push('"'+N[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(N[1]);break;case"PtgAreaN":E=Ew(N[1][1],r?{s:r}:l,a),u.push(Jg(E,a));break;case"PtgArea":E=Ew(N[1][1],l,a),u.push(Jg(E,a));break;case"PtgArea3d":v=N[1][1],E=N[1][2],S=Ww(n,v,a),u.push(S+"!"+Jg(E,a));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":_=N[1][2];var C=(n.names||[])[_-1]||(n[0]||[])[_],I=C?C.Name:"SH33TJSNAME"+String(_);I&&I.slice(0,6)=="_xlfn."&&!a.xlfn&&(I=I.slice(6)),u.push(I);break;case"PtgNameX":var b=N[1][1];_=N[1][2];var O;if(a.biff<=5)b<0&&(b=-b),n[b]&&(O=n[b][_]);else{var L="";if(((n[b]||[])[0]||[])[0]==14849||(((n[b]||[])[0]||[])[0]==1025?n[b][_]&&n[b][_].itab>0&&(L=n.SheetNames[n[b][_].itab-1]+"!"):L=n.SheetNames[_-1]+"!"),n[b]&&n[b][_])L+=n[b][_].Name;else if(n[0]&&n[0][_])L+=n[0][_].Name;else{var M=(O4(n,b,a)||"").split(";;");M[_-1]?L=M[_-1]:L+="SH33TJSERRX"}u.push(L);break}O||(O={Name:"SH33TJSERRY"}),u.push(O.Name);break;case"PtgParen":var D="(",Ee=")";if(y>=0){switch(w="",t[0][y][1][0]){case 2:D=Sr(" ",t[0][y][1][1])+D;break;case 3:D=Sr("\r",t[0][y][1][1])+D;break;case 4:Ee=Sr(" ",t[0][y][1][1])+Ee;break;case 5:Ee=Sr("\r",t[0][y][1][1])+Ee;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][y][1][0])}y=-1}u.push(D+u.pop()+Ee);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":p={c:N[1][1],r:N[1][0]};var Te={c:r.c,r:r.r};if(n.sharedf[lt(p)]){var ne=n.sharedf[lt(p)];u.push(Rn(ne,l,Te,n,a))}else{var ue=!1;for(h=0;h!=n.arrayf.length;++h)if(d=n.arrayf[h],!(p.c<d[0].s.c||p.c>d[0].e.c)&&!(p.r<d[0].s.r||p.r>d[0].e.r)){u.push(Rn(d[1],l,Te,n,a)),ue=!0;break}ue||u.push(N[1])}break;case"PtgArray":u.push("{"+PB(N[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":y=P;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+N[1].idx+"[#"+N[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(N));default:throw new Error("Unrecognized Formula Token: "+String(N))}var Ue=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&y>=0&&Ue.indexOf(t[0][P][0])==-1){N=t[0][y];var ie=!0;switch(N[1][0]){case 4:ie=!1;case 0:w=Sr(" ",N[1][1]);break;case 5:ie=!1;case 1:w=Sr("\r",N[1][1]);break;default:if(w="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+N[1][0])}u.push((ie?w:"")+u.pop()+(ie?"":w)),y=-1}}if(u.length>1&&a.WTF)throw new Error("bad formula stack");return u[0]}function UB(t,e,r){var n=t.l+e,a=r.biff==2?1:2,o,l=t.read_shift(a);if(l==65535)return[[],Pn(t,e-2)];var u=D0(t,l,r);return e!==l+a&&(o=N0(t,e-l-a,u,r)),t.l=n,[u,o]}function BB(t,e,r){var n=t.l+e,a=r.biff==2?1:2,o,l=t.read_shift(a);if(l==65535)return[[],Pn(t,e-2)];var u=D0(t,l,r);return e!==l+a&&(o=N0(t,e-l-a,u,r)),t.l=n,[u,o]}function VB(t,e,r,n){var a=t.l+e,o=D0(t,n,r),l;return a!==t.l&&(l=N0(t,a-t.l,o,r)),[o,l]}function jB(t,e,r){var n=t.l+e,a,o=t.read_shift(2),l=D0(t,o,r);return o==65535?[[],Pn(t,e-2)]:(e!==o+2&&(a=N0(t,n-o-2,l,r)),[l,a])}function HB(t){var e;if(us(t,t.l+6)!==65535)return[Dn(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function zB(t){if(t==null){var e=Ae(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return bl(t);return bl(0)}function a1(t,e,r){var n=t.l+e,a=Vi(t);r.biff==2&&++t.l;var o=HB(t),l=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var u=BB(t,n-t.l,r);return{cell:a,val:o[0],formula:u,shared:l>>3&1,tt:o[1]}}function GB(t,e,r,n,a){var o=Cl(e,r,a),l=zB(t.v),u=Ae(6),h=33;u.write_shift(2,h),u.write_shift(4,0);for(var d=Ae(t.bf.length),p=0;p<t.bf.length;++p)d[p]=t.bf[p];var v=fn([o,l,u,d]);return v}function Om(t,e,r){var n=t.read_shift(4),a=D0(t,n,r),o=t.read_shift(4),l=o>0?N0(t,o,a,r):null;return[a,l]}var qB=Om,Fm=Om,WB=Om,XB=Om,KB={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},F4={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},YB={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Xw(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function $B(t){var e="of:="+t.replace(Mv,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function i1(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function QB(t){return t.replace(/\./,"!")}var Lf={},Wc={},Uf=typeof Map<"u";function Bv(t,e,r){var n=0,a=t.length;if(r){if(Uf?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var o=Uf?r.get(e):r[e];n<o.length;++n)if(t[o[n]].t===e)return t.Count++,o[n]}}else for(;n<a;++n)if(t[n].t===e)return t.Count++,n;return t[a]={t:e},t.Count++,t.Unique++,r&&(Uf?(r.has(e)||r.set(e,[]),r.get(e).push(a)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(a))),a}function Pm(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(Nn=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=i0(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=nm(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function pl(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function Do(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],a=60,o=t.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){Mi(e.z,a),r.ssf[a]=e.z,r.revssf[e.z]=n=a;break}}for(a=0;a!=o;++a)if(t[a].numFmtId===n)return a;return t[o]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},o}function P4(t,e,r,n,a,o){try{n.cellNF&&(t.z=tt[e])}catch(u){if(n.WTF)throw u}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=mr(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(tt[e]==null&&Mi(K5[e]||"General",e),t.t==="e")t.w=t.w||Es[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Zf(t.v);else if(t.t==="d"){var l=rn(t.v);(l|0)===l?t.w=l.toString(10):t.w=Zf(l)}else{if(t.v===void 0)return"";t.w=Sl(t.v,Wc)}else t.t==="d"?t.w=Ta(e,rn(t.v),Wc):t.w=Ta(e,t.v,Wc)}catch(u){if(n.WTF)throw u}if(n.cellStyles&&r!=null)try{t.s=o.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=rm(a.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=a.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=rm(a.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=a.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(u){if(n.WTF&&o.Fills)throw u}}}function ZB(t,e,r){if(t&&t["!ref"]){var n=Ht(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function JB(t,e){var r=Ht(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=yt(r))}var eV=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,tV=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,rV=/<(?:\w:)?hyperlink [^>]*>/mg,nV=/"(\w*:\w*)"/,aV=/<(?:\w:)?col\b[^>]*[\/]?>/g,iV=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,sV=/<(?:\w:)?pageMargins[^>]*\/>/g,M4=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,oV=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,lV=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function cV(t,e,r,n,a,o,l){if(!t)return t;n||(n={"!id":{}});var u=e.dense?[]:{},h={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",p="",v=t.match(tV);v?(d=t.slice(0,v.index),p=t.slice(v.index+v[0].length)):d=p=t;var _=d.match(M4);_?Vv(_[0],u,a,r):(_=d.match(oV))&&fV(_[0],_[1]||"",u,a,r);var E=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(E>0){var S=d.slice(E,E+50).match(nV);S&&JB(u,S[1])}var y=d.match(lV);y&&y[1]&&SV(y[1],a);var w=[];if(e.cellStyles){var P=d.match(aV);P&&_V(w,P)}v&&kV(v[1],u,e,h,o,l);var B=p.match(iV);B&&(u["!autofilter"]=EV(B[0]));var N=[],z=p.match(eV);if(z)for(E=0;E!=z.length;++E)N[E]=Ht(z[E].slice(z[E].indexOf('"')+1));var q=p.match(rV);q&&gV(u,q,n);var Z=p.match(sV);if(Z&&(u["!margins"]=xV(dt(Z[0]))),!u["!ref"]&&h.e.c>=h.s.c&&h.e.r>=h.s.r&&(u["!ref"]=yt(h)),e.sheetRows>0&&u["!ref"]){var C=Ht(u["!ref"]);e.sheetRows<=+C.e.r&&(C.e.r=e.sheetRows-1,C.e.r>h.e.r&&(C.e.r=h.e.r),C.e.r<C.s.r&&(C.s.r=C.e.r),C.e.c>h.e.c&&(C.e.c=h.e.c),C.e.c<C.s.c&&(C.s.c=C.e.c),u["!fullref"]=u["!ref"],u["!ref"]=yt(C))}return w.length>0&&(u["!cols"]=w),N.length>0&&(u["!merges"]=N),u}function uV(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+yt(t[r])+'"/>';return e+"</mergeCells>"}function Vv(t,e,r,n){var a=dt(t);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=jt(ar(a.codeName)))}function fV(t,e,r,n,a){Vv(t.slice(0,t.indexOf(">")),r,n,a)}function hV(t,e,r,n,a){var o=!1,l={},u=null;if(n.bookType!=="xlsx"&&e.vbaraw){var h=e.SheetNames[r];try{e.Workbook&&(h=e.Workbook.Sheets[r].CodeName||h)}catch{}o=!0,l.codeName=Ci(Jt(h))}if(t&&t["!outline"]){var d={summaryBelow:1,summaryRight:1};t["!outline"].above&&(d.summaryBelow=0),t["!outline"].left&&(d.summaryRight=0),u=(u||"")+He("outlinePr",null,d)}!o&&!u||(a[a.length]=He("sheetPr",u,l))}var dV=["objects","scenarios","selectLockedCells","selectUnlockedCells"],mV=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function pV(t){var e={sheet:1};return dV.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),mV.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=Ov(t.password).toString(16).toUpperCase()),He("sheetProtection",null,e)}function gV(t,e,r){for(var n=Array.isArray(t),a=0;a!=e.length;++a){var o=dt(ar(e[a]),!0);if(!o.ref)return;var l=((r||{})["!id"]||[])[o.id];l?(o.Target=l.Target,o.location&&(o.Target+="#"+jt(o.location))):(o.Target="#"+jt(o.location),l={Target:o.Target,TargetMode:"Internal"}),o.Rel=l,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip);for(var u=Ht(o.ref),h=u.s.r;h<=u.e.r;++h)for(var d=u.s.c;d<=u.e.c;++d){var p=lt({c:d,r:h});n?(t[h]||(t[h]=[]),t[h][d]||(t[h][d]={t:"z",v:void 0}),t[h][d].l=o):(t[p]||(t[p]={t:"z",v:void 0}),t[p].l=o)}}}function xV(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function vV(t){return pl(t),He("pageMargins",null,t)}function _V(t,e){for(var r=!1,n=0;n!=e.length;++n){var a=dt(e[n],!0);a.hidden&&(a.hidden=hr(a.hidden));var o=parseInt(a.min,10)-1,l=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,Fv(a.width)),To(a);o<=l;)t[o++]=pr(a)}}function yV(t,e){for(var r=["<cols>"],n,a=0;a!=e.length;++a)(n=e[a])&&(r[r.length]=He("col",null,Pm(a,n)));return r[r.length]="</cols>",r.join("")}function EV(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function TV(t,e,r,n){var a=typeof t.ref=="string"?t.ref:yt(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=aa(a);l.s.r==l.e.r&&(l.e.r=aa(e["!ref"]).e.r,a=yt(l));for(var u=0;u<o.length;++u){var h=o[u];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==n){h.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return u==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),He("autoFilter",null,{ref:a})}var wV=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function SV(t,e){e.Views||(e.Views=[{}]),(t.match(wV)||[]).forEach(function(r,n){var a=dt(r);e.Views[n]||(e.Views[n]={}),+a.zoomScale&&(e.Views[n].zoom=+a.zoomScale),hr(a.rightToLeft)&&(e.Views[n].RTL=!0)})}function AV(t,e,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),He("sheetViews",He("sheetView",null,a),{})}function bV(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var a="",o=t.t,l=t.v;if(t.t!=="z")switch(t.t){case"b":a=t.v?"1":"0";break;case"n":a=""+t.v;break;case"e":a=Es[t.v];break;case"d":n&&n.cellDates?a=mr(t.v,-1).toISOString():(t=pr(t),t.t="n",a=""+(t.v=rn(mr(t.v)))),typeof t.z>"u"&&(t.z=tt[14]);break;default:a=t.v;break}var u=En("v",Jt(a)),h={r:e},d=Do(n.cellXfs,t,n);switch(d!==0&&(h.s=d),t.t){case"n":break;case"d":h.t="d";break;case"b":h.t="b";break;case"e":h.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){u=En("v",""+Bv(n.Strings,t.v,n.revStrings)),h.t="s";break}h.t="str";break}if(t.t!=o&&(t.t=o,t.v=l),typeof t.f=="string"&&t.f){var p=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;u=He("f",Jt(t.f),p)+(t.v!=null?u:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(h.cm=1),He("c",u,h)}var kV=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,o=Jf("v"),l=Jf("f");return function(h,d,p,v,_,E){for(var S=0,y="",w=[],P=[],B=0,N=0,z=0,q="",Z,C,I=0,b=0,O,L,M=0,D=0,Ee=Array.isArray(E.CellXf),Te,ne=[],ue=[],Ue=Array.isArray(d),ie=[],K={},pe=!1,V=!!p.sheetStubs,X=h.split(e),ee=0,te=X.length;ee!=te;++ee){y=X[ee].trim();var le=y.length;if(le!==0){var Ne=0;e:for(S=0;S<le;++S)switch(y[S]){case">":if(y[S-1]!="/"){++S;break e}if(p&&p.cellStyles){if(C=dt(y.slice(Ne,S),!0),I=C.r!=null?parseInt(C.r,10):I+1,b=-1,p.sheetRows&&p.sheetRows<I)continue;K={},pe=!1,C.ht&&(pe=!0,K.hpt=parseFloat(C.ht),K.hpx=tu(K.hpt)),C.hidden=="1"&&(pe=!0,K.hidden=!0),C.outlineLevel!=null&&(pe=!0,K.level=+C.outlineLevel),pe&&(ie[I-1]=K)}break;case"<":Ne=S;break}if(Ne>=S)break;if(C=dt(y.slice(Ne,S),!0),I=C.r!=null?parseInt(C.r,10):I+1,b=-1,!(p.sheetRows&&p.sheetRows<I)){v.s.r>I-1&&(v.s.r=I-1),v.e.r<I-1&&(v.e.r=I-1),p&&p.cellStyles&&(K={},pe=!1,C.ht&&(pe=!0,K.hpt=parseFloat(C.ht),K.hpx=tu(K.hpt)),C.hidden=="1"&&(pe=!0,K.hidden=!0),C.outlineLevel!=null&&(pe=!0,K.level=+C.outlineLevel),pe&&(ie[I-1]=K)),w=y.slice(S).split(t);for(var ke=0;ke!=w.length&&w[ke].trim().charAt(0)=="<";++ke);for(w=w.slice(ke),S=0;S!=w.length;++S)if(y=w[S].trim(),y.length!==0){if(P=y.match(r),B=S,N=0,z=0,y="<c "+(y.slice(0,1)=="<"?">":"")+y,P!=null&&P.length===2){for(B=0,q=P[1],N=0;N!=q.length&&!((z=q.charCodeAt(N)-64)<1||z>26);++N)B=26*B+z;--B,b=B}else++b;for(N=0;N!=y.length&&y.charCodeAt(N)!==62;++N);if(++N,C=dt(y.slice(0,N),!0),C.r||(C.r=lt({r:I-1,c:b})),q=y.slice(N),Z={t:""},(P=q.match(o))!=null&&P[1]!==""&&(Z.v=jt(P[1])),p.cellFormula){if((P=q.match(l))!=null&&P[1]!==""){if(Z.f=jt(ar(P[1])).replace(/\r\n/g,`
`),p.xlfn||(Z.f=zw(Z.f)),P[0].indexOf('t="array"')>-1)Z.F=(q.match(a)||[])[1],Z.F.indexOf(":")>-1&&ne.push([Ht(Z.F),Z.F]);else if(P[0].indexOf('t="shared"')>-1){L=dt(P[0]);var Oe=jt(ar(P[1]));p.xlfn||(Oe=zw(Oe)),ue[parseInt(L.si,10)]=[L,Oe,C.r]}}else(P=q.match(/<f[^>]*\/>/))&&(L=dt(P[0]),ue[L.si]&&(Z.f=wU(ue[L.si][1],ue[L.si][2],C.r)));var _e=yr(C.r);for(N=0;N<ne.length;++N)_e.r>=ne[N][0].s.r&&_e.r<=ne[N][0].e.r&&_e.c>=ne[N][0].s.c&&_e.c<=ne[N][0].e.c&&(Z.F=ne[N][1])}if(C.t==null&&Z.v===void 0)if(Z.f||Z.F)Z.v=0,Z.t="n";else if(V)Z.t="z";else continue;else Z.t=C.t||"n";switch(v.s.c>b&&(v.s.c=b),v.e.c<b&&(v.e.c=b),Z.t){case"n":if(Z.v==""||Z.v==null){if(!V)continue;Z.t="z"}else Z.v=parseFloat(Z.v);break;case"s":if(typeof Z.v>"u"){if(!V)continue;Z.t="z"}else O=Lf[parseInt(Z.v,10)],Z.v=O.t,Z.r=O.r,p.cellHTML&&(Z.h=O.h);break;case"str":Z.t="s",Z.v=Z.v!=null?ar(Z.v):"",p.cellHTML&&(Z.h=vv(Z.v));break;case"inlineStr":P=q.match(n),Z.t="s",P!=null&&(O=Dv(P[1]))?(Z.v=O.t,p.cellHTML&&(Z.h=O.h)):Z.v="";break;case"b":Z.v=hr(Z.v);break;case"d":p.cellDates?Z.v=mr(Z.v,1):(Z.v=rn(mr(Z.v,1)),Z.t="n");break;case"e":(!p||p.cellText!==!1)&&(Z.w=Z.v),Z.v=Uk[Z.v];break}if(M=D=0,Te=null,Ee&&C.s!==void 0&&(Te=E.CellXf[C.s],Te!=null&&(Te.numFmtId!=null&&(M=Te.numFmtId),p.cellStyles&&Te.fillId!=null&&(D=Te.fillId))),P4(Z,M,D,p,_,E),p.cellDates&&Ee&&Z.t=="n"&&Fl(tt[M])&&(Z.t="d",Z.v=Nm(Z.v)),C.cm&&p.xlmeta){var Be=(p.xlmeta.Cell||[])[+C.cm-1];Be&&Be.type=="XLDAPR"&&(Z.D=!0)}if(Ue){var W=yr(C.r);d[W.r]||(d[W.r]=[]),d[W.r][W.c]=Z}else d[C.r]=Z}}}}ie.length>0&&(d["!rows"]=ie)}}();function CV(t,e,r,n){var a=[],o=[],l=Ht(t["!ref"]),u="",h,d="",p=[],v=0,_=0,E=t["!rows"],S=Array.isArray(t),y={r:d},w,P=-1;for(_=l.s.c;_<=l.e.c;++_)p[_]=_r(_);for(v=l.s.r;v<=l.e.r;++v){for(o=[],d=Pr(v),_=l.s.c;_<=l.e.c;++_){h=p[_]+d;var B=S?(t[v]||[])[_]:t[h];B!==void 0&&(u=bV(B,h,t,e))!=null&&o.push(u)}(o.length>0||E&&E[v])&&(y={r:d},E&&E[v]&&(w=E[v],w.hidden&&(y.hidden=1),P=-1,w.hpx?P=s0(w.hpx):w.hpt&&(P=w.hpt),P>-1&&(y.ht=P,y.customHeight=1),w.level&&(y.outlineLevel=w.level)),a[a.length]=He("row",o.join(""),y))}if(E)for(;v<E.length;++v)E&&E[v]&&(y={r:v+1},w=E[v],w.hidden&&(y.hidden=1),P=-1,w.hpx?P=s0(w.hpx):w.hpt&&(P=w.hpt),P>-1&&(y.ht=P,y.customHeight=1),w.level&&(y.outlineLevel=w.level),a[a.length]=He("row","",y));return a.join("")}function L4(t,e,r,n){var a=[Mr,He("worksheet",null,{xmlns:Pl[0],"xmlns:r":Jr.r})],o=r.SheetNames[t],l=0,u="",h=r.Sheets[o];h==null&&(h={});var d=h["!ref"]||"A1",p=Ht(d);if(p.e.c>16383||p.e.r>1048575){if(e.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");p.e.c=Math.min(p.e.c,16383),p.e.r=Math.min(p.e.c,1048575),d=yt(p)}n||(n={}),h["!comments"]=[];var v=[];hV(h,r,t,e,a),a[a.length]=He("dimension",null,{ref:d}),a[a.length]=AV(h,e,t,r),e.sheetFormat&&(a[a.length]=He("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),h["!cols"]!=null&&h["!cols"].length>0&&(a[a.length]=yV(h,h["!cols"])),a[l=a.length]="<sheetData/>",h["!links"]=[],h["!ref"]!=null&&(u=CV(h,e),u.length>0&&(a[a.length]=u)),a.length>l+1&&(a[a.length]="</sheetData>",a[l]=a[l].replace("/>",">")),h["!protect"]&&(a[a.length]=pV(h["!protect"])),h["!autofilter"]!=null&&(a[a.length]=TV(h["!autofilter"],h,r,t)),h["!merges"]!=null&&h["!merges"].length>0&&(a[a.length]=uV(h["!merges"]));var _=-1,E,S=-1;return h["!links"].length>0&&(a[a.length]="<hyperlinks>",h["!links"].forEach(function(y){y[1].Target&&(E={ref:y[0]},y[1].Target.charAt(0)!="#"&&(S=Zt(n,-1,Jt(y[1].Target).replace(/#.*$/,""),Ct.HLINK),E["r:id"]="rId"+S),(_=y[1].Target.indexOf("#"))>-1&&(E.location=Jt(y[1].Target.slice(_+1))),y[1].Tooltip&&(E.tooltip=Jt(y[1].Tooltip)),a[a.length]=He("hyperlink",null,E))}),a[a.length]="</hyperlinks>"),delete h["!links"],h["!margins"]!=null&&(a[a.length]=vV(h["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(a[a.length]=En("ignoredErrors",He("ignoredError",null,{numberStoredAsText:1,sqref:d}))),v.length>0&&(S=Zt(n,-1,"../drawings/drawing"+(t+1)+".xml",Ct.DRAW),a[a.length]=He("drawing",null,{"r:id":"rId"+S}),h["!drawing"]=v),h["!comments"].length>0&&(S=Zt(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Ct.VML),a[a.length]=He("legacyDrawing",null,{"r:id":"rId"+S}),h["!legacy"]=S),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function RV(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var a=t.read_shift(2);t.l+=1;var o=t.read_shift(1);return t.l=n,o&7&&(r.level=o&7),o&16&&(r.hidden=!0),o&32&&(r.hpt=a/20),r}function IV(t,e,r){var n=Ae(145),a=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var o=320;a.hpx?o=s0(a.hpx)*20:a.hpt&&(o=a.hpt*20),n.write_shift(2,o),n.write_shift(1,0);var l=0;a.level&&(l|=a.level),a.hidden&&(l|=16),(a.hpx||a.hpt)&&(l|=32),n.write_shift(1,l),n.write_shift(1,0);var u=0,h=n.l;n.l+=4;for(var d={r:t,c:0},p=0;p<16;++p)if(!(e.s.c>p+1<<10||e.e.c<p<<10)){for(var v=-1,_=-1,E=p<<10;E<p+1<<10;++E){d.c=E;var S=Array.isArray(r)?(r[d.r]||[])[d.c]:r[lt(d)];S&&(v<0&&(v=E),_=E)}v<0||(++u,n.write_shift(4,v),n.write_shift(4,_))}var y=n.l;return n.l=h,n.write_shift(4,u),n.l=y,n.length>n.l?n.slice(0,n.l):n}function NV(t,e,r,n){var a=IV(n,r,e);(a.length>17||(e["!rows"]||[])[n])&&Fe(t,0,a)}var DV=Bl,OV=fu;function FV(){}function PV(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=UP(t),r}function MV(t,e,r){r==null&&(r=Ae(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return Jd({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),Ok(t,r),r.slice(0,r.l)}function LV(t){var e=za(t);return[e]}function UV(t,e,r){return r==null&&(r=Ae(8)),Ml(e,r)}function BV(t){var e=Ll(t);return[e]}function VV(t,e,r){return r==null&&(r=Ae(4)),Ul(e,r)}function jV(t){var e=za(t),r=t.read_shift(1);return[e,r,"b"]}function HV(t,e,r){return r==null&&(r=Ae(9)),Ml(e,r),r.write_shift(1,t.v?1:0),r}function zV(t){var e=Ll(t),r=t.read_shift(1);return[e,r,"b"]}function GV(t,e,r){return r==null&&(r=Ae(5)),Ul(e,r),r.write_shift(1,t.v?1:0),r}function qV(t){var e=za(t),r=t.read_shift(1);return[e,r,"e"]}function WV(t,e,r){return r==null&&(r=Ae(9)),Ml(e,r),r.write_shift(1,t.v),r}function XV(t){var e=Ll(t),r=t.read_shift(1);return[e,r,"e"]}function KV(t,e,r){return r==null&&(r=Ae(8)),Ul(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function YV(t){var e=za(t),r=t.read_shift(4);return[e,r,"s"]}function $V(t,e,r){return r==null&&(r=Ae(12)),Ml(e,r),r.write_shift(4,e.v),r}function QV(t){var e=Ll(t),r=t.read_shift(4);return[e,r,"s"]}function ZV(t,e,r){return r==null&&(r=Ae(8)),Ul(e,r),r.write_shift(4,e.v),r}function JV(t){var e=za(t),r=Dn(t);return[e,r,"n"]}function ej(t,e,r){return r==null&&(r=Ae(16)),Ml(e,r),bl(t.v,r),r}function U4(t){var e=Ll(t),r=Dn(t);return[e,r,"n"]}function tj(t,e,r){return r==null&&(r=Ae(12)),Ul(e,r),bl(t.v,r),r}function rj(t){var e=za(t),r=kv(t);return[e,r,"n"]}function nj(t,e,r){return r==null&&(r=Ae(12)),Ml(e,r),Fk(t.v,r),r}function aj(t){var e=Ll(t),r=kv(t);return[e,r,"n"]}function ij(t,e,r){return r==null&&(r=Ae(8)),Ul(e,r),Fk(t.v,r),r}function sj(t){var e=za(t),r=Sv(t);return[e,r,"is"]}function oj(t){var e=za(t),r=On(t);return[e,r,"str"]}function lj(t,e,r){return r==null&&(r=Ae(12+4*t.v.length)),Ml(e,r),hn(t.v,r),r.length>r.l?r.slice(0,r.l):r}function cj(t){var e=Ll(t),r=On(t);return[e,r,"str"]}function uj(t,e,r){return r==null&&(r=Ae(8+4*t.v.length)),Ul(e,r),hn(t.v,r),r.length>r.l?r.slice(0,r.l):r}function fj(t,e,r){var n=t.l+e,a=za(t);a.r=r["!row"];var o=t.read_shift(1),l=[a,o,"b"];if(r.cellFormula){t.l+=2;var u=Fm(t,n-t.l,r);l[3]=Rn(u,null,a,r.supbooks,r)}else t.l=n;return l}function hj(t,e,r){var n=t.l+e,a=za(t);a.r=r["!row"];var o=t.read_shift(1),l=[a,o,"e"];if(r.cellFormula){t.l+=2;var u=Fm(t,n-t.l,r);l[3]=Rn(u,null,a,r.supbooks,r)}else t.l=n;return l}function dj(t,e,r){var n=t.l+e,a=za(t);a.r=r["!row"];var o=Dn(t),l=[a,o,"n"];if(r.cellFormula){t.l+=2;var u=Fm(t,n-t.l,r);l[3]=Rn(u,null,a,r.supbooks,r)}else t.l=n;return l}function mj(t,e,r){var n=t.l+e,a=za(t);a.r=r["!row"];var o=On(t),l=[a,o,"str"];if(r.cellFormula){t.l+=2;var u=Fm(t,n-t.l,r);l[3]=Rn(u,null,a,r.supbooks,r)}else t.l=n;return l}var pj=Bl,gj=fu;function xj(t,e){return e==null&&(e=Ae(4)),e.write_shift(4,t),e}function vj(t,e){var r=t.l+e,n=Bl(t),a=Av(t),o=On(t),l=On(t),u=On(t);t.l=r;var h={rfx:n,relId:a,loc:o,display:u};return l&&(h.Tooltip=l),h}function _j(t,e){var r=Ae(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));fu({s:yr(t[0]),e:yr(t[0])},r),bv("rId"+e,r);var n=t[1].Target.indexOf("#"),a=n==-1?"":t[1].Target.slice(n+1);return hn(a||"",r),hn(t[1].Tooltip||"",r),hn("",r),r.slice(0,r.l)}function yj(){}function Ej(t,e,r){var n=t.l+e,a=Pk(t),o=t.read_shift(1),l=[a];if(l[2]=o,r.cellFormula){var u=qB(t,n-t.l,r);l[1]=u}else t.l=n;return l}function Tj(t,e,r){var n=t.l+e,a=Bl(t),o=[a];if(r.cellFormula){var l=XB(t,n-t.l,r);o[1]=l,t.l=n}else t.l=n;return o}function wj(t,e,r){r==null&&(r=Ae(18));var n=Pm(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return e.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),e.level&&(a|=e.level<<8),r.write_shift(2,a),r}var B4=["left","right","top","bottom","header","footer"];function Sj(t){var e={};return B4.forEach(function(r){e[r]=Dn(t)}),e}function Aj(t,e){return e==null&&(e=Ae(6*8)),pl(t),B4.forEach(function(r){bl(t[r],e)}),e}function bj(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function kj(t,e,r){r==null&&(r=Ae(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function Cj(t){var e=Ae(24);return e.write_shift(4,4),e.write_shift(4,1),fu(t,e),e}function Rj(t,e){return e==null&&(e=Ae(16*4+2)),e.write_shift(2,t.password?Ov(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function Ij(){}function Nj(){}function Dj(t,e,r,n,a,o,l){if(!t)return t;var u=e||{};n||(n={"!id":{}});var h=u.dense?[]:{},d,p={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=!1,_=!1,E,S,y,w,P,B,N,z,q,Z=[];u.biff=12,u["!row"]=0;var C=0,I=!1,b=[],O={},L=u.supbooks||a.supbooks||[[]];if(L.sharedf=O,L.arrayf=b,L.SheetNames=a.SheetNames||a.Sheets.map(function(Ue){return Ue.name}),!u.supbooks&&(u.supbooks=L,a.Names))for(var M=0;M<a.Names.length;++M)L[0][M+1]=a.Names[M];var D=[],Ee=[],Te=!1;o0[16]={n:"BrtShortReal",f:U4};var ne;if(ys(t,function(ie,K,pe){if(!_)switch(pe){case 148:d=ie;break;case 0:E=ie,u.sheetRows&&u.sheetRows<=E.r&&(_=!0),z=Pr(w=E.r),u["!row"]=E.r,(ie.hidden||ie.hpt||ie.level!=null)&&(ie.hpt&&(ie.hpx=tu(ie.hpt)),Ee[ie.r]=ie);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(S={t:ie[2]},ie[2]){case"n":S.v=ie[1];break;case"s":N=Lf[ie[1]],S.v=N.t,S.r=N.r;break;case"b":S.v=!!ie[1];break;case"e":S.v=ie[1],u.cellText!==!1&&(S.w=Es[S.v]);break;case"str":S.t="s",S.v=ie[1];break;case"is":S.t="s",S.v=ie[1].t;break}if((y=l.CellXf[ie[0].iStyleRef])&&P4(S,y.numFmtId,null,u,o,l),P=ie[0].c==-1?P+1:ie[0].c,u.dense?(h[w]||(h[w]=[]),h[w][P]=S):h[_r(P)+z]=S,u.cellFormula){for(I=!1,C=0;C<b.length;++C){var V=b[C];E.r>=V[0].s.r&&E.r<=V[0].e.r&&P>=V[0].s.c&&P<=V[0].e.c&&(S.F=yt(V[0]),I=!0)}!I&&ie.length>3&&(S.f=ie[3])}if(p.s.r>E.r&&(p.s.r=E.r),p.s.c>P&&(p.s.c=P),p.e.r<E.r&&(p.e.r=E.r),p.e.c<P&&(p.e.c=P),u.cellDates&&y&&S.t=="n"&&Fl(tt[y.numFmtId])){var X=io(S.v);X&&(S.t="d",S.v=new Date(X.y,X.m-1,X.d,X.H,X.M,X.S,X.u))}ne&&(ne.type=="XLDAPR"&&(S.D=!0),ne=void 0);break;case 1:case 12:if(!u.sheetStubs||v)break;S={t:"z",v:void 0},P=ie[0].c==-1?P+1:ie[0].c,u.dense?(h[w]||(h[w]=[]),h[w][P]=S):h[_r(P)+z]=S,p.s.r>E.r&&(p.s.r=E.r),p.s.c>P&&(p.s.c=P),p.e.r<E.r&&(p.e.r=E.r),p.e.c<P&&(p.e.c=P),ne&&(ne.type=="XLDAPR"&&(S.D=!0),ne=void 0);break;case 176:Z.push(ie);break;case 49:ne=((u.xlmeta||{}).Cell||[])[ie-1];break;case 494:var ee=n["!id"][ie.relId];for(ee?(ie.Target=ee.Target,ie.loc&&(ie.Target+="#"+ie.loc),ie.Rel=ee):ie.relId==""&&(ie.Target="#"+ie.loc),w=ie.rfx.s.r;w<=ie.rfx.e.r;++w)for(P=ie.rfx.s.c;P<=ie.rfx.e.c;++P)u.dense?(h[w]||(h[w]=[]),h[w][P]||(h[w][P]={t:"z",v:void 0}),h[w][P].l=ie):(B=lt({c:P,r:w}),h[B]||(h[B]={t:"z",v:void 0}),h[B].l=ie);break;case 426:if(!u.cellFormula)break;b.push(ie),q=u.dense?h[w][P]:h[_r(P)+z],q.f=Rn(ie[1],p,{r:E.r,c:P},L,u),q.F=yt(ie[0]);break;case 427:if(!u.cellFormula)break;O[lt(ie[0].s)]=ie[1],q=u.dense?h[w][P]:h[_r(P)+z],q.f=Rn(ie[1],p,{r:E.r,c:P},L,u);break;case 60:if(!u.cellStyles)break;for(;ie.e>=ie.s;)D[ie.e--]={width:ie.w/256,hidden:!!(ie.flags&1),level:ie.level},Te||(Te=!0,Fv(ie.w/256)),To(D[ie.e+1]);break;case 161:h["!autofilter"]={ref:yt(ie)};break;case 476:h["!margins"]=ie;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),ie.name&&(a.Sheets[r].CodeName=ie.name),(ie.above||ie.left)&&(h["!outline"]={above:ie.above,left:ie.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),ie.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:v=!0;break;case 36:v=!1;break;case 37:v=!0;break;case 38:v=!1;break;default:if(!K.T){if(!v||u.WTF)throw new Error("Unexpected record 0x"+pe.toString(16))}}},u),delete u.supbooks,delete u["!row"],!h["!ref"]&&(p.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(h["!ref"]=yt(d||p)),u.sheetRows&&h["!ref"]){var ue=Ht(h["!ref"]);u.sheetRows<=+ue.e.r&&(ue.e.r=u.sheetRows-1,ue.e.r>p.e.r&&(ue.e.r=p.e.r),ue.e.r<ue.s.r&&(ue.s.r=ue.e.r),ue.e.c>p.e.c&&(ue.e.c=p.e.c),ue.e.c<ue.s.c&&(ue.s.c=ue.e.c),h["!fullref"]=h["!ref"],h["!ref"]=yt(ue))}return Z.length>0&&(h["!merges"]=Z),D.length>0&&(h["!cols"]=D),Ee.length>0&&(h["!rows"]=Ee),h}function Oj(t,e,r,n,a,o,l){if(e.v===void 0)return!1;var u="";switch(e.t){case"b":u=e.v?"1":"0";break;case"d":e=pr(e),e.z=e.z||tt[14],e.v=rn(mr(e.v)),e.t="n";break;case"n":case"e":u=""+e.v;break;default:u=e.v;break}var h={r,c:n};switch(h.s=Do(a.cellXfs,e,a),e.l&&o["!links"].push([lt(h),e.l]),e.c&&o["!comments"].push([lt(h),e.c]),e.t){case"s":case"str":return a.bookSST?(u=Bv(a.Strings,e.v,a.revStrings),h.t="s",h.v=u,l?Fe(t,18,ZV(e,h)):Fe(t,7,$V(e,h))):(h.t="str",l?Fe(t,17,uj(e,h)):Fe(t,6,lj(e,h))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?l?Fe(t,13,ij(e,h)):Fe(t,2,nj(e,h)):l?Fe(t,16,tj(e,h)):Fe(t,5,ej(e,h)),!0;case"b":return h.t="b",l?Fe(t,15,GV(e,h)):Fe(t,4,HV(e,h)),!0;case"e":return h.t="e",l?Fe(t,14,KV(e,h)):Fe(t,3,WV(e,h)),!0}return l?Fe(t,12,VV(e,h)):Fe(t,1,UV(e,h)),!0}function Fj(t,e,r,n){var a=Ht(e["!ref"]||"A1"),o,l="",u=[];Fe(t,145);var h=Array.isArray(e),d=a.e.r;e["!rows"]&&(d=Math.max(a.e.r,e["!rows"].length-1));for(var p=a.s.r;p<=d;++p){l=Pr(p),NV(t,e,a,p);var v=!1;if(p<=a.e.r)for(var _=a.s.c;_<=a.e.c;++_){p===a.s.r&&(u[_]=_r(_)),o=u[_]+l;var E=h?(e[p]||[])[_]:e[o];if(!E){v=!1;continue}v=Oj(t,E,p,_,n,e,v)}}Fe(t,146)}function Pj(t,e){!e||!e["!merges"]||(Fe(t,177,xj(e["!merges"].length)),e["!merges"].forEach(function(r){Fe(t,176,gj(r))}),Fe(t,178))}function Mj(t,e){!e||!e["!cols"]||(Fe(t,390),e["!cols"].forEach(function(r,n){r&&Fe(t,60,wj(n,r))}),Fe(t,391))}function Lj(t,e){!e||!e["!ref"]||(Fe(t,648),Fe(t,649,Cj(Ht(e["!ref"]))),Fe(t,650))}function Uj(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var a=Zt(r,-1,n[1].Target.replace(/#.*$/,""),Ct.HLINK);Fe(t,494,_j(n,a))}}),delete e["!links"]}function Bj(t,e,r,n){if(e["!comments"].length>0){var a=Zt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Ct.VML);Fe(t,551,bv("rId"+a)),e["!legacy"]=a}}function Vj(t,e,r,n){if(e["!autofilter"]){var a=e["!autofilter"],o=typeof a.ref=="string"?a.ref:yt(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,u=aa(o);u.s.r==u.e.r&&(u.e.r=aa(e["!ref"]).e.r,o=yt(u));for(var h=0;h<l.length;++h){var d=l[h];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==n){d.Ref="'"+r.SheetNames[n]+"'!"+o;break}}h==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+o}),Fe(t,161,fu(Ht(o))),Fe(t,162)}}function jj(t,e,r){Fe(t,133),Fe(t,137,kj(e,r)),Fe(t,138),Fe(t,134)}function Hj(t,e){e["!protect"]&&Fe(t,535,Rj(e["!protect"]))}function zj(t,e,r,n){var a=na(),o=r.SheetNames[t],l=r.Sheets[o]||{},u=o;try{r&&r.Workbook&&(u=r.Workbook.Sheets[t].CodeName||u)}catch{}var h=Ht(l["!ref"]||"A1");if(h.e.c>16383||h.e.r>1048575){if(e.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],Fe(a,129),(r.vbaraw||l["!outline"])&&Fe(a,147,MV(u,l["!outline"])),Fe(a,148,OV(h)),jj(a,l,r.Workbook),Mj(a,l),Fj(a,l,t,e),Hj(a,l),Vj(a,l,r,t),Pj(a,l),Uj(a,l,n),l["!margins"]&&Fe(a,476,Aj(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&Lj(a,l),Bj(a,l,t,n),Fe(a,130),a.end()}function Gj(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(o){var l=o.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(e[+l[1]]=r?+l[2]:l[2])});var a=jt((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(o){n=o.replace(/<.*?>/g,"")}),[e,a,n]}function qj(t,e,r,n,a,o){var l=o||{"!type":"chart"};if(!t)return o;var u=0,h=0,d="A",p={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(v){var _=Gj(v);p.s.r=p.s.c=0,p.e.c=u,d=_r(u),_[0].forEach(function(E,S){l[d+Pr(S)]={t:"n",v:E,z:_[1]},h=S}),p.e.r<h&&(p.e.r=h),++u}),u>0&&(l["!ref"]=yt(p)),l}function Wj(t,e,r,n,a){if(!t)return t;n||(n={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},l,u=t.match(M4);return u&&Vv(u[0],o,a,r),(l=t.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=l[1]),n["!id"][o["!rel"]]&&(o["!drawel"]=n["!id"][o["!rel"]]),o}function Xj(t,e){t.l+=10;var r=On(t);return{name:r}}function Kj(t,e,r,n,a){if(!t)return t;n||(n={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},l=!1;return ys(t,function(h,d,p){switch(p){case 550:o["!rel"]=h;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),h.name&&(a.Sheets[r].CodeName=h.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!l||e.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}}}},e),n["!id"][o["!rel"]]&&(o["!drawel"]=n["!id"][o["!rel"]]),o}var jv=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Yj=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],$j=[],Qj=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Kw(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],a=0;a!=e.length;++a){var o=e[a];if(n[o[0]]==null)n[o[0]]=o[1];else switch(o[2]){case"bool":typeof n[o[0]]=="string"&&(n[o[0]]=hr(n[o[0]]));break;case"int":typeof n[o[0]]=="string"&&(n[o[0]]=parseInt(n[o[0]],10));break}}}function Yw(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=hr(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function V4(t){Yw(t.WBProps,jv),Yw(t.CalcPr,Qj),Kw(t.WBView,Yj),Kw(t.Sheets,$j),Wc.date1904=hr(t.WBProps.date1904)}function Zj(t){return!t.Workbook||!t.Workbook.WBProps?"false":hr(t.Workbook.WBProps.date1904)?"true":"false"}var Jj="][*?/\\".split("");function j4(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Jj.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function eH(t,e,r){t.forEach(function(n,a){j4(n);for(var o=0;o<a;++o)if(n==t[o])throw new Error("Duplicate Sheet Name: "+n);if(r){var l=e&&e[a]&&e[a].CodeName||n;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function tH(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];eH(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)ZB(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var rH=/<\w+:workbook/;function nH(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",o={},l=0;if(t.replace(Mn,function(h,d){var p=dt(h);switch(Bi(p[0])){case"<?xml":break;case"<workbook":h.match(rH)&&(a="xmlns"+h.match(/<(\w+):/)[1]),r.xmlns=p[a];break;case"</workbook>":break;case"<fileVersion":delete p[0],r.AppVersion=p;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":jv.forEach(function(v){if(p[v[0]]!=null)switch(v[2]){case"bool":r.WBProps[v[0]]=hr(p[v[0]]);break;case"int":r.WBProps[v[0]]=parseInt(p[v[0]],10);break;default:r.WBProps[v[0]]=p[v[0]]}}),p.codeName&&(r.WBProps.CodeName=ar(p.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete p[0],r.WBView.push(p);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(p.state){case"hidden":p.Hidden=1;break;case"veryHidden":p.Hidden=2;break;default:p.Hidden=0}delete p.state,p.name=jt(ar(p.name)),delete p[0],r.Sheets.push(p);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":o={},o.Name=ar(p.name),p.comment&&(o.Comment=p.comment),p.localSheetId&&(o.Sheet=+p.localSheetId),hr(p.hidden||"0")&&(o.Hidden=!0),l=d+h.length;break;case"</definedName>":o.Ref=jt(ar(t.slice(l,d))),r.Names.push(o);break;case"<definedName/>":break;case"<calcPr":delete p[0],r.CalcPr=p;break;case"<calcPr/>":delete p[0],r.CalcPr=p;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+p[0]+" in workbook")}return h}),Pl.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return V4(r),r}function H4(t){var e=[Mr];e[e.length]=He("workbook",null,{xmlns:Pl[0],"xmlns:r":Jr.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(jv.forEach(function(u){t.Workbook.WBProps[u[0]]!=null&&t.Workbook.WBProps[u[0]]!=u[1]&&(n[u[0]]=t.Workbook.WBProps[u[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=He("workbookPr",null,n);var a=t.Workbook&&t.Workbook.Sheets||[],o=0;if(a&&a[0]&&a[0].Hidden){for(e[e.length]="<bookViews>",o=0;o!=t.SheetNames.length&&!(!a[o]||!a[o].Hidden);++o);o==t.SheetNames.length&&(o=0),e[e.length]='<workbookView firstSheet="'+o+'" activeTab="'+o+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",o=0;o!=t.SheetNames.length;++o){var l={name:Jt(t.SheetNames[o].slice(0,31))};if(l.sheetId=""+(o+1),l["r:id"]="rId"+(o+1),a[o])switch(a[o].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}e[e.length]=He("sheet",null,l)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(u){var h={name:u.Name};u.Comment&&(h.comment=u.Comment),u.Sheet!=null&&(h.localSheetId=""+u.Sheet),u.Hidden&&(h.hidden="1"),u.Ref&&(e[e.length]=He("definedName",Jt(u.Ref),h))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function aH(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=X1(t),r.name=On(t),r}function iH(t,e){return e||(e=Ae(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),bv(t.strRelID,e),hn(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function sH(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var a=e>8?On(t):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function oH(t,e){e||(e=Ae(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),Ok(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function lH(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function cH(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var a=t.read_shift(4),o=BP(t),l=WB(t,0,r),u=Av(t);t.l=n;var h={Name:o,Ptg:l};return a<268435455&&(h.Sheet=a),u&&(h.Comment=u),h}function uH(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;e||(e={}),e.biff=12;var o=[],l=[[]];return l.SheetNames=[],l.XTI=[],o0[16]={n:"BrtFRTArchID$",f:lH},ys(t,function(h,d,p){switch(p){case 156:l.SheetNames.push(h.name),r.Sheets.push(h);break;case 153:r.WBProps=h;break;case 39:h.Sheet!=null&&(e.SID=h.Sheet),h.Ref=Rn(h.Ptg,null,null,l,e),delete e.SID,delete h.Ptg,o.push(h);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([p,h]):l[0]=[p,h],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(h),l.XTI=l.XTI.concat(h);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(p),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(p),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!d.T){if(!a||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}},e),V4(r),r.Names=o,r.supbooks=l,r}function fH(t,e){Fe(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};Fe(t,156,iH(a))}Fe(t,144)}function hH(t,e){e||(e=Ae(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return hn("SheetJS",e),hn(Wd.version,e),hn(Wd.version,e),hn("7262",e),e.length>e.l?e.slice(0,e.l):e}function dH(t,e){e||(e=Ae(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function mH(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,a=-1,o=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&o==-1&&(o=n);o>a||(Fe(t,135),Fe(t,158,dH(a)),Fe(t,136))}}function pH(t,e){var r=na();return Fe(r,131),Fe(r,128,hH()),Fe(r,153,oH(t.Workbook&&t.Workbook.WBProps||null)),mH(r,t),fH(r,t),Fe(r,132),r.end()}function gH(t,e,r){return e.slice(-4)===".bin"?uH(t,r):nH(t,r)}function xH(t,e,r,n,a,o,l,u){return e.slice(-4)===".bin"?Dj(t,n,r,a,o,l,u):cV(t,n,r,a,o,l,u)}function vH(t,e,r,n,a,o,l,u){return e.slice(-4)===".bin"?Kj(t,n,r,a,o):Wj(t,n,r,a,o)}function _H(t,e,r,n,a,o,l,u){return e.slice(-4)===".bin"?EU():TU()}function yH(t,e,r,n,a,o,l,u){return e.slice(-4)===".bin"?_U():yU()}function EH(t,e,r,n){return e.slice(-4)===".bin"?g7(t,r,n):a7(t,r,n)}function TH(t,e,r){return T4(t,r)}function wH(t,e,r){return e.slice(-4)===".bin"?w9(t,r):y9(t,r)}function SH(t,e,r){return e.slice(-4)===".bin"?mU(t,r):iU(t,r)}function AH(t,e,r){return e.slice(-4)===".bin"?rU(t):eU(t)}function bH(t,e,r,n){return r.slice(-4)===".bin"?nU(t,e,r,n):void 0}function kH(t,e,r){return e.slice(-4)===".bin"?Q7(t,e,r):J7(t,e,r)}function CH(t,e,r){return(e.slice(-4)===".bin"?pH:H4)(t)}function RH(t,e,r,n,a){return(e.slice(-4)===".bin"?zj:L4)(t,r,n,a)}function IH(t,e,r){return(e.slice(-4)===".bin"?b7:y4)(t,r)}function NH(t,e,r){return(e.slice(-4)===".bin"?b9:h4)(t,r)}function DH(t,e,r){return(e.slice(-4)===".bin"?pU:A4)(t)}function OH(t){return(t.slice(-4)===".bin"?Z7:w4)()}var z4=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,G4=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function $a(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=t.match(z4),o,l,u,h;if(a)for(h=0;h!=a.length;++h)o=a[h].match(G4),(l=o[1].indexOf(":"))===-1?n[o[1]]=o[2].slice(1,o[2].length-1):(o[1].slice(0,6)==="xmlns:"?u="xmlns"+o[1].slice(6):u=o[1].slice(l+1),n[u]=o[2].slice(1,o[2].length-1));return n}function FH(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(z4),a,o,l,u;if(n)for(u=0;u!=n.length;++u)a=n[u].match(G4),(o=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(o+1),r[l]=a[2].slice(1,a[2].length-1));return r}var Bf;function PH(t,e){var r=Bf[t]||jt(t);return r==="General"?Sl(e):Ta(r,e)}function MH(t,e,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=hr(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=mr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[jt(e)]=a}function LH(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||Es[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Zf(t.v):t.w=Sl(t.v):t.w=PH(e||"General",t.v)}catch(o){if(r.WTF)throw o}try{var n=Bf[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&Fl(n)){var a=io(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(o){if(r.WTF)throw o}}}function UH(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=$9[n.Pattern]||n.Pattern)}t[e.ID]=e}function BH(t,e,r,n,a,o,l,u,h,d){var p="General",v=n.StyleID,_={};d=d||{};var E=[],S=0;for(v===void 0&&u&&(v=u.StyleID),v===void 0&&l&&(v=l.StyleID);o[v]!==void 0&&(o[v].nf&&(p=o[v].nf),o[v].Interior&&E.push(o[v].Interior),!!o[v].Parent);)v=o[v].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=hr(t);break;case"String":n.t="s",n.r=hw(jt(t)),n.v=t.indexOf("<")>-1?jt(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(mr(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=jt(t):n.v<60&&(n.v=n.v-1),(!p||p=="General")&&(p="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=Uk[t],d.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=hw(e||t));break}if(LH(n,p,d),d.cellFormula!==!1)if(n.Formula){var y=jt(n.Formula);y.charCodeAt(0)==61&&(y=y.slice(1)),n.f=qc(y,a),delete n.Formula,n.ArrayRange=="RC"?n.F=qc("RC:RC",a):n.ArrayRange&&(n.F=qc(n.ArrayRange,a),h.push([Ht(n.F),n.F]))}else for(S=0;S<h.length;++S)a.r>=h[S][0].s.r&&a.r<=h[S][0].e.r&&a.c>=h[S][0].s.c&&a.c<=h[S][0].e.c&&(n.F=h[S][1]);d.cellStyles&&(E.forEach(function(w){!_.patternType&&w.patternType&&(_.patternType=w.patternType)}),n.s=_),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function VH(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function s1(t,e){var r=e||{};cu();var n=Tf(_v(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=ar(n));var a=n.slice(0,1024).toLowerCase(),o=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var l=pr(r);return l.type="string",eu.to_workbook(n,l)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ir){a.indexOf("<"+ir)>=0&&(o=!0)}),o)return Az(n,r);Bf={"General Number":"General","General Date":tt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":tt[15],"Short Date":tt[14],"Long Time":tt[19],"Medium Time":tt[18],"Short Time":tt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:tt[2],Standard:tt[4],Percent:tt[10],Scientific:tt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,h=[],d,p={},v=[],_=r.dense?[]:{},E="",S={},y={},w=$a('<Data ss:Type="String">'),P=0,B=0,N=0,z={s:{r:2e6,c:2e6},e:{r:0,c:0}},q={},Z={},C="",I=0,b=[],O={},L={},M=0,D=[],Ee=[],Te={},ne=[],ue,Ue=!1,ie=[],K=[],pe={},V=0,X=0,ee={Sheets:[],WBProps:{date1904:!1}},te={};t0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var le="";u=t0.exec(n);)switch(u[3]=(le=u[3]).toLowerCase()){case"data":if(le=="data"){if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break}if(h[h.length-1][1])break;u[1]==="/"?BH(n.slice(P,u.index),C,w,h[h.length-1][0]=="comment"?Te:S,{c:B,r:N},q,ne[B],y,ie,r):(C="",w=$a(u[0]),P=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(Ee.length>0&&(S.c=Ee),(!r.sheetRows||r.sheetRows>N)&&S.v!==void 0&&(r.dense?(_[N]||(_[N]=[]),_[N][B]=S):_[_r(B)+Pr(N)]=S),S.HRef&&(S.l={Target:jt(S.HRef)},S.HRefScreenTip&&(S.l.Tooltip=S.HRefScreenTip),delete S.HRef,delete S.HRefScreenTip),(S.MergeAcross||S.MergeDown)&&(V=B+(parseInt(S.MergeAcross,10)|0),X=N+(parseInt(S.MergeDown,10)|0),b.push({s:{c:B,r:N},e:{c:V,r:X}})),!r.sheetStubs)S.MergeAcross?B=V+1:++B;else if(S.MergeAcross||S.MergeDown){for(var Ne=B;Ne<=V;++Ne)for(var ke=N;ke<=X;++ke)(Ne>B||ke>N)&&(r.dense?(_[ke]||(_[ke]=[]),_[ke][Ne]={t:"z"}):_[_r(Ne)+Pr(ke)]={t:"z"});B=V+1}else++B;else S=FH(u[0]),S.Index&&(B=+S.Index-1),B<z.s.c&&(z.s.c=B),B>z.e.c&&(z.e.c=B),u[0].slice(-2)==="/>"&&++B,Ee=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(N<z.s.r&&(z.s.r=N),N>z.e.r&&(z.e.r=N),u[0].slice(-2)==="/>"&&(y=$a(u[0]),y.Index&&(N=+y.Index-1)),B=0,++N):(y=$a(u[0]),y.Index&&(N=+y.Index-1),pe={},(y.AutoFitHeight=="0"||y.Height)&&(pe.hpx=parseInt(y.Height,10),pe.hpt=s0(pe.hpx),K[N]=pe),y.Hidden=="1"&&(pe.hidden=!0,K[N]=pe));break;case"worksheet":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));v.push(E),z.s.r<=z.e.r&&z.s.c<=z.e.c&&(_["!ref"]=yt(z),r.sheetRows&&r.sheetRows<=z.e.r&&(_["!fullref"]=_["!ref"],z.e.r=r.sheetRows-1,_["!ref"]=yt(z))),b.length&&(_["!merges"]=b),ne.length>0&&(_["!cols"]=ne),K.length>0&&(_["!rows"]=K),p[E]=_}else z={s:{r:2e6,c:2e6},e:{r:0,c:0}},N=B=0,h.push([u[3],!1]),d=$a(u[0]),E=jt(d.Name),_=r.dense?[]:{},b=[],ie=[],K=[],te={name:E,Hidden:0},ee.Sheets.push(te);break;case"table":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else{if(u[0].slice(-2)=="/>")break;h.push([u[3],!1]),ne=[],Ue=!1}break;case"style":u[1]==="/"?UH(q,Z,r):Z=$a(u[0]);break;case"numberformat":Z.nf=jt($a(u[0]).Format||"General"),Bf[Z.nf]&&(Z.nf=Bf[Z.nf]);for(var Oe=0;Oe!=392&&tt[Oe]!=Z.nf;++Oe);if(Oe==392){for(Oe=57;Oe!=392;++Oe)if(tt[Oe]==null){Mi(Z.nf,Oe);break}}break;case"column":if(h[h.length-1][0]!=="table")break;if(ue=$a(u[0]),ue.Hidden&&(ue.hidden=!0,delete ue.Hidden),ue.Width&&(ue.wpx=parseInt(ue.Width,10)),!Ue&&ue.wpx>10){Ue=!0,Nn=v4;for(var _e=0;_e<ne.length;++_e)ne[_e]&&To(ne[_e])}Ue&&To(ue),ne[ue.Index-1||ne.length]=ue;for(var Be=0;Be<+ue.Span;++Be)ne[ne.length]=pr(ue);break;case"namedrange":if(u[1]==="/")break;ee.Names||(ee.Names=[]);var W=dt(u[0]),nt={Name:W.Name,Ref:qc(W.RefersTo.slice(1),{r:0,c:0})};ee.Sheets.length>0&&(nt.Sheet=ee.Sheets.length-1),ee.Names.push(nt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?C+=n.slice(I,u.index):I=u.index+u[0].length;break;case"interior":if(!r.cellStyles)break;Z.Interior=$a(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?uM(O,le,n.slice(M,u.index)):M=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else h.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));VH(Te),Ee.push(Te)}else h.push([u[3],!1]),d=$a(u[0]),Te={a:d.Author};break;case"autofilter":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var it=$a(u[0]);_["!autofilter"]={ref:qc(it.Range).replace(/\$/g,"")},h.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"null":break;default:if(h.length==0&&u[3]=="document"||h.length==0&&u[3]=="uof")return eS(n,r);var wt=!0;switch(h[h.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:wt=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:wt=!1}break;case"excelworkbook":switch(u[3]){case"date1904":ee.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:wt=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:wt=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(n.slice(M,u.index)){case"SheetHidden":te.Hidden=1;break;case"SheetVeryHidden":te.Hidden=2;break}else M=u.index+u[0].length;break;case"header":_["!margins"]||pl(_["!margins"]={},"xlml"),isNaN(+dt(u[0]).Margin)||(_["!margins"].header=+dt(u[0]).Margin);break;case"footer":_["!margins"]||pl(_["!margins"]={},"xlml"),isNaN(+dt(u[0]).Margin)||(_["!margins"].footer=+dt(u[0]).Margin);break;case"pagemargins":var st=dt(u[0]);_["!margins"]||pl(_["!margins"]={},"xlml"),isNaN(+st.Top)||(_["!margins"].top=+st.Top),isNaN(+st.Left)||(_["!margins"].left=+st.Left),isNaN(+st.Right)||(_["!margins"].right=+st.Right),isNaN(+st.Bottom)||(_["!margins"].bottom=+st.Bottom);break;case"displayrighttoleft":ee.Views||(ee.Views=[]),ee.Views[0]||(ee.Views[0]={}),ee.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:wt=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:wt=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:wt=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:wt=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:wt=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:wt=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:wt=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:wt=!1}break;case"smarttags":break;default:wt=!1;break}if(wt||u[3].match(/!\[CDATA/))break;if(!h[h.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+h.join("|");if(h[h.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?MH(L,le,D,n.slice(M,u.index)):(D=u,M=u.index+u[0].length);break}if(r.WTF)throw"Unrecognized tag: "+u[3]+"|"+h.join("|")}var Le={};return!r.bookSheets&&!r.bookProps&&(Le.Sheets=p),Le.SheetNames=v,Le.Workbook=ee,Le.SSF=pr(tt),Le.Props=O,Le.Custprops=L,Le}function ex(t,e){switch(zv(e=e||{}),e.type||"base64"){case"base64":return s1(Ea(t),e);case"binary":case"buffer":case"file":return s1(t,e);case"array":return s1(Io(t),e)}}function jH(t,e){var r=[];return t.Props&&r.push(fM(t.Props,e)),t.Custprops&&r.push(hM(t.Props,t.Custprops)),r.join("")}function HH(){return""}function zH(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,a){var o=[];o.push(He("NumberFormat",null,{"ss:Format":Jt(tt[n.numFmtId])}));var l={"ss:ID":"s"+(21+a)};r.push(He("Style",o.join(""),l))}),He("Styles",r.join(""))}function q4(t){return He("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+Lv(t.Ref,{r:0,c:0})})}function GH(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var a=e[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(q4(a)))}return He("Names",r.join(""))}function qH(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,o=[],l=0;l<a.length;++l){var u=a[l];u.Sheet==r&&(u.Name.match(/^_xlfn\./)||o.push(q4(u)))}return o.join("")}function WH(t,e,r,n){if(!t)return"";var a=[];if(t["!margins"]&&(a.push("<PageSetup>"),t["!margins"].header&&a.push(He("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&a.push(He("Footer",null,{"x:Margin":t["!margins"].footer})),a.push(He("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(He("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var o=0;o<r&&!(n.Workbook.Sheets[o]&&!n.Workbook.Sheets[o].Hidden);++o);o==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),t["!protect"]&&(a.push(En("ProtectContents","True")),t["!protect"].objects&&a.push(En("ProtectObjects","True")),t["!protect"].scenarios&&a.push(En("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?a.push(En("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&a.push(En("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){t["!protect"][l[0]]&&a.push("<"+l[1]+"/>")})),a.length==0?"":He("WorksheetOptions",a.join(""),{xmlns:ma.x})}function XH(t){return t.map(function(e){var r=mP(e.t||""),n=He("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return He("Comment",n,{"ss:Author":e.a})}).join("")}function KH(t,e,r,n,a,o,l){if(!t||t.v==null&&t.f==null)return"";var u={};if(t.f&&(u["ss:Formula"]="="+Jt(Lv(t.f,l))),t.F&&t.F.slice(0,e.length)==e){var h=yr(t.F.slice(e.length+1));u["ss:ArrayRange"]="RC:R"+(h.r==l.r?"":"["+(h.r-l.r)+"]")+"C"+(h.c==l.c?"":"["+(h.c-l.c)+"]")}if(t.l&&t.l.Target&&(u["ss:HRef"]=Jt(t.l.Target),t.l.Tooltip&&(u["x:HRefScreenTip"]=Jt(t.l.Tooltip))),r["!merges"])for(var d=r["!merges"],p=0;p!=d.length;++p)d[p].s.c!=l.c||d[p].s.r!=l.r||(d[p].e.c>d[p].s.c&&(u["ss:MergeAcross"]=d[p].e.c-d[p].s.c),d[p].e.r>d[p].s.r&&(u["ss:MergeDown"]=d[p].e.r-d[p].s.r));var v="",_="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":v="Number",_=String(t.v);break;case"b":v="Boolean",_=t.v?"1":"0";break;case"e":v="Error",_=Es[t.v];break;case"d":v="DateTime",_=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||tt[14]);break;case"s":v="String",_=dP(t.v||"");break}var E=Do(n.cellXfs,t,n);u["ss:StyleID"]="s"+(21+E),u["ss:Index"]=l.c+1;var S=t.v!=null?_:"",y=t.t=="z"?"":'<Data ss:Type="'+v+'">'+S+"</Data>";return(t.c||[]).length>0&&(y+=XH(t.c)),He("Cell",y,u)}function YH(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=tu(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function $H(t,e,r,n){if(!t["!ref"])return"";var a=Ht(t["!ref"]),o=t["!merges"]||[],l=0,u=[];t["!cols"]&&t["!cols"].forEach(function(w,P){To(w);var B=!!w.width,N=Pm(P,w),z={"ss:Index":P+1};B&&(z["ss:Width"]=a0(N.width)),w.hidden&&(z["ss:Hidden"]="1"),u.push(He("Column",null,z))});for(var h=Array.isArray(t),d=a.s.r;d<=a.e.r;++d){for(var p=[YH(d,(t["!rows"]||[])[d])],v=a.s.c;v<=a.e.c;++v){var _=!1;for(l=0;l!=o.length;++l)if(!(o[l].s.c>v)&&!(o[l].s.r>d)&&!(o[l].e.c<v)&&!(o[l].e.r<d)){(o[l].s.c!=v||o[l].s.r!=d)&&(_=!0);break}if(!_){var E={r:d,c:v},S=lt(E),y=h?(t[d]||[])[v]:t[S];p.push(KH(y,S,t,e,r,n,E))}}p.push("</Row>"),p.length>2&&u.push(p.join(""))}return u.join("")}function QH(t,e,r){var n=[],a=r.SheetNames[t],o=r.Sheets[a],l=o?qH(o,e,t,r):"";return l.length>0&&n.push("<Names>"+l+"</Names>"),l=o?$H(o,e,t,r):"",l.length>0&&n.push("<Table>"+l+"</Table>"),n.push(WH(o,e,t,r)),n.join("")}function ZH(t,e){e||(e={}),t.SSF||(t.SSF=pr(tt)),t.SSF&&(cu(),A0(t.SSF),e.revssf=Im(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],Do(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(jH(t,e)),r.push(HH()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(He("Worksheet",QH(n,e,t),{"ss:Name":Jt(t.SheetNames[n])}));return r[2]=zH(t,e),r[3]=GH(t),Mr+He("Workbook",r.join(""),{xmlns:ma.ss,"xmlns:o":ma.o,"xmlns:x":ma.x,"xmlns:ss":ma.ss,"xmlns:dt":ma.dt,"xmlns:html":ma.html})}function JH(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=GP(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=qP(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var ez=[60,1084,2066,2165,2175];function tz(t,e,r,n,a){var o=n,l=[],u=r.slice(r.l,r.l+o);if(a&&a.enc&&a.enc.insitu&&u.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(u)}l.push(u),r.l+=o;for(var h=us(r,r.l),d=tx[h],p=0;d!=null&&ez.indexOf(h)>-1;)o=us(r,r.l+2),p=r.l+4,h==2066?p+=4:(h==2165||h==2175)&&(p+=12),u=r.slice(p,r.l+4+o),l.push(u),r.l+=4+o,d=tx[h=us(r,r.l)];var v=fn(l);_n(v,0);var _=0;v.lens=[];for(var E=0;E<l.length;++E)v.lens.push(_),_+=l[E].length;if(v.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+v.length+" < "+n;return e.f(v,v.length,a)}function Ti(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=tt[n])}catch(o){if(e.WTF)throw o}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Es[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Zf(t.v):t.w=Sl(t.v):t.w=Ta(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(o){if(e.WTF)throw o}if(e.cellDates&&n&&t.t=="n"&&Fl(tt[n]||String(n))){var a=io(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function dd(t,e,r){return{v:t,ixfe:e,t:r}}function rz(t,e){var r={opts:{}},n={},a=e.dense?[]:{},o={},l={},u=null,h=[],d="",p={},v,_="",E,S,y,w,P={},B=[],N,z,q=[],Z=[],C={Sheets:[],WBProps:{date1904:!1},Views:[{}]},I={},b=function(_t){return _t<8?hl[_t]:_t<64&&Z[_t-8]||hl[_t]},O=function(_t,fr,Ur){var sr=fr.XF.data;if(!(!sr||!sr.patternType||!Ur||!Ur.cellStyles)){fr.s={},fr.s.patternType=sr.patternType;var Ln;(Ln=n0(b(sr.icvFore)))&&(fr.s.fgColor={rgb:Ln}),(Ln=n0(b(sr.icvBack)))&&(fr.s.bgColor={rgb:Ln})}},L=function(_t,fr,Ur){if(!(pe>1)&&!(Ur.sheetRows&&_t.r>=Ur.sheetRows)){if(Ur.cellStyles&&fr.XF&&fr.XF.data&&O(_t,fr,Ur),delete fr.ixfe,delete fr.XF,v=_t,_=lt(_t),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),_t.r<l.s.r&&(l.s.r=_t.r),_t.c<l.s.c&&(l.s.c=_t.c),_t.r+1>l.e.r&&(l.e.r=_t.r+1),_t.c+1>l.e.c&&(l.e.c=_t.c+1),Ur.cellFormula&&fr.f){for(var sr=0;sr<B.length;++sr)if(!(B[sr][0].s.c>_t.c||B[sr][0].s.r>_t.r)&&!(B[sr][0].e.c<_t.c||B[sr][0].e.r<_t.r)){fr.F=yt(B[sr][0]),(B[sr][0].s.c!=_t.c||B[sr][0].s.r!=_t.r)&&delete fr.f,fr.f&&(fr.f=""+Rn(B[sr][1],l,_t,ie,M));break}}Ur.dense?(a[_t.r]||(a[_t.r]=[]),a[_t.r][_t.c]=fr):a[_]=fr}},M={enc:!1,sbcch:0,snames:[],sharedf:P,arrayf:B,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(M.password=e.password);var D,Ee=[],Te=[],ne=[],ue=[],Ue=!1,ie=[];ie.SheetNames=M.snames,ie.sharedf=M.sharedf,ie.arrayf=M.arrayf,ie.names=[],ie.XTI=[];var K=0,pe=0,V=0,X=[],ee=[],te;M.codepage=1200,Za(1200);for(var le=!1;t.l<t.length-1;){var Ne=t.l,ke=t.read_shift(2);if(ke===0&&K===10)break;var Oe=t.l===t.length?0:t.read_shift(2),_e=tx[ke];if(_e&&_e.f){if(e.bookSheets&&K===133&&ke!==133)break;if(K=ke,_e.r===2||_e.r==12){var Be=t.read_shift(2);if(Oe-=2,!M.enc&&Be!==ke&&((Be&255)<<8|Be>>8)!==ke)throw new Error("rt mismatch: "+Be+"!="+ke);_e.r==12&&(t.l+=10,Oe-=10)}var W={};if(ke===10?W=_e.f(t,Oe,M):W=tz(ke,_e,t,Oe,M),pe==0&&[9,521,1033,2057].indexOf(K)===-1)continue;switch(ke){case 34:r.opts.Date1904=C.WBProps.date1904=W;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(M.enc||(t.l=0),M.enc=W,!e.password)throw new Error("File is password-protected");if(W.valid==null)throw new Error("Encryption scheme unsupported");if(!W.valid)throw new Error("Password is incorrect");break;case 92:M.lastuser=W;break;case 66:var nt=Number(W);switch(nt){case 21010:nt=1200;break;case 32768:nt=1e4;break;case 32769:nt=1252;break}Za(M.codepage=nt),le=!0;break;case 317:M.rrtabid=W;break;case 25:M.winlocked=W;break;case 439:r.opts.RefreshAll=W;break;case 12:r.opts.CalcCount=W;break;case 16:r.opts.CalcDelta=W;break;case 17:r.opts.CalcIter=W;break;case 13:r.opts.CalcMode=W;break;case 14:r.opts.CalcPrecision=W;break;case 95:r.opts.CalcSaveRecalc=W;break;case 15:M.CalcRefMode=W;break;case 2211:r.opts.FullCalc=W;break;case 129:W.fDialog&&(a["!type"]="dialog"),W.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),W.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:q.push(W);break;case 430:ie.push([W]),ie[ie.length-1].XTI=[];break;case 35:case 547:ie[ie.length-1].push(W);break;case 24:case 536:te={Name:W.Name,Ref:Rn(W.rgce,l,null,ie,M)},W.itab>0&&(te.Sheet=W.itab-1),ie.names.push(te),ie[0]||(ie[0]=[],ie[0].XTI=[]),ie[ie.length-1].push(W),W.Name=="_xlnm._FilterDatabase"&&W.itab>0&&W.rgce&&W.rgce[0]&&W.rgce[0][0]&&W.rgce[0][0][0]=="PtgArea3d"&&(ee[W.itab-1]={ref:yt(W.rgce[0][0][1][2])});break;case 22:M.ExternCount=W;break;case 23:ie.length==0&&(ie[0]=[],ie[0].XTI=[]),ie[ie.length-1].XTI=ie[ie.length-1].XTI.concat(W),ie.XTI=ie.XTI.concat(W);break;case 2196:if(M.biff<8)break;te!=null&&(te.Comment=W[1]);break;case 18:a["!protect"]=W;break;case 19:W!==0&&M.WTF&&console.error("Password verifier: "+W);break;case 133:o[W.pos]=W,M.snames.push(W.name);break;case 10:{if(--pe)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,a["!ref"]=yt(l),e.sheetRows&&e.sheetRows<=l.e.r){var it=l.e.r;l.e.r=e.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=yt(l),l.e.r=it}l.e.r++,l.e.c++}Ee.length>0&&(a["!merges"]=Ee),Te.length>0&&(a["!objects"]=Te),ne.length>0&&(a["!cols"]=ne),ue.length>0&&(a["!rows"]=ue),C.Sheets.push(I)}d===""?p=a:n[d]=a,a=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(M.biff===8&&(M.biff={9:2,521:3,1033:4}[ke]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[W.BIFFVer]||8),M.biffguess=W.BIFFVer==0,W.BIFFVer==0&&W.dt==4096&&(M.biff=5,le=!0,Za(M.codepage=28591)),M.biff==8&&W.BIFFVer==0&&W.dt==16&&(M.biff=2),pe++)break;if(a=e.dense?[]:{},M.biff<8&&!le&&(le=!0,Za(M.codepage=e.codepage||1252)),M.biff<5||W.BIFFVer==0&&W.dt==4096){d===""&&(d="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var wt={pos:t.l-Oe,name:d};o[wt.pos]=wt,M.snames.push(d)}else d=(o[Ne]||{name:""}).name;W.dt==32&&(a["!type"]="chart"),W.dt==64&&(a["!type"]="macro"),Ee=[],Te=[],M.arrayf=B=[],ne=[],ue=[],Ue=!1,I={Hidden:(o[Ne]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(e.dense?(a[W.r]||[])[W.c]:a[lt({c:W.c,r:W.r})])&&++W.c,N={ixfe:W.ixfe,XF:q[W.ixfe]||{},v:W.val,t:"n"},V>0&&(N.z=X[N.ixfe>>8&63]),Ti(N,e,r.opts.Date1904),L({c:W.c,r:W.r},N,e);break;case 5:case 517:N={ixfe:W.ixfe,XF:q[W.ixfe],v:W.val,t:W.t},V>0&&(N.z=X[N.ixfe>>8&63]),Ti(N,e,r.opts.Date1904),L({c:W.c,r:W.r},N,e);break;case 638:N={ixfe:W.ixfe,XF:q[W.ixfe],v:W.rknum,t:"n"},V>0&&(N.z=X[N.ixfe>>8&63]),Ti(N,e,r.opts.Date1904),L({c:W.c,r:W.r},N,e);break;case 189:for(var st=W.c;st<=W.C;++st){var Le=W.rkrec[st-W.c][0];N={ixfe:Le,XF:q[Le],v:W.rkrec[st-W.c][1],t:"n"},V>0&&(N.z=X[N.ixfe>>8&63]),Ti(N,e,r.opts.Date1904),L({c:st,r:W.r},N,e)}break;case 6:case 518:case 1030:{if(W.val=="String"){u=W;break}if(N=dd(W.val,W.cell.ixfe,W.tt),N.XF=q[N.ixfe],e.cellFormula){var ir=W.formula;if(ir&&ir[0]&&ir[0][0]&&ir[0][0][0]=="PtgExp"){var Lr=ir[0][0][1][0],Kr=ir[0][0][1][1],me=lt({r:Lr,c:Kr});P[me]?N.f=""+Rn(W.formula,l,W.cell,ie,M):N.F=((e.dense?(a[Lr]||[])[Kr]:a[me])||{}).F}else N.f=""+Rn(W.formula,l,W.cell,ie,M)}V>0&&(N.z=X[N.ixfe>>8&63]),Ti(N,e,r.opts.Date1904),L(W.cell,N,e),u=W}break;case 7:case 519:if(u)u.val=W,N=dd(W,u.cell.ixfe,"s"),N.XF=q[N.ixfe],e.cellFormula&&(N.f=""+Rn(u.formula,l,u.cell,ie,M)),V>0&&(N.z=X[N.ixfe>>8&63]),Ti(N,e,r.opts.Date1904),L(u.cell,N,e),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{B.push(W);var We=lt(W[0].s);if(E=e.dense?(a[W[0].s.r]||[])[W[0].s.c]:a[We],e.cellFormula&&E){if(!u||!We||!E)break;E.f=""+Rn(W[1],l,W[0],ie,M),E.F=yt(W[0])}}break;case 1212:{if(!e.cellFormula)break;if(_){if(!u)break;P[lt(u.cell)]=W[0],E=e.dense?(a[u.cell.r]||[])[u.cell.c]:a[lt(u.cell)],(E||{}).f=""+Rn(W[0],l,v,ie,M)}}break;case 253:N=dd(h[W.isst].t,W.ixfe,"s"),h[W.isst].h&&(N.h=h[W.isst].h),N.XF=q[N.ixfe],V>0&&(N.z=X[N.ixfe>>8&63]),Ti(N,e,r.opts.Date1904),L({c:W.c,r:W.r},N,e);break;case 513:e.sheetStubs&&(N={ixfe:W.ixfe,XF:q[W.ixfe],t:"z"},V>0&&(N.z=X[N.ixfe>>8&63]),Ti(N,e,r.opts.Date1904),L({c:W.c,r:W.r},N,e));break;case 190:if(e.sheetStubs)for(var je=W.c;je<=W.C;++je){var ot=W.ixfe[je-W.c];N={ixfe:ot,XF:q[ot],t:"z"},V>0&&(N.z=X[N.ixfe>>8&63]),Ti(N,e,r.opts.Date1904),L({c:je,r:W.r},N,e)}break;case 214:case 516:case 4:N=dd(W.val,W.ixfe,"s"),N.XF=q[N.ixfe],V>0&&(N.z=X[N.ixfe>>8&63]),Ti(N,e,r.opts.Date1904),L({c:W.c,r:W.r},N,e);break;case 0:case 512:pe===1&&(l=W);break;case 252:h=W;break;case 1054:if(M.biff==4){X[V++]=W[1];for(var Nt=0;Nt<V+163&&tt[Nt]!=W[1];++Nt);Nt>=163&&Mi(W[1],V+163)}else Mi(W[1],W[0]);break;case 30:{X[V++]=W;for(var mt=0;mt<V+163&&tt[mt]!=W;++mt);mt>=163&&Mi(W,V+163)}break;case 229:Ee=Ee.concat(W);break;case 93:Te[W.cmo[0]]=M.lastobj=W;break;case 438:M.lastobj.TxO=W;break;case 127:M.lastobj.ImData=W;break;case 440:for(w=W[0].s.r;w<=W[0].e.r;++w)for(y=W[0].s.c;y<=W[0].e.c;++y)E=e.dense?(a[w]||[])[y]:a[lt({c:y,r:w})],E&&(E.l=W[1]);break;case 2048:for(w=W[0].s.r;w<=W[0].e.r;++w)for(y=W[0].s.c;y<=W[0].e.c;++y)E=e.dense?(a[w]||[])[y]:a[lt({c:y,r:w})],E&&E.l&&(E.l.Tooltip=W[1]);break;case 28:{if(M.biff<=5&&M.biff>=2)break;E=e.dense?(a[W[0].r]||[])[W[0].c]:a[lt(W[0])];var vt=Te[W[2]];E||(e.dense?(a[W[0].r]||(a[W[0].r]=[]),E=a[W[0].r][W[0].c]={t:"z"}):E=a[lt(W[0])]={t:"z"},l.e.r=Math.max(l.e.r,W[0].r),l.s.r=Math.min(l.s.r,W[0].r),l.e.c=Math.max(l.e.c,W[0].c),l.s.c=Math.min(l.s.c,W[0].c)),E.c||(E.c=[]),S={a:W[1],t:vt.TxO.t},E.c.push(S)}break;case 2173:z7(q[W.ixfe],W.ext);break;case 125:{if(!M.cellStyles)break;for(;W.e>=W.s;)ne[W.e--]={width:W.w/256,level:W.level||0,hidden:!!(W.flags&1)},Ue||(Ue=!0,Fv(W.w/256)),To(ne[W.e+1])}break;case 520:{var pt={};W.level!=null&&(ue[W.r]=pt,pt.level=W.level),W.hidden&&(ue[W.r]=pt,pt.hidden=!0),W.hpt&&(ue[W.r]=pt,pt.hpt=W.hpt,pt.hpx=tu(W.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||pl(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ke]]=W;break;case 161:a["!margins"]||pl(a["!margins"]={}),a["!margins"].header=W.header,a["!margins"].footer=W.footer;break;case 574:W.RTL&&(C.Views[0].RTL=!0);break;case 146:Z=W;break;case 2198:D=W;break;case 140:z=W;break;case 442:d?I.CodeName=W||I.name:C.WBProps.CodeName=W||"ThisWorkbook";break}}else _e||console.error("Missing Info for XLS Record 0x"+ke.toString(16)),t.l+=Oe}return r.SheetNames=Cr(o).sort(function(Ft,_t){return Number(Ft)-Number(_t)}).map(function(Ft){return o[Ft].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&p["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=p)):r.Preamble=p,r.Sheets&&ee.forEach(function(Ft,_t){r.Sheets[r.SheetNames[_t]]["!autofilter"]=Ft}),r.Strings=h,r.SSF=pr(tt),M.enc&&(r.Encryption=M.enc),D&&(r.Themes=D),r.Metadata={},z!==void 0&&(r.Metadata.Country=z),ie.names.length>0&&(C.Names=ie.names),r.Workbook=C,r}var Vf={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function nz(t,e,r){var n=Je.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=Iw(n,K1,Vf.DSI);for(var o in a)e[o]=a[o]}catch(d){if(r.WTF)throw d}var l=Je.find(t,"/!SummaryInformation");if(l&&l.size>0)try{var u=Iw(l,Y1,Vf.SI);for(var h in u)e[h]==null&&(e[h]=u[h])}catch(d){if(r.WTF)throw d}e.HeadingPairs&&e.TitlesOfParts&&(Gk(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function az(t,e){var r=[],n=[],a=[],o=0,l,u=sw(K1,"n"),h=sw(Y1,"n");if(t.Props)for(l=Cr(t.Props),o=0;o<l.length;++o)(Object.prototype.hasOwnProperty.call(u,l[o])?r:Object.prototype.hasOwnProperty.call(h,l[o])?n:a).push([l[o],t.Props[l[o]]]);if(t.Custprops)for(l=Cr(t.Custprops),o=0;o<l.length;++o)Object.prototype.hasOwnProperty.call(t.Props||{},l[o])||(Object.prototype.hasOwnProperty.call(u,l[o])?r:Object.prototype.hasOwnProperty.call(h,l[o])?n:a).push([l[o],t.Custprops[l[o]]]);var d=[];for(o=0;o<a.length;++o)Qk.indexOf(a[o][0])>-1||zk.indexOf(a[o][0])>-1||a[o][1]!=null&&d.push(a[o]);n.length&&Je.utils.cfb_add(e,"/SummaryInformation",Nw(n,Vf.SI,h,Y1)),(r.length||d.length)&&Je.utils.cfb_add(e,"/DocumentSummaryInformation",Nw(r,Vf.DSI,u,K1,d.length?d:null,Vf.UDI))}function W4(t,e){e||(e={}),zv(e),uv(),e.codepage&&cv(e.codepage);var r,n;if(t.FullPaths){if(Je.find(t,"/encryption"))throw new Error("File is password-protected");r=Je.find(t,"!CompObj"),n=Je.find(t,"/Workbook")||Je.find(t,"/Book")}else{switch(e.type){case"base64":t=xa(Ea(t));break;case"binary":t=xa(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}_n(t,0),n={content:t}}var a,o;if(r&&JH(r),e.bookProps&&!e.bookSheets)a={};else{var l=bt?"buffer":"array";if(n&&n.content)a=rz(n.content,e);else if((o=Je.find(t,"PerfectOffice_MAIN"))&&o.content)a=ml.to_workbook(o.content,(e.type=l,e));else if((o=Je.find(t,"NativeContent_MAIN"))&&o.content)a=ml.to_workbook(o.content,(e.type=l,e));else throw(o=Je.find(t,"MN0"))&&o.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&Je.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=xU(t))}var u={};return t.FullPaths&&nz(t,u,e),a.Props=a.Custprops=u,e.bookFiles&&(a.cfb=t),a}function iz(t,e){var r=e||{},n=Je.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Je.utils.cfb_add(n,a,X4(t,r)),r.biff==8&&(t.Props||t.Custprops)&&az(t,n),r.biff==8&&t.vbaraw&&vU(n,Je.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var o0={0:{f:RV},1:{f:LV},2:{f:rj},3:{f:qV},4:{f:jV},5:{f:JV},6:{f:oj},7:{f:YV},8:{f:mj},9:{f:dj},10:{f:fj},11:{f:hj},12:{f:BV},13:{f:aj},14:{f:XV},15:{f:zV},16:{f:U4},17:{f:cj},18:{f:QV},19:{f:Sv},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:cH},40:{},42:{},43:{f:o7},44:{f:i7},45:{f:u7},46:{f:h7},47:{f:f7},48:{},49:{f:DP},50:{},51:{f:W7},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:l4},62:{f:sj},63:{f:tU},64:{f:Ij},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Pn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:bj},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:PV},148:{f:DV,p:16},151:{f:yj},152:{},153:{f:sH},154:{},155:{},156:{f:aH},157:{},158:{},159:{T:1,f:T9},160:{T:-1},161:{T:1,f:Bl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:pj},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:G7},336:{T:-1},337:{f:Y7,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:X1},357:{},358:{},359:{},360:{T:1},361:{},362:{f:o4},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Ej},427:{f:Tj},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Sj},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:FV},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:vj},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:X1},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:hU},633:{T:1},634:{T:-1},635:{T:1,f:uU},636:{T:-1},637:{f:MP},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Xj},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Nj},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},tx={6:{f:a1},10:{f:Qs},12:{f:qr},13:{f:qr},14:{f:Or},15:{f:Or},16:{f:Dn},17:{f:Or},18:{f:Or},19:{f:qr},20:{f:Lw},21:{f:Lw},23:{f:o4},24:{f:Bw},25:{f:Or},26:{},27:{},28:{f:NL},29:{},34:{f:Or},35:{f:Uw},38:{f:Dn},39:{f:Dn},40:{f:Dn},41:{f:Dn},42:{f:Or},43:{f:Or},47:{f:z9},49:{f:aL},51:{f:qr},60:{},61:{f:JM},64:{f:Or},65:{f:nL},66:{f:qr},77:{},80:{},81:{},82:{},85:{f:qr},89:{},90:{},91:{},92:{f:HM},93:{f:FL},94:{},95:{f:Or},96:{},97:{},99:{f:Or},125:{f:l4},128:{f:_L},129:{f:GM},130:{f:qr},131:{f:Or},132:{f:Or},133:{f:qM},134:{},140:{f:HL},141:{f:qr},144:{},146:{f:qL},151:{},152:{},153:{},154:{},155:{},156:{f:qr},157:{},158:{},160:{f:ZL},161:{f:KL},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:pL},190:{f:gL},193:{f:Qs},197:{},198:{},199:{},200:{},201:{},202:{f:Or},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:qr},220:{},221:{f:Or},222:{},224:{f:vL},225:{f:jM},226:{f:Qs},227:{},229:{f:DL},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:XM},253:{f:sL},255:{f:YM},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Zk},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Or},353:{f:Qs},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:SL},431:{f:Or},432:{},433:{},434:{},437:{},438:{f:LL},439:{f:Or},440:{f:UL},441:{},442:{f:R0},443:{},444:{f:qr},445:{},446:{},448:{f:Qs},449:{f:ZM,r:2},450:{f:Qs},512:{f:Fw},513:{f:QL},515:{f:TL},516:{f:lL},517:{f:Mw},519:{f:JL},520:{f:$M},523:{},545:{f:Vw},549:{f:Ow},566:{},574:{f:tL},638:{f:mL},659:{},1048:{},1054:{f:uL},1084:{},1212:{f:CL},2048:{f:VL},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:ud},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Qs},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:WL,r:12},2173:{f:H7,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Or,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:kL,r:12},2197:{},2198:{f:M7,r:12},2199:{},2200:{},2201:{},2202:{f:RL,r:12},2203:{f:Qs},2204:{},2205:{},2206:{},2207:{},2211:{f:QM},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:qr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:YL},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:GL},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Fw},1:{},2:{f:a9},3:{f:r9},4:{f:t9},5:{f:Mw},7:{f:s9},8:{},9:{f:ud},11:{},22:{f:qr},30:{f:hL},31:{},32:{},33:{f:Vw},36:{},37:{f:Ow},50:{f:o9},62:{},52:{},67:{},68:{f:qr},69:{},86:{},126:{},127:{f:e9},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:l9},223:{},234:{},354:{},421:{},518:{f:a1},521:{f:ud},536:{f:Bw},547:{f:Uw},561:{},579:{},1030:{f:a1},1033:{f:ud},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ge(t,e,r,n){var a=e;if(!isNaN(a)){var o=n||(r||[]).length||0,l=t.next(4);l.write_shift(2,a),l.write_shift(2,o),o>0&&Ev(r)&&t.push(r)}}function sz(t,e,r,n){var a=(r||[]).length||0;if(a<=8224)return Ge(t,e,r,a);var o=e;if(!isNaN(o)){for(var l=r.parts||[],u=0,h=0,d=0;d+(l[u]||8224)<=8224;)d+=l[u]||8224,u++;var p=t.next(4);for(p.write_shift(2,o),p.write_shift(2,d),t.push(r.slice(h,h+d)),h+=d;h<a;){for(p=t.next(4),p.write_shift(2,60),d=0;d+(l[u]||8224)<=8224;)d+=l[u]||8224,u++;p.write_shift(2,d),t.push(r.slice(h,h+d)),h+=d}}}function O0(t,e,r){return t||(t=Ae(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function oz(t,e,r,n){var a=Ae(9);return O0(a,t,e),Jk(r,n||"b",a),a}function lz(t,e,r){var n=Ae(8+2*r.length);return O0(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function cz(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var a=e.t=="d"?rn(mr(e.v)):e.v;a==(a|0)&&a>=0&&a<65536?Ge(t,2,i9(r,n,a)):Ge(t,3,n9(r,n,a));return;case"b":case"e":Ge(t,5,oz(r,n,e.v,e.t));return;case"s":case"str":Ge(t,4,lz(r,n,(e.v||"").slice(0,255)));return}Ge(t,1,O0(null,r,n))}function uz(t,e,r,n){var a=Array.isArray(e),o=Ht(e["!ref"]||"A1"),l,u="",h=[];if(o.e.c>255||o.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");o.e.c=Math.min(o.e.c,255),o.e.r=Math.min(o.e.c,16383),l=yt(o)}for(var d=o.s.r;d<=o.e.r;++d){u=Pr(d);for(var p=o.s.c;p<=o.e.c;++p){d===o.s.r&&(h[p]=_r(p)),l=h[p]+u;var v=a?(e[d]||[])[p]:e[l];v&&cz(t,v,d,p)}}}function fz(t,e){for(var r=e||{},n=na(),a=0,o=0;o<t.SheetNames.length;++o)t.SheetNames[o]==r.sheet&&(a=o);if(a==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Ge(n,r.biff==4?1033:r.biff==3?521:9,Nv(t,16,r)),uz(n,t.Sheets[t.SheetNames[a]],a,r),Ge(n,10),n.end()}function hz(t,e,r){Ge(t,49,iL({sz:12,name:"Arial"},r))}function dz(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&Ge(t,1054,fL(a,e[a],r))})}function mz(t,e){var r=Ae(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Ge(t,2151,r),r=Ae(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),a4(Ht(e["!ref"]||"A1"),r),r.write_shift(4,4),Ge(t,2152,r)}function pz(t,e){for(var r=0;r<16;++r)Ge(t,224,Pw({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){Ge(t,224,Pw(n,0,e))})}function gz(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];Ge(t,440,BL(n)),n[1].Tooltip&&Ge(t,2048,jL(n))}delete e["!links"]}function xz(t,e){if(e){var r=0;e.forEach(function(n,a){++r<=256&&n&&Ge(t,125,XL(Pm(a,n),a))})}}function vz(t,e,r,n,a){var o=16+Do(a.cellXfs,e,a);if(e.v==null&&!e.bf){Ge(t,513,Cl(r,n,o));return}if(e.bf)Ge(t,6,GB(e,r,n,a,o));else switch(e.t){case"d":case"n":var l=e.t=="d"?rn(mr(e.v)):e.v;Ge(t,515,wL(r,n,l,o));break;case"b":case"e":Ge(t,517,EL(r,n,e.v,o,a,e.t));break;case"s":case"str":if(a.bookSST){var u=Bv(a.Strings,e.v,a.revStrings);Ge(t,253,oL(r,n,u,o))}else Ge(t,516,cL(r,n,(e.v||"").slice(0,255),o,a));break;default:Ge(t,513,Cl(r,n,o))}}function _z(t,e,r){var n=na(),a=r.SheetNames[t],o=r.Sheets[a]||{},l=(r||{}).Workbook||{},u=(l.Sheets||[])[t]||{},h=Array.isArray(o),d=e.biff==8,p,v="",_=[],E=Ht(o["!ref"]||"A1"),S=d?65536:16384;if(E.e.c>255||E.e.r>=S){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:IV16384");E.e.c=Math.min(E.e.c,255),E.e.r=Math.min(E.e.c,S-1)}Ge(n,2057,Nv(r,16,e)),Ge(n,13,Va(1)),Ge(n,12,Va(100)),Ge(n,15,qn(!0)),Ge(n,17,qn(!1)),Ge(n,16,bl(.001)),Ge(n,95,qn(!0)),Ge(n,42,qn(!1)),Ge(n,43,qn(!1)),Ge(n,130,Va(1)),Ge(n,128,yL()),Ge(n,131,qn(!1)),Ge(n,132,qn(!1)),d&&xz(n,o["!cols"]),Ge(n,512,dL(E,e)),d&&(o["!links"]=[]);for(var y=E.s.r;y<=E.e.r;++y){v=Pr(y);for(var w=E.s.c;w<=E.e.c;++w){y===E.s.r&&(_[w]=_r(w)),p=_[w]+v;var P=h?(o[y]||[])[w]:o[p];P&&(vz(n,P,y,w,e),d&&P.l&&o["!links"].push([p,P.l]))}}var B=u.CodeName||u.name||a;return d&&Ge(n,574,rL((l.Views||[])[0])),d&&(o["!merges"]||[]).length&&Ge(n,229,OL(o["!merges"])),d&&gz(n,o),Ge(n,442,e4(B)),d&&mz(n,o),Ge(n,10),n.end()}function yz(t,e,r){var n=na(),a=(t||{}).Workbook||{},o=a.Sheets||[],l=a.WBProps||{},u=r.biff==8,h=r.biff==5;if(Ge(n,2057,Nv(t,5,r)),r.bookType=="xla"&&Ge(n,135),Ge(n,225,u?Va(1200):null),Ge(n,193,EM(2)),h&&Ge(n,191),h&&Ge(n,192),Ge(n,226),Ge(n,92,zM("SheetJS",r)),Ge(n,66,Va(u?1200:1252)),u&&Ge(n,353,Va(0)),u&&Ge(n,448),Ge(n,317,$L(t.SheetNames.length)),u&&t.vbaraw&&Ge(n,211),u&&t.vbaraw){var d=l.CodeName||"ThisWorkbook";Ge(n,442,e4(d))}Ge(n,156,Va(17)),Ge(n,25,qn(!1)),Ge(n,18,qn(!1)),Ge(n,19,Va(0)),u&&Ge(n,431,qn(!1)),u&&Ge(n,444,Va(0)),Ge(n,61,eL()),Ge(n,64,qn(!1)),Ge(n,141,Va(0)),Ge(n,34,qn(Zj(t)=="true")),Ge(n,14,qn(!0)),u&&Ge(n,439,qn(!1)),Ge(n,218,Va(0)),hz(n,t,r),dz(n,t.SSF,r),pz(n,r),u&&Ge(n,352,qn(!1));var p=n.end(),v=na();u&&Ge(v,140,zL()),u&&r.Strings&&sz(v,252,KM(r.Strings)),Ge(v,10);var _=v.end(),E=na(),S=0,y=0;for(y=0;y<t.SheetNames.length;++y)S+=(u?12:11)+(u?2:1)*t.SheetNames[y].length;var w=p.length+S+_.length;for(y=0;y<t.SheetNames.length;++y){var P=o[y]||{};Ge(E,133,WM({pos:w,hs:P.Hidden||0,dt:0,name:t.SheetNames[y]},r)),w+=e[y].length}var B=E.end();if(S!=B.length)throw new Error("BS8 "+S+" != "+B.length);var N=[];return p.length&&N.push(p),B.length&&N.push(B),_.length&&N.push(_),fn(N)}function Ez(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=pr(tt)),t&&t.SSF&&(cu(),A0(t.SSF),r.revssf=Im(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Gv(r),r.cellXfs=[],Do(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var a=0;a<t.SheetNames.length;++a)n[n.length]=_z(a,r,t);return n.unshift(yz(t,n,r)),fn(n)}function X4(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var a=aa(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var o=e||{};switch(o.biff||2){case 8:case 5:return Ez(t,e);case 4:case 3:case 2:return fz(t,e)}throw new Error("invalid type "+o.bookType+" for BIFF")}function $w(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var a=t.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var o=t.match(/<\/table/i),l=a.index,u=o&&o.index||t.length,h=iP(t.slice(l,u),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,p=0,v=0,_=0,E={s:{r:1e7,c:1e7},e:{r:0,c:0}},S=[];for(l=0;l<h.length;++l){var y=h[l].trim(),w=y.slice(0,3).toLowerCase();if(w=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}p=0;continue}if(!(w!="<td"&&w!="<th")){var P=y.split(/<\/t[dh]>/i);for(u=0;u<P.length;++u){var B=P[u].trim();if(B.match(/<t[dh]/i)){for(var N=B,z=0;N.charAt(0)=="<"&&(z=N.indexOf(">"))>-1;)N=N.slice(z+1);for(var q=0;q<S.length;++q){var Z=S[q];Z.s.c==p&&Z.s.r<d&&d<=Z.e.r&&(p=Z.e.c+1,q=-1)}var C=dt(B.slice(0,B.indexOf(">")));_=C.colspan?+C.colspan:1,((v=+C.rowspan)>1||_>1)&&S.push({s:{r:d,c:p},e:{r:d+(v||1)-1,c:p+_-1}});var I=C.t||C["data-t"]||"";if(!N.length){p+=_;continue}if(N=xk(N),E.s.r>d&&(E.s.r=d),E.e.r<d&&(E.e.r=d),E.s.c>p&&(E.s.c=p),E.e.c<p&&(E.e.c=p),!N.length){p+=_;continue}var b={t:"s",v:N};r.raw||!N.trim().length||I=="s"||(N==="TRUE"?b={t:"b",v:!0}:N==="FALSE"?b={t:"b",v:!1}:isNaN(ti(N))?isNaN(Jc(N).getDate())||(b={t:"d",v:mr(N)},r.cellDates||(b={t:"n",v:rn(b.v)}),b.z=r.dateNF||tt[14]):b={t:"n",v:ti(N)}),r.dense?(n[d]||(n[d]=[]),n[d][p]=b):n[lt({r:d,c:p})]=b,p+=_}}}}return n["!ref"]=yt(E),S.length&&(n["!merges"]=S),n}function Tz(t,e,r,n){for(var a=t["!merges"]||[],o=[],l=e.s.c;l<=e.e.c;++l){for(var u=0,h=0,d=0;d<a.length;++d)if(!(a[d].s.r>r||a[d].s.c>l)&&!(a[d].e.r<r||a[d].e.c<l)){if(a[d].s.r<r||a[d].s.c<l){u=-1;break}u=a[d].e.r-a[d].s.r+1,h=a[d].e.c-a[d].s.c+1;break}if(!(u<0)){var p=lt({r,c:l}),v=n.dense?(t[r]||[])[l]:t[p],_=v&&v.v!=null&&(v.h||vv(v.w||(vs(v),v.w)||""))||"",E={};u>1&&(E.rowspan=u),h>1&&(E.colspan=h),n.editable?_='<span contenteditable="true">'+_+"</span>":v&&(E["data-t"]=v&&v.t||"z",v.v!=null&&(E["data-v"]=v.v),v.z!=null&&(E["data-z"]=v.z),v.l&&(v.l.Target||"#").charAt(0)!="#"&&(_='<a href="'+v.l.Target+'">'+_+"</a>")),E.id=(n.id||"sjs")+"-"+p,o.push(He("td",_,E))}}var S="<tr>";return S+o.join("")+"</tr>"}var wz='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Sz="</body></html>";function Az(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return No($w(r[0],e),e);var n=Xv();return r.forEach(function(a,o){Kv(n,$w(a,e),"Sheet"+(o+1))}),n}function bz(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function K4(t,e){var r=e||{},n=r.header!=null?r.header:wz,a=r.footer!=null?r.footer:Sz,o=[n],l=aa(t["!ref"]);r.dense=Array.isArray(t),o.push(bz(t,l,r));for(var u=l.s.r;u<=l.e.r;++u)o.push(Tz(t,l,u,r));return o.push("</table>"+a),o.join("")}function Y4(t,e,r){var n=r||{},a=0,o=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?yr(n.origin):n.origin;a=l.r,o=l.c}var u=e.getElementsByTagName("tr"),h=Math.min(n.sheetRows||1e7,u.length),d={s:{r:0,c:0},e:{r:a,c:o}};if(t["!ref"]){var p=aa(t["!ref"]);d.s.r=Math.min(d.s.r,p.s.r),d.s.c=Math.min(d.s.c,p.s.c),d.e.r=Math.max(d.e.r,p.e.r),d.e.c=Math.max(d.e.c,p.e.c),a==-1&&(d.e.r=a=p.e.r+1)}var v=[],_=0,E=t["!rows"]||(t["!rows"]=[]),S=0,y=0,w=0,P=0,B=0,N=0;for(t["!cols"]||(t["!cols"]=[]);S<u.length&&y<h;++S){var z=u[S];if(Qw(z)){if(n.display)continue;E[y]={hidden:!0}}var q=z.children;for(w=P=0;w<q.length;++w){var Z=q[w];if(!(n.display&&Qw(Z))){var C=Z.hasAttribute("data-v")?Z.getAttribute("data-v"):Z.hasAttribute("v")?Z.getAttribute("v"):xk(Z.innerHTML),I=Z.getAttribute("data-z")||Z.getAttribute("z");for(_=0;_<v.length;++_){var b=v[_];b.s.c==P+o&&b.s.r<y+a&&y+a<=b.e.r&&(P=b.e.c+1-o,_=-1)}N=+Z.getAttribute("colspan")||1,((B=+Z.getAttribute("rowspan")||1)>1||N>1)&&v.push({s:{r:y+a,c:P+o},e:{r:y+a+(B||1)-1,c:P+o+(N||1)-1}});var O={t:"s",v:C},L=Z.getAttribute("data-t")||Z.getAttribute("t")||"";C!=null&&(C.length==0?O.t=L||"z":n.raw||C.trim().length==0||L=="s"||(C==="TRUE"?O={t:"b",v:!0}:C==="FALSE"?O={t:"b",v:!1}:isNaN(ti(C))?isNaN(Jc(C).getDate())||(O={t:"d",v:mr(C)},n.cellDates||(O={t:"n",v:rn(O.v)}),O.z=n.dateNF||tt[14]):O={t:"n",v:ti(C)})),O.z===void 0&&I!=null&&(O.z=I);var M="",D=Z.getElementsByTagName("A");if(D&&D.length)for(var Ee=0;Ee<D.length&&!(D[Ee].hasAttribute("href")&&(M=D[Ee].getAttribute("href"),M.charAt(0)!="#"));++Ee);M&&M.charAt(0)!="#"&&(O.l={Target:M}),n.dense?(t[y+a]||(t[y+a]=[]),t[y+a][P+o]=O):t[lt({c:P+o,r:y+a})]=O,d.e.c<P+o&&(d.e.c=P+o),P+=N}}++y}return v.length&&(t["!merges"]=(t["!merges"]||[]).concat(v)),d.e.r=Math.max(d.e.r,y-1+a),t["!ref"]=yt(d),y>=h&&(t["!fullref"]=yt((d.e.r=u.length-S+y-1+a,d))),t}function $4(t,e){var r=e||{},n=r.dense?[]:{};return Y4(n,t,e)}function kz(t,e){return No($4(t,e),e)}function Qw(t){var e="",r=Cz(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function Cz(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Rz(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=jt(e.replace(/<[^>]*>/g,""));return[r]}var Zw={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Q4(t,e){var r=e||{},n=_v(t),a=[],o,l,u={name:""},h="",d=0,p,v,_={},E=[],S=r.dense?[]:{},y,w,P={value:""},B="",N=0,z=[],q=-1,Z=-1,C={s:{r:1e6,c:1e7},e:{r:0,c:0}},I=0,b={},O=[],L={},M=0,D=0,Ee=[],Te=1,ne=1,ue=[],Ue={Names:[]},ie={},K=["",""],pe=[],V={},X="",ee=0,te=!1,le=!1,Ne=0;for(t0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");y=t0.exec(n);)switch(y[3]=y[3].replace(/_.*$/,"")){case"table":case"":y[1]==="/"?(C.e.c>=C.s.c&&C.e.r>=C.s.r?S["!ref"]=yt(C):S["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=C.e.r&&(S["!fullref"]=S["!ref"],C.e.r=r.sheetRows-1,S["!ref"]=yt(C)),O.length&&(S["!merges"]=O),Ee.length&&(S["!rows"]=Ee),p.name=p.||p.name,typeof JSON<"u"&&JSON.stringify(p),E.push(p.name),_[p.name]=S,le=!1):y[0].charAt(y[0].length-2)!=="/"&&(p=dt(y[0],!1),q=Z=-1,C.s.r=C.s.c=1e7,C.e.r=C.e.c=0,S=r.dense?[]:{},O=[],Ee=[],le=!0);break;case"table-row-group":y[1]==="/"?--I:++I;break;case"table-row":case"":if(y[1]==="/"){q+=Te,Te=1;break}if(v=dt(y[0],!1),v.?q=v.-1:q==-1&&(q=0),Te=+v["number-rows-repeated"]||1,Te<10)for(Ne=0;Ne<Te;++Ne)I>0&&(Ee[q+Ne]={level:I});Z=-1;break;case"covered-table-cell":y[1]!=="/"&&++Z,r.sheetStubs&&(r.dense?(S[q]||(S[q]=[]),S[q][Z]={t:"z"}):S[lt({r:q,c:Z})]={t:"z"}),B="",z=[];break;case"table-cell":case"":if(y[0].charAt(y[0].length-2)==="/")++Z,P=dt(y[0],!1),ne=parseInt(P["number-columns-repeated"]||"1",10),w={t:"z",v:null},P.formula&&r.cellFormula!=!1&&(w.f=Xw(jt(P.formula))),(P.||P["value-type"])=="string"&&(w.t="s",w.v=jt(P["string-value"]||""),r.dense?(S[q]||(S[q]=[]),S[q][Z]=w):S[lt({r:q,c:Z})]=w),Z+=ne-1;else if(y[1]!=="/"){++Z,B="",N=0,z=[],ne=1;var ke=Te?q+Te-1:q;if(Z>C.e.c&&(C.e.c=Z),Z<C.s.c&&(C.s.c=Z),q<C.s.r&&(C.s.r=q),ke>C.e.r&&(C.e.r=ke),P=dt(y[0],!1),pe=[],V={},w={t:P.||P["value-type"],v:null},r.cellFormula)if(P.formula&&(P.formula=jt(P.formula)),P["number-matrix-columns-spanned"]&&P["number-matrix-rows-spanned"]&&(M=parseInt(P["number-matrix-rows-spanned"],10)||0,D=parseInt(P["number-matrix-columns-spanned"],10)||0,L={s:{r:q,c:Z},e:{r:q+M-1,c:Z+D-1}},w.F=yt(L),ue.push([L,w.F])),P.formula)w.f=Xw(P.formula);else for(Ne=0;Ne<ue.length;++Ne)q>=ue[Ne][0].s.r&&q<=ue[Ne][0].e.r&&Z>=ue[Ne][0].s.c&&Z<=ue[Ne][0].e.c&&(w.F=ue[Ne][1]);switch((P["number-columns-spanned"]||P["number-rows-spanned"])&&(M=parseInt(P["number-rows-spanned"],10)||0,D=parseInt(P["number-columns-spanned"],10)||0,L={s:{r:q,c:Z},e:{r:q+M-1,c:Z+D-1}},O.push(L)),P["number-columns-repeated"]&&(ne=parseInt(P["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=hr(P["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(P.value);break;case"percentage":w.t="n",w.v=parseFloat(P.value);break;case"currency":w.t="n",w.v=parseFloat(P.value);break;case"date":w.t="d",w.v=mr(P["date-value"]),r.cellDates||(w.t="n",w.v=rn(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=rP(P["time-value"])/86400,r.cellDates&&(w.t="d",w.v=Nm(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(P.);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",P["string-value"]!=null&&(B=jt(P["string-value"]),z=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(te=!1,w.t==="s"&&(w.v=B||"",z.length&&(w.R=z),te=N==0),ie.Target&&(w.l=ie),pe.length>0&&(w.c=pe,pe=[]),B&&r.cellText!==!1&&(w.w=B),te&&(w.t="z",delete w.v),(!te||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=q))for(var Oe=0;Oe<Te;++Oe){if(ne=parseInt(P["number-columns-repeated"]||"1",10),r.dense)for(S[q+Oe]||(S[q+Oe]=[]),S[q+Oe][Z]=Oe==0?w:pr(w);--ne>0;)S[q+Oe][Z+ne]=pr(w);else for(S[lt({r:q+Oe,c:Z})]=w;--ne>0;)S[lt({r:q+Oe,c:Z+ne})]=pr(w);C.e.c<=Z&&(C.e.c=Z)}ne=parseInt(P["number-columns-repeated"]||"1",10),Z+=ne-1,ne=0,w={},B="",z=[]}ie={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(y[1]==="/"){if((o=a.pop())[0]!==y[3])throw"Bad state: "+o}else y[0].charAt(y[0].length-2)!=="/"&&a.push([y[3],!0]);break;case"annotation":if(y[1]==="/"){if((o=a.pop())[0]!==y[3])throw"Bad state: "+o;V.t=B,z.length&&(V.R=z),V.a=X,pe.push(V)}else y[0].charAt(y[0].length-2)!=="/"&&a.push([y[3],!1]);X="",ee=0,B="",N=0,z=[];break;case"creator":y[1]==="/"?X=n.slice(ee,y.index):ee=y.index+y[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(y[1]==="/"){if((o=a.pop())[0]!==y[3])throw"Bad state: "+o}else y[0].charAt(y[0].length-2)!=="/"&&a.push([y[3],!1]);B="",N=0,z=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(y[1]==="/"){if(b[u.name]=h,(o=a.pop())[0]!==y[3])throw"Bad state: "+o}else y[0].charAt(y[0].length-2)!=="/"&&(h="",u=dt(y[0],!1),a.push([y[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":l=dt(y[0],!1),h+=Zw[y[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":l=dt(y[0],!1),h+=Zw[y[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(y[0].slice(-2)==="/>")break;if(y[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":h+=n.slice(d,y.index);break}else d=y.index+y[0].length;break;case"named-range":l=dt(y[0],!1),K=i1(l["cell-range-address"]);var _e={Name:l.name,Ref:K[0]+"!"+K[1]};le&&(_e.Sheet=E.length),Ue.Names.push(_e);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(y[1]==="/"&&(!P||!P["string-value"])){var Be=Rz(n.slice(N,y.index));B=(B.length>0?B+`
`:"")+Be[0]}else dt(y[0],!1),N=y.index+y[0].length;break;case"s":break;case"database-range":if(y[1]==="/")break;try{K=i1(dt(y[0])["target-range-address"]),_[K[0]]["!autofilter"]={ref:K[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(y[1]!=="/"){if(ie=dt(y[0],!1),!ie.href)break;ie.Target=jt(ie.href),delete ie.href,ie.Target.charAt(0)=="#"&&ie.Target.indexOf(".")>-1?(K=i1(ie.Target.slice(1)),ie.Target="#"+K[0]+"!"+K[1]):ie.Target.match(/^\.\.[\\\/]/)&&(ie.Target=ie.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(y[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(y)}}var W={Sheets:_,SheetNames:E,Workbook:Ue};return r.bookSheets&&delete W.Sheets,W}function Jw(t,e){e=e||{},Ba(t,"META-INF/manifest.xml")&&rM(Gr(t,"META-INF/manifest.xml"),e);var r=va(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=Q4(ar(r),e);return Ba(t,"meta.xml")&&(n.Props=jk(Gr(t,"meta.xml"))),n}function eS(t,e){return Q4(t,e)}var Iz=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+e0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Mr+e}}(),tS=function(){var t=function(o){return Jt(o).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(o,l,u){var h=[];h.push('      <table:table table:name="'+Jt(l.SheetNames[u])+`" table:style-name="ta1">
`);var d=0,p=0,v=aa(o["!ref"]||"A1"),_=o["!merges"]||[],E=0,S=Array.isArray(o);if(o["!cols"])for(p=0;p<=v.e.c;++p)h.push("        <table:table-column"+(o["!cols"][p]?' table:style-name="co'+o["!cols"][p].ods+'"':"")+`></table:table-column>
`);var y="",w=o["!rows"]||[];for(d=0;d<v.s.r;++d)y=w[d]?' table:style-name="ro'+w[d].ods+'"':"",h.push("        <table:table-row"+y+`></table:table-row>
`);for(;d<=v.e.r;++d){for(y=w[d]?' table:style-name="ro'+w[d].ods+'"':"",h.push("        <table:table-row"+y+`>
`),p=0;p<v.s.c;++p)h.push(e);for(;p<=v.e.c;++p){var P=!1,B={},N="";for(E=0;E!=_.length;++E)if(!(_[E].s.c>p)&&!(_[E].s.r>d)&&!(_[E].e.c<p)&&!(_[E].e.r<d)){(_[E].s.c!=p||_[E].s.r!=d)&&(P=!0),B["table:number-columns-spanned"]=_[E].e.c-_[E].s.c+1,B["table:number-rows-spanned"]=_[E].e.r-_[E].s.r+1;break}if(P){h.push(r);continue}var z=lt({r:d,c:p}),q=S?(o[d]||[])[p]:o[z];if(q&&q.f&&(B["table:formula"]=Jt($B(q.f)),q.F&&q.F.slice(0,z.length)==z)){var Z=aa(q.F);B["table:number-matrix-columns-spanned"]=Z.e.c-Z.s.c+1,B["table:number-matrix-rows-spanned"]=Z.e.r-Z.s.r+1}if(!q){h.push(e);continue}switch(q.t){case"b":N=q.v?"TRUE":"FALSE",B["office:value-type"]="boolean",B["office:boolean-value"]=q.v?"true":"false";break;case"n":N=q.w||String(q.v||0),B["office:value-type"]="float",B["office:value"]=q.v||0;break;case"s":case"str":N=q.v==null?"":q.v,B["office:value-type"]="string";break;case"d":N=q.w||mr(q.v).toISOString(),B["office:value-type"]="date",B["office:date-value"]=mr(q.v).toISOString(),B["table:style-name"]="ce1";break;default:h.push(e);continue}var C=t(N);if(q.l&&q.l.Target){var I=q.l.Target;I=I.charAt(0)=="#"?"#"+QB(I.slice(1)):I,I.charAt(0)!="#"&&!I.match(/^\w+:/)&&(I="../"+I),C=He("text:a",C,{"xlink:href":I.replace(/&/g,"&amp;")})}h.push("          "+He("table:table-cell",He("text:p",C,{}),B)+`
`)}h.push(`        </table:table-row>
`)}return h.push(`      </table:table>
`),h.join("")},a=function(o,l){o.push(` <office:automatic-styles>
`),o.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),o.push(`   <number:month number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:day number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:year/>
`),o.push(`  </number:date-style>
`);var u=0;l.SheetNames.map(function(d){return l.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var p=0;p<d["!cols"].length;++p)if(d["!cols"][p]){var v=d["!cols"][p];if(v.width==null&&v.wpx==null&&v.wch==null)continue;To(v),v.ods=u;var _=d["!cols"][p].wpx+"px";o.push('  <style:style style:name="co'+u+`" style:family="table-column">
`),o.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+_+`"/>
`),o.push(`  </style:style>
`),++u}}});var h=0;l.SheetNames.map(function(d){return l.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var p=0;p<d["!rows"].length;++p)if(d["!rows"][p]){d["!rows"][p].ods=h;var v=d["!rows"][p].hpx+"px";o.push('  <style:style style:name="ro'+h+`" style:family="table-row">
`),o.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+v+`"/>
`),o.push(`  </style:style>
`),++h}}}),o.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),o.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),o.push(`  </style:style>
`),o.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),o.push(` </office:automatic-styles>
`)};return function(l,u){var h=[Mr],d=e0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),p=e0({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});u.bookType=="fods"?(h.push("<office:document"+d+p+`>
`),h.push(Vk().replace(/office:document-meta/g,"office:meta"))):h.push("<office:document-content"+d+`>
`),a(h,l),h.push(`  <office:body>
`),h.push(`    <office:spreadsheet>
`);for(var v=0;v!=l.SheetNames.length;++v)h.push(n(l.Sheets[l.SheetNames[v]],l,v));return h.push(`    </office:spreadsheet>
`),h.push(`  </office:body>
`),u.bookType=="fods"?h.push("</office:document>"):h.push("</office:document-content>"),h.join("")}}();function Z4(t,e){if(e.bookType=="fods")return tS(t,e);var r=pv(),n="",a=[],o=[];return n="mimetype",Tt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Tt(r,n,tS(t,e)),a.push([n,"text/xml"]),o.push([n,"ContentFile"]),n="styles.xml",Tt(r,n,Iz(t,e)),a.push([n,"text/xml"]),o.push([n,"StylesFile"]),n="meta.xml",Tt(r,n,Mr+Vk()),a.push([n,"text/xml"]),o.push([n,"MetadataFile"]),n="manifest.rdf",Tt(r,n,iM(o)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Tt(r,n,nM(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Rl(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function rx(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):ar(Io(t))}function Nz(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):xa(Ci(t))}function Dz(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function So(t){var e=t.reduce(function(a,o){return a+o.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(a){r.set(a,n),n+=a.length}),r}function rS(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function Oz(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,a=e+13;a>=e;--a)n=n*256+t[a];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function Fz(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var o=0;a>=1;++o,a/=256)t[e+o]=a&255;t[e+15]|=r>=0?0:128}function l0(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function Qt(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function Ar(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function qt(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],a=l0(t,r),o=a&7;a=Math.floor(a/8);var l=0,u;if(a==0)break;switch(o){case 0:{for(var h=r[0];t[r[0]++]>=128;);u=t.slice(h,r[0])}break;case 5:l=4,u=t.slice(r[0],r[0]+l),r[0]+=l;break;case 1:l=8,u=t.slice(r[0],r[0]+l),r[0]+=l;break;case 2:l=l0(t,r),u=t.slice(r[0],r[0]+l),r[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(o," for Field ").concat(a," at offset ").concat(n))}var d={data:u,type:o};e[a]==null?e[a]=[d]:e[a].push(d)}return e}function xn(t){var e=[];return t.forEach(function(r,n){r.forEach(function(a){a.data&&(e.push(Qt(n*8+a.type)),a.type==2&&e.push(Qt(a.data.length)),e.push(a.data))})}),So(e)}function Hv(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function La(t){for(var e,r=[],n=[0];n[0]<t.length;){var a=l0(t,n),o=qt(t.slice(n[0],n[0]+a));n[0]+=a;var l={id:Ar(o[1][0].data),messages:[]};o[2].forEach(function(u){var h=qt(u.data),d=Ar(h[3][0].data);l.messages.push({meta:h,data:t.slice(n[0],n[0]+d)}),n[0]+=d}),(e=o[3])!=null&&e[0]&&(l.merge=Ar(o[3][0].data)>>>0>0),r.push(l)}return r}function Cc(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:Qt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Qt(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(l){a.push(l.data),l.meta[3]=[{type:0,data:Qt(l.data.length)}],n[2].push({data:xn(l.meta),type:2})});var o=xn(n);e.push(Qt(o.length)),e.push(o),a.forEach(function(l){return e.push(l)})}),So(e)}function Pz(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=l0(e,r),a=[];r[0]<e.length;){var o=e[r[0]]&3;if(o==0){var l=e[r[0]++]>>2;if(l<60)++l;else{var u=l-59;l=e[r[0]],u>1&&(l|=e[r[0]+1]<<8),u>2&&(l|=e[r[0]+2]<<16),u>3&&(l|=e[r[0]+3]<<24),l>>>=0,l++,r[0]+=u}a.push(e.slice(r[0],r[0]+l)),r[0]+=l;continue}else{var h=0,d=0;if(o==1?(d=(e[r[0]]>>2&7)+4,h=(e[r[0]++]&224)<<3,h|=e[r[0]++]):(d=(e[r[0]++]>>2)+1,o==2?(h=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(h=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),a=[So(a)],h==0)throw new Error("Invalid offset 0");if(h>a[0].length)throw new Error("Invalid offset beyond length");if(d>=h)for(a.push(a[0].slice(-h)),d-=h;d>=a[a.length-1].length;)a.push(a[a.length-1]),d-=a[a.length-1].length;a.push(a[0].slice(-h,-h+d))}}var p=So(a);if(p.length!=n)throw new Error("Unexpected length: ".concat(p.length," != ").concat(n));return p}function Ua(t){for(var e=[],r=0;r<t.length;){var n=t[r++],a=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(Pz(n,t.slice(r,r+a))),r+=a}if(r!==t.length)throw new Error("data is not a valid framed stream!");return So(e)}function Rc(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),a=new Uint8Array(4);e.push(a);var o=Qt(n),l=o.length;e.push(o),n<=60?(l++,e.push(new Uint8Array([n-1<<2]))):n<=256?(l+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(l+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(l+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(l+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),l+=n,a[0]=0,a[1]=l&255,a[2]=l>>8&255,a[3]=l>>16&255,r+=n}return So(e)}function Mz(t,e,r,n){var a=Rl(t),o=a.getUint32(4,!0),l=(n>1?12:8)+rS(o&(n>1?3470:398))*4,u=-1,h=-1,d=NaN,p=new Date(2001,0,1);o&512&&(u=a.getUint32(l,!0),l+=4),l+=rS(o&(n>1?12288:4096))*4,o&16&&(h=a.getUint32(l,!0),l+=4),o&32&&(d=a.getFloat64(l,!0),l+=8),o&64&&(p.setTime(p.getTime()+a.getFloat64(l,!0)*1e3),l+=8);var v;switch(t[2]){case 0:break;case 2:v={t:"n",v:d};break;case 3:v={t:"s",v:e[h]};break;case 5:v={t:"d",v:p};break;case 6:v={t:"b",v:d>0};break;case 7:v={t:"n",v:d/86400};break;case 8:v={t:"e",v:0};break;case 9:if(u>-1)v={t:"s",v:r[u]};else if(h>-1)v={t:"s",v:e[h]};else if(!isNaN(d))v={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return v}function Lz(t,e,r){var n=Rl(t),a=n.getUint32(8,!0),o=12,l=-1,u=-1,h=NaN,d=NaN,p=new Date(2001,0,1);a&1&&(h=Oz(t,o),o+=16),a&2&&(d=n.getFloat64(o,!0),o+=8),a&4&&(p.setTime(p.getTime()+n.getFloat64(o,!0)*1e3),o+=8),a&8&&(u=n.getUint32(o,!0),o+=4),a&16&&(l=n.getUint32(o,!0),o+=4);var v;switch(t[1]){case 0:break;case 2:v={t:"n",v:h};break;case 3:v={t:"s",v:e[u]};break;case 5:v={t:"d",v:p};break;case 6:v={t:"b",v:d>0};break;case 7:v={t:"n",v:d/86400};break;case 8:v={t:"e",v:0};break;case 9:if(l>-1)v={t:"s",v:r[l]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)));break;case 10:v={t:"n",v:h};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)))}return v}function o1(t,e){var r=new Uint8Array(32),n=Rl(r),a=12,o=0;switch(r[0]=5,t.t){case"n":r[1]=2,Fz(r,a,t.v),o|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,t.v?1:0,!0),o|=2,a+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(a,e.indexOf(t.v),!0),o|=8,a+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,o,!0),r.slice(0,a)}function l1(t,e){var r=new Uint8Array(32),n=Rl(r),a=12,o=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(a,t.v,!0),o|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,t.v?1:0,!0),o|=32,a+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(a,e.indexOf(t.v),!0),o|=16,a+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,o,!0),r.slice(0,a)}function Uz(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return Mz(t,e,r,t[0]);case 5:return Lz(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Cn(t){var e=qt(t);return l0(e[1][0].data)}function nS(t,e){var r=qt(e.data),n=Ar(r[1][0].data),a=r[3],o=[];return(a||[]).forEach(function(l){var u=qt(l.data),h=Ar(u[1][0].data)>>>0;switch(n){case 1:o[h]=rx(u[3][0].data);break;case 8:{var d=t[Cn(u[9][0].data)][0],p=qt(d.data),v=t[Cn(p[1][0].data)][0],_=Ar(v.meta[1][0].data);if(_!=2001)throw new Error("2000 unexpected reference to ".concat(_));var E=qt(v.data);o[h]=E[3].map(function(S){return rx(S.data)}).join("")}break}}),o}function Bz(t,e){var r,n,a,o,l,u,h,d,p,v,_,E,S,y,w=qt(t),P=Ar(w[1][0].data)>>>0,B=Ar(w[2][0].data)>>>0,N=((n=(r=w[8])==null?void 0:r[0])==null?void 0:n.data)&&Ar(w[8][0].data)>0||!1,z,q;if((o=(a=w[7])==null?void 0:a[0])!=null&&o.data&&e!=0)z=(u=(l=w[7])==null?void 0:l[0])==null?void 0:u.data,q=(d=(h=w[6])==null?void 0:h[0])==null?void 0:d.data;else if((v=(p=w[4])==null?void 0:p[0])!=null&&v.data&&e!=1)z=(E=(_=w[4])==null?void 0:_[0])==null?void 0:E.data,q=(y=(S=w[3])==null?void 0:S[0])==null?void 0:y.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var Z=N?4:1,C=Rl(z),I=[],b=0;b<z.length/2;++b){var O=C.getUint16(b*2,!0);O<65535&&I.push([b,O])}if(I.length!=B)throw"Expected ".concat(B," cells, found ").concat(I.length);var L=[];for(b=0;b<I.length-1;++b)L[I[b][0]]=q.subarray(I[b][1]*Z,I[b+1][1]*Z);return I.length>=1&&(L[I[I.length-1][0]]=q.subarray(I[I.length-1][1]*Z)),{R:P,cells:L}}function Vz(t,e){var r,n=qt(e.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?Ar(n[7][0].data)>>>0>0?1:0:-1,o=Hv(n[5],function(l){return Bz(l,a)});return{nrows:Ar(n[4][0].data)>>>0,data:o.reduce(function(l,u){return l[u.R]||(l[u.R]=[]),u.cells.forEach(function(h,d){if(l[u.R][d])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(d));l[u.R][d]=h}),l},[])}}function jz(t,e,r){var n,a=qt(e.data),o={s:{r:0,c:0},e:{r:0,c:0}};if(o.e.r=(Ar(a[6][0].data)>>>0)-1,o.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(o.e.c=(Ar(a[7][0].data)>>>0)-1,o.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=yt(o);var l=qt(a[4][0].data),u=nS(t,t[Cn(l[4][0].data)][0]),h=(n=l[17])!=null&&n[0]?nS(t,t[Cn(l[17][0].data)][0]):[],d=qt(l[3][0].data),p=0;d[1].forEach(function(v){var _=qt(v.data),E=t[Cn(_[2][0].data)][0],S=Ar(E.meta[1][0].data);if(S!=6002)throw new Error("6001 unexpected reference to ".concat(S));var y=Vz(t,E);y.data.forEach(function(w,P){w.forEach(function(B,N){var z=lt({r:p+P,c:N}),q=Uz(B,u,h);q&&(r[z]=q)})}),p+=y.nrows})}function Hz(t,e){var r=qt(e.data),n={"!ref":"A1"},a=t[Cn(r[2][0].data)],o=Ar(a[0].meta[1][0].data);if(o!=6001)throw new Error("6000 unexpected reference to ".concat(o));return jz(t,a[0],n),n}function zz(t,e){var r,n=qt(e.data),a={name:(r=n[1])!=null&&r[0]?rx(n[1][0].data):"",sheets:[]},o=Hv(n[2],Cn);return o.forEach(function(l){t[l].forEach(function(u){var h=Ar(u.meta[1][0].data);h==6e3&&a.sheets.push(Hz(t,u))})}),a}function Gz(t,e){var r=Xv(),n=qt(e.data),a=Hv(n[1],Cn);if(a.forEach(function(o){t[o].forEach(function(l){var u=Ar(l.meta[1][0].data);if(u==2){var h=zz(t,l);h.sheets.forEach(function(d,p){Kv(r,d,p==0?h.name:h.name+"_"+p,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function c1(t){var e,r,n,a,o={},l=[];if(t.FullPaths.forEach(function(h){if(h.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(h){if(h.name.match(/\.iwa$/)){var d;try{d=Ua(h.content)}catch(v){return console.log("?? "+h.content.length+" "+(v.message||v))}var p;try{p=La(d)}catch(v){return console.log("## "+(v.message||v))}p.forEach(function(v){o[v.id]=v.messages,l.push(v.id)})}}),!l.length)throw new Error("File has no messages");var u=((a=(n=(r=(e=o==null?void 0:o[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Ar(o[1][0].meta[1][0].data)==1&&o[1][0];if(u||l.forEach(function(h){o[h].forEach(function(d){var p=Ar(d.meta[1][0].data)>>>0;if(p==1)if(!u)u=d;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return Gz(o,u)}function qz(t,e,r){var n,a,o,l;if(!((n=t[6])!=null&&n[0])||!((a=t[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var u=((l=(o=t[8])==null?void 0:o[0])==null?void 0:l.data)&&Ar(t[8][0].data)>0||!1;if(u)throw"Math only works with normal offsets";for(var h=0,d=Rl(t[7][0].data),p=0,v=[],_=Rl(t[4][0].data),E=0,S=[],y=0;y<e.length;++y){if(e[y]==null){d.setUint16(y*2,65535,!0),_.setUint16(y*2,65535);continue}d.setUint16(y*2,p,!0),_.setUint16(y*2,E,!0);var w,P;switch(typeof e[y]){case"string":w=o1({t:"s",v:e[y]},r),P=l1({t:"s",v:e[y]},r);break;case"number":w=o1({t:"n",v:e[y]},r),P=l1({t:"n",v:e[y]},r);break;case"boolean":w=o1({t:"b",v:e[y]},r),P=l1({t:"b",v:e[y]},r);break;default:throw new Error("Unsupported value "+e[y])}v.push(w),p+=w.length,S.push(P),E+=P.length,++h}for(t[2][0].data=Qt(h);y<t[7][0].data.length/2;++y)d.setUint16(y*2,65535,!0),_.setUint16(y*2,65535,!0);return t[6][0].data=So(v),t[3][0].data=So(S),h}function Wz(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=aa(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(yt(n)));var o=am(r,{range:n,header:1}),l=["~Sh33tJ5~"];o.forEach(function(X){return X.forEach(function(ee){typeof ee=="string"&&l.push(ee)})});var u={},h=[],d=Je.read(e.numbers,{type:"base64"});d.FileIndex.map(function(X,ee){return[X,d.FullPaths[ee]]}).forEach(function(X){var ee=X[0],te=X[1];if(ee.type==2&&ee.name.match(/\.iwa/)){var le=ee.content,Ne=Ua(le),ke=La(Ne);ke.forEach(function(Oe){h.push(Oe.id),u[Oe.id]={deps:[],location:te,type:Ar(Oe.messages[0].meta[1][0].data)}})}}),h.sort(function(X,ee){return X-ee});var p=h.filter(function(X){return X>1}).map(function(X){return[X,Qt(X)]});d.FileIndex.map(function(X,ee){return[X,d.FullPaths[ee]]}).forEach(function(X){var ee=X[0];if(X[1],!!ee.name.match(/\.iwa/)){var te=La(Ua(ee.content));te.forEach(function(le){le.messages.forEach(function(Ne){p.forEach(function(ke){le.messages.some(function(Oe){return Ar(Oe.meta[1][0].data)!=11006&&Dz(Oe.data,ke[1])})&&u[ke[0]].deps.push(le.id)})})})}});for(var v=Je.find(d,u[1].location),_=La(Ua(v.content)),E,S=0;S<_.length;++S){var y=_[S];y.id==1&&(E=y)}var w=Cn(qt(E.messages[0].data)[1][0].data);for(v=Je.find(d,u[w].location),_=La(Ua(v.content)),S=0;S<_.length;++S)y=_[S],y.id==w&&(E=y);for(w=Cn(qt(E.messages[0].data)[2][0].data),v=Je.find(d,u[w].location),_=La(Ua(v.content)),S=0;S<_.length;++S)y=_[S],y.id==w&&(E=y);for(w=Cn(qt(E.messages[0].data)[2][0].data),v=Je.find(d,u[w].location),_=La(Ua(v.content)),S=0;S<_.length;++S)y=_[S],y.id==w&&(E=y);var P=qt(E.messages[0].data);{P[6][0].data=Qt(n.e.r+1),P[7][0].data=Qt(n.e.c+1);var B=Cn(P[46][0].data),N=Je.find(d,u[B].location),z=La(Ua(N.content));{for(var q=0;q<z.length&&z[q].id!=B;++q);if(z[q].id!=B)throw"Bad ColumnRowUIDMapArchive";var Z=qt(z[q].messages[0].data);Z[1]=[],Z[2]=[],Z[3]=[];for(var C=0;C<=n.e.c;++C){var I=[];I[1]=I[2]=[{type:0,data:Qt(C+420690)}],Z[1].push({type:2,data:xn(I)}),Z[2].push({type:0,data:Qt(C)}),Z[3].push({type:0,data:Qt(C)})}Z[4]=[],Z[5]=[],Z[6]=[];for(var b=0;b<=n.e.r;++b)I=[],I[1]=I[2]=[{type:0,data:Qt(b+726270)}],Z[4].push({type:2,data:xn(I)}),Z[5].push({type:0,data:Qt(b)}),Z[6].push({type:0,data:Qt(b)});z[q].messages[0].data=xn(Z)}N.content=Rc(Cc(z)),N.size=N.content.length,delete P[46];var O=qt(P[4][0].data);{O[7][0].data=Qt(n.e.r+1);var L=qt(O[1][0].data),M=Cn(L[2][0].data);N=Je.find(d,u[M].location),z=La(Ua(N.content));{if(z[0].id!=M)throw"Bad HeaderStorageBucket";var D=qt(z[0].messages[0].data);for(b=0;b<o.length;++b){var Ee=qt(D[2][0].data);Ee[1][0].data=Qt(b),Ee[4][0].data=Qt(o[b].length),D[2][b]={type:D[2][0].type,data:xn(Ee)}}z[0].messages[0].data=xn(D)}N.content=Rc(Cc(z)),N.size=N.content.length;var Te=Cn(O[2][0].data);N=Je.find(d,u[Te].location),z=La(Ua(N.content));{if(z[0].id!=Te)throw"Bad HeaderStorageBucket";for(D=qt(z[0].messages[0].data),C=0;C<=n.e.c;++C)Ee=qt(D[2][0].data),Ee[1][0].data=Qt(C),Ee[4][0].data=Qt(n.e.r+1),D[2][C]={type:D[2][0].type,data:xn(Ee)};z[0].messages[0].data=xn(D)}N.content=Rc(Cc(z)),N.size=N.content.length;var ne=Cn(O[4][0].data);(function(){for(var X=Je.find(d,u[ne].location),ee=La(Ua(X.content)),te,le=0;le<ee.length;++le){var Ne=ee[le];Ne.id==ne&&(te=Ne)}var ke=qt(te.messages[0].data);{ke[3]=[];var Oe=[];l.forEach(function(W,nt){Oe[1]=[{type:0,data:Qt(nt)}],Oe[2]=[{type:0,data:Qt(1)}],Oe[3]=[{type:2,data:Nz(W)}],ke[3].push({type:2,data:xn(Oe)})})}te.messages[0].data=xn(ke);var _e=Cc(ee),Be=Rc(_e);X.content=Be,X.size=X.content.length})();var ue=qt(O[3][0].data);{var Ue=ue[1][0];delete ue[2];var ie=qt(Ue.data);{var K=Cn(ie[2][0].data);(function(){for(var X=Je.find(d,u[K].location),ee=La(Ua(X.content)),te,le=0;le<ee.length;++le){var Ne=ee[le];Ne.id==K&&(te=Ne)}var ke=qt(te.messages[0].data);{delete ke[6],delete ue[7];var Oe=new Uint8Array(ke[5][0].data);ke[5]=[];for(var _e=0,Be=0;Be<=n.e.r;++Be){var W=qt(Oe);_e+=qz(W,o[Be],l),W[1][0].data=Qt(Be),ke[5].push({data:xn(W),type:2})}ke[1]=[{type:0,data:Qt(n.e.c+1)}],ke[2]=[{type:0,data:Qt(n.e.r+1)}],ke[3]=[{type:0,data:Qt(_e)}],ke[4]=[{type:0,data:Qt(n.e.r+1)}]}te.messages[0].data=xn(ke);var nt=Cc(ee),it=Rc(nt);X.content=it,X.size=X.content.length})()}Ue.data=xn(ie)}O[3][0].data=xn(ue)}P[4][0].data=xn(O)}E.messages[0].data=xn(P);var pe=Cc(_),V=Rc(pe);return v.content=V,v.size=v.content.length,d}function J4(t){return function(r){for(var n=0;n!=t.length;++n){var a=t[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function zv(t){J4([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function Gv(t){J4([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function Xz(t){return Ct.WS.indexOf(t)>-1?"sheet":t==Ct.CS?"chart":t==Ct.DS?"dialog":t==Ct.MS?"macro":t&&t.length?t:"sheet"}function Kz(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,Xz(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function Yz(t,e,r,n,a,o,l,u,h,d,p,v){try{o[n]=Mf(va(t,r,!0),e);var _=Gr(t,e),E;switch(u){case"sheet":E=xH(_,e,a,h,o[n],d,p,v);break;case"chart":if(E=vH(_,e,a,h,o[n],d,p,v),!E||!E["!drawel"])break;var S=Sf(E["!drawel"].Target,e),y=r0(S),w=aU(va(t,S,!0),Mf(va(t,y,!0),S)),P=Sf(w,S),B=r0(P);E=qj(va(t,P,!0),P,h,Mf(va(t,B,!0),P),d,E);break;case"macro":E=_H(_,e,a,h,o[n],d,p,v);break;case"dialog":E=yH(_,e,a,h,o[n],d,p,v);break;default:throw new Error("Unrecognized sheet type "+u)}l[n]=E;var N=[];o&&o[n]&&Cr(o[n]).forEach(function(z){var q="";if(o[n][z].Type==Ct.CMNT){q=Sf(o[n][z].Target,e);var Z=SH(Gr(t,q,!0),q,h);if(!Z||!Z.length)return;Hw(E,Z,!1)}o[n][z].Type==Ct.TCMNT&&(q=Sf(o[n][z].Target,e),N=N.concat(sU(Gr(t,q,!0),h)))}),N&&N.length&&Hw(E,N,!0,h.people||[])}catch(z){if(h.WTF)throw z}}function Pa(t){return t.charAt(0)=="/"?t.slice(1):t}function $z(t,e){if(cu(),e=e||{},zv(e),Ba(t,"META-INF/manifest.xml")||Ba(t,"objectdata.xml"))return Jw(t,e);if(Ba(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof c1<"u"){if(t.FileIndex)return c1(t);var r=Je.utils.cfb_new();return cw(t).forEach(function(Ee){Tt(r,Ee,oP(t,Ee))}),c1(r)}throw new Error("Unsupported NUMBERS file")}if(!Ba(t,"[Content_Types].xml"))throw Ba(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Ba(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=cw(t),a=eM(va(t,"[Content_Types].xml")),o=!1,l,u;if(a.workbooks.length===0&&(u="xl/workbook.xml",Gr(t,u,!0)&&a.workbooks.push(u)),a.workbooks.length===0){if(u="xl/workbook.bin",!Gr(t,u,!0))throw new Error("Could not find workbook");a.workbooks.push(u),o=!0}a.workbooks[0].slice(-3)=="bin"&&(o=!0);var h={},d={};if(!e.bookSheets&&!e.bookProps){if(Lf=[],a.sst)try{Lf=wH(Gr(t,Pa(a.sst)),a.sst,e)}catch(Ee){if(e.WTF)throw Ee}e.cellStyles&&a.themes.length&&(h=TH(va(t,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],e)),a.style&&(d=EH(Gr(t,Pa(a.style)),a.style,h,e))}a.links.map(function(Ee){try{var Te=Mf(va(t,r0(Pa(Ee))),Ee);return bH(Gr(t,Pa(Ee)),Te,Ee,e)}catch{}});var p=gH(Gr(t,Pa(a.workbooks[0])),a.workbooks[0],e),v={},_="";a.coreprops.length&&(_=Gr(t,Pa(a.coreprops[0]),!0),_&&(v=jk(_)),a.extprops.length!==0&&(_=Gr(t,Pa(a.extprops[0]),!0),_&&oM(_,v,e)));var E={};(!e.bookSheets||e.bookProps)&&a.custprops.length!==0&&(_=va(t,Pa(a.custprops[0]),!0),_&&(E=cM(_,e)));var S={};if((e.bookSheets||e.bookProps)&&(p.Sheets?l=p.Sheets.map(function(Te){return Te.name}):v.Worksheets&&v.SheetNames.length>0&&(l=v.SheetNames),e.bookProps&&(S.Props=v,S.Custprops=E),e.bookSheets&&typeof l<"u"&&(S.SheetNames=l),e.bookSheets?S.SheetNames:e.bookProps))return S;l={};var y={};e.bookDeps&&a.calcchain&&(y=AH(Gr(t,Pa(a.calcchain)),a.calcchain));var w=0,P={},B,N;{var z=p.Sheets;v.Worksheets=z.length,v.SheetNames=[];for(var q=0;q!=z.length;++q)v.SheetNames[q]=z[q].name}var Z=o?"bin":"xml",C=a.workbooks[0].lastIndexOf("/"),I=(a.workbooks[0].slice(0,C+1)+"_rels/"+a.workbooks[0].slice(C+1)+".rels").replace(/^\//,"");Ba(t,I)||(I="xl/_rels/workbook."+Z+".rels");var b=Mf(va(t,I,!0),I.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(e.xlmeta=kH(Gr(t,Pa(a.metadata[0])),a.metadata[0],e)),(a.people||[]).length>=1&&(e.people=lU(Gr(t,Pa(a.people[0])),e)),b&&(b=Kz(b,p.Sheets));var O=Gr(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=v.Worksheets;++w){var L="sheet";if(b&&b[w]?(B="xl/"+b[w][1].replace(/[\/]?xl\//,""),Ba(t,B)||(B=b[w][1]),Ba(t,B)||(B=I.replace(/_rels\/.*$/,"")+b[w][1]),L=b[w][2]):(B="xl/worksheets/sheet"+(w+1-O)+"."+Z,B=B.replace(/sheet0\./,"sheet.")),N=B.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(w!=e.sheets)continue e;break;case"string":if(v.SheetNames[w].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var M=!1,D=0;D!=e.sheets.length;++D)typeof e.sheets[D]=="number"&&e.sheets[D]==w&&(M=1),typeof e.sheets[D]=="string"&&e.sheets[D].toLowerCase()==v.SheetNames[w].toLowerCase()&&(M=1);if(!M)continue e}}Yz(t,B,N,v.SheetNames[w],w,P,l,L,e,p,h,d)}return S={Directory:a,Workbook:p,Props:v,Custprops:E,Deps:y,Sheets:l,SheetNames:v.SheetNames,Strings:Lf,Styles:d,Themes:h,SSF:pr(tt)},e&&e.bookFiles&&(t.files?(S.keys=n,S.files=t.files):(S.keys=[],S.files={},t.FullPaths.forEach(function(Ee,Te){Ee=Ee.replace(/^Root Entry[\/]/,""),S.keys.push(Ee),S.files[Ee]=t.FileIndex[Te]}))),e&&e.bookVBA&&(a.vba.length>0?S.vbaraw=Gr(t,Pa(a.vba[0]),!0):a.defaults&&a.defaults.bin===gU&&(S.vbaraw=Gr(t,"xl/vbaProject.bin",!0))),S}function Qz(t,e){var r=e||{},n="Workbook",a=Je.find(t,n);try{if(n="/!DataSpaces/Version",a=Je.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(k9(a.content),n="/!DataSpaces/DataSpaceMap",a=Je.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=R9(a.content);if(o.length!==1||o[0].comps.length!==1||o[0].comps[0].t!==0||o[0].name!=="StrongEncryptionDataSpace"||o[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Je.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=I9(a.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Je.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);D9(a.content)}catch{}if(n="/EncryptionInfo",a=Je.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var u=O9(a.content);if(n="/EncryptedPackage",a=Je.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],a.content,r.password||"",r);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function Zz(t,e){return e.bookType=="ods"?Z4(t,e):e.bookType=="numbers"?Wz(t,e):e.bookType=="xlsb"?Jz(t,e):eG(t,e)}function Jz(t,e){Mc=1024,t&&!t.SSF&&(t.SSF=pr(tt)),t&&t.SSF&&(cu(),A0(t.SSF),e.revssf=Im(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Uf?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=b4.indexOf(e.bookType)>-1,a=Rv();Gv(e=e||{});var o=pv(),l="",u=0;if(e.cellXfs=[],Do(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),l="docProps/core.xml",Tt(o,l,Hk(t.Props,e)),a.coreprops.push(l),Zt(e.rels,2,l,Ct.CORE_PROPS),l="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var h=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&h.push(t.SheetNames[d]);t.Props.SheetNames=h}for(t.Props.Worksheets=t.Props.SheetNames.length,Tt(o,l,qk(t.Props)),a.extprops.push(l),Zt(e.rels,3,l,Ct.EXT_PROPS),t.Custprops!==t.Props&&Cr(t.Custprops||{}).length>0&&(l="docProps/custom.xml",Tt(o,l,Wk(t.Custprops)),a.custprops.push(l),Zt(e.rels,4,l,Ct.CUST_PROPS)),u=1;u<=t.SheetNames.length;++u){var p={"!id":{}},v=t.Sheets[t.SheetNames[u-1]],_=(v||{})["!type"]||"sheet";switch(_){case"chart":default:l="xl/worksheets/sheet"+u+"."+r,Tt(o,l,RH(u-1,l,e,t,p)),a.sheets.push(l),Zt(e.wbrels,-1,"worksheets/sheet"+u+"."+r,Ct.WS[0])}if(v){var E=v["!comments"],S=!1,y="";E&&E.length>0&&(y="xl/comments"+u+"."+r,Tt(o,y,DH(E,y)),a.comments.push(y),Zt(p,-1,"../comments"+u+"."+r,Ct.CMNT),S=!0),v["!legacy"]&&S&&Tt(o,"xl/drawings/vmlDrawing"+u+".vml",S4(u,v["!comments"])),delete v["!comments"],delete v["!legacy"]}p["!id"].rId1&&Tt(o,r0(l),Gc(p))}return e.Strings!=null&&e.Strings.length>0&&(l="xl/sharedStrings."+r,Tt(o,l,NH(e.Strings,l,e)),a.strs.push(l),Zt(e.wbrels,-1,"sharedStrings."+r,Ct.SST)),l="xl/workbook."+r,Tt(o,l,CH(t,l)),a.workbooks.push(l),Zt(e.rels,1,l,Ct.WB),l="xl/theme/theme1.xml",Tt(o,l,Pv(t.Themes,e)),a.themes.push(l),Zt(e.wbrels,-1,"theme/theme1.xml",Ct.THEME),l="xl/styles."+r,Tt(o,l,IH(t,l,e)),a.styles.push(l),Zt(e.wbrels,-1,"styles."+r,Ct.STY),t.vbaraw&&n&&(l="xl/vbaProject.bin",Tt(o,l,t.vbaraw),a.vba.push(l),Zt(e.wbrels,-1,"vbaProject.bin",Ct.VBA)),l="xl/metadata."+r,Tt(o,l,OH(l)),a.metadata.push(l),Zt(e.wbrels,-1,"metadata."+r,Ct.XLMETA),Tt(o,"[Content_Types].xml",Bk(a,e)),Tt(o,"_rels/.rels",Gc(e.rels)),Tt(o,"xl/_rels/workbook."+r+".rels",Gc(e.wbrels)),delete e.revssf,delete e.ssf,o}function eG(t,e){Mc=1024,t&&!t.SSF&&(t.SSF=pr(tt)),t&&t.SSF&&(cu(),A0(t.SSF),e.revssf=Im(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Uf?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=b4.indexOf(e.bookType)>-1,a=Rv();Gv(e=e||{});var o=pv(),l="",u=0;if(e.cellXfs=[],Do(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),l="docProps/core.xml",Tt(o,l,Hk(t.Props,e)),a.coreprops.push(l),Zt(e.rels,2,l,Ct.CORE_PROPS),l="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var h=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&h.push(t.SheetNames[d]);t.Props.SheetNames=h}t.Props.Worksheets=t.Props.SheetNames.length,Tt(o,l,qk(t.Props)),a.extprops.push(l),Zt(e.rels,3,l,Ct.EXT_PROPS),t.Custprops!==t.Props&&Cr(t.Custprops||{}).length>0&&(l="docProps/custom.xml",Tt(o,l,Wk(t.Custprops)),a.custprops.push(l),Zt(e.rels,4,l,Ct.CUST_PROPS));var p=["SheetJ5"];for(e.tcid=0,u=1;u<=t.SheetNames.length;++u){var v={"!id":{}},_=t.Sheets[t.SheetNames[u-1]],E=(_||{})["!type"]||"sheet";switch(E){case"chart":default:l="xl/worksheets/sheet"+u+"."+r,Tt(o,l,L4(u-1,e,t,v)),a.sheets.push(l),Zt(e.wbrels,-1,"worksheets/sheet"+u+"."+r,Ct.WS[0])}if(_){var S=_["!comments"],y=!1,w="";if(S&&S.length>0){var P=!1;S.forEach(function(B){B[1].forEach(function(N){N.T==!0&&(P=!0)})}),P&&(w="xl/threadedComments/threadedComment"+u+"."+r,Tt(o,w,oU(S,p,e)),a.threadedcomments.push(w),Zt(v,-1,"../threadedComments/threadedComment"+u+"."+r,Ct.TCMNT)),w="xl/comments"+u+"."+r,Tt(o,w,A4(S)),a.comments.push(w),Zt(v,-1,"../comments"+u+"."+r,Ct.CMNT),y=!0}_["!legacy"]&&y&&Tt(o,"xl/drawings/vmlDrawing"+u+".vml",S4(u,_["!comments"])),delete _["!comments"],delete _["!legacy"]}v["!id"].rId1&&Tt(o,r0(l),Gc(v))}return e.Strings!=null&&e.Strings.length>0&&(l="xl/sharedStrings."+r,Tt(o,l,h4(e.Strings,e)),a.strs.push(l),Zt(e.wbrels,-1,"sharedStrings."+r,Ct.SST)),l="xl/workbook."+r,Tt(o,l,H4(t)),a.workbooks.push(l),Zt(e.rels,1,l,Ct.WB),l="xl/theme/theme1.xml",Tt(o,l,Pv(t.Themes,e)),a.themes.push(l),Zt(e.wbrels,-1,"theme/theme1.xml",Ct.THEME),l="xl/styles."+r,Tt(o,l,y4(t,e)),a.styles.push(l),Zt(e.wbrels,-1,"styles."+r,Ct.STY),t.vbaraw&&n&&(l="xl/vbaProject.bin",Tt(o,l,t.vbaraw),a.vba.push(l),Zt(e.wbrels,-1,"vbaProject.bin",Ct.VBA)),l="xl/metadata."+r,Tt(o,l,w4()),a.metadata.push(l),Zt(e.wbrels,-1,"metadata."+r,Ct.XLMETA),p.length>1&&(l="xl/persons/person.xml",Tt(o,l,cU(p)),a.people.push(l),Zt(e.wbrels,-1,"persons/person.xml",Ct.PEOPLE)),Tt(o,"[Content_Types].xml",Bk(a,e)),Tt(o,"_rels/.rels",Gc(e.rels)),Tt(o,"xl/_rels/workbook."+r+".rels",Gc(e.wbrels)),delete e.revssf,delete e.ssf,o}function qv(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Ea(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function tG(t,e){return Je.find(t,"EncryptedPackage")?Qz(t,e):W4(t,e)}function rG(t,e){var r,n=t,a=e||{};return a.type||(a.type=bt&&Buffer.isBuffer(t)?"buffer":"base64"),r=mk(n,a),$z(r,a)}function eC(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return ex(t.slice(r),e);default:break e}return eu.to_workbook(t,e)}function nG(t,e){var r="",n=qv(t,e);switch(e.type){case"base64":r=Ea(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=Al(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=ar(r)),e.type="binary",eC(r,e)}function aG(t,e){var r=t;return e.type=="base64"&&(r=Ea(r)),r=$f.utils.decode(1200,r.slice(2),"str"),e.type="binary",eC(r,e)}function iG(t){return t.match(/[^\x00-\x7F]/)?Ci(t):t}function u1(t,e,r,n){return n?(r.type="string",eu.to_workbook(t,r)):eu.to_workbook(e,r)}function nx(t,e){uv();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return nx(new Uint8Array(t),(r=pr(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,a=[0,0,0,0],o=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Wc={},r.dateNF&&(Wc.dateNF=r.dateNF),r.type||(r.type=bt&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=bt?"buffer":"binary",n=J5(t),typeof Uint8Array<"u"&&!bt&&(r.type="array")),r.type=="string"&&(o=!0,r.type="binary",r.codepage=65001,n=iG(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),u=new Uint8Array(l);if(u.foo="bar",!u.foo)return r=pr(r),r.type="array",nx(fv(n),r)}switch((a=qv(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return tG(Je.read(n,r),r);break;case 9:if(a[1]<=8)return W4(n,r);break;case 60:return ex(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return u9(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return u4.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?rG(n,r):u1(t,n,r,o);case 239:return a[3]===60?ex(n,r):u1(t,n,r,o);case 255:if(a[1]===254)return aG(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return ml.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return ml.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return J1.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return x4.to_workbook(n,r);break;case 10:case 13:case 32:return nG(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return c9.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?J1.to_workbook(n,r):u1(t,n,r,o)}function tC(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return b0(e.file,Je.write(t,{type:bt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Je.write(t,e)}function sG(t,e){var r=pr(e||{}),n=Zz(t,r);return oG(n,r)}function oG(t,e){var r={},n=bt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var a=t.FullPaths?Je.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(e.type=="binary"||e.type=="base64")return a;a=new Uint8Array(Cm(a))}return e.password&&typeof encrypt_agile<"u"?tC(encrypt_agile(a,e.password),e):e.type==="file"?b0(e.file,a):e.type=="string"?ar(a):a}function lG(t,e){var r=e||{},n=iz(t,r);return tC(n,r)}function Si(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return Qf(Ci(n));case"binary":return Ci(n);case"string":return t;case"file":return b0(e.file,n,"utf8");case"buffer":return bt?_s(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Si(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function cG(t,e){switch(e.type){case"base64":return Qf(t);case"binary":return t;case"string":return t;case"file":return b0(e.file,t,"binary");case"buffer":return bt?_s(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function md(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?Qf(r):e.type=="string"?ar(r):r;case"file":return b0(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function rC(t,e){uv(),tH(t);var r=pr(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=rC(t,r);return r.type="array",Cm(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=t.SheetNames.indexOf(r.sheet),!t.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Si(ZH(t,r),r);case"slk":case"sylk":return Si(c4.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"htm":case"html":return Si(K4(t.Sheets[t.SheetNames[a]],r),r);case"txt":return cG(nC(t.Sheets[t.SheetNames[a]],r),r);case"csv":return Si(Wv(t.Sheets[t.SheetNames[a]],r),r,"\uFEFF");case"dif":return Si(u4.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"dbf":return md(J1.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"prn":return Si(eu.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"rtf":return Si(x4.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"eth":return Si(f4.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"fods":return Si(Z4(t,r),r);case"wk1":return md(ml.sheet_to_wk1(t.Sheets[t.SheetNames[a]],r),r);case"wk3":return md(ml.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),md(X4(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),lG(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return sG(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function uG(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function fG(t,e,r){var n={};return n.type="file",n.file=e,uG(n),rC(t,n)}function hG(t,e,r,n,a,o,l,u){var h=Pr(r),d=u.defval,p=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),v=!0,_=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(_,"__rowNum__",{value:r,enumerable:!1})}catch{_.__rowNum__=r}else _.__rowNum__=r;if(!l||t[r])for(var E=e.s.c;E<=e.e.c;++E){var S=l?t[r][E]:t[n[E]+h];if(S===void 0||S.t===void 0){if(d===void 0)continue;o[E]!=null&&(_[o[E]]=d);continue}var y=S.v;switch(S.t){case"z":if(y==null)break;continue;case"e":y=y==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+S.t)}if(o[E]!=null){if(y==null)if(S.t=="e"&&y===null)_[o[E]]=null;else if(d!==void 0)_[o[E]]=d;else if(p&&y===null)_[o[E]]=null;else continue;else _[o[E]]=p&&(S.t!=="n"||S.t==="n"&&u.rawNumbers!==!1)?y:vs(S,y,u);y!=null&&(v=!1)}}return{row:_,isempty:v}}function am(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,o=[],l=0,u="",h={s:{r:0,c:0},e:{r:0,c:0}},d=e||{},p=d.range!=null?d.range:t["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)?n=3:d.header==null&&(n=0),typeof p){case"string":h=Ht(p);break;case"number":h=Ht(t["!ref"]),h.s.r=p;break;default:h=p}n>0&&(a=0);var v=Pr(h.s.r),_=[],E=[],S=0,y=0,w=Array.isArray(t),P=h.s.r,B=0,N={};w&&!t[P]&&(t[P]=[]);var z=d.skipHidden&&t["!cols"]||[],q=d.skipHidden&&t["!rows"]||[];for(B=h.s.c;B<=h.e.c;++B)if(!(z[B]||{}).hidden)switch(_[B]=_r(B),r=w?t[P][B]:t[_[B]+v],n){case 1:o[B]=B-h.s.c;break;case 2:o[B]=_[B];break;case 3:o[B]=d.header[B-h.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),u=l=vs(r,null,d),y=N[l]||0,!y)N[l]=1;else{do u=l+"_"+y++;while(N[u]);N[l]=y,N[u]=1}o[B]=u}for(P=h.s.r+a;P<=h.e.r;++P)if(!(q[P]||{}).hidden){var Z=hG(t,h,P,_,n,o,w,d);(Z.isempty===!1||(n===1?d.blankrows!==!1:d.blankrows))&&(E[S++]=Z.row)}return E.length=S,E}var aS=/"/g;function dG(t,e,r,n,a,o,l,u){for(var h=!0,d=[],p="",v=Pr(r),_=e.s.c;_<=e.e.c;++_)if(n[_]){var E=u.dense?(t[r]||[])[_]:t[n[_]+v];if(E==null)p="";else if(E.v!=null){h=!1,p=""+(u.rawNumbers&&E.t=="n"?E.v:vs(E,null,u));for(var S=0,y=0;S!==p.length;++S)if((y=p.charCodeAt(S))===a||y===o||y===34||u.forceQuotes){p='"'+p.replace(aS,'""')+'"';break}p=="ID"&&(p='"ID"')}else E.f!=null&&!E.F?(h=!1,p="="+E.f,p.indexOf(",")>=0&&(p='"'+p.replace(aS,'""')+'"')):p="";d.push(p)}return u.blankrows===!1&&h?null:d.join(l)}function Wv(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var a=Ht(t["!ref"]),o=n.FS!==void 0?n.FS:",",l=o.charCodeAt(0),u=n.RS!==void 0?n.RS:`
`,h=u.charCodeAt(0),d=new RegExp((o=="|"?"\\|":o)+"+$"),p="",v=[];n.dense=Array.isArray(t);for(var _=n.skipHidden&&t["!cols"]||[],E=n.skipHidden&&t["!rows"]||[],S=a.s.c;S<=a.e.c;++S)(_[S]||{}).hidden||(v[S]=_r(S));for(var y=0,w=a.s.r;w<=a.e.r;++w)(E[w]||{}).hidden||(p=dG(t,a,w,v,l,h,o,n),p!=null&&(n.strip&&(p=p.replace(d,"")),(p||n.blankrows!==!1)&&r.push((y++?u:"")+p)));return delete n.dense,r.join("")}function nC(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=Wv(t,e);return r}function mG(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var a=Ht(t["!ref"]),o="",l=[],u,h=[],d=Array.isArray(t);for(u=a.s.c;u<=a.e.c;++u)l[u]=_r(u);for(var p=a.s.r;p<=a.e.r;++p)for(o=Pr(p),u=a.s.c;u<=a.e.c;++u)if(e=l[u]+o,r=d?(t[p]||[])[u]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}h[h.length]=e+"="+n}return h}function aC(t,e,r){var n=r||{},a=+!n.skipHeader,o=t||{},l=0,u=0;if(o&&n.origin!=null)if(typeof n.origin=="number")l=n.origin;else{var h=typeof n.origin=="string"?yr(n.origin):n.origin;l=h.r,u=h.c}var d,p={s:{c:0,r:0},e:{c:u,r:l+e.length-1+a}};if(o["!ref"]){var v=Ht(o["!ref"]);p.e.c=Math.max(p.e.c,v.e.c),p.e.r=Math.max(p.e.r,v.e.r),l==-1&&(l=v.e.r+1,p.e.r=l+e.length-1+a)}else l==-1&&(l=0,p.e.r=e.length-1+a);var _=n.header||[],E=0;e.forEach(function(y,w){Cr(y).forEach(function(P){(E=_.indexOf(P))==-1&&(_[E=_.length]=P);var B=y[P],N="z",z="",q=lt({c:u+E,r:l+w+a});d=c0(o,q),B&&typeof B=="object"&&!(B instanceof Date)?o[q]=B:(typeof B=="number"?N="n":typeof B=="boolean"?N="b":typeof B=="string"?N="s":B instanceof Date?(N="d",n.cellDates||(N="n",B=rn(B)),z=n.dateNF||tt[14]):B===null&&n.nullError&&(N="e",B=0),d?(d.t=N,d.v=B,delete d.w,delete d.R,z&&(d.z=z)):o[q]=d={t:N,v:B},z&&(d.z=z))})}),p.e.c=Math.max(p.e.c,u+_.length-1);var S=Pr(l);if(a)for(E=0;E<_.length;++E)o[_r(E+u)+S]={t:"s",v:_[E]};return o["!ref"]=yt(p),o}function pG(t,e){return aC(null,t,e)}function c0(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=yr(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?c0(t,lt(e)):c0(t,lt({r:e,c:r||0}))}function gG(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function Xv(){return{SheetNames:[],Sheets:{}}}function Kv(t,e,r,n){var a=1;if(!r)for(;a<=65535&&t.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var o=r.match(/(^.*?)(\d+)$/);a=o&&+o[2]||0;var l=o&&o[1]||r;for(++a;a<=65535&&t.SheetNames.indexOf(r=l+a)!=-1;++a);}if(j4(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function xG(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=gG(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function vG(t,e){return t.z=e,t}function iC(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function _G(t,e,r){return iC(t,"#"+e,r)}function yG(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function EG(t,e,r,n){for(var a=typeof e!="string"?e:Ht(e),o=typeof e=="string"?e:yt(e),l=a.s.r;l<=a.e.r;++l)for(var u=a.s.c;u<=a.e.c;++u){var h=c0(t,l,u);h.t="n",h.F=o,delete h.v,l==a.s.r&&u==a.s.c&&(h.f=r,n&&(h.D=!0))}return t}var pd={encode_col:_r,encode_row:Pr,encode_cell:lt,encode_range:yt,decode_col:wv,decode_row:Tv,split_cell:NP,decode_cell:yr,decode_range:aa,format_cell:vs,sheet_add_aoa:Dk,sheet_add_json:aC,sheet_add_dom:Y4,aoa_to_sheet:uu,json_to_sheet:pG,table_to_sheet:$4,table_to_book:kz,sheet_to_csv:Wv,sheet_to_txt:nC,sheet_to_json:am,sheet_to_html:K4,sheet_to_formulae:mG,sheet_to_row_object_array:am,sheet_get_cell:c0,book_new:Xv,book_append_sheet:Kv,book_set_sheet_visibility:xG,cell_set_number_format:vG,cell_set_hyperlink:iC,cell_set_internal_link:_G,cell_add_comment:yG,sheet_set_array_formula:EG,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const f1=["Unidade","Licena","N-Ano","Descrio","rgo licenciador","FCEI-N do processo","Data emisso","Vencimento","Observao"],TG=({open:t,onClose:e,branches:r,licenseTypes:n,onAddBranch:a,onImport:o})=>{const l=Qe.useRef(null),[u,h]=Qe.useState(!1),[d,p]=Qe.useState(null),v=()=>{const S=pd.aoa_to_sheet([f1]),y=pd.book_new();pd.book_append_sheet(y,S,"Licenas"),fG(y,"modelo_licencas.xlsx")},_=async S=>{var w,P;const y=(w=S.target.files)==null?void 0:w[0];if(y){h(!0),p(null);try{const B=await y.arrayBuffer(),N=nx(B),z=N.Sheets[N.SheetNames[0]],q=pd.sheet_to_json(z,{header:1,defval:""});if(!q.length||q[0].length<f1.length){p("Arquivo invlido ou colunas insuficientes."),h(!1);return}const Z=q[0].map(O=>O.trim());if(JSON.stringify(Z)!==JSON.stringify(f1)){p("As colunas do arquivo no correspondem ao modelo."),h(!1);return}const C=q.slice(1).filter(O=>O.some(L=>L)),I={};for(const O of C){const L=(P=O[0])==null?void 0:P.trim();if(!L)continue;let M=r.find(D=>D.name.trim().toLowerCase()===L.toLowerCase());if(!M&&!I[L]){const Ee=await a({name:L,cnpj:"",address:"",city:"",state:"",contact:"",status:"Ativa"});I[L]=typeof Ee=="string"?Ee:""}else M&&(I[L]=M.id)}const b=C.map(O=>{var Te;const L=n.find(ne=>ne.name===O[1]),M=E(O[7]);let D="",Ee="";if(L&&M){const ne=new Date(M+"T00:00:00");if(ne.setDate(ne.getDate()-(L.renewalProtocolDays||0)),D=isNaN(ne.getTime())?"":ne.toISOString().slice(0,10),D&&L.processStartDays){const ue=new Date(D+"T00:00:00");ue.setDate(ue.getDate()-(L.processStartDays||0)),Ee=isNaN(ue.getTime())?"":ue.toISOString().slice(0,10)}}return{unitId:I[(Te=O[0])==null?void 0:Te.trim()]||"",licenseType:O[1],numberYear:O[2],description:O[3],licensingAgency:O[4],processNumber:O[5],issueDate:E(O[6]),originalExpiryDate:M,prorrogaDate:D,processStartDate:Ee,observation:O[8],active:!0,inactiveObservation:""}});if(b.some(O=>!O.unitId||!O.licenseType)){p("Algumas linhas esto sem Unidade ou Licena."),h(!1);return}await o(b),p("Licenas importadas com sucesso!")}catch(B){p("Erro ao importar: "+B.message)}h(!1)}};function E(S){if(!S)return"";if(typeof S=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(S))return S;if(typeof S=="number"){const y=lk.parse_date_code(S);if(!y)return"";const w=String(y.m).padStart(2,"0"),P=String(y.d).padStart(2,"0");return`${y.y}-${w}-${P}`}return""}return t?A.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-30",children:A.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 w-full max-w-md relative",children:[A.jsx("button",{className:"absolute top-2 right-2 text-gray-400 hover:text-gray-700",onClick:e,children:""}),A.jsx("h3",{className:"text-lg font-bold mb-4",children:"Importar Licenas"}),A.jsxs("div",{className:"space-y-4",children:[A.jsx("button",{onClick:v,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Baixar modelo Excel"}),A.jsx("div",{children:A.jsx("input",{type:"file",accept:".xlsx,.xls",ref:l,onChange:_,disabled:u,className:"block w-full text-sm text-gray-700"})}),u&&A.jsx("div",{className:"text-blue-600",children:"Importando..."}),d&&A.jsx("div",{className:"text-sm text-center",style:{color:d.includes("sucesso")?"green":"red"},children:d})]})]})}):null},h1={unitId:"",licenseType:"",numberYear:"",description:"",licensingAgency:"",processNumber:"",issueDate:"",originalExpiryDate:"",prorrogaDate:"",processStartDate:"",observation:"",active:!0,inactiveObservation:"",category:"Ambiental",responsible:"",fileUrl:"",fileName:""},sC=[{label:"Unidade",key:"unitId",visible:!0},{label:"Licena",key:"licenseType",visible:!0},{label:"N/Ano",key:"numberYear",visible:!0},{label:"Descrio",key:"description",visible:!0},{label:"rgo Licenciador",key:"licensingAgency",visible:!0},{label:"FCEI-N do Processo",key:"processNumber",visible:!0},{label:"Responsvel",key:"responsible",visible:!0},{label:"Arquivo",key:"fileUrl",visible:!0},{label:"Data Emisso",key:"issueDate",visible:!0},{label:"Data Vencimento",key:"originalExpiryDate",visible:!0},{label:"Prazo Prorrogao",key:"prorrogaDate",visible:!0},{label:"Incio Processo",key:"processStartDate",visible:!0},{label:"Alerta",key:"alert",visible:!0},{label:"Observao",key:"observation",visible:!0},{label:"Aes",key:"actions",visible:!0}];function wG(){const t=localStorage.getItem("licenseTableColumns");return t?JSON.parse(t):sC}const iS=({licenses:t,branches:e,licenseTypes:r,onAddLicense:n,onUpdateLicense:a,onDeleteLicense:o,onAddBranch:l,category:u="Ambiental"})=>{const[h,d]=Qe.useState(h1),[p,v]=Qe.useState(!1),[_,E]=Qe.useState(null),[S,y]=Qe.useState(!1),[w,P]=Qe.useState({branchId:"",licenseType:"",onlyAlert:!1}),[B,N]=Qe.useState({key:"originalExpiryDate",direction:"asc"}),[z,q]=Qe.useState(!1),[Z,C]=Qe.useState(!1),[I,b]=Qe.useState(wG()),[O,L]=Qe.useState(()=>{const me=localStorage.getItem("licenseTableColWidths");return me?JSON.parse(me):{}}),[M,D]=Qe.useState(!1);Qe.useEffect(()=>{localStorage.setItem("licenseTableColumns",JSON.stringify(I))},[I]),Qe.useEffect(()=>{localStorage.setItem("licenseTableColWidths",JSON.stringify(O))},[O]);function Ee(me){b(We=>We.map((je,ot)=>ot===me?{...je,visible:!je.visible}:je))}function Te(me,We){b(je=>{const ot=[...je],[Nt]=ot.splice(me,1);return ot.splice(We,0,Nt),ot})}function ne(){b(sC)}const ue=()=>{E(null),d({...h1,category:u}),v(!0)},Ue=me=>{E(me);const{id:We,...je}=me;d(je),v(!0)},ie=()=>{v(!1),E(null),d(h1)},K=me=>{const{name:We,value:je}=me.target;d(ot=>{let Nt={...ot,[We]:je};if(We==="originalExpiryDate"||We==="licenseType"){const mt=r.find(pt=>pt.name===(We==="licenseType"?je:ot.licenseType)),vt=We==="originalExpiryDate"?je:ot.originalExpiryDate;if(mt&&vt){const pt=new Date(vt+"T00:00:00");if(pt.setDate(pt.getDate()-(mt.renewalProtocolDays||0)),Nt.prorrogaDate=isNaN(pt.getTime())?"":pt.toISOString().slice(0,10),Nt.prorrogaDate&&mt.processStartDays){const Ft=new Date(Nt.prorrogaDate+"T00:00:00");Ft.setDate(Ft.getDate()-(mt.processStartDays||0)),Nt.processStartDate=isNaN(Ft.getTime())?"":Ft.toISOString().slice(0,10)}else Nt.processStartDate=""}else Nt.prorrogaDate="",Nt.processStartDate=""}return Nt})},pe=me=>{if(me.preventDefault(),!h.unitId||!h.licenseType){alert("Por favor, selecione uma unidade e um tipo de licena.");return}_?a({...h,id:_.id}):n(h),ie()},V=me=>{var We;return((We=e.find(je=>je.id===me))==null?void 0:We.name)||"Desconhecida"},X=me=>{const We=new Date;We.setHours(0,0,0,0);const ot=new Date(me+"T00:00:00").getTime()-We.getTime();return Math.ceil(ot/(1e3*60*60*24))},ee=me=>{N(We=>We.key===me?{key:me,direction:We.direction==="asc"?"desc":"asc"}:{key:me,direction:"asc"})};function te(me,We){if(["issueDate","originalExpiryDate","prorrogaDate","processStartDate"].includes(We))return me[We]?new Date(me[We]):new Date(0);if(We==="alert"){const je=X(me.originalExpiryDate),ot=r.find(mt=>mt.name===me.licenseType),Nt=ot?(ot.renewalProtocolDays||0)+(ot.processStartDays||0):180;return je<0?0:je<=Nt?1:2}return(me[We]||"").toString().toLowerCase()}function le(me,We){L(je=>({...je,[me]:Math.max(80,We)}))}const Ne=[...e].sort((me,We)=>me.name.localeCompare(We.name)),ke=[...r].sort((me,We)=>me.name.localeCompare(We.name)),Be=[...t.filter(me=>me.active).filter(me=>(!w.branchId||me.unitId===w.branchId)&&(!w.licenseType||me.licenseType===w.licenseType)&&(!w.onlyAlert||te(me,"alert")!==2)&&(u==="Ambiental"?!me.category||me.category==="Ambiental":me.category===u))].sort((me,We)=>{const je=te(me,B.key),ot=te(We,B.key);return je<ot?B.direction==="asc"?-1:1:je>ot?B.direction==="asc"?1:-1:0}),W=(me,We)=>{const je=X(me),ot=r.find(mt=>mt.name===We),Nt=ot?(ot.renewalProtocolDays||0)+(ot.processStartDays||0):180;return je<0?A.jsxs("span",{className:"px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800",children:["Vencida h ",Math.abs(je)," dia(s)"]}):je<=Nt?A.jsxs("span",{className:"px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800",children:["Vence em ",je," dia(s)"]}):A.jsx("span",{className:"px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:"Ativa"})},[nt,it]=Qe.useState(null),[wt,st]=Qe.useState(!1);function Le(me,We){if(wt){me.preventDefault();return}it(We),me.dataTransfer.effectAllowed="move"}function ir(me,We){me.preventDefault(),me.dataTransfer.dropEffect="move"}function Lr(me,We){if(me.preventDefault(),nt===null||nt===We)return;const je=I.filter(pt=>pt.visible),ot=je[nt],Nt=je[We],mt=I.findIndex(pt=>pt.key===ot.key),vt=I.findIndex(pt=>pt.key===Nt.key);Te(mt,vt),it(null)}const Kr=async me=>{if(me.target.files&&me.target.files[0]){const We=me.target.files[0];D(!0);try{const je=d5(v5,`licenses/${Date.now()}_${We.name}`),ot=await f5(je,We),Nt=await h5(ot.ref);d(mt=>({...mt,fileUrl:Nt,fileName:We.name}))}catch(je){console.error("Error uploading file: ",je),alert("Erro ao fazer upload do arquivo.")}finally{D(!1)}}};return A.jsxs("div",{className:"space-y-6",children:[A.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg",children:[A.jsxs("div",{className:"flex justify-between items-center mb-4",children:[A.jsxs("h2",{className:"text-2xl font-bold text-gray-700 dark:text-white flex items-center gap-2",children:[_?"Editar Licena":"Cadastro de Licenas",A.jsx("button",{type:"button",onClick:()=>y(me=>!me),className:"ml-2 p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition",children:A.jsx(Yb,{})}),A.jsx("button",{type:"button",onClick:()=>C(!0),className:"ml-2 p-2 rounded hover:bg-gray-100 transition",title:"Configurar colunas",children:A.jsx(y5,{})})]}),A.jsxs("div",{className:"flex items-center gap-2",children:[A.jsx("button",{type:"button",onClick:()=>q(!0),className:"p-2 rounded hover:bg-gray-100 transition",title:"Importar planilha",children:A.jsx(_5,{})}),A.jsx("button",{onClick:p?ie:ue,className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white font-semibold rounded-lg hover:bg-blue-600 transition-transform transform hover:scale-105",children:p?"Fechar Formulrio":A.jsxs(A.Fragment,{children:[A.jsx(bm,{})," Nova Licena"]})})]})]}),S&&A.jsxs("div",{className:"mb-4 bg-gray-50 dark:bg-gray-700/60 border border-gray-200 dark:border-gray-600 rounded-lg p-4 flex flex-col md:flex-row gap-4 items-center",children:[A.jsxs("div",{className:"flex flex-col",children:[A.jsx("label",{className:"text-xs font-semibold text-gray-600 dark:text-gray-200 mb-1",children:"Filtrar por Filial"}),A.jsxs("select",{value:w.branchId,onChange:me=>P(We=>({...We,branchId:me.target.value})),className:"p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-100",children:[A.jsx("option",{value:"",children:"Todas"}),Ne.map(me=>A.jsx("option",{value:me.id,children:me.name},me.id))]})]}),A.jsxs("div",{className:"flex flex-col",children:[A.jsx("label",{className:"text-xs font-semibold text-gray-600 dark:text-gray-200 mb-1",children:"Filtrar por Tipo de Licena"}),A.jsxs("select",{value:w.licenseType,onChange:me=>P(We=>({...We,licenseType:me.target.value})),className:"p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-100",children:[A.jsx("option",{value:"",children:"Todas"}),ke.map(me=>A.jsx("option",{value:me.name,children:me.name},me.id))]})]}),A.jsxs("div",{className:"flex flex-col",children:[A.jsx("label",{className:"text-xs font-semibold text-gray-600 dark:text-gray-200 mb-1",children:""}),A.jsxs("label",{className:"inline-flex items-center text-sm text-gray-700 dark:text-gray-200",children:[A.jsx("input",{type:"checkbox",checked:w.onlyAlert,onChange:me=>P(We=>({...We,onlyAlert:me.target.checked})),className:"mr-2 accent-blue-600"}),"Mostrar apenas licenas em alerta"]})]}),A.jsx("button",{onClick:()=>P({branchId:"",licenseType:"",onlyAlert:!1}),className:"mt-4 md:mt-6 px-4 py-2 bg-gray-300 dark:bg-gray-600 text-gray-700 dark:text-gray-100 rounded hover:bg-gray-400 dark:hover:bg-gray-500 transition",children:"Limpar Filtros"})]}),p&&A.jsxs("form",{onSubmit:pe,className:"grid grid-cols-1 md:grid-cols-2 gap-6 animate-fade-in",children:[A.jsxs("div",{className:"flex flex-col",children:[A.jsx("label",{htmlFor:"unitId",className:"mb-1 font-semibold text-gray-600",children:"Unidade"}),A.jsxs("select",{name:"unitId",id:"unitId",value:h.unitId,onChange:K,required:!0,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition",children:[A.jsx("option",{value:"",disabled:!0,children:"Selecione uma Filial"}),Ne.map(me=>A.jsx("option",{value:me.id,children:me.name},me.id))]})]}),A.jsxs("div",{className:"flex flex-col",children:[A.jsx("label",{htmlFor:"licenseType",className:"mb-1 font-semibold text-gray-600",children:"Licena"}),A.jsxs("select",{name:"licenseType",id:"licenseType",value:h.licenseType,onChange:K,required:!0,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition",children:[A.jsx("option",{value:"",disabled:!0,children:"Selecione o tipo"}),ke.map(me=>A.jsx("option",{value:me.name,children:me.name},me.id))]})]}),A.jsxs("div",{className:"flex flex-col",children:[A.jsx("label",{htmlFor:"numberYear",className:"mb-1 font-semibold text-gray-600",children:"N/Ano"}),A.jsx("input",{type:"text",name:"numberYear",id:"numberYear",value:h.numberYear,onChange:K,required:!0,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition"})]}),A.jsxs("div",{className:"flex flex-col",children:[A.jsx("label",{htmlFor:"description",className:"mb-1 font-semibold text-gray-600",children:"Descrio"}),A.jsx("textarea",{name:"description",id:"description",value:h.description,onChange:K,rows:2,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition"})]}),A.jsxs("div",{className:"flex flex-col",children:[A.jsx("label",{htmlFor:"licensingAgency",className:"mb-1 font-semibold text-gray-600",children:"rgo Licenciador"}),A.jsx("input",{type:"text",name:"licensingAgency",id:"licensingAgency",value:h.licensingAgency,onChange:K,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition"})]}),A.jsxs("div",{className:"flex flex-col",children:[A.jsx("label",{htmlFor:"processNumber",className:"mb-1 font-semibold text-gray-600",children:"FCEI-N do Processo"}),A.jsx("input",{type:"text",name:"processNumber",id:"processNumber",value:h.processNumber,onChange:K,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition"})]}),A.jsxs("div",{className:"flex flex-col",children:[A.jsx("label",{htmlFor:"responsible",className:"mb-1 font-semibold text-gray-600",children:"Responsvel"}),A.jsx("input",{type:"text",name:"responsible",id:"responsible",value:h.responsible||"",onChange:K,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition"})]}),A.jsxs("div",{className:"flex flex-col",children:[A.jsx("label",{htmlFor:"file",className:"mb-1 font-semibold text-gray-600",children:"Anexar Arquivo"}),A.jsxs("div",{className:"flex items-center gap-2",children:[A.jsx("input",{type:"file",id:"file",onChange:Kr,className:"p-2 border border-gray-300 rounded-lg w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100",disabled:M}),M&&A.jsx("span",{className:"text-sm text-blue-500",children:"Enviando..."})]}),h.fileName&&A.jsxs("span",{className:"text-xs text-green-600 mt-1",children:["Arquivo atual: ",h.fileName]})]}),A.jsxs("div",{className:"flex flex-col",children:[A.jsx("label",{htmlFor:"issueDate",className:"mb-1 font-semibold text-gray-600",children:"Data Emisso"}),A.jsx("input",{type:"date",name:"issueDate",id:"issueDate",value:h.issueDate,onChange:K,required:!0,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition"})]}),A.jsxs("div",{className:"flex flex-col",children:[A.jsx("label",{htmlFor:"originalExpiryDate",className:"mb-1 font-semibold text-gray-600",children:"Data Vencimento"}),A.jsx("input",{type:"date",name:"originalExpiryDate",id:"originalExpiryDate",value:h.originalExpiryDate,onChange:K,required:!0,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition"})]}),A.jsxs("div",{className:"flex flex-col",children:[A.jsx("label",{htmlFor:"prorrogaDate",className:"mb-1 font-semibold text-gray-600",children:"Prazo para Prorrogao"}),A.jsx("input",{type:"date",name:"prorrogaDate",id:"prorrogaDate",value:h.prorrogaDate,onChange:K,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition"})]}),A.jsxs("div",{className:"flex flex-col",children:[A.jsx("label",{htmlFor:"processStartDate",className:"mb-1 font-semibold text-gray-600",children:"Incio do Processo"}),A.jsx("input",{type:"date",name:"processStartDate",id:"processStartDate",value:h.processStartDate,onChange:K,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition"})]}),A.jsxs("div",{className:"flex items-center md:col-span-2",children:[A.jsx("input",{type:"checkbox",id:"active",name:"active",checked:h.active,onChange:me=>d(We=>({...We,active:me.target.checked,inactiveObservation:me.target.checked?"":We.inactiveObservation})),className:"mr-2"}),A.jsx("label",{htmlFor:"active",className:"font-semibold text-gray-600",children:"Licena Vigente"})]}),!h.active&&A.jsxs("div",{className:"md:col-span-2 flex flex-col",children:[A.jsx("label",{htmlFor:"inactiveObservation",className:"mb-1 font-semibold text-gray-600",children:"Observao da Desativao"}),A.jsx("textarea",{name:"inactiveObservation",id:"inactiveObservation",value:h.inactiveObservation,onChange:K,rows:2,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition",required:!h.active})]}),A.jsxs("div",{className:"md:col-span-2 flex flex-col",children:[A.jsx("label",{htmlFor:"observation",className:"mb-1 font-semibold text-gray-600",children:"Observao"}),A.jsx("textarea",{name:"observation",id:"observation",value:h.observation,onChange:K,rows:2,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition"})]}),A.jsxs("div",{className:"md:col-span-2 flex justify-end gap-4",children:[A.jsx("button",{type:"button",onClick:ie,className:"px-6 py-3 bg-gray-500 text-white font-bold rounded-lg hover:bg-gray-600 transition-colors",children:"Cancelar"}),A.jsx("button",{type:"submit",className:"px-6 py-3 bg-green-500 text-white font-bold rounded-lg hover:bg-green-600 transition-colors",children:_?"Salvar Alteraes":"Salvar Licena"})]})]})]}),A.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg",children:[A.jsx("h2",{className:"text-2xl font-bold text-gray-700 dark:text-white mb-4",children:"Licenas Registradas"}),A.jsx("div",{className:"overflow-x-auto table-scrollbar",style:{transform:"rotateX(180deg)"},children:A.jsxs("table",{className:"min-w-full bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700 table-fixed",style:{transform:"rotateX(180deg)"},children:[A.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:A.jsx("tr",{children:I.filter(me=>me.visible).map((me,We)=>A.jsxs("th",{draggable:me.key!=="actions"&&!wt,onDragStart:je=>Le(je,We),onDragOver:je=>ir(je),onDrop:je=>Lr(je,We),className:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider select-none relative group border-r border-transparent hover:border-gray-300 transition-colors ${nt===We?"opacity-50 bg-gray-100":""}`,style:{width:O[me.key]?O[me.key]+"px":void 0,minWidth:80,cursor:me.key!=="actions"?"grab":"default"},onClick:me.key&&me.key!=="alert"&&me.key!=="actions"?()=>ee(me.key):void 0,children:[A.jsxs("div",{className:"flex items-center justify-between",children:[A.jsx("span",{className:"truncate",title:me.label,children:me.label}),me.key&&B.key===me.key&&A.jsx("span",{className:"ml-1 flex-shrink-0",children:B.direction==="asc"?"":""})]}),me.key!=="actions"&&me.key!=="alert"&&A.jsx("div",{className:"absolute right-0 top-0 h-full w-4 cursor-col-resize hover:bg-blue-400/20 z-10 flex justify-end",onMouseDown:je=>{je.stopPropagation(),je.preventDefault(),st(!0);const ot=je.clientX,Nt=je.currentTarget.parentElement;if(!Nt)return;const mt=Nt.offsetWidth;function vt(Ft){le(String(me.key),mt+(Ft.clientX-ot))}function pt(){st(!1),window.removeEventListener("mousemove",vt),window.removeEventListener("mouseup",pt)}window.addEventListener("mousemove",vt),window.addEventListener("mouseup",pt)},title:"Arraste para redimensionar",children:A.jsx("div",{className:"w-1 h-full bg-transparent hover:bg-blue-400 transition-colors"})})]},me.key))})}),A.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:Be.map((me,We)=>A.jsx("tr",{className:"bg-white dark:bg-gray-800 transition-all duration-200 ease-out hover:bg-gray-50 hover:shadow-md hover:-translate-y-0.5 dark:hover:bg-gray-700",children:I.filter(je=>je.visible).map((je,ot)=>{switch(je.key){case"unitId":return A.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white overflow-hidden text-ellipsis",children:V(me.unitId)},je.key);case"licenseType":return A.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300 overflow-hidden text-ellipsis",children:me.licenseType},je.key);case"numberYear":return A.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300 overflow-hidden text-ellipsis",children:me.numberYear},je.key);case"description":return A.jsx("td",{className:"px-6 py-4 whitespace-normal text-sm text-gray-600 dark:text-gray-300 overflow-hidden text-ellipsis",children:me.description},je.key);case"licensingAgency":return A.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300 overflow-hidden text-ellipsis",children:me.licensingAgency},je.key);case"processNumber":return A.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300 overflow-hidden text-ellipsis",children:me.processNumber},je.key);case"responsible":return A.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300 overflow-hidden text-ellipsis",children:me.responsible||"-"},je.key);case"fileUrl":return A.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300 overflow-hidden text-ellipsis",children:me.fileUrl?A.jsxs("a",{href:me.fileUrl,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline flex items-center gap-1",children:[" ",A.jsx("span",{className:"truncate max-w-[100px]",children:me.fileName||"Arquivo"})]}):"-"},je.key);case"issueDate":return A.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300 overflow-hidden text-ellipsis",children:me.issueDate?new Date(me.issueDate+"T00:00:00").toLocaleDateString("pt-BR"):""},je.key);case"originalExpiryDate":return A.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300 overflow-hidden text-ellipsis",children:me.originalExpiryDate?new Date(me.originalExpiryDate+"T00:00:00").toLocaleDateString("pt-BR"):""},je.key);case"prorrogaDate":return A.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300 overflow-hidden text-ellipsis",children:me.prorrogaDate?new Date(me.prorrogaDate+"T00:00:00").toLocaleDateString("pt-BR"):""},je.key);case"processStartDate":return A.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300 overflow-hidden text-ellipsis",children:me.processStartDate?new Date(me.processStartDate+"T00:00:00").toLocaleDateString("pt-BR"):""},je.key);case"alert":return A.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:W(me.originalExpiryDate,me.licenseType)},je.key);case"observation":return A.jsx("td",{className:"px-6 py-4 whitespace-normal text-sm text-gray-600 dark:text-gray-300 overflow-hidden text-ellipsis",children:me.active?me.observation:me.inactiveObservation},je.key);case"actions":return A.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:A.jsxs("div",{className:"flex items-center gap-2",children:[A.jsx("button",{onClick:()=>Ue(me),className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300 transition-colors",children:A.jsx(S0,{})}),A.jsx("button",{onClick:()=>o(me.id),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300 transition-colors",children:A.jsx(km,{})})]})},je.key);default:return null}})},me.id))})]})})]}),A.jsx(TG,{open:z,onClose:()=>q(!1),branches:e,licenseTypes:r,onAddBranch:l,onImport:async me=>{for(const We of me)await n(We);q(!1)}}),Z&&A.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-30",children:A.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 w-full max-w-md relative",children:[A.jsx("button",{className:"absolute top-2 right-2 text-gray-400 hover:text-gray-700",onClick:()=>C(!1),children:""}),A.jsx("h3",{className:"text-lg font-bold mb-4",children:"Configurar Colunas"}),A.jsx("div",{className:"space-y-2",children:I.map((me,We)=>A.jsxs("div",{className:"flex items-center gap-2 cursor-move",draggable:!0,onDragStart:je=>je.dataTransfer.setData("colIdx",String(We)),onDrop:je=>{je.preventDefault(),Te(Number(je.dataTransfer.getData("colIdx")),We)},onDragOver:je=>je.preventDefault(),children:[A.jsx("input",{type:"checkbox",checked:me.visible,onChange:()=>Ee(We),id:`col-${me.key}`}),A.jsx("label",{htmlFor:`col-${me.key}`,children:me.label}),A.jsx("span",{className:"ml-auto text-gray-400",children:""})]},me.key))}),A.jsx("button",{onClick:ne,className:"mt-4 px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400 transition",children:"Restaurar padro"})]})})]})},d1={name:"",renewalProtocolDays:0,processStartDays:0},SG=({licenseTypes:t,onAddLicenseType:e,onUpdateLicenseType:r,onDeleteLicenseType:n})=>{const[a,o]=Qe.useState(d1),[l,u]=Qe.useState(!1),[h,d]=Qe.useState(null),[p,v]=Qe.useState({key:"name",direction:"asc"}),_=()=>{d(null),o(d1),u(!0)},E=z=>{d(z);const{id:q,...Z}=z;o(Z),u(!0)},S=()=>{u(!1),d(null),o(d1)},y=z=>{const{name:q,value:Z}=z.target;o(C=>({...C,[q]:z.target.type==="number"?parseInt(Z,10)||0:Z}))},w=z=>{z.preventDefault(),h?r({...a,id:h.id}):e(a),S()},P=z=>{v(q=>q.key===z?{key:z,direction:q.direction==="asc"?"desc":"asc"}:{key:z,direction:"asc"})};function B(z,q){return(z[q]||"").toString().toLowerCase()}const N=[...t].sort((z,q)=>{const Z=B(z,p.key),C=B(q,p.key);return Z<C?p.direction==="asc"?-1:1:Z>C?p.direction==="asc"?1:-1:0});return A.jsxs("div",{className:"space-y-6",children:[A.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg dark:bg-gray-900 dark:border dark:border-gray-700",children:[A.jsxs("div",{className:"flex justify-between items-center mb-4",children:[A.jsx("h2",{className:"text-2xl font-bold text-gray-700 dark:text-gray-200",children:h?"Editar Tipo de Licena":"Cadastro de Tipos de Licena"}),A.jsx("button",{onClick:l?S:_,className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white font-semibold rounded-lg hover:bg-blue-600 transition-transform transform hover:scale-105",children:l?"Fechar Formulrio":A.jsxs(A.Fragment,{children:[A.jsx(bm,{})," Novo Tipo de Licena"]})})]}),l&&A.jsxs("form",{onSubmit:w,className:"grid grid-cols-1 md:grid-cols-3 gap-6 animate-fade-in",children:[A.jsxs("div",{className:"flex flex-col",children:[A.jsx("label",{htmlFor:"name",className:"mb-1 font-semibold text-gray-600 dark:text-gray-300",children:"Tipo de Licena"}),A.jsx("input",{type:"text",id:"name",name:"name",value:a.name,onChange:y,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition",required:!0})]}),A.jsxs("div",{className:"flex flex-col",children:[A.jsx("label",{htmlFor:"renewalProtocolDays",className:"mb-1 font-semibold text-gray-600 dark:text-gray-300",children:"Prazo para Protocolo (dias)"}),A.jsx("input",{type:"number",id:"renewalProtocolDays",name:"renewalProtocolDays",value:a.renewalProtocolDays,onChange:y,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition",required:!0})]}),A.jsxs("div",{className:"flex flex-col",children:[A.jsx("label",{htmlFor:"processStartDays",className:"mb-1 font-semibold text-gray-600 dark:text-gray-300",children:"Prazo para Incio (dias)"}),A.jsx("input",{type:"number",id:"processStartDays",name:"processStartDays",value:a.processStartDays,onChange:y,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition",required:!0})]}),A.jsxs("div",{className:"md:col-span-3 flex justify-end gap-4",children:[A.jsx("button",{type:"button",onClick:S,className:"px-6 py-3 bg-gray-500 text-white font-bold rounded-lg hover:bg-gray-600 transition-colors",children:"Cancelar"}),A.jsx("button",{type:"submit",className:"px-6 py-3 bg-green-500 text-white font-bold rounded-lg hover:bg-green-600 transition-colors",children:h?"Salvar Alteraes":"Salvar Tipo"})]})]})]}),A.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg dark:bg-gray-900 dark:border dark:border-gray-700",children:[A.jsx("h2",{className:"text-2xl font-bold text-gray-700 dark:text-gray-200 mb-4",children:"Tipos de Licena Registrados"}),A.jsx("div",{className:"overflow-x-auto",children:A.jsxs("table",{className:"min-w-full bg-white divide-y divide-gray-200 dark:bg-gray-900 dark:divide-gray-700",children:[A.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:A.jsx("tr",{children:[{label:"Tipo de Licena",key:"name"},{label:"Prazo Protocolo (dias)",key:"renewalProtocolDays"},{label:"Prazo Incio (dias)",key:"processStartDays"},{label:"Aes",key:""}].map(z=>A.jsxs("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer select-none",onClick:z.key?()=>P(z.key):void 0,children:[z.label,z.key&&p.key===z.key&&A.jsx("span",{className:"ml-1",children:p.direction==="asc"?"":""})]},z.label))})}),A.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:N.map(z=>A.jsxs("tr",{className:"bg-white dark:bg-gray-900 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[A.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-100",children:z.name}),A.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:z.renewalProtocolDays}),A.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:z.processStartDays}),A.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:A.jsxs("div",{className:"flex items-center gap-2",children:[A.jsx("button",{onClick:()=>E(z),className:"text-blue-600 hover:text-blue-900 transition-colors",children:A.jsx(S0,{})}),A.jsx("button",{onClick:()=>n(z.id),className:"text-red-600 hover:text-red-900 transition-colors",children:A.jsx(km,{})})]})})]},z.id))})]})})]})]})},m1={name:"",cnpj:"",address:"",city:"",state:"",contact:"",status:"Ativa"},AG=({branches:t,onAddBranch:e,onUpdateBranch:r,onDeleteBranch:n})=>{const[a,o]=Qe.useState(m1),[l,u]=Qe.useState(!1),[h,d]=Qe.useState(null),[p,v]=Qe.useState({key:"name",direction:"asc"}),_=()=>{d(null),o(m1),u(!0)},E=q=>{d(q);const{id:Z,...C}=q;o(C),u(!0)},S=()=>{u(!1),d(null),o(m1)},y=q=>{const{name:Z,value:C}=q.target;o(I=>({...I,[Z]:C}))},w=q=>{if(q.preventDefault(),!a.name){alert("Por favor, preencha o nome da filial.");return}h?r({...a,id:h.id}):e(a),S()},P=q=>{v(Z=>Z.key===q?{key:q,direction:Z.direction==="asc"?"desc":"asc"}:{key:q,direction:"asc"})};function B(q,Z){return(q[Z]||"").toString().toLowerCase()}const N=[...t].sort((q,Z)=>{const C=B(q,p.key),I=B(Z,p.key);return C<I?p.direction==="asc"?-1:1:C>I?p.direction==="asc"?1:-1:0}),z=q=>{switch(q){case"Ativa":return"bg-green-100 text-green-800";case"Vencida":return"bg-red-100 text-red-800";case"Em Renovao":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}};return A.jsxs("div",{className:"space-y-6",children:[A.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg dark:bg-gray-900 dark:border dark:border-gray-700",children:[A.jsxs("div",{className:"flex justify-between items-center mb-4",children:[A.jsx("h2",{className:"text-2xl font-bold text-gray-700 dark:text-gray-200",children:h?"Editar Filial":"Cadastro de Filiais"}),A.jsx("button",{onClick:l?S:_,className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white font-semibold rounded-lg hover:bg-blue-600 transition-transform transform hover:scale-105",children:l?"Fechar Formulrio":A.jsxs(A.Fragment,{children:[A.jsx(bm,{})," Nova Filial"]})})]}),l&&A.jsxs("form",{onSubmit:w,className:"grid grid-cols-1 md:grid-cols-2 gap-6 animate-fade-in",children:[A.jsxs("div",{className:"flex flex-col",children:[A.jsx("label",{htmlFor:"name",className:"mb-1 font-semibold text-gray-600 dark:text-gray-300",children:"Nome da Filial"}),A.jsx("input",{type:"text",id:"name",name:"name",value:a.name,onChange:y,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition",required:!0})]}),A.jsxs("div",{className:"flex flex-col",children:[A.jsx("label",{htmlFor:"cnpj",className:"mb-1 font-semibold text-gray-600 dark:text-gray-300",children:"CNPJ"}),A.jsx("input",{type:"text",id:"cnpj",name:"cnpj",value:a.cnpj,onChange:y,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition"})]}),A.jsxs("div",{className:"flex flex-col",children:[A.jsx("label",{htmlFor:"address",className:"mb-1 font-semibold text-gray-600 dark:text-gray-300",children:"Endereo"}),A.jsx("input",{type:"text",id:"address",name:"address",value:a.address,onChange:y,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition"})]}),A.jsxs("div",{className:"flex flex-col",children:[A.jsx("label",{htmlFor:"city",className:"mb-1 font-semibold text-gray-600 dark:text-gray-300",children:"Cidade"}),A.jsx("input",{type:"text",id:"city",name:"city",value:a.city,onChange:y,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition"})]}),A.jsxs("div",{className:"flex flex-col",children:[A.jsx("label",{htmlFor:"state",className:"mb-1 font-semibold text-gray-600 dark:text-gray-300",children:"Estado"}),A.jsx("input",{type:"text",id:"state",name:"state",value:a.state,onChange:y,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition"})]}),A.jsxs("div",{className:"flex flex-col",children:[A.jsx("label",{htmlFor:"contact",className:"mb-1 font-semibold text-gray-600 dark:text-gray-300",children:"Contato"}),A.jsx("input",{type:"text",id:"contact",name:"contact",value:a.contact,onChange:y,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition"})]}),A.jsxs("div",{className:"flex flex-col",children:[A.jsx("label",{htmlFor:"status",className:"mb-1 font-semibold text-gray-600 dark:text-gray-300",children:"Situao"}),A.jsxs("select",{name:"status",id:"status",value:a.status,onChange:y,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition",children:[A.jsx("option",{value:"Ativa",children:"Ativa"}),A.jsx("option",{value:"Vencida",children:"Vencida"}),A.jsx("option",{value:"Em Renovao",children:"Em Renovao"})]})]}),A.jsxs("div",{className:"md:col-span-2 flex justify-end gap-4",children:[A.jsx("button",{type:"button",onClick:S,className:"px-6 py-3 bg-gray-500 text-white font-bold rounded-lg hover:bg-gray-600 transition-colors",children:"Cancelar"}),A.jsx("button",{type:"submit",className:"px-6 py-3 bg-green-500 text-white font-bold rounded-lg hover:bg-green-600 transition-colors",children:h?"Salvar Alteraes":"Salvar Filial"})]})]})]}),A.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg dark:bg-gray-900 dark:border dark:border-gray-700",children:[A.jsx("h2",{className:"text-2xl font-bold text-gray-700 dark:text-gray-200 mb-4",children:"Filiais Registradas"}),A.jsx("div",{className:"overflow-x-auto",children:A.jsxs("table",{className:"min-w-full bg-white divide-y divide-gray-200 dark:bg-gray-900 dark:divide-gray-700",children:[A.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:A.jsx("tr",{children:[{label:"Nome",key:"name"},{label:"CNPJ",key:"cnpj"},{label:"Endereo",key:"address"},{label:"Cidade",key:"city"},{label:"Estado",key:"state"},{label:"Contato",key:"contact"},{label:"Situao",key:"status"},{label:"Aes",key:""}].map(q=>A.jsxs("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer select-none",onClick:q.key?()=>P(q.key):void 0,children:[q.label,q.key&&p.key===q.key&&A.jsx("span",{className:"ml-1",children:p.direction==="asc"?"":""})]},q.label))})}),A.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:N.map(q=>A.jsxs("tr",{className:"bg-white dark:bg-gray-900 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[A.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-100",children:q.name}),A.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:q.cnpj}),A.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:q.address}),A.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:q.city}),A.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:q.state}),A.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:q.contact}),A.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:A.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${z(q.status)}`,children:q.status})}),A.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:A.jsxs("div",{className:"flex items-center gap-2",children:[A.jsx("button",{onClick:()=>E(q),className:"text-blue-600 hover:text-blue-900 transition-colors",children:A.jsx(S0,{})}),A.jsx("button",{onClick:()=>n(q.id),className:"text-red-600 hover:text-red-900 transition-colors",children:A.jsx(km,{})})]})})]},q.id))})]})})]})]})},bG=({licenses:t,branches:e,licenseTypes:r,onUpdateLicense:n})=>{const[a,o]=Qe.useState(null),[l,u]=Qe.useState(null),[h,d]=Qe.useState({key:"originalExpiryDate",direction:"asc"}),[p,v]=Qe.useState(!1),[_,E]=Qe.useState({branchId:"",licenseType:""}),S=b=>{var O;return((O=e.find(L=>L.id===b))==null?void 0:O.name)||"Desconhecida"},y=b=>{o(b),u(b)},w=()=>{o(null),u(null)},P=b=>{const{name:O,value:L,type:M,checked:D}=b.target;u(Ee=>Ee?{...Ee,[O]:M==="checkbox"?D:L}:null)},B=b=>{b.preventDefault(),l&&(n(l),w())},N=b=>{d(O=>O.key===b?{key:b,direction:O.direction==="asc"?"desc":"asc"}:{key:b,direction:"asc"})};function z(b,O){return["issueDate","originalExpiryDate","prorrogaDate","processStartDate"].includes(O)?b[O]?new Date(b[O]):new Date(0):(b[O]||"").toString().toLowerCase()}const q=[...e].sort((b,O)=>b.name.localeCompare(O.name)),Z=[...r].sort((b,O)=>b.name.localeCompare(O.name)),I=[...t.filter(b=>(!_.branchId||b.unitId===_.branchId)&&(!_.licenseType||b.licenseType===_.licenseType))].sort((b,O)=>{const L=z(b,h.key),M=z(O,h.key);return L<M?h.direction==="asc"?-1:1:L>M?h.direction==="asc"?1:-1:0});return A.jsxs("div",{className:"space-y-6",children:[A.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg dark:bg-gray-900 dark:border dark:border-gray-700",children:[A.jsxs("h2",{className:"text-2xl font-bold text-gray-700 dark:text-white mb-4 flex items-center gap-2",children:["Licenas Desativadas",A.jsx("button",{type:"button",onClick:()=>v(b=>!b),className:"ml-2 p-2 rounded hover:bg-gray-100 transition",children:A.jsx(Yb,{})})]}),p&&A.jsxs("div",{className:"mb-4 bg-gray-50 border border-gray-200 rounded-lg p-4 flex flex-col md:flex-row gap-4 items-center",children:[A.jsxs("div",{className:"flex flex-col",children:[A.jsx("label",{className:"text-xs font-semibold text-gray-600 dark:text-gray-300 mb-1",children:"Filtrar por Filial"}),A.jsxs("select",{value:_.branchId,onChange:b=>E(O=>({...O,branchId:b.target.value})),className:"p-2 border border-gray-300 rounded",children:[A.jsx("option",{value:"",children:"Todas"}),q.map(b=>A.jsx("option",{value:b.id,children:b.name},b.id))]})]}),A.jsxs("div",{className:"flex flex-col",children:[A.jsx("label",{className:"text-xs font-semibold text-gray-600 dark:text-gray-300 mb-1",children:"Filtrar por Tipo de Licena"}),A.jsxs("select",{value:_.licenseType,onChange:b=>E(O=>({...O,licenseType:b.target.value})),className:"p-2 border border-gray-300 rounded",children:[A.jsx("option",{value:"",children:"Todas"}),Z.map(b=>A.jsx("option",{value:b.name,children:b.name},b.id))]})]}),A.jsx("button",{onClick:()=>E({branchId:"",licenseType:""}),className:"mt-4 md:mt-6 px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400 transition",children:"Limpar Filtros"})]}),A.jsx("div",{className:"overflow-x-auto",children:A.jsxs("table",{className:"min-w-full bg-white divide-y divide-gray-200 dark:bg-gray-900 dark:divide-gray-700",children:[A.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:A.jsx("tr",{children:[{label:"Unidade",key:"unitId"},{label:"Licena",key:"licenseType"},{label:"N/Ano",key:"numberYear"},{label:"Descrio",key:"description"},{label:"rgo Licenciador",key:"licensingAgency"},{label:"FCEI-N do Processo",key:"processNumber"},{label:"Data Emisso",key:"issueDate"},{label:"Data Vencimento",key:"originalExpiryDate"},{label:"Prazo Prorrogao",key:"prorrogaDate"},{label:"Incio Processo",key:"processStartDate"},{label:"Observao da Desativao",key:"inactiveObservation"},{label:"Aes",key:""}].map(b=>A.jsxs("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer select-none",onClick:b.key?()=>N(b.key):void 0,children:[b.label,b.key&&h.key===b.key&&A.jsx("span",{className:"ml-1",children:h.direction==="asc"?"":""})]},b.label))})}),A.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:I.map(b=>A.jsxs("tr",{className:"bg-white dark:bg-gray-900 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[A.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-100",children:S(b.unitId)}),A.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:b.licenseType}),A.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:b.numberYear}),A.jsx("td",{className:"px-6 py-4 whitespace-normal text-sm text-gray-600 dark:text-gray-300 max-w-xs",children:b.description}),A.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:b.licensingAgency}),A.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:b.processNumber}),A.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:b.issueDate?new Date(b.issueDate+"T00:00:00").toLocaleDateString("pt-BR"):""}),A.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:b.originalExpiryDate?new Date(b.originalExpiryDate+"T00:00:00").toLocaleDateString("pt-BR"):""}),A.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:b.prorrogaDate?new Date(b.prorrogaDate+"T00:00:00").toLocaleDateString("pt-BR"):""}),A.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:b.processStartDate?new Date(b.processStartDate+"T00:00:00").toLocaleDateString("pt-BR"):""}),A.jsx("td",{className:"px-6 py-4 whitespace-normal text-sm text-red-600 max-w-xs",children:b.inactiveObservation}),A.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:A.jsx("button",{onClick:()=>y(b),className:"text-blue-600 hover:text-blue-900 transition-colors",children:A.jsx(S0,{})})})]},b.id))})]})})]}),a&&l&&A.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg dark:bg-gray-900 dark:border dark:border-gray-700 mt-6",children:[A.jsx("h3",{className:"text-xl font-bold text-gray-700 mb-4",children:"Editar Licena Desativada"}),A.jsxs("form",{onSubmit:B,className:"grid grid-cols-1 md:grid-cols-2 gap-6 animate-fade-in",children:[A.jsxs("div",{className:"flex flex-col",children:[A.jsx("label",{htmlFor:"inactiveObservation",className:"mb-1 font-semibold text-gray-600 dark:text-gray-300",children:"Observao da Desativao"}),A.jsx("textarea",{name:"inactiveObservation",id:"inactiveObservation",value:l.inactiveObservation||"",onChange:P,rows:2,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition",required:!0})]}),A.jsxs("div",{className:"flex items-center md:col-span-2",children:[A.jsx("input",{type:"checkbox",id:"active",name:"active",checked:l.active,onChange:P,className:"mr-2"}),A.jsx("label",{htmlFor:"active",className:"font-semibold text-gray-600 dark:text-gray-300",children:"Reativar Licena"})]}),A.jsxs("div",{className:"md:col-span-2 flex justify-end gap-4",children:[A.jsx("button",{type:"button",onClick:w,className:"px-6 py-3 bg-gray-500 text-white font-bold rounded-lg hover:bg-gray-600 transition-colors",children:"Cancelar"}),A.jsx("button",{type:"submit",className:"px-6 py-3 bg-green-500 text-white font-bold rounded-lg hover:bg-green-600 transition-colors",children:"Salvar Alteraes"})]})]})]})]})},kG="/licencas/assets/meioambiental-Cjp3hbnE.jpeg",CG=({onLogin:t})=>{const[e,r]=Qe.useState(""),[n,a]=Qe.useState(""),[o,l]=Qe.useState(""),[u,h]=Qe.useState(!1),d=async p=>{p.preventDefault(),h(!0),l("");try{await zO(Ef,e,n),t()}catch{l("Usurio ou senha invlidos, ou usurio no autorizado.")}finally{h(!1)}};return A.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-cover bg-center bg-no-repeat relative",style:{backgroundImage:`url(${kG})`},children:[A.jsx("div",{className:"absolute inset-0 bg-black/50"}),A.jsxs("form",{onSubmit:d,className:"relative z-10 bg-white/95 backdrop-blur-sm p-8 rounded-xl shadow-2xl w-full max-w-sm space-y-6",children:[A.jsx("h2",{className:"text-2xl font-bold text-center text-gray-700",children:"Login"}),A.jsxs("div",{className:"flex flex-col gap-2",children:[A.jsx("label",{htmlFor:"email",className:"font-semibold text-gray-600",children:"E-mail"}),A.jsx("input",{id:"email",type:"email",value:e,onChange:p=>r(p.target.value),className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition",required:!0,autoFocus:!0})]}),A.jsxs("div",{className:"flex flex-col gap-2",children:[A.jsx("label",{htmlFor:"password",className:"font-semibold text-gray-600",children:"Senha"}),A.jsx("input",{id:"password",type:"password",value:n,onChange:p=>a(p.target.value),className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition",required:!0})]}),o&&A.jsx("div",{className:"text-red-600 text-sm text-center",children:o}),A.jsx("button",{type:"submit",className:"w-full py-3 bg-blue-500 text-white font-bold rounded-lg hover:bg-blue-600 transition-colors",disabled:u,children:u?"Entrando...":"Entrar"})]})]})},ax=({className:t="h-6 w-6"})=>A.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),ix=({className:t="h-6 w-6"})=>A.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),oC=({className:t="h-6 w-6"})=>A.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),RG=({licenses:t,branches:e,licenseTypes:r})=>{const n=t.filter(y=>y.active);t.filter(y=>!y.active);const a=new Date;a.setHours(0,0,0,0);const o=y=>{const P=new Date(y+"T00:00:00").getTime()-a.getTime();return Math.ceil(P/(1e3*60*60*24))},l=n.map(y=>{const w=o(y.originalExpiryDate),P=r.find(z=>z.name===y.licenseType),B=P?(P.renewalProtocolDays||0)+(P.processStartDays||0):180;let N="ok";return w<0?N="expired":w<=B&&(N="warning"),{...y,days:w,status:N}}),u=n.length,h=l.filter(y=>y.status==="expired").length,d=l.filter(y=>y.status==="warning").length,p=e.length,v=l.sort((y,w)=>y.days-w.days).slice(0,10),_=r.map(y=>{const w=n.filter(P=>P.licenseType===y.name).length;return{...y,count:w}}).filter(y=>y.count>0).sort((y,w)=>w.count-y.count),E=e.map(y=>{const w=n.filter(P=>P.unitId===y.id).length;return{...y,count:w}}).filter(y=>y.count>0).sort((y,w)=>w.count-y.count),S=({title:y,value:w,icon:P,color:B,bgColor:N})=>A.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 flex items-center justify-between border border-gray-100 dark:border-gray-700",children:[A.jsxs("div",{children:[A.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:y}),A.jsx("p",{className:"text-3xl font-bold text-gray-800 dark:text-white mt-2",children:w})]}),A.jsx("div",{className:`p-3 rounded-full ${N} ${B}`,children:P})]});return A.jsxs("div",{className:"space-y-6 animate-fade-in",children:[A.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[A.jsx(S,{title:"Licenas Ativas",value:u,icon:A.jsx(ax,{className:"h-8 w-8"}),color:"text-blue-700",bgColor:"bg-blue-100 dark:bg-blue-900/20"}),A.jsx(S,{title:"Em Alerta",value:d,icon:A.jsx(ix,{className:"h-8 w-8"}),color:"text-yellow-700",bgColor:"bg-yellow-100 dark:bg-yellow-900/20"}),A.jsx(S,{title:"Vencidas (Ativas)",value:h,icon:A.jsx(ix,{className:"h-8 w-8"}),color:"text-red-700",bgColor:"bg-red-100 dark:bg-red-900/20"}),A.jsx(S,{title:"Filiais",value:p,icon:A.jsx(oC,{className:"h-8 w-8"}),color:"text-green-700",bgColor:"bg-green-100 dark:bg-green-900/20"})]}),A.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[A.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 p-6",children:[A.jsx("h3",{className:"text-lg font-bold text-gray-800 dark:text-white mb-4",children:"Prximos Vencimentos"}),A.jsx("div",{className:"overflow-x-auto",style:{transform:"rotateX(180deg)"},children:A.jsxs("table",{className:"min-w-full",style:{transform:"rotateX(180deg)"},children:[A.jsx("thead",{children:A.jsxs("tr",{className:"text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-b border-gray-200 dark:border-gray-700",children:[A.jsx("th",{className:"pb-3",children:"Filial"}),A.jsx("th",{className:"pb-3",children:"Licena"}),A.jsx("th",{className:"pb-3",children:"Vencimento"}),A.jsx("th",{className:"pb-3",children:"Status"})]})}),A.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:v.length>0?v.map(y=>{var w;return A.jsxs("tr",{children:[A.jsx("td",{className:"py-3 text-sm text-gray-700 dark:text-gray-300",children:(w=e.find(P=>P.id===y.unitId))==null?void 0:w.name}),A.jsx("td",{className:"py-3 text-sm text-gray-700 dark:text-gray-300",children:y.licenseType}),A.jsx("td",{className:"py-3 text-sm text-gray-700 dark:text-gray-300",children:new Date(y.originalExpiryDate+"T00:00:00").toLocaleDateString("pt-BR")}),A.jsx("td",{className:"py-3",children:A.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${y.status==="expired"?"bg-red-100 text-red-800 dark:bg-red-900/90 dark:text-red-200":y.status==="warning"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/90 dark:text-yellow-200":"bg-green-100 text-green-800 dark:bg-green-900/90 dark:text-green-200"}`,children:y.status==="expired"?"Vencida":`${y.days} dias`})})]},y.id)}):A.jsx("tr",{children:A.jsx("td",{colSpan:4,className:"py-4 text-center text-gray-500 text-sm",children:"Nenhuma licena prxima do vencimento."})})})]})})]}),A.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 p-6",children:[A.jsx("h3",{className:"text-lg font-bold text-gray-800 dark:text-white mb-4",children:"Distribuies"}),A.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[A.jsxs("div",{children:[A.jsx("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3",children:"Por Tipo"}),A.jsx("div",{className:"space-y-4 max-h-[620px] overflow-y-auto pr-2",children:_.map(y=>{const w=Math.round(y.count/u*100)||0;return A.jsxs("div",{children:[A.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[A.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:y.name}),A.jsxs("span",{className:"text-gray-500 dark:text-gray-400",children:[y.count," (",w,"%)"]})]}),A.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-400 rounded-full h-2",children:A.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${w}%`}})})]},y.id)})})]}),A.jsxs("div",{children:[A.jsx("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3",children:"Por Filial"}),A.jsx("div",{className:"space-y-4 max-h-[620px] overflow-y-auto pr-2",children:E.map(y=>{const w=Math.round(y.count/u*100)||0;return A.jsxs("div",{children:[A.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[A.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:y.name}),A.jsxs("span",{className:"text-gray-500 dark:text-gray-400",children:[y.count," (",w,"%)"]})]}),A.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-400 rounded-full h-2",children:A.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${w}%`}})})]},y.id)})})]})]})]})]})]})},p1=[{id:"dashboard",label:"Dashboard"},{id:"licenses",label:"Licenas Vigentes"},{id:"sgaLicenses",label:"Licenas SGA"},{id:"deactivatedLicenses",label:"Licenas Vencidas"},{id:"licenseTypes",label:"Tipos de Licena"},{id:"branches",label:"Filiais"},{id:"users",label:"Usurios"}],IG=({branches:t=[],licenseTypes:e=[]})=>{const[r,n]=Qe.useState([]),[a,o]=Qe.useState(!0),[l,u]=Qe.useState(!1),[h,d]=Qe.useState(null),[p,v]=Qe.useState({allowedScreens:[],visibleBranchIds:[],visibleLicenseTypes:[],name:"",email:"",password:"",role:"colaborador"}),[_,E]=Qe.useState(""),S=D=>{v(Ee=>{const Te=new Set(Ee.allowedScreens);return Te.has(D)?Te.delete(D):Te.add(D),{...Ee,allowedScreens:Array.from(Te)}})},y=D=>{v(Ee=>{const Te=new Set(Ee.visibleBranchIds);return Te.has(D)?Te.delete(D):Te.add(D),{...Ee,visibleBranchIds:Array.from(Te)}})},w=()=>{v(D=>{if(!t||t.length===0)return D;const Ee=t.map(ne=>ne.id),Te=D.visibleBranchIds.length===Ee.length;return{...D,visibleBranchIds:Te?[]:Ee}})},P=D=>{v(Ee=>{const Te=new Set(Ee.visibleLicenseTypes);return Te.has(D)?Te.delete(D):Te.add(D),{...Ee,visibleLicenseTypes:Array.from(Te)}})},B=()=>{v(D=>{if(!e||e.length===0)return D;const Ee=e.map(ne=>ne.name),Te=D.visibleLicenseTypes.length===Ee.length;return{...D,visibleLicenseTypes:Te?[]:Ee}})},[N,z]=Qe.useState(""),q=ou(Wn,"users"),Z=async()=>{o(!0);try{const Ee=(await ll(q)).docs.map(Te=>({...Te.data(),id:Te.id}));n(Ee)}catch(D){console.error("Error fetching users:",D)}finally{o(!1)}};Qe.useEffect(()=>{Z()},[]);const C=D=>{const{name:Ee,value:Te}=D.target;v(ne=>{let ue={...ne,[Ee]:Te};if(Ee==="role"&&Te==="admin"){const Ue=p1.map(ie=>ie.id);ue={...ue,allowedScreens:Ue,visibleBranchIds:t.map(ie=>ie.id),visibleLicenseTypes:e.map(ie=>ie.name)}}return ue})},I=()=>{v({name:"",email:"",password:"",role:"colaborador",allowedScreens:[],visibleBranchIds:[],visibleLicenseTypes:[]}),d(null),E(""),z(""),u(!1)},b=async D=>{if(D.preventDefault(),E(""),z(""),p.role==="admin"&&(p.allowedScreens=p1.map(Ee=>Ee.id),p.visibleBranchIds=t.map(Ee=>Ee.id),p.visibleLicenseTypes=e.map(Ee=>Ee.name)),h)try{const Ee=bi(Wn,"users",h.id);await If(Ee,{allowedScreens:p.allowedScreens||[],visibleBranchIds:p.visibleBranchIds||[],visibleLicenseTypes:p.visibleLicenseTypes||[],name:p.name,role:p.role}),z("Usurio atualizado com sucesso!"),Z(),setTimeout(I,1500)}catch(Ee){E("Erro ao atualizar usurio: "+Ee.message)}else{if(!p.password||p.password.length<6){E("A senha deve ter pelo menos 6 caracteres.");return}try{const Ee=fx(Kb,"Secondary"),Te=Ib(Ee),ue=(await HO(Te,p.email,p.password)).user.uid;await z1(Te),await pI(Ee),await yf(q,{uid:ue,name:p.name,email:p.email,role:p.role,allowedScreens:p.allowedScreens||[],visibleBranchIds:p.visibleBranchIds||[],visibleLicenseTypes:p.visibleLicenseTypes||[],active:!0,createdAt:new Date().toISOString()}),z("Usurio criado com sucesso!"),Z(),setTimeout(I,1500)}catch(Ee){console.error(Ee),Ee.code==="auth/email-already-in-use"?E("Este e-mail j est em uso."):E("Erro ao criar usurio: "+Ee.message)}}},O=D=>{d(D),v({name:D.name,email:D.email,password:"",role:D.role,allowedScreens:D.allowedScreens||[],visibleBranchIds:D.visibleBranchIds||[],visibleLicenseTypes:D.visibleLicenseTypes||[]}),u(!0)},L=async D=>{if(window.confirm("Tem certeza que deseja excluir este usurio? O acesso dele ser revogado."))try{await Td(bi(Wn,"users",D)),Z()}catch(Ee){alert("Erro ao excluir usurio: "+Ee.message)}},M=async D=>{try{const Ee=bi(Wn,"users",D.id);await If(Ee,{active:!D.active}),Z()}catch(Ee){alert("Erro ao alterar status: "+Ee.message)}};return A.jsxs("div",{className:"space-y-6 animate-fade-in",children:[A.jsxs("div",{className:"flex justify-between items-center",children:[A.jsx("h2",{className:"text-xl font-semibold text-gray-800 dark:text-white",children:"Gerenciamento de Usurios"}),A.jsxs("button",{onClick:()=>{I(),u(!0)},className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-sm",children:[A.jsx(bm,{className:"h-5 w-5 mr-2"}),"Novo Usurio"]})]}),A.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden",children:A.jsx("div",{className:"overflow-x-auto",children:A.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[A.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700/90",children:A.jsxs("tr",{children:[A.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Nome"}),A.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Email"}),A.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Funo"}),A.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Status"}),A.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Aes"})]})}),A.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:a?A.jsx("tr",{children:A.jsx("td",{colSpan:5,className:"px-6 py-4 text-center text-black dark:text-gray-400",children:"Carregando..."})}):r.length===0?A.jsx("tr",{children:A.jsx("td",{colSpan:5,className:"px-6 py-4 text-center text-black dark:text-gray-400",children:"Nenhum usurio encontrado."})}):r.map(D=>A.jsxs("tr",{className:"bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700/90 transition-colors",children:[A.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:D.name}),A.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-black dark:text-gray-300",children:D.email}),A.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-black dark:text-gray-300",children:A.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${D.role==="admin"?"bg-purple-100 text-purple-800 dark:bg-purple-900/90 dark:text-purple-200":"bg-blue-100 text-blue-800 dark:bg-blue-900/90 dark:text-blue-200"}`,children:D.role==="admin"?"Administrador":"Colaborador"})}),A.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:A.jsx("button",{onClick:()=>M(D),className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full cursor-pointer ${D.active?"bg-green-100 text-green-800 dark:bg-green-900/90 dark:text-green-200":"bg-red-100 text-red-800 dark:bg-red-900/90 dark:text-red-200"}`,children:D.active?"Ativo":"Inativo"})}),A.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[A.jsx("button",{onClick:()=>O(D),className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300 mr-3",children:A.jsx(S0,{className:"h-5 w-5"})}),A.jsx("button",{onClick:()=>L(D.id),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300",children:A.jsx(km,{className:"h-5 w-5"})})]})]},D.id))})]})})}),l&&A.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:A.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-xl max-w-md w-full p-6 animate-fade-in",children:[A.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4",children:h?"Editar Usurio":"Novo Usurio"}),_&&A.jsx("div",{className:"mb-4 p-3 bg-red-100 text-red-700 rounded-lg text-sm",children:_}),N&&A.jsx("div",{className:"mb-4 p-3 bg-green-100 text-green-700 rounded-lg text-sm",children:N}),A.jsxs("form",{onSubmit:b,className:"space-y-4",children:[A.jsxs("div",{children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Nome"}),A.jsx("input",{type:"text",name:"name",value:p.name,onChange:C,className:"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 outline-none",required:!0})]}),A.jsxs("div",{children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Email"}),A.jsx("input",{type:"email",name:"email",value:p.email,onChange:C,className:"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 outline-none disabled:opacity-50",required:!0,disabled:!!h})]}),!h&&A.jsxs("div",{children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Senha"}),A.jsx("input",{type:"password",name:"password",value:p.password,onChange:C,className:"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 outline-none",required:!h,minLength:6})]}),A.jsxs("div",{children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Funo"}),A.jsxs("select",{name:"role",value:p.role,onChange:C,className:"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 outline-none",children:[A.jsx("option",{value:"colaborador",children:"Colaborador"}),A.jsx("option",{value:"admin",children:"Administrador"})]})]}),A.jsxs("div",{children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Permisses (telas)"}),A.jsx("div",{className:"grid grid-cols-2 gap-2",children:p1.map(D=>A.jsxs("label",{className:"inline-flex items-center gap-2",children:[A.jsx("input",{type:"checkbox",checked:p.allowedScreens.includes(D.id),onChange:()=>S(D.id),disabled:p.role==="admin"}),A.jsx("span",{className:"text-sm",children:D.label})]},D.id))})]}),A.jsxs("div",{children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Acesso por Filial"}),A.jsx("div",{className:"flex items-center gap-2 mb-2",children:A.jsxs("label",{className:"inline-flex items-center gap-2",children:[A.jsx("input",{type:"checkbox",checked:t.length>0&&p.visibleBranchIds.length===t.length,onChange:w}),A.jsx("span",{className:"text-sm font-medium",children:"Selecionar todos"})]})}),A.jsx("div",{className:"grid grid-cols-1 max-h-32 overflow-y-auto gap-2 p-1 border rounded",children:t.map(D=>A.jsxs("label",{className:"inline-flex items-center gap-2",children:[A.jsx("input",{type:"checkbox",checked:p.visibleBranchIds.includes(D.id),onChange:()=>y(D.id),disabled:p.role==="admin"}),A.jsx("span",{className:"text-sm",children:D.name})]},D.id))})]}),A.jsxs("div",{children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Acesso por Tipo de Licena"}),A.jsx("div",{className:"flex items-center gap-2 mb-2",children:A.jsxs("label",{className:"inline-flex items-center gap-2",children:[A.jsx("input",{type:"checkbox",checked:e.length>0&&p.visibleLicenseTypes.length===e.length,onChange:B}),A.jsx("span",{className:"text-sm font-medium",children:"Selecionar todos"})]})}),A.jsx("div",{className:"grid grid-cols-1 max-h-32 overflow-y-auto gap-2 p-1 border rounded",children:e.map(D=>A.jsxs("label",{className:"inline-flex items-center gap-2",children:[A.jsx("input",{type:"checkbox",checked:p.visibleLicenseTypes.includes(D.name),onChange:()=>P(D.name),disabled:p.role==="admin"}),A.jsx("span",{className:"text-sm",children:D.name})]},D.id))})]}),A.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[A.jsx("button",{type:"button",onClick:I,className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:"Cancelar"}),A.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:h?"Salvar Alteraes":"Criar Usurio"})]})]})]})})]})},NG=({className:t="h-6 w-6"})=>A.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})}),DG=({className:t="h-6 w-6"})=>A.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"}),A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 5a2 2 0 012-2h4a2 2 0 012 2v6H8V5z"})]}),OG=({className:t="h-6 w-6"})=>A.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),FG="/licencas/assets/ambiental-C3pQG8id.svg",PG=ou(Wn,"units"),sS=ou(Wn,"licenses"),oS=ou(Wn,"licenseTypes"),lS=ou(Wn,"branches"),MG=()=>{var Ne,ke,Oe;const[t,e]=Qe.useState("dashboard"),[r,n]=Qe.useState([]),[a,o]=Qe.useState([]),[l,u]=Qe.useState([]),[h,d]=Qe.useState([]),[p,v]=Qe.useState(!0),[_,E]=Qe.useState(null),[S,y]=Qe.useState(null),[w,P]=Qe.useState(null),[B,N]=Qe.useState(!0),[z,q]=Qe.useState(!0),[Z,C]=Qe.useState(()=>typeof window<"u"&&localStorage.getItem("theme")||"light");Qe.useEffect(()=>{typeof window>"u"||(Z==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),localStorage.setItem("theme",Z))},[Z]);const I=()=>{C(_e=>_e==="light"?"dark":"light")},b=Qe.useCallback(async()=>{const Be=(await ll(PG)).docs.map(W=>({...W.data(),id:W.id}));n(Be)},[]),O=Qe.useCallback(async()=>{const Be=(await ll(sS)).docs.map(W=>({...W.data(),id:W.id}));o(Be)},[]),L=Qe.useCallback(async()=>{const Be=(await ll(oS)).docs.map(W=>({...W.data(),id:W.id}));u(Be)},[]),M=Qe.useCallback(async()=>{const Be=(await ll(lS)).docs.map(W=>({...W.data(),id:W.id}));d(Be)},[]);if(Qe.useEffect(()=>{(async()=>{v(!0);try{await Promise.all([b(),O(),L(),M()])}catch(Be){console.error("Failed to fetch data from Firebase:",Be)}finally{v(!1)}})()},[b,O,L,M]),Qe.useEffect(()=>{const _e=WO(Ef,Be=>{E(Be),N(!1)});return()=>_e()},[]),Qe.useEffect(()=>{(async()=>{var Be,W;if(_){const nt=ou(Wn,"users"),it=B6(nt,V6("uid","==",_.uid)),wt=await ll(it);if(wt.empty)if((await ll(nt)).empty){const Le=await yf(nt,{uid:_.uid,name:_.displayName||((Be=_.email)==null?void 0:Be.split("@")[0])||"Admin",email:_.email,role:"admin",active:!0,allowedScreens:["dashboard","licenses","deactivatedLicenses","licenseTypes","branches","users"],visibleBranchIds:[],visibleLicenseTypes:[],createdAt:new Date().toISOString()});y("admin"),P({id:Le.id,uid:_.uid,name:_.displayName||((W=_.email)==null?void 0:W.split("@")[0])||"Admin",email:_.email,role:"admin",active:!0,allowedScreens:["dashboard","licenses","deactivatedLicenses","licenseTypes","branches","users"]})}else y("colaborador"),P({id:"",uid:_.uid,name:_.displayName||"",email:_.email||"",role:"colaborador",active:!0,allowedScreens:["dashboard"]});else{const st=wt.docs[0].data();P({id:wt.docs[0].id,...st}),y(st.role)}}else y(null)})()},[_]),B)return A.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:A.jsxs("div",{className:"text-center",children:[A.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-blue-600 mx-auto"}),A.jsx("p",{className:"mt-4 text-xl font-semibold text-gray-700",children:"Verificando autenticao..."})]})});if(!_)return A.jsx(CG,{onLogin:()=>E(Ef.currentUser)});const D=async _e=>{await yf(sS,_e),await O()},Ee=async _e=>{const{id:Be,...W}=_e,nt=bi(Wn,"licenses",Be);await If(nt,{...W}),await O()},Te=async _e=>{const Be=bi(Wn,"licenses",_e);await Td(Be),await O()},ne=async _e=>{const Be={..._e,renewalProtocolDays:Number(_e.renewalProtocolDays)||0,processStartDays:Number(_e.processStartDays)||0};await yf(oS,Be),await L()},ue=async _e=>{const{id:Be,...W}=_e,nt={...W,renewalProtocolDays:Number(W.renewalProtocolDays)||0,processStartDays:Number(W.processStartDays)||0},it=bi(Wn,"licenseTypes",Be);await If(it,nt),await L()},Ue=async _e=>{const Be=bi(Wn,"licenseTypes",_e);await Td(Be),await L()},ie=async _e=>{const Be=await yf(lS,_e);return await M(),Be.id},K=async _e=>{const{id:Be,...W}=_e,nt=bi(Wn,"branches",Be);await If(nt,{...W}),await M()},pe=async _e=>{const Be=bi(Wn,"branches",_e);await Td(Be),await M()},V=({icon:_e,label:Be,active:W,onClick:nt})=>A.jsxs("li",{onClick:nt,className:"flex items-center cursor-pointer p-3 rounded-lg transition-colors duration-200 mb-1 hover:bg-slate-700",style:W?{backgroundColor:"#3b82f6",color:"#ffffff"}:{color:"#94a3b8"},children:[A.jsx("div",{className:"mr-3",style:W?{color:"#ffffff"}:{color:"#94a3b8"},children:_e}),A.jsx("span",{className:"whitespace-nowrap",children:Be})]}),X=_e=>{var Be;return S==="admin"?!0:!!((Be=w==null?void 0:w.allowedScreens)!=null&&Be.includes(_e))};if(p)return A.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:A.jsxs("div",{className:"text-center",children:[A.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-blue-600 mx-auto"}),A.jsx("p",{className:"mt-4 text-xl font-semibold text-gray-700",children:"Carregando dados..."})]})});const ee=S==="admin"||!w?a:a.filter(_e=>{const Be=!(w!=null&&w.visibleBranchIds)||w.visibleBranchIds.length===0||w.visibleBranchIds.includes(_e.unitId),W=!(w!=null&&w.visibleLicenseTypes)||w.visibleLicenseTypes.length===0||w.visibleLicenseTypes.includes(_e.licenseType);return Be&&W}),te=S==="admin"||!w?h:h.filter(_e=>!(w!=null&&w.visibleBranchIds)||w.visibleBranchIds.length===0||w.visibleBranchIds.includes(_e.id)),le=S==="admin"||!w?l:l.filter(_e=>!(w!=null&&w.visibleLicenseTypes)||w.visibleLicenseTypes.length===0||w.visibleLicenseTypes.includes(_e.name));return A.jsxs("div",{className:`flex min-h-screen bg-gray-100 text-gray-800 ${Z==="dark"?"dark bg-gray-900 text-gray-100":""}`,children:[A.jsx("button",{onClick:()=>q(!z),className:"fixed top-1/2 -translate-y-1/2 p-1.5 rounded-full bg-slate-600 hover:bg-slate-500 transition-all duration-300 text-white shadow-lg z-30",style:{left:z?"240px":"8px"},"aria-label":z?"Recolher sidebar":"Expandir sidebar",children:A.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 12h16M4 18h16"})})}),A.jsx("aside",{className:`${z?"w-64":"w-0"} flex flex-col sticky top-0 h-screen shrink-0 z-20 transition-all duration-300 overflow-hidden`,style:{backgroundColor:"#1e293b"},children:A.jsxs("div",{className:`${z?"opacity-100":"opacity-0"} flex flex-col h-full transition-opacity duration-200`,children:[A.jsx("div",{className:"h-32 flex items-center justify-center shrink-0 p-4 border-b border-slate-700/50",children:A.jsx("img",{src:FG,alt:"Logo Ambiental",className:"max-h-full max-w-full object-contain"})}),A.jsx("nav",{className:"flex-1 py-4 overflow-hidden",children:A.jsxs("ul",{className:"px-3 space-y-1",children:[X("dashboard")&&A.jsx(V,{icon:A.jsx(DG,{}),label:"Dashboard",active:t==="dashboard",onClick:()=>e("dashboard")}),X("licenses")&&A.jsx(V,{icon:A.jsx(ax,{}),label:"Licenas Vigentes",active:t==="licenses",onClick:()=>e("licenses")}),X("sgaLicenses")&&A.jsx(V,{icon:A.jsx(ax,{}),label:"Licenas SGA",active:t==="sgaLicenses",onClick:()=>e("sgaLicenses")}),X("deactivatedLicenses")&&A.jsx(V,{icon:A.jsx(ix,{}),label:"Licenas Vencidas",active:t==="deactivatedLicenses",onClick:()=>e("deactivatedLicenses")}),X("licenseTypes")&&A.jsx(V,{icon:A.jsx(NG,{}),label:"Tipos de Licena",active:t==="licenseTypes",onClick:()=>e("licenseTypes")}),X("branches")&&A.jsx(V,{icon:A.jsx(oC,{}),label:"Filiais",active:t==="branches",onClick:()=>e("branches")}),X("users")&&A.jsx(V,{icon:A.jsx(OG,{}),label:"Usurios",active:t==="users",onClick:()=>e("users")})]})}),A.jsx("div",{className:"p-4 shrink-0",children:A.jsxs("div",{className:"flex items-center p-2 rounded-lg cursor-pointer transition-colors hover:bg-slate-700",onClick:()=>z1(Ef),title:"Clique para sair",children:[A.jsx("div",{className:"h-10 w-10 rounded-full bg-blue-500 flex items-center justify-center text-white font-bold text-lg shrink-0",children:((Ne=w==null?void 0:w.name)==null?void 0:Ne.charAt(0).toUpperCase())||((ke=_==null?void 0:_.email)==null?void 0:ke.charAt(0).toUpperCase())}),A.jsxs("div",{className:"ml-3 overflow-hidden",children:[A.jsx("p",{className:"text-white font-medium text-sm truncate",children:(w==null?void 0:w.name)||((Oe=_==null?void 0:_.email)==null?void 0:Oe.split("@")[0])}),A.jsx("p",{className:"text-slate-400 text-xs truncate",children:_==null?void 0:_.email})]})]})})]})}),A.jsxs("div",{className:"flex-1 flex flex-col min-h-screen min-w-0",children:[A.jsxs("header",{className:"h-14 flex items-center justify-between px-6 sticky top-0 z-10",style:{backgroundColor:"#1e293b"},children:[A.jsx("div",{className:"flex items-center gap-4 min-w-[200px]"}),A.jsx("h1",{className:"text-lg font-semibold text-white",children:"Gesto de Licenas Ambientais"}),A.jsxs("div",{className:"flex items-center gap-2 min-w-[200px] justify-end",children:[A.jsx("button",{onClick:I,className:"p-2 rounded-lg hover:bg-slate-700 transition-colors text-white","aria-label":"Alternar tema",children:Z==="dark"?A.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}):A.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})})}),A.jsx("button",{onClick:()=>z1(Ef),className:"px-4 py-1.5 bg-red-500 hover:bg-red-600 text-white text-sm font-medium rounded-lg transition-colors",children:"Sair"})]})]}),A.jsx("main",{className:"flex-1 p-6 lg:p-8 overflow-x-hidden",children:A.jsxs("div",{className:"w-full",children:[t==="dashboard"&&A.jsx(RG,{licenses:ee,branches:h,licenseTypes:l}),t==="licenses"&&A.jsx(iS,{licenses:ee,branches:te,licenseTypes:le,onAddLicense:D,onUpdateLicense:Ee,onDeleteLicense:Te,onAddBranch:ie,category:"Ambiental"}),t==="sgaLicenses"&&A.jsx(iS,{licenses:ee,branches:te,licenseTypes:le,onAddLicense:D,onUpdateLicense:Ee,onDeleteLicense:Te,onAddBranch:ie,category:"SGA"}),t==="deactivatedLicenses"&&A.jsx(bG,{licenses:ee.filter(_e=>!_e.active),branches:te,licenseTypes:le,onUpdateLicense:Ee}),t==="licenseTypes"&&A.jsx(SG,{licenseTypes:l,onAddLicenseType:ne,onUpdateLicenseType:ue,onDeleteLicenseType:Ue}),t==="branches"&&A.jsx(AG,{branches:h,onAddBranch:ie,onUpdateBranch:K,onDeleteBranch:pe}),t==="users"&&A.jsx(IG,{branches:h,licenseTypes:l})]})}),A.jsx("footer",{className:"text-center text-gray-500 py-6 text-sm border-t border-gray-200 dark:border-gray-800 mt-auto bg-white dark:bg-gray-800",children:A.jsxs("p",{children:[" ",new Date().getFullYear()," Gesto Ambiental. Todos os direitos reservados."]})})]})]})},lC=document.getElementById("root");if(!lC)throw new Error("Could not find root element to mount to");const LG=G3.createRoot(lC);LG.render(A.jsx(M3.StrictMode,{children:A.jsx(MG,{})}));
