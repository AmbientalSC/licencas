(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(a){if(a.ep)return;a.ep=!0;const o=r(a);fetch(a.href,o)}})();function pb(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Mg={exports:{}},ff={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fw;function V3(){if(fw)return ff;fw=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function r(n,a,o){var l=null;if(o!==void 0&&(l=""+o),a.key!==void 0&&(l=""+a.key),"key"in a){o={};for(var u in a)u!=="key"&&(o[u]=a[u])}else o=a;return a=o.ref,{$$typeof:t,type:n,key:l,ref:a!==void 0?a:null,props:o}}return ff.Fragment=e,ff.jsx=r,ff.jsxs=r,ff}var hw;function j3(){return hw||(hw=1,Mg.exports=V3()),Mg.exports}var y=j3(),Ug={exports:{}},_t={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dw;function H3(){if(dw)return _t;dw=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),v=Symbol.iterator;function _(ee){return ee===null||typeof ee!="object"?null:(ee=v&&ee[v]||ee["@@iterator"],typeof ee=="function"?ee:null)}var E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,w={};function b(ee,ge,V){this.props=ee,this.context=ge,this.refs=w,this.updater=V||E}b.prototype.isReactComponent={},b.prototype.setState=function(ee,ge){if(typeof ee!="object"&&typeof ee!="function"&&ee!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,ee,ge,"setState")},b.prototype.forceUpdate=function(ee){this.updater.enqueueForceUpdate(this,ee,"forceUpdate")};function L(){}L.prototype=b.prototype;function B(ee,ge,V){this.props=ee,this.context=ge,this.refs=w,this.updater=V||E}var F=B.prototype=new L;F.constructor=B,S(F,b.prototype),F.isPureReactComponent=!0;var z=Array.isArray,q={H:null,A:null,T:null,S:null,V:null},W=Object.prototype.hasOwnProperty;function k(ee,ge,V,K,Y,te){return V=te.ref,{$$typeof:t,type:ee,key:ge,ref:V!==void 0?V:null,props:te}}function I(ee,ge){return k(ee.type,ge,void 0,void 0,void 0,ee.props)}function A(ee){return typeof ee=="object"&&ee!==null&&ee.$$typeof===t}function O(ee){var ge={"=":"=0",":":"=2"};return"$"+ee.replace(/[=:]/g,function(V){return ge[V]})}var M=/\/+/g;function N(ee,ge){return typeof ee=="object"&&ee!==null&&ee.key!=null?O(""+ee.key):ge.toString(36)}function D(){}function he(ee){switch(ee.status){case"fulfilled":return ee.value;case"rejected":throw ee.reason;default:switch(typeof ee.status=="string"?ee.then(D,D):(ee.status="pending",ee.then(function(ge){ee.status==="pending"&&(ee.status="fulfilled",ee.value=ge)},function(ge){ee.status==="pending"&&(ee.status="rejected",ee.reason=ge)})),ee.status){case"fulfilled":return ee.value;case"rejected":throw ee.reason}}throw ee}function we(ee,ge,V,K,Y){var te=typeof ee;(te==="undefined"||te==="boolean")&&(ee=null);var ce=!1;if(ee===null)ce=!0;else switch(te){case"bigint":case"string":case"number":ce=!0;break;case"object":switch(ee.$$typeof){case t:case e:ce=!0;break;case m:return ce=ee._init,we(ce(ee._payload),ge,V,K,Y)}}if(ce)return Y=Y(ee),ce=K===""?"."+N(ee,0):K,z(Y)?(V="",ce!=null&&(V=ce.replace(M,"$&/")+"/"),we(Y,ge,V,"",function(Fe){return Fe})):Y!=null&&(A(Y)&&(Y=I(Y,V+(Y.key==null||ee&&ee.key===Y.key?"":(""+Y.key).replace(M,"$&/")+"/")+ce)),ge.push(Y)),1;ce=0;var De=K===""?".":K+":";if(z(ee))for(var ke=0;ke<ee.length;ke++)K=ee[ke],te=De+N(K,ke),ce+=we(K,ge,V,te,Y);else if(ke=_(ee),typeof ke=="function")for(ee=ke.call(ee),ke=0;!(K=ee.next()).done;)K=K.value,te=De+N(K,ke++),ce+=we(K,ge,V,te,Y);else if(te==="object"){if(typeof ee.then=="function")return we(he(ee),ge,V,K,Y);throw ge=String(ee),Error("Objects are not valid as a React child (found: "+(ge==="[object Object]"?"object with keys {"+Object.keys(ee).join(", ")+"}":ge)+"). If you meant to render a collection of children, use an array instead.")}return ce}function ne(ee,ge,V){if(ee==null)return ee;var K=[],Y=0;return we(ee,K,"","",function(te){return ge.call(V,te,Y++)}),K}function ue(ee){if(ee._status===-1){var ge=ee._result;ge=ge(),ge.then(function(V){(ee._status===0||ee._status===-1)&&(ee._status=1,ee._result=V)},function(V){(ee._status===0||ee._status===-1)&&(ee._status=2,ee._result=V)}),ee._status===-1&&(ee._status=0,ee._result=ge)}if(ee._status===1)return ee._result.default;throw ee._result}var Ve=typeof reportError=="function"?reportError:function(ee){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ge=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof ee=="object"&&ee!==null&&typeof ee.message=="string"?String(ee.message):String(ee),error:ee});if(!window.dispatchEvent(ge))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",ee);return}console.error(ee)};function ie(){}return _t.Children={map:ne,forEach:function(ee,ge,V){ne(ee,function(){ge.apply(this,arguments)},V)},count:function(ee){var ge=0;return ne(ee,function(){ge++}),ge},toArray:function(ee){return ne(ee,function(ge){return ge})||[]},only:function(ee){if(!A(ee))throw Error("React.Children.only expected to receive a single React element child.");return ee}},_t.Component=b,_t.Fragment=r,_t.Profiler=a,_t.PureComponent=B,_t.StrictMode=n,_t.Suspense=f,_t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=q,_t.__COMPILER_RUNTIME={__proto__:null,c:function(ee){return q.H.useMemoCache(ee)}},_t.cache=function(ee){return function(){return ee.apply(null,arguments)}},_t.cloneElement=function(ee,ge,V){if(ee==null)throw Error("The argument must be a React element, but you passed "+ee+".");var K=S({},ee.props),Y=ee.key,te=void 0;if(ge!=null)for(ce in ge.ref!==void 0&&(te=void 0),ge.key!==void 0&&(Y=""+ge.key),ge)!W.call(ge,ce)||ce==="key"||ce==="__self"||ce==="__source"||ce==="ref"&&ge.ref===void 0||(K[ce]=ge[ce]);var ce=arguments.length-2;if(ce===1)K.children=V;else if(1<ce){for(var De=Array(ce),ke=0;ke<ce;ke++)De[ke]=arguments[ke+2];K.children=De}return k(ee.type,Y,void 0,void 0,te,K)},_t.createContext=function(ee){return ee={$$typeof:l,_currentValue:ee,_currentValue2:ee,_threadCount:0,Provider:null,Consumer:null},ee.Provider=ee,ee.Consumer={$$typeof:o,_context:ee},ee},_t.createElement=function(ee,ge,V){var K,Y={},te=null;if(ge!=null)for(K in ge.key!==void 0&&(te=""+ge.key),ge)W.call(ge,K)&&K!=="key"&&K!=="__self"&&K!=="__source"&&(Y[K]=ge[K]);var ce=arguments.length-2;if(ce===1)Y.children=V;else if(1<ce){for(var De=Array(ce),ke=0;ke<ce;ke++)De[ke]=arguments[ke+2];Y.children=De}if(ee&&ee.defaultProps)for(K in ce=ee.defaultProps,ce)Y[K]===void 0&&(Y[K]=ce[K]);return k(ee,te,void 0,void 0,null,Y)},_t.createRef=function(){return{current:null}},_t.forwardRef=function(ee){return{$$typeof:u,render:ee}},_t.isValidElement=A,_t.lazy=function(ee){return{$$typeof:m,_payload:{_status:-1,_result:ee},_init:ue}},_t.memo=function(ee,ge){return{$$typeof:d,type:ee,compare:ge===void 0?null:ge}},_t.startTransition=function(ee){var ge=q.T,V={};q.T=V;try{var K=ee(),Y=q.S;Y!==null&&Y(V,K),typeof K=="object"&&K!==null&&typeof K.then=="function"&&K.then(ie,Ve)}catch(te){Ve(te)}finally{q.T=ge}},_t.unstable_useCacheRefresh=function(){return q.H.useCacheRefresh()},_t.use=function(ee){return q.H.use(ee)},_t.useActionState=function(ee,ge,V){return q.H.useActionState(ee,ge,V)},_t.useCallback=function(ee,ge){return q.H.useCallback(ee,ge)},_t.useContext=function(ee){return q.H.useContext(ee)},_t.useDebugValue=function(){},_t.useDeferredValue=function(ee,ge){return q.H.useDeferredValue(ee,ge)},_t.useEffect=function(ee,ge,V){var K=q.H;if(typeof V=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return K.useEffect(ee,ge)},_t.useId=function(){return q.H.useId()},_t.useImperativeHandle=function(ee,ge,V){return q.H.useImperativeHandle(ee,ge,V)},_t.useInsertionEffect=function(ee,ge){return q.H.useInsertionEffect(ee,ge)},_t.useLayoutEffect=function(ee,ge){return q.H.useLayoutEffect(ee,ge)},_t.useMemo=function(ee,ge){return q.H.useMemo(ee,ge)},_t.useOptimistic=function(ee,ge){return q.H.useOptimistic(ee,ge)},_t.useReducer=function(ee,ge,V){return q.H.useReducer(ee,ge,V)},_t.useRef=function(ee){return q.H.useRef(ee)},_t.useState=function(ee){return q.H.useState(ee)},_t.useSyncExternalStore=function(ee,ge,V){return q.H.useSyncExternalStore(ee,ge,V)},_t.useTransition=function(){return q.H.useTransition()},_t.version="19.1.0",_t}var mw;function fx(){return mw||(mw=1,Ug.exports=H3()),Ug.exports}var Xe=fx();const gb=pb(Xe);var Bg={exports:{}},hf={},Vg={exports:{}},jg={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pw;function z3(){return pw||(pw=1,function(t){function e(ne,ue){var Ve=ne.length;ne.push(ue);e:for(;0<Ve;){var ie=Ve-1>>>1,ee=ne[ie];if(0<a(ee,ue))ne[ie]=ue,ne[Ve]=ee,Ve=ie;else break e}}function r(ne){return ne.length===0?null:ne[0]}function n(ne){if(ne.length===0)return null;var ue=ne[0],Ve=ne.pop();if(Ve!==ue){ne[0]=Ve;e:for(var ie=0,ee=ne.length,ge=ee>>>1;ie<ge;){var V=2*(ie+1)-1,K=ne[V],Y=V+1,te=ne[Y];if(0>a(K,Ve))Y<ee&&0>a(te,K)?(ne[ie]=te,ne[Y]=Ve,ie=Y):(ne[ie]=K,ne[V]=Ve,ie=V);else if(Y<ee&&0>a(te,Ve))ne[ie]=te,ne[Y]=Ve,ie=Y;else break e}}return ue}function a(ne,ue){var Ve=ne.sortIndex-ue.sortIndex;return Ve!==0?Ve:ne.id-ue.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var l=Date,u=l.now();t.unstable_now=function(){return l.now()-u}}var f=[],d=[],m=1,v=null,_=3,E=!1,S=!1,w=!1,b=!1,L=typeof setTimeout=="function"?setTimeout:null,B=typeof clearTimeout=="function"?clearTimeout:null,F=typeof setImmediate<"u"?setImmediate:null;function z(ne){for(var ue=r(d);ue!==null;){if(ue.callback===null)n(d);else if(ue.startTime<=ne)n(d),ue.sortIndex=ue.expirationTime,e(f,ue);else break;ue=r(d)}}function q(ne){if(w=!1,z(ne),!S)if(r(f)!==null)S=!0,W||(W=!0,N());else{var ue=r(d);ue!==null&&we(q,ue.startTime-ne)}}var W=!1,k=-1,I=5,A=-1;function O(){return b?!0:!(t.unstable_now()-A<I)}function M(){if(b=!1,W){var ne=t.unstable_now();A=ne;var ue=!0;try{e:{S=!1,w&&(w=!1,B(k),k=-1),E=!0;var Ve=_;try{t:{for(z(ne),v=r(f);v!==null&&!(v.expirationTime>ne&&O());){var ie=v.callback;if(typeof ie=="function"){v.callback=null,_=v.priorityLevel;var ee=ie(v.expirationTime<=ne);if(ne=t.unstable_now(),typeof ee=="function"){v.callback=ee,z(ne),ue=!0;break t}v===r(f)&&n(f),z(ne)}else n(f);v=r(f)}if(v!==null)ue=!0;else{var ge=r(d);ge!==null&&we(q,ge.startTime-ne),ue=!1}}break e}finally{v=null,_=Ve,E=!1}ue=void 0}}finally{ue?N():W=!1}}}var N;if(typeof F=="function")N=function(){F(M)};else if(typeof MessageChannel<"u"){var D=new MessageChannel,he=D.port2;D.port1.onmessage=M,N=function(){he.postMessage(null)}}else N=function(){L(M,0)};function we(ne,ue){k=L(function(){ne(t.unstable_now())},ue)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ne){ne.callback=null},t.unstable_forceFrameRate=function(ne){0>ne||125<ne?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<ne?Math.floor(1e3/ne):5},t.unstable_getCurrentPriorityLevel=function(){return _},t.unstable_next=function(ne){switch(_){case 1:case 2:case 3:var ue=3;break;default:ue=_}var Ve=_;_=ue;try{return ne()}finally{_=Ve}},t.unstable_requestPaint=function(){b=!0},t.unstable_runWithPriority=function(ne,ue){switch(ne){case 1:case 2:case 3:case 4:case 5:break;default:ne=3}var Ve=_;_=ne;try{return ue()}finally{_=Ve}},t.unstable_scheduleCallback=function(ne,ue,Ve){var ie=t.unstable_now();switch(typeof Ve=="object"&&Ve!==null?(Ve=Ve.delay,Ve=typeof Ve=="number"&&0<Ve?ie+Ve:ie):Ve=ie,ne){case 1:var ee=-1;break;case 2:ee=250;break;case 5:ee=1073741823;break;case 4:ee=1e4;break;default:ee=5e3}return ee=Ve+ee,ne={id:m++,callback:ue,priorityLevel:ne,startTime:Ve,expirationTime:ee,sortIndex:-1},Ve>ie?(ne.sortIndex=Ve,e(d,ne),r(f)===null&&ne===r(d)&&(w?(B(k),k=-1):w=!0,we(q,Ve-ie))):(ne.sortIndex=ee,e(f,ne),S||E||(S=!0,W||(W=!0,N()))),ne},t.unstable_shouldYield=O,t.unstable_wrapCallback=function(ne){var ue=_;return function(){var Ve=_;_=ue;try{return ne.apply(this,arguments)}finally{_=Ve}}}}(jg)),jg}var gw;function G3(){return gw||(gw=1,Vg.exports=z3()),Vg.exports}var Hg={exports:{}},Sn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xw;function q3(){if(xw)return Sn;xw=1;var t=fx();function e(f){var d="https://react.dev/errors/"+f;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)d+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+f+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(e(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},a=Symbol.for("react.portal");function o(f,d,m){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:v==null?null:""+v,children:f,containerInfo:d,implementation:m}}var l=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(f,d){if(f==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return Sn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Sn.createPortal=function(f,d){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return o(f,d,null,m)},Sn.flushSync=function(f){var d=l.T,m=n.p;try{if(l.T=null,n.p=2,f)return f()}finally{l.T=d,n.p=m,n.d.f()}},Sn.preconnect=function(f,d){typeof f=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,n.d.C(f,d))},Sn.prefetchDNS=function(f){typeof f=="string"&&n.d.D(f)},Sn.preinit=function(f,d){if(typeof f=="string"&&d&&typeof d.as=="string"){var m=d.as,v=u(m,d.crossOrigin),_=typeof d.integrity=="string"?d.integrity:void 0,E=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;m==="style"?n.d.S(f,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:v,integrity:_,fetchPriority:E}):m==="script"&&n.d.X(f,{crossOrigin:v,integrity:_,fetchPriority:E,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},Sn.preinitModule=function(f,d){if(typeof f=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var m=u(d.as,d.crossOrigin);n.d.M(f,{crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&n.d.M(f)},Sn.preload=function(f,d){if(typeof f=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var m=d.as,v=u(m,d.crossOrigin);n.d.L(f,m,{crossOrigin:v,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},Sn.preloadModule=function(f,d){if(typeof f=="string")if(d){var m=u(d.as,d.crossOrigin);n.d.m(f,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else n.d.m(f)},Sn.requestFormReset=function(f){n.d.r(f)},Sn.unstable_batchedUpdates=function(f,d){return f(d)},Sn.useFormState=function(f,d,m){return l.H.useFormState(f,d,m)},Sn.useFormStatus=function(){return l.H.useHostTransitionStatus()},Sn.version="19.1.0",Sn}var vw;function W3(){if(vw)return Hg.exports;vw=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Hg.exports=q3(),Hg.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _w;function X3(){if(_w)return hf;_w=1;var t=G3(),e=fx(),r=W3();function n(i){var s="https://react.dev/errors/"+i;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)s+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+i+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function o(i){var s=i,c=i;if(i.alternate)for(;s.return;)s=s.return;else{i=s;do s=i,(s.flags&4098)!==0&&(c=s.return),i=s.return;while(i)}return s.tag===3?c:null}function l(i){if(i.tag===13){var s=i.memoizedState;if(s===null&&(i=i.alternate,i!==null&&(s=i.memoizedState)),s!==null)return s.dehydrated}return null}function u(i){if(o(i)!==i)throw Error(n(188))}function f(i){var s=i.alternate;if(!s){if(s=o(i),s===null)throw Error(n(188));return s!==i?null:i}for(var c=i,h=s;;){var g=c.return;if(g===null)break;var x=g.alternate;if(x===null){if(h=g.return,h!==null){c=h;continue}break}if(g.child===x.child){for(x=g.child;x;){if(x===c)return u(g),i;if(x===h)return u(g),s;x=x.sibling}throw Error(n(188))}if(c.return!==h.return)c=g,h=x;else{for(var R=!1,U=g.child;U;){if(U===c){R=!0,c=g,h=x;break}if(U===h){R=!0,h=g,c=x;break}U=U.sibling}if(!R){for(U=x.child;U;){if(U===c){R=!0,c=x,h=g;break}if(U===h){R=!0,h=x,c=g;break}U=U.sibling}if(!R)throw Error(n(189))}}if(c.alternate!==h)throw Error(n(190))}if(c.tag!==3)throw Error(n(188));return c.stateNode.current===c?i:s}function d(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i;for(i=i.child;i!==null;){if(s=d(i),s!==null)return s;i=i.sibling}return null}var m=Object.assign,v=Symbol.for("react.element"),_=Symbol.for("react.transitional.element"),E=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),b=Symbol.for("react.profiler"),L=Symbol.for("react.provider"),B=Symbol.for("react.consumer"),F=Symbol.for("react.context"),z=Symbol.for("react.forward_ref"),q=Symbol.for("react.suspense"),W=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),I=Symbol.for("react.lazy"),A=Symbol.for("react.activity"),O=Symbol.for("react.memo_cache_sentinel"),M=Symbol.iterator;function N(i){return i===null||typeof i!="object"?null:(i=M&&i[M]||i["@@iterator"],typeof i=="function"?i:null)}var D=Symbol.for("react.client.reference");function he(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===D?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case S:return"Fragment";case b:return"Profiler";case w:return"StrictMode";case q:return"Suspense";case W:return"SuspenseList";case A:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case E:return"Portal";case F:return(i.displayName||"Context")+".Provider";case B:return(i._context.displayName||"Context")+".Consumer";case z:var s=i.render;return i=i.displayName,i||(i=s.displayName||s.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case k:return s=i.displayName||null,s!==null?s:he(i.type)||"Memo";case I:s=i._payload,i=i._init;try{return he(i(s))}catch{}}return null}var we=Array.isArray,ne=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ue=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ve={pending:!1,data:null,method:null,action:null},ie=[],ee=-1;function ge(i){return{current:i}}function V(i){0>ee||(i.current=ie[ee],ie[ee]=null,ee--)}function K(i,s){ee++,ie[ee]=i.current,i.current=s}var Y=ge(null),te=ge(null),ce=ge(null),De=ge(null);function ke(i,s){switch(K(ce,s),K(te,i),K(Y,null),s.nodeType){case 9:case 11:i=(i=s.documentElement)&&(i=i.namespaceURI)?B2(i):0;break;default:if(i=s.tagName,s=s.namespaceURI)s=B2(s),i=V2(s,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}V(Y),K(Y,i)}function Fe(){V(Y),V(te),V(ce)}function ye(i){i.memoizedState!==null&&K(De,i);var s=Y.current,c=V2(s,i.type);s!==c&&(K(te,i),K(Y,c))}function Be(i){te.current===i&&(V(Y),V(te)),De.current===i&&(V(De),sf._currentValue=Ve)}var X=Object.prototype.hasOwnProperty,rt=t.unstable_scheduleCallback,nt=t.unstable_cancelCallback,wt=t.unstable_shouldYield,ut=t.unstable_requestPaint,Ue=t.unstable_now,Jt=t.unstable_getCurrentPriorityLevel,Cr=t.unstable_ImmediatePriority,Mr=t.unstable_UserBlockingPriority,Xr=t.unstable_NormalPriority,Ga=t.unstable_LowPriority,hn=t.unstable_IdlePriority,Rr=t.log,Tn=t.unstable_setDisableYieldValue,Ut=null,kt=null;function se(i){if(typeof Rr=="function"&&Tn(i),kt&&typeof kt.setStrictMode=="function")try{kt.setStrictMode(Ut,i)}catch{}}var Me=Math.clz32?Math.clz32:pt,Re=Math.log,Je=Math.LN2;function pt(i){return i>>>=0,i===0?32:31-(Re(i)/Je|0)|0}var mt=256,sr=4194304;function qt(i){var s=i&42;if(s!==0)return s;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function Un(i,s,c){var h=i.pendingLanes;if(h===0)return 0;var g=0,x=i.suspendedLanes,R=i.pingedLanes;i=i.warmLanes;var U=h&134217727;return U!==0?(h=U&~x,h!==0?g=qt(h):(R&=U,R!==0?g=qt(R):c||(c=U&~i,c!==0&&(g=qt(c))))):(U=h&~x,U!==0?g=qt(U):R!==0?g=qt(R):c||(c=h&~i,c!==0&&(g=qt(c)))),g===0?0:s!==0&&s!==g&&(s&x)===0&&(x=g&-g,c=s&-s,x>=c||x===32&&(c&4194048)!==0)?s:g}function Hi(i,s){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&s)===0}function Ts(i,s){switch(i){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function bs(){var i=mt;return mt<<=1,(mt&4194048)===0&&(mt=256),i}function Ss(){var i=sr;return sr<<=1,(sr&62914560)===0&&(sr=4194304),i}function qa(i){for(var s=[],c=0;31>c;c++)s.push(i);return s}function Wa(i,s){i.pendingLanes|=s,s!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function si(i,s,c,h,g,x){var R=i.pendingLanes;i.pendingLanes=c,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=c,i.entangledLanes&=c,i.errorRecoveryDisabledLanes&=c,i.shellSuspendCounter=0;var U=i.entanglements,re=i.expirationTimes,pe=i.hiddenUpdates;for(c=R&~c;0<c;){var Ae=31-Me(c),Ie=1<<Ae;U[Ae]=0,re[Ae]=-1;var _e=pe[Ae];if(_e!==null)for(pe[Ae]=null,Ae=0;Ae<_e.length;Ae++){var Ee=_e[Ae];Ee!==null&&(Ee.lane&=-536870913)}c&=~Ie}h!==0&&Ta(i,h,0),x!==0&&g===0&&i.tag!==0&&(i.suspendedLanes|=x&~(R&~s))}function Ta(i,s,c){i.pendingLanes|=s,i.suspendedLanes&=~s;var h=31-Me(s);i.entangledLanes|=s,i.entanglements[h]=i.entanglements[h]|1073741824|c&4194090}function Oo(i,s){var c=i.entangledLanes|=s;for(i=i.entanglements;c;){var h=31-Me(c),g=1<<h;g&s|i[h]&s&&(i[h]|=s),c&=~g}}function oi(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function As(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function li(){var i=ue.p;return i!==0?i:(i=window.event,i===void 0?32:iw(i.type))}function jl(i,s){var c=ue.p;try{return ue.p=i,s()}finally{ue.p=c}}var or=Math.random().toString(36).slice(2),Nr="__reactFiber$"+or,mr="__reactProps$"+or,Yn="__reactContainer$"+or,Fo="__reactEvents$"+or,hu="__reactListeners$"+or,P="__reactHandles$"+or,Z="__reactResources$"+or,H="__reactMarker$"+or;function G(i){delete i[Nr],delete i[mr],delete i[Fo],delete i[hu],delete i[P]}function Q(i){var s=i[Nr];if(s)return s;for(var c=i.parentNode;c;){if(s=c[Yn]||c[Nr]){if(c=s.alternate,s.child!==null||c!==null&&c.child!==null)for(i=G2(i);i!==null;){if(c=i[Nr])return c;i=G2(i)}return s}i=c,c=i.parentNode}return null}function J(i){if(i=i[Nr]||i[Yn]){var s=i.tag;if(s===5||s===6||s===13||s===26||s===27||s===3)return i}return null}function me(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i.stateNode;throw Error(n(33))}function Te(i){var s=i[Z];return s||(s=i[Z]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function le(i){i[H]=!0}var xe=new Set,ve={};function Le(i,s){He(i,s),He(i+"Capture",s)}function He(i,s){for(ve[i]=s,i=0;i<s.length;i++)xe.add(s[i])}var Ke=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),je={},We={};function ft(i){return X.call(We,i)?!0:X.call(je,i)?!1:Ke.test(i)?We[i]=!0:(je[i]=!0,!1)}function jt(i,s,c){if(ft(s))if(c===null)i.removeAttribute(s);else{switch(typeof c){case"undefined":case"function":case"symbol":i.removeAttribute(s);return;case"boolean":var h=s.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){i.removeAttribute(s);return}}i.setAttribute(s,""+c)}}function Dt(i,s,c){if(c===null)i.removeAttribute(s);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(s);return}i.setAttribute(s,""+c)}}function Ot(i,s,c,h){if(h===null)i.removeAttribute(c);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(c);return}i.setAttributeNS(s,c,""+h)}}var ia,ci;function Bn(i){if(ia===void 0)try{throw Error()}catch(c){var s=c.stack.trim().match(/\n( *(at )?)/);ia=s&&s[1]||"",ci=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ia+i+ci}var $n=!1;function ui(i,s){if(!i||$n)return"";$n=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(s){var Ie=function(){throw Error()};if(Object.defineProperty(Ie.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ie,[])}catch(Ee){var _e=Ee}Reflect.construct(i,[],Ie)}else{try{Ie.call()}catch(Ee){_e=Ee}i.call(Ie.prototype)}}else{try{throw Error()}catch(Ee){_e=Ee}(Ie=i())&&typeof Ie.catch=="function"&&Ie.catch(function(){})}}catch(Ee){if(Ee&&_e&&typeof Ee.stack=="string")return[Ee.stack,_e.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var x=h.DetermineComponentFrameRoot(),R=x[0],U=x[1];if(R&&U){var re=R.split(`
`),pe=U.split(`
`);for(g=h=0;h<re.length&&!re[h].includes("DetermineComponentFrameRoot");)h++;for(;g<pe.length&&!pe[g].includes("DetermineComponentFrameRoot");)g++;if(h===re.length||g===pe.length)for(h=re.length-1,g=pe.length-1;1<=h&&0<=g&&re[h]!==pe[g];)g--;for(;1<=h&&0<=g;h--,g--)if(re[h]!==pe[g]){if(h!==1||g!==1)do if(h--,g--,0>g||re[h]!==pe[g]){var Ae=`
`+re[h].replace(" at new "," at ");return i.displayName&&Ae.includes("<anonymous>")&&(Ae=Ae.replace("<anonymous>",i.displayName)),Ae}while(1<=h&&0<=g);break}}}finally{$n=!1,Error.prepareStackTrace=c}return(c=i?i.displayName||i.name:"")?Bn(c):""}function Vn(i){switch(i.tag){case 26:case 27:case 5:return Bn(i.type);case 16:return Bn("Lazy");case 13:return Bn("Suspense");case 19:return Bn("SuspenseList");case 0:case 15:return ui(i.type,!1);case 11:return ui(i.type.render,!1);case 1:return ui(i.type,!0);case 31:return Bn("Activity");default:return""}}function Hl(i){try{var s="";do s+=Vn(i),i=i.return;while(i);return s}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}function jn(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function du(i){var s=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function jm(i){var s=du(i)?"checked":"value",c=Object.getOwnPropertyDescriptor(i.constructor.prototype,s),h=""+i[s];if(!i.hasOwnProperty(s)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var g=c.get,x=c.set;return Object.defineProperty(i,s,{configurable:!0,get:function(){return g.call(this)},set:function(R){h=""+R,x.call(this,R)}}),Object.defineProperty(i,s,{enumerable:c.enumerable}),{getValue:function(){return h},setValue:function(R){h=""+R},stopTracking:function(){i._valueTracker=null,delete i[s]}}}}function zl(i){i._valueTracker||(i._valueTracker=jm(i))}function mu(i){if(!i)return!1;var s=i._valueTracker;if(!s)return!0;var c=s.getValue(),h="";return i&&(h=du(i)?i.checked?"true":"false":i.value),i=h,i!==c?(s.setValue(i),!0):!1}function Po(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var Hm=/[\n"\\]/g;function Ur(i){return i.replace(Hm,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function sa(i,s,c,h,g,x,R,U){i.name="",R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"?i.type=R:i.removeAttribute("type"),s!=null?R==="number"?(s===0&&i.value===""||i.value!=s)&&(i.value=""+jn(s)):i.value!==""+jn(s)&&(i.value=""+jn(s)):R!=="submit"&&R!=="reset"||i.removeAttribute("value"),s!=null?ks(i,R,jn(s)):c!=null?ks(i,R,jn(c)):h!=null&&i.removeAttribute("value"),g==null&&x!=null&&(i.defaultChecked=!!x),g!=null&&(i.checked=g&&typeof g!="function"&&typeof g!="symbol"),U!=null&&typeof U!="function"&&typeof U!="symbol"&&typeof U!="boolean"?i.name=""+jn(U):i.removeAttribute("name")}function Lo(i,s,c,h,g,x,R,U){if(x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(i.type=x),s!=null||c!=null){if(!(x!=="submit"&&x!=="reset"||s!=null))return;c=c!=null?""+jn(c):"",s=s!=null?""+jn(s):c,U||s===i.value||(i.value=s),i.defaultValue=s}h=h??g,h=typeof h!="function"&&typeof h!="symbol"&&!!h,i.checked=U?i.checked:!!h,i.defaultChecked=!!h,R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"&&(i.name=R)}function ks(i,s,c){s==="number"&&Po(i.ownerDocument)===i||i.defaultValue===""+c||(i.defaultValue=""+c)}function zi(i,s,c,h){if(i=i.options,s){s={};for(var g=0;g<c.length;g++)s["$"+c[g]]=!0;for(c=0;c<i.length;c++)g=s.hasOwnProperty("$"+i[c].value),i[c].selected!==g&&(i[c].selected=g),g&&h&&(i[c].defaultSelected=!0)}else{for(c=""+jn(c),s=null,g=0;g<i.length;g++){if(i[g].value===c){i[g].selected=!0,h&&(i[g].defaultSelected=!0);return}s!==null||i[g].disabled||(s=i[g])}s!==null&&(s.selected=!0)}}function er(i,s,c){if(s!=null&&(s=""+jn(s),s!==i.value&&(i.value=s),c==null)){i.defaultValue!==s&&(i.defaultValue=s);return}i.defaultValue=c!=null?""+jn(c):""}function Mo(i,s,c,h){if(s==null){if(h!=null){if(c!=null)throw Error(n(92));if(we(h)){if(1<h.length)throw Error(n(93));h=h[0]}c=h}c==null&&(c=""),s=c}c=jn(s),i.defaultValue=c,h=i.textContent,h===c&&h!==""&&h!==null&&(i.value=h)}function ba(i,s){if(s){var c=i.firstChild;if(c&&c===i.lastChild&&c.nodeType===3){c.nodeValue=s;return}}i.textContent=s}var Uo=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function P0(i,s,c){var h=s.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?h?i.setProperty(s,""):s==="float"?i.cssFloat="":i[s]="":h?i.setProperty(s,c):typeof c!="number"||c===0||Uo.has(s)?s==="float"?i.cssFloat=c:i[s]=(""+c).trim():i[s]=c+"px"}function pu(i,s,c){if(s!=null&&typeof s!="object")throw Error(n(62));if(i=i.style,c!=null){for(var h in c)!c.hasOwnProperty(h)||s!=null&&s.hasOwnProperty(h)||(h.indexOf("--")===0?i.setProperty(h,""):h==="float"?i.cssFloat="":i[h]="");for(var g in s)h=s[g],s.hasOwnProperty(g)&&c[g]!==h&&P0(i,g,h)}else for(var x in s)s.hasOwnProperty(x)&&P0(i,x,s[x])}function gu(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var zm=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Gm=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Gl(i){return Gm.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}var Gi=null;function Sa(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var qi=null,Wi=null;function xu(i){var s=J(i);if(s&&(i=s.stateNode)){var c=i[mr]||null;e:switch(i=s.stateNode,s.type){case"input":if(sa(i,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),s=c.name,c.type==="radio"&&s!=null){for(c=i;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+Ur(""+s)+'"][type="radio"]'),s=0;s<c.length;s++){var h=c[s];if(h!==i&&h.form===i.form){var g=h[mr]||null;if(!g)throw Error(n(90));sa(h,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(s=0;s<c.length;s++)h=c[s],h.form===i.form&&mu(h)}break e;case"textarea":er(i,c.value,c.defaultValue);break e;case"select":s=c.value,s!=null&&zi(i,!!c.multiple,s,!1)}}}var fi=!1;function L0(i,s,c){if(fi)return i(s,c);fi=!0;try{var h=i(s);return h}finally{if(fi=!1,(qi!==null||Wi!==null)&&(Rh(),qi&&(s=qi,i=Wi,Wi=qi=null,xu(s),i)))for(s=0;s<i.length;s++)xu(i[s])}}function Bo(i,s){var c=i.stateNode;if(c===null)return null;var h=c[mr]||null;if(h===null)return null;c=h[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(i=i.type,h=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!h;break e;default:i=!1}if(i)return null;if(c&&typeof c!="function")throw Error(n(231,s,typeof c));return c}var Xa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Aa=!1;if(Xa)try{var Vo={};Object.defineProperty(Vo,"passive",{get:function(){Aa=!0}}),window.addEventListener("test",Vo,Vo),window.removeEventListener("test",Vo,Vo)}catch{Aa=!1}var hi=null,Cs=null,Xi=null;function vu(){if(Xi)return Xi;var i,s=Cs,c=s.length,h,g="value"in hi?hi.value:hi.textContent,x=g.length;for(i=0;i<c&&s[i]===g[i];i++);var R=c-i;for(h=1;h<=R&&s[c-h]===g[x-h];h++);return Xi=g.slice(i,1<h?1-h:void 0)}function di(i){var s=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&s===13&&(i=13)):i=s,i===10&&(i=13),32<=i||i===13?i:0}function mi(){return!0}function _u(){return!1}function rn(i){function s(c,h,g,x,R){this._reactName=c,this._targetInst=g,this.type=h,this.nativeEvent=x,this.target=R,this.currentTarget=null;for(var U in i)i.hasOwnProperty(U)&&(c=i[U],this[U]=c?c(x):x[U]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?mi:_u,this.isPropagationStopped=_u,this}return m(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=mi)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=mi)},persist:function(){},isPersistent:mi}),s}var Wt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ql=rn(Wt),jo=m({},Wt,{view:0,detail:0}),M0=rn(jo),Wl,Xl,pi,Ho=m({},jo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:qo,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==pi&&(pi&&i.type==="mousemove"?(Wl=i.screenX-pi.screenX,Xl=i.screenY-pi.screenY):Xl=Wl=0,pi=i),Wl)},movementY:function(i){return"movementY"in i?i.movementY:Xl}}),ka=rn(Ho),U0=m({},Ho,{dataTransfer:0}),qm=rn(U0),zo=m({},jo,{relatedTarget:0}),Kl=rn(zo),yu=m({},Wt,{animationName:0,elapsedTime:0,pseudoElement:0}),Yl=rn(yu),B0=m({},Wt,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),$l=rn(B0),Wm=m({},Wt,{data:0}),wu=rn(Wm),Go={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},V0={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},j0={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Eu(i){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(i):(i=j0[i])?!!s[i]:!1}function qo(){return Eu}var H0=m({},jo,{key:function(i){if(i.key){var s=Go[i.key]||i.key;if(s!=="Unidentified")return s}return i.type==="keypress"?(i=di(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?V0[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:qo,charCode:function(i){return i.type==="keypress"?di(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?di(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),Ql=rn(H0),z0=m({},Ho,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Tu=rn(z0),Ki=m({},jo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:qo}),G0=rn(Ki),q0=m({},Wt,{propertyName:0,elapsedTime:0,pseudoElement:0}),W0=rn(q0),X0=m({},Ho,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Zl=rn(X0),Hn=m({},Wt,{newState:0,oldState:0}),K0=rn(Hn),Y0=[9,13,27,32],gi=Xa&&"CompositionEvent"in window,p=null;Xa&&"documentMode"in document&&(p=document.documentMode);var T=Xa&&"TextEvent"in window&&!p,C=Xa&&(!gi||p&&8<p&&11>=p),j=" ",fe=!1;function be(i,s){switch(i){case"keyup":return Y0.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ge(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Ft=!1;function Kr(i,s){switch(i){case"compositionend":return Ge(s);case"keypress":return s.which!==32?null:(fe=!0,j);case"textInput":return i=s.data,i===j&&fe?null:i;default:return null}}function Pt(i,s){if(Ft)return i==="compositionend"||!gi&&be(i,s)?(i=vu(),Xi=Cs=hi=null,Ft=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return C&&s.locale!=="ko"?null:s.data;default:return null}}var nn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Yr(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s==="input"?!!nn[i.type]:s==="textarea"}function Yi(i,s,c,h){qi?Wi?Wi.push(h):Wi=[h]:qi=h,s=Ph(s,"onChange"),0<s.length&&(c=new ql("onChange","change",null,c,h),i.push({event:c,listeners:s}))}var dn=null,xi=null;function bu(i){F2(i,0)}function $0(i){var s=me(i);if(mu(s))return i}function t_(i,s){if(i==="change")return s}var r_=!1;if(Xa){var Xm;if(Xa){var Km="oninput"in document;if(!Km){var n_=document.createElement("div");n_.setAttribute("oninput","return;"),Km=typeof n_.oninput=="function"}Xm=Km}else Xm=!1;r_=Xm&&(!document.documentMode||9<document.documentMode)}function a_(){dn&&(dn.detachEvent("onpropertychange",i_),xi=dn=null)}function i_(i){if(i.propertyName==="value"&&$0(xi)){var s=[];Yi(s,xi,i,Sa(i)),L0(bu,s)}}function gC(i,s,c){i==="focusin"?(a_(),dn=s,xi=c,dn.attachEvent("onpropertychange",i_)):i==="focusout"&&a_()}function xC(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return $0(xi)}function vC(i,s){if(i==="click")return $0(s)}function _C(i,s){if(i==="input"||i==="change")return $0(s)}function yC(i,s){return i===s&&(i!==0||1/i===1/s)||i!==i&&s!==s}var oa=typeof Object.is=="function"?Object.is:yC;function Su(i,s){if(oa(i,s))return!0;if(typeof i!="object"||i===null||typeof s!="object"||s===null)return!1;var c=Object.keys(i),h=Object.keys(s);if(c.length!==h.length)return!1;for(h=0;h<c.length;h++){var g=c[h];if(!X.call(s,g)||!oa(i[g],s[g]))return!1}return!0}function s_(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function o_(i,s){var c=s_(i);i=0;for(var h;c;){if(c.nodeType===3){if(h=i+c.textContent.length,i<=s&&h>=s)return{node:c,offset:s-i};i=h}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=s_(c)}}function l_(i,s){return i&&s?i===s?!0:i&&i.nodeType===3?!1:s&&s.nodeType===3?l_(i,s.parentNode):"contains"in i?i.contains(s):i.compareDocumentPosition?!!(i.compareDocumentPosition(s)&16):!1:!1}function c_(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var s=Po(i.document);s instanceof i.HTMLIFrameElement;){try{var c=typeof s.contentWindow.location.href=="string"}catch{c=!1}if(c)i=s.contentWindow;else break;s=Po(i.document)}return s}function Ym(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s&&(s==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||s==="textarea"||i.contentEditable==="true")}var wC=Xa&&"documentMode"in document&&11>=document.documentMode,Jl=null,$m=null,Au=null,Qm=!1;function u_(i,s,c){var h=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Qm||Jl==null||Jl!==Po(h)||(h=Jl,"selectionStart"in h&&Ym(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),Au&&Su(Au,h)||(Au=h,h=Ph($m,"onSelect"),0<h.length&&(s=new ql("onSelect","select",null,s,c),i.push({event:s,listeners:h}),s.target=Jl)))}function Wo(i,s){var c={};return c[i.toLowerCase()]=s.toLowerCase(),c["Webkit"+i]="webkit"+s,c["Moz"+i]="moz"+s,c}var ec={animationend:Wo("Animation","AnimationEnd"),animationiteration:Wo("Animation","AnimationIteration"),animationstart:Wo("Animation","AnimationStart"),transitionrun:Wo("Transition","TransitionRun"),transitionstart:Wo("Transition","TransitionStart"),transitioncancel:Wo("Transition","TransitionCancel"),transitionend:Wo("Transition","TransitionEnd")},Zm={},f_={};Xa&&(f_=document.createElement("div").style,"AnimationEvent"in window||(delete ec.animationend.animation,delete ec.animationiteration.animation,delete ec.animationstart.animation),"TransitionEvent"in window||delete ec.transitionend.transition);function Xo(i){if(Zm[i])return Zm[i];if(!ec[i])return i;var s=ec[i],c;for(c in s)if(s.hasOwnProperty(c)&&c in f_)return Zm[i]=s[c];return i}var h_=Xo("animationend"),d_=Xo("animationiteration"),m_=Xo("animationstart"),EC=Xo("transitionrun"),TC=Xo("transitionstart"),bC=Xo("transitioncancel"),p_=Xo("transitionend"),g_=new Map,Jm="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Jm.push("scrollEnd");function Ka(i,s){g_.set(i,s),Le(s,[i])}var x_=new WeakMap;function Ca(i,s){if(typeof i=="object"&&i!==null){var c=x_.get(i);return c!==void 0?c:(s={value:i,source:s,stack:Hl(s)},x_.set(i,s),s)}return{value:i,source:s,stack:Hl(s)}}var Ra=[],tc=0,ep=0;function Q0(){for(var i=tc,s=ep=tc=0;s<i;){var c=Ra[s];Ra[s++]=null;var h=Ra[s];Ra[s++]=null;var g=Ra[s];Ra[s++]=null;var x=Ra[s];if(Ra[s++]=null,h!==null&&g!==null){var R=h.pending;R===null?g.next=g:(g.next=R.next,R.next=g),h.pending=g}x!==0&&v_(c,g,x)}}function Z0(i,s,c,h){Ra[tc++]=i,Ra[tc++]=s,Ra[tc++]=c,Ra[tc++]=h,ep|=h,i.lanes|=h,i=i.alternate,i!==null&&(i.lanes|=h)}function tp(i,s,c,h){return Z0(i,s,c,h),J0(i)}function rc(i,s){return Z0(i,null,null,s),J0(i)}function v_(i,s,c){i.lanes|=c;var h=i.alternate;h!==null&&(h.lanes|=c);for(var g=!1,x=i.return;x!==null;)x.childLanes|=c,h=x.alternate,h!==null&&(h.childLanes|=c),x.tag===22&&(i=x.stateNode,i===null||i._visibility&1||(g=!0)),i=x,x=x.return;return i.tag===3?(x=i.stateNode,g&&s!==null&&(g=31-Me(c),i=x.hiddenUpdates,h=i[g],h===null?i[g]=[s]:h.push(s),s.lane=c|536870912),x):null}function J0(i){if(50<Qu)throw Qu=0,og=null,Error(n(185));for(var s=i.return;s!==null;)i=s,s=i.return;return i.tag===3?i.stateNode:null}var nc={};function SC(i,s,c,h){this.tag=i,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function la(i,s,c,h){return new SC(i,s,c,h)}function rp(i){return i=i.prototype,!(!i||!i.isReactComponent)}function $i(i,s){var c=i.alternate;return c===null?(c=la(i.tag,s,i.key,i.mode),c.elementType=i.elementType,c.type=i.type,c.stateNode=i.stateNode,c.alternate=i,i.alternate=c):(c.pendingProps=s,c.type=i.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=i.flags&65011712,c.childLanes=i.childLanes,c.lanes=i.lanes,c.child=i.child,c.memoizedProps=i.memoizedProps,c.memoizedState=i.memoizedState,c.updateQueue=i.updateQueue,s=i.dependencies,c.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},c.sibling=i.sibling,c.index=i.index,c.ref=i.ref,c.refCleanup=i.refCleanup,c}function __(i,s){i.flags&=65011714;var c=i.alternate;return c===null?(i.childLanes=0,i.lanes=s,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=c.childLanes,i.lanes=c.lanes,i.child=c.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=c.memoizedProps,i.memoizedState=c.memoizedState,i.updateQueue=c.updateQueue,i.type=c.type,s=c.dependencies,i.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),i}function eh(i,s,c,h,g,x){var R=0;if(h=i,typeof i=="function")rp(i)&&(R=1);else if(typeof i=="string")R=k3(i,c,Y.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case A:return i=la(31,c,s,g),i.elementType=A,i.lanes=x,i;case S:return Ko(c.children,g,x,s);case w:R=8,g|=24;break;case b:return i=la(12,c,s,g|2),i.elementType=b,i.lanes=x,i;case q:return i=la(13,c,s,g),i.elementType=q,i.lanes=x,i;case W:return i=la(19,c,s,g),i.elementType=W,i.lanes=x,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case L:case F:R=10;break e;case B:R=9;break e;case z:R=11;break e;case k:R=14;break e;case I:R=16,h=null;break e}R=29,c=Error(n(130,i===null?"null":typeof i,"")),h=null}return s=la(R,c,s,g),s.elementType=i,s.type=h,s.lanes=x,s}function Ko(i,s,c,h){return i=la(7,i,h,s),i.lanes=c,i}function np(i,s,c){return i=la(6,i,null,s),i.lanes=c,i}function ap(i,s,c){return s=la(4,i.children!==null?i.children:[],i.key,s),s.lanes=c,s.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},s}var ac=[],ic=0,th=null,rh=0,Na=[],Ia=0,Yo=null,Qi=1,Zi="";function $o(i,s){ac[ic++]=rh,ac[ic++]=th,th=i,rh=s}function y_(i,s,c){Na[Ia++]=Qi,Na[Ia++]=Zi,Na[Ia++]=Yo,Yo=i;var h=Qi;i=Zi;var g=32-Me(h)-1;h&=~(1<<g),c+=1;var x=32-Me(s)+g;if(30<x){var R=g-g%5;x=(h&(1<<R)-1).toString(32),h>>=R,g-=R,Qi=1<<32-Me(s)+g|c<<g|h,Zi=x+i}else Qi=1<<x|c<<g|h,Zi=i}function ip(i){i.return!==null&&($o(i,1),y_(i,1,0))}function sp(i){for(;i===th;)th=ac[--ic],ac[ic]=null,rh=ac[--ic],ac[ic]=null;for(;i===Yo;)Yo=Na[--Ia],Na[Ia]=null,Zi=Na[--Ia],Na[Ia]=null,Qi=Na[--Ia],Na[Ia]=null}var zn=null,wr=null,Gt=!1,Qo=null,vi=!1,op=Error(n(519));function Zo(i){var s=Error(n(418,""));throw Ru(Ca(s,i)),op}function w_(i){var s=i.stateNode,c=i.type,h=i.memoizedProps;switch(s[Nr]=i,s[mr]=h,c){case"dialog":Rt("cancel",s),Rt("close",s);break;case"iframe":case"object":case"embed":Rt("load",s);break;case"video":case"audio":for(c=0;c<Ju.length;c++)Rt(Ju[c],s);break;case"source":Rt("error",s);break;case"img":case"image":case"link":Rt("error",s),Rt("load",s);break;case"details":Rt("toggle",s);break;case"input":Rt("invalid",s),Lo(s,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0),zl(s);break;case"select":Rt("invalid",s);break;case"textarea":Rt("invalid",s),Mo(s,h.value,h.defaultValue,h.children),zl(s)}c=h.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||s.textContent===""+c||h.suppressHydrationWarning===!0||U2(s.textContent,c)?(h.popover!=null&&(Rt("beforetoggle",s),Rt("toggle",s)),h.onScroll!=null&&Rt("scroll",s),h.onScrollEnd!=null&&Rt("scrollend",s),h.onClick!=null&&(s.onclick=Lh),s=!0):s=!1,s||Zo(i)}function E_(i){for(zn=i.return;zn;)switch(zn.tag){case 5:case 13:vi=!1;return;case 27:case 3:vi=!0;return;default:zn=zn.return}}function ku(i){if(i!==zn)return!1;if(!Gt)return E_(i),Gt=!0,!1;var s=i.tag,c;if((c=s!==3&&s!==27)&&((c=s===5)&&(c=i.type,c=!(c!=="form"&&c!=="button")||Tg(i.type,i.memoizedProps)),c=!c),c&&wr&&Zo(i),E_(i),s===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(317));e:{for(i=i.nextSibling,s=0;i;){if(i.nodeType===8)if(c=i.data,c==="/$"){if(s===0){wr=$a(i.nextSibling);break e}s--}else c!=="$"&&c!=="$!"&&c!=="$?"||s++;i=i.nextSibling}wr=null}}else s===27?(s=wr,Gs(i.type)?(i=kg,kg=null,wr=i):wr=s):wr=zn?$a(i.stateNode.nextSibling):null;return!0}function Cu(){wr=zn=null,Gt=!1}function T_(){var i=Qo;return i!==null&&(Jn===null?Jn=i:Jn.push.apply(Jn,i),Qo=null),i}function Ru(i){Qo===null?Qo=[i]:Qo.push(i)}var lp=ge(null),Jo=null,Ji=null;function Rs(i,s,c){K(lp,s._currentValue),s._currentValue=c}function es(i){i._currentValue=lp.current,V(lp)}function cp(i,s,c){for(;i!==null;){var h=i.alternate;if((i.childLanes&s)!==s?(i.childLanes|=s,h!==null&&(h.childLanes|=s)):h!==null&&(h.childLanes&s)!==s&&(h.childLanes|=s),i===c)break;i=i.return}}function up(i,s,c,h){var g=i.child;for(g!==null&&(g.return=i);g!==null;){var x=g.dependencies;if(x!==null){var R=g.child;x=x.firstContext;e:for(;x!==null;){var U=x;x=g;for(var re=0;re<s.length;re++)if(U.context===s[re]){x.lanes|=c,U=x.alternate,U!==null&&(U.lanes|=c),cp(x.return,c,i),h||(R=null);break e}x=U.next}}else if(g.tag===18){if(R=g.return,R===null)throw Error(n(341));R.lanes|=c,x=R.alternate,x!==null&&(x.lanes|=c),cp(R,c,i),R=null}else R=g.child;if(R!==null)R.return=g;else for(R=g;R!==null;){if(R===i){R=null;break}if(g=R.sibling,g!==null){g.return=R.return,R=g;break}R=R.return}g=R}}function Nu(i,s,c,h){i=null;for(var g=s,x=!1;g!==null;){if(!x){if((g.flags&524288)!==0)x=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var R=g.alternate;if(R===null)throw Error(n(387));if(R=R.memoizedProps,R!==null){var U=g.type;oa(g.pendingProps.value,R.value)||(i!==null?i.push(U):i=[U])}}else if(g===De.current){if(R=g.alternate,R===null)throw Error(n(387));R.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(i!==null?i.push(sf):i=[sf])}g=g.return}i!==null&&up(s,i,c,h),s.flags|=262144}function nh(i){for(i=i.firstContext;i!==null;){if(!oa(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function el(i){Jo=i,Ji=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function bn(i){return b_(Jo,i)}function ah(i,s){return Jo===null&&el(i),b_(i,s)}function b_(i,s){var c=s._currentValue;if(s={context:s,memoizedValue:c,next:null},Ji===null){if(i===null)throw Error(n(308));Ji=s,i.dependencies={lanes:0,firstContext:s},i.flags|=524288}else Ji=Ji.next=s;return c}var AC=typeof AbortController<"u"?AbortController:function(){var i=[],s=this.signal={aborted:!1,addEventListener:function(c,h){i.push(h)}};this.abort=function(){s.aborted=!0,i.forEach(function(c){return c()})}},kC=t.unstable_scheduleCallback,CC=t.unstable_NormalPriority,$r={$$typeof:F,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function fp(){return{controller:new AC,data:new Map,refCount:0}}function Iu(i){i.refCount--,i.refCount===0&&kC(CC,function(){i.controller.abort()})}var Du=null,hp=0,sc=0,oc=null;function RC(i,s){if(Du===null){var c=Du=[];hp=0,sc=mg(),oc={status:"pending",value:void 0,then:function(h){c.push(h)}}}return hp++,s.then(S_,S_),s}function S_(){if(--hp===0&&Du!==null){oc!==null&&(oc.status="fulfilled");var i=Du;Du=null,sc=0,oc=null;for(var s=0;s<i.length;s++)(0,i[s])()}}function NC(i,s){var c=[],h={status:"pending",value:null,reason:null,then:function(g){c.push(g)}};return i.then(function(){h.status="fulfilled",h.value=s;for(var g=0;g<c.length;g++)(0,c[g])(s)},function(g){for(h.status="rejected",h.reason=g,g=0;g<c.length;g++)(0,c[g])(void 0)}),h}var A_=ne.S;ne.S=function(i,s){typeof s=="object"&&s!==null&&typeof s.then=="function"&&RC(i,s),A_!==null&&A_(i,s)};var tl=ge(null);function dp(){var i=tl.current;return i!==null?i:lr.pooledCache}function ih(i,s){s===null?K(tl,tl.current):K(tl,s.pool)}function k_(){var i=dp();return i===null?null:{parent:$r._currentValue,pool:i}}var Ou=Error(n(460)),C_=Error(n(474)),sh=Error(n(542)),mp={then:function(){}};function R_(i){return i=i.status,i==="fulfilled"||i==="rejected"}function oh(){}function N_(i,s,c){switch(c=i[c],c===void 0?i.push(s):c!==s&&(s.then(oh,oh),s=c),s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,D_(i),i;default:if(typeof s.status=="string")s.then(oh,oh);else{if(i=lr,i!==null&&100<i.shellSuspendCounter)throw Error(n(482));i=s,i.status="pending",i.then(function(h){if(s.status==="pending"){var g=s;g.status="fulfilled",g.value=h}},function(h){if(s.status==="pending"){var g=s;g.status="rejected",g.reason=h}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,D_(i),i}throw Fu=s,Ou}}var Fu=null;function I_(){if(Fu===null)throw Error(n(459));var i=Fu;return Fu=null,i}function D_(i){if(i===Ou||i===sh)throw Error(n(483))}var Ns=!1;function pp(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function gp(i,s){i=i.updateQueue,s.updateQueue===i&&(s.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function Is(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function Ds(i,s,c){var h=i.updateQueue;if(h===null)return null;if(h=h.shared,(Kt&2)!==0){var g=h.pending;return g===null?s.next=s:(s.next=g.next,g.next=s),h.pending=s,s=J0(i),v_(i,null,c),s}return Z0(i,h,s,c),J0(i)}function Pu(i,s,c){if(s=s.updateQueue,s!==null&&(s=s.shared,(c&4194048)!==0)){var h=s.lanes;h&=i.pendingLanes,c|=h,s.lanes=c,Oo(i,c)}}function xp(i,s){var c=i.updateQueue,h=i.alternate;if(h!==null&&(h=h.updateQueue,c===h)){var g=null,x=null;if(c=c.firstBaseUpdate,c!==null){do{var R={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};x===null?g=x=R:x=x.next=R,c=c.next}while(c!==null);x===null?g=x=s:x=x.next=s}else g=x=s;c={baseState:h.baseState,firstBaseUpdate:g,lastBaseUpdate:x,shared:h.shared,callbacks:h.callbacks},i.updateQueue=c;return}i=c.lastBaseUpdate,i===null?c.firstBaseUpdate=s:i.next=s,c.lastBaseUpdate=s}var vp=!1;function Lu(){if(vp){var i=oc;if(i!==null)throw i}}function Mu(i,s,c,h){vp=!1;var g=i.updateQueue;Ns=!1;var x=g.firstBaseUpdate,R=g.lastBaseUpdate,U=g.shared.pending;if(U!==null){g.shared.pending=null;var re=U,pe=re.next;re.next=null,R===null?x=pe:R.next=pe,R=re;var Ae=i.alternate;Ae!==null&&(Ae=Ae.updateQueue,U=Ae.lastBaseUpdate,U!==R&&(U===null?Ae.firstBaseUpdate=pe:U.next=pe,Ae.lastBaseUpdate=re))}if(x!==null){var Ie=g.baseState;R=0,Ae=pe=re=null,U=x;do{var _e=U.lane&-536870913,Ee=_e!==U.lane;if(Ee?(Lt&_e)===_e:(h&_e)===_e){_e!==0&&_e===sc&&(vp=!0),Ae!==null&&(Ae=Ae.next={lane:0,tag:U.tag,payload:U.payload,callback:null,next:null});e:{var ht=i,it=U;_e=s;var nr=c;switch(it.tag){case 1:if(ht=it.payload,typeof ht=="function"){Ie=ht.call(nr,Ie,_e);break e}Ie=ht;break e;case 3:ht.flags=ht.flags&-65537|128;case 0:if(ht=it.payload,_e=typeof ht=="function"?ht.call(nr,Ie,_e):ht,_e==null)break e;Ie=m({},Ie,_e);break e;case 2:Ns=!0}}_e=U.callback,_e!==null&&(i.flags|=64,Ee&&(i.flags|=8192),Ee=g.callbacks,Ee===null?g.callbacks=[_e]:Ee.push(_e))}else Ee={lane:_e,tag:U.tag,payload:U.payload,callback:U.callback,next:null},Ae===null?(pe=Ae=Ee,re=Ie):Ae=Ae.next=Ee,R|=_e;if(U=U.next,U===null){if(U=g.shared.pending,U===null)break;Ee=U,U=Ee.next,Ee.next=null,g.lastBaseUpdate=Ee,g.shared.pending=null}}while(!0);Ae===null&&(re=Ie),g.baseState=re,g.firstBaseUpdate=pe,g.lastBaseUpdate=Ae,x===null&&(g.shared.lanes=0),Vs|=R,i.lanes=R,i.memoizedState=Ie}}function O_(i,s){if(typeof i!="function")throw Error(n(191,i));i.call(s)}function F_(i,s){var c=i.callbacks;if(c!==null)for(i.callbacks=null,i=0;i<c.length;i++)O_(c[i],s)}var lc=ge(null),lh=ge(0);function P_(i,s){i=os,K(lh,i),K(lc,s),os=i|s.baseLanes}function _p(){K(lh,os),K(lc,lc.current)}function yp(){os=lh.current,V(lc),V(lh)}var Os=0,Et=null,tr=null,Br=null,ch=!1,cc=!1,rl=!1,uh=0,Uu=0,uc=null,IC=0;function Ir(){throw Error(n(321))}function wp(i,s){if(s===null)return!1;for(var c=0;c<s.length&&c<i.length;c++)if(!oa(i[c],s[c]))return!1;return!0}function Ep(i,s,c,h,g,x){return Os=x,Et=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,ne.H=i===null||i.memoizedState===null?vy:_y,rl=!1,x=c(h,g),rl=!1,cc&&(x=M_(s,c,h,g)),L_(i),x}function L_(i){ne.H=gh;var s=tr!==null&&tr.next!==null;if(Os=0,Br=tr=Et=null,ch=!1,Uu=0,uc=null,s)throw Error(n(300));i===null||an||(i=i.dependencies,i!==null&&nh(i)&&(an=!0))}function M_(i,s,c,h){Et=i;var g=0;do{if(cc&&(uc=null),Uu=0,cc=!1,25<=g)throw Error(n(301));if(g+=1,Br=tr=null,i.updateQueue!=null){var x=i.updateQueue;x.lastEffect=null,x.events=null,x.stores=null,x.memoCache!=null&&(x.memoCache.index=0)}ne.H=UC,x=s(c,h)}while(cc);return x}function DC(){var i=ne.H,s=i.useState()[0];return s=typeof s.then=="function"?Bu(s):s,i=i.useState()[0],(tr!==null?tr.memoizedState:null)!==i&&(Et.flags|=1024),s}function Tp(){var i=uh!==0;return uh=0,i}function bp(i,s,c){s.updateQueue=i.updateQueue,s.flags&=-2053,i.lanes&=~c}function Sp(i){if(ch){for(i=i.memoizedState;i!==null;){var s=i.queue;s!==null&&(s.pending=null),i=i.next}ch=!1}Os=0,Br=tr=Et=null,cc=!1,Uu=uh=0,uc=null}function Qn(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Br===null?Et.memoizedState=Br=i:Br=Br.next=i,Br}function Vr(){if(tr===null){var i=Et.alternate;i=i!==null?i.memoizedState:null}else i=tr.next;var s=Br===null?Et.memoizedState:Br.next;if(s!==null)Br=s,tr=i;else{if(i===null)throw Et.alternate===null?Error(n(467)):Error(n(310));tr=i,i={memoizedState:tr.memoizedState,baseState:tr.baseState,baseQueue:tr.baseQueue,queue:tr.queue,next:null},Br===null?Et.memoizedState=Br=i:Br=Br.next=i}return Br}function Ap(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Bu(i){var s=Uu;return Uu+=1,uc===null&&(uc=[]),i=N_(uc,i,s),s=Et,(Br===null?s.memoizedState:Br.next)===null&&(s=s.alternate,ne.H=s===null||s.memoizedState===null?vy:_y),i}function fh(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return Bu(i);if(i.$$typeof===F)return bn(i)}throw Error(n(438,String(i)))}function kp(i){var s=null,c=Et.updateQueue;if(c!==null&&(s=c.memoCache),s==null){var h=Et.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(s={data:h.data.map(function(g){return g.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),c===null&&(c=Ap(),Et.updateQueue=c),c.memoCache=s,c=s.data[s.index],c===void 0)for(c=s.data[s.index]=Array(i),h=0;h<i;h++)c[h]=O;return s.index++,c}function ts(i,s){return typeof s=="function"?s(i):s}function hh(i){var s=Vr();return Cp(s,tr,i)}function Cp(i,s,c){var h=i.queue;if(h===null)throw Error(n(311));h.lastRenderedReducer=c;var g=i.baseQueue,x=h.pending;if(x!==null){if(g!==null){var R=g.next;g.next=x.next,x.next=R}s.baseQueue=g=x,h.pending=null}if(x=i.baseState,g===null)i.memoizedState=x;else{s=g.next;var U=R=null,re=null,pe=s,Ae=!1;do{var Ie=pe.lane&-536870913;if(Ie!==pe.lane?(Lt&Ie)===Ie:(Os&Ie)===Ie){var _e=pe.revertLane;if(_e===0)re!==null&&(re=re.next={lane:0,revertLane:0,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null}),Ie===sc&&(Ae=!0);else if((Os&_e)===_e){pe=pe.next,_e===sc&&(Ae=!0);continue}else Ie={lane:0,revertLane:pe.revertLane,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null},re===null?(U=re=Ie,R=x):re=re.next=Ie,Et.lanes|=_e,Vs|=_e;Ie=pe.action,rl&&c(x,Ie),x=pe.hasEagerState?pe.eagerState:c(x,Ie)}else _e={lane:Ie,revertLane:pe.revertLane,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null},re===null?(U=re=_e,R=x):re=re.next=_e,Et.lanes|=Ie,Vs|=Ie;pe=pe.next}while(pe!==null&&pe!==s);if(re===null?R=x:re.next=U,!oa(x,i.memoizedState)&&(an=!0,Ae&&(c=oc,c!==null)))throw c;i.memoizedState=x,i.baseState=R,i.baseQueue=re,h.lastRenderedState=x}return g===null&&(h.lanes=0),[i.memoizedState,h.dispatch]}function Rp(i){var s=Vr(),c=s.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=i;var h=c.dispatch,g=c.pending,x=s.memoizedState;if(g!==null){c.pending=null;var R=g=g.next;do x=i(x,R.action),R=R.next;while(R!==g);oa(x,s.memoizedState)||(an=!0),s.memoizedState=x,s.baseQueue===null&&(s.baseState=x),c.lastRenderedState=x}return[x,h]}function U_(i,s,c){var h=Et,g=Vr(),x=Gt;if(x){if(c===void 0)throw Error(n(407));c=c()}else c=s();var R=!oa((tr||g).memoizedState,c);R&&(g.memoizedState=c,an=!0),g=g.queue;var U=j_.bind(null,h,g,i);if(Vu(2048,8,U,[i]),g.getSnapshot!==s||R||Br!==null&&Br.memoizedState.tag&1){if(h.flags|=2048,fc(9,dh(),V_.bind(null,h,g,c,s),null),lr===null)throw Error(n(349));x||(Os&124)!==0||B_(h,s,c)}return c}function B_(i,s,c){i.flags|=16384,i={getSnapshot:s,value:c},s=Et.updateQueue,s===null?(s=Ap(),Et.updateQueue=s,s.stores=[i]):(c=s.stores,c===null?s.stores=[i]:c.push(i))}function V_(i,s,c,h){s.value=c,s.getSnapshot=h,H_(s)&&z_(i)}function j_(i,s,c){return c(function(){H_(s)&&z_(i)})}function H_(i){var s=i.getSnapshot;i=i.value;try{var c=s();return!oa(i,c)}catch{return!0}}function z_(i){var s=rc(i,2);s!==null&&da(s,i,2)}function Np(i){var s=Qn();if(typeof i=="function"){var c=i;if(i=c(),rl){se(!0);try{c()}finally{se(!1)}}}return s.memoizedState=s.baseState=i,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ts,lastRenderedState:i},s}function G_(i,s,c,h){return i.baseState=c,Cp(i,tr,typeof h=="function"?h:ts)}function OC(i,s,c,h,g){if(ph(i))throw Error(n(485));if(i=s.action,i!==null){var x={payload:g,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(R){x.listeners.push(R)}};ne.T!==null?c(!0):x.isTransition=!1,h(x),c=s.pending,c===null?(x.next=s.pending=x,q_(s,x)):(x.next=c.next,s.pending=c.next=x)}}function q_(i,s){var c=s.action,h=s.payload,g=i.state;if(s.isTransition){var x=ne.T,R={};ne.T=R;try{var U=c(g,h),re=ne.S;re!==null&&re(R,U),W_(i,s,U)}catch(pe){Ip(i,s,pe)}finally{ne.T=x}}else try{x=c(g,h),W_(i,s,x)}catch(pe){Ip(i,s,pe)}}function W_(i,s,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(h){X_(i,s,h)},function(h){return Ip(i,s,h)}):X_(i,s,c)}function X_(i,s,c){s.status="fulfilled",s.value=c,K_(s),i.state=c,s=i.pending,s!==null&&(c=s.next,c===s?i.pending=null:(c=c.next,s.next=c,q_(i,c)))}function Ip(i,s,c){var h=i.pending;if(i.pending=null,h!==null){h=h.next;do s.status="rejected",s.reason=c,K_(s),s=s.next;while(s!==h)}i.action=null}function K_(i){i=i.listeners;for(var s=0;s<i.length;s++)(0,i[s])()}function Y_(i,s){return s}function $_(i,s){if(Gt){var c=lr.formState;if(c!==null){e:{var h=Et;if(Gt){if(wr){t:{for(var g=wr,x=vi;g.nodeType!==8;){if(!x){g=null;break t}if(g=$a(g.nextSibling),g===null){g=null;break t}}x=g.data,g=x==="F!"||x==="F"?g:null}if(g){wr=$a(g.nextSibling),h=g.data==="F!";break e}}Zo(h)}h=!1}h&&(s=c[0])}}return c=Qn(),c.memoizedState=c.baseState=s,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Y_,lastRenderedState:s},c.queue=h,c=py.bind(null,Et,h),h.dispatch=c,h=Np(!1),x=Lp.bind(null,Et,!1,h.queue),h=Qn(),g={state:s,dispatch:null,action:i,pending:null},h.queue=g,c=OC.bind(null,Et,g,x,c),g.dispatch=c,h.memoizedState=i,[s,c,!1]}function Q_(i){var s=Vr();return Z_(s,tr,i)}function Z_(i,s,c){if(s=Cp(i,s,Y_)[0],i=hh(ts)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var h=Bu(s)}catch(R){throw R===Ou?sh:R}else h=s;s=Vr();var g=s.queue,x=g.dispatch;return c!==s.memoizedState&&(Et.flags|=2048,fc(9,dh(),FC.bind(null,g,c),null)),[h,x,i]}function FC(i,s){i.action=s}function J_(i){var s=Vr(),c=tr;if(c!==null)return Z_(s,c,i);Vr(),s=s.memoizedState,c=Vr();var h=c.queue.dispatch;return c.memoizedState=i,[s,h,!1]}function fc(i,s,c,h){return i={tag:i,create:c,deps:h,inst:s,next:null},s=Et.updateQueue,s===null&&(s=Ap(),Et.updateQueue=s),c=s.lastEffect,c===null?s.lastEffect=i.next=i:(h=c.next,c.next=i,i.next=h,s.lastEffect=i),i}function dh(){return{destroy:void 0,resource:void 0}}function ey(){return Vr().memoizedState}function mh(i,s,c,h){var g=Qn();h=h===void 0?null:h,Et.flags|=i,g.memoizedState=fc(1|s,dh(),c,h)}function Vu(i,s,c,h){var g=Vr();h=h===void 0?null:h;var x=g.memoizedState.inst;tr!==null&&h!==null&&wp(h,tr.memoizedState.deps)?g.memoizedState=fc(s,x,c,h):(Et.flags|=i,g.memoizedState=fc(1|s,x,c,h))}function ty(i,s){mh(8390656,8,i,s)}function ry(i,s){Vu(2048,8,i,s)}function ny(i,s){return Vu(4,2,i,s)}function ay(i,s){return Vu(4,4,i,s)}function iy(i,s){if(typeof s=="function"){i=i();var c=s(i);return function(){typeof c=="function"?c():s(null)}}if(s!=null)return i=i(),s.current=i,function(){s.current=null}}function sy(i,s,c){c=c!=null?c.concat([i]):null,Vu(4,4,iy.bind(null,s,i),c)}function Dp(){}function oy(i,s){var c=Vr();s=s===void 0?null:s;var h=c.memoizedState;return s!==null&&wp(s,h[1])?h[0]:(c.memoizedState=[i,s],i)}function ly(i,s){var c=Vr();s=s===void 0?null:s;var h=c.memoizedState;if(s!==null&&wp(s,h[1]))return h[0];if(h=i(),rl){se(!0);try{i()}finally{se(!1)}}return c.memoizedState=[h,s],h}function Op(i,s,c){return c===void 0||(Os&1073741824)!==0?i.memoizedState=s:(i.memoizedState=c,i=f2(),Et.lanes|=i,Vs|=i,c)}function cy(i,s,c,h){return oa(c,s)?c:lc.current!==null?(i=Op(i,c,h),oa(i,s)||(an=!0),i):(Os&42)===0?(an=!0,i.memoizedState=c):(i=f2(),Et.lanes|=i,Vs|=i,s)}function uy(i,s,c,h,g){var x=ue.p;ue.p=x!==0&&8>x?x:8;var R=ne.T,U={};ne.T=U,Lp(i,!1,s,c);try{var re=g(),pe=ne.S;if(pe!==null&&pe(U,re),re!==null&&typeof re=="object"&&typeof re.then=="function"){var Ae=NC(re,h);ju(i,s,Ae,ha(i))}else ju(i,s,h,ha(i))}catch(Ie){ju(i,s,{then:function(){},status:"rejected",reason:Ie},ha())}finally{ue.p=x,ne.T=R}}function PC(){}function Fp(i,s,c,h){if(i.tag!==5)throw Error(n(476));var g=fy(i).queue;uy(i,g,s,Ve,c===null?PC:function(){return hy(i),c(h)})}function fy(i){var s=i.memoizedState;if(s!==null)return s;s={memoizedState:Ve,baseState:Ve,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ts,lastRenderedState:Ve},next:null};var c={};return s.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ts,lastRenderedState:c},next:null},i.memoizedState=s,i=i.alternate,i!==null&&(i.memoizedState=s),s}function hy(i){var s=fy(i).next.queue;ju(i,s,{},ha())}function Pp(){return bn(sf)}function dy(){return Vr().memoizedState}function my(){return Vr().memoizedState}function LC(i){for(var s=i.return;s!==null;){switch(s.tag){case 24:case 3:var c=ha();i=Is(c);var h=Ds(s,i,c);h!==null&&(da(h,s,c),Pu(h,s,c)),s={cache:fp()},i.payload=s;return}s=s.return}}function MC(i,s,c){var h=ha();c={lane:h,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null},ph(i)?gy(s,c):(c=tp(i,s,c,h),c!==null&&(da(c,i,h),xy(c,s,h)))}function py(i,s,c){var h=ha();ju(i,s,c,h)}function ju(i,s,c,h){var g={lane:h,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null};if(ph(i))gy(s,g);else{var x=i.alternate;if(i.lanes===0&&(x===null||x.lanes===0)&&(x=s.lastRenderedReducer,x!==null))try{var R=s.lastRenderedState,U=x(R,c);if(g.hasEagerState=!0,g.eagerState=U,oa(U,R))return Z0(i,s,g,0),lr===null&&Q0(),!1}catch{}finally{}if(c=tp(i,s,g,h),c!==null)return da(c,i,h),xy(c,s,h),!0}return!1}function Lp(i,s,c,h){if(h={lane:2,revertLane:mg(),action:h,hasEagerState:!1,eagerState:null,next:null},ph(i)){if(s)throw Error(n(479))}else s=tp(i,c,h,2),s!==null&&da(s,i,2)}function ph(i){var s=i.alternate;return i===Et||s!==null&&s===Et}function gy(i,s){cc=ch=!0;var c=i.pending;c===null?s.next=s:(s.next=c.next,c.next=s),i.pending=s}function xy(i,s,c){if((c&4194048)!==0){var h=s.lanes;h&=i.pendingLanes,c|=h,s.lanes=c,Oo(i,c)}}var gh={readContext:bn,use:fh,useCallback:Ir,useContext:Ir,useEffect:Ir,useImperativeHandle:Ir,useLayoutEffect:Ir,useInsertionEffect:Ir,useMemo:Ir,useReducer:Ir,useRef:Ir,useState:Ir,useDebugValue:Ir,useDeferredValue:Ir,useTransition:Ir,useSyncExternalStore:Ir,useId:Ir,useHostTransitionStatus:Ir,useFormState:Ir,useActionState:Ir,useOptimistic:Ir,useMemoCache:Ir,useCacheRefresh:Ir},vy={readContext:bn,use:fh,useCallback:function(i,s){return Qn().memoizedState=[i,s===void 0?null:s],i},useContext:bn,useEffect:ty,useImperativeHandle:function(i,s,c){c=c!=null?c.concat([i]):null,mh(4194308,4,iy.bind(null,s,i),c)},useLayoutEffect:function(i,s){return mh(4194308,4,i,s)},useInsertionEffect:function(i,s){mh(4,2,i,s)},useMemo:function(i,s){var c=Qn();s=s===void 0?null:s;var h=i();if(rl){se(!0);try{i()}finally{se(!1)}}return c.memoizedState=[h,s],h},useReducer:function(i,s,c){var h=Qn();if(c!==void 0){var g=c(s);if(rl){se(!0);try{c(s)}finally{se(!1)}}}else g=s;return h.memoizedState=h.baseState=g,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:g},h.queue=i,i=i.dispatch=MC.bind(null,Et,i),[h.memoizedState,i]},useRef:function(i){var s=Qn();return i={current:i},s.memoizedState=i},useState:function(i){i=Np(i);var s=i.queue,c=py.bind(null,Et,s);return s.dispatch=c,[i.memoizedState,c]},useDebugValue:Dp,useDeferredValue:function(i,s){var c=Qn();return Op(c,i,s)},useTransition:function(){var i=Np(!1);return i=uy.bind(null,Et,i.queue,!0,!1),Qn().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,s,c){var h=Et,g=Qn();if(Gt){if(c===void 0)throw Error(n(407));c=c()}else{if(c=s(),lr===null)throw Error(n(349));(Lt&124)!==0||B_(h,s,c)}g.memoizedState=c;var x={value:c,getSnapshot:s};return g.queue=x,ty(j_.bind(null,h,x,i),[i]),h.flags|=2048,fc(9,dh(),V_.bind(null,h,x,c,s),null),c},useId:function(){var i=Qn(),s=lr.identifierPrefix;if(Gt){var c=Zi,h=Qi;c=(h&~(1<<32-Me(h)-1)).toString(32)+c,s=""+s+"R"+c,c=uh++,0<c&&(s+="H"+c.toString(32)),s+=""}else c=IC++,s=""+s+"r"+c.toString(32)+"";return i.memoizedState=s},useHostTransitionStatus:Pp,useFormState:$_,useActionState:$_,useOptimistic:function(i){var s=Qn();s.memoizedState=s.baseState=i;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=c,s=Lp.bind(null,Et,!0,c),c.dispatch=s,[i,s]},useMemoCache:kp,useCacheRefresh:function(){return Qn().memoizedState=LC.bind(null,Et)}},_y={readContext:bn,use:fh,useCallback:oy,useContext:bn,useEffect:ry,useImperativeHandle:sy,useInsertionEffect:ny,useLayoutEffect:ay,useMemo:ly,useReducer:hh,useRef:ey,useState:function(){return hh(ts)},useDebugValue:Dp,useDeferredValue:function(i,s){var c=Vr();return cy(c,tr.memoizedState,i,s)},useTransition:function(){var i=hh(ts)[0],s=Vr().memoizedState;return[typeof i=="boolean"?i:Bu(i),s]},useSyncExternalStore:U_,useId:dy,useHostTransitionStatus:Pp,useFormState:Q_,useActionState:Q_,useOptimistic:function(i,s){var c=Vr();return G_(c,tr,i,s)},useMemoCache:kp,useCacheRefresh:my},UC={readContext:bn,use:fh,useCallback:oy,useContext:bn,useEffect:ry,useImperativeHandle:sy,useInsertionEffect:ny,useLayoutEffect:ay,useMemo:ly,useReducer:Rp,useRef:ey,useState:function(){return Rp(ts)},useDebugValue:Dp,useDeferredValue:function(i,s){var c=Vr();return tr===null?Op(c,i,s):cy(c,tr.memoizedState,i,s)},useTransition:function(){var i=Rp(ts)[0],s=Vr().memoizedState;return[typeof i=="boolean"?i:Bu(i),s]},useSyncExternalStore:U_,useId:dy,useHostTransitionStatus:Pp,useFormState:J_,useActionState:J_,useOptimistic:function(i,s){var c=Vr();return tr!==null?G_(c,tr,i,s):(c.baseState=i,[i,c.queue.dispatch])},useMemoCache:kp,useCacheRefresh:my},hc=null,Hu=0;function xh(i){var s=Hu;return Hu+=1,hc===null&&(hc=[]),N_(hc,i,s)}function zu(i,s){s=s.props.ref,i.ref=s!==void 0?s:null}function vh(i,s){throw s.$$typeof===v?Error(n(525)):(i=Object.prototype.toString.call(s),Error(n(31,i==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":i)))}function yy(i){var s=i._init;return s(i._payload)}function wy(i){function s(oe,ae){if(i){var de=oe.deletions;de===null?(oe.deletions=[ae],oe.flags|=16):de.push(ae)}}function c(oe,ae){if(!i)return null;for(;ae!==null;)s(oe,ae),ae=ae.sibling;return null}function h(oe){for(var ae=new Map;oe!==null;)oe.key!==null?ae.set(oe.key,oe):ae.set(oe.index,oe),oe=oe.sibling;return ae}function g(oe,ae){return oe=$i(oe,ae),oe.index=0,oe.sibling=null,oe}function x(oe,ae,de){return oe.index=de,i?(de=oe.alternate,de!==null?(de=de.index,de<ae?(oe.flags|=67108866,ae):de):(oe.flags|=67108866,ae)):(oe.flags|=1048576,ae)}function R(oe){return i&&oe.alternate===null&&(oe.flags|=67108866),oe}function U(oe,ae,de,Ce){return ae===null||ae.tag!==6?(ae=np(de,oe.mode,Ce),ae.return=oe,ae):(ae=g(ae,de),ae.return=oe,ae)}function re(oe,ae,de,Ce){var Qe=de.type;return Qe===S?Ae(oe,ae,de.props.children,Ce,de.key):ae!==null&&(ae.elementType===Qe||typeof Qe=="object"&&Qe!==null&&Qe.$$typeof===I&&yy(Qe)===ae.type)?(ae=g(ae,de.props),zu(ae,de),ae.return=oe,ae):(ae=eh(de.type,de.key,de.props,null,oe.mode,Ce),zu(ae,de),ae.return=oe,ae)}function pe(oe,ae,de,Ce){return ae===null||ae.tag!==4||ae.stateNode.containerInfo!==de.containerInfo||ae.stateNode.implementation!==de.implementation?(ae=ap(de,oe.mode,Ce),ae.return=oe,ae):(ae=g(ae,de.children||[]),ae.return=oe,ae)}function Ae(oe,ae,de,Ce,Qe){return ae===null||ae.tag!==7?(ae=Ko(de,oe.mode,Ce,Qe),ae.return=oe,ae):(ae=g(ae,de),ae.return=oe,ae)}function Ie(oe,ae,de){if(typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint")return ae=np(""+ae,oe.mode,de),ae.return=oe,ae;if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case _:return de=eh(ae.type,ae.key,ae.props,null,oe.mode,de),zu(de,ae),de.return=oe,de;case E:return ae=ap(ae,oe.mode,de),ae.return=oe,ae;case I:var Ce=ae._init;return ae=Ce(ae._payload),Ie(oe,ae,de)}if(we(ae)||N(ae))return ae=Ko(ae,oe.mode,de,null),ae.return=oe,ae;if(typeof ae.then=="function")return Ie(oe,xh(ae),de);if(ae.$$typeof===F)return Ie(oe,ah(oe,ae),de);vh(oe,ae)}return null}function _e(oe,ae,de,Ce){var Qe=ae!==null?ae.key:null;if(typeof de=="string"&&de!==""||typeof de=="number"||typeof de=="bigint")return Qe!==null?null:U(oe,ae,""+de,Ce);if(typeof de=="object"&&de!==null){switch(de.$$typeof){case _:return de.key===Qe?re(oe,ae,de,Ce):null;case E:return de.key===Qe?pe(oe,ae,de,Ce):null;case I:return Qe=de._init,de=Qe(de._payload),_e(oe,ae,de,Ce)}if(we(de)||N(de))return Qe!==null?null:Ae(oe,ae,de,Ce,null);if(typeof de.then=="function")return _e(oe,ae,xh(de),Ce);if(de.$$typeof===F)return _e(oe,ae,ah(oe,de),Ce);vh(oe,de)}return null}function Ee(oe,ae,de,Ce,Qe){if(typeof Ce=="string"&&Ce!==""||typeof Ce=="number"||typeof Ce=="bigint")return oe=oe.get(de)||null,U(ae,oe,""+Ce,Qe);if(typeof Ce=="object"&&Ce!==null){switch(Ce.$$typeof){case _:return oe=oe.get(Ce.key===null?de:Ce.key)||null,re(ae,oe,Ce,Qe);case E:return oe=oe.get(Ce.key===null?de:Ce.key)||null,pe(ae,oe,Ce,Qe);case I:var St=Ce._init;return Ce=St(Ce._payload),Ee(oe,ae,de,Ce,Qe)}if(we(Ce)||N(Ce))return oe=oe.get(de)||null,Ae(ae,oe,Ce,Qe,null);if(typeof Ce.then=="function")return Ee(oe,ae,de,xh(Ce),Qe);if(Ce.$$typeof===F)return Ee(oe,ae,de,ah(ae,Ce),Qe);vh(ae,Ce)}return null}function ht(oe,ae,de,Ce){for(var Qe=null,St=null,Ze=ae,st=ae=0,on=null;Ze!==null&&st<de.length;st++){Ze.index>st?(on=Ze,Ze=null):on=Ze.sibling;var Ht=_e(oe,Ze,de[st],Ce);if(Ht===null){Ze===null&&(Ze=on);break}i&&Ze&&Ht.alternate===null&&s(oe,Ze),ae=x(Ht,ae,st),St===null?Qe=Ht:St.sibling=Ht,St=Ht,Ze=on}if(st===de.length)return c(oe,Ze),Gt&&$o(oe,st),Qe;if(Ze===null){for(;st<de.length;st++)Ze=Ie(oe,de[st],Ce),Ze!==null&&(ae=x(Ze,ae,st),St===null?Qe=Ze:St.sibling=Ze,St=Ze);return Gt&&$o(oe,st),Qe}for(Ze=h(Ze);st<de.length;st++)on=Ee(Ze,oe,st,de[st],Ce),on!==null&&(i&&on.alternate!==null&&Ze.delete(on.key===null?st:on.key),ae=x(on,ae,st),St===null?Qe=on:St.sibling=on,St=on);return i&&Ze.forEach(function(Ys){return s(oe,Ys)}),Gt&&$o(oe,st),Qe}function it(oe,ae,de,Ce){if(de==null)throw Error(n(151));for(var Qe=null,St=null,Ze=ae,st=ae=0,on=null,Ht=de.next();Ze!==null&&!Ht.done;st++,Ht=de.next()){Ze.index>st?(on=Ze,Ze=null):on=Ze.sibling;var Ys=_e(oe,Ze,Ht.value,Ce);if(Ys===null){Ze===null&&(Ze=on);break}i&&Ze&&Ys.alternate===null&&s(oe,Ze),ae=x(Ys,ae,st),St===null?Qe=Ys:St.sibling=Ys,St=Ys,Ze=on}if(Ht.done)return c(oe,Ze),Gt&&$o(oe,st),Qe;if(Ze===null){for(;!Ht.done;st++,Ht=de.next())Ht=Ie(oe,Ht.value,Ce),Ht!==null&&(ae=x(Ht,ae,st),St===null?Qe=Ht:St.sibling=Ht,St=Ht);return Gt&&$o(oe,st),Qe}for(Ze=h(Ze);!Ht.done;st++,Ht=de.next())Ht=Ee(Ze,oe,st,Ht.value,Ce),Ht!==null&&(i&&Ht.alternate!==null&&Ze.delete(Ht.key===null?st:Ht.key),ae=x(Ht,ae,st),St===null?Qe=Ht:St.sibling=Ht,St=Ht);return i&&Ze.forEach(function(B3){return s(oe,B3)}),Gt&&$o(oe,st),Qe}function nr(oe,ae,de,Ce){if(typeof de=="object"&&de!==null&&de.type===S&&de.key===null&&(de=de.props.children),typeof de=="object"&&de!==null){switch(de.$$typeof){case _:e:{for(var Qe=de.key;ae!==null;){if(ae.key===Qe){if(Qe=de.type,Qe===S){if(ae.tag===7){c(oe,ae.sibling),Ce=g(ae,de.props.children),Ce.return=oe,oe=Ce;break e}}else if(ae.elementType===Qe||typeof Qe=="object"&&Qe!==null&&Qe.$$typeof===I&&yy(Qe)===ae.type){c(oe,ae.sibling),Ce=g(ae,de.props),zu(Ce,de),Ce.return=oe,oe=Ce;break e}c(oe,ae);break}else s(oe,ae);ae=ae.sibling}de.type===S?(Ce=Ko(de.props.children,oe.mode,Ce,de.key),Ce.return=oe,oe=Ce):(Ce=eh(de.type,de.key,de.props,null,oe.mode,Ce),zu(Ce,de),Ce.return=oe,oe=Ce)}return R(oe);case E:e:{for(Qe=de.key;ae!==null;){if(ae.key===Qe)if(ae.tag===4&&ae.stateNode.containerInfo===de.containerInfo&&ae.stateNode.implementation===de.implementation){c(oe,ae.sibling),Ce=g(ae,de.children||[]),Ce.return=oe,oe=Ce;break e}else{c(oe,ae);break}else s(oe,ae);ae=ae.sibling}Ce=ap(de,oe.mode,Ce),Ce.return=oe,oe=Ce}return R(oe);case I:return Qe=de._init,de=Qe(de._payload),nr(oe,ae,de,Ce)}if(we(de))return ht(oe,ae,de,Ce);if(N(de)){if(Qe=N(de),typeof Qe!="function")throw Error(n(150));return de=Qe.call(de),it(oe,ae,de,Ce)}if(typeof de.then=="function")return nr(oe,ae,xh(de),Ce);if(de.$$typeof===F)return nr(oe,ae,ah(oe,de),Ce);vh(oe,de)}return typeof de=="string"&&de!==""||typeof de=="number"||typeof de=="bigint"?(de=""+de,ae!==null&&ae.tag===6?(c(oe,ae.sibling),Ce=g(ae,de),Ce.return=oe,oe=Ce):(c(oe,ae),Ce=np(de,oe.mode,Ce),Ce.return=oe,oe=Ce),R(oe)):c(oe,ae)}return function(oe,ae,de,Ce){try{Hu=0;var Qe=nr(oe,ae,de,Ce);return hc=null,Qe}catch(Ze){if(Ze===Ou||Ze===sh)throw Ze;var St=la(29,Ze,null,oe.mode);return St.lanes=Ce,St.return=oe,St}finally{}}}var dc=wy(!0),Ey=wy(!1),Da=ge(null),_i=null;function Fs(i){var s=i.alternate;K(Qr,Qr.current&1),K(Da,i),_i===null&&(s===null||lc.current!==null||s.memoizedState!==null)&&(_i=i)}function Ty(i){if(i.tag===22){if(K(Qr,Qr.current),K(Da,i),_i===null){var s=i.alternate;s!==null&&s.memoizedState!==null&&(_i=i)}}else Ps()}function Ps(){K(Qr,Qr.current),K(Da,Da.current)}function rs(i){V(Da),_i===i&&(_i=null),V(Qr)}var Qr=ge(0);function _h(i){for(var s=i;s!==null;){if(s.tag===13){var c=s.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||Ag(c)))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}function Mp(i,s,c,h){s=i.memoizedState,c=c(h,s),c=c==null?s:m({},s,c),i.memoizedState=c,i.lanes===0&&(i.updateQueue.baseState=c)}var Up={enqueueSetState:function(i,s,c){i=i._reactInternals;var h=ha(),g=Is(h);g.payload=s,c!=null&&(g.callback=c),s=Ds(i,g,h),s!==null&&(da(s,i,h),Pu(s,i,h))},enqueueReplaceState:function(i,s,c){i=i._reactInternals;var h=ha(),g=Is(h);g.tag=1,g.payload=s,c!=null&&(g.callback=c),s=Ds(i,g,h),s!==null&&(da(s,i,h),Pu(s,i,h))},enqueueForceUpdate:function(i,s){i=i._reactInternals;var c=ha(),h=Is(c);h.tag=2,s!=null&&(h.callback=s),s=Ds(i,h,c),s!==null&&(da(s,i,c),Pu(s,i,c))}};function by(i,s,c,h,g,x,R){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(h,x,R):s.prototype&&s.prototype.isPureReactComponent?!Su(c,h)||!Su(g,x):!0}function Sy(i,s,c,h){i=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(c,h),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(c,h),s.state!==i&&Up.enqueueReplaceState(s,s.state,null)}function nl(i,s){var c=s;if("ref"in s){c={};for(var h in s)h!=="ref"&&(c[h]=s[h])}if(i=i.defaultProps){c===s&&(c=m({},c));for(var g in i)c[g]===void 0&&(c[g]=i[g])}return c}var yh=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)};function Ay(i){yh(i)}function ky(i){console.error(i)}function Cy(i){yh(i)}function wh(i,s){try{var c=i.onUncaughtError;c(s.value,{componentStack:s.stack})}catch(h){setTimeout(function(){throw h})}}function Ry(i,s,c){try{var h=i.onCaughtError;h(c.value,{componentStack:c.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function Bp(i,s,c){return c=Is(c),c.tag=3,c.payload={element:null},c.callback=function(){wh(i,s)},c}function Ny(i){return i=Is(i),i.tag=3,i}function Iy(i,s,c,h){var g=c.type.getDerivedStateFromError;if(typeof g=="function"){var x=h.value;i.payload=function(){return g(x)},i.callback=function(){Ry(s,c,h)}}var R=c.stateNode;R!==null&&typeof R.componentDidCatch=="function"&&(i.callback=function(){Ry(s,c,h),typeof g!="function"&&(js===null?js=new Set([this]):js.add(this));var U=h.stack;this.componentDidCatch(h.value,{componentStack:U!==null?U:""})})}function BC(i,s,c,h,g){if(c.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(s=c.alternate,s!==null&&Nu(s,c,g,!0),c=Da.current,c!==null){switch(c.tag){case 13:return _i===null?cg():c.alternate===null&&Er===0&&(Er=3),c.flags&=-257,c.flags|=65536,c.lanes=g,h===mp?c.flags|=16384:(s=c.updateQueue,s===null?c.updateQueue=new Set([h]):s.add(h),fg(i,h,g)),!1;case 22:return c.flags|=65536,h===mp?c.flags|=16384:(s=c.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([h])},c.updateQueue=s):(c=s.retryQueue,c===null?s.retryQueue=new Set([h]):c.add(h)),fg(i,h,g)),!1}throw Error(n(435,c.tag))}return fg(i,h,g),cg(),!1}if(Gt)return s=Da.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=g,h!==op&&(i=Error(n(422),{cause:h}),Ru(Ca(i,c)))):(h!==op&&(s=Error(n(423),{cause:h}),Ru(Ca(s,c))),i=i.current.alternate,i.flags|=65536,g&=-g,i.lanes|=g,h=Ca(h,c),g=Bp(i.stateNode,h,g),xp(i,g),Er!==4&&(Er=2)),!1;var x=Error(n(520),{cause:h});if(x=Ca(x,c),$u===null?$u=[x]:$u.push(x),Er!==4&&(Er=2),s===null)return!0;h=Ca(h,c),c=s;do{switch(c.tag){case 3:return c.flags|=65536,i=g&-g,c.lanes|=i,i=Bp(c.stateNode,h,i),xp(c,i),!1;case 1:if(s=c.type,x=c.stateNode,(c.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(js===null||!js.has(x))))return c.flags|=65536,g&=-g,c.lanes|=g,g=Ny(g),Iy(g,i,c,h),xp(c,g),!1}c=c.return}while(c!==null);return!1}var Dy=Error(n(461)),an=!1;function mn(i,s,c,h){s.child=i===null?Ey(s,null,c,h):dc(s,i.child,c,h)}function Oy(i,s,c,h,g){c=c.render;var x=s.ref;if("ref"in h){var R={};for(var U in h)U!=="ref"&&(R[U]=h[U])}else R=h;return el(s),h=Ep(i,s,c,R,x,g),U=Tp(),i!==null&&!an?(bp(i,s,g),ns(i,s,g)):(Gt&&U&&ip(s),s.flags|=1,mn(i,s,h,g),s.child)}function Fy(i,s,c,h,g){if(i===null){var x=c.type;return typeof x=="function"&&!rp(x)&&x.defaultProps===void 0&&c.compare===null?(s.tag=15,s.type=x,Py(i,s,x,h,g)):(i=eh(c.type,null,h,s,s.mode,g),i.ref=s.ref,i.return=s,s.child=i)}if(x=i.child,!Xp(i,g)){var R=x.memoizedProps;if(c=c.compare,c=c!==null?c:Su,c(R,h)&&i.ref===s.ref)return ns(i,s,g)}return s.flags|=1,i=$i(x,h),i.ref=s.ref,i.return=s,s.child=i}function Py(i,s,c,h,g){if(i!==null){var x=i.memoizedProps;if(Su(x,h)&&i.ref===s.ref)if(an=!1,s.pendingProps=h=x,Xp(i,g))(i.flags&131072)!==0&&(an=!0);else return s.lanes=i.lanes,ns(i,s,g)}return Vp(i,s,c,h,g)}function Ly(i,s,c){var h=s.pendingProps,g=h.children,x=i!==null?i.memoizedState:null;if(h.mode==="hidden"){if((s.flags&128)!==0){if(h=x!==null?x.baseLanes|c:c,i!==null){for(g=s.child=i.child,x=0;g!==null;)x=x|g.lanes|g.childLanes,g=g.sibling;s.childLanes=x&~h}else s.childLanes=0,s.child=null;return My(i,s,h,c)}if((c&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},i!==null&&ih(s,x!==null?x.cachePool:null),x!==null?P_(s,x):_p(),Ty(s);else return s.lanes=s.childLanes=536870912,My(i,s,x!==null?x.baseLanes|c:c,c)}else x!==null?(ih(s,x.cachePool),P_(s,x),Ps(),s.memoizedState=null):(i!==null&&ih(s,null),_p(),Ps());return mn(i,s,g,c),s.child}function My(i,s,c,h){var g=dp();return g=g===null?null:{parent:$r._currentValue,pool:g},s.memoizedState={baseLanes:c,cachePool:g},i!==null&&ih(s,null),_p(),Ty(s),i!==null&&Nu(i,s,h,!0),null}function Eh(i,s){var c=s.ref;if(c===null)i!==null&&i.ref!==null&&(s.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(n(284));(i===null||i.ref!==c)&&(s.flags|=4194816)}}function Vp(i,s,c,h,g){return el(s),c=Ep(i,s,c,h,void 0,g),h=Tp(),i!==null&&!an?(bp(i,s,g),ns(i,s,g)):(Gt&&h&&ip(s),s.flags|=1,mn(i,s,c,g),s.child)}function Uy(i,s,c,h,g,x){return el(s),s.updateQueue=null,c=M_(s,h,c,g),L_(i),h=Tp(),i!==null&&!an?(bp(i,s,x),ns(i,s,x)):(Gt&&h&&ip(s),s.flags|=1,mn(i,s,c,x),s.child)}function By(i,s,c,h,g){if(el(s),s.stateNode===null){var x=nc,R=c.contextType;typeof R=="object"&&R!==null&&(x=bn(R)),x=new c(h,x),s.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,x.updater=Up,s.stateNode=x,x._reactInternals=s,x=s.stateNode,x.props=h,x.state=s.memoizedState,x.refs={},pp(s),R=c.contextType,x.context=typeof R=="object"&&R!==null?bn(R):nc,x.state=s.memoizedState,R=c.getDerivedStateFromProps,typeof R=="function"&&(Mp(s,c,R,h),x.state=s.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(R=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),R!==x.state&&Up.enqueueReplaceState(x,x.state,null),Mu(s,h,x,g),Lu(),x.state=s.memoizedState),typeof x.componentDidMount=="function"&&(s.flags|=4194308),h=!0}else if(i===null){x=s.stateNode;var U=s.memoizedProps,re=nl(c,U);x.props=re;var pe=x.context,Ae=c.contextType;R=nc,typeof Ae=="object"&&Ae!==null&&(R=bn(Ae));var Ie=c.getDerivedStateFromProps;Ae=typeof Ie=="function"||typeof x.getSnapshotBeforeUpdate=="function",U=s.pendingProps!==U,Ae||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(U||pe!==R)&&Sy(s,x,h,R),Ns=!1;var _e=s.memoizedState;x.state=_e,Mu(s,h,x,g),Lu(),pe=s.memoizedState,U||_e!==pe||Ns?(typeof Ie=="function"&&(Mp(s,c,Ie,h),pe=s.memoizedState),(re=Ns||by(s,c,re,h,_e,pe,R))?(Ae||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(s.flags|=4194308)):(typeof x.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=h,s.memoizedState=pe),x.props=h,x.state=pe,x.context=R,h=re):(typeof x.componentDidMount=="function"&&(s.flags|=4194308),h=!1)}else{x=s.stateNode,gp(i,s),R=s.memoizedProps,Ae=nl(c,R),x.props=Ae,Ie=s.pendingProps,_e=x.context,pe=c.contextType,re=nc,typeof pe=="object"&&pe!==null&&(re=bn(pe)),U=c.getDerivedStateFromProps,(pe=typeof U=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(R!==Ie||_e!==re)&&Sy(s,x,h,re),Ns=!1,_e=s.memoizedState,x.state=_e,Mu(s,h,x,g),Lu();var Ee=s.memoizedState;R!==Ie||_e!==Ee||Ns||i!==null&&i.dependencies!==null&&nh(i.dependencies)?(typeof U=="function"&&(Mp(s,c,U,h),Ee=s.memoizedState),(Ae=Ns||by(s,c,Ae,h,_e,Ee,re)||i!==null&&i.dependencies!==null&&nh(i.dependencies))?(pe||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(h,Ee,re),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(h,Ee,re)),typeof x.componentDidUpdate=="function"&&(s.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof x.componentDidUpdate!="function"||R===i.memoizedProps&&_e===i.memoizedState||(s.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||R===i.memoizedProps&&_e===i.memoizedState||(s.flags|=1024),s.memoizedProps=h,s.memoizedState=Ee),x.props=h,x.state=Ee,x.context=re,h=Ae):(typeof x.componentDidUpdate!="function"||R===i.memoizedProps&&_e===i.memoizedState||(s.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||R===i.memoizedProps&&_e===i.memoizedState||(s.flags|=1024),h=!1)}return x=h,Eh(i,s),h=(s.flags&128)!==0,x||h?(x=s.stateNode,c=h&&typeof c.getDerivedStateFromError!="function"?null:x.render(),s.flags|=1,i!==null&&h?(s.child=dc(s,i.child,null,g),s.child=dc(s,null,c,g)):mn(i,s,c,g),s.memoizedState=x.state,i=s.child):i=ns(i,s,g),i}function Vy(i,s,c,h){return Cu(),s.flags|=256,mn(i,s,c,h),s.child}var jp={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Hp(i){return{baseLanes:i,cachePool:k_()}}function zp(i,s,c){return i=i!==null?i.childLanes&~c:0,s&&(i|=Oa),i}function jy(i,s,c){var h=s.pendingProps,g=!1,x=(s.flags&128)!==0,R;if((R=x)||(R=i!==null&&i.memoizedState===null?!1:(Qr.current&2)!==0),R&&(g=!0,s.flags&=-129),R=(s.flags&32)!==0,s.flags&=-33,i===null){if(Gt){if(g?Fs(s):Ps(),Gt){var U=wr,re;if(re=U){e:{for(re=U,U=vi;re.nodeType!==8;){if(!U){U=null;break e}if(re=$a(re.nextSibling),re===null){U=null;break e}}U=re}U!==null?(s.memoizedState={dehydrated:U,treeContext:Yo!==null?{id:Qi,overflow:Zi}:null,retryLane:536870912,hydrationErrors:null},re=la(18,null,null,0),re.stateNode=U,re.return=s,s.child=re,zn=s,wr=null,re=!0):re=!1}re||Zo(s)}if(U=s.memoizedState,U!==null&&(U=U.dehydrated,U!==null))return Ag(U)?s.lanes=32:s.lanes=536870912,null;rs(s)}return U=h.children,h=h.fallback,g?(Ps(),g=s.mode,U=Th({mode:"hidden",children:U},g),h=Ko(h,g,c,null),U.return=s,h.return=s,U.sibling=h,s.child=U,g=s.child,g.memoizedState=Hp(c),g.childLanes=zp(i,R,c),s.memoizedState=jp,h):(Fs(s),Gp(s,U))}if(re=i.memoizedState,re!==null&&(U=re.dehydrated,U!==null)){if(x)s.flags&256?(Fs(s),s.flags&=-257,s=qp(i,s,c)):s.memoizedState!==null?(Ps(),s.child=i.child,s.flags|=128,s=null):(Ps(),g=h.fallback,U=s.mode,h=Th({mode:"visible",children:h.children},U),g=Ko(g,U,c,null),g.flags|=2,h.return=s,g.return=s,h.sibling=g,s.child=h,dc(s,i.child,null,c),h=s.child,h.memoizedState=Hp(c),h.childLanes=zp(i,R,c),s.memoizedState=jp,s=g);else if(Fs(s),Ag(U)){if(R=U.nextSibling&&U.nextSibling.dataset,R)var pe=R.dgst;R=pe,h=Error(n(419)),h.stack="",h.digest=R,Ru({value:h,source:null,stack:null}),s=qp(i,s,c)}else if(an||Nu(i,s,c,!1),R=(c&i.childLanes)!==0,an||R){if(R=lr,R!==null&&(h=c&-c,h=(h&42)!==0?1:oi(h),h=(h&(R.suspendedLanes|c))!==0?0:h,h!==0&&h!==re.retryLane))throw re.retryLane=h,rc(i,h),da(R,i,h),Dy;U.data==="$?"||cg(),s=qp(i,s,c)}else U.data==="$?"?(s.flags|=192,s.child=i.child,s=null):(i=re.treeContext,wr=$a(U.nextSibling),zn=s,Gt=!0,Qo=null,vi=!1,i!==null&&(Na[Ia++]=Qi,Na[Ia++]=Zi,Na[Ia++]=Yo,Qi=i.id,Zi=i.overflow,Yo=s),s=Gp(s,h.children),s.flags|=4096);return s}return g?(Ps(),g=h.fallback,U=s.mode,re=i.child,pe=re.sibling,h=$i(re,{mode:"hidden",children:h.children}),h.subtreeFlags=re.subtreeFlags&65011712,pe!==null?g=$i(pe,g):(g=Ko(g,U,c,null),g.flags|=2),g.return=s,h.return=s,h.sibling=g,s.child=h,h=g,g=s.child,U=i.child.memoizedState,U===null?U=Hp(c):(re=U.cachePool,re!==null?(pe=$r._currentValue,re=re.parent!==pe?{parent:pe,pool:pe}:re):re=k_(),U={baseLanes:U.baseLanes|c,cachePool:re}),g.memoizedState=U,g.childLanes=zp(i,R,c),s.memoizedState=jp,h):(Fs(s),c=i.child,i=c.sibling,c=$i(c,{mode:"visible",children:h.children}),c.return=s,c.sibling=null,i!==null&&(R=s.deletions,R===null?(s.deletions=[i],s.flags|=16):R.push(i)),s.child=c,s.memoizedState=null,c)}function Gp(i,s){return s=Th({mode:"visible",children:s},i.mode),s.return=i,i.child=s}function Th(i,s){return i=la(22,i,null,s),i.lanes=0,i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},i}function qp(i,s,c){return dc(s,i.child,null,c),i=Gp(s,s.pendingProps.children),i.flags|=2,s.memoizedState=null,i}function Hy(i,s,c){i.lanes|=s;var h=i.alternate;h!==null&&(h.lanes|=s),cp(i.return,s,c)}function Wp(i,s,c,h,g){var x=i.memoizedState;x===null?i.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:h,tail:c,tailMode:g}:(x.isBackwards=s,x.rendering=null,x.renderingStartTime=0,x.last=h,x.tail=c,x.tailMode=g)}function zy(i,s,c){var h=s.pendingProps,g=h.revealOrder,x=h.tail;if(mn(i,s,h.children,c),h=Qr.current,(h&2)!==0)h=h&1|2,s.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=s.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&Hy(i,c,s);else if(i.tag===19)Hy(i,c,s);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}h&=1}switch(K(Qr,h),g){case"forwards":for(c=s.child,g=null;c!==null;)i=c.alternate,i!==null&&_h(i)===null&&(g=c),c=c.sibling;c=g,c===null?(g=s.child,s.child=null):(g=c.sibling,c.sibling=null),Wp(s,!1,g,c,x);break;case"backwards":for(c=null,g=s.child,s.child=null;g!==null;){if(i=g.alternate,i!==null&&_h(i)===null){s.child=g;break}i=g.sibling,g.sibling=c,c=g,g=i}Wp(s,!0,c,null,x);break;case"together":Wp(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function ns(i,s,c){if(i!==null&&(s.dependencies=i.dependencies),Vs|=s.lanes,(c&s.childLanes)===0)if(i!==null){if(Nu(i,s,c,!1),(c&s.childLanes)===0)return null}else return null;if(i!==null&&s.child!==i.child)throw Error(n(153));if(s.child!==null){for(i=s.child,c=$i(i,i.pendingProps),s.child=c,c.return=s;i.sibling!==null;)i=i.sibling,c=c.sibling=$i(i,i.pendingProps),c.return=s;c.sibling=null}return s.child}function Xp(i,s){return(i.lanes&s)!==0?!0:(i=i.dependencies,!!(i!==null&&nh(i)))}function VC(i,s,c){switch(s.tag){case 3:ke(s,s.stateNode.containerInfo),Rs(s,$r,i.memoizedState.cache),Cu();break;case 27:case 5:ye(s);break;case 4:ke(s,s.stateNode.containerInfo);break;case 10:Rs(s,s.type,s.memoizedProps.value);break;case 13:var h=s.memoizedState;if(h!==null)return h.dehydrated!==null?(Fs(s),s.flags|=128,null):(c&s.child.childLanes)!==0?jy(i,s,c):(Fs(s),i=ns(i,s,c),i!==null?i.sibling:null);Fs(s);break;case 19:var g=(i.flags&128)!==0;if(h=(c&s.childLanes)!==0,h||(Nu(i,s,c,!1),h=(c&s.childLanes)!==0),g){if(h)return zy(i,s,c);s.flags|=128}if(g=s.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),K(Qr,Qr.current),h)break;return null;case 22:case 23:return s.lanes=0,Ly(i,s,c);case 24:Rs(s,$r,i.memoizedState.cache)}return ns(i,s,c)}function Gy(i,s,c){if(i!==null)if(i.memoizedProps!==s.pendingProps)an=!0;else{if(!Xp(i,c)&&(s.flags&128)===0)return an=!1,VC(i,s,c);an=(i.flags&131072)!==0}else an=!1,Gt&&(s.flags&1048576)!==0&&y_(s,rh,s.index);switch(s.lanes=0,s.tag){case 16:e:{i=s.pendingProps;var h=s.elementType,g=h._init;if(h=g(h._payload),s.type=h,typeof h=="function")rp(h)?(i=nl(h,i),s.tag=1,s=By(null,s,h,i,c)):(s.tag=0,s=Vp(null,s,h,i,c));else{if(h!=null){if(g=h.$$typeof,g===z){s.tag=11,s=Oy(null,s,h,i,c);break e}else if(g===k){s.tag=14,s=Fy(null,s,h,i,c);break e}}throw s=he(h)||h,Error(n(306,s,""))}}return s;case 0:return Vp(i,s,s.type,s.pendingProps,c);case 1:return h=s.type,g=nl(h,s.pendingProps),By(i,s,h,g,c);case 3:e:{if(ke(s,s.stateNode.containerInfo),i===null)throw Error(n(387));h=s.pendingProps;var x=s.memoizedState;g=x.element,gp(i,s),Mu(s,h,null,c);var R=s.memoizedState;if(h=R.cache,Rs(s,$r,h),h!==x.cache&&up(s,[$r],c,!0),Lu(),h=R.element,x.isDehydrated)if(x={element:h,isDehydrated:!1,cache:R.cache},s.updateQueue.baseState=x,s.memoizedState=x,s.flags&256){s=Vy(i,s,h,c);break e}else if(h!==g){g=Ca(Error(n(424)),s),Ru(g),s=Vy(i,s,h,c);break e}else{switch(i=s.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(wr=$a(i.firstChild),zn=s,Gt=!0,Qo=null,vi=!0,c=Ey(s,null,h,c),s.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(Cu(),h===g){s=ns(i,s,c);break e}mn(i,s,h,c)}s=s.child}return s;case 26:return Eh(i,s),i===null?(c=K2(s.type,null,s.pendingProps,null))?s.memoizedState=c:Gt||(c=s.type,i=s.pendingProps,h=Mh(ce.current).createElement(c),h[Nr]=s,h[mr]=i,gn(h,c,i),le(h),s.stateNode=h):s.memoizedState=K2(s.type,i.memoizedProps,s.pendingProps,i.memoizedState),null;case 27:return ye(s),i===null&&Gt&&(h=s.stateNode=q2(s.type,s.pendingProps,ce.current),zn=s,vi=!0,g=wr,Gs(s.type)?(kg=g,wr=$a(h.firstChild)):wr=g),mn(i,s,s.pendingProps.children,c),Eh(i,s),i===null&&(s.flags|=4194304),s.child;case 5:return i===null&&Gt&&((g=h=wr)&&(h=m3(h,s.type,s.pendingProps,vi),h!==null?(s.stateNode=h,zn=s,wr=$a(h.firstChild),vi=!1,g=!0):g=!1),g||Zo(s)),ye(s),g=s.type,x=s.pendingProps,R=i!==null?i.memoizedProps:null,h=x.children,Tg(g,x)?h=null:R!==null&&Tg(g,R)&&(s.flags|=32),s.memoizedState!==null&&(g=Ep(i,s,DC,null,null,c),sf._currentValue=g),Eh(i,s),mn(i,s,h,c),s.child;case 6:return i===null&&Gt&&((i=c=wr)&&(c=p3(c,s.pendingProps,vi),c!==null?(s.stateNode=c,zn=s,wr=null,i=!0):i=!1),i||Zo(s)),null;case 13:return jy(i,s,c);case 4:return ke(s,s.stateNode.containerInfo),h=s.pendingProps,i===null?s.child=dc(s,null,h,c):mn(i,s,h,c),s.child;case 11:return Oy(i,s,s.type,s.pendingProps,c);case 7:return mn(i,s,s.pendingProps,c),s.child;case 8:return mn(i,s,s.pendingProps.children,c),s.child;case 12:return mn(i,s,s.pendingProps.children,c),s.child;case 10:return h=s.pendingProps,Rs(s,s.type,h.value),mn(i,s,h.children,c),s.child;case 9:return g=s.type._context,h=s.pendingProps.children,el(s),g=bn(g),h=h(g),s.flags|=1,mn(i,s,h,c),s.child;case 14:return Fy(i,s,s.type,s.pendingProps,c);case 15:return Py(i,s,s.type,s.pendingProps,c);case 19:return zy(i,s,c);case 31:return h=s.pendingProps,c=s.mode,h={mode:h.mode,children:h.children},i===null?(c=Th(h,c),c.ref=s.ref,s.child=c,c.return=s,s=c):(c=$i(i.child,h),c.ref=s.ref,s.child=c,c.return=s,s=c),s;case 22:return Ly(i,s,c);case 24:return el(s),h=bn($r),i===null?(g=dp(),g===null&&(g=lr,x=fp(),g.pooledCache=x,x.refCount++,x!==null&&(g.pooledCacheLanes|=c),g=x),s.memoizedState={parent:h,cache:g},pp(s),Rs(s,$r,g)):((i.lanes&c)!==0&&(gp(i,s),Mu(s,null,null,c),Lu()),g=i.memoizedState,x=s.memoizedState,g.parent!==h?(g={parent:h,cache:h},s.memoizedState=g,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=g),Rs(s,$r,h)):(h=x.cache,Rs(s,$r,h),h!==g.cache&&up(s,[$r],c,!0))),mn(i,s,s.pendingProps.children,c),s.child;case 29:throw s.pendingProps}throw Error(n(156,s.tag))}function as(i){i.flags|=4}function qy(i,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!J2(s)){if(s=Da.current,s!==null&&((Lt&4194048)===Lt?_i!==null:(Lt&62914560)!==Lt&&(Lt&536870912)===0||s!==_i))throw Fu=mp,C_;i.flags|=8192}}function bh(i,s){s!==null&&(i.flags|=4),i.flags&16384&&(s=i.tag!==22?Ss():536870912,i.lanes|=s,xc|=s)}function Gu(i,s){if(!Gt)switch(i.tailMode){case"hidden":s=i.tail;for(var c=null;s!==null;)s.alternate!==null&&(c=s),s=s.sibling;c===null?i.tail=null:c.sibling=null;break;case"collapsed":c=i.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?s||i.tail===null?i.tail=null:i.tail.sibling=null:h.sibling=null}}function xr(i){var s=i.alternate!==null&&i.alternate.child===i.child,c=0,h=0;if(s)for(var g=i.child;g!==null;)c|=g.lanes|g.childLanes,h|=g.subtreeFlags&65011712,h|=g.flags&65011712,g.return=i,g=g.sibling;else for(g=i.child;g!==null;)c|=g.lanes|g.childLanes,h|=g.subtreeFlags,h|=g.flags,g.return=i,g=g.sibling;return i.subtreeFlags|=h,i.childLanes=c,s}function jC(i,s,c){var h=s.pendingProps;switch(sp(s),s.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return xr(s),null;case 1:return xr(s),null;case 3:return c=s.stateNode,h=null,i!==null&&(h=i.memoizedState.cache),s.memoizedState.cache!==h&&(s.flags|=2048),es($r),Fe(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(i===null||i.child===null)&&(ku(s)?as(s):i===null||i.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,T_())),xr(s),null;case 26:return c=s.memoizedState,i===null?(as(s),c!==null?(xr(s),qy(s,c)):(xr(s),s.flags&=-16777217)):c?c!==i.memoizedState?(as(s),xr(s),qy(s,c)):(xr(s),s.flags&=-16777217):(i.memoizedProps!==h&&as(s),xr(s),s.flags&=-16777217),null;case 27:Be(s),c=ce.current;var g=s.type;if(i!==null&&s.stateNode!=null)i.memoizedProps!==h&&as(s);else{if(!h){if(s.stateNode===null)throw Error(n(166));return xr(s),null}i=Y.current,ku(s)?w_(s):(i=q2(g,h,c),s.stateNode=i,as(s))}return xr(s),null;case 5:if(Be(s),c=s.type,i!==null&&s.stateNode!=null)i.memoizedProps!==h&&as(s);else{if(!h){if(s.stateNode===null)throw Error(n(166));return xr(s),null}if(i=Y.current,ku(s))w_(s);else{switch(g=Mh(ce.current),i){case 1:i=g.createElementNS("http://www.w3.org/2000/svg",c);break;case 2:i=g.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;default:switch(c){case"svg":i=g.createElementNS("http://www.w3.org/2000/svg",c);break;case"math":i=g.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;case"script":i=g.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild);break;case"select":i=typeof h.is=="string"?g.createElement("select",{is:h.is}):g.createElement("select"),h.multiple?i.multiple=!0:h.size&&(i.size=h.size);break;default:i=typeof h.is=="string"?g.createElement(c,{is:h.is}):g.createElement(c)}}i[Nr]=s,i[mr]=h;e:for(g=s.child;g!==null;){if(g.tag===5||g.tag===6)i.appendChild(g.stateNode);else if(g.tag!==4&&g.tag!==27&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===s)break e;for(;g.sibling===null;){if(g.return===null||g.return===s)break e;g=g.return}g.sibling.return=g.return,g=g.sibling}s.stateNode=i;e:switch(gn(i,c,h),c){case"button":case"input":case"select":case"textarea":i=!!h.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&as(s)}}return xr(s),s.flags&=-16777217,null;case 6:if(i&&s.stateNode!=null)i.memoizedProps!==h&&as(s);else{if(typeof h!="string"&&s.stateNode===null)throw Error(n(166));if(i=ce.current,ku(s)){if(i=s.stateNode,c=s.memoizedProps,h=null,g=zn,g!==null)switch(g.tag){case 27:case 5:h=g.memoizedProps}i[Nr]=s,i=!!(i.nodeValue===c||h!==null&&h.suppressHydrationWarning===!0||U2(i.nodeValue,c)),i||Zo(s)}else i=Mh(i).createTextNode(h),i[Nr]=s,s.stateNode=i}return xr(s),null;case 13:if(h=s.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(g=ku(s),h!==null&&h.dehydrated!==null){if(i===null){if(!g)throw Error(n(318));if(g=s.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(n(317));g[Nr]=s}else Cu(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;xr(s),g=!1}else g=T_(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=g),g=!0;if(!g)return s.flags&256?(rs(s),s):(rs(s),null)}if(rs(s),(s.flags&128)!==0)return s.lanes=c,s;if(c=h!==null,i=i!==null&&i.memoizedState!==null,c){h=s.child,g=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(g=h.alternate.memoizedState.cachePool.pool);var x=null;h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(x=h.memoizedState.cachePool.pool),x!==g&&(h.flags|=2048)}return c!==i&&c&&(s.child.flags|=8192),bh(s,s.updateQueue),xr(s),null;case 4:return Fe(),i===null&&vg(s.stateNode.containerInfo),xr(s),null;case 10:return es(s.type),xr(s),null;case 19:if(V(Qr),g=s.memoizedState,g===null)return xr(s),null;if(h=(s.flags&128)!==0,x=g.rendering,x===null)if(h)Gu(g,!1);else{if(Er!==0||i!==null&&(i.flags&128)!==0)for(i=s.child;i!==null;){if(x=_h(i),x!==null){for(s.flags|=128,Gu(g,!1),i=x.updateQueue,s.updateQueue=i,bh(s,i),s.subtreeFlags=0,i=c,c=s.child;c!==null;)__(c,i),c=c.sibling;return K(Qr,Qr.current&1|2),s.child}i=i.sibling}g.tail!==null&&Ue()>kh&&(s.flags|=128,h=!0,Gu(g,!1),s.lanes=4194304)}else{if(!h)if(i=_h(x),i!==null){if(s.flags|=128,h=!0,i=i.updateQueue,s.updateQueue=i,bh(s,i),Gu(g,!0),g.tail===null&&g.tailMode==="hidden"&&!x.alternate&&!Gt)return xr(s),null}else 2*Ue()-g.renderingStartTime>kh&&c!==536870912&&(s.flags|=128,h=!0,Gu(g,!1),s.lanes=4194304);g.isBackwards?(x.sibling=s.child,s.child=x):(i=g.last,i!==null?i.sibling=x:s.child=x,g.last=x)}return g.tail!==null?(s=g.tail,g.rendering=s,g.tail=s.sibling,g.renderingStartTime=Ue(),s.sibling=null,i=Qr.current,K(Qr,h?i&1|2:i&1),s):(xr(s),null);case 22:case 23:return rs(s),yp(),h=s.memoizedState!==null,i!==null?i.memoizedState!==null!==h&&(s.flags|=8192):h&&(s.flags|=8192),h?(c&536870912)!==0&&(s.flags&128)===0&&(xr(s),s.subtreeFlags&6&&(s.flags|=8192)):xr(s),c=s.updateQueue,c!==null&&bh(s,c.retryQueue),c=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),h=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(h=s.memoizedState.cachePool.pool),h!==c&&(s.flags|=2048),i!==null&&V(tl),null;case 24:return c=null,i!==null&&(c=i.memoizedState.cache),s.memoizedState.cache!==c&&(s.flags|=2048),es($r),xr(s),null;case 25:return null;case 30:return null}throw Error(n(156,s.tag))}function HC(i,s){switch(sp(s),s.tag){case 1:return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 3:return es($r),Fe(),i=s.flags,(i&65536)!==0&&(i&128)===0?(s.flags=i&-65537|128,s):null;case 26:case 27:case 5:return Be(s),null;case 13:if(rs(s),i=s.memoizedState,i!==null&&i.dehydrated!==null){if(s.alternate===null)throw Error(n(340));Cu()}return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 19:return V(Qr),null;case 4:return Fe(),null;case 10:return es(s.type),null;case 22:case 23:return rs(s),yp(),i!==null&&V(tl),i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 24:return es($r),null;case 25:return null;default:return null}}function Wy(i,s){switch(sp(s),s.tag){case 3:es($r),Fe();break;case 26:case 27:case 5:Be(s);break;case 4:Fe();break;case 13:rs(s);break;case 19:V(Qr);break;case 10:es(s.type);break;case 22:case 23:rs(s),yp(),i!==null&&V(tl);break;case 24:es($r)}}function qu(i,s){try{var c=s.updateQueue,h=c!==null?c.lastEffect:null;if(h!==null){var g=h.next;c=g;do{if((c.tag&i)===i){h=void 0;var x=c.create,R=c.inst;h=x(),R.destroy=h}c=c.next}while(c!==g)}}catch(U){ir(s,s.return,U)}}function Ls(i,s,c){try{var h=s.updateQueue,g=h!==null?h.lastEffect:null;if(g!==null){var x=g.next;h=x;do{if((h.tag&i)===i){var R=h.inst,U=R.destroy;if(U!==void 0){R.destroy=void 0,g=s;var re=c,pe=U;try{pe()}catch(Ae){ir(g,re,Ae)}}}h=h.next}while(h!==x)}}catch(Ae){ir(s,s.return,Ae)}}function Xy(i){var s=i.updateQueue;if(s!==null){var c=i.stateNode;try{F_(s,c)}catch(h){ir(i,i.return,h)}}}function Ky(i,s,c){c.props=nl(i.type,i.memoizedProps),c.state=i.memoizedState;try{c.componentWillUnmount()}catch(h){ir(i,s,h)}}function Wu(i,s){try{var c=i.ref;if(c!==null){switch(i.tag){case 26:case 27:case 5:var h=i.stateNode;break;case 30:h=i.stateNode;break;default:h=i.stateNode}typeof c=="function"?i.refCleanup=c(h):c.current=h}}catch(g){ir(i,s,g)}}function yi(i,s){var c=i.ref,h=i.refCleanup;if(c!==null)if(typeof h=="function")try{h()}catch(g){ir(i,s,g)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(g){ir(i,s,g)}else c.current=null}function Yy(i){var s=i.type,c=i.memoizedProps,h=i.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":c.autoFocus&&h.focus();break e;case"img":c.src?h.src=c.src:c.srcSet&&(h.srcset=c.srcSet)}}catch(g){ir(i,i.return,g)}}function Kp(i,s,c){try{var h=i.stateNode;c3(h,i.type,c,s),h[mr]=s}catch(g){ir(i,i.return,g)}}function $y(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&Gs(i.type)||i.tag===4}function Yp(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||$y(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&Gs(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function $p(i,s,c){var h=i.tag;if(h===5||h===6)i=i.stateNode,s?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(i,s):(s=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,s.appendChild(i),c=c._reactRootContainer,c!=null||s.onclick!==null||(s.onclick=Lh));else if(h!==4&&(h===27&&Gs(i.type)&&(c=i.stateNode,s=null),i=i.child,i!==null))for($p(i,s,c),i=i.sibling;i!==null;)$p(i,s,c),i=i.sibling}function Sh(i,s,c){var h=i.tag;if(h===5||h===6)i=i.stateNode,s?c.insertBefore(i,s):c.appendChild(i);else if(h!==4&&(h===27&&Gs(i.type)&&(c=i.stateNode),i=i.child,i!==null))for(Sh(i,s,c),i=i.sibling;i!==null;)Sh(i,s,c),i=i.sibling}function Qy(i){var s=i.stateNode,c=i.memoizedProps;try{for(var h=i.type,g=s.attributes;g.length;)s.removeAttributeNode(g[0]);gn(s,h,c),s[Nr]=i,s[mr]=c}catch(x){ir(i,i.return,x)}}var is=!1,Dr=!1,Qp=!1,Zy=typeof WeakSet=="function"?WeakSet:Set,sn=null;function zC(i,s){if(i=i.containerInfo,wg=zh,i=c_(i),Ym(i)){if("selectionStart"in i)var c={start:i.selectionStart,end:i.selectionEnd};else e:{c=(c=i.ownerDocument)&&c.defaultView||window;var h=c.getSelection&&c.getSelection();if(h&&h.rangeCount!==0){c=h.anchorNode;var g=h.anchorOffset,x=h.focusNode;h=h.focusOffset;try{c.nodeType,x.nodeType}catch{c=null;break e}var R=0,U=-1,re=-1,pe=0,Ae=0,Ie=i,_e=null;t:for(;;){for(var Ee;Ie!==c||g!==0&&Ie.nodeType!==3||(U=R+g),Ie!==x||h!==0&&Ie.nodeType!==3||(re=R+h),Ie.nodeType===3&&(R+=Ie.nodeValue.length),(Ee=Ie.firstChild)!==null;)_e=Ie,Ie=Ee;for(;;){if(Ie===i)break t;if(_e===c&&++pe===g&&(U=R),_e===x&&++Ae===h&&(re=R),(Ee=Ie.nextSibling)!==null)break;Ie=_e,_e=Ie.parentNode}Ie=Ee}c=U===-1||re===-1?null:{start:U,end:re}}else c=null}c=c||{start:0,end:0}}else c=null;for(Eg={focusedElem:i,selectionRange:c},zh=!1,sn=s;sn!==null;)if(s=sn,i=s.child,(s.subtreeFlags&1024)!==0&&i!==null)i.return=s,sn=i;else for(;sn!==null;){switch(s=sn,x=s.alternate,i=s.flags,s.tag){case 0:break;case 11:case 15:break;case 1:if((i&1024)!==0&&x!==null){i=void 0,c=s,g=x.memoizedProps,x=x.memoizedState,h=c.stateNode;try{var ht=nl(c.type,g,c.elementType===c.type);i=h.getSnapshotBeforeUpdate(ht,x),h.__reactInternalSnapshotBeforeUpdate=i}catch(it){ir(c,c.return,it)}}break;case 3:if((i&1024)!==0){if(i=s.stateNode.containerInfo,c=i.nodeType,c===9)Sg(i);else if(c===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":Sg(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(n(163))}if(i=s.sibling,i!==null){i.return=s.return,sn=i;break}sn=s.return}}function Jy(i,s,c){var h=c.flags;switch(c.tag){case 0:case 11:case 15:Ms(i,c),h&4&&qu(5,c);break;case 1:if(Ms(i,c),h&4)if(i=c.stateNode,s===null)try{i.componentDidMount()}catch(R){ir(c,c.return,R)}else{var g=nl(c.type,s.memoizedProps);s=s.memoizedState;try{i.componentDidUpdate(g,s,i.__reactInternalSnapshotBeforeUpdate)}catch(R){ir(c,c.return,R)}}h&64&&Xy(c),h&512&&Wu(c,c.return);break;case 3:if(Ms(i,c),h&64&&(i=c.updateQueue,i!==null)){if(s=null,c.child!==null)switch(c.child.tag){case 27:case 5:s=c.child.stateNode;break;case 1:s=c.child.stateNode}try{F_(i,s)}catch(R){ir(c,c.return,R)}}break;case 27:s===null&&h&4&&Qy(c);case 26:case 5:Ms(i,c),s===null&&h&4&&Yy(c),h&512&&Wu(c,c.return);break;case 12:Ms(i,c);break;case 13:Ms(i,c),h&4&&r2(i,c),h&64&&(i=c.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(c=ZC.bind(null,c),g3(i,c))));break;case 22:if(h=c.memoizedState!==null||is,!h){s=s!==null&&s.memoizedState!==null||Dr,g=is;var x=Dr;is=h,(Dr=s)&&!x?Us(i,c,(c.subtreeFlags&8772)!==0):Ms(i,c),is=g,Dr=x}break;case 30:break;default:Ms(i,c)}}function e2(i){var s=i.alternate;s!==null&&(i.alternate=null,e2(s)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(s=i.stateNode,s!==null&&G(s)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var pr=null,Zn=!1;function ss(i,s,c){for(c=c.child;c!==null;)t2(i,s,c),c=c.sibling}function t2(i,s,c){if(kt&&typeof kt.onCommitFiberUnmount=="function")try{kt.onCommitFiberUnmount(Ut,c)}catch{}switch(c.tag){case 26:Dr||yi(c,s),ss(i,s,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:Dr||yi(c,s);var h=pr,g=Zn;Gs(c.type)&&(pr=c.stateNode,Zn=!1),ss(i,s,c),tf(c.stateNode),pr=h,Zn=g;break;case 5:Dr||yi(c,s);case 6:if(h=pr,g=Zn,pr=null,ss(i,s,c),pr=h,Zn=g,pr!==null)if(Zn)try{(pr.nodeType===9?pr.body:pr.nodeName==="HTML"?pr.ownerDocument.body:pr).removeChild(c.stateNode)}catch(x){ir(c,s,x)}else try{pr.removeChild(c.stateNode)}catch(x){ir(c,s,x)}break;case 18:pr!==null&&(Zn?(i=pr,z2(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,c.stateNode),uf(i)):z2(pr,c.stateNode));break;case 4:h=pr,g=Zn,pr=c.stateNode.containerInfo,Zn=!0,ss(i,s,c),pr=h,Zn=g;break;case 0:case 11:case 14:case 15:Dr||Ls(2,c,s),Dr||Ls(4,c,s),ss(i,s,c);break;case 1:Dr||(yi(c,s),h=c.stateNode,typeof h.componentWillUnmount=="function"&&Ky(c,s,h)),ss(i,s,c);break;case 21:ss(i,s,c);break;case 22:Dr=(h=Dr)||c.memoizedState!==null,ss(i,s,c),Dr=h;break;default:ss(i,s,c)}}function r2(i,s){if(s.memoizedState===null&&(i=s.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{uf(i)}catch(c){ir(s,s.return,c)}}function GC(i){switch(i.tag){case 13:case 19:var s=i.stateNode;return s===null&&(s=i.stateNode=new Zy),s;case 22:return i=i.stateNode,s=i._retryCache,s===null&&(s=i._retryCache=new Zy),s;default:throw Error(n(435,i.tag))}}function Zp(i,s){var c=GC(i);s.forEach(function(h){var g=JC.bind(null,i,h);c.has(h)||(c.add(h),h.then(g,g))})}function ca(i,s){var c=s.deletions;if(c!==null)for(var h=0;h<c.length;h++){var g=c[h],x=i,R=s,U=R;e:for(;U!==null;){switch(U.tag){case 27:if(Gs(U.type)){pr=U.stateNode,Zn=!1;break e}break;case 5:pr=U.stateNode,Zn=!1;break e;case 3:case 4:pr=U.stateNode.containerInfo,Zn=!0;break e}U=U.return}if(pr===null)throw Error(n(160));t2(x,R,g),pr=null,Zn=!1,x=g.alternate,x!==null&&(x.return=null),g.return=null}if(s.subtreeFlags&13878)for(s=s.child;s!==null;)n2(s,i),s=s.sibling}var Ya=null;function n2(i,s){var c=i.alternate,h=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:ca(s,i),ua(i),h&4&&(Ls(3,i,i.return),qu(3,i),Ls(5,i,i.return));break;case 1:ca(s,i),ua(i),h&512&&(Dr||c===null||yi(c,c.return)),h&64&&is&&(i=i.updateQueue,i!==null&&(h=i.callbacks,h!==null&&(c=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=c===null?h:c.concat(h))));break;case 26:var g=Ya;if(ca(s,i),ua(i),h&512&&(Dr||c===null||yi(c,c.return)),h&4){var x=c!==null?c.memoizedState:null;if(h=i.memoizedState,c===null)if(h===null)if(i.stateNode===null){e:{h=i.type,c=i.memoizedProps,g=g.ownerDocument||g;t:switch(h){case"title":x=g.getElementsByTagName("title")[0],(!x||x[H]||x[Nr]||x.namespaceURI==="http://www.w3.org/2000/svg"||x.hasAttribute("itemprop"))&&(x=g.createElement(h),g.head.insertBefore(x,g.querySelector("head > title"))),gn(x,h,c),x[Nr]=i,le(x),h=x;break e;case"link":var R=Q2("link","href",g).get(h+(c.href||""));if(R){for(var U=0;U<R.length;U++)if(x=R[U],x.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&x.getAttribute("rel")===(c.rel==null?null:c.rel)&&x.getAttribute("title")===(c.title==null?null:c.title)&&x.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){R.splice(U,1);break t}}x=g.createElement(h),gn(x,h,c),g.head.appendChild(x);break;case"meta":if(R=Q2("meta","content",g).get(h+(c.content||""))){for(U=0;U<R.length;U++)if(x=R[U],x.getAttribute("content")===(c.content==null?null:""+c.content)&&x.getAttribute("name")===(c.name==null?null:c.name)&&x.getAttribute("property")===(c.property==null?null:c.property)&&x.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&x.getAttribute("charset")===(c.charSet==null?null:c.charSet)){R.splice(U,1);break t}}x=g.createElement(h),gn(x,h,c),g.head.appendChild(x);break;default:throw Error(n(468,h))}x[Nr]=i,le(x),h=x}i.stateNode=h}else Z2(g,i.type,i.stateNode);else i.stateNode=$2(g,h,i.memoizedProps);else x!==h?(x===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):x.count--,h===null?Z2(g,i.type,i.stateNode):$2(g,h,i.memoizedProps)):h===null&&i.stateNode!==null&&Kp(i,i.memoizedProps,c.memoizedProps)}break;case 27:ca(s,i),ua(i),h&512&&(Dr||c===null||yi(c,c.return)),c!==null&&h&4&&Kp(i,i.memoizedProps,c.memoizedProps);break;case 5:if(ca(s,i),ua(i),h&512&&(Dr||c===null||yi(c,c.return)),i.flags&32){g=i.stateNode;try{ba(g,"")}catch(Ee){ir(i,i.return,Ee)}}h&4&&i.stateNode!=null&&(g=i.memoizedProps,Kp(i,g,c!==null?c.memoizedProps:g)),h&1024&&(Qp=!0);break;case 6:if(ca(s,i),ua(i),h&4){if(i.stateNode===null)throw Error(n(162));h=i.memoizedProps,c=i.stateNode;try{c.nodeValue=h}catch(Ee){ir(i,i.return,Ee)}}break;case 3:if(Vh=null,g=Ya,Ya=Uh(s.containerInfo),ca(s,i),Ya=g,ua(i),h&4&&c!==null&&c.memoizedState.isDehydrated)try{uf(s.containerInfo)}catch(Ee){ir(i,i.return,Ee)}Qp&&(Qp=!1,a2(i));break;case 4:h=Ya,Ya=Uh(i.stateNode.containerInfo),ca(s,i),ua(i),Ya=h;break;case 12:ca(s,i),ua(i);break;case 13:ca(s,i),ua(i),i.child.flags&8192&&i.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(ag=Ue()),h&4&&(h=i.updateQueue,h!==null&&(i.updateQueue=null,Zp(i,h)));break;case 22:g=i.memoizedState!==null;var re=c!==null&&c.memoizedState!==null,pe=is,Ae=Dr;if(is=pe||g,Dr=Ae||re,ca(s,i),Dr=Ae,is=pe,ua(i),h&8192)e:for(s=i.stateNode,s._visibility=g?s._visibility&-2:s._visibility|1,g&&(c===null||re||is||Dr||al(i)),c=null,s=i;;){if(s.tag===5||s.tag===26){if(c===null){re=c=s;try{if(x=re.stateNode,g)R=x.style,typeof R.setProperty=="function"?R.setProperty("display","none","important"):R.display="none";else{U=re.stateNode;var Ie=re.memoizedProps.style,_e=Ie!=null&&Ie.hasOwnProperty("display")?Ie.display:null;U.style.display=_e==null||typeof _e=="boolean"?"":(""+_e).trim()}}catch(Ee){ir(re,re.return,Ee)}}}else if(s.tag===6){if(c===null){re=s;try{re.stateNode.nodeValue=g?"":re.memoizedProps}catch(Ee){ir(re,re.return,Ee)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===i)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;c===s&&(c=null),s=s.return}c===s&&(c=null),s.sibling.return=s.return,s=s.sibling}h&4&&(h=i.updateQueue,h!==null&&(c=h.retryQueue,c!==null&&(h.retryQueue=null,Zp(i,c))));break;case 19:ca(s,i),ua(i),h&4&&(h=i.updateQueue,h!==null&&(i.updateQueue=null,Zp(i,h)));break;case 30:break;case 21:break;default:ca(s,i),ua(i)}}function ua(i){var s=i.flags;if(s&2){try{for(var c,h=i.return;h!==null;){if($y(h)){c=h;break}h=h.return}if(c==null)throw Error(n(160));switch(c.tag){case 27:var g=c.stateNode,x=Yp(i);Sh(i,x,g);break;case 5:var R=c.stateNode;c.flags&32&&(ba(R,""),c.flags&=-33);var U=Yp(i);Sh(i,U,R);break;case 3:case 4:var re=c.stateNode.containerInfo,pe=Yp(i);$p(i,pe,re);break;default:throw Error(n(161))}}catch(Ae){ir(i,i.return,Ae)}i.flags&=-3}s&4096&&(i.flags&=-4097)}function a2(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var s=i;a2(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),i=i.sibling}}function Ms(i,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)Jy(i,s.alternate,s),s=s.sibling}function al(i){for(i=i.child;i!==null;){var s=i;switch(s.tag){case 0:case 11:case 14:case 15:Ls(4,s,s.return),al(s);break;case 1:yi(s,s.return);var c=s.stateNode;typeof c.componentWillUnmount=="function"&&Ky(s,s.return,c),al(s);break;case 27:tf(s.stateNode);case 26:case 5:yi(s,s.return),al(s);break;case 22:s.memoizedState===null&&al(s);break;case 30:al(s);break;default:al(s)}i=i.sibling}}function Us(i,s,c){for(c=c&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var h=s.alternate,g=i,x=s,R=x.flags;switch(x.tag){case 0:case 11:case 15:Us(g,x,c),qu(4,x);break;case 1:if(Us(g,x,c),h=x,g=h.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(pe){ir(h,h.return,pe)}if(h=x,g=h.updateQueue,g!==null){var U=h.stateNode;try{var re=g.shared.hiddenCallbacks;if(re!==null)for(g.shared.hiddenCallbacks=null,g=0;g<re.length;g++)O_(re[g],U)}catch(pe){ir(h,h.return,pe)}}c&&R&64&&Xy(x),Wu(x,x.return);break;case 27:Qy(x);case 26:case 5:Us(g,x,c),c&&h===null&&R&4&&Yy(x),Wu(x,x.return);break;case 12:Us(g,x,c);break;case 13:Us(g,x,c),c&&R&4&&r2(g,x);break;case 22:x.memoizedState===null&&Us(g,x,c),Wu(x,x.return);break;case 30:break;default:Us(g,x,c)}s=s.sibling}}function Jp(i,s){var c=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),i=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(i=s.memoizedState.cachePool.pool),i!==c&&(i!=null&&i.refCount++,c!=null&&Iu(c))}function eg(i,s){i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&Iu(i))}function wi(i,s,c,h){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)i2(i,s,c,h),s=s.sibling}function i2(i,s,c,h){var g=s.flags;switch(s.tag){case 0:case 11:case 15:wi(i,s,c,h),g&2048&&qu(9,s);break;case 1:wi(i,s,c,h);break;case 3:wi(i,s,c,h),g&2048&&(i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&Iu(i)));break;case 12:if(g&2048){wi(i,s,c,h),i=s.stateNode;try{var x=s.memoizedProps,R=x.id,U=x.onPostCommit;typeof U=="function"&&U(R,s.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(re){ir(s,s.return,re)}}else wi(i,s,c,h);break;case 13:wi(i,s,c,h);break;case 23:break;case 22:x=s.stateNode,R=s.alternate,s.memoizedState!==null?x._visibility&2?wi(i,s,c,h):Xu(i,s):x._visibility&2?wi(i,s,c,h):(x._visibility|=2,mc(i,s,c,h,(s.subtreeFlags&10256)!==0)),g&2048&&Jp(R,s);break;case 24:wi(i,s,c,h),g&2048&&eg(s.alternate,s);break;default:wi(i,s,c,h)}}function mc(i,s,c,h,g){for(g=g&&(s.subtreeFlags&10256)!==0,s=s.child;s!==null;){var x=i,R=s,U=c,re=h,pe=R.flags;switch(R.tag){case 0:case 11:case 15:mc(x,R,U,re,g),qu(8,R);break;case 23:break;case 22:var Ae=R.stateNode;R.memoizedState!==null?Ae._visibility&2?mc(x,R,U,re,g):Xu(x,R):(Ae._visibility|=2,mc(x,R,U,re,g)),g&&pe&2048&&Jp(R.alternate,R);break;case 24:mc(x,R,U,re,g),g&&pe&2048&&eg(R.alternate,R);break;default:mc(x,R,U,re,g)}s=s.sibling}}function Xu(i,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var c=i,h=s,g=h.flags;switch(h.tag){case 22:Xu(c,h),g&2048&&Jp(h.alternate,h);break;case 24:Xu(c,h),g&2048&&eg(h.alternate,h);break;default:Xu(c,h)}s=s.sibling}}var Ku=8192;function pc(i){if(i.subtreeFlags&Ku)for(i=i.child;i!==null;)s2(i),i=i.sibling}function s2(i){switch(i.tag){case 26:pc(i),i.flags&Ku&&i.memoizedState!==null&&R3(Ya,i.memoizedState,i.memoizedProps);break;case 5:pc(i);break;case 3:case 4:var s=Ya;Ya=Uh(i.stateNode.containerInfo),pc(i),Ya=s;break;case 22:i.memoizedState===null&&(s=i.alternate,s!==null&&s.memoizedState!==null?(s=Ku,Ku=16777216,pc(i),Ku=s):pc(i));break;default:pc(i)}}function o2(i){var s=i.alternate;if(s!==null&&(i=s.child,i!==null)){s.child=null;do s=i.sibling,i.sibling=null,i=s;while(i!==null)}}function Yu(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var c=0;c<s.length;c++){var h=s[c];sn=h,c2(h,i)}o2(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)l2(i),i=i.sibling}function l2(i){switch(i.tag){case 0:case 11:case 15:Yu(i),i.flags&2048&&Ls(9,i,i.return);break;case 3:Yu(i);break;case 12:Yu(i);break;case 22:var s=i.stateNode;i.memoizedState!==null&&s._visibility&2&&(i.return===null||i.return.tag!==13)?(s._visibility&=-3,Ah(i)):Yu(i);break;default:Yu(i)}}function Ah(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var c=0;c<s.length;c++){var h=s[c];sn=h,c2(h,i)}o2(i)}for(i=i.child;i!==null;){switch(s=i,s.tag){case 0:case 11:case 15:Ls(8,s,s.return),Ah(s);break;case 22:c=s.stateNode,c._visibility&2&&(c._visibility&=-3,Ah(s));break;default:Ah(s)}i=i.sibling}}function c2(i,s){for(;sn!==null;){var c=sn;switch(c.tag){case 0:case 11:case 15:Ls(8,c,s);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var h=c.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:Iu(c.memoizedState.cache)}if(h=c.child,h!==null)h.return=c,sn=h;else e:for(c=i;sn!==null;){h=sn;var g=h.sibling,x=h.return;if(e2(h),h===c){sn=null;break e}if(g!==null){g.return=x,sn=g;break e}sn=x}}}var qC={getCacheForType:function(i){var s=bn($r),c=s.data.get(i);return c===void 0&&(c=i(),s.data.set(i,c)),c}},WC=typeof WeakMap=="function"?WeakMap:Map,Kt=0,lr=null,Ct=null,Lt=0,Yt=0,fa=null,Bs=!1,gc=!1,tg=!1,os=0,Er=0,Vs=0,il=0,rg=0,Oa=0,xc=0,$u=null,Jn=null,ng=!1,ag=0,kh=1/0,Ch=null,js=null,pn=0,Hs=null,vc=null,_c=0,ig=0,sg=null,u2=null,Qu=0,og=null;function ha(){if((Kt&2)!==0&&Lt!==0)return Lt&-Lt;if(ne.T!==null){var i=sc;return i!==0?i:mg()}return li()}function f2(){Oa===0&&(Oa=(Lt&536870912)===0||Gt?bs():536870912);var i=Da.current;return i!==null&&(i.flags|=32),Oa}function da(i,s,c){(i===lr&&(Yt===2||Yt===9)||i.cancelPendingCommit!==null)&&(yc(i,0),zs(i,Lt,Oa,!1)),Wa(i,c),((Kt&2)===0||i!==lr)&&(i===lr&&((Kt&2)===0&&(il|=c),Er===4&&zs(i,Lt,Oa,!1)),Ei(i))}function h2(i,s,c){if((Kt&6)!==0)throw Error(n(327));var h=!c&&(s&124)===0&&(s&i.expiredLanes)===0||Hi(i,s),g=h?YC(i,s):ug(i,s,!0),x=h;do{if(g===0){gc&&!h&&zs(i,s,0,!1);break}else{if(c=i.current.alternate,x&&!XC(c)){g=ug(i,s,!1),x=!1;continue}if(g===2){if(x=s,i.errorRecoveryDisabledLanes&x)var R=0;else R=i.pendingLanes&-536870913,R=R!==0?R:R&536870912?536870912:0;if(R!==0){s=R;e:{var U=i;g=$u;var re=U.current.memoizedState.isDehydrated;if(re&&(yc(U,R).flags|=256),R=ug(U,R,!1),R!==2){if(tg&&!re){U.errorRecoveryDisabledLanes|=x,il|=x,g=4;break e}x=Jn,Jn=g,x!==null&&(Jn===null?Jn=x:Jn.push.apply(Jn,x))}g=R}if(x=!1,g!==2)continue}}if(g===1){yc(i,0),zs(i,s,0,!0);break}e:{switch(h=i,x=g,x){case 0:case 1:throw Error(n(345));case 4:if((s&4194048)!==s)break;case 6:zs(h,s,Oa,!Bs);break e;case 2:Jn=null;break;case 3:case 5:break;default:throw Error(n(329))}if((s&62914560)===s&&(g=ag+300-Ue(),10<g)){if(zs(h,s,Oa,!Bs),Un(h,0,!0)!==0)break e;h.timeoutHandle=j2(d2.bind(null,h,c,Jn,Ch,ng,s,Oa,il,xc,Bs,x,2,-0,0),g);break e}d2(h,c,Jn,Ch,ng,s,Oa,il,xc,Bs,x,0,-0,0)}}break}while(!0);Ei(i)}function d2(i,s,c,h,g,x,R,U,re,pe,Ae,Ie,_e,Ee){if(i.timeoutHandle=-1,Ie=s.subtreeFlags,(Ie&8192||(Ie&16785408)===16785408)&&(af={stylesheets:null,count:0,unsuspend:C3},s2(s),Ie=N3(),Ie!==null)){i.cancelPendingCommit=Ie(y2.bind(null,i,s,x,c,h,g,R,U,re,Ae,1,_e,Ee)),zs(i,x,R,!pe);return}y2(i,s,x,c,h,g,R,U,re)}function XC(i){for(var s=i;;){var c=s.tag;if((c===0||c===11||c===15)&&s.flags&16384&&(c=s.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var h=0;h<c.length;h++){var g=c[h],x=g.getSnapshot;g=g.value;try{if(!oa(x(),g))return!1}catch{return!1}}if(c=s.child,s.subtreeFlags&16384&&c!==null)c.return=s,s=c;else{if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function zs(i,s,c,h){s&=~rg,s&=~il,i.suspendedLanes|=s,i.pingedLanes&=~s,h&&(i.warmLanes|=s),h=i.expirationTimes;for(var g=s;0<g;){var x=31-Me(g),R=1<<x;h[x]=-1,g&=~R}c!==0&&Ta(i,c,s)}function Rh(){return(Kt&6)===0?(Zu(0),!1):!0}function lg(){if(Ct!==null){if(Yt===0)var i=Ct.return;else i=Ct,Ji=Jo=null,Sp(i),hc=null,Hu=0,i=Ct;for(;i!==null;)Wy(i.alternate,i),i=i.return;Ct=null}}function yc(i,s){var c=i.timeoutHandle;c!==-1&&(i.timeoutHandle=-1,f3(c)),c=i.cancelPendingCommit,c!==null&&(i.cancelPendingCommit=null,c()),lg(),lr=i,Ct=c=$i(i.current,null),Lt=s,Yt=0,fa=null,Bs=!1,gc=Hi(i,s),tg=!1,xc=Oa=rg=il=Vs=Er=0,Jn=$u=null,ng=!1,(s&8)!==0&&(s|=s&32);var h=i.entangledLanes;if(h!==0)for(i=i.entanglements,h&=s;0<h;){var g=31-Me(h),x=1<<g;s|=i[g],h&=~x}return os=s,Q0(),c}function m2(i,s){Et=null,ne.H=gh,s===Ou||s===sh?(s=I_(),Yt=3):s===C_?(s=I_(),Yt=4):Yt=s===Dy?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,fa=s,Ct===null&&(Er=1,wh(i,Ca(s,i.current)))}function p2(){var i=ne.H;return ne.H=gh,i===null?gh:i}function g2(){var i=ne.A;return ne.A=qC,i}function cg(){Er=4,Bs||(Lt&4194048)!==Lt&&Da.current!==null||(gc=!0),(Vs&134217727)===0&&(il&134217727)===0||lr===null||zs(lr,Lt,Oa,!1)}function ug(i,s,c){var h=Kt;Kt|=2;var g=p2(),x=g2();(lr!==i||Lt!==s)&&(Ch=null,yc(i,s)),s=!1;var R=Er;e:do try{if(Yt!==0&&Ct!==null){var U=Ct,re=fa;switch(Yt){case 8:lg(),R=6;break e;case 3:case 2:case 9:case 6:Da.current===null&&(s=!0);var pe=Yt;if(Yt=0,fa=null,wc(i,U,re,pe),c&&gc){R=0;break e}break;default:pe=Yt,Yt=0,fa=null,wc(i,U,re,pe)}}KC(),R=Er;break}catch(Ae){m2(i,Ae)}while(!0);return s&&i.shellSuspendCounter++,Ji=Jo=null,Kt=h,ne.H=g,ne.A=x,Ct===null&&(lr=null,Lt=0,Q0()),R}function KC(){for(;Ct!==null;)x2(Ct)}function YC(i,s){var c=Kt;Kt|=2;var h=p2(),g=g2();lr!==i||Lt!==s?(Ch=null,kh=Ue()+500,yc(i,s)):gc=Hi(i,s);e:do try{if(Yt!==0&&Ct!==null){s=Ct;var x=fa;t:switch(Yt){case 1:Yt=0,fa=null,wc(i,s,x,1);break;case 2:case 9:if(R_(x)){Yt=0,fa=null,v2(s);break}s=function(){Yt!==2&&Yt!==9||lr!==i||(Yt=7),Ei(i)},x.then(s,s);break e;case 3:Yt=7;break e;case 4:Yt=5;break e;case 7:R_(x)?(Yt=0,fa=null,v2(s)):(Yt=0,fa=null,wc(i,s,x,7));break;case 5:var R=null;switch(Ct.tag){case 26:R=Ct.memoizedState;case 5:case 27:var U=Ct;if(!R||J2(R)){Yt=0,fa=null;var re=U.sibling;if(re!==null)Ct=re;else{var pe=U.return;pe!==null?(Ct=pe,Nh(pe)):Ct=null}break t}}Yt=0,fa=null,wc(i,s,x,5);break;case 6:Yt=0,fa=null,wc(i,s,x,6);break;case 8:lg(),Er=6;break e;default:throw Error(n(462))}}$C();break}catch(Ae){m2(i,Ae)}while(!0);return Ji=Jo=null,ne.H=h,ne.A=g,Kt=c,Ct!==null?0:(lr=null,Lt=0,Q0(),Er)}function $C(){for(;Ct!==null&&!wt();)x2(Ct)}function x2(i){var s=Gy(i.alternate,i,os);i.memoizedProps=i.pendingProps,s===null?Nh(i):Ct=s}function v2(i){var s=i,c=s.alternate;switch(s.tag){case 15:case 0:s=Uy(c,s,s.pendingProps,s.type,void 0,Lt);break;case 11:s=Uy(c,s,s.pendingProps,s.type.render,s.ref,Lt);break;case 5:Sp(s);default:Wy(c,s),s=Ct=__(s,os),s=Gy(c,s,os)}i.memoizedProps=i.pendingProps,s===null?Nh(i):Ct=s}function wc(i,s,c,h){Ji=Jo=null,Sp(s),hc=null,Hu=0;var g=s.return;try{if(BC(i,g,s,c,Lt)){Er=1,wh(i,Ca(c,i.current)),Ct=null;return}}catch(x){if(g!==null)throw Ct=g,x;Er=1,wh(i,Ca(c,i.current)),Ct=null;return}s.flags&32768?(Gt||h===1?i=!0:gc||(Lt&536870912)!==0?i=!1:(Bs=i=!0,(h===2||h===9||h===3||h===6)&&(h=Da.current,h!==null&&h.tag===13&&(h.flags|=16384))),_2(s,i)):Nh(s)}function Nh(i){var s=i;do{if((s.flags&32768)!==0){_2(s,Bs);return}i=s.return;var c=jC(s.alternate,s,os);if(c!==null){Ct=c;return}if(s=s.sibling,s!==null){Ct=s;return}Ct=s=i}while(s!==null);Er===0&&(Er=5)}function _2(i,s){do{var c=HC(i.alternate,i);if(c!==null){c.flags&=32767,Ct=c;return}if(c=i.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!s&&(i=i.sibling,i!==null)){Ct=i;return}Ct=i=c}while(i!==null);Er=6,Ct=null}function y2(i,s,c,h,g,x,R,U,re){i.cancelPendingCommit=null;do Ih();while(pn!==0);if((Kt&6)!==0)throw Error(n(327));if(s!==null){if(s===i.current)throw Error(n(177));if(x=s.lanes|s.childLanes,x|=ep,si(i,c,x,R,U,re),i===lr&&(Ct=lr=null,Lt=0),vc=s,Hs=i,_c=c,ig=x,sg=g,u2=h,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,e3(Xr,function(){return S2(),null})):(i.callbackNode=null,i.callbackPriority=0),h=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||h){h=ne.T,ne.T=null,g=ue.p,ue.p=2,R=Kt,Kt|=4;try{zC(i,s,c)}finally{Kt=R,ue.p=g,ne.T=h}}pn=1,w2(),E2(),T2()}}function w2(){if(pn===1){pn=0;var i=Hs,s=vc,c=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||c){c=ne.T,ne.T=null;var h=ue.p;ue.p=2;var g=Kt;Kt|=4;try{n2(s,i);var x=Eg,R=c_(i.containerInfo),U=x.focusedElem,re=x.selectionRange;if(R!==U&&U&&U.ownerDocument&&l_(U.ownerDocument.documentElement,U)){if(re!==null&&Ym(U)){var pe=re.start,Ae=re.end;if(Ae===void 0&&(Ae=pe),"selectionStart"in U)U.selectionStart=pe,U.selectionEnd=Math.min(Ae,U.value.length);else{var Ie=U.ownerDocument||document,_e=Ie&&Ie.defaultView||window;if(_e.getSelection){var Ee=_e.getSelection(),ht=U.textContent.length,it=Math.min(re.start,ht),nr=re.end===void 0?it:Math.min(re.end,ht);!Ee.extend&&it>nr&&(R=nr,nr=it,it=R);var oe=o_(U,it),ae=o_(U,nr);if(oe&&ae&&(Ee.rangeCount!==1||Ee.anchorNode!==oe.node||Ee.anchorOffset!==oe.offset||Ee.focusNode!==ae.node||Ee.focusOffset!==ae.offset)){var de=Ie.createRange();de.setStart(oe.node,oe.offset),Ee.removeAllRanges(),it>nr?(Ee.addRange(de),Ee.extend(ae.node,ae.offset)):(de.setEnd(ae.node,ae.offset),Ee.addRange(de))}}}}for(Ie=[],Ee=U;Ee=Ee.parentNode;)Ee.nodeType===1&&Ie.push({element:Ee,left:Ee.scrollLeft,top:Ee.scrollTop});for(typeof U.focus=="function"&&U.focus(),U=0;U<Ie.length;U++){var Ce=Ie[U];Ce.element.scrollLeft=Ce.left,Ce.element.scrollTop=Ce.top}}zh=!!wg,Eg=wg=null}finally{Kt=g,ue.p=h,ne.T=c}}i.current=s,pn=2}}function E2(){if(pn===2){pn=0;var i=Hs,s=vc,c=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||c){c=ne.T,ne.T=null;var h=ue.p;ue.p=2;var g=Kt;Kt|=4;try{Jy(i,s.alternate,s)}finally{Kt=g,ue.p=h,ne.T=c}}pn=3}}function T2(){if(pn===4||pn===3){pn=0,ut();var i=Hs,s=vc,c=_c,h=u2;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?pn=5:(pn=0,vc=Hs=null,b2(i,i.pendingLanes));var g=i.pendingLanes;if(g===0&&(js=null),As(c),s=s.stateNode,kt&&typeof kt.onCommitFiberRoot=="function")try{kt.onCommitFiberRoot(Ut,s,void 0,(s.current.flags&128)===128)}catch{}if(h!==null){s=ne.T,g=ue.p,ue.p=2,ne.T=null;try{for(var x=i.onRecoverableError,R=0;R<h.length;R++){var U=h[R];x(U.value,{componentStack:U.stack})}}finally{ne.T=s,ue.p=g}}(_c&3)!==0&&Ih(),Ei(i),g=i.pendingLanes,(c&4194090)!==0&&(g&42)!==0?i===og?Qu++:(Qu=0,og=i):Qu=0,Zu(0)}}function b2(i,s){(i.pooledCacheLanes&=s)===0&&(s=i.pooledCache,s!=null&&(i.pooledCache=null,Iu(s)))}function Ih(i){return w2(),E2(),T2(),S2()}function S2(){if(pn!==5)return!1;var i=Hs,s=ig;ig=0;var c=As(_c),h=ne.T,g=ue.p;try{ue.p=32>c?32:c,ne.T=null,c=sg,sg=null;var x=Hs,R=_c;if(pn=0,vc=Hs=null,_c=0,(Kt&6)!==0)throw Error(n(331));var U=Kt;if(Kt|=4,l2(x.current),i2(x,x.current,R,c),Kt=U,Zu(0,!1),kt&&typeof kt.onPostCommitFiberRoot=="function")try{kt.onPostCommitFiberRoot(Ut,x)}catch{}return!0}finally{ue.p=g,ne.T=h,b2(i,s)}}function A2(i,s,c){s=Ca(c,s),s=Bp(i.stateNode,s,2),i=Ds(i,s,2),i!==null&&(Wa(i,2),Ei(i))}function ir(i,s,c){if(i.tag===3)A2(i,i,c);else for(;s!==null;){if(s.tag===3){A2(s,i,c);break}else if(s.tag===1){var h=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(js===null||!js.has(h))){i=Ca(c,i),c=Ny(2),h=Ds(s,c,2),h!==null&&(Iy(c,h,s,i),Wa(h,2),Ei(h));break}}s=s.return}}function fg(i,s,c){var h=i.pingCache;if(h===null){h=i.pingCache=new WC;var g=new Set;h.set(s,g)}else g=h.get(s),g===void 0&&(g=new Set,h.set(s,g));g.has(c)||(tg=!0,g.add(c),i=QC.bind(null,i,s,c),s.then(i,i))}function QC(i,s,c){var h=i.pingCache;h!==null&&h.delete(s),i.pingedLanes|=i.suspendedLanes&c,i.warmLanes&=~c,lr===i&&(Lt&c)===c&&(Er===4||Er===3&&(Lt&62914560)===Lt&&300>Ue()-ag?(Kt&2)===0&&yc(i,0):rg|=c,xc===Lt&&(xc=0)),Ei(i)}function k2(i,s){s===0&&(s=Ss()),i=rc(i,s),i!==null&&(Wa(i,s),Ei(i))}function ZC(i){var s=i.memoizedState,c=0;s!==null&&(c=s.retryLane),k2(i,c)}function JC(i,s){var c=0;switch(i.tag){case 13:var h=i.stateNode,g=i.memoizedState;g!==null&&(c=g.retryLane);break;case 19:h=i.stateNode;break;case 22:h=i.stateNode._retryCache;break;default:throw Error(n(314))}h!==null&&h.delete(s),k2(i,c)}function e3(i,s){return rt(i,s)}var Dh=null,Ec=null,hg=!1,Oh=!1,dg=!1,sl=0;function Ei(i){i!==Ec&&i.next===null&&(Ec===null?Dh=Ec=i:Ec=Ec.next=i),Oh=!0,hg||(hg=!0,r3())}function Zu(i,s){if(!dg&&Oh){dg=!0;do for(var c=!1,h=Dh;h!==null;){if(i!==0){var g=h.pendingLanes;if(g===0)var x=0;else{var R=h.suspendedLanes,U=h.pingedLanes;x=(1<<31-Me(42|i)+1)-1,x&=g&~(R&~U),x=x&201326741?x&201326741|1:x?x|2:0}x!==0&&(c=!0,I2(h,x))}else x=Lt,x=Un(h,h===lr?x:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(x&3)===0||Hi(h,x)||(c=!0,I2(h,x));h=h.next}while(c);dg=!1}}function t3(){C2()}function C2(){Oh=hg=!1;var i=0;sl!==0&&(u3()&&(i=sl),sl=0);for(var s=Ue(),c=null,h=Dh;h!==null;){var g=h.next,x=R2(h,s);x===0?(h.next=null,c===null?Dh=g:c.next=g,g===null&&(Ec=c)):(c=h,(i!==0||(x&3)!==0)&&(Oh=!0)),h=g}Zu(i)}function R2(i,s){for(var c=i.suspendedLanes,h=i.pingedLanes,g=i.expirationTimes,x=i.pendingLanes&-62914561;0<x;){var R=31-Me(x),U=1<<R,re=g[R];re===-1?((U&c)===0||(U&h)!==0)&&(g[R]=Ts(U,s)):re<=s&&(i.expiredLanes|=U),x&=~U}if(s=lr,c=Lt,c=Un(i,i===s?c:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),h=i.callbackNode,c===0||i===s&&(Yt===2||Yt===9)||i.cancelPendingCommit!==null)return h!==null&&h!==null&&nt(h),i.callbackNode=null,i.callbackPriority=0;if((c&3)===0||Hi(i,c)){if(s=c&-c,s===i.callbackPriority)return s;switch(h!==null&&nt(h),As(c)){case 2:case 8:c=Mr;break;case 32:c=Xr;break;case 268435456:c=hn;break;default:c=Xr}return h=N2.bind(null,i),c=rt(c,h),i.callbackPriority=s,i.callbackNode=c,s}return h!==null&&h!==null&&nt(h),i.callbackPriority=2,i.callbackNode=null,2}function N2(i,s){if(pn!==0&&pn!==5)return i.callbackNode=null,i.callbackPriority=0,null;var c=i.callbackNode;if(Ih()&&i.callbackNode!==c)return null;var h=Lt;return h=Un(i,i===lr?h:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),h===0?null:(h2(i,h,s),R2(i,Ue()),i.callbackNode!=null&&i.callbackNode===c?N2.bind(null,i):null)}function I2(i,s){if(Ih())return null;h2(i,s,!0)}function r3(){h3(function(){(Kt&6)!==0?rt(Cr,t3):C2()})}function mg(){return sl===0&&(sl=bs()),sl}function D2(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:Gl(""+i)}function O2(i,s){var c=s.ownerDocument.createElement("input");return c.name=s.name,c.value=s.value,i.id&&c.setAttribute("form",i.id),s.parentNode.insertBefore(c,s),i=new FormData(i),c.parentNode.removeChild(c),i}function n3(i,s,c,h,g){if(s==="submit"&&c&&c.stateNode===g){var x=D2((g[mr]||null).action),R=h.submitter;R&&(s=(s=R[mr]||null)?D2(s.formAction):R.getAttribute("formAction"),s!==null&&(x=s,R=null));var U=new ql("action","action",null,h,g);i.push({event:U,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(sl!==0){var re=R?O2(g,R):new FormData(g);Fp(c,{pending:!0,data:re,method:g.method,action:x},null,re)}}else typeof x=="function"&&(U.preventDefault(),re=R?O2(g,R):new FormData(g),Fp(c,{pending:!0,data:re,method:g.method,action:x},x,re))},currentTarget:g}]})}}for(var pg=0;pg<Jm.length;pg++){var gg=Jm[pg],a3=gg.toLowerCase(),i3=gg[0].toUpperCase()+gg.slice(1);Ka(a3,"on"+i3)}Ka(h_,"onAnimationEnd"),Ka(d_,"onAnimationIteration"),Ka(m_,"onAnimationStart"),Ka("dblclick","onDoubleClick"),Ka("focusin","onFocus"),Ka("focusout","onBlur"),Ka(EC,"onTransitionRun"),Ka(TC,"onTransitionStart"),Ka(bC,"onTransitionCancel"),Ka(p_,"onTransitionEnd"),He("onMouseEnter",["mouseout","mouseover"]),He("onMouseLeave",["mouseout","mouseover"]),He("onPointerEnter",["pointerout","pointerover"]),He("onPointerLeave",["pointerout","pointerover"]),Le("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Le("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Le("onBeforeInput",["compositionend","keypress","textInput","paste"]),Le("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Le("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Le("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ju="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),s3=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ju));function F2(i,s){s=(s&4)!==0;for(var c=0;c<i.length;c++){var h=i[c],g=h.event;h=h.listeners;e:{var x=void 0;if(s)for(var R=h.length-1;0<=R;R--){var U=h[R],re=U.instance,pe=U.currentTarget;if(U=U.listener,re!==x&&g.isPropagationStopped())break e;x=U,g.currentTarget=pe;try{x(g)}catch(Ae){yh(Ae)}g.currentTarget=null,x=re}else for(R=0;R<h.length;R++){if(U=h[R],re=U.instance,pe=U.currentTarget,U=U.listener,re!==x&&g.isPropagationStopped())break e;x=U,g.currentTarget=pe;try{x(g)}catch(Ae){yh(Ae)}g.currentTarget=null,x=re}}}}function Rt(i,s){var c=s[Fo];c===void 0&&(c=s[Fo]=new Set);var h=i+"__bubble";c.has(h)||(P2(s,i,2,!1),c.add(h))}function xg(i,s,c){var h=0;s&&(h|=4),P2(c,i,h,s)}var Fh="_reactListening"+Math.random().toString(36).slice(2);function vg(i){if(!i[Fh]){i[Fh]=!0,xe.forEach(function(c){c!=="selectionchange"&&(s3.has(c)||xg(c,!1,i),xg(c,!0,i))});var s=i.nodeType===9?i:i.ownerDocument;s===null||s[Fh]||(s[Fh]=!0,xg("selectionchange",!1,s))}}function P2(i,s,c,h){switch(iw(s)){case 2:var g=O3;break;case 8:g=F3;break;default:g=Dg}c=g.bind(null,s,c,i),g=void 0,!Aa||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(g=!0),h?g!==void 0?i.addEventListener(s,c,{capture:!0,passive:g}):i.addEventListener(s,c,!0):g!==void 0?i.addEventListener(s,c,{passive:g}):i.addEventListener(s,c,!1)}function _g(i,s,c,h,g){var x=h;if((s&1)===0&&(s&2)===0&&h!==null)e:for(;;){if(h===null)return;var R=h.tag;if(R===3||R===4){var U=h.stateNode.containerInfo;if(U===g)break;if(R===4)for(R=h.return;R!==null;){var re=R.tag;if((re===3||re===4)&&R.stateNode.containerInfo===g)return;R=R.return}for(;U!==null;){if(R=Q(U),R===null)return;if(re=R.tag,re===5||re===6||re===26||re===27){h=x=R;continue e}U=U.parentNode}}h=h.return}L0(function(){var pe=x,Ae=Sa(c),Ie=[];e:{var _e=g_.get(i);if(_e!==void 0){var Ee=ql,ht=i;switch(i){case"keypress":if(di(c)===0)break e;case"keydown":case"keyup":Ee=Ql;break;case"focusin":ht="focus",Ee=Kl;break;case"focusout":ht="blur",Ee=Kl;break;case"beforeblur":case"afterblur":Ee=Kl;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ee=ka;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ee=qm;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ee=G0;break;case h_:case d_:case m_:Ee=Yl;break;case p_:Ee=W0;break;case"scroll":case"scrollend":Ee=M0;break;case"wheel":Ee=Zl;break;case"copy":case"cut":case"paste":Ee=$l;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ee=Tu;break;case"toggle":case"beforetoggle":Ee=K0}var it=(s&4)!==0,nr=!it&&(i==="scroll"||i==="scrollend"),oe=it?_e!==null?_e+"Capture":null:_e;it=[];for(var ae=pe,de;ae!==null;){var Ce=ae;if(de=Ce.stateNode,Ce=Ce.tag,Ce!==5&&Ce!==26&&Ce!==27||de===null||oe===null||(Ce=Bo(ae,oe),Ce!=null&&it.push(ef(ae,Ce,de))),nr)break;ae=ae.return}0<it.length&&(_e=new Ee(_e,ht,null,c,Ae),Ie.push({event:_e,listeners:it}))}}if((s&7)===0){e:{if(_e=i==="mouseover"||i==="pointerover",Ee=i==="mouseout"||i==="pointerout",_e&&c!==Gi&&(ht=c.relatedTarget||c.fromElement)&&(Q(ht)||ht[Yn]))break e;if((Ee||_e)&&(_e=Ae.window===Ae?Ae:(_e=Ae.ownerDocument)?_e.defaultView||_e.parentWindow:window,Ee?(ht=c.relatedTarget||c.toElement,Ee=pe,ht=ht?Q(ht):null,ht!==null&&(nr=o(ht),it=ht.tag,ht!==nr||it!==5&&it!==27&&it!==6)&&(ht=null)):(Ee=null,ht=pe),Ee!==ht)){if(it=ka,Ce="onMouseLeave",oe="onMouseEnter",ae="mouse",(i==="pointerout"||i==="pointerover")&&(it=Tu,Ce="onPointerLeave",oe="onPointerEnter",ae="pointer"),nr=Ee==null?_e:me(Ee),de=ht==null?_e:me(ht),_e=new it(Ce,ae+"leave",Ee,c,Ae),_e.target=nr,_e.relatedTarget=de,Ce=null,Q(Ae)===pe&&(it=new it(oe,ae+"enter",ht,c,Ae),it.target=de,it.relatedTarget=nr,Ce=it),nr=Ce,Ee&&ht)t:{for(it=Ee,oe=ht,ae=0,de=it;de;de=Tc(de))ae++;for(de=0,Ce=oe;Ce;Ce=Tc(Ce))de++;for(;0<ae-de;)it=Tc(it),ae--;for(;0<de-ae;)oe=Tc(oe),de--;for(;ae--;){if(it===oe||oe!==null&&it===oe.alternate)break t;it=Tc(it),oe=Tc(oe)}it=null}else it=null;Ee!==null&&L2(Ie,_e,Ee,it,!1),ht!==null&&nr!==null&&L2(Ie,nr,ht,it,!0)}}e:{if(_e=pe?me(pe):window,Ee=_e.nodeName&&_e.nodeName.toLowerCase(),Ee==="select"||Ee==="input"&&_e.type==="file")var Qe=t_;else if(Yr(_e))if(r_)Qe=_C;else{Qe=xC;var St=gC}else Ee=_e.nodeName,!Ee||Ee.toLowerCase()!=="input"||_e.type!=="checkbox"&&_e.type!=="radio"?pe&&gu(pe.elementType)&&(Qe=t_):Qe=vC;if(Qe&&(Qe=Qe(i,pe))){Yi(Ie,Qe,c,Ae);break e}St&&St(i,_e,pe),i==="focusout"&&pe&&_e.type==="number"&&pe.memoizedProps.value!=null&&ks(_e,"number",_e.value)}switch(St=pe?me(pe):window,i){case"focusin":(Yr(St)||St.contentEditable==="true")&&(Jl=St,$m=pe,Au=null);break;case"focusout":Au=$m=Jl=null;break;case"mousedown":Qm=!0;break;case"contextmenu":case"mouseup":case"dragend":Qm=!1,u_(Ie,c,Ae);break;case"selectionchange":if(wC)break;case"keydown":case"keyup":u_(Ie,c,Ae)}var Ze;if(gi)e:{switch(i){case"compositionstart":var st="onCompositionStart";break e;case"compositionend":st="onCompositionEnd";break e;case"compositionupdate":st="onCompositionUpdate";break e}st=void 0}else Ft?be(i,c)&&(st="onCompositionEnd"):i==="keydown"&&c.keyCode===229&&(st="onCompositionStart");st&&(C&&c.locale!=="ko"&&(Ft||st!=="onCompositionStart"?st==="onCompositionEnd"&&Ft&&(Ze=vu()):(hi=Ae,Cs="value"in hi?hi.value:hi.textContent,Ft=!0)),St=Ph(pe,st),0<St.length&&(st=new wu(st,i,null,c,Ae),Ie.push({event:st,listeners:St}),Ze?st.data=Ze:(Ze=Ge(c),Ze!==null&&(st.data=Ze)))),(Ze=T?Kr(i,c):Pt(i,c))&&(st=Ph(pe,"onBeforeInput"),0<st.length&&(St=new wu("onBeforeInput","beforeinput",null,c,Ae),Ie.push({event:St,listeners:st}),St.data=Ze)),n3(Ie,i,pe,c,Ae)}F2(Ie,s)})}function ef(i,s,c){return{instance:i,listener:s,currentTarget:c}}function Ph(i,s){for(var c=s+"Capture",h=[];i!==null;){var g=i,x=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||x===null||(g=Bo(i,c),g!=null&&h.unshift(ef(i,g,x)),g=Bo(i,s),g!=null&&h.push(ef(i,g,x))),i.tag===3)return h;i=i.return}return[]}function Tc(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function L2(i,s,c,h,g){for(var x=s._reactName,R=[];c!==null&&c!==h;){var U=c,re=U.alternate,pe=U.stateNode;if(U=U.tag,re!==null&&re===h)break;U!==5&&U!==26&&U!==27||pe===null||(re=pe,g?(pe=Bo(c,x),pe!=null&&R.unshift(ef(c,pe,re))):g||(pe=Bo(c,x),pe!=null&&R.push(ef(c,pe,re)))),c=c.return}R.length!==0&&i.push({event:s,listeners:R})}var o3=/\r\n?/g,l3=/\u0000|\uFFFD/g;function M2(i){return(typeof i=="string"?i:""+i).replace(o3,`
`).replace(l3,"")}function U2(i,s){return s=M2(s),M2(i)===s}function Lh(){}function rr(i,s,c,h,g,x){switch(c){case"children":typeof h=="string"?s==="body"||s==="textarea"&&h===""||ba(i,h):(typeof h=="number"||typeof h=="bigint")&&s!=="body"&&ba(i,""+h);break;case"className":Dt(i,"class",h);break;case"tabIndex":Dt(i,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":Dt(i,c,h);break;case"style":pu(i,h,x);break;case"data":if(s!=="object"){Dt(i,"data",h);break}case"src":case"href":if(h===""&&(s!=="a"||c!=="href")){i.removeAttribute(c);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){i.removeAttribute(c);break}h=Gl(""+h),i.setAttribute(c,h);break;case"action":case"formAction":if(typeof h=="function"){i.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof x=="function"&&(c==="formAction"?(s!=="input"&&rr(i,s,"name",g.name,g,null),rr(i,s,"formEncType",g.formEncType,g,null),rr(i,s,"formMethod",g.formMethod,g,null),rr(i,s,"formTarget",g.formTarget,g,null)):(rr(i,s,"encType",g.encType,g,null),rr(i,s,"method",g.method,g,null),rr(i,s,"target",g.target,g,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){i.removeAttribute(c);break}h=Gl(""+h),i.setAttribute(c,h);break;case"onClick":h!=null&&(i.onclick=Lh);break;case"onScroll":h!=null&&Rt("scroll",i);break;case"onScrollEnd":h!=null&&Rt("scrollend",i);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(n(61));if(c=h.__html,c!=null){if(g.children!=null)throw Error(n(60));i.innerHTML=c}}break;case"multiple":i.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":i.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){i.removeAttribute("xlink:href");break}c=Gl(""+h),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?i.setAttribute(c,""+h):i.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?i.setAttribute(c,""):i.removeAttribute(c);break;case"capture":case"download":h===!0?i.setAttribute(c,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?i.setAttribute(c,h):i.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?i.setAttribute(c,h):i.removeAttribute(c);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?i.removeAttribute(c):i.setAttribute(c,h);break;case"popover":Rt("beforetoggle",i),Rt("toggle",i),jt(i,"popover",h);break;case"xlinkActuate":Ot(i,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":Ot(i,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":Ot(i,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":Ot(i,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":Ot(i,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":Ot(i,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":Ot(i,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":Ot(i,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":Ot(i,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":jt(i,"is",h);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=zm.get(c)||c,jt(i,c,h))}}function yg(i,s,c,h,g,x){switch(c){case"style":pu(i,h,x);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(n(61));if(c=h.__html,c!=null){if(g.children!=null)throw Error(n(60));i.innerHTML=c}}break;case"children":typeof h=="string"?ba(i,h):(typeof h=="number"||typeof h=="bigint")&&ba(i,""+h);break;case"onScroll":h!=null&&Rt("scroll",i);break;case"onScrollEnd":h!=null&&Rt("scrollend",i);break;case"onClick":h!=null&&(i.onclick=Lh);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ve.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(g=c.endsWith("Capture"),s=c.slice(2,g?c.length-7:void 0),x=i[mr]||null,x=x!=null?x[c]:null,typeof x=="function"&&i.removeEventListener(s,x,g),typeof h=="function")){typeof x!="function"&&x!==null&&(c in i?i[c]=null:i.hasAttribute(c)&&i.removeAttribute(c)),i.addEventListener(s,h,g);break e}c in i?i[c]=h:h===!0?i.setAttribute(c,""):jt(i,c,h)}}}function gn(i,s,c){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Rt("error",i),Rt("load",i);var h=!1,g=!1,x;for(x in c)if(c.hasOwnProperty(x)){var R=c[x];if(R!=null)switch(x){case"src":h=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,s));default:rr(i,s,x,R,c,null)}}g&&rr(i,s,"srcSet",c.srcSet,c,null),h&&rr(i,s,"src",c.src,c,null);return;case"input":Rt("invalid",i);var U=x=R=g=null,re=null,pe=null;for(h in c)if(c.hasOwnProperty(h)){var Ae=c[h];if(Ae!=null)switch(h){case"name":g=Ae;break;case"type":R=Ae;break;case"checked":re=Ae;break;case"defaultChecked":pe=Ae;break;case"value":x=Ae;break;case"defaultValue":U=Ae;break;case"children":case"dangerouslySetInnerHTML":if(Ae!=null)throw Error(n(137,s));break;default:rr(i,s,h,Ae,c,null)}}Lo(i,x,U,re,pe,R,g,!1),zl(i);return;case"select":Rt("invalid",i),h=R=x=null;for(g in c)if(c.hasOwnProperty(g)&&(U=c[g],U!=null))switch(g){case"value":x=U;break;case"defaultValue":R=U;break;case"multiple":h=U;default:rr(i,s,g,U,c,null)}s=x,c=R,i.multiple=!!h,s!=null?zi(i,!!h,s,!1):c!=null&&zi(i,!!h,c,!0);return;case"textarea":Rt("invalid",i),x=g=h=null;for(R in c)if(c.hasOwnProperty(R)&&(U=c[R],U!=null))switch(R){case"value":h=U;break;case"defaultValue":g=U;break;case"children":x=U;break;case"dangerouslySetInnerHTML":if(U!=null)throw Error(n(91));break;default:rr(i,s,R,U,c,null)}Mo(i,h,g,x),zl(i);return;case"option":for(re in c)if(c.hasOwnProperty(re)&&(h=c[re],h!=null))switch(re){case"selected":i.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:rr(i,s,re,h,c,null)}return;case"dialog":Rt("beforetoggle",i),Rt("toggle",i),Rt("cancel",i),Rt("close",i);break;case"iframe":case"object":Rt("load",i);break;case"video":case"audio":for(h=0;h<Ju.length;h++)Rt(Ju[h],i);break;case"image":Rt("error",i),Rt("load",i);break;case"details":Rt("toggle",i);break;case"embed":case"source":case"link":Rt("error",i),Rt("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(pe in c)if(c.hasOwnProperty(pe)&&(h=c[pe],h!=null))switch(pe){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,s));default:rr(i,s,pe,h,c,null)}return;default:if(gu(s)){for(Ae in c)c.hasOwnProperty(Ae)&&(h=c[Ae],h!==void 0&&yg(i,s,Ae,h,c,void 0));return}}for(U in c)c.hasOwnProperty(U)&&(h=c[U],h!=null&&rr(i,s,U,h,c,null))}function c3(i,s,c,h){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,x=null,R=null,U=null,re=null,pe=null,Ae=null;for(Ee in c){var Ie=c[Ee];if(c.hasOwnProperty(Ee)&&Ie!=null)switch(Ee){case"checked":break;case"value":break;case"defaultValue":re=Ie;default:h.hasOwnProperty(Ee)||rr(i,s,Ee,null,h,Ie)}}for(var _e in h){var Ee=h[_e];if(Ie=c[_e],h.hasOwnProperty(_e)&&(Ee!=null||Ie!=null))switch(_e){case"type":x=Ee;break;case"name":g=Ee;break;case"checked":pe=Ee;break;case"defaultChecked":Ae=Ee;break;case"value":R=Ee;break;case"defaultValue":U=Ee;break;case"children":case"dangerouslySetInnerHTML":if(Ee!=null)throw Error(n(137,s));break;default:Ee!==Ie&&rr(i,s,_e,Ee,h,Ie)}}sa(i,R,U,re,pe,Ae,x,g);return;case"select":Ee=R=U=_e=null;for(x in c)if(re=c[x],c.hasOwnProperty(x)&&re!=null)switch(x){case"value":break;case"multiple":Ee=re;default:h.hasOwnProperty(x)||rr(i,s,x,null,h,re)}for(g in h)if(x=h[g],re=c[g],h.hasOwnProperty(g)&&(x!=null||re!=null))switch(g){case"value":_e=x;break;case"defaultValue":U=x;break;case"multiple":R=x;default:x!==re&&rr(i,s,g,x,h,re)}s=U,c=R,h=Ee,_e!=null?zi(i,!!c,_e,!1):!!h!=!!c&&(s!=null?zi(i,!!c,s,!0):zi(i,!!c,c?[]:"",!1));return;case"textarea":Ee=_e=null;for(U in c)if(g=c[U],c.hasOwnProperty(U)&&g!=null&&!h.hasOwnProperty(U))switch(U){case"value":break;case"children":break;default:rr(i,s,U,null,h,g)}for(R in h)if(g=h[R],x=c[R],h.hasOwnProperty(R)&&(g!=null||x!=null))switch(R){case"value":_e=g;break;case"defaultValue":Ee=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(n(91));break;default:g!==x&&rr(i,s,R,g,h,x)}er(i,_e,Ee);return;case"option":for(var ht in c)if(_e=c[ht],c.hasOwnProperty(ht)&&_e!=null&&!h.hasOwnProperty(ht))switch(ht){case"selected":i.selected=!1;break;default:rr(i,s,ht,null,h,_e)}for(re in h)if(_e=h[re],Ee=c[re],h.hasOwnProperty(re)&&_e!==Ee&&(_e!=null||Ee!=null))switch(re){case"selected":i.selected=_e&&typeof _e!="function"&&typeof _e!="symbol";break;default:rr(i,s,re,_e,h,Ee)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var it in c)_e=c[it],c.hasOwnProperty(it)&&_e!=null&&!h.hasOwnProperty(it)&&rr(i,s,it,null,h,_e);for(pe in h)if(_e=h[pe],Ee=c[pe],h.hasOwnProperty(pe)&&_e!==Ee&&(_e!=null||Ee!=null))switch(pe){case"children":case"dangerouslySetInnerHTML":if(_e!=null)throw Error(n(137,s));break;default:rr(i,s,pe,_e,h,Ee)}return;default:if(gu(s)){for(var nr in c)_e=c[nr],c.hasOwnProperty(nr)&&_e!==void 0&&!h.hasOwnProperty(nr)&&yg(i,s,nr,void 0,h,_e);for(Ae in h)_e=h[Ae],Ee=c[Ae],!h.hasOwnProperty(Ae)||_e===Ee||_e===void 0&&Ee===void 0||yg(i,s,Ae,_e,h,Ee);return}}for(var oe in c)_e=c[oe],c.hasOwnProperty(oe)&&_e!=null&&!h.hasOwnProperty(oe)&&rr(i,s,oe,null,h,_e);for(Ie in h)_e=h[Ie],Ee=c[Ie],!h.hasOwnProperty(Ie)||_e===Ee||_e==null&&Ee==null||rr(i,s,Ie,_e,h,Ee)}var wg=null,Eg=null;function Mh(i){return i.nodeType===9?i:i.ownerDocument}function B2(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function V2(i,s){if(i===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&s==="foreignObject"?0:i}function Tg(i,s){return i==="textarea"||i==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var bg=null;function u3(){var i=window.event;return i&&i.type==="popstate"?i===bg?!1:(bg=i,!0):(bg=null,!1)}var j2=typeof setTimeout=="function"?setTimeout:void 0,f3=typeof clearTimeout=="function"?clearTimeout:void 0,H2=typeof Promise=="function"?Promise:void 0,h3=typeof queueMicrotask=="function"?queueMicrotask:typeof H2<"u"?function(i){return H2.resolve(null).then(i).catch(d3)}:j2;function d3(i){setTimeout(function(){throw i})}function Gs(i){return i==="head"}function z2(i,s){var c=s,h=0,g=0;do{var x=c.nextSibling;if(i.removeChild(c),x&&x.nodeType===8)if(c=x.data,c==="/$"){if(0<h&&8>h){c=h;var R=i.ownerDocument;if(c&1&&tf(R.documentElement),c&2&&tf(R.body),c&4)for(c=R.head,tf(c),R=c.firstChild;R;){var U=R.nextSibling,re=R.nodeName;R[H]||re==="SCRIPT"||re==="STYLE"||re==="LINK"&&R.rel.toLowerCase()==="stylesheet"||c.removeChild(R),R=U}}if(g===0){i.removeChild(x),uf(s);return}g--}else c==="$"||c==="$?"||c==="$!"?g++:h=c.charCodeAt(0)-48;else h=0;c=x}while(c);uf(s)}function Sg(i){var s=i.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var c=s;switch(s=s.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":Sg(c),G(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}i.removeChild(c)}}function m3(i,s,c,h){for(;i.nodeType===1;){var g=c;if(i.nodeName.toLowerCase()!==s.toLowerCase()){if(!h&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(h){if(!i[H])switch(s){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(x=i.getAttribute("rel"),x==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(x!==g.rel||i.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||i.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||i.getAttribute("title")!==(g.title==null?null:g.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(x=i.getAttribute("src"),(x!==(g.src==null?null:g.src)||i.getAttribute("type")!==(g.type==null?null:g.type)||i.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&x&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(s==="input"&&i.type==="hidden"){var x=g.name==null?null:""+g.name;if(g.type==="hidden"&&i.getAttribute("name")===x)return i}else return i;if(i=$a(i.nextSibling),i===null)break}return null}function p3(i,s,c){if(s==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!c||(i=$a(i.nextSibling),i===null))return null;return i}function Ag(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState==="complete"}function g3(i,s){var c=i.ownerDocument;if(i.data!=="$?"||c.readyState==="complete")s();else{var h=function(){s(),c.removeEventListener("DOMContentLoaded",h)};c.addEventListener("DOMContentLoaded",h),i._reactRetry=h}}function $a(i){for(;i!=null;i=i.nextSibling){var s=i.nodeType;if(s===1||s===3)break;if(s===8){if(s=i.data,s==="$"||s==="$!"||s==="$?"||s==="F!"||s==="F")break;if(s==="/$")return null}}return i}var kg=null;function G2(i){i=i.previousSibling;for(var s=0;i;){if(i.nodeType===8){var c=i.data;if(c==="$"||c==="$!"||c==="$?"){if(s===0)return i;s--}else c==="/$"&&s++}i=i.previousSibling}return null}function q2(i,s,c){switch(s=Mh(c),i){case"html":if(i=s.documentElement,!i)throw Error(n(452));return i;case"head":if(i=s.head,!i)throw Error(n(453));return i;case"body":if(i=s.body,!i)throw Error(n(454));return i;default:throw Error(n(451))}}function tf(i){for(var s=i.attributes;s.length;)i.removeAttributeNode(s[0]);G(i)}var Fa=new Map,W2=new Set;function Uh(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var ls=ue.d;ue.d={f:x3,r:v3,D:_3,C:y3,L:w3,m:E3,X:b3,S:T3,M:S3};function x3(){var i=ls.f(),s=Rh();return i||s}function v3(i){var s=J(i);s!==null&&s.tag===5&&s.type==="form"?hy(s):ls.r(i)}var bc=typeof document>"u"?null:document;function X2(i,s,c){var h=bc;if(h&&typeof s=="string"&&s){var g=Ur(s);g='link[rel="'+i+'"][href="'+g+'"]',typeof c=="string"&&(g+='[crossorigin="'+c+'"]'),W2.has(g)||(W2.add(g),i={rel:i,crossOrigin:c,href:s},h.querySelector(g)===null&&(s=h.createElement("link"),gn(s,"link",i),le(s),h.head.appendChild(s)))}}function _3(i){ls.D(i),X2("dns-prefetch",i,null)}function y3(i,s){ls.C(i,s),X2("preconnect",i,s)}function w3(i,s,c){ls.L(i,s,c);var h=bc;if(h&&i&&s){var g='link[rel="preload"][as="'+Ur(s)+'"]';s==="image"&&c&&c.imageSrcSet?(g+='[imagesrcset="'+Ur(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(g+='[imagesizes="'+Ur(c.imageSizes)+'"]')):g+='[href="'+Ur(i)+'"]';var x=g;switch(s){case"style":x=Sc(i);break;case"script":x=Ac(i)}Fa.has(x)||(i=m({rel:"preload",href:s==="image"&&c&&c.imageSrcSet?void 0:i,as:s},c),Fa.set(x,i),h.querySelector(g)!==null||s==="style"&&h.querySelector(rf(x))||s==="script"&&h.querySelector(nf(x))||(s=h.createElement("link"),gn(s,"link",i),le(s),h.head.appendChild(s)))}}function E3(i,s){ls.m(i,s);var c=bc;if(c&&i){var h=s&&typeof s.as=="string"?s.as:"script",g='link[rel="modulepreload"][as="'+Ur(h)+'"][href="'+Ur(i)+'"]',x=g;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":x=Ac(i)}if(!Fa.has(x)&&(i=m({rel:"modulepreload",href:i},s),Fa.set(x,i),c.querySelector(g)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(nf(x)))return}h=c.createElement("link"),gn(h,"link",i),le(h),c.head.appendChild(h)}}}function T3(i,s,c){ls.S(i,s,c);var h=bc;if(h&&i){var g=Te(h).hoistableStyles,x=Sc(i);s=s||"default";var R=g.get(x);if(!R){var U={loading:0,preload:null};if(R=h.querySelector(rf(x)))U.loading=5;else{i=m({rel:"stylesheet",href:i,"data-precedence":s},c),(c=Fa.get(x))&&Cg(i,c);var re=R=h.createElement("link");le(re),gn(re,"link",i),re._p=new Promise(function(pe,Ae){re.onload=pe,re.onerror=Ae}),re.addEventListener("load",function(){U.loading|=1}),re.addEventListener("error",function(){U.loading|=2}),U.loading|=4,Bh(R,s,h)}R={type:"stylesheet",instance:R,count:1,state:U},g.set(x,R)}}}function b3(i,s){ls.X(i,s);var c=bc;if(c&&i){var h=Te(c).hoistableScripts,g=Ac(i),x=h.get(g);x||(x=c.querySelector(nf(g)),x||(i=m({src:i,async:!0},s),(s=Fa.get(g))&&Rg(i,s),x=c.createElement("script"),le(x),gn(x,"link",i),c.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},h.set(g,x))}}function S3(i,s){ls.M(i,s);var c=bc;if(c&&i){var h=Te(c).hoistableScripts,g=Ac(i),x=h.get(g);x||(x=c.querySelector(nf(g)),x||(i=m({src:i,async:!0,type:"module"},s),(s=Fa.get(g))&&Rg(i,s),x=c.createElement("script"),le(x),gn(x,"link",i),c.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},h.set(g,x))}}function K2(i,s,c,h){var g=(g=ce.current)?Uh(g):null;if(!g)throw Error(n(446));switch(i){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(s=Sc(c.href),c=Te(g).hoistableStyles,h=c.get(s),h||(h={type:"style",instance:null,count:0,state:null},c.set(s,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){i=Sc(c.href);var x=Te(g).hoistableStyles,R=x.get(i);if(R||(g=g.ownerDocument||g,R={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},x.set(i,R),(x=g.querySelector(rf(i)))&&!x._p&&(R.instance=x,R.state.loading=5),Fa.has(i)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},Fa.set(i,c),x||A3(g,i,c,R.state))),s&&h===null)throw Error(n(528,""));return R}if(s&&h!==null)throw Error(n(529,""));return null;case"script":return s=c.async,c=c.src,typeof c=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=Ac(c),c=Te(g).hoistableScripts,h=c.get(s),h||(h={type:"script",instance:null,count:0,state:null},c.set(s,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,i))}}function Sc(i){return'href="'+Ur(i)+'"'}function rf(i){return'link[rel="stylesheet"]['+i+"]"}function Y2(i){return m({},i,{"data-precedence":i.precedence,precedence:null})}function A3(i,s,c,h){i.querySelector('link[rel="preload"][as="style"]['+s+"]")?h.loading=1:(s=i.createElement("link"),h.preload=s,s.addEventListener("load",function(){return h.loading|=1}),s.addEventListener("error",function(){return h.loading|=2}),gn(s,"link",c),le(s),i.head.appendChild(s))}function Ac(i){return'[src="'+Ur(i)+'"]'}function nf(i){return"script[async]"+i}function $2(i,s,c){if(s.count++,s.instance===null)switch(s.type){case"style":var h=i.querySelector('style[data-href~="'+Ur(c.href)+'"]');if(h)return s.instance=h,le(h),h;var g=m({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return h=(i.ownerDocument||i).createElement("style"),le(h),gn(h,"style",g),Bh(h,c.precedence,i),s.instance=h;case"stylesheet":g=Sc(c.href);var x=i.querySelector(rf(g));if(x)return s.state.loading|=4,s.instance=x,le(x),x;h=Y2(c),(g=Fa.get(g))&&Cg(h,g),x=(i.ownerDocument||i).createElement("link"),le(x);var R=x;return R._p=new Promise(function(U,re){R.onload=U,R.onerror=re}),gn(x,"link",h),s.state.loading|=4,Bh(x,c.precedence,i),s.instance=x;case"script":return x=Ac(c.src),(g=i.querySelector(nf(x)))?(s.instance=g,le(g),g):(h=c,(g=Fa.get(x))&&(h=m({},c),Rg(h,g)),i=i.ownerDocument||i,g=i.createElement("script"),le(g),gn(g,"link",h),i.head.appendChild(g),s.instance=g);case"void":return null;default:throw Error(n(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(h=s.instance,s.state.loading|=4,Bh(h,c.precedence,i));return s.instance}function Bh(i,s,c){for(var h=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=h.length?h[h.length-1]:null,x=g,R=0;R<h.length;R++){var U=h[R];if(U.dataset.precedence===s)x=U;else if(x!==g)break}x?x.parentNode.insertBefore(i,x.nextSibling):(s=c.nodeType===9?c.head:c,s.insertBefore(i,s.firstChild))}function Cg(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.title==null&&(i.title=s.title)}function Rg(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.integrity==null&&(i.integrity=s.integrity)}var Vh=null;function Q2(i,s,c){if(Vh===null){var h=new Map,g=Vh=new Map;g.set(c,h)}else g=Vh,h=g.get(c),h||(h=new Map,g.set(c,h));if(h.has(i))return h;for(h.set(i,null),c=c.getElementsByTagName(i),g=0;g<c.length;g++){var x=c[g];if(!(x[H]||x[Nr]||i==="link"&&x.getAttribute("rel")==="stylesheet")&&x.namespaceURI!=="http://www.w3.org/2000/svg"){var R=x.getAttribute(s)||"";R=i+R;var U=h.get(R);U?U.push(x):h.set(R,[x])}}return h}function Z2(i,s,c){i=i.ownerDocument||i,i.head.insertBefore(c,s==="title"?i.querySelector("head > title"):null)}function k3(i,s,c){if(c===1||s.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;switch(s.rel){case"stylesheet":return i=s.disabled,typeof s.precedence=="string"&&i==null;default:return!0}case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function J2(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}var af=null;function C3(){}function R3(i,s,c){if(af===null)throw Error(n(475));var h=af;if(s.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(s.state.loading&4)===0){if(s.instance===null){var g=Sc(c.href),x=i.querySelector(rf(g));if(x){i=x._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(h.count++,h=jh.bind(h),i.then(h,h)),s.state.loading|=4,s.instance=x,le(x);return}x=i.ownerDocument||i,c=Y2(c),(g=Fa.get(g))&&Cg(c,g),x=x.createElement("link"),le(x);var R=x;R._p=new Promise(function(U,re){R.onload=U,R.onerror=re}),gn(x,"link",c),s.instance=x}h.stylesheets===null&&(h.stylesheets=new Map),h.stylesheets.set(s,i),(i=s.state.preload)&&(s.state.loading&3)===0&&(h.count++,s=jh.bind(h),i.addEventListener("load",s),i.addEventListener("error",s))}}function N3(){if(af===null)throw Error(n(475));var i=af;return i.stylesheets&&i.count===0&&Ng(i,i.stylesheets),0<i.count?function(s){var c=setTimeout(function(){if(i.stylesheets&&Ng(i,i.stylesheets),i.unsuspend){var h=i.unsuspend;i.unsuspend=null,h()}},6e4);return i.unsuspend=s,function(){i.unsuspend=null,clearTimeout(c)}}:null}function jh(){if(this.count--,this.count===0){if(this.stylesheets)Ng(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var Hh=null;function Ng(i,s){i.stylesheets=null,i.unsuspend!==null&&(i.count++,Hh=new Map,s.forEach(I3,i),Hh=null,jh.call(i))}function I3(i,s){if(!(s.state.loading&4)){var c=Hh.get(i);if(c)var h=c.get(null);else{c=new Map,Hh.set(i,c);for(var g=i.querySelectorAll("link[data-precedence],style[data-precedence]"),x=0;x<g.length;x++){var R=g[x];(R.nodeName==="LINK"||R.getAttribute("media")!=="not all")&&(c.set(R.dataset.precedence,R),h=R)}h&&c.set(null,h)}g=s.instance,R=g.getAttribute("data-precedence"),x=c.get(R)||h,x===h&&c.set(null,g),c.set(R,g),this.count++,h=jh.bind(this),g.addEventListener("load",h),g.addEventListener("error",h),x?x.parentNode.insertBefore(g,x.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(g,i.firstChild)),s.state.loading|=4}}var sf={$$typeof:F,Provider:null,Consumer:null,_currentValue:Ve,_currentValue2:Ve,_threadCount:0};function D3(i,s,c,h,g,x,R,U){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=qa(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=qa(0),this.hiddenUpdates=qa(null),this.identifierPrefix=h,this.onUncaughtError=g,this.onCaughtError=x,this.onRecoverableError=R,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=U,this.incompleteTransitions=new Map}function ew(i,s,c,h,g,x,R,U,re,pe,Ae,Ie){return i=new D3(i,s,c,R,U,re,pe,Ie),s=1,x===!0&&(s|=24),x=la(3,null,null,s),i.current=x,x.stateNode=i,s=fp(),s.refCount++,i.pooledCache=s,s.refCount++,x.memoizedState={element:h,isDehydrated:c,cache:s},pp(x),i}function tw(i){return i?(i=nc,i):nc}function rw(i,s,c,h,g,x){g=tw(g),h.context===null?h.context=g:h.pendingContext=g,h=Is(s),h.payload={element:c},x=x===void 0?null:x,x!==null&&(h.callback=x),c=Ds(i,h,s),c!==null&&(da(c,i,s),Pu(c,i,s))}function nw(i,s){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var c=i.retryLane;i.retryLane=c!==0&&c<s?c:s}}function Ig(i,s){nw(i,s),(i=i.alternate)&&nw(i,s)}function aw(i){if(i.tag===13){var s=rc(i,67108864);s!==null&&da(s,i,67108864),Ig(i,67108864)}}var zh=!0;function O3(i,s,c,h){var g=ne.T;ne.T=null;var x=ue.p;try{ue.p=2,Dg(i,s,c,h)}finally{ue.p=x,ne.T=g}}function F3(i,s,c,h){var g=ne.T;ne.T=null;var x=ue.p;try{ue.p=8,Dg(i,s,c,h)}finally{ue.p=x,ne.T=g}}function Dg(i,s,c,h){if(zh){var g=Og(h);if(g===null)_g(i,s,h,Gh,c),sw(i,h);else if(L3(g,i,s,c,h))h.stopPropagation();else if(sw(i,h),s&4&&-1<P3.indexOf(i)){for(;g!==null;){var x=J(g);if(x!==null)switch(x.tag){case 3:if(x=x.stateNode,x.current.memoizedState.isDehydrated){var R=qt(x.pendingLanes);if(R!==0){var U=x;for(U.pendingLanes|=2,U.entangledLanes|=2;R;){var re=1<<31-Me(R);U.entanglements[1]|=re,R&=~re}Ei(x),(Kt&6)===0&&(kh=Ue()+500,Zu(0))}}break;case 13:U=rc(x,2),U!==null&&da(U,x,2),Rh(),Ig(x,2)}if(x=Og(h),x===null&&_g(i,s,h,Gh,c),x===g)break;g=x}g!==null&&h.stopPropagation()}else _g(i,s,h,null,c)}}function Og(i){return i=Sa(i),Fg(i)}var Gh=null;function Fg(i){if(Gh=null,i=Q(i),i!==null){var s=o(i);if(s===null)i=null;else{var c=s.tag;if(c===13){if(i=l(s),i!==null)return i;i=null}else if(c===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;i=null}else s!==i&&(i=null)}}return Gh=i,null}function iw(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Jt()){case Cr:return 2;case Mr:return 8;case Xr:case Ga:return 32;case hn:return 268435456;default:return 32}default:return 32}}var Pg=!1,qs=null,Ws=null,Xs=null,of=new Map,lf=new Map,Ks=[],P3="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function sw(i,s){switch(i){case"focusin":case"focusout":qs=null;break;case"dragenter":case"dragleave":Ws=null;break;case"mouseover":case"mouseout":Xs=null;break;case"pointerover":case"pointerout":of.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":lf.delete(s.pointerId)}}function cf(i,s,c,h,g,x){return i===null||i.nativeEvent!==x?(i={blockedOn:s,domEventName:c,eventSystemFlags:h,nativeEvent:x,targetContainers:[g]},s!==null&&(s=J(s),s!==null&&aw(s)),i):(i.eventSystemFlags|=h,s=i.targetContainers,g!==null&&s.indexOf(g)===-1&&s.push(g),i)}function L3(i,s,c,h,g){switch(s){case"focusin":return qs=cf(qs,i,s,c,h,g),!0;case"dragenter":return Ws=cf(Ws,i,s,c,h,g),!0;case"mouseover":return Xs=cf(Xs,i,s,c,h,g),!0;case"pointerover":var x=g.pointerId;return of.set(x,cf(of.get(x)||null,i,s,c,h,g)),!0;case"gotpointercapture":return x=g.pointerId,lf.set(x,cf(lf.get(x)||null,i,s,c,h,g)),!0}return!1}function ow(i){var s=Q(i.target);if(s!==null){var c=o(s);if(c!==null){if(s=c.tag,s===13){if(s=l(c),s!==null){i.blockedOn=s,jl(i.priority,function(){if(c.tag===13){var h=ha();h=oi(h);var g=rc(c,h);g!==null&&da(g,c,h),Ig(c,h)}});return}}else if(s===3&&c.stateNode.current.memoizedState.isDehydrated){i.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}i.blockedOn=null}function qh(i){if(i.blockedOn!==null)return!1;for(var s=i.targetContainers;0<s.length;){var c=Og(i.nativeEvent);if(c===null){c=i.nativeEvent;var h=new c.constructor(c.type,c);Gi=h,c.target.dispatchEvent(h),Gi=null}else return s=J(c),s!==null&&aw(s),i.blockedOn=c,!1;s.shift()}return!0}function lw(i,s,c){qh(i)&&c.delete(s)}function M3(){Pg=!1,qs!==null&&qh(qs)&&(qs=null),Ws!==null&&qh(Ws)&&(Ws=null),Xs!==null&&qh(Xs)&&(Xs=null),of.forEach(lw),lf.forEach(lw)}function Wh(i,s){i.blockedOn===s&&(i.blockedOn=null,Pg||(Pg=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,M3)))}var Xh=null;function cw(i){Xh!==i&&(Xh=i,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){Xh===i&&(Xh=null);for(var s=0;s<i.length;s+=3){var c=i[s],h=i[s+1],g=i[s+2];if(typeof h!="function"){if(Fg(h||c)===null)continue;break}var x=J(c);x!==null&&(i.splice(s,3),s-=3,Fp(x,{pending:!0,data:g,method:c.method,action:h},h,g))}}))}function uf(i){function s(re){return Wh(re,i)}qs!==null&&Wh(qs,i),Ws!==null&&Wh(Ws,i),Xs!==null&&Wh(Xs,i),of.forEach(s),lf.forEach(s);for(var c=0;c<Ks.length;c++){var h=Ks[c];h.blockedOn===i&&(h.blockedOn=null)}for(;0<Ks.length&&(c=Ks[0],c.blockedOn===null);)ow(c),c.blockedOn===null&&Ks.shift();if(c=(i.ownerDocument||i).$$reactFormReplay,c!=null)for(h=0;h<c.length;h+=3){var g=c[h],x=c[h+1],R=g[mr]||null;if(typeof x=="function")R||cw(c);else if(R){var U=null;if(x&&x.hasAttribute("formAction")){if(g=x,R=x[mr]||null)U=R.formAction;else if(Fg(g)!==null)continue}else U=R.action;typeof U=="function"?c[h+1]=U:(c.splice(h,3),h-=3),cw(c)}}}function Lg(i){this._internalRoot=i}Kh.prototype.render=Lg.prototype.render=function(i){var s=this._internalRoot;if(s===null)throw Error(n(409));var c=s.current,h=ha();rw(c,h,i,s,null,null)},Kh.prototype.unmount=Lg.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var s=i.containerInfo;rw(i.current,2,null,i,null,null),Rh(),s[Yn]=null}};function Kh(i){this._internalRoot=i}Kh.prototype.unstable_scheduleHydration=function(i){if(i){var s=li();i={blockedOn:null,target:i,priority:s};for(var c=0;c<Ks.length&&s!==0&&s<Ks[c].priority;c++);Ks.splice(c,0,i),c===0&&ow(i)}};var uw=e.version;if(uw!=="19.1.0")throw Error(n(527,uw,"19.1.0"));ue.findDOMNode=function(i){var s=i._reactInternals;if(s===void 0)throw typeof i.render=="function"?Error(n(188)):(i=Object.keys(i).join(","),Error(n(268,i)));return i=f(s),i=i!==null?d(i):null,i=i===null?null:i.stateNode,i};var U3={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:ne,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Yh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Yh.isDisabled&&Yh.supportsFiber)try{Ut=Yh.inject(U3),kt=Yh}catch{}}return hf.createRoot=function(i,s){if(!a(i))throw Error(n(299));var c=!1,h="",g=Ay,x=ky,R=Cy,U=null;return s!=null&&(s.unstable_strictMode===!0&&(c=!0),s.identifierPrefix!==void 0&&(h=s.identifierPrefix),s.onUncaughtError!==void 0&&(g=s.onUncaughtError),s.onCaughtError!==void 0&&(x=s.onCaughtError),s.onRecoverableError!==void 0&&(R=s.onRecoverableError),s.unstable_transitionCallbacks!==void 0&&(U=s.unstable_transitionCallbacks)),s=ew(i,1,!1,null,null,c,h,g,x,R,U,null),i[Yn]=s.current,vg(i),new Lg(s)},hf.hydrateRoot=function(i,s,c){if(!a(i))throw Error(n(299));var h=!1,g="",x=Ay,R=ky,U=Cy,re=null,pe=null;return c!=null&&(c.unstable_strictMode===!0&&(h=!0),c.identifierPrefix!==void 0&&(g=c.identifierPrefix),c.onUncaughtError!==void 0&&(x=c.onUncaughtError),c.onCaughtError!==void 0&&(R=c.onCaughtError),c.onRecoverableError!==void 0&&(U=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(re=c.unstable_transitionCallbacks),c.formState!==void 0&&(pe=c.formState)),s=ew(i,1,!0,s,c??null,h,g,x,R,U,re,pe),s.context=tw(null),c=s.current,h=ha(),h=oi(h),g=Is(h),g.callback=null,Ds(c,g,h),c=h,s.current.lanes=c,Wa(s,c),Ei(s),i[Yn]=s.current,vg(i),new Kh(s)},hf.version="19.1.0",hf}var yw;function K3(){if(yw)return Bg.exports;yw=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Bg.exports=X3(),Bg.exports}var Y3=K3();const $3=pb(Y3),Q3=()=>{};var ww={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xb=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let a=t.charCodeAt(n);a<128?e[r++]=a:a<2048?(e[r++]=a>>6|192,e[r++]=a&63|128):(a&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(a=65536+((a&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=a>>18|240,e[r++]=a>>12&63|128,e[r++]=a>>6&63|128,e[r++]=a&63|128):(e[r++]=a>>12|224,e[r++]=a>>6&63|128,e[r++]=a&63|128)}return e},Z3=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const a=t[r++];if(a<128)e[n++]=String.fromCharCode(a);else if(a>191&&a<224){const o=t[r++];e[n++]=String.fromCharCode((a&31)<<6|o&63)}else if(a>239&&a<365){const o=t[r++],l=t[r++],u=t[r++],f=((a&7)<<18|(o&63)<<12|(l&63)<<6|u&63)-65536;e[n++]=String.fromCharCode(55296+(f>>10)),e[n++]=String.fromCharCode(56320+(f&1023))}else{const o=t[r++],l=t[r++];e[n++]=String.fromCharCode((a&15)<<12|(o&63)<<6|l&63)}}return e.join("")},vb={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let a=0;a<t.length;a+=3){const o=t[a],l=a+1<t.length,u=l?t[a+1]:0,f=a+2<t.length,d=f?t[a+2]:0,m=o>>2,v=(o&3)<<4|u>>4;let _=(u&15)<<2|d>>6,E=d&63;f||(E=64,l||(_=64)),n.push(r[m],r[v],r[_],r[E])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(xb(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Z3(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let a=0;a<t.length;){const o=r[t.charAt(a++)],u=a<t.length?r[t.charAt(a)]:0;++a;const d=a<t.length?r[t.charAt(a)]:64;++a;const v=a<t.length?r[t.charAt(a)]:64;if(++a,o==null||u==null||d==null||v==null)throw new J3;const _=o<<2|u>>4;if(n.push(_),d!==64){const E=u<<4&240|d>>2;if(n.push(E),v!==64){const S=d<<6&192|v;n.push(S)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class J3 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const eR=function(t){const e=xb(t);return vb.encodeByteArray(e,!0)},Nd=function(t){return eR(t).replace(/\./g,"")},_b=function(t){try{return vb.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tR(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rR=()=>tR().__FIREBASE_DEFAULTS__,nR=()=>{if(typeof process>"u"||typeof ww>"u")return;const t=ww.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},aR=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&_b(t[1]);return e&&JSON.parse(e)},lm=()=>{try{return Q3()||rR()||nR()||aR()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},yb=t=>{var e,r;return(r=(e=lm())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},wb=t=>{const e=yb(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},Eb=()=>{var t;return(t=lm())===null||t===void 0?void 0:t.config},Tb=t=>{var e;return(e=lm())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iR{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function So(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function hx(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bb(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",a=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:a,exp:a+3600,auth_time:a,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Nd(JSON.stringify(r)),Nd(JSON.stringify(l)),""].join(".")}const Sf={};function sR(){const t={prod:[],emulator:[]};for(const e of Object.keys(Sf))Sf[e]?t.emulator.push(e):t.prod.push(e);return t}function oR(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let Ew=!1;function dx(t,e){if(typeof window>"u"||typeof document>"u"||!So(window.location.host)||Sf[t]===e||Sf[t]||Ew)return;Sf[t]=e;function r(_){return`__firebase__banner__${_}`}const n="__firebase__banner",o=sR().prod.length>0;function l(){const _=document.getElementById(n);_&&_.remove()}function u(_){_.style.display="flex",_.style.background="#7faaf0",_.style.position="fixed",_.style.bottom="5px",_.style.left="5px",_.style.padding=".5em",_.style.borderRadius="5px",_.style.alignItems="center"}function f(_,E){_.setAttribute("width","24"),_.setAttribute("id",E),_.setAttribute("height","24"),_.setAttribute("viewBox","0 0 24 24"),_.setAttribute("fill","none"),_.style.marginLeft="-6px"}function d(){const _=document.createElement("span");return _.style.cursor="pointer",_.style.marginLeft="16px",_.style.fontSize="24px",_.innerHTML=" &times;",_.onclick=()=>{Ew=!0,l()},_}function m(_,E){_.setAttribute("id",E),_.innerText="Learn more",_.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",_.setAttribute("target","__blank"),_.style.paddingLeft="5px",_.style.textDecoration="underline"}function v(){const _=oR(n),E=r("text"),S=document.getElementById(E)||document.createElement("span"),w=r("learnmore"),b=document.getElementById(w)||document.createElement("a"),L=r("preprendIcon"),B=document.getElementById(L)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(_.created){const F=_.element;u(F),m(b,w);const z=d();f(B,L),F.append(B,S,b,z),document.body.appendChild(F)}o?(S.innerText="Preview backend disconnected.",B.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(B.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,S.innerText="Preview backend running in this workspace."),S.setAttribute("id",E)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",v):v()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function lR(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Pn())}function cR(){var t;const e=(t=lm())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function uR(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function fR(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function hR(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function dR(){const t=Pn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function mR(){return!cR()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function pR(){try{return typeof indexedDB=="object"}catch{return!1}}function gR(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(n);a.onsuccess=()=>{a.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},a.onupgradeneeded=()=>{r=!1},a.onerror=()=>{var o;e(((o=a.error)===null||o===void 0?void 0:o.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xR="FirebaseError";class Bi extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=xR,Object.setPrototypeOf(this,Bi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,u0.prototype.create)}}class u0{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},a=`${this.service}/${e}`,o=this.errors[e],l=o?vR(o,n):"Error",u=`${this.serviceName}: ${l} (${a}).`;return new Bi(a,u,n)}}function vR(t,e){return t.replace(_R,(r,n)=>{const a=e[n];return a!=null?String(a):`<${n}?>`})}const _R=/\{\$([^}]+)}/g;function yR(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function gl(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const a of r){if(!n.includes(a))return!1;const o=t[a],l=e[a];if(Tw(o)&&Tw(l)){if(!gl(o,l))return!1}else if(o!==l)return!1}for(const a of n)if(!r.includes(a))return!1;return!0}function Tw(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f0(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(a=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function pf(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[a,o]=n.split("=");e[decodeURIComponent(a)]=decodeURIComponent(o)}}),e}function gf(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function wR(t,e){const r=new ER(t,e);return r.subscribe.bind(r)}class ER{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let a;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");TR(e,["next","error","complete"])?a=e:a={next:e,error:r,complete:n},a.next===void 0&&(a.next=zg),a.error===void 0&&(a.error=zg),a.complete===void 0&&(a.complete=zg);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function TR(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function zg(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gr(t){return t&&t._delegate?t._delegate:t}class ho{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ol="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bR{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new iR;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:r});a&&n.resolve(a)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),a=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(o){if(a)return null;throw o}else{if(a)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(AR(e))try{this.getOrInitializeService({instanceIdentifier:ol})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);try{const o=this.getOrInitializeService({instanceIdentifier:a});n.resolve(o)}catch{}}}}clearInstance(e=ol){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ol){return this.instances.has(e)}getOptions(e=ol){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[o,l]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(o);n===u&&l.resolve(a)}return a}onInit(e,r){var n;const a=this.normalizeInstanceIdentifier(r),o=(n=this.onInitCallbacks.get(a))!==null&&n!==void 0?n:new Set;o.add(e),this.onInitCallbacks.set(a,o);const l=this.instances.get(a);return l&&e(l,a),()=>{o.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const a of n)try{a(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:SR(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=ol){return this.component?this.component.multipleInstances?e:ol:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function SR(t){return t===ol?void 0:t}function AR(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kR{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new bR(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Nt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Nt||(Nt={}));const CR={debug:Nt.DEBUG,verbose:Nt.VERBOSE,info:Nt.INFO,warn:Nt.WARN,error:Nt.ERROR,silent:Nt.SILENT},RR=Nt.INFO,NR={[Nt.DEBUG]:"log",[Nt.VERBOSE]:"log",[Nt.INFO]:"info",[Nt.WARN]:"warn",[Nt.ERROR]:"error"},IR=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),a=NR[e];if(a)console[a](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class mx{constructor(e){this.name=e,this._logLevel=RR,this._logHandler=IR,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Nt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?CR[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Nt.DEBUG,...e),this._logHandler(this,Nt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Nt.VERBOSE,...e),this._logHandler(this,Nt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Nt.INFO,...e),this._logHandler(this,Nt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Nt.WARN,...e),this._logHandler(this,Nt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Nt.ERROR,...e),this._logHandler(this,Nt.ERROR,...e)}}const DR=(t,e)=>e.some(r=>t instanceof r);let bw,Sw;function OR(){return bw||(bw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function FR(){return Sw||(Sw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Sb=new WeakMap,w1=new WeakMap,Ab=new WeakMap,Gg=new WeakMap,px=new WeakMap;function PR(t){const e=new Promise((r,n)=>{const a=()=>{t.removeEventListener("success",o),t.removeEventListener("error",l)},o=()=>{r(oo(t.result)),a()},l=()=>{n(t.error),a()};t.addEventListener("success",o),t.addEventListener("error",l)});return e.then(r=>{r instanceof IDBCursor&&Sb.set(r,t)}).catch(()=>{}),px.set(e,t),e}function LR(t){if(w1.has(t))return;const e=new Promise((r,n)=>{const a=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",l),t.removeEventListener("abort",l)},o=()=>{r(),a()},l=()=>{n(t.error||new DOMException("AbortError","AbortError")),a()};t.addEventListener("complete",o),t.addEventListener("error",l),t.addEventListener("abort",l)});w1.set(t,e)}let E1={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return w1.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Ab.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return oo(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function MR(t){E1=t(E1)}function UR(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(qg(this),e,...r);return Ab.set(n,e.sort?e.sort():[e]),oo(n)}:FR().includes(t)?function(...e){return t.apply(qg(this),e),oo(Sb.get(this))}:function(...e){return oo(t.apply(qg(this),e))}}function BR(t){return typeof t=="function"?UR(t):(t instanceof IDBTransaction&&LR(t),DR(t,OR())?new Proxy(t,E1):t)}function oo(t){if(t instanceof IDBRequest)return PR(t);if(Gg.has(t))return Gg.get(t);const e=BR(t);return e!==t&&(Gg.set(t,e),px.set(e,t)),e}const qg=t=>px.get(t);function VR(t,e,{blocked:r,upgrade:n,blocking:a,terminated:o}={}){const l=indexedDB.open(t,e),u=oo(l);return n&&l.addEventListener("upgradeneeded",f=>{n(oo(l.result),f.oldVersion,f.newVersion,oo(l.transaction),f)}),r&&l.addEventListener("blocked",f=>r(f.oldVersion,f.newVersion,f)),u.then(f=>{o&&f.addEventListener("close",()=>o()),a&&f.addEventListener("versionchange",d=>a(d.oldVersion,d.newVersion,d))}).catch(()=>{}),u}const jR=["get","getKey","getAll","getAllKeys","count"],HR=["put","add","delete","clear"],Wg=new Map;function Aw(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Wg.get(e))return Wg.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,a=HR.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(a||jR.includes(r)))return;const o=async function(l,...u){const f=this.transaction(l,a?"readwrite":"readonly");let d=f.store;return n&&(d=d.index(u.shift())),(await Promise.all([d[r](...u),a&&f.done]))[0]};return Wg.set(e,o),o}MR(t=>({...t,get:(e,r,n)=>Aw(e,r)||t.get(e,r,n),has:(e,r)=>!!Aw(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zR{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(GR(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function GR(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const T1="@firebase/app",kw="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ps=new mx("@firebase/app"),qR="@firebase/app-compat",WR="@firebase/analytics-compat",XR="@firebase/analytics",KR="@firebase/app-check-compat",YR="@firebase/app-check",$R="@firebase/auth",QR="@firebase/auth-compat",ZR="@firebase/database",JR="@firebase/data-connect",eN="@firebase/database-compat",tN="@firebase/functions",rN="@firebase/functions-compat",nN="@firebase/installations",aN="@firebase/installations-compat",iN="@firebase/messaging",sN="@firebase/messaging-compat",oN="@firebase/performance",lN="@firebase/performance-compat",cN="@firebase/remote-config",uN="@firebase/remote-config-compat",fN="@firebase/storage",hN="@firebase/storage-compat",dN="@firebase/firestore",mN="@firebase/ai",pN="@firebase/firestore-compat",gN="firebase",xN="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b1="[DEFAULT]",vN={[T1]:"fire-core",[qR]:"fire-core-compat",[XR]:"fire-analytics",[WR]:"fire-analytics-compat",[YR]:"fire-app-check",[KR]:"fire-app-check-compat",[$R]:"fire-auth",[QR]:"fire-auth-compat",[ZR]:"fire-rtdb",[JR]:"fire-data-connect",[eN]:"fire-rtdb-compat",[tN]:"fire-fn",[rN]:"fire-fn-compat",[nN]:"fire-iid",[aN]:"fire-iid-compat",[iN]:"fire-fcm",[sN]:"fire-fcm-compat",[oN]:"fire-perf",[lN]:"fire-perf-compat",[cN]:"fire-rc",[uN]:"fire-rc-compat",[fN]:"fire-gcs",[hN]:"fire-gcs-compat",[dN]:"fire-fst",[pN]:"fire-fst-compat",[mN]:"fire-vertex","fire-js":"fire-js",[gN]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xc=new Map,S1=new Map,A1=new Map;function Cw(t,e){try{t.container.addComponent(e)}catch(r){ps.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function xl(t){const e=t.name;if(A1.has(e))return ps.debug(`There were multiple attempts to register component ${e}.`),!1;A1.set(e,t);for(const r of Xc.values())Cw(r,t);for(const r of S1.values())Cw(r,t);return!0}function cm(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function ga(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _N={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},lo=new u0("app","Firebase",_N);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yN{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new ho("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw lo.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nl=xN;function gx(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:b1,automaticDataCollectionEnabled:!0},e),a=n.name;if(typeof a!="string"||!a)throw lo.create("bad-app-name",{appName:String(a)});if(r||(r=Eb()),!r)throw lo.create("no-options");const o=Xc.get(a);if(o){if(gl(r,o.options)&&gl(n,o.config))return o;throw lo.create("duplicate-app",{appName:a})}const l=new kR(a);for(const f of A1.values())l.addComponent(f);const u=new yN(r,n,l);return Xc.set(a,u),u}function xx(t=b1){const e=Xc.get(t);if(!e&&t===b1&&Eb())return gx();if(!e)throw lo.create("no-app",{appName:t});return e}async function wN(t){let e=!1;const r=t.name;Xc.has(r)?(e=!0,Xc.delete(r)):S1.has(r)&&t.decRefCount()<=0&&(S1.delete(r),e=!0),e&&(await Promise.all(t.container.getProviders().map(n=>n.delete())),t.isDeleted=!0)}function Ni(t,e,r){var n;let a=(n=vN[t])!==null&&n!==void 0?n:t;r&&(a+=`-${r}`);const o=a.match(/\s|\//),l=e.match(/\s|\//);if(o||l){const u=[`Unable to register library "${a}" with version "${e}":`];o&&u.push(`library name "${a}" contains illegal characters (whitespace or "/")`),o&&l&&u.push("and"),l&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ps.warn(u.join(" "));return}xl(new ho(`${a}-version`,()=>({library:a,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EN="firebase-heartbeat-database",TN=1,jf="firebase-heartbeat-store";let Xg=null;function kb(){return Xg||(Xg=VR(EN,TN,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(jf)}catch(r){console.warn(r)}}}}).catch(t=>{throw lo.create("idb-open",{originalErrorMessage:t.message})})),Xg}async function bN(t){try{const r=(await kb()).transaction(jf),n=await r.objectStore(jf).get(Cb(t));return await r.done,n}catch(e){if(e instanceof Bi)ps.warn(e.message);else{const r=lo.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ps.warn(r.message)}}}async function Rw(t,e){try{const n=(await kb()).transaction(jf,"readwrite");await n.objectStore(jf).put(e,Cb(t)),await n.done}catch(r){if(r instanceof Bi)ps.warn(r.message);else{const n=lo.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});ps.warn(n.message)}}}function Cb(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SN=1024,AN=30;class kN{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new RN(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=Nw();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(l=>l.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:a}),this._heartbeatsCache.heartbeats.length>AN){const l=NN(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){ps.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=Nw(),{heartbeatsToSend:n,unsentEntries:a}=CN(this._heartbeatsCache.heartbeats),o=Nd(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(r){return ps.warn(r),""}}}function Nw(){return new Date().toISOString().substring(0,10)}function CN(t,e=SN){const r=[];let n=t.slice();for(const a of t){const o=r.find(l=>l.agent===a.agent);if(o){if(o.dates.push(a.date),Iw(r)>e){o.dates.pop();break}}else if(r.push({agent:a.agent,dates:[a.date]}),Iw(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class RN{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return pR()?gR().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await bN(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const a=await this.read();return Rw(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:a.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const a=await this.read();return Rw(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...e.heartbeats]})}else return}}function Iw(t){return Nd(JSON.stringify({version:2,heartbeats:t})).length}function NN(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IN(t){xl(new ho("platform-logger",e=>new zR(e),"PRIVATE")),xl(new ho("heartbeat",e=>new kN(e),"PRIVATE")),Ni(T1,kw,t),Ni(T1,kw,"esm2017"),Ni("fire-js","")}IN("");var DN="firebase",ON="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ni(DN,ON,"app");var Dw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var co,Rb;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(k,I){function A(){}A.prototype=I.prototype,k.D=I.prototype,k.prototype=new A,k.prototype.constructor=k,k.C=function(O,M,N){for(var D=Array(arguments.length-2),he=2;he<arguments.length;he++)D[he-2]=arguments[he];return I.prototype[M].apply(O,D)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(k,I,A){A||(A=0);var O=Array(16);if(typeof I=="string")for(var M=0;16>M;++M)O[M]=I.charCodeAt(A++)|I.charCodeAt(A++)<<8|I.charCodeAt(A++)<<16|I.charCodeAt(A++)<<24;else for(M=0;16>M;++M)O[M]=I[A++]|I[A++]<<8|I[A++]<<16|I[A++]<<24;I=k.g[0],A=k.g[1],M=k.g[2];var N=k.g[3],D=I+(N^A&(M^N))+O[0]+3614090360&4294967295;I=A+(D<<7&4294967295|D>>>25),D=N+(M^I&(A^M))+O[1]+3905402710&4294967295,N=I+(D<<12&4294967295|D>>>20),D=M+(A^N&(I^A))+O[2]+606105819&4294967295,M=N+(D<<17&4294967295|D>>>15),D=A+(I^M&(N^I))+O[3]+3250441966&4294967295,A=M+(D<<22&4294967295|D>>>10),D=I+(N^A&(M^N))+O[4]+4118548399&4294967295,I=A+(D<<7&4294967295|D>>>25),D=N+(M^I&(A^M))+O[5]+1200080426&4294967295,N=I+(D<<12&4294967295|D>>>20),D=M+(A^N&(I^A))+O[6]+2821735955&4294967295,M=N+(D<<17&4294967295|D>>>15),D=A+(I^M&(N^I))+O[7]+4249261313&4294967295,A=M+(D<<22&4294967295|D>>>10),D=I+(N^A&(M^N))+O[8]+1770035416&4294967295,I=A+(D<<7&4294967295|D>>>25),D=N+(M^I&(A^M))+O[9]+2336552879&4294967295,N=I+(D<<12&4294967295|D>>>20),D=M+(A^N&(I^A))+O[10]+4294925233&4294967295,M=N+(D<<17&4294967295|D>>>15),D=A+(I^M&(N^I))+O[11]+2304563134&4294967295,A=M+(D<<22&4294967295|D>>>10),D=I+(N^A&(M^N))+O[12]+1804603682&4294967295,I=A+(D<<7&4294967295|D>>>25),D=N+(M^I&(A^M))+O[13]+4254626195&4294967295,N=I+(D<<12&4294967295|D>>>20),D=M+(A^N&(I^A))+O[14]+2792965006&4294967295,M=N+(D<<17&4294967295|D>>>15),D=A+(I^M&(N^I))+O[15]+1236535329&4294967295,A=M+(D<<22&4294967295|D>>>10),D=I+(M^N&(A^M))+O[1]+4129170786&4294967295,I=A+(D<<5&4294967295|D>>>27),D=N+(A^M&(I^A))+O[6]+3225465664&4294967295,N=I+(D<<9&4294967295|D>>>23),D=M+(I^A&(N^I))+O[11]+643717713&4294967295,M=N+(D<<14&4294967295|D>>>18),D=A+(N^I&(M^N))+O[0]+3921069994&4294967295,A=M+(D<<20&4294967295|D>>>12),D=I+(M^N&(A^M))+O[5]+3593408605&4294967295,I=A+(D<<5&4294967295|D>>>27),D=N+(A^M&(I^A))+O[10]+38016083&4294967295,N=I+(D<<9&4294967295|D>>>23),D=M+(I^A&(N^I))+O[15]+3634488961&4294967295,M=N+(D<<14&4294967295|D>>>18),D=A+(N^I&(M^N))+O[4]+3889429448&4294967295,A=M+(D<<20&4294967295|D>>>12),D=I+(M^N&(A^M))+O[9]+568446438&4294967295,I=A+(D<<5&4294967295|D>>>27),D=N+(A^M&(I^A))+O[14]+3275163606&4294967295,N=I+(D<<9&4294967295|D>>>23),D=M+(I^A&(N^I))+O[3]+4107603335&4294967295,M=N+(D<<14&4294967295|D>>>18),D=A+(N^I&(M^N))+O[8]+1163531501&4294967295,A=M+(D<<20&4294967295|D>>>12),D=I+(M^N&(A^M))+O[13]+2850285829&4294967295,I=A+(D<<5&4294967295|D>>>27),D=N+(A^M&(I^A))+O[2]+4243563512&4294967295,N=I+(D<<9&4294967295|D>>>23),D=M+(I^A&(N^I))+O[7]+1735328473&4294967295,M=N+(D<<14&4294967295|D>>>18),D=A+(N^I&(M^N))+O[12]+2368359562&4294967295,A=M+(D<<20&4294967295|D>>>12),D=I+(A^M^N)+O[5]+4294588738&4294967295,I=A+(D<<4&4294967295|D>>>28),D=N+(I^A^M)+O[8]+2272392833&4294967295,N=I+(D<<11&4294967295|D>>>21),D=M+(N^I^A)+O[11]+1839030562&4294967295,M=N+(D<<16&4294967295|D>>>16),D=A+(M^N^I)+O[14]+4259657740&4294967295,A=M+(D<<23&4294967295|D>>>9),D=I+(A^M^N)+O[1]+2763975236&4294967295,I=A+(D<<4&4294967295|D>>>28),D=N+(I^A^M)+O[4]+1272893353&4294967295,N=I+(D<<11&4294967295|D>>>21),D=M+(N^I^A)+O[7]+4139469664&4294967295,M=N+(D<<16&4294967295|D>>>16),D=A+(M^N^I)+O[10]+3200236656&4294967295,A=M+(D<<23&4294967295|D>>>9),D=I+(A^M^N)+O[13]+681279174&4294967295,I=A+(D<<4&4294967295|D>>>28),D=N+(I^A^M)+O[0]+3936430074&4294967295,N=I+(D<<11&4294967295|D>>>21),D=M+(N^I^A)+O[3]+3572445317&4294967295,M=N+(D<<16&4294967295|D>>>16),D=A+(M^N^I)+O[6]+76029189&4294967295,A=M+(D<<23&4294967295|D>>>9),D=I+(A^M^N)+O[9]+3654602809&4294967295,I=A+(D<<4&4294967295|D>>>28),D=N+(I^A^M)+O[12]+3873151461&4294967295,N=I+(D<<11&4294967295|D>>>21),D=M+(N^I^A)+O[15]+530742520&4294967295,M=N+(D<<16&4294967295|D>>>16),D=A+(M^N^I)+O[2]+3299628645&4294967295,A=M+(D<<23&4294967295|D>>>9),D=I+(M^(A|~N))+O[0]+4096336452&4294967295,I=A+(D<<6&4294967295|D>>>26),D=N+(A^(I|~M))+O[7]+1126891415&4294967295,N=I+(D<<10&4294967295|D>>>22),D=M+(I^(N|~A))+O[14]+2878612391&4294967295,M=N+(D<<15&4294967295|D>>>17),D=A+(N^(M|~I))+O[5]+4237533241&4294967295,A=M+(D<<21&4294967295|D>>>11),D=I+(M^(A|~N))+O[12]+1700485571&4294967295,I=A+(D<<6&4294967295|D>>>26),D=N+(A^(I|~M))+O[3]+2399980690&4294967295,N=I+(D<<10&4294967295|D>>>22),D=M+(I^(N|~A))+O[10]+4293915773&4294967295,M=N+(D<<15&4294967295|D>>>17),D=A+(N^(M|~I))+O[1]+2240044497&4294967295,A=M+(D<<21&4294967295|D>>>11),D=I+(M^(A|~N))+O[8]+1873313359&4294967295,I=A+(D<<6&4294967295|D>>>26),D=N+(A^(I|~M))+O[15]+4264355552&4294967295,N=I+(D<<10&4294967295|D>>>22),D=M+(I^(N|~A))+O[6]+2734768916&4294967295,M=N+(D<<15&4294967295|D>>>17),D=A+(N^(M|~I))+O[13]+1309151649&4294967295,A=M+(D<<21&4294967295|D>>>11),D=I+(M^(A|~N))+O[4]+4149444226&4294967295,I=A+(D<<6&4294967295|D>>>26),D=N+(A^(I|~M))+O[11]+3174756917&4294967295,N=I+(D<<10&4294967295|D>>>22),D=M+(I^(N|~A))+O[2]+718787259&4294967295,M=N+(D<<15&4294967295|D>>>17),D=A+(N^(M|~I))+O[9]+3951481745&4294967295,k.g[0]=k.g[0]+I&4294967295,k.g[1]=k.g[1]+(M+(D<<21&4294967295|D>>>11))&4294967295,k.g[2]=k.g[2]+M&4294967295,k.g[3]=k.g[3]+N&4294967295}n.prototype.u=function(k,I){I===void 0&&(I=k.length);for(var A=I-this.blockSize,O=this.B,M=this.h,N=0;N<I;){if(M==0)for(;N<=A;)a(this,k,N),N+=this.blockSize;if(typeof k=="string"){for(;N<I;)if(O[M++]=k.charCodeAt(N++),M==this.blockSize){a(this,O),M=0;break}}else for(;N<I;)if(O[M++]=k[N++],M==this.blockSize){a(this,O),M=0;break}}this.h=M,this.o+=I},n.prototype.v=function(){var k=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);k[0]=128;for(var I=1;I<k.length-8;++I)k[I]=0;var A=8*this.o;for(I=k.length-8;I<k.length;++I)k[I]=A&255,A/=256;for(this.u(k),k=Array(16),I=A=0;4>I;++I)for(var O=0;32>O;O+=8)k[A++]=this.g[I]>>>O&255;return k};function o(k,I){var A=u;return Object.prototype.hasOwnProperty.call(A,k)?A[k]:A[k]=I(k)}function l(k,I){this.h=I;for(var A=[],O=!0,M=k.length-1;0<=M;M--){var N=k[M]|0;O&&N==I||(A[M]=N,O=!1)}this.g=A}var u={};function f(k){return-128<=k&&128>k?o(k,function(I){return new l([I|0],0>I?-1:0)}):new l([k|0],0>k?-1:0)}function d(k){if(isNaN(k)||!isFinite(k))return v;if(0>k)return b(d(-k));for(var I=[],A=1,O=0;k>=A;O++)I[O]=k/A|0,A*=4294967296;return new l(I,0)}function m(k,I){if(k.length==0)throw Error("number format error: empty string");if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(k.charAt(0)=="-")return b(m(k.substring(1),I));if(0<=k.indexOf("-"))throw Error('number format error: interior "-" character');for(var A=d(Math.pow(I,8)),O=v,M=0;M<k.length;M+=8){var N=Math.min(8,k.length-M),D=parseInt(k.substring(M,M+N),I);8>N?(N=d(Math.pow(I,N)),O=O.j(N).add(d(D))):(O=O.j(A),O=O.add(d(D)))}return O}var v=f(0),_=f(1),E=f(16777216);t=l.prototype,t.m=function(){if(w(this))return-b(this).m();for(var k=0,I=1,A=0;A<this.g.length;A++){var O=this.i(A);k+=(0<=O?O:4294967296+O)*I,I*=4294967296}return k},t.toString=function(k){if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(S(this))return"0";if(w(this))return"-"+b(this).toString(k);for(var I=d(Math.pow(k,6)),A=this,O="";;){var M=z(A,I).g;A=L(A,M.j(I));var N=((0<A.g.length?A.g[0]:A.h)>>>0).toString(k);if(A=M,S(A))return N+O;for(;6>N.length;)N="0"+N;O=N+O}},t.i=function(k){return 0>k?0:k<this.g.length?this.g[k]:this.h};function S(k){if(k.h!=0)return!1;for(var I=0;I<k.g.length;I++)if(k.g[I]!=0)return!1;return!0}function w(k){return k.h==-1}t.l=function(k){return k=L(this,k),w(k)?-1:S(k)?0:1};function b(k){for(var I=k.g.length,A=[],O=0;O<I;O++)A[O]=~k.g[O];return new l(A,~k.h).add(_)}t.abs=function(){return w(this)?b(this):this},t.add=function(k){for(var I=Math.max(this.g.length,k.g.length),A=[],O=0,M=0;M<=I;M++){var N=O+(this.i(M)&65535)+(k.i(M)&65535),D=(N>>>16)+(this.i(M)>>>16)+(k.i(M)>>>16);O=D>>>16,N&=65535,D&=65535,A[M]=D<<16|N}return new l(A,A[A.length-1]&-2147483648?-1:0)};function L(k,I){return k.add(b(I))}t.j=function(k){if(S(this)||S(k))return v;if(w(this))return w(k)?b(this).j(b(k)):b(b(this).j(k));if(w(k))return b(this.j(b(k)));if(0>this.l(E)&&0>k.l(E))return d(this.m()*k.m());for(var I=this.g.length+k.g.length,A=[],O=0;O<2*I;O++)A[O]=0;for(O=0;O<this.g.length;O++)for(var M=0;M<k.g.length;M++){var N=this.i(O)>>>16,D=this.i(O)&65535,he=k.i(M)>>>16,we=k.i(M)&65535;A[2*O+2*M]+=D*we,B(A,2*O+2*M),A[2*O+2*M+1]+=N*we,B(A,2*O+2*M+1),A[2*O+2*M+1]+=D*he,B(A,2*O+2*M+1),A[2*O+2*M+2]+=N*he,B(A,2*O+2*M+2)}for(O=0;O<I;O++)A[O]=A[2*O+1]<<16|A[2*O];for(O=I;O<2*I;O++)A[O]=0;return new l(A,0)};function B(k,I){for(;(k[I]&65535)!=k[I];)k[I+1]+=k[I]>>>16,k[I]&=65535,I++}function F(k,I){this.g=k,this.h=I}function z(k,I){if(S(I))throw Error("division by zero");if(S(k))return new F(v,v);if(w(k))return I=z(b(k),I),new F(b(I.g),b(I.h));if(w(I))return I=z(k,b(I)),new F(b(I.g),I.h);if(30<k.g.length){if(w(k)||w(I))throw Error("slowDivide_ only works with positive integers.");for(var A=_,O=I;0>=O.l(k);)A=q(A),O=q(O);var M=W(A,1),N=W(O,1);for(O=W(O,2),A=W(A,2);!S(O);){var D=N.add(O);0>=D.l(k)&&(M=M.add(A),N=D),O=W(O,1),A=W(A,1)}return I=L(k,M.j(I)),new F(M,I)}for(M=v;0<=k.l(I);){for(A=Math.max(1,Math.floor(k.m()/I.m())),O=Math.ceil(Math.log(A)/Math.LN2),O=48>=O?1:Math.pow(2,O-48),N=d(A),D=N.j(I);w(D)||0<D.l(k);)A-=O,N=d(A),D=N.j(I);S(N)&&(N=_),M=M.add(N),k=L(k,D)}return new F(M,k)}t.A=function(k){return z(this,k).h},t.and=function(k){for(var I=Math.max(this.g.length,k.g.length),A=[],O=0;O<I;O++)A[O]=this.i(O)&k.i(O);return new l(A,this.h&k.h)},t.or=function(k){for(var I=Math.max(this.g.length,k.g.length),A=[],O=0;O<I;O++)A[O]=this.i(O)|k.i(O);return new l(A,this.h|k.h)},t.xor=function(k){for(var I=Math.max(this.g.length,k.g.length),A=[],O=0;O<I;O++)A[O]=this.i(O)^k.i(O);return new l(A,this.h^k.h)};function q(k){for(var I=k.g.length+1,A=[],O=0;O<I;O++)A[O]=k.i(O)<<1|k.i(O-1)>>>31;return new l(A,k.h)}function W(k,I){var A=I>>5;I%=32;for(var O=k.g.length-A,M=[],N=0;N<O;N++)M[N]=0<I?k.i(N+A)>>>I|k.i(N+A+1)<<32-I:k.i(N+A);return new l(M,k.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,Rb=n,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.A,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=d,l.fromString=m,co=l}).apply(typeof Dw<"u"?Dw:typeof self<"u"?self:typeof window<"u"?window:{});var $h=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Nb,xf,Ib,xd,k1,Db,Ob,Fb;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(p,T,C){return p==Array.prototype||p==Object.prototype||(p[T]=C.value),p};function r(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof $h=="object"&&$h];for(var T=0;T<p.length;++T){var C=p[T];if(C&&C.Math==Math)return C}throw Error("Cannot find global object")}var n=r(this);function a(p,T){if(T)e:{var C=n;p=p.split(".");for(var j=0;j<p.length-1;j++){var fe=p[j];if(!(fe in C))break e;C=C[fe]}p=p[p.length-1],j=C[p],T=T(j),T!=j&&T!=null&&e(C,p,{configurable:!0,writable:!0,value:T})}}function o(p,T){p instanceof String&&(p+="");var C=0,j=!1,fe={next:function(){if(!j&&C<p.length){var be=C++;return{value:T(be,p[be]),done:!1}}return j=!0,{done:!0,value:void 0}}};return fe[Symbol.iterator]=function(){return fe},fe}a("Array.prototype.values",function(p){return p||function(){return o(this,function(T,C){return C})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var l=l||{},u=this||self;function f(p){var T=typeof p;return T=T!="object"?T:p?Array.isArray(p)?"array":T:"null",T=="array"||T=="object"&&typeof p.length=="number"}function d(p){var T=typeof p;return T=="object"&&p!=null||T=="function"}function m(p,T,C){return p.call.apply(p.bind,arguments)}function v(p,T,C){if(!p)throw Error();if(2<arguments.length){var j=Array.prototype.slice.call(arguments,2);return function(){var fe=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(fe,j),p.apply(T,fe)}}return function(){return p.apply(T,arguments)}}function _(p,T,C){return _=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?m:v,_.apply(null,arguments)}function E(p,T){var C=Array.prototype.slice.call(arguments,1);return function(){var j=C.slice();return j.push.apply(j,arguments),p.apply(this,j)}}function S(p,T){function C(){}C.prototype=T.prototype,p.aa=T.prototype,p.prototype=new C,p.prototype.constructor=p,p.Qb=function(j,fe,be){for(var Ge=Array(arguments.length-2),Ft=2;Ft<arguments.length;Ft++)Ge[Ft-2]=arguments[Ft];return T.prototype[fe].apply(j,Ge)}}function w(p){const T=p.length;if(0<T){const C=Array(T);for(let j=0;j<T;j++)C[j]=p[j];return C}return[]}function b(p,T){for(let C=1;C<arguments.length;C++){const j=arguments[C];if(f(j)){const fe=p.length||0,be=j.length||0;p.length=fe+be;for(let Ge=0;Ge<be;Ge++)p[fe+Ge]=j[Ge]}else p.push(j)}}class L{constructor(T,C){this.i=T,this.j=C,this.h=0,this.g=null}get(){let T;return 0<this.h?(this.h--,T=this.g,this.g=T.next,T.next=null):T=this.i(),T}}function B(p){return/^[\s\xa0]*$/.test(p)}function F(){var p=u.navigator;return p&&(p=p.userAgent)?p:""}function z(p){return z[" "](p),p}z[" "]=function(){};var q=F().indexOf("Gecko")!=-1&&!(F().toLowerCase().indexOf("webkit")!=-1&&F().indexOf("Edge")==-1)&&!(F().indexOf("Trident")!=-1||F().indexOf("MSIE")!=-1)&&F().indexOf("Edge")==-1;function W(p,T,C){for(const j in p)T.call(C,p[j],j,p)}function k(p,T){for(const C in p)T.call(void 0,p[C],C,p)}function I(p){const T={};for(const C in p)T[C]=p[C];return T}const A="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function O(p,T){let C,j;for(let fe=1;fe<arguments.length;fe++){j=arguments[fe];for(C in j)p[C]=j[C];for(let be=0;be<A.length;be++)C=A[be],Object.prototype.hasOwnProperty.call(j,C)&&(p[C]=j[C])}}function M(p){var T=1;p=p.split(":");const C=[];for(;0<T&&p.length;)C.push(p.shift()),T--;return p.length&&C.push(p.join(":")),C}function N(p){u.setTimeout(()=>{throw p},0)}function D(){var p=ie;let T=null;return p.g&&(T=p.g,p.g=p.g.next,p.g||(p.h=null),T.next=null),T}class he{constructor(){this.h=this.g=null}add(T,C){const j=we.get();j.set(T,C),this.h?this.h.next=j:this.g=j,this.h=j}}var we=new L(()=>new ne,p=>p.reset());class ne{constructor(){this.next=this.g=this.h=null}set(T,C){this.h=T,this.g=C,this.next=null}reset(){this.next=this.g=this.h=null}}let ue,Ve=!1,ie=new he,ee=()=>{const p=u.Promise.resolve(void 0);ue=()=>{p.then(ge)}};var ge=()=>{for(var p;p=D();){try{p.h.call(p.g)}catch(C){N(C)}var T=we;T.j(p),100>T.h&&(T.h++,p.next=T.g,T.g=p)}Ve=!1};function V(){this.s=this.s,this.C=this.C}V.prototype.s=!1,V.prototype.ma=function(){this.s||(this.s=!0,this.N())},V.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function K(p,T){this.type=p,this.g=this.target=T,this.defaultPrevented=!1}K.prototype.h=function(){this.defaultPrevented=!0};var Y=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var p=!1,T=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const C=()=>{};u.addEventListener("test",C,T),u.removeEventListener("test",C,T)}catch{}return p}();function te(p,T){if(K.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p){var C=this.type=p.type,j=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;if(this.target=p.target||p.srcElement,this.g=T,T=p.relatedTarget){if(q){e:{try{z(T.nodeName);var fe=!0;break e}catch{}fe=!1}fe||(T=null)}}else C=="mouseover"?T=p.fromElement:C=="mouseout"&&(T=p.toElement);this.relatedTarget=T,j?(this.clientX=j.clientX!==void 0?j.clientX:j.pageX,this.clientY=j.clientY!==void 0?j.clientY:j.pageY,this.screenX=j.screenX||0,this.screenY=j.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=typeof p.pointerType=="string"?p.pointerType:ce[p.pointerType]||"",this.state=p.state,this.i=p,p.defaultPrevented&&te.aa.h.call(this)}}S(te,K);var ce={2:"touch",3:"pen",4:"mouse"};te.prototype.h=function(){te.aa.h.call(this);var p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var De="closure_listenable_"+(1e6*Math.random()|0),ke=0;function Fe(p,T,C,j,fe){this.listener=p,this.proxy=null,this.src=T,this.type=C,this.capture=!!j,this.ha=fe,this.key=++ke,this.da=this.fa=!1}function ye(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function Be(p){this.src=p,this.g={},this.h=0}Be.prototype.add=function(p,T,C,j,fe){var be=p.toString();p=this.g[be],p||(p=this.g[be]=[],this.h++);var Ge=rt(p,T,j,fe);return-1<Ge?(T=p[Ge],C||(T.fa=!1)):(T=new Fe(T,this.src,be,!!j,fe),T.fa=C,p.push(T)),T};function X(p,T){var C=T.type;if(C in p.g){var j=p.g[C],fe=Array.prototype.indexOf.call(j,T,void 0),be;(be=0<=fe)&&Array.prototype.splice.call(j,fe,1),be&&(ye(T),p.g[C].length==0&&(delete p.g[C],p.h--))}}function rt(p,T,C,j){for(var fe=0;fe<p.length;++fe){var be=p[fe];if(!be.da&&be.listener==T&&be.capture==!!C&&be.ha==j)return fe}return-1}var nt="closure_lm_"+(1e6*Math.random()|0),wt={};function ut(p,T,C,j,fe){if(Array.isArray(T)){for(var be=0;be<T.length;be++)ut(p,T[be],C,j,fe);return null}return C=Tn(C),p&&p[De]?p.K(T,C,d(j)?!!j.capture:!1,fe):Ue(p,T,C,!1,j,fe)}function Ue(p,T,C,j,fe,be){if(!T)throw Error("Invalid event type");var Ge=d(fe)?!!fe.capture:!!fe,Ft=hn(p);if(Ft||(p[nt]=Ft=new Be(p)),C=Ft.add(T,C,j,Ge,be),C.proxy)return C;if(j=Jt(),C.proxy=j,j.src=p,j.listener=C,p.addEventListener)Y||(fe=Ge),fe===void 0&&(fe=!1),p.addEventListener(T.toString(),j,fe);else if(p.attachEvent)p.attachEvent(Xr(T.toString()),j);else if(p.addListener&&p.removeListener)p.addListener(j);else throw Error("addEventListener and attachEvent are unavailable.");return C}function Jt(){function p(C){return T.call(p.src,p.listener,C)}const T=Ga;return p}function Cr(p,T,C,j,fe){if(Array.isArray(T))for(var be=0;be<T.length;be++)Cr(p,T[be],C,j,fe);else j=d(j)?!!j.capture:!!j,C=Tn(C),p&&p[De]?(p=p.i,T=String(T).toString(),T in p.g&&(be=p.g[T],C=rt(be,C,j,fe),-1<C&&(ye(be[C]),Array.prototype.splice.call(be,C,1),be.length==0&&(delete p.g[T],p.h--)))):p&&(p=hn(p))&&(T=p.g[T.toString()],p=-1,T&&(p=rt(T,C,j,fe)),(C=-1<p?T[p]:null)&&Mr(C))}function Mr(p){if(typeof p!="number"&&p&&!p.da){var T=p.src;if(T&&T[De])X(T.i,p);else{var C=p.type,j=p.proxy;T.removeEventListener?T.removeEventListener(C,j,p.capture):T.detachEvent?T.detachEvent(Xr(C),j):T.addListener&&T.removeListener&&T.removeListener(j),(C=hn(T))?(X(C,p),C.h==0&&(C.src=null,T[nt]=null)):ye(p)}}}function Xr(p){return p in wt?wt[p]:wt[p]="on"+p}function Ga(p,T){if(p.da)p=!0;else{T=new te(T,this);var C=p.listener,j=p.ha||p.src;p.fa&&Mr(p),p=C.call(j,T)}return p}function hn(p){return p=p[nt],p instanceof Be?p:null}var Rr="__closure_events_fn_"+(1e9*Math.random()>>>0);function Tn(p){return typeof p=="function"?p:(p[Rr]||(p[Rr]=function(T){return p.handleEvent(T)}),p[Rr])}function Ut(){V.call(this),this.i=new Be(this),this.M=this,this.F=null}S(Ut,V),Ut.prototype[De]=!0,Ut.prototype.removeEventListener=function(p,T,C,j){Cr(this,p,T,C,j)};function kt(p,T){var C,j=p.F;if(j)for(C=[];j;j=j.F)C.push(j);if(p=p.M,j=T.type||T,typeof T=="string")T=new K(T,p);else if(T instanceof K)T.target=T.target||p;else{var fe=T;T=new K(j,p),O(T,fe)}if(fe=!0,C)for(var be=C.length-1;0<=be;be--){var Ge=T.g=C[be];fe=se(Ge,j,!0,T)&&fe}if(Ge=T.g=p,fe=se(Ge,j,!0,T)&&fe,fe=se(Ge,j,!1,T)&&fe,C)for(be=0;be<C.length;be++)Ge=T.g=C[be],fe=se(Ge,j,!1,T)&&fe}Ut.prototype.N=function(){if(Ut.aa.N.call(this),this.i){var p=this.i,T;for(T in p.g){for(var C=p.g[T],j=0;j<C.length;j++)ye(C[j]);delete p.g[T],p.h--}}this.F=null},Ut.prototype.K=function(p,T,C,j){return this.i.add(String(p),T,!1,C,j)},Ut.prototype.L=function(p,T,C,j){return this.i.add(String(p),T,!0,C,j)};function se(p,T,C,j){if(T=p.i.g[String(T)],!T)return!0;T=T.concat();for(var fe=!0,be=0;be<T.length;++be){var Ge=T[be];if(Ge&&!Ge.da&&Ge.capture==C){var Ft=Ge.listener,Kr=Ge.ha||Ge.src;Ge.fa&&X(p.i,Ge),fe=Ft.call(Kr,j)!==!1&&fe}}return fe&&!j.defaultPrevented}function Me(p,T,C){if(typeof p=="function")C&&(p=_(p,C));else if(p&&typeof p.handleEvent=="function")p=_(p.handleEvent,p);else throw Error("Invalid listener argument");return 2147483647<Number(T)?-1:u.setTimeout(p,T||0)}function Re(p){p.g=Me(()=>{p.g=null,p.i&&(p.i=!1,Re(p))},p.l);const T=p.h;p.h=null,p.m.apply(null,T)}class Je extends V{constructor(T,C){super(),this.m=T,this.l=C,this.h=null,this.i=!1,this.g=null}j(T){this.h=arguments,this.g?this.i=!0:Re(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function pt(p){V.call(this),this.h=p,this.g={}}S(pt,V);var mt=[];function sr(p){W(p.g,function(T,C){this.g.hasOwnProperty(C)&&Mr(T)},p),p.g={}}pt.prototype.N=function(){pt.aa.N.call(this),sr(this)},pt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var qt=u.JSON.stringify,Un=u.JSON.parse,Hi=class{stringify(p){return u.JSON.stringify(p,void 0)}parse(p){return u.JSON.parse(p,void 0)}};function Ts(){}Ts.prototype.h=null;function bs(p){return p.h||(p.h=p.i())}function Ss(){}var qa={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Wa(){K.call(this,"d")}S(Wa,K);function si(){K.call(this,"c")}S(si,K);var Ta={},Oo=null;function oi(){return Oo=Oo||new Ut}Ta.La="serverreachability";function As(p){K.call(this,Ta.La,p)}S(As,K);function li(p){const T=oi();kt(T,new As(T))}Ta.STAT_EVENT="statevent";function jl(p,T){K.call(this,Ta.STAT_EVENT,p),this.stat=T}S(jl,K);function or(p){const T=oi();kt(T,new jl(T,p))}Ta.Ma="timingevent";function Nr(p,T){K.call(this,Ta.Ma,p),this.size=T}S(Nr,K);function mr(p,T){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){p()},T)}function Yn(){this.g=!0}Yn.prototype.xa=function(){this.g=!1};function Fo(p,T,C,j,fe,be){p.info(function(){if(p.g)if(be)for(var Ge="",Ft=be.split("&"),Kr=0;Kr<Ft.length;Kr++){var Pt=Ft[Kr].split("=");if(1<Pt.length){var nn=Pt[0];Pt=Pt[1];var Yr=nn.split("_");Ge=2<=Yr.length&&Yr[1]=="type"?Ge+(nn+"="+Pt+"&"):Ge+(nn+"=redacted&")}}else Ge=null;else Ge=be;return"XMLHTTP REQ ("+j+") [attempt "+fe+"]: "+T+`
`+C+`
`+Ge})}function hu(p,T,C,j,fe,be,Ge){p.info(function(){return"XMLHTTP RESP ("+j+") [ attempt "+fe+"]: "+T+`
`+C+`
`+be+" "+Ge})}function P(p,T,C,j){p.info(function(){return"XMLHTTP TEXT ("+T+"): "+H(p,C)+(j?" "+j:"")})}function Z(p,T){p.info(function(){return"TIMEOUT: "+T})}Yn.prototype.info=function(){};function H(p,T){if(!p.g)return T;if(!T)return null;try{var C=JSON.parse(T);if(C){for(p=0;p<C.length;p++)if(Array.isArray(C[p])){var j=C[p];if(!(2>j.length)){var fe=j[1];if(Array.isArray(fe)&&!(1>fe.length)){var be=fe[0];if(be!="noop"&&be!="stop"&&be!="close")for(var Ge=1;Ge<fe.length;Ge++)fe[Ge]=""}}}}return qt(C)}catch{return T}}var G={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Q={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},J;function me(){}S(me,Ts),me.prototype.g=function(){return new XMLHttpRequest},me.prototype.i=function(){return{}},J=new me;function Te(p,T,C,j){this.j=p,this.i=T,this.l=C,this.R=j||1,this.U=new pt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new le}function le(){this.i=null,this.g="",this.h=!1}var xe={},ve={};function Le(p,T,C){p.L=1,p.v=Mo(sa(T)),p.m=C,p.P=!0,He(p,null)}function He(p,T){p.F=Date.now(),We(p),p.A=sa(p.v);var C=p.A,j=p.R;Array.isArray(j)||(j=[String(j)]),xu(C.i,"t",j),p.C=0,C=p.j.J,p.h=new le,p.g=W0(p.j,C?T:null,!p.m),0<p.O&&(p.M=new Je(_(p.Y,p,p.g),p.O)),T=p.U,C=p.g,j=p.ca;var fe="readystatechange";Array.isArray(fe)||(fe&&(mt[0]=fe.toString()),fe=mt);for(var be=0;be<fe.length;be++){var Ge=ut(C,fe[be],j||T.handleEvent,!1,T.h||T);if(!Ge)break;T.g[Ge.key]=Ge}T=p.H?I(p.H):{},p.m?(p.u||(p.u="POST"),T["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.A,p.u,p.m,T)):(p.u="GET",p.g.ea(p.A,p.u,null,T)),li(),Fo(p.i,p.u,p.A,p.l,p.R,p.m)}Te.prototype.ca=function(p){p=p.target;const T=this.M;T&&ka(p)==3?T.j():this.Y(p)},Te.prototype.Y=function(p){try{if(p==this.g)e:{const Yr=ka(this.g);var T=this.g.Ba();const Yi=this.g.Z();if(!(3>Yr)&&(Yr!=3||this.g&&(this.h.h||this.g.oa()||U0(this.g)))){this.J||Yr!=4||T==7||(T==8||0>=Yi?li(3):li(2)),jt(this);var C=this.g.Z();this.X=C;t:if(Ke(this)){var j=U0(this.g);p="";var fe=j.length,be=ka(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ot(this),Dt(this);var Ge="";break t}this.h.i=new u.TextDecoder}for(T=0;T<fe;T++)this.h.h=!0,p+=this.h.i.decode(j[T],{stream:!(be&&T==fe-1)});j.length=0,this.h.g+=p,this.C=0,Ge=this.h.g}else Ge=this.g.oa();if(this.o=C==200,hu(this.i,this.u,this.A,this.l,this.R,Yr,C),this.o){if(this.T&&!this.K){t:{if(this.g){var Ft,Kr=this.g;if((Ft=Kr.g?Kr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!B(Ft)){var Pt=Ft;break t}}Pt=null}if(C=Pt)P(this.i,this.l,C,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ia(this,C);else{this.o=!1,this.s=3,or(12),Ot(this),Dt(this);break e}}if(this.P){C=!0;let dn;for(;!this.J&&this.C<Ge.length;)if(dn=je(this,Ge),dn==ve){Yr==4&&(this.s=4,or(14),C=!1),P(this.i,this.l,null,"[Incomplete Response]");break}else if(dn==xe){this.s=4,or(15),P(this.i,this.l,Ge,"[Invalid Chunk]"),C=!1;break}else P(this.i,this.l,dn,null),ia(this,dn);if(Ke(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Yr!=4||Ge.length!=0||this.h.h||(this.s=1,or(16),C=!1),this.o=this.o&&C,!C)P(this.i,this.l,Ge,"[Invalid Chunked Response]"),Ot(this),Dt(this);else if(0<Ge.length&&!this.W){this.W=!0;var nn=this.j;nn.g==this&&nn.ba&&!nn.M&&(nn.j.info("Great, no buffering proxy detected. Bytes received: "+Ge.length),qo(nn),nn.M=!0,or(11))}}else P(this.i,this.l,Ge,null),ia(this,Ge);Yr==4&&Ot(this),this.o&&!this.J&&(Yr==4?z0(this.j,this):(this.o=!1,We(this)))}else qm(this.g),C==400&&0<Ge.indexOf("Unknown SID")?(this.s=3,or(12)):(this.s=0,or(13)),Ot(this),Dt(this)}}}catch{}finally{}};function Ke(p){return p.g?p.u=="GET"&&p.L!=2&&p.j.Ca:!1}function je(p,T){var C=p.C,j=T.indexOf(`
`,C);return j==-1?ve:(C=Number(T.substring(C,j)),isNaN(C)?xe:(j+=1,j+C>T.length?ve:(T=T.slice(j,j+C),p.C=j+C,T)))}Te.prototype.cancel=function(){this.J=!0,Ot(this)};function We(p){p.S=Date.now()+p.I,ft(p,p.I)}function ft(p,T){if(p.B!=null)throw Error("WatchDog timer not null");p.B=mr(_(p.ba,p),T)}function jt(p){p.B&&(u.clearTimeout(p.B),p.B=null)}Te.prototype.ba=function(){this.B=null;const p=Date.now();0<=p-this.S?(Z(this.i,this.A),this.L!=2&&(li(),or(17)),Ot(this),this.s=2,Dt(this)):ft(this,this.S-p)};function Dt(p){p.j.G==0||p.J||z0(p.j,p)}function Ot(p){jt(p);var T=p.M;T&&typeof T.ma=="function"&&T.ma(),p.M=null,sr(p.U),p.g&&(T=p.g,p.g=null,T.abort(),T.ma())}function ia(p,T){try{var C=p.j;if(C.G!=0&&(C.g==p||Vn(C.h,p))){if(!p.K&&Vn(C.h,p)&&C.G==3){try{var j=C.Da.g.parse(T)}catch{j=null}if(Array.isArray(j)&&j.length==3){var fe=j;if(fe[0]==0){e:if(!C.u){if(C.g)if(C.g.F+3e3<p.F)Ql(C),Yl(C);else break e;Eu(C),or(18)}}else C.za=fe[1],0<C.za-C.T&&37500>fe[2]&&C.F&&C.v==0&&!C.C&&(C.C=mr(_(C.Za,C),6e3));if(1>=ui(C.h)&&C.ca){try{C.ca()}catch{}C.ca=void 0}}else Ki(C,11)}else if((p.K||C.g==p)&&Ql(C),!B(T))for(fe=C.Da.g.parse(T),T=0;T<fe.length;T++){let Pt=fe[T];if(C.T=Pt[0],Pt=Pt[1],C.G==2)if(Pt[0]=="c"){C.K=Pt[1],C.ia=Pt[2];const nn=Pt[3];nn!=null&&(C.la=nn,C.j.info("VER="+C.la));const Yr=Pt[4];Yr!=null&&(C.Aa=Yr,C.j.info("SVER="+C.Aa));const Yi=Pt[5];Yi!=null&&typeof Yi=="number"&&0<Yi&&(j=1.5*Yi,C.L=j,C.j.info("backChannelRequestTimeoutMs_="+j)),j=C;const dn=p.g;if(dn){const xi=dn.g?dn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(xi){var be=j.h;be.g||xi.indexOf("spdy")==-1&&xi.indexOf("quic")==-1&&xi.indexOf("h2")==-1||(be.j=be.l,be.g=new Set,be.h&&(Hl(be,be.h),be.h=null))}if(j.D){const bu=dn.g?dn.g.getResponseHeader("X-HTTP-Session-Id"):null;bu&&(j.ya=bu,er(j.I,j.D,bu))}}C.G=3,C.l&&C.l.ua(),C.ba&&(C.R=Date.now()-p.F,C.j.info("Handshake RTT: "+C.R+"ms")),j=C;var Ge=p;if(j.qa=q0(j,j.J?j.ia:null,j.W),Ge.K){jn(j.h,Ge);var Ft=Ge,Kr=j.L;Kr&&(Ft.I=Kr),Ft.B&&(jt(Ft),We(Ft)),j.g=Ge}else j0(j);0<C.i.length&&$l(C)}else Pt[0]!="stop"&&Pt[0]!="close"||Ki(C,7);else C.G==3&&(Pt[0]=="stop"||Pt[0]=="close"?Pt[0]=="stop"?Ki(C,7):yu(C):Pt[0]!="noop"&&C.l&&C.l.ta(Pt),C.v=0)}}li(4)}catch{}}var ci=class{constructor(p,T){this.g=p,this.map=T}};function Bn(p){this.l=p||10,u.PerformanceNavigationTiming?(p=u.performance.getEntriesByType("navigation"),p=0<p.length&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function $n(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function ui(p){return p.h?1:p.g?p.g.size:0}function Vn(p,T){return p.h?p.h==T:p.g?p.g.has(T):!1}function Hl(p,T){p.g?p.g.add(T):p.h=T}function jn(p,T){p.h&&p.h==T?p.h=null:p.g&&p.g.has(T)&&p.g.delete(T)}Bn.prototype.cancel=function(){if(this.i=du(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function du(p){if(p.h!=null)return p.i.concat(p.h.D);if(p.g!=null&&p.g.size!==0){let T=p.i;for(const C of p.g.values())T=T.concat(C.D);return T}return w(p.i)}function jm(p){if(p.V&&typeof p.V=="function")return p.V();if(typeof Map<"u"&&p instanceof Map||typeof Set<"u"&&p instanceof Set)return Array.from(p.values());if(typeof p=="string")return p.split("");if(f(p)){for(var T=[],C=p.length,j=0;j<C;j++)T.push(p[j]);return T}T=[],C=0;for(j in p)T[C++]=p[j];return T}function zl(p){if(p.na&&typeof p.na=="function")return p.na();if(!p.V||typeof p.V!="function"){if(typeof Map<"u"&&p instanceof Map)return Array.from(p.keys());if(!(typeof Set<"u"&&p instanceof Set)){if(f(p)||typeof p=="string"){var T=[];p=p.length;for(var C=0;C<p;C++)T.push(C);return T}T=[],C=0;for(const j in p)T[C++]=j;return T}}}function mu(p,T){if(p.forEach&&typeof p.forEach=="function")p.forEach(T,void 0);else if(f(p)||typeof p=="string")Array.prototype.forEach.call(p,T,void 0);else for(var C=zl(p),j=jm(p),fe=j.length,be=0;be<fe;be++)T.call(void 0,j[be],C&&C[be],p)}var Po=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Hm(p,T){if(p){p=p.split("&");for(var C=0;C<p.length;C++){var j=p[C].indexOf("="),fe=null;if(0<=j){var be=p[C].substring(0,j);fe=p[C].substring(j+1)}else be=p[C];T(be,fe?decodeURIComponent(fe.replace(/\+/g," ")):"")}}}function Ur(p){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,p instanceof Ur){this.h=p.h,Lo(this,p.j),this.o=p.o,this.g=p.g,ks(this,p.s),this.l=p.l;var T=p.i,C=new Gi;C.i=T.i,T.g&&(C.g=new Map(T.g),C.h=T.h),zi(this,C),this.m=p.m}else p&&(T=String(p).match(Po))?(this.h=!1,Lo(this,T[1]||"",!0),this.o=ba(T[2]||""),this.g=ba(T[3]||"",!0),ks(this,T[4]),this.l=ba(T[5]||"",!0),zi(this,T[6]||"",!0),this.m=ba(T[7]||"")):(this.h=!1,this.i=new Gi(null,this.h))}Ur.prototype.toString=function(){var p=[],T=this.j;T&&p.push(Uo(T,pu,!0),":");var C=this.g;return(C||T=="file")&&(p.push("//"),(T=this.o)&&p.push(Uo(T,pu,!0),"@"),p.push(encodeURIComponent(String(C)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),C=this.s,C!=null&&p.push(":",String(C))),(C=this.l)&&(this.g&&C.charAt(0)!="/"&&p.push("/"),p.push(Uo(C,C.charAt(0)=="/"?zm:gu,!0))),(C=this.i.toString())&&p.push("?",C),(C=this.m)&&p.push("#",Uo(C,Gl)),p.join("")};function sa(p){return new Ur(p)}function Lo(p,T,C){p.j=C?ba(T,!0):T,p.j&&(p.j=p.j.replace(/:$/,""))}function ks(p,T){if(T){if(T=Number(T),isNaN(T)||0>T)throw Error("Bad port number "+T);p.s=T}else p.s=null}function zi(p,T,C){T instanceof Gi?(p.i=T,L0(p.i,p.h)):(C||(T=Uo(T,Gm)),p.i=new Gi(T,p.h))}function er(p,T,C){p.i.set(T,C)}function Mo(p){return er(p,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),p}function ba(p,T){return p?T?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function Uo(p,T,C){return typeof p=="string"?(p=encodeURI(p).replace(T,P0),C&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function P0(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var pu=/[#\/\?@]/g,gu=/[#\?:]/g,zm=/[#\?]/g,Gm=/[#\?@]/g,Gl=/#/g;function Gi(p,T){this.h=this.g=null,this.i=p||null,this.j=!!T}function Sa(p){p.g||(p.g=new Map,p.h=0,p.i&&Hm(p.i,function(T,C){p.add(decodeURIComponent(T.replace(/\+/g," ")),C)}))}t=Gi.prototype,t.add=function(p,T){Sa(this),this.i=null,p=fi(this,p);var C=this.g.get(p);return C||this.g.set(p,C=[]),C.push(T),this.h+=1,this};function qi(p,T){Sa(p),T=fi(p,T),p.g.has(T)&&(p.i=null,p.h-=p.g.get(T).length,p.g.delete(T))}function Wi(p,T){return Sa(p),T=fi(p,T),p.g.has(T)}t.forEach=function(p,T){Sa(this),this.g.forEach(function(C,j){C.forEach(function(fe){p.call(T,fe,j,this)},this)},this)},t.na=function(){Sa(this);const p=Array.from(this.g.values()),T=Array.from(this.g.keys()),C=[];for(let j=0;j<T.length;j++){const fe=p[j];for(let be=0;be<fe.length;be++)C.push(T[j])}return C},t.V=function(p){Sa(this);let T=[];if(typeof p=="string")Wi(this,p)&&(T=T.concat(this.g.get(fi(this,p))));else{p=Array.from(this.g.values());for(let C=0;C<p.length;C++)T=T.concat(p[C])}return T},t.set=function(p,T){return Sa(this),this.i=null,p=fi(this,p),Wi(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[T]),this.h+=1,this},t.get=function(p,T){return p?(p=this.V(p),0<p.length?String(p[0]):T):T};function xu(p,T,C){qi(p,T),0<C.length&&(p.i=null,p.g.set(fi(p,T),w(C)),p.h+=C.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],T=Array.from(this.g.keys());for(var C=0;C<T.length;C++){var j=T[C];const be=encodeURIComponent(String(j)),Ge=this.V(j);for(j=0;j<Ge.length;j++){var fe=be;Ge[j]!==""&&(fe+="="+encodeURIComponent(String(Ge[j]))),p.push(fe)}}return this.i=p.join("&")};function fi(p,T){return T=String(T),p.j&&(T=T.toLowerCase()),T}function L0(p,T){T&&!p.j&&(Sa(p),p.i=null,p.g.forEach(function(C,j){var fe=j.toLowerCase();j!=fe&&(qi(this,j),xu(this,fe,C))},p)),p.j=T}function Bo(p,T){const C=new Yn;if(u.Image){const j=new Image;j.onload=E(Aa,C,"TestLoadImage: loaded",!0,T,j),j.onerror=E(Aa,C,"TestLoadImage: error",!1,T,j),j.onabort=E(Aa,C,"TestLoadImage: abort",!1,T,j),j.ontimeout=E(Aa,C,"TestLoadImage: timeout",!1,T,j),u.setTimeout(function(){j.ontimeout&&j.ontimeout()},1e4),j.src=p}else T(!1)}function Xa(p,T){const C=new Yn,j=new AbortController,fe=setTimeout(()=>{j.abort(),Aa(C,"TestPingServer: timeout",!1,T)},1e4);fetch(p,{signal:j.signal}).then(be=>{clearTimeout(fe),be.ok?Aa(C,"TestPingServer: ok",!0,T):Aa(C,"TestPingServer: server error",!1,T)}).catch(()=>{clearTimeout(fe),Aa(C,"TestPingServer: error",!1,T)})}function Aa(p,T,C,j,fe){try{fe&&(fe.onload=null,fe.onerror=null,fe.onabort=null,fe.ontimeout=null),j(C)}catch{}}function Vo(){this.g=new Hi}function hi(p,T,C){const j=C||"";try{mu(p,function(fe,be){let Ge=fe;d(fe)&&(Ge=qt(fe)),T.push(j+be+"="+encodeURIComponent(Ge))})}catch(fe){throw T.push(j+"type="+encodeURIComponent("_badmap")),fe}}function Cs(p){this.l=p.Ub||null,this.j=p.eb||!1}S(Cs,Ts),Cs.prototype.g=function(){return new Xi(this.l,this.j)},Cs.prototype.i=function(p){return function(){return p}}({});function Xi(p,T){Ut.call(this),this.D=p,this.o=T,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}S(Xi,Ut),t=Xi.prototype,t.open=function(p,T){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=p,this.A=T,this.readyState=1,mi(this)},t.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const T={headers:this.u,method:this.B,credentials:this.m,cache:void 0};p&&(T.body=p),(this.D||u).fetch(new Request(this.A,T)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,di(this)),this.readyState=0},t.Sa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,mi(this)),this.g&&(this.readyState=3,mi(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;vu(this)}else p.text().then(this.Ra.bind(this),this.ga.bind(this))};function vu(p){p.j.read().then(p.Pa.bind(p)).catch(p.ga.bind(p))}t.Pa=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var T=p.value?p.value:new Uint8Array(0);(T=this.v.decode(T,{stream:!p.done}))&&(this.response=this.responseText+=T)}p.done?di(this):mi(this),this.readyState==3&&vu(this)}},t.Ra=function(p){this.g&&(this.response=this.responseText=p,di(this))},t.Qa=function(p){this.g&&(this.response=p,di(this))},t.ga=function(){this.g&&di(this)};function di(p){p.readyState=4,p.l=null,p.j=null,p.v=null,mi(p)}t.setRequestHeader=function(p,T){this.u.append(p,T)},t.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],T=this.h.entries();for(var C=T.next();!C.done;)C=C.value,p.push(C[0]+": "+C[1]),C=T.next();return p.join(`\r
`)};function mi(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty(Xi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function _u(p){let T="";return W(p,function(C,j){T+=j,T+=":",T+=C,T+=`\r
`}),T}function rn(p,T,C){e:{for(j in C){var j=!1;break e}j=!0}j||(C=_u(C),typeof p=="string"?C!=null&&encodeURIComponent(String(C)):er(p,T,C))}function Wt(p){Ut.call(this),this.headers=new Map,this.o=p||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}S(Wt,Ut);var ql=/^https?$/i,jo=["POST","PUT"];t=Wt.prototype,t.Ha=function(p){this.J=p},t.ea=function(p,T,C,j){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);T=T?T.toUpperCase():"GET",this.D=p,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():J.g(),this.v=this.o?bs(this.o):bs(J),this.g.onreadystatechange=_(this.Ea,this);try{this.B=!0,this.g.open(T,String(p),!0),this.B=!1}catch(be){M0(this,be);return}if(p=C||"",C=new Map(this.headers),j)if(Object.getPrototypeOf(j)===Object.prototype)for(var fe in j)C.set(fe,j[fe]);else if(typeof j.keys=="function"&&typeof j.get=="function")for(const be of j.keys())C.set(be,j.get(be));else throw Error("Unknown input type for opt_headers: "+String(j));j=Array.from(C.keys()).find(be=>be.toLowerCase()=="content-type"),fe=u.FormData&&p instanceof u.FormData,!(0<=Array.prototype.indexOf.call(jo,T,void 0))||j||fe||C.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[be,Ge]of C)this.g.setRequestHeader(be,Ge);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Ho(this),this.u=!0,this.g.send(p),this.u=!1}catch(be){M0(this,be)}};function M0(p,T){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=T,p.m=5,Wl(p),pi(p)}function Wl(p){p.A||(p.A=!0,kt(p,"complete"),kt(p,"error"))}t.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=p||7,kt(this,"complete"),kt(this,"abort"),pi(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),pi(this,!0)),Wt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Xl(this):this.bb())},t.bb=function(){Xl(this)};function Xl(p){if(p.h&&typeof l<"u"&&(!p.v[1]||ka(p)!=4||p.Z()!=2)){if(p.u&&ka(p)==4)Me(p.Ea,0,p);else if(kt(p,"readystatechange"),ka(p)==4){p.h=!1;try{const Ge=p.Z();e:switch(Ge){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var T=!0;break e;default:T=!1}var C;if(!(C=T)){var j;if(j=Ge===0){var fe=String(p.D).match(Po)[1]||null;!fe&&u.self&&u.self.location&&(fe=u.self.location.protocol.slice(0,-1)),j=!ql.test(fe?fe.toLowerCase():"")}C=j}if(C)kt(p,"complete"),kt(p,"success");else{p.m=6;try{var be=2<ka(p)?p.g.statusText:""}catch{be=""}p.l=be+" ["+p.Z()+"]",Wl(p)}}finally{pi(p)}}}}function pi(p,T){if(p.g){Ho(p);const C=p.g,j=p.v[0]?()=>{}:null;p.g=null,p.v=null,T||kt(p,"ready");try{C.onreadystatechange=j}catch{}}}function Ho(p){p.I&&(u.clearTimeout(p.I),p.I=null)}t.isActive=function(){return!!this.g};function ka(p){return p.g?p.g.readyState:0}t.Z=function(){try{return 2<ka(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(p){if(this.g){var T=this.g.responseText;return p&&T.indexOf(p)==0&&(T=T.substring(p.length)),Un(T)}};function U0(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.H){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function qm(p){const T={};p=(p.g&&2<=ka(p)&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let j=0;j<p.length;j++){if(B(p[j]))continue;var C=M(p[j]);const fe=C[0];if(C=C[1],typeof C!="string")continue;C=C.trim();const be=T[fe]||[];T[fe]=be,be.push(C)}k(T,function(j){return j.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function zo(p,T,C){return C&&C.internalChannelParams&&C.internalChannelParams[p]||T}function Kl(p){this.Aa=0,this.i=[],this.j=new Yn,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=zo("failFast",!1,p),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=zo("baseRetryDelayMs",5e3,p),this.cb=zo("retryDelaySeedMs",1e4,p),this.Wa=zo("forwardChannelMaxRetries",2,p),this.wa=zo("forwardChannelRequestTimeoutMs",2e4,p),this.pa=p&&p.xmlHttpFactory||void 0,this.Xa=p&&p.Tb||void 0,this.Ca=p&&p.useFetchStreams||!1,this.L=void 0,this.J=p&&p.supportsCrossDomainXhr||!1,this.K="",this.h=new Bn(p&&p.concurrentRequestLimit),this.Da=new Vo,this.P=p&&p.fastHandshake||!1,this.O=p&&p.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=p&&p.Rb||!1,p&&p.xa&&this.j.xa(),p&&p.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&p&&p.detectBufferingProxy||!1,this.ja=void 0,p&&p.longPollingTimeout&&0<p.longPollingTimeout&&(this.ja=p.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Kl.prototype,t.la=8,t.G=1,t.connect=function(p,T,C,j){or(0),this.W=p,this.H=T||{},C&&j!==void 0&&(this.H.OSID=C,this.H.OAID=j),this.F=this.X,this.I=q0(this,null,this.W),$l(this)};function yu(p){if(B0(p),p.G==3){var T=p.U++,C=sa(p.I);if(er(C,"SID",p.K),er(C,"RID",T),er(C,"TYPE","terminate"),Go(p,C),T=new Te(p,p.j,T),T.L=2,T.v=Mo(sa(C)),C=!1,u.navigator&&u.navigator.sendBeacon)try{C=u.navigator.sendBeacon(T.v.toString(),"")}catch{}!C&&u.Image&&(new Image().src=T.v,C=!0),C||(T.g=W0(T.j,null),T.g.ea(T.v)),T.F=Date.now(),We(T)}G0(p)}function Yl(p){p.g&&(qo(p),p.g.cancel(),p.g=null)}function B0(p){Yl(p),p.u&&(u.clearTimeout(p.u),p.u=null),Ql(p),p.h.cancel(),p.s&&(typeof p.s=="number"&&u.clearTimeout(p.s),p.s=null)}function $l(p){if(!$n(p.h)&&!p.s){p.s=!0;var T=p.Ga;ue||ee(),Ve||(ue(),Ve=!0),ie.add(T,p),p.B=0}}function Wm(p,T){return ui(p.h)>=p.h.j-(p.s?1:0)?!1:p.s?(p.i=T.D.concat(p.i),!0):p.G==1||p.G==2||p.B>=(p.Va?0:p.Wa)?!1:(p.s=mr(_(p.Ga,p,T),Tu(p,p.B)),p.B++,!0)}t.Ga=function(p){if(this.s)if(this.s=null,this.G==1){if(!p){this.U=Math.floor(1e5*Math.random()),p=this.U++;const fe=new Te(this,this.j,p);let be=this.o;if(this.S&&(be?(be=I(be),O(be,this.S)):be=this.S),this.m!==null||this.O||(fe.H=be,be=null),this.P)e:{for(var T=0,C=0;C<this.i.length;C++){t:{var j=this.i[C];if("__data__"in j.map&&(j=j.map.__data__,typeof j=="string")){j=j.length;break t}j=void 0}if(j===void 0)break;if(T+=j,4096<T){T=C;break e}if(T===4096||C===this.i.length-1){T=C+1;break e}}T=1e3}else T=1e3;T=V0(this,fe,T),C=sa(this.I),er(C,"RID",p),er(C,"CVER",22),this.D&&er(C,"X-HTTP-Session-Id",this.D),Go(this,C),be&&(this.O?T="headers="+encodeURIComponent(String(_u(be)))+"&"+T:this.m&&rn(C,this.m,be)),Hl(this.h,fe),this.Ua&&er(C,"TYPE","init"),this.P?(er(C,"$req",T),er(C,"SID","null"),fe.T=!0,Le(fe,C,null)):Le(fe,C,T),this.G=2}}else this.G==3&&(p?wu(this,p):this.i.length==0||$n(this.h)||wu(this))};function wu(p,T){var C;T?C=T.l:C=p.U++;const j=sa(p.I);er(j,"SID",p.K),er(j,"RID",C),er(j,"AID",p.T),Go(p,j),p.m&&p.o&&rn(j,p.m,p.o),C=new Te(p,p.j,C,p.B+1),p.m===null&&(C.H=p.o),T&&(p.i=T.D.concat(p.i)),T=V0(p,C,1e3),C.I=Math.round(.5*p.wa)+Math.round(.5*p.wa*Math.random()),Hl(p.h,C),Le(C,j,T)}function Go(p,T){p.H&&W(p.H,function(C,j){er(T,j,C)}),p.l&&mu({},function(C,j){er(T,j,C)})}function V0(p,T,C){C=Math.min(p.i.length,C);var j=p.l?_(p.l.Na,p.l,p):null;e:{var fe=p.i;let be=-1;for(;;){const Ge=["count="+C];be==-1?0<C?(be=fe[0].g,Ge.push("ofs="+be)):be=0:Ge.push("ofs="+be);let Ft=!0;for(let Kr=0;Kr<C;Kr++){let Pt=fe[Kr].g;const nn=fe[Kr].map;if(Pt-=be,0>Pt)be=Math.max(0,fe[Kr].g-100),Ft=!1;else try{hi(nn,Ge,"req"+Pt+"_")}catch{j&&j(nn)}}if(Ft){j=Ge.join("&");break e}}}return p=p.i.splice(0,C),T.D=p,j}function j0(p){if(!p.g&&!p.u){p.Y=1;var T=p.Fa;ue||ee(),Ve||(ue(),Ve=!0),ie.add(T,p),p.v=0}}function Eu(p){return p.g||p.u||3<=p.v?!1:(p.Y++,p.u=mr(_(p.Fa,p),Tu(p,p.v)),p.v++,!0)}t.Fa=function(){if(this.u=null,H0(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var p=2*this.R;this.j.info("BP detection timer enabled: "+p),this.A=mr(_(this.ab,this),p)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,or(10),Yl(this),H0(this))};function qo(p){p.A!=null&&(u.clearTimeout(p.A),p.A=null)}function H0(p){p.g=new Te(p,p.j,"rpc",p.Y),p.m===null&&(p.g.H=p.o),p.g.O=0;var T=sa(p.qa);er(T,"RID","rpc"),er(T,"SID",p.K),er(T,"AID",p.T),er(T,"CI",p.F?"0":"1"),!p.F&&p.ja&&er(T,"TO",p.ja),er(T,"TYPE","xmlhttp"),Go(p,T),p.m&&p.o&&rn(T,p.m,p.o),p.L&&(p.g.I=p.L);var C=p.g;p=p.ia,C.L=1,C.v=Mo(sa(T)),C.m=null,C.P=!0,He(C,p)}t.Za=function(){this.C!=null&&(this.C=null,Yl(this),Eu(this),or(19))};function Ql(p){p.C!=null&&(u.clearTimeout(p.C),p.C=null)}function z0(p,T){var C=null;if(p.g==T){Ql(p),qo(p),p.g=null;var j=2}else if(Vn(p.h,T))C=T.D,jn(p.h,T),j=1;else return;if(p.G!=0){if(T.o)if(j==1){C=T.m?T.m.length:0,T=Date.now()-T.F;var fe=p.B;j=oi(),kt(j,new Nr(j,C)),$l(p)}else j0(p);else if(fe=T.s,fe==3||fe==0&&0<T.X||!(j==1&&Wm(p,T)||j==2&&Eu(p)))switch(C&&0<C.length&&(T=p.h,T.i=T.i.concat(C)),fe){case 1:Ki(p,5);break;case 4:Ki(p,10);break;case 3:Ki(p,6);break;default:Ki(p,2)}}}function Tu(p,T){let C=p.Ta+Math.floor(Math.random()*p.cb);return p.isActive()||(C*=2),C*T}function Ki(p,T){if(p.j.info("Error code "+T),T==2){var C=_(p.fb,p),j=p.Xa;const fe=!j;j=new Ur(j||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||Lo(j,"https"),Mo(j),fe?Bo(j.toString(),C):Xa(j.toString(),C)}else or(2);p.G=0,p.l&&p.l.sa(T),G0(p),B0(p)}t.fb=function(p){p?(this.j.info("Successfully pinged google.com"),or(2)):(this.j.info("Failed to ping google.com"),or(1))};function G0(p){if(p.G=0,p.ka=[],p.l){const T=du(p.h);(T.length!=0||p.i.length!=0)&&(b(p.ka,T),b(p.ka,p.i),p.h.i.length=0,w(p.i),p.i.length=0),p.l.ra()}}function q0(p,T,C){var j=C instanceof Ur?sa(C):new Ur(C);if(j.g!="")T&&(j.g=T+"."+j.g),ks(j,j.s);else{var fe=u.location;j=fe.protocol,T=T?T+"."+fe.hostname:fe.hostname,fe=+fe.port;var be=new Ur(null);j&&Lo(be,j),T&&(be.g=T),fe&&ks(be,fe),C&&(be.l=C),j=be}return C=p.D,T=p.ya,C&&T&&er(j,C,T),er(j,"VER",p.la),Go(p,j),j}function W0(p,T,C){if(T&&!p.J)throw Error("Can't create secondary domain capable XhrIo object.");return T=p.Ca&&!p.pa?new Wt(new Cs({eb:C})):new Wt(p.pa),T.Ha(p.J),T}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function X0(){}t=X0.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Zl(){}Zl.prototype.g=function(p,T){return new Hn(p,T)};function Hn(p,T){Ut.call(this),this.g=new Kl(T),this.l=p,this.h=T&&T.messageUrlParams||null,p=T&&T.messageHeaders||null,T&&T.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=T&&T.initMessageHeaders||null,T&&T.messageContentType&&(p?p["X-WebChannel-Content-Type"]=T.messageContentType:p={"X-WebChannel-Content-Type":T.messageContentType}),T&&T.va&&(p?p["X-WebChannel-Client-Profile"]=T.va:p={"X-WebChannel-Client-Profile":T.va}),this.g.S=p,(p=T&&T.Sb)&&!B(p)&&(this.g.m=p),this.v=T&&T.supportsCrossDomainXhr||!1,this.u=T&&T.sendRawJson||!1,(T=T&&T.httpSessionIdParam)&&!B(T)&&(this.g.D=T,p=this.h,p!==null&&T in p&&(p=this.h,T in p&&delete p[T])),this.j=new gi(this)}S(Hn,Ut),Hn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Hn.prototype.close=function(){yu(this.g)},Hn.prototype.o=function(p){var T=this.g;if(typeof p=="string"){var C={};C.__data__=p,p=C}else this.u&&(C={},C.__data__=qt(p),p=C);T.i.push(new ci(T.Ya++,p)),T.G==3&&$l(T)},Hn.prototype.N=function(){this.g.l=null,delete this.j,yu(this.g),delete this.g,Hn.aa.N.call(this)};function K0(p){Wa.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var T=p.__sm__;if(T){e:{for(const C in T){p=C;break e}p=void 0}(this.i=p)&&(p=this.i,T=T!==null&&p in T?T[p]:void 0),this.data=T}else this.data=p}S(K0,Wa);function Y0(){si.call(this),this.status=1}S(Y0,si);function gi(p){this.g=p}S(gi,X0),gi.prototype.ua=function(){kt(this.g,"a")},gi.prototype.ta=function(p){kt(this.g,new K0(p))},gi.prototype.sa=function(p){kt(this.g,new Y0)},gi.prototype.ra=function(){kt(this.g,"b")},Zl.prototype.createWebChannel=Zl.prototype.g,Hn.prototype.send=Hn.prototype.o,Hn.prototype.open=Hn.prototype.m,Hn.prototype.close=Hn.prototype.close,Fb=function(){return new Zl},Ob=function(){return oi()},Db=Ta,k1={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},G.NO_ERROR=0,G.TIMEOUT=8,G.HTTP_ERROR=6,xd=G,Q.COMPLETE="complete",Ib=Q,Ss.EventType=qa,qa.OPEN="a",qa.CLOSE="b",qa.ERROR="c",qa.MESSAGE="d",Ut.prototype.listen=Ut.prototype.K,xf=Ss,Wt.prototype.listenOnce=Wt.prototype.L,Wt.prototype.getLastError=Wt.prototype.Ka,Wt.prototype.getLastErrorCode=Wt.prototype.Ba,Wt.prototype.getStatus=Wt.prototype.Z,Wt.prototype.getResponseJson=Wt.prototype.Oa,Wt.prototype.getResponseText=Wt.prototype.oa,Wt.prototype.send=Wt.prototype.ea,Wt.prototype.setWithCredentials=Wt.prototype.Ha,Nb=Wt}).apply(typeof $h<"u"?$h:typeof self<"u"?self:typeof window<"u"?window:{});const Ow="@firebase/firestore",Fw="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Cn.UNAUTHENTICATED=new Cn(null),Cn.GOOGLE_CREDENTIALS=new Cn("google-credentials-uid"),Cn.FIRST_PARTY=new Cn("first-party-uid"),Cn.MOCK_USER=new Cn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ru="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vl=new mx("@firebase/firestore");function Nc(){return vl.logLevel}function Ye(t,...e){if(vl.logLevel<=Nt.DEBUG){const r=e.map(vx);vl.debug(`Firestore (${ru}): ${t}`,...r)}}function gs(t,...e){if(vl.logLevel<=Nt.ERROR){const r=e.map(vx);vl.error(`Firestore (${ru}): ${t}`,...r)}}function mo(t,...e){if(vl.logLevel<=Nt.WARN){const r=e.map(vx);vl.warn(`Firestore (${ru}): ${t}`,...r)}}function vx(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ct(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,Pb(t,n,r)}function Pb(t,e,r){let n=`FIRESTORE (${ru}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw gs(n),new Error(n)}function Xt(t,e,r,n){let a="Unexpected state";typeof r=="string"?a=r:n=r,t||Pb(e,a,n)}function xt(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ne={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class $e extends Bi{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uo{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lb{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class FN{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Cn.UNAUTHENTICATED))}shutdown(){}}class PN{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class LN{constructor(e){this.t=e,this.currentUser=Cn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Xt(this.o===void 0,42304);let n=this.i;const a=f=>this.i!==n?(n=this.i,r(f)):Promise.resolve();let o=new uo;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new uo,e.enqueueRetryable(()=>a(this.currentUser))};const l=()=>{const f=o;e.enqueueRetryable(async()=>{await f.promise,await a(this.currentUser)})},u=f=>{Ye("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit(f=>u(f)),setTimeout(()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?u(f):(Ye("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new uo)}},0),l()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Ye("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Xt(typeof n.accessToken=="string",31837,{l:n}),new Lb(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Xt(e===null||typeof e=="string",2055,{h:e}),new Cn(e)}}class MN{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=Cn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class UN{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new MN(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(Cn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Pw{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class BN{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ga(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){Xt(this.o===void 0,3512);const n=o=>{o.error!=null&&Ye("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const l=o.token!==this.m;return this.m=o.token,Ye("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?r(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>n(o))};const a=o=>{Ye("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>a(o)),setTimeout(()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?a(o):Ye("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Pw(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(Xt(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new Pw(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VN(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mb(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _x{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const a=VN(40);for(let o=0;o<a.length;++o)n.length<20&&a[o]<r&&(n+=e.charAt(a[o]%62))}return n}}function Tt(t,e){return t<e?-1:t>e?1:0}function C1(t,e){let r=0;for(;r<t.length&&r<e.length;){const n=t.codePointAt(r),a=e.codePointAt(r);if(n!==a){if(n<128&&a<128)return Tt(n,a);{const o=Mb(),l=jN(o.encode(Lw(t,r)),o.encode(Lw(e,r)));return l!==0?l:Tt(n,a)}}r+=n>65535?2:1}return Tt(t.length,e.length)}function Lw(t,e){return t.codePointAt(e)>65535?t.substring(e,e+2):t.substring(e,e+1)}function jN(t,e){for(let r=0;r<t.length&&r<e.length;++r)if(t[r]!==e[r])return Tt(t[r],e[r]);return Tt(t.length,e.length)}function Kc(t,e,r){return t.length===e.length&&t.every((n,a)=>r(n,e[a]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mw="__name__";class Ai{constructor(e,r,n){r===void 0?r=0:r>e.length&&ct(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&ct(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Ai.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Ai?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let a=0;a<n;a++){const o=Ai.compareSegments(e.get(a),r.get(a));if(o!==0)return o}return Tt(e.length,r.length)}static compareSegments(e,r){const n=Ai.isNumericId(e),a=Ai.isNumericId(r);return n&&!a?-1:!n&&a?1:n&&a?Ai.extractNumericId(e).compare(Ai.extractNumericId(r)):C1(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return co.fromString(e.substring(4,e.length-2))}}class cr extends Ai{construct(e,r,n){return new cr(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new $e(Ne.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(a=>a.length>0))}return new cr(r)}static emptyPath(){return new cr([])}}const HN=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class yn extends Ai{construct(e,r,n){return new yn(e,r,n)}static isValidIdentifier(e){return HN.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),yn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Mw}static keyField(){return new yn([Mw])}static fromServerFormat(e){const r=[];let n="",a=0;const o=()=>{if(n.length===0)throw new $e(Ne.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let l=!1;for(;a<e.length;){const u=e[a];if(u==="\\"){if(a+1===e.length)throw new $e(Ne.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[a+1];if(f!=="\\"&&f!=="."&&f!=="`")throw new $e(Ne.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=f,a+=2}else u==="`"?(l=!l,a++):u!=="."||l?(n+=u,a++):(o(),a++)}if(o(),l)throw new $e(Ne.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new yn(r)}static emptyPath(){return new yn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tt{constructor(e){this.path=e}static fromPath(e){return new tt(cr.fromString(e))}static fromName(e){return new tt(cr.fromString(e).popFirst(5))}static empty(){return new tt(cr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&cr.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return cr.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new tt(new cr(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ub(t,e,r){if(!r)throw new $e(Ne.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function zN(t,e,r,n){if(e===!0&&n===!0)throw new $e(Ne.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function Uw(t){if(!tt.isDocumentKey(t))throw new $e(Ne.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Bw(t){if(tt.isDocumentKey(t))throw new $e(Ne.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Bb(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function um(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ct(12329,{type:typeof t})}function _l(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new $e(Ne.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=um(t);throw new $e(Ne.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wr(t,e){const r={typeString:t};return e&&(r.value=e),r}function h0(t,e){if(!Bb(t))throw new $e(Ne.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const a=e[n].typeString,o="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const l=t[n];if(a&&typeof l!==a){r=`JSON field '${n}' must be a ${a}.`;break}if(o!==void 0&&l!==o.value){r=`Expected '${n}' field to equal '${o.value}'`;break}}if(r)throw new $e(Ne.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vw=-62135596800,jw=1e6;class fr{static now(){return fr.fromMillis(Date.now())}static fromDate(e){return fr.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*jw);return new fr(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new $e(Ne.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new $e(Ne.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<Vw)throw new $e(Ne.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new $e(Ne.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/jw}_compareTo(e){return this.seconds===e.seconds?Tt(this.nanoseconds,e.nanoseconds):Tt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:fr._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(h0(e,fr._jsonSchema))return new fr(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Vw;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}fr._jsonSchemaVersion="firestore/timestamp/1.0",fr._jsonSchema={type:Wr("string",fr._jsonSchemaVersion),seconds:Wr("number"),nanoseconds:Wr("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gt{static fromTimestamp(e){return new gt(e)}static min(){return new gt(new fr(0,0))}static max(){return new gt(new fr(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hf=-1;function GN(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,a=gt.fromTimestamp(n===1e9?new fr(r+1,0):new fr(r,n));return new po(a,tt.empty(),e)}function qN(t){return new po(t.readTime,t.key,Hf)}class po{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new po(gt.min(),tt.empty(),Hf)}static max(){return new po(gt.max(),tt.empty(),Hf)}}function WN(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=tt.comparator(t.documentKey,e.documentKey),r!==0?r:Tt(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XN="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class KN{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nu(t){if(t.code!==Ne.FAILED_PRECONDITION||t.message!==XN)throw t;Ye("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&ct(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Oe((n,a)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(n,a)},this.catchCallback=o=>{this.wrapFailure(r,o).next(n,a)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof Oe?r:Oe.resolve(r)}catch(r){return Oe.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):Oe.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):Oe.reject(r)}static resolve(e){return new Oe((r,n)=>{r(e)})}static reject(e){return new Oe((r,n)=>{n(e)})}static waitFor(e){return new Oe((r,n)=>{let a=0,o=0,l=!1;e.forEach(u=>{++a,u.next(()=>{++o,l&&o===a&&r()},f=>n(f))}),l=!0,o===a&&r()})}static or(e){let r=Oe.resolve(!1);for(const n of e)r=r.next(a=>a?Oe.resolve(a):n());return r}static forEach(e,r){const n=[];return e.forEach((a,o)=>{n.push(r.call(this,a,o))}),this.waitFor(n)}static mapArray(e,r){return new Oe((n,a)=>{const o=e.length,l=new Array(o);let u=0;for(let f=0;f<o;f++){const d=f;r(e[d]).next(m=>{l[d]=m,++u,u===o&&n(l)},m=>a(m))}})}static doWhile(e,r){return new Oe((n,a)=>{const o=()=>{e()===!0?r().next(()=>{o()},a):n()};o()})}}function YN(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function au(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fm{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this._e(n),this.ae=n=>r.writeSequenceNumber(n))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}fm.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yx=-1;function hm(t){return t==null}function Id(t){return t===0&&1/t==-1/0}function $N(t){return typeof t=="number"&&Number.isInteger(t)&&!Id(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vb="";function QN(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=Hw(e)),e=ZN(t.get(r),e);return Hw(e)}function ZN(t,e){let r=e;const n=t.length;for(let a=0;a<n;a++){const o=t.charAt(a);switch(o){case"\0":r+="";break;case Vb:r+="";break;default:r+=o}}return r}function Hw(t){return t+Vb+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zw(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Ao(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function jb(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yr{constructor(e,r){this.comparator=e,this.root=r||vn.EMPTY}insert(e,r){return new yr(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,vn.BLACK,null,null))}remove(e){return new yr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,vn.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const a=this.comparator(e,n.key);if(a===0)return r+n.left.size;a<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Qh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Qh(this.root,e,this.comparator,!1)}getReverseIterator(){return new Qh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Qh(this.root,e,this.comparator,!0)}}class Qh{constructor(e,r,n,a){this.isReverse=a,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=r?n(e.key,r):1,r&&a&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class vn{constructor(e,r,n,a,o){this.key=e,this.value=r,this.color=n??vn.RED,this.left=a??vn.EMPTY,this.right=o??vn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,a,o){return new vn(e??this.key,r??this.value,n??this.color,a??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let a=this;const o=n(e,a.key);return a=o<0?a.copy(null,null,null,a.left.insert(e,r,n),null):o===0?a.copy(null,r,null,null,null):a.copy(null,null,null,null,a.right.insert(e,r,n)),a.fixUp()}removeMin(){if(this.left.isEmpty())return vn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,a=this;if(r(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,r),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),r(e,a.key)===0){if(a.right.isEmpty())return vn.EMPTY;n=a.right.min(),a=a.copy(n.key,n.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,r))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,vn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,vn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ct(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ct(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ct(27949);return e+(this.isRed()?0:1)}}vn.EMPTY=null,vn.RED=!0,vn.BLACK=!1;vn.EMPTY=new class{constructor(){this.size=0}get key(){throw ct(57766)}get value(){throw ct(16141)}get color(){throw ct(16727)}get left(){throw ct(29726)}get right(){throw ct(36894)}copy(e,r,n,a,o){return this}insert(e,r,n){return new vn(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en{constructor(e){this.comparator=e,this.data=new yr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const a=n.getNext();if(this.comparator(a.key,e[1])>=0)return;r(a.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new Gw(this.data.getIterator())}getIteratorFrom(e){return new Gw(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof en)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const a=r.getNext().key,o=n.getNext().key;if(this.comparator(a,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new en(this.comparator);return r.data=e,r}}class Gw{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _a{constructor(e){this.fields=e,e.sort(yn.comparator)}static empty(){return new _a([])}unionWith(e){let r=new en(yn.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new _a(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Kc(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hb extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class En{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(a){try{return atob(a)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new Hb("Invalid base64 string: "+o):o}}(e);return new En(r)}static fromUint8Array(e){const r=function(a){let o="";for(let l=0;l<a.length;++l)o+=String.fromCharCode(a[l]);return o}(e);return new En(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let a=0;a<r.length;a++)n[a]=r.charCodeAt(a);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Tt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}En.EMPTY_BYTE_STRING=new En("");const JN=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function go(t){if(Xt(!!t,39018),typeof t=="string"){let e=0;const r=JN.exec(t);if(Xt(!!r,46558,{timestamp:t}),r[1]){let a=r[1];a=(a+"000000000").substr(0,9),e=Number(a)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Fr(t.seconds),nanos:Fr(t.nanos)}}function Fr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function xo(t){return typeof t=="string"?En.fromBase64String(t):En.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zb="server_timestamp",Gb="__type__",qb="__previous_value__",Wb="__local_write_time__";function wx(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[Gb])===null||r===void 0?void 0:r.stringValue)===zb}function dm(t){const e=t.mapValue.fields[qb];return wx(e)?dm(e):e}function zf(t){const e=go(t.mapValue.fields[Wb].timestampValue);return new fr(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eI{constructor(e,r,n,a,o,l,u,f,d,m){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=a,this.ssl=o,this.forceLongPolling=l,this.autoDetectLongPolling=u,this.longPollingOptions=f,this.useFetchStreams=d,this.isUsingEmulator=m}}const Dd="(default)";class Gf{constructor(e,r){this.projectId=e,this.database=r||Dd}static empty(){return new Gf("","")}get isDefaultDatabase(){return this.database===Dd}isEqual(e){return e instanceof Gf&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xb="__type__",tI="__max__",Zh={mapValue:{}},Kb="__vector__",Od="value";function vo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?wx(t)?4:nI(t)?9007199254740991:rI(t)?10:11:ct(28295,{value:t})}function Ui(t,e){if(t===e)return!0;const r=vo(t);if(r!==vo(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return zf(t).isEqual(zf(e));case 3:return function(a,o){if(typeof a.timestampValue=="string"&&typeof o.timestampValue=="string"&&a.timestampValue.length===o.timestampValue.length)return a.timestampValue===o.timestampValue;const l=go(a.timestampValue),u=go(o.timestampValue);return l.seconds===u.seconds&&l.nanos===u.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(a,o){return xo(a.bytesValue).isEqual(xo(o.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(a,o){return Fr(a.geoPointValue.latitude)===Fr(o.geoPointValue.latitude)&&Fr(a.geoPointValue.longitude)===Fr(o.geoPointValue.longitude)}(t,e);case 2:return function(a,o){if("integerValue"in a&&"integerValue"in o)return Fr(a.integerValue)===Fr(o.integerValue);if("doubleValue"in a&&"doubleValue"in o){const l=Fr(a.doubleValue),u=Fr(o.doubleValue);return l===u?Id(l)===Id(u):isNaN(l)&&isNaN(u)}return!1}(t,e);case 9:return Kc(t.arrayValue.values||[],e.arrayValue.values||[],Ui);case 10:case 11:return function(a,o){const l=a.mapValue.fields||{},u=o.mapValue.fields||{};if(zw(l)!==zw(u))return!1;for(const f in l)if(l.hasOwnProperty(f)&&(u[f]===void 0||!Ui(l[f],u[f])))return!1;return!0}(t,e);default:return ct(52216,{left:t})}}function qf(t,e){return(t.values||[]).find(r=>Ui(r,e))!==void 0}function Yc(t,e){if(t===e)return 0;const r=vo(t),n=vo(e);if(r!==n)return Tt(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return Tt(t.booleanValue,e.booleanValue);case 2:return function(o,l){const u=Fr(o.integerValue||o.doubleValue),f=Fr(l.integerValue||l.doubleValue);return u<f?-1:u>f?1:u===f?0:isNaN(u)?isNaN(f)?0:-1:1}(t,e);case 3:return qw(t.timestampValue,e.timestampValue);case 4:return qw(zf(t),zf(e));case 5:return C1(t.stringValue,e.stringValue);case 6:return function(o,l){const u=xo(o),f=xo(l);return u.compareTo(f)}(t.bytesValue,e.bytesValue);case 7:return function(o,l){const u=o.split("/"),f=l.split("/");for(let d=0;d<u.length&&d<f.length;d++){const m=Tt(u[d],f[d]);if(m!==0)return m}return Tt(u.length,f.length)}(t.referenceValue,e.referenceValue);case 8:return function(o,l){const u=Tt(Fr(o.latitude),Fr(l.latitude));return u!==0?u:Tt(Fr(o.longitude),Fr(l.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Ww(t.arrayValue,e.arrayValue);case 10:return function(o,l){var u,f,d,m;const v=o.fields||{},_=l.fields||{},E=(u=v[Od])===null||u===void 0?void 0:u.arrayValue,S=(f=_[Od])===null||f===void 0?void 0:f.arrayValue,w=Tt(((d=E==null?void 0:E.values)===null||d===void 0?void 0:d.length)||0,((m=S==null?void 0:S.values)===null||m===void 0?void 0:m.length)||0);return w!==0?w:Ww(E,S)}(t.mapValue,e.mapValue);case 11:return function(o,l){if(o===Zh.mapValue&&l===Zh.mapValue)return 0;if(o===Zh.mapValue)return 1;if(l===Zh.mapValue)return-1;const u=o.fields||{},f=Object.keys(u),d=l.fields||{},m=Object.keys(d);f.sort(),m.sort();for(let v=0;v<f.length&&v<m.length;++v){const _=C1(f[v],m[v]);if(_!==0)return _;const E=Yc(u[f[v]],d[m[v]]);if(E!==0)return E}return Tt(f.length,m.length)}(t.mapValue,e.mapValue);default:throw ct(23264,{le:r})}}function qw(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Tt(t,e);const r=go(t),n=go(e),a=Tt(r.seconds,n.seconds);return a!==0?a:Tt(r.nanos,n.nanos)}function Ww(t,e){const r=t.values||[],n=e.values||[];for(let a=0;a<r.length&&a<n.length;++a){const o=Yc(r[a],n[a]);if(o)return o}return Tt(r.length,n.length)}function $c(t){return R1(t)}function R1(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=go(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return xo(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return tt.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",a=!0;for(const o of r.values||[])a?a=!1:n+=",",n+=R1(o);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let a="{",o=!0;for(const l of n)o?o=!1:a+=",",a+=`${l}:${R1(r.fields[l])}`;return a+"}"}(t.mapValue):ct(61005,{value:t})}function vd(t){switch(vo(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=dm(t);return e?16+vd(e):16;case 5:return 2*t.stringValue.length;case 6:return xo(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((a,o)=>a+vd(o),0)}(t.arrayValue);case 10:case 11:return function(n){let a=0;return Ao(n.fields,(o,l)=>{a+=o.length+vd(l)}),a}(t.mapValue);default:throw ct(13486,{value:t})}}function Xw(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function N1(t){return!!t&&"integerValue"in t}function Ex(t){return!!t&&"arrayValue"in t}function Kw(t){return!!t&&"nullValue"in t}function Yw(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function _d(t){return!!t&&"mapValue"in t}function rI(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[Xb])===null||r===void 0?void 0:r.stringValue)===Kb}function Af(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Ao(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Af(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Af(t.arrayValue.values[r]);return e}return Object.assign({},t)}function nI(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===tI}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ra{constructor(e){this.value=e}static empty(){return new ra({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!_d(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Af(r)}setAll(e){let r=yn.emptyPath(),n={},a=[];e.forEach((l,u)=>{if(!r.isImmediateParentOf(u)){const f=this.getFieldsMap(r);this.applyChanges(f,n,a),n={},a=[],r=u.popLast()}l?n[u.lastSegment()]=Af(l):a.push(u.lastSegment())});const o=this.getFieldsMap(r);this.applyChanges(o,n,a)}delete(e){const r=this.field(e.popLast());_d(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return Ui(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let a=r.mapValue.fields[e.get(n)];_d(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=a),r=a}return r.mapValue.fields}applyChanges(e,r,n){Ao(r,(a,o)=>e[a]=o);for(const a of n)delete e[a]}clone(){return new ra(Af(this.value))}}function Yb(t){const e=[];return Ao(t.fields,(r,n)=>{const a=new yn([r]);if(_d(n)){const o=Yb(n.mapValue).fields;if(o.length===0)e.push(a);else for(const l of o)e.push(a.child(l))}else e.push(a)}),new _a(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class In{constructor(e,r,n,a,o,l,u){this.key=e,this.documentType=r,this.version=n,this.readTime=a,this.createTime=o,this.data=l,this.documentState=u}static newInvalidDocument(e){return new In(e,0,gt.min(),gt.min(),gt.min(),ra.empty(),0)}static newFoundDocument(e,r,n,a){return new In(e,1,r,gt.min(),n,a,0)}static newNoDocument(e,r){return new In(e,2,r,gt.min(),gt.min(),ra.empty(),0)}static newUnknownDocument(e,r){return new In(e,3,r,gt.min(),gt.min(),ra.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(gt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ra.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ra.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=gt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof In&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new In(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fd{constructor(e,r){this.position=e,this.inclusive=r}}function $w(t,e,r){let n=0;for(let a=0;a<t.position.length;a++){const o=e[a],l=t.position[a];if(o.field.isKeyField()?n=tt.comparator(tt.fromName(l.referenceValue),r.key):n=Yc(l,r.data.field(o.field)),o.dir==="desc"&&(n*=-1),n!==0)break}return n}function Qw(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Ui(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pd{constructor(e,r="asc"){this.field=e,this.dir=r}}function aI(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $b{}class qr extends $b{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new sI(e,r,n):r==="array-contains"?new cI(e,n):r==="in"?new uI(e,n):r==="not-in"?new fI(e,n):r==="array-contains-any"?new hI(e,n):new qr(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new oI(e,n):new lI(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(Yc(r,this.value)):r!==null&&vo(this.value)===vo(r)&&this.matchesComparison(Yc(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ct(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ai extends $b{constructor(e,r){super(),this.filters=e,this.op=r,this.he=null}static create(e,r){return new ai(e,r)}matches(e){return Qb(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function Qb(t){return t.op==="and"}function Zb(t){return iI(t)&&Qb(t)}function iI(t){for(const e of t.filters)if(e instanceof ai)return!1;return!0}function I1(t){if(t instanceof qr)return t.field.canonicalString()+t.op.toString()+$c(t.value);if(Zb(t))return t.filters.map(e=>I1(e)).join(",");{const e=t.filters.map(r=>I1(r)).join(",");return`${t.op}(${e})`}}function Jb(t,e){return t instanceof qr?function(n,a){return a instanceof qr&&n.op===a.op&&n.field.isEqual(a.field)&&Ui(n.value,a.value)}(t,e):t instanceof ai?function(n,a){return a instanceof ai&&n.op===a.op&&n.filters.length===a.filters.length?n.filters.reduce((o,l,u)=>o&&Jb(l,a.filters[u]),!0):!1}(t,e):void ct(19439)}function eS(t){return t instanceof qr?function(r){return`${r.field.canonicalString()} ${r.op} ${$c(r.value)}`}(t):t instanceof ai?function(r){return r.op.toString()+" {"+r.getFilters().map(eS).join(" ,")+"}"}(t):"Filter"}class sI extends qr{constructor(e,r,n){super(e,r,n),this.key=tt.fromName(n.referenceValue)}matches(e){const r=tt.comparator(e.key,this.key);return this.matchesComparison(r)}}class oI extends qr{constructor(e,r){super(e,"in",r),this.keys=tS("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class lI extends qr{constructor(e,r){super(e,"not-in",r),this.keys=tS("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function tS(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>tt.fromName(n.referenceValue))}class cI extends qr{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Ex(r)&&qf(r.arrayValue,this.value)}}class uI extends qr{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&qf(this.value.arrayValue,r)}}class fI extends qr{constructor(e,r){super(e,"not-in",r)}matches(e){if(qf(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!qf(this.value.arrayValue,r)}}class hI extends qr{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Ex(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>qf(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dI{constructor(e,r=null,n=[],a=[],o=null,l=null,u=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=a,this.limit=o,this.startAt=l,this.endAt=u,this.Pe=null}}function Zw(t,e=null,r=[],n=[],a=null,o=null,l=null){return new dI(t,e,r,n,a,o,l)}function Tx(t){const e=xt(t);if(e.Pe===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>I1(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(o){return o.field.canonicalString()+o.dir}(n)).join(","),hm(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>$c(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>$c(n)).join(",")),e.Pe=r}return e.Pe}function bx(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!aI(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!Jb(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Qw(t.startAt,e.startAt)&&Qw(t.endAt,e.endAt)}function D1(t){return tt.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d0{constructor(e,r=null,n=[],a=[],o=null,l="F",u=null,f=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=a,this.limit=o,this.limitType=l,this.startAt=u,this.endAt=f,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function mI(t,e,r,n,a,o,l,u){return new d0(t,e,r,n,a,o,l,u)}function rS(t){return new d0(t)}function Jw(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function nS(t){return t.collectionGroup!==null}function kf(t){const e=xt(t);if(e.Te===null){e.Te=[];const r=new Set;for(const o of e.explicitOrderBy)e.Te.push(o),r.add(o.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(l){let u=new en(yn.comparator);return l.filters.forEach(f=>{f.getFlattenedFilters().forEach(d=>{d.isInequality()&&(u=u.add(d.field))})}),u})(e).forEach(o=>{r.has(o.canonicalString())||o.isKeyField()||e.Te.push(new Pd(o,n))}),r.has(yn.keyField().canonicalString())||e.Te.push(new Pd(yn.keyField(),n))}return e.Te}function Ii(t){const e=xt(t);return e.Ie||(e.Ie=pI(e,kf(t))),e.Ie}function pI(t,e){if(t.limitType==="F")return Zw(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(a=>{const o=a.dir==="desc"?"asc":"desc";return new Pd(a.field,o)});const r=t.endAt?new Fd(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Fd(t.startAt.position,t.startAt.inclusive):null;return Zw(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function O1(t,e){const r=t.filters.concat([e]);return new d0(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function F1(t,e,r){return new d0(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function mm(t,e){return bx(Ii(t),Ii(e))&&t.limitType===e.limitType}function aS(t){return`${Tx(Ii(t))}|lt:${t.limitType}`}function Ic(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(a=>eS(a)).join(", ")}]`),hm(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(a=>function(l){return`${l.field.canonicalString()} (${l.dir})`}(a)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(a=>$c(a)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(a=>$c(a)).join(",")),`Target(${n})`}(Ii(t))}; limitType=${t.limitType})`}function pm(t,e){return e.isFoundDocument()&&function(n,a){const o=a.key.path;return n.collectionGroup!==null?a.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(o):tt.isDocumentKey(n.path)?n.path.isEqual(o):n.path.isImmediateParentOf(o)}(t,e)&&function(n,a){for(const o of kf(n))if(!o.field.isKeyField()&&a.data.field(o.field)===null)return!1;return!0}(t,e)&&function(n,a){for(const o of n.filters)if(!o.matches(a))return!1;return!0}(t,e)&&function(n,a){return!(n.startAt&&!function(l,u,f){const d=$w(l,u,f);return l.inclusive?d<=0:d<0}(n.startAt,kf(n),a)||n.endAt&&!function(l,u,f){const d=$w(l,u,f);return l.inclusive?d>=0:d>0}(n.endAt,kf(n),a))}(t,e)}function gI(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function iS(t){return(e,r)=>{let n=!1;for(const a of kf(t)){const o=xI(a,e,r);if(o!==0)return o;n=n||a.field.isKeyField()}return 0}}function xI(t,e,r){const n=t.field.isKeyField()?tt.comparator(e.key,r.key):function(o,l,u){const f=l.data.field(o),d=u.data.field(o);return f!==null&&d!==null?Yc(f,d):ct(42886)}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return ct(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Il{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[a,o]of n)if(this.equalsFn(a,e))return o}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),a=this.inner[n];if(a===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let o=0;o<a.length;o++)if(this.equalsFn(a[o][0],e))return void(a[o]=[e,r]);a.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let a=0;a<n.length;a++)if(this.equalsFn(n[a][0],e))return n.length===1?delete this.inner[r]:n.splice(a,1),this.innerSize--,!0;return!1}forEach(e){Ao(this.inner,(r,n)=>{for(const[a,o]of n)e(a,o)})}isEmpty(){return jb(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vI=new yr(tt.comparator);function xs(){return vI}const sS=new yr(tt.comparator);function vf(...t){let e=sS;for(const r of t)e=e.insert(r.key,r);return e}function oS(t){let e=sS;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function ul(){return Cf()}function lS(){return Cf()}function Cf(){return new Il(t=>t.toString(),(t,e)=>t.isEqual(e))}const _I=new yr(tt.comparator),yI=new en(tt.comparator);function It(...t){let e=yI;for(const r of t)e=e.add(r);return e}const wI=new en(Tt);function EI(){return wI}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sx(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Id(e)?"-0":e}}function cS(t){return{integerValue:""+t}}function TI(t,e){return $N(e)?cS(e):Sx(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gm{constructor(){this._=void 0}}function bI(t,e,r){return t instanceof Ld?function(a,o){const l={fields:{[Gb]:{stringValue:zb},[Wb]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return o&&wx(o)&&(o=dm(o)),o&&(l.fields[qb]=o),{mapValue:l}}(r,e):t instanceof Wf?fS(t,e):t instanceof Xf?hS(t,e):function(a,o){const l=uS(a,o),u=eE(l)+eE(a.Ee);return N1(l)&&N1(a.Ee)?cS(u):Sx(a.serializer,u)}(t,e)}function SI(t,e,r){return t instanceof Wf?fS(t,e):t instanceof Xf?hS(t,e):r}function uS(t,e){return t instanceof Md?function(n){return N1(n)||function(o){return!!o&&"doubleValue"in o}(n)}(e)?e:{integerValue:0}:null}class Ld extends gm{}class Wf extends gm{constructor(e){super(),this.elements=e}}function fS(t,e){const r=dS(e);for(const n of t.elements)r.some(a=>Ui(a,n))||r.push(n);return{arrayValue:{values:r}}}class Xf extends gm{constructor(e){super(),this.elements=e}}function hS(t,e){let r=dS(e);for(const n of t.elements)r=r.filter(a=>!Ui(a,n));return{arrayValue:{values:r}}}class Md extends gm{constructor(e,r){super(),this.serializer=e,this.Ee=r}}function eE(t){return Fr(t.integerValue||t.doubleValue)}function dS(t){return Ex(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function AI(t,e){return t.field.isEqual(e.field)&&function(n,a){return n instanceof Wf&&a instanceof Wf||n instanceof Xf&&a instanceof Xf?Kc(n.elements,a.elements,Ui):n instanceof Md&&a instanceof Md?Ui(n.Ee,a.Ee):n instanceof Ld&&a instanceof Ld}(t.transform,e.transform)}class kI{constructor(e,r){this.version=e,this.transformResults=r}}class ti{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new ti}static exists(e){return new ti(void 0,e)}static updateTime(e){return new ti(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function yd(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class xm{}function mS(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Ax(t.key,ti.none()):new m0(t.key,t.data,ti.none());{const r=t.data,n=ra.empty();let a=new en(yn.comparator);for(let o of e.fields)if(!a.has(o)){let l=r.field(o);l===null&&o.length>1&&(o=o.popLast(),l=r.field(o)),l===null?n.delete(o):n.set(o,l),a=a.add(o)}return new ko(t.key,n,new _a(a.toArray()),ti.none())}}function CI(t,e,r){t instanceof m0?function(a,o,l){const u=a.value.clone(),f=rE(a.fieldTransforms,o,l.transformResults);u.setAll(f),o.convertToFoundDocument(l.version,u).setHasCommittedMutations()}(t,e,r):t instanceof ko?function(a,o,l){if(!yd(a.precondition,o))return void o.convertToUnknownDocument(l.version);const u=rE(a.fieldTransforms,o,l.transformResults),f=o.data;f.setAll(pS(a)),f.setAll(u),o.convertToFoundDocument(l.version,f).setHasCommittedMutations()}(t,e,r):function(a,o,l){o.convertToNoDocument(l.version).setHasCommittedMutations()}(0,e,r)}function Rf(t,e,r,n){return t instanceof m0?function(o,l,u,f){if(!yd(o.precondition,l))return u;const d=o.value.clone(),m=nE(o.fieldTransforms,f,l);return d.setAll(m),l.convertToFoundDocument(l.version,d).setHasLocalMutations(),null}(t,e,r,n):t instanceof ko?function(o,l,u,f){if(!yd(o.precondition,l))return u;const d=nE(o.fieldTransforms,f,l),m=l.data;return m.setAll(pS(o)),m.setAll(d),l.convertToFoundDocument(l.version,m).setHasLocalMutations(),u===null?null:u.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(v=>v.field))}(t,e,r,n):function(o,l,u){return yd(o.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):u}(t,e,r)}function RI(t,e){let r=null;for(const n of t.fieldTransforms){const a=e.data.field(n.field),o=uS(n.transform,a||null);o!=null&&(r===null&&(r=ra.empty()),r.set(n.field,o))}return r||null}function tE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,a){return n===void 0&&a===void 0||!(!n||!a)&&Kc(n,a,(o,l)=>AI(o,l))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class m0 extends xm{constructor(e,r,n,a=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class ko extends xm{constructor(e,r,n,a,o=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=a,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function pS(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function rE(t,e,r){const n=new Map;Xt(t.length===r.length,32656,{Ae:r.length,Re:t.length});for(let a=0;a<r.length;a++){const o=t[a],l=o.transform,u=e.data.field(o.field);n.set(o.field,SI(l,u,r[a]))}return n}function nE(t,e,r){const n=new Map;for(const a of t){const o=a.transform,l=r.data.field(a.field);n.set(a.field,bI(o,l,e))}return n}class Ax extends xm{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class NI extends xm{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class II{constructor(e,r,n,a){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=a}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let a=0;a<this.mutations.length;a++){const o=this.mutations[a];o.key.isEqual(e.key)&&CI(o,e,n[a])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Rf(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Rf(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=lS();return this.mutations.forEach(a=>{const o=e.get(a.key),l=o.overlayedDocument;let u=this.applyToLocalView(l,o.mutatedFields);u=r.has(a.key)?null:u;const f=mS(l,u);f!==null&&n.set(a.key,f),l.isValidDocument()||l.convertToNoDocument(gt.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),It())}isEqual(e){return this.batchId===e.batchId&&Kc(this.mutations,e.mutations,(r,n)=>tE(r,n))&&Kc(this.baseMutations,e.baseMutations,(r,n)=>tE(r,n))}}class kx{constructor(e,r,n,a){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=a}static from(e,r,n){Xt(e.mutations.length===n.length,58842,{Ve:e.mutations.length,me:n.length});let a=function(){return _I}();const o=e.mutations;for(let l=0;l<o.length;l++)a=a.insert(o[l].key,n[l].version);return new kx(e,r,n,a)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DI{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OI{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Hr,Mt;function FI(t){switch(t){case Ne.OK:return ct(64938);case Ne.CANCELLED:case Ne.UNKNOWN:case Ne.DEADLINE_EXCEEDED:case Ne.RESOURCE_EXHAUSTED:case Ne.INTERNAL:case Ne.UNAVAILABLE:case Ne.UNAUTHENTICATED:return!1;case Ne.INVALID_ARGUMENT:case Ne.NOT_FOUND:case Ne.ALREADY_EXISTS:case Ne.PERMISSION_DENIED:case Ne.FAILED_PRECONDITION:case Ne.ABORTED:case Ne.OUT_OF_RANGE:case Ne.UNIMPLEMENTED:case Ne.DATA_LOSS:return!0;default:return ct(15467,{code:t})}}function gS(t){if(t===void 0)return gs("GRPC error has no .code"),Ne.UNKNOWN;switch(t){case Hr.OK:return Ne.OK;case Hr.CANCELLED:return Ne.CANCELLED;case Hr.UNKNOWN:return Ne.UNKNOWN;case Hr.DEADLINE_EXCEEDED:return Ne.DEADLINE_EXCEEDED;case Hr.RESOURCE_EXHAUSTED:return Ne.RESOURCE_EXHAUSTED;case Hr.INTERNAL:return Ne.INTERNAL;case Hr.UNAVAILABLE:return Ne.UNAVAILABLE;case Hr.UNAUTHENTICATED:return Ne.UNAUTHENTICATED;case Hr.INVALID_ARGUMENT:return Ne.INVALID_ARGUMENT;case Hr.NOT_FOUND:return Ne.NOT_FOUND;case Hr.ALREADY_EXISTS:return Ne.ALREADY_EXISTS;case Hr.PERMISSION_DENIED:return Ne.PERMISSION_DENIED;case Hr.FAILED_PRECONDITION:return Ne.FAILED_PRECONDITION;case Hr.ABORTED:return Ne.ABORTED;case Hr.OUT_OF_RANGE:return Ne.OUT_OF_RANGE;case Hr.UNIMPLEMENTED:return Ne.UNIMPLEMENTED;case Hr.DATA_LOSS:return Ne.DATA_LOSS;default:return ct(39323,{code:t})}}(Mt=Hr||(Hr={}))[Mt.OK=0]="OK",Mt[Mt.CANCELLED=1]="CANCELLED",Mt[Mt.UNKNOWN=2]="UNKNOWN",Mt[Mt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Mt[Mt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Mt[Mt.NOT_FOUND=5]="NOT_FOUND",Mt[Mt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Mt[Mt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Mt[Mt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Mt[Mt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Mt[Mt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Mt[Mt.ABORTED=10]="ABORTED",Mt[Mt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Mt[Mt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Mt[Mt.INTERNAL=13]="INTERNAL",Mt[Mt.UNAVAILABLE=14]="UNAVAILABLE",Mt[Mt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PI=new co([4294967295,4294967295],0);function aE(t){const e=Mb().encode(t),r=new Rb;return r.update(e),new Uint8Array(r.digest())}function iE(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),a=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new co([r,n],0),new co([a,o],0)]}class Cx{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new _f(`Invalid padding: ${r}`);if(n<0)throw new _f(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new _f(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new _f(`Invalid padding when bitmap length is 0: ${r}`);this.fe=8*e.length-r,this.ge=co.fromNumber(this.fe)}pe(e,r,n){let a=e.add(r.multiply(co.fromNumber(n)));return a.compare(PI)===1&&(a=new co([a.getBits(0),a.getBits(1)],0)),a.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;const r=aE(e),[n,a]=iE(r);for(let o=0;o<this.hashCount;o++){const l=this.pe(n,a,o);if(!this.ye(l))return!1}return!0}static create(e,r,n){const a=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),l=new Cx(o,a,r);return n.forEach(u=>l.insert(u)),l}insert(e){if(this.fe===0)return;const r=aE(e),[n,a]=iE(r);for(let o=0;o<this.hashCount;o++){const l=this.pe(n,a,o);this.we(l)}}we(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class _f extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vm{constructor(e,r,n,a,o){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=a,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const a=new Map;return a.set(e,p0.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new vm(gt.min(),a,new yr(Tt),xs(),It())}}class p0{constructor(e,r,n,a,o){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=a,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new p0(n,r,It(),It(),It())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wd{constructor(e,r,n,a){this.Se=e,this.removedTargetIds=r,this.key=n,this.be=a}}class xS{constructor(e,r){this.targetId=e,this.De=r}}class vS{constructor(e,r,n=En.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=a}}class sE{constructor(){this.ve=0,this.Ce=oE(),this.Fe=En.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=It(),r=It(),n=It();return this.Ce.forEach((a,o)=>{switch(o){case 0:e=e.add(a);break;case 2:r=r.add(a);break;case 1:n=n.add(a);break;default:ct(38017,{changeType:o})}}),new p0(this.Fe,this.Me,e,r,n)}ke(){this.xe=!1,this.Ce=oE()}qe(e,r){this.xe=!0,this.Ce=this.Ce.insert(e,r)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,Xt(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class LI{constructor(e){this.We=e,this.Ge=new Map,this.ze=xs(),this.je=Jh(),this.Je=Jh(),this.He=new yr(Tt)}Ye(e){for(const r of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(r,e.be):this.Xe(r,e.key,e.be);for(const r of e.removedTargetIds)this.Xe(r,e.key,e.be)}et(e){this.forEachTarget(e,r=>{const n=this.tt(r);switch(e.state){case 0:this.nt(r)&&n.Be(e.resumeToken);break;case 1:n.Ue(),n.Oe||n.ke(),n.Be(e.resumeToken);break;case 2:n.Ue(),n.Oe||this.removeTarget(r);break;case 3:this.nt(r)&&(n.Ke(),n.Be(e.resumeToken));break;case 4:this.nt(r)&&(this.rt(r),n.Be(e.resumeToken));break;default:ct(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Ge.forEach((n,a)=>{this.nt(a)&&r(a)})}it(e){const r=e.targetId,n=e.De.count,a=this.st(r);if(a){const o=a.target;if(D1(o))if(n===0){const l=new tt(o.path);this.Xe(r,l,In.newNoDocument(l,gt.min()))}else Xt(n===1,20013,{expectedCount:n});else{const l=this.ot(r);if(l!==n){const u=this._t(e),f=u?this.ut(u,e,l):1;if(f!==0){this.rt(r);const d=f===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(r,d)}}}}}_t(e){const r=e.De.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:a=0},hashCount:o=0}=r;let l,u;try{l=xo(n).toUint8Array()}catch(f){if(f instanceof Hb)return mo("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw f}try{u=new Cx(l,a,o)}catch(f){return mo(f instanceof _f?"BloomFilter error: ":"Applying bloom filter failed: ",f),null}return u.fe===0?null:u}ut(e,r,n){return r.De.count===n-this.ht(e,r.targetId)?0:2}ht(e,r){const n=this.We.getRemoteKeysForTarget(r);let a=0;return n.forEach(o=>{const l=this.We.lt(),u=`projects/${l.projectId}/databases/${l.database}/documents/${o.path.canonicalString()}`;e.mightContain(u)||(this.Xe(r,o,null),a++)}),a}Pt(e){const r=new Map;this.Ge.forEach((o,l)=>{const u=this.st(l);if(u){if(o.current&&D1(u.target)){const f=new tt(u.target.path);this.Tt(f).has(l)||this.It(l,f)||this.Xe(l,f,In.newNoDocument(f,e))}o.Ne&&(r.set(l,o.Le()),o.ke())}});let n=It();this.Je.forEach((o,l)=>{let u=!0;l.forEachWhile(f=>{const d=this.st(f);return!d||d.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(n=n.add(o))}),this.ze.forEach((o,l)=>l.setReadTime(e));const a=new vm(e,r,this.He,this.ze,n);return this.ze=xs(),this.je=Jh(),this.Je=Jh(),this.He=new yr(Tt),a}Ze(e,r){if(!this.nt(e))return;const n=this.It(e,r.key)?2:0;this.tt(e).qe(r.key,n),this.ze=this.ze.insert(r.key,r),this.je=this.je.insert(r.key,this.Tt(r.key).add(e)),this.Je=this.Je.insert(r.key,this.dt(r.key).add(e))}Xe(e,r,n){if(!this.nt(e))return;const a=this.tt(e);this.It(e,r)?a.qe(r,1):a.Qe(r),this.Je=this.Je.insert(r,this.dt(r).delete(e)),this.Je=this.Je.insert(r,this.dt(r).add(e)),n&&(this.ze=this.ze.insert(r,n))}removeTarget(e){this.Ge.delete(e)}ot(e){const r=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let r=this.Ge.get(e);return r||(r=new sE,this.Ge.set(e,r)),r}dt(e){let r=this.Je.get(e);return r||(r=new en(Tt),this.Je=this.Je.insert(e,r)),r}Tt(e){let r=this.je.get(e);return r||(r=new en(Tt),this.je=this.je.insert(e,r)),r}nt(e){const r=this.st(e)!==null;return r||Ye("WatchChangeAggregator","Detected inactive target",e),r}st(e){const r=this.Ge.get(e);return r&&r.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new sE),this.We.getRemoteKeysForTarget(e).forEach(r=>{this.Xe(e,r,null)})}It(e,r){return this.We.getRemoteKeysForTarget(e).has(r)}}function Jh(){return new yr(tt.comparator)}function oE(){return new yr(tt.comparator)}const MI={asc:"ASCENDING",desc:"DESCENDING"},UI={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},BI={and:"AND",or:"OR"};class VI{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function P1(t,e){return t.useProto3Json||hm(e)?e:{value:e}}function Ud(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function _S(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function jI(t,e){return Ud(t,e.toTimestamp())}function Di(t){return Xt(!!t,49232),gt.fromTimestamp(function(r){const n=go(r);return new fr(n.seconds,n.nanos)}(t))}function Rx(t,e){return L1(t,e).canonicalString()}function L1(t,e){const r=function(a){return new cr(["projects",a.projectId,"databases",a.database])}(t).child("documents");return e===void 0?r:r.child(e)}function yS(t){const e=cr.fromString(t);return Xt(SS(e),10190,{key:e.toString()}),e}function M1(t,e){return Rx(t.databaseId,e.path)}function Kg(t,e){const r=yS(e);if(r.get(1)!==t.databaseId.projectId)throw new $e(Ne.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new $e(Ne.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new tt(ES(r))}function wS(t,e){return Rx(t.databaseId,e)}function HI(t){const e=yS(t);return e.length===4?cr.emptyPath():ES(e)}function U1(t){return new cr(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function ES(t){return Xt(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function lE(t,e,r){return{name:M1(t,e),fields:r.value.mapValue.fields}}function zI(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:ct(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],o=function(d,m){return d.useProto3Json?(Xt(m===void 0||typeof m=="string",58123),En.fromBase64String(m||"")):(Xt(m===void 0||m instanceof Buffer||m instanceof Uint8Array,16193),En.fromUint8Array(m||new Uint8Array))}(t,e.targetChange.resumeToken),l=e.targetChange.cause,u=l&&function(d){const m=d.code===void 0?Ne.UNKNOWN:gS(d.code);return new $e(m,d.message||"")}(l);r=new vS(n,a,o,u||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const a=Kg(t,n.document.name),o=Di(n.document.updateTime),l=n.document.createTime?Di(n.document.createTime):gt.min(),u=new ra({mapValue:{fields:n.document.fields}}),f=In.newFoundDocument(a,o,l,u),d=n.targetIds||[],m=n.removedTargetIds||[];r=new wd(d,m,f.key,f)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const a=Kg(t,n.document),o=n.readTime?Di(n.readTime):gt.min(),l=In.newNoDocument(a,o),u=n.removedTargetIds||[];r=new wd([],u,l.key,l)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const a=Kg(t,n.document),o=n.removedTargetIds||[];r=new wd([],o,a,null)}else{if(!("filter"in e))return ct(11601,{At:e});{e.filter;const n=e.filter;n.targetId;const{count:a=0,unchangedNames:o}=n,l=new OI(a,o),u=n.targetId;r=new xS(u,l)}}return r}function GI(t,e){let r;if(e instanceof m0)r={update:lE(t,e.key,e.value)};else if(e instanceof Ax)r={delete:M1(t,e.key)};else if(e instanceof ko)r={update:lE(t,e.key,e.data),updateMask:JI(e.fieldMask)};else{if(!(e instanceof NI))return ct(16599,{Rt:e.type});r={verify:M1(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(o,l){const u=l.transform;if(u instanceof Ld)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof Wf)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof Xf)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof Md)return{fieldPath:l.field.canonicalString(),increment:u.Ee};throw ct(20930,{transform:l.transform})}(0,n))),e.precondition.isNone||(r.currentDocument=function(a,o){return o.updateTime!==void 0?{updateTime:jI(a,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:ct(27497)}(t,e.precondition)),r}function qI(t,e){return t&&t.length>0?(Xt(e!==void 0,14353),t.map(r=>function(a,o){let l=a.updateTime?Di(a.updateTime):Di(o);return l.isEqual(gt.min())&&(l=Di(o)),new kI(l,a.transformResults||[])}(r,e))):[]}function WI(t,e){return{documents:[wS(t,e.path)]}}function XI(t,e){const r={structuredQuery:{}},n=e.path;let a;e.collectionGroup!==null?(a=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=wS(t,a);const o=function(d){if(d.length!==0)return bS(ai.create(d,"and"))}(e.filters);o&&(r.structuredQuery.where=o);const l=function(d){if(d.length!==0)return d.map(m=>function(_){return{field:Dc(_.field),direction:$I(_.dir)}}(m))}(e.orderBy);l&&(r.structuredQuery.orderBy=l);const u=P1(t,e.limit);return u!==null&&(r.structuredQuery.limit=u),e.startAt&&(r.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{Vt:r,parent:a}}function KI(t){let e=HI(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let a=null;if(n>0){Xt(n===1,65062);const m=r.from[0];m.allDescendants?a=m.collectionId:e=e.child(m.collectionId)}let o=[];r.where&&(o=function(v){const _=TS(v);return _ instanceof ai&&Zb(_)?_.getFilters():[_]}(r.where));let l=[];r.orderBy&&(l=function(v){return v.map(_=>function(S){return new Pd(Oc(S.field),function(b){switch(b){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(S.direction))}(_))}(r.orderBy));let u=null;r.limit&&(u=function(v){let _;return _=typeof v=="object"?v.value:v,hm(_)?null:_}(r.limit));let f=null;r.startAt&&(f=function(v){const _=!!v.before,E=v.values||[];return new Fd(E,_)}(r.startAt));let d=null;return r.endAt&&(d=function(v){const _=!v.before,E=v.values||[];return new Fd(E,_)}(r.endAt)),mI(e,a,l,o,u,"F",f,d)}function YI(t,e){const r=function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ct(28987,{purpose:a})}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function TS(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Oc(r.unaryFilter.field);return qr.create(n,"==",{doubleValue:NaN});case"IS_NULL":const a=Oc(r.unaryFilter.field);return qr.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=Oc(r.unaryFilter.field);return qr.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=Oc(r.unaryFilter.field);return qr.create(l,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ct(61313);default:return ct(60726)}}(t):t.fieldFilter!==void 0?function(r){return qr.create(Oc(r.fieldFilter.field),function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ct(58110);default:return ct(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return ai.create(r.compositeFilter.filters.map(n=>TS(n)),function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return ct(1026)}}(r.compositeFilter.op))}(t):ct(30097,{filter:t})}function $I(t){return MI[t]}function QI(t){return UI[t]}function ZI(t){return BI[t]}function Dc(t){return{fieldPath:t.canonicalString()}}function Oc(t){return yn.fromServerFormat(t.fieldPath)}function bS(t){return t instanceof qr?function(r){if(r.op==="=="){if(Yw(r.value))return{unaryFilter:{field:Dc(r.field),op:"IS_NAN"}};if(Kw(r.value))return{unaryFilter:{field:Dc(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(Yw(r.value))return{unaryFilter:{field:Dc(r.field),op:"IS_NOT_NAN"}};if(Kw(r.value))return{unaryFilter:{field:Dc(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Dc(r.field),op:QI(r.op),value:r.value}}}(t):t instanceof ai?function(r){const n=r.getFilters().map(a=>bS(a));return n.length===1?n[0]:{compositeFilter:{op:ZI(r.op),filters:n}}}(t):ct(54877,{filter:t})}function JI(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function SS(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class no{constructor(e,r,n,a,o=gt.min(),l=gt.min(),u=En.EMPTY_BYTE_STRING,f=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=a,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=u,this.expectedCount=f}withSequenceNumber(e){return new no(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new no(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new no(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new no(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eD{constructor(e){this.gt=e}}function tD(t){const e=KI({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?F1(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rD{constructor(){this.Dn=new nD}addToCollectionParentIndex(e,r){return this.Dn.add(r),Oe.resolve()}getCollectionParents(e,r){return Oe.resolve(this.Dn.getEntries(r))}addFieldIndex(e,r){return Oe.resolve()}deleteFieldIndex(e,r){return Oe.resolve()}deleteAllFieldIndexes(e){return Oe.resolve()}createTargetIndexes(e,r){return Oe.resolve()}getDocumentsMatchingTarget(e,r){return Oe.resolve(null)}getIndexType(e,r){return Oe.resolve(0)}getFieldIndexes(e,r){return Oe.resolve([])}getNextCollectionGroupToUpdate(e){return Oe.resolve(null)}getMinOffset(e,r){return Oe.resolve(po.min())}getMinOffsetFromCollectionGroup(e,r){return Oe.resolve(po.min())}updateCollectionGroup(e,r,n){return Oe.resolve()}updateIndexEntries(e,r){return Oe.resolve()}}class nD{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),a=this.index[r]||new en(cr.comparator),o=!a.has(n);return this.index[r]=a.add(n),o}has(e){const r=e.lastSegment(),n=e.popLast(),a=this.index[r];return a&&a.has(n)}getEntries(e){return(this.index[e]||new en(cr.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},AS=41943040;class ta{static withCacheSize(e){return new ta(e,ta.DEFAULT_COLLECTION_PERCENTILE,ta.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ta.DEFAULT_COLLECTION_PERCENTILE=10,ta.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ta.DEFAULT=new ta(AS,ta.DEFAULT_COLLECTION_PERCENTILE,ta.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ta.DISABLED=new ta(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qc{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new Qc(0)}static ur(){return new Qc(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uE="LruGarbageCollector",aD=1048576;function fE([t,e],[r,n]){const a=Tt(t,r);return a===0?Tt(e,n):a}class iD{constructor(e){this.Tr=e,this.buffer=new en(fE),this.Ir=0}dr(){return++this.Ir}Er(e){const r=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();fE(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class sD{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){Ye(uE,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){au(r)?Ye(uE,"Ignoring IndexedDB error during garbage collection: ",r):await nu(r)}await this.Rr(3e5)})}}class oD{constructor(e,r){this.Vr=e,this.params=r}calculateTargetCount(e,r){return this.Vr.mr(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return Oe.resolve(fm.ue);const n=new iD(r);return this.Vr.forEachTarget(e,a=>n.Er(a.sequenceNumber)).next(()=>this.Vr.gr(e,a=>n.Er(a))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.Vr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.Vr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(Ye("LruGarbageCollector","Garbage collection skipped; disabled"),Oe.resolve(cE)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Ye("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),cE):this.pr(e,r))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,r){let n,a,o,l,u,f,d;const m=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(v=>(v>this.params.maximumSequenceNumbersToCollect?(Ye("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),a=this.params.maximumSequenceNumbersToCollect):a=v,l=Date.now(),this.nthSequenceNumber(e,a))).next(v=>(n=v,u=Date.now(),this.removeTargets(e,n,r))).next(v=>(o=v,f=Date.now(),this.removeOrphanedDocuments(e,n))).next(v=>(d=Date.now(),Nc()<=Nt.DEBUG&&Ye("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${l-m}ms
	Determined least recently used ${a} in `+(u-l)+`ms
	Removed ${o} targets in `+(f-u)+`ms
	Removed ${v} documents in `+(d-f)+`ms
Total Duration: ${d-m}ms`),Oe.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:o,documentsRemoved:v})))}}function lD(t,e){return new oD(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cD{constructor(){this.changes=new Il(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,In.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Oe.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uD{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fD{constructor(e,r,n,a){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=a}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(a=>(n=a,this.remoteDocumentCache.getEntry(e,r))).next(a=>(n!==null&&Rf(n.mutation,a,_a.empty(),fr.now()),a))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,It()).next(()=>n))}getLocalViewOfDocuments(e,r,n=It()){const a=ul();return this.populateOverlays(e,a,r).next(()=>this.computeViews(e,r,a,n).next(o=>{let l=vf();return o.forEach((u,f)=>{l=l.insert(u,f.overlayedDocument)}),l}))}getOverlayedDocuments(e,r){const n=ul();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,It()))}populateOverlays(e,r,n){const a=[];return n.forEach(o=>{r.has(o)||a.push(o)}),this.documentOverlayCache.getOverlays(e,a).next(o=>{o.forEach((l,u)=>{r.set(l,u)})})}computeViews(e,r,n,a){let o=xs();const l=Cf(),u=function(){return Cf()}();return r.forEach((f,d)=>{const m=n.get(d.key);a.has(d.key)&&(m===void 0||m.mutation instanceof ko)?o=o.insert(d.key,d):m!==void 0?(l.set(d.key,m.mutation.getFieldMask()),Rf(m.mutation,d,m.mutation.getFieldMask(),fr.now())):l.set(d.key,_a.empty())}),this.recalculateAndSaveOverlays(e,o).next(f=>(f.forEach((d,m)=>l.set(d,m)),r.forEach((d,m)=>{var v;return u.set(d,new uD(m,(v=l.get(d))!==null&&v!==void 0?v:null))}),u))}recalculateAndSaveOverlays(e,r){const n=Cf();let a=new yr((l,u)=>l-u),o=It();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(l=>{for(const u of l)u.keys().forEach(f=>{const d=r.get(f);if(d===null)return;let m=n.get(f)||_a.empty();m=u.applyToLocalView(d,m),n.set(f,m);const v=(a.get(u.batchId)||It()).add(f);a=a.insert(u.batchId,v)})}).next(()=>{const l=[],u=a.getReverseIterator();for(;u.hasNext();){const f=u.getNext(),d=f.key,m=f.value,v=lS();m.forEach(_=>{if(!o.has(_)){const E=mS(r.get(_),n.get(_));E!==null&&v.set(_,E),o=o.add(_)}}),l.push(this.documentOverlayCache.saveOverlays(e,d,v))}return Oe.waitFor(l)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,a){return function(l){return tt.isDocumentKey(l.path)&&l.collectionGroup===null&&l.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):nS(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,a):this.getDocumentsMatchingCollectionQuery(e,r,n,a)}getNextDocuments(e,r,n,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,a).next(o=>{const l=a-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,a-o.size):Oe.resolve(ul());let u=Hf,f=o;return l.next(d=>Oe.forEach(d,(m,v)=>(u<v.largestBatchId&&(u=v.largestBatchId),o.get(m)?Oe.resolve():this.remoteDocumentCache.getEntry(e,m).next(_=>{f=f.insert(m,_)}))).next(()=>this.populateOverlays(e,d,o)).next(()=>this.computeViews(e,f,d,It())).next(m=>({batchId:u,changes:oS(m)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new tt(r)).next(n=>{let a=vf();return n.isFoundDocument()&&(a=a.insert(n.key,n)),a})}getDocumentsMatchingCollectionGroupQuery(e,r,n,a){const o=r.collectionGroup;let l=vf();return this.indexManager.getCollectionParents(e,o).next(u=>Oe.forEach(u,f=>{const d=function(v,_){return new d0(_,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)}(r,f.child(o));return this.getDocumentsMatchingCollectionQuery(e,d,n,a).next(m=>{m.forEach((v,_)=>{l=l.insert(v,_)})})}).next(()=>l))}getDocumentsMatchingCollectionQuery(e,r,n,a){let o;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(l=>(o=l,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,o,a))).next(l=>{o.forEach((f,d)=>{const m=d.getKey();l.get(m)===null&&(l=l.insert(m,In.newInvalidDocument(m)))});let u=vf();return l.forEach((f,d)=>{const m=o.get(f);m!==void 0&&Rf(m.mutation,d,_a.empty(),fr.now()),pm(r,d)&&(u=u.insert(f,d))}),u})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hD{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,r){return Oe.resolve(this.Br.get(r))}saveBundleMetadata(e,r){return this.Br.set(r.id,function(a){return{id:a.id,version:a.version,createTime:Di(a.createTime)}}(r)),Oe.resolve()}getNamedQuery(e,r){return Oe.resolve(this.Lr.get(r))}saveNamedQuery(e,r){return this.Lr.set(r.name,function(a){return{name:a.name,query:tD(a.bundledQuery),readTime:Di(a.readTime)}}(r)),Oe.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dD{constructor(){this.overlays=new yr(tt.comparator),this.kr=new Map}getOverlay(e,r){return Oe.resolve(this.overlays.get(r))}getOverlays(e,r){const n=ul();return Oe.forEach(r,a=>this.getOverlay(e,a).next(o=>{o!==null&&n.set(a,o)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((a,o)=>{this.wt(e,r,o)}),Oe.resolve()}removeOverlaysForBatchId(e,r,n){const a=this.kr.get(n);return a!==void 0&&(a.forEach(o=>this.overlays=this.overlays.remove(o)),this.kr.delete(n)),Oe.resolve()}getOverlaysForCollection(e,r,n){const a=ul(),o=r.length+1,l=new tt(r.child("")),u=this.overlays.getIteratorFrom(l);for(;u.hasNext();){const f=u.getNext().value,d=f.getKey();if(!r.isPrefixOf(d.path))break;d.path.length===o&&f.largestBatchId>n&&a.set(f.getKey(),f)}return Oe.resolve(a)}getOverlaysForCollectionGroup(e,r,n,a){let o=new yr((d,m)=>d-m);const l=this.overlays.getIterator();for(;l.hasNext();){const d=l.getNext().value;if(d.getKey().getCollectionGroup()===r&&d.largestBatchId>n){let m=o.get(d.largestBatchId);m===null&&(m=ul(),o=o.insert(d.largestBatchId,m)),m.set(d.getKey(),d)}}const u=ul(),f=o.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach((d,m)=>u.set(d,m)),!(u.size()>=a)););return Oe.resolve(u)}wt(e,r,n){const a=this.overlays.get(n.key);if(a!==null){const l=this.kr.get(a.largestBatchId).delete(n.key);this.kr.set(a.largestBatchId,l)}this.overlays=this.overlays.insert(n.key,new DI(r,n));let o=this.kr.get(r);o===void 0&&(o=It(),this.kr.set(r,o)),this.kr.set(r,o.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mD{constructor(){this.sessionToken=En.EMPTY_BYTE_STRING}getSessionToken(e){return Oe.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Oe.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nx{constructor(){this.qr=new en(ln.Qr),this.$r=new en(ln.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,r){const n=new ln(e,r);this.qr=this.qr.add(n),this.$r=this.$r.add(n)}Kr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Wr(new ln(e,r))}Gr(e,r){e.forEach(n=>this.removeReference(n,r))}zr(e){const r=new tt(new cr([])),n=new ln(r,e),a=new ln(r,e+1),o=[];return this.$r.forEachInRange([n,a],l=>{this.Wr(l),o.push(l.key)}),o}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const r=new tt(new cr([])),n=new ln(r,e),a=new ln(r,e+1);let o=It();return this.$r.forEachInRange([n,a],l=>{o=o.add(l.key)}),o}containsKey(e){const r=new ln(e,0),n=this.qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class ln{constructor(e,r){this.key=e,this.Hr=r}static Qr(e,r){return tt.comparator(e.key,r.key)||Tt(e.Hr,r.Hr)}static Ur(e,r){return Tt(e.Hr,r.Hr)||tt.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pD{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.er=1,this.Yr=new en(ln.Qr)}checkEmpty(e){return Oe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,a){const o=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new II(o,r,n,a);this.mutationQueue.push(l);for(const u of a)this.Yr=this.Yr.add(new ln(u.key,o)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return Oe.resolve(l)}lookupMutationBatch(e,r){return Oe.resolve(this.Zr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,a=this.Xr(n),o=a<0?0:a;return Oe.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return Oe.resolve(this.mutationQueue.length===0?yx:this.er-1)}getAllMutationBatches(e){return Oe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new ln(r,0),a=new ln(r,Number.POSITIVE_INFINITY),o=[];return this.Yr.forEachInRange([n,a],l=>{const u=this.Zr(l.Hr);o.push(u)}),Oe.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new en(Tt);return r.forEach(a=>{const o=new ln(a,0),l=new ln(a,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([o,l],u=>{n=n.add(u.Hr)})}),Oe.resolve(this.ei(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,a=n.length+1;let o=n;tt.isDocumentKey(o)||(o=o.child(""));const l=new ln(new tt(o),0);let u=new en(Tt);return this.Yr.forEachWhile(f=>{const d=f.key.path;return!!n.isPrefixOf(d)&&(d.length===a&&(u=u.add(f.Hr)),!0)},l),Oe.resolve(this.ei(u))}ei(e){const r=[];return e.forEach(n=>{const a=this.Zr(n);a!==null&&r.push(a)}),r}removeMutationBatch(e,r){Xt(this.ti(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Yr;return Oe.forEach(r.mutations,a=>{const o=new ln(a.key,r.batchId);return n=n.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)}).next(()=>{this.Yr=n})}rr(e){}containsKey(e,r){const n=new ln(r,0),a=this.Yr.firstAfterOrEqual(n);return Oe.resolve(r.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,Oe.resolve()}ti(e,r){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const r=this.Xr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gD{constructor(e){this.ni=e,this.docs=function(){return new yr(tt.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,a=this.docs.get(n),o=a?a.size:0,l=this.ni(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:l}),this.size+=l-o,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Oe.resolve(n?n.document.mutableCopy():In.newInvalidDocument(r))}getEntries(e,r){let n=xs();return r.forEach(a=>{const o=this.docs.get(a);n=n.insert(a,o?o.document.mutableCopy():In.newInvalidDocument(a))}),Oe.resolve(n)}getDocumentsMatchingQuery(e,r,n,a){let o=xs();const l=r.path,u=new tt(l.child("__id-9223372036854775808__")),f=this.docs.getIteratorFrom(u);for(;f.hasNext();){const{key:d,value:{document:m}}=f.getNext();if(!l.isPrefixOf(d.path))break;d.path.length>l.length+1||WN(qN(m),n)<=0||(a.has(m.key)||pm(r,m))&&(o=o.insert(m.key,m.mutableCopy()))}return Oe.resolve(o)}getAllFromCollectionGroup(e,r,n,a){ct(9500)}ri(e,r){return Oe.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new xD(this)}getSize(e){return Oe.resolve(this.size)}}class xD extends cD{constructor(e){super(),this.Or=e}applyChanges(e){const r=[];return this.changes.forEach((n,a)=>{a.isValidDocument()?r.push(this.Or.addEntry(e,a)):this.Or.removeEntry(n)}),Oe.waitFor(r)}getFromCache(e,r){return this.Or.getEntry(e,r)}getAllFromCache(e,r){return this.Or.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vD{constructor(e){this.persistence=e,this.ii=new Il(r=>Tx(r),bx),this.lastRemoteSnapshotVersion=gt.min(),this.highestTargetId=0,this.si=0,this.oi=new Nx,this.targetCount=0,this._i=Qc.ar()}forEachTarget(e,r){return this.ii.forEach((n,a)=>r(a)),Oe.resolve()}getLastRemoteSnapshotVersion(e){return Oe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Oe.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),Oe.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.si&&(this.si=r),Oe.resolve()}hr(e){this.ii.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this._i=new Qc(r),this.highestTargetId=r),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,r){return this.hr(r),this.targetCount+=1,Oe.resolve()}updateTargetData(e,r){return this.hr(r),Oe.resolve()}removeTargetData(e,r){return this.ii.delete(r.target),this.oi.zr(r.targetId),this.targetCount-=1,Oe.resolve()}removeTargets(e,r,n){let a=0;const o=[];return this.ii.forEach((l,u)=>{u.sequenceNumber<=r&&n.get(u.targetId)===null&&(this.ii.delete(l),o.push(this.removeMatchingKeysForTargetId(e,u.targetId)),a++)}),Oe.waitFor(o).next(()=>a)}getTargetCount(e){return Oe.resolve(this.targetCount)}getTargetData(e,r){const n=this.ii.get(r)||null;return Oe.resolve(n)}addMatchingKeys(e,r,n){return this.oi.Kr(r,n),Oe.resolve()}removeMatchingKeys(e,r,n){this.oi.Gr(r,n);const a=this.persistence.referenceDelegate,o=[];return a&&r.forEach(l=>{o.push(a.markPotentiallyOrphaned(e,l))}),Oe.waitFor(o)}removeMatchingKeysForTargetId(e,r){return this.oi.zr(r),Oe.resolve()}getMatchingKeysForTargetId(e,r){const n=this.oi.Jr(r);return Oe.resolve(n)}containsKey(e,r){return Oe.resolve(this.oi.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kS{constructor(e,r){this.ai={},this.overlays={},this.ui=new fm(0),this.ci=!1,this.ci=!0,this.li=new mD,this.referenceDelegate=e(this),this.hi=new vD(this),this.indexManager=new rD,this.remoteDocumentCache=function(a){return new gD(a)}(n=>this.referenceDelegate.Pi(n)),this.serializer=new eD(r),this.Ti=new hD(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new dD,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ai[e.toKey()];return n||(n=new pD(r,this.referenceDelegate),this.ai[e.toKey()]=n),n}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,r,n){Ye("MemoryPersistence","Starting transaction:",e);const a=new _D(this.ui.next());return this.referenceDelegate.Ii(),n(a).next(o=>this.referenceDelegate.di(a).next(()=>o)).toPromise().then(o=>(a.raiseOnCommittedEvent(),o))}Ei(e,r){return Oe.or(Object.values(this.ai).map(n=>()=>n.containsKey(e,r)))}}class _D extends KN{constructor(e){super(),this.currentSequenceNumber=e}}class Ix{constructor(e){this.persistence=e,this.Ai=new Nx,this.Ri=null}static Vi(e){return new Ix(e)}get mi(){if(this.Ri)return this.Ri;throw ct(60996)}addReference(e,r,n){return this.Ai.addReference(n,r),this.mi.delete(n.toString()),Oe.resolve()}removeReference(e,r,n){return this.Ai.removeReference(n,r),this.mi.add(n.toString()),Oe.resolve()}markPotentiallyOrphaned(e,r){return this.mi.add(r.toString()),Oe.resolve()}removeTarget(e,r){this.Ai.zr(r.targetId).forEach(a=>this.mi.add(a.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(a=>{a.forEach(o=>this.mi.add(o.toString()))}).next(()=>n.removeTargetData(e,r))}Ii(){this.Ri=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Oe.forEach(this.mi,n=>{const a=tt.fromPath(n);return this.fi(e,a).next(o=>{o||r.removeEntry(a,gt.min())})}).next(()=>(this.Ri=null,r.apply(e)))}updateLimboDocument(e,r){return this.fi(e,r).next(n=>{n?this.mi.delete(r.toString()):this.mi.add(r.toString())})}Pi(e){return 0}fi(e,r){return Oe.or([()=>Oe.resolve(this.Ai.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ei(e,r)])}}class Bd{constructor(e,r){this.persistence=e,this.gi=new Il(n=>QN(n.path),(n,a)=>n.isEqual(a)),this.garbageCollector=lD(this,r)}static Vi(e,r){return new Bd(e,r)}Ii(){}di(e){return Oe.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}mr(e){const r=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(a=>n+a))}yr(e){let r=0;return this.gr(e,n=>{r++}).next(()=>r)}gr(e,r){return Oe.forEach(this.gi,(n,a)=>this.Sr(e,n,a).next(o=>o?Oe.resolve():r(a)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const a=this.persistence.getRemoteDocumentCache(),o=a.newChangeBuffer();return a.ri(e,l=>this.Sr(e,l,r).next(u=>{u||(n++,o.removeEntry(l,gt.min()))})).next(()=>o.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.gi.set(r,e.currentSequenceNumber),Oe.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.gi.set(n,e.currentSequenceNumber),Oe.resolve()}removeReference(e,r,n){return this.gi.set(n,e.currentSequenceNumber),Oe.resolve()}updateLimboDocument(e,r){return this.gi.set(r,e.currentSequenceNumber),Oe.resolve()}Pi(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=vd(e.data.value)),r}Sr(e,r,n){return Oe.or([()=>this.persistence.Ei(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const a=this.gi.get(r);return Oe.resolve(a!==void 0&&a>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dx{constructor(e,r,n,a){this.targetId=e,this.fromCache=r,this.Is=n,this.ds=a}static Es(e,r){let n=It(),a=It();for(const o of r.docChanges)switch(o.type){case 0:n=n.add(o.doc.key);break;case 1:a=a.add(o.doc.key)}return new Dx(e,r.fromCache,n,a)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yD{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wD{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=function(){return mR()?8:YN(Pn())>0?6:4}()}initialize(e,r){this.gs=e,this.indexManager=r,this.As=!0}getDocumentsMatchingQuery(e,r,n,a){const o={result:null};return this.ps(e,r).next(l=>{o.result=l}).next(()=>{if(!o.result)return this.ys(e,r,a,n).next(l=>{o.result=l})}).next(()=>{if(o.result)return;const l=new yD;return this.ws(e,r,l).next(u=>{if(o.result=u,this.Rs)return this.Ss(e,r,l,u.size)})}).next(()=>o.result)}Ss(e,r,n,a){return n.documentReadCount<this.Vs?(Nc()<=Nt.DEBUG&&Ye("QueryEngine","SDK will not create cache indexes for query:",Ic(r),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),Oe.resolve()):(Nc()<=Nt.DEBUG&&Ye("QueryEngine","Query:",Ic(r),"scans",n.documentReadCount,"local documents and returns",a,"documents as results."),n.documentReadCount>this.fs*a?(Nc()<=Nt.DEBUG&&Ye("QueryEngine","The SDK decides to create cache indexes for query:",Ic(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ii(r))):Oe.resolve())}ps(e,r){if(Jw(r))return Oe.resolve(null);let n=Ii(r);return this.indexManager.getIndexType(e,n).next(a=>a===0?null:(r.limit!==null&&a===1&&(r=F1(r,null,"F"),n=Ii(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(o=>{const l=It(...o);return this.gs.getDocuments(e,l).next(u=>this.indexManager.getMinOffset(e,n).next(f=>{const d=this.bs(r,u);return this.Ds(r,d,l,f.readTime)?this.ps(e,F1(r,null,"F")):this.vs(e,d,r,f)}))})))}ys(e,r,n,a){return Jw(r)||a.isEqual(gt.min())?Oe.resolve(null):this.gs.getDocuments(e,n).next(o=>{const l=this.bs(r,o);return this.Ds(r,l,n,a)?Oe.resolve(null):(Nc()<=Nt.DEBUG&&Ye("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),Ic(r)),this.vs(e,l,r,GN(a,Hf)).next(u=>u))})}bs(e,r){let n=new en(iS(e));return r.forEach((a,o)=>{pm(e,o)&&(n=n.add(o))}),n}Ds(e,r,n,a){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const o=e.limitType==="F"?r.last():r.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(a)>0)}ws(e,r,n){return Nc()<=Nt.DEBUG&&Ye("QueryEngine","Using full collection scan to execute query:",Ic(r)),this.gs.getDocumentsMatchingQuery(e,r,po.min(),n)}vs(e,r,n,a){return this.gs.getDocumentsMatchingQuery(e,n,a).next(o=>(r.forEach(l=>{o=o.insert(l.key,l)}),o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ox="LocalStore",ED=3e8;class TD{constructor(e,r,n,a){this.persistence=e,this.Cs=r,this.serializer=a,this.Fs=new yr(Tt),this.Ms=new Il(o=>Tx(o),bx),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(n)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new fD(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.Fs))}}function bD(t,e,r,n){return new TD(t,e,r,n)}async function CS(t,e){const r=xt(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let a;return r.mutationQueue.getAllMutationBatches(n).next(o=>(a=o,r.Ns(e),r.mutationQueue.getAllMutationBatches(n))).next(o=>{const l=[],u=[];let f=It();for(const d of a){l.push(d.batchId);for(const m of d.mutations)f=f.add(m.key)}for(const d of o){u.push(d.batchId);for(const m of d.mutations)f=f.add(m.key)}return r.localDocuments.getDocuments(n,f).next(d=>({Bs:d,removedBatchIds:l,addedBatchIds:u}))})})}function SD(t,e){const r=xt(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const a=e.batch.keys(),o=r.Os.newChangeBuffer({trackRemovals:!0});return function(u,f,d,m){const v=d.batch,_=v.keys();let E=Oe.resolve();return _.forEach(S=>{E=E.next(()=>m.getEntry(f,S)).next(w=>{const b=d.docVersions.get(S);Xt(b!==null,48541),w.version.compareTo(b)<0&&(v.applyToRemoteDocument(w,d),w.isValidDocument()&&(w.setReadTime(d.commitVersion),m.addEntry(w)))})}),E.next(()=>u.mutationQueue.removeMutationBatch(f,v))}(r,n,e,o).next(()=>o.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,a,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(u){let f=It();for(let d=0;d<u.mutationResults.length;++d)u.mutationResults[d].transformResults.length>0&&(f=f.add(u.batch.mutations[d].key));return f}(e))).next(()=>r.localDocuments.getDocuments(n,a))})}function RS(t){const e=xt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.hi.getLastRemoteSnapshotVersion(r))}function AD(t,e){const r=xt(t),n=e.snapshotVersion;let a=r.Fs;return r.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const l=r.Os.newChangeBuffer({trackRemovals:!0});a=r.Fs;const u=[];e.targetChanges.forEach((m,v)=>{const _=a.get(v);if(!_)return;u.push(r.hi.removeMatchingKeys(o,m.removedDocuments,v).next(()=>r.hi.addMatchingKeys(o,m.addedDocuments,v)));let E=_.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(v)!==null?E=E.withResumeToken(En.EMPTY_BYTE_STRING,gt.min()).withLastLimboFreeSnapshotVersion(gt.min()):m.resumeToken.approximateByteSize()>0&&(E=E.withResumeToken(m.resumeToken,n)),a=a.insert(v,E),function(w,b,L){return w.resumeToken.approximateByteSize()===0||b.snapshotVersion.toMicroseconds()-w.snapshotVersion.toMicroseconds()>=ED?!0:L.addedDocuments.size+L.modifiedDocuments.size+L.removedDocuments.size>0}(_,E,m)&&u.push(r.hi.updateTargetData(o,E))});let f=xs(),d=It();if(e.documentUpdates.forEach(m=>{e.resolvedLimboDocuments.has(m)&&u.push(r.persistence.referenceDelegate.updateLimboDocument(o,m))}),u.push(kD(o,l,e.documentUpdates).next(m=>{f=m.Ls,d=m.ks})),!n.isEqual(gt.min())){const m=r.hi.getLastRemoteSnapshotVersion(o).next(v=>r.hi.setTargetsMetadata(o,o.currentSequenceNumber,n));u.push(m)}return Oe.waitFor(u).next(()=>l.apply(o)).next(()=>r.localDocuments.getLocalViewOfDocuments(o,f,d)).next(()=>f)}).then(o=>(r.Fs=a,o))}function kD(t,e,r){let n=It(),a=It();return r.forEach(o=>n=n.add(o)),e.getEntries(t,n).next(o=>{let l=xs();return r.forEach((u,f)=>{const d=o.get(u);f.isFoundDocument()!==d.isFoundDocument()&&(a=a.add(u)),f.isNoDocument()&&f.version.isEqual(gt.min())?(e.removeEntry(u,f.readTime),l=l.insert(u,f)):!d.isValidDocument()||f.version.compareTo(d.version)>0||f.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(f),l=l.insert(u,f)):Ye(Ox,"Ignoring outdated watch update for ",u,". Current version:",d.version," Watch version:",f.version)}),{Ls:l,ks:a}})}function CD(t,e){const r=xt(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=yx),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function RD(t,e){const r=xt(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let a;return r.hi.getTargetData(n,e).next(o=>o?(a=o,Oe.resolve(a)):r.hi.allocateTargetId(n).next(l=>(a=new no(e,l,"TargetPurposeListen",n.currentSequenceNumber),r.hi.addTargetData(n,a).next(()=>a))))}).then(n=>{const a=r.Fs.get(n.targetId);return(a===null||n.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(r.Fs=r.Fs.insert(n.targetId,n),r.Ms.set(e,n.targetId)),n})}async function B1(t,e,r){const n=xt(t),a=n.Fs.get(e),o=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",o,l=>n.persistence.referenceDelegate.removeTarget(l,a))}catch(l){if(!au(l))throw l;Ye(Ox,`Failed to update sequence numbers for target ${e}: ${l}`)}n.Fs=n.Fs.remove(e),n.Ms.delete(a.target)}function hE(t,e,r){const n=xt(t);let a=gt.min(),o=It();return n.persistence.runTransaction("Execute query","readwrite",l=>function(f,d,m){const v=xt(f),_=v.Ms.get(m);return _!==void 0?Oe.resolve(v.Fs.get(_)):v.hi.getTargetData(d,m)}(n,l,Ii(e)).next(u=>{if(u)return a=u.lastLimboFreeSnapshotVersion,n.hi.getMatchingKeysForTargetId(l,u.targetId).next(f=>{o=f})}).next(()=>n.Cs.getDocumentsMatchingQuery(l,e,r?a:gt.min(),r?o:It())).next(u=>(ND(n,gI(e),u),{documents:u,qs:o})))}function ND(t,e,r){let n=t.xs.get(e)||gt.min();r.forEach((a,o)=>{o.readTime.compareTo(n)>0&&(n=o.readTime)}),t.xs.set(e,n)}class dE{constructor(){this.activeTargetIds=EI()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class ID{constructor(){this.Fo=new dE,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,r,n){this.Mo[e]=r}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new dE,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DD{xo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mE="ConnectivityMonitor";class pE{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){Ye(mE,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){Ye(mE,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ed=null;function V1(){return ed===null?ed=function(){return 268435456+Math.round(2147483648*Math.random())}():ed++,"0x"+ed.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yg="RestConnection",OD={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class FD{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.$o=r+"://"+e.host,this.Uo=`projects/${n}/databases/${a}`,this.Ko=this.databaseId.database===Dd?`project_id=${n}`:`project_id=${n}&database_id=${a}`}Wo(e,r,n,a,o){const l=V1(),u=this.Go(e,r.toUriEncodedString());Ye(Yg,`Sending RPC '${e}' ${l}:`,u,n);const f={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(f,a,o);const{host:d}=new URL(u),m=So(d);return this.jo(e,u,f,n,m).then(v=>(Ye(Yg,`Received RPC '${e}' ${l}: `,v),v),v=>{throw mo(Yg,`RPC '${e}' ${l} failed with error: `,v,"url: ",u,"request:",n),v})}Jo(e,r,n,a,o,l){return this.Wo(e,r,n,a,o)}zo(e,r,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ru}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((a,o)=>e[o]=a),n&&n.headers.forEach((a,o)=>e[o]=a)}Go(e,r){const n=OD[e];return`${this.$o}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PD{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const An="WebChannelConnection";class LD extends FD{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,r,n,a,o){const l=V1();return new Promise((u,f)=>{const d=new Nb;d.setWithCredentials(!0),d.listenOnce(Ib.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case xd.NO_ERROR:const v=d.getResponseJson();Ye(An,`XHR for RPC '${e}' ${l} received:`,JSON.stringify(v)),u(v);break;case xd.TIMEOUT:Ye(An,`RPC '${e}' ${l} timed out`),f(new $e(Ne.DEADLINE_EXCEEDED,"Request time out"));break;case xd.HTTP_ERROR:const _=d.getStatus();if(Ye(An,`RPC '${e}' ${l} failed with status:`,_,"response text:",d.getResponseText()),_>0){let E=d.getResponseJson();Array.isArray(E)&&(E=E[0]);const S=E==null?void 0:E.error;if(S&&S.status&&S.message){const w=function(L){const B=L.toLowerCase().replace(/_/g,"-");return Object.values(Ne).indexOf(B)>=0?B:Ne.UNKNOWN}(S.status);f(new $e(w,S.message))}else f(new $e(Ne.UNKNOWN,"Server responded with status "+d.getStatus()))}else f(new $e(Ne.UNAVAILABLE,"Connection failed."));break;default:ct(9055,{c_:e,streamId:l,l_:d.getLastErrorCode(),h_:d.getLastError()})}}finally{Ye(An,`RPC '${e}' ${l} completed.`)}});const m=JSON.stringify(a);Ye(An,`RPC '${e}' ${l} sending request:`,a),d.send(r,"POST",m,n,15)})}P_(e,r,n){const a=V1(),o=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],l=Fb(),u=Ob(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(f.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(f.useFetchStreams=!0),this.zo(f.initMessageHeaders,r,n),f.encodeInitMessageHeaders=!0;const m=o.join("");Ye(An,`Creating RPC '${e}' stream ${a}: ${m}`,f);const v=l.createWebChannel(m,f);this.T_(v);let _=!1,E=!1;const S=new PD({Ho:b=>{E?Ye(An,`Not sending because RPC '${e}' stream ${a} is closed:`,b):(_||(Ye(An,`Opening RPC '${e}' stream ${a} transport.`),v.open(),_=!0),Ye(An,`RPC '${e}' stream ${a} sending:`,b),v.send(b))},Yo:()=>v.close()}),w=(b,L,B)=>{b.listen(L,F=>{try{B(F)}catch(z){setTimeout(()=>{throw z},0)}})};return w(v,xf.EventType.OPEN,()=>{E||(Ye(An,`RPC '${e}' stream ${a} transport opened.`),S.s_())}),w(v,xf.EventType.CLOSE,()=>{E||(E=!0,Ye(An,`RPC '${e}' stream ${a} transport closed`),S.__(),this.I_(v))}),w(v,xf.EventType.ERROR,b=>{E||(E=!0,mo(An,`RPC '${e}' stream ${a} transport errored. Name:`,b.name,"Message:",b.message),S.__(new $e(Ne.UNAVAILABLE,"The operation could not be completed")))}),w(v,xf.EventType.MESSAGE,b=>{var L;if(!E){const B=b.data[0];Xt(!!B,16349);const F=B,z=(F==null?void 0:F.error)||((L=F[0])===null||L===void 0?void 0:L.error);if(z){Ye(An,`RPC '${e}' stream ${a} received error:`,z);const q=z.status;let W=function(A){const O=Hr[A];if(O!==void 0)return gS(O)}(q),k=z.message;W===void 0&&(W=Ne.INTERNAL,k="Unknown error status: "+q+" with message "+z.message),E=!0,S.__(new $e(W,k)),v.close()}else Ye(An,`RPC '${e}' stream ${a} received:`,B),S.a_(B)}}),w(u,Db.STAT_EVENT,b=>{b.stat===k1.PROXY?Ye(An,`RPC '${e}' stream ${a} detected buffering proxy`):b.stat===k1.NOPROXY&&Ye(An,`RPC '${e}' stream ${a} detected no buffering proxy`)}),setTimeout(()=>{S.o_()},0),S}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(r=>r===e)}}function $g(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _m(t){return new VI(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NS{constructor(e,r,n=1e3,a=1.5,o=6e4){this.Fi=e,this.timerId=r,this.d_=n,this.E_=a,this.A_=o,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const r=Math.floor(this.R_+this.p_()),n=Math.max(0,Date.now()-this.m_),a=Math.max(0,r-n);a>0&&Ye("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.R_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,a,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gE="PersistentStream";class IS{constructor(e,r,n,a,o,l,u,f){this.Fi=e,this.w_=n,this.S_=a,this.connection=o,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=u,this.listener=f,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new NS(e,r)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():r&&r.code===Ne.RESOURCE_EXHAUSTED?(gs(r.toString()),gs("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):r&&r.code===Ne.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(r)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),r=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,a])=>{this.b_===r&&this.W_(n,a)},n=>{e(()=>{const a=new $e(Ne.UNKNOWN,"Fetching auth token failed: "+n.message);return this.G_(a)})})}W_(e,r){const n=this.K_(this.b_);this.stream=this.z_(e,r),this.stream.Zo(()=>{n(()=>this.listener.Zo())}),this.stream.e_(()=>{n(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(a=>{n(()=>this.G_(a))}),this.stream.onMessage(a=>{n(()=>++this.C_==1?this.j_(a):this.onNext(a))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(e){return Ye(gE,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return r=>{this.Fi.enqueueAndForget(()=>this.b_===e?r():(Ye(gE,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class MD extends IS{constructor(e,r,n,a,o,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,a,l),this.serializer=o}z_(e,r){return this.connection.P_("Listen",e,r)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const r=zI(this.serializer,e),n=function(o){if(!("targetChange"in o))return gt.min();const l=o.targetChange;return l.targetIds&&l.targetIds.length?gt.min():l.readTime?Di(l.readTime):gt.min()}(e);return this.listener.J_(r,n)}H_(e){const r={};r.database=U1(this.serializer),r.addTarget=function(o,l){let u;const f=l.target;if(u=D1(f)?{documents:WI(o,f)}:{query:XI(o,f).Vt},u.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){u.resumeToken=_S(o,l.resumeToken);const d=P1(o,l.expectedCount);d!==null&&(u.expectedCount=d)}else if(l.snapshotVersion.compareTo(gt.min())>0){u.readTime=Ud(o,l.snapshotVersion.toTimestamp());const d=P1(o,l.expectedCount);d!==null&&(u.expectedCount=d)}return u}(this.serializer,e);const n=YI(this.serializer,e);n&&(r.labels=n),this.k_(r)}Y_(e){const r={};r.database=U1(this.serializer),r.removeTarget=e,this.k_(r)}}class UD extends IS{constructor(e,r,n,a,o,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,a,l),this.serializer=o}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,r){return this.connection.P_("Write",e,r)}j_(e){return Xt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Xt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){Xt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const r=qI(e.writeResults,e.commitTime),n=Di(e.commitTime);return this.listener.ta(n,r)}na(){const e={};e.database=U1(this.serializer),this.k_(e)}X_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>GI(this.serializer,n))};this.k_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BD{}class VD extends BD{constructor(e,r,n,a){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=a,this.ra=!1}ia(){if(this.ra)throw new $e(Ne.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,r,n,a){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Wo(e,L1(r,n),a,o,l)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Ne.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new $e(Ne.UNKNOWN,o.toString())})}Jo(e,r,n,a,o){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([l,u])=>this.connection.Jo(e,L1(r,n),a,l,u,o)).catch(l=>{throw l.name==="FirebaseError"?(l.code===Ne.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new $e(Ne.UNKNOWN,l.toString())})}terminate(){this.ra=!0,this.connection.terminate()}}class jD{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(gs(r),this._a=!1):Ye("OnlineStateTracker",r)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yl="RemoteStore";class HD{constructor(e,r,n,a,o){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=o,this.Ea.xo(l=>{n.enqueueAndForget(async()=>{Dl(this)&&(Ye(yl,"Restarting streams for network reachability change."),await async function(f){const d=xt(f);d.Ia.add(4),await g0(d),d.Aa.set("Unknown"),d.Ia.delete(4),await ym(d)}(this))})}),this.Aa=new jD(n,a)}}async function ym(t){if(Dl(t))for(const e of t.da)await e(!0)}async function g0(t){for(const e of t.da)await e(!1)}function DS(t,e){const r=xt(t);r.Ta.has(e.targetId)||(r.Ta.set(e.targetId,e),Mx(r)?Lx(r):iu(r).x_()&&Px(r,e))}function Fx(t,e){const r=xt(t),n=iu(r);r.Ta.delete(e),n.x_()&&OS(r,e),r.Ta.size===0&&(n.x_()?n.B_():Dl(r)&&r.Aa.set("Unknown"))}function Px(t,e){if(t.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(gt.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}iu(t).H_(e)}function OS(t,e){t.Ra.$e(e),iu(t).Y_(e)}function Lx(t){t.Ra=new LI({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>t.Ta.get(e)||null,lt:()=>t.datastore.serializer.databaseId}),iu(t).start(),t.Aa.aa()}function Mx(t){return Dl(t)&&!iu(t).M_()&&t.Ta.size>0}function Dl(t){return xt(t).Ia.size===0}function FS(t){t.Ra=void 0}async function zD(t){t.Aa.set("Online")}async function GD(t){t.Ta.forEach((e,r)=>{Px(t,e)})}async function qD(t,e){FS(t),Mx(t)?(t.Aa.la(e),Lx(t)):t.Aa.set("Unknown")}async function WD(t,e,r){if(t.Aa.set("Online"),e instanceof vS&&e.state===2&&e.cause)try{await async function(a,o){const l=o.cause;for(const u of o.targetIds)a.Ta.has(u)&&(await a.remoteSyncer.rejectListen(u,l),a.Ta.delete(u),a.Ra.removeTarget(u))}(t,e)}catch(n){Ye(yl,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Vd(t,n)}else if(e instanceof wd?t.Ra.Ye(e):e instanceof xS?t.Ra.it(e):t.Ra.et(e),!r.isEqual(gt.min()))try{const n=await RS(t.localStore);r.compareTo(n)>=0&&await function(o,l){const u=o.Ra.Pt(l);return u.targetChanges.forEach((f,d)=>{if(f.resumeToken.approximateByteSize()>0){const m=o.Ta.get(d);m&&o.Ta.set(d,m.withResumeToken(f.resumeToken,l))}}),u.targetMismatches.forEach((f,d)=>{const m=o.Ta.get(f);if(!m)return;o.Ta.set(f,m.withResumeToken(En.EMPTY_BYTE_STRING,m.snapshotVersion)),OS(o,f);const v=new no(m.target,f,d,m.sequenceNumber);Px(o,v)}),o.remoteSyncer.applyRemoteEvent(u)}(t,r)}catch(n){Ye(yl,"Failed to raise snapshot:",n),await Vd(t,n)}}async function Vd(t,e,r){if(!au(e))throw e;t.Ia.add(1),await g0(t),t.Aa.set("Offline"),r||(r=()=>RS(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Ye(yl,"Retrying IndexedDB access"),await r(),t.Ia.delete(1),await ym(t)})}function PS(t,e){return e().catch(r=>Vd(t,r,e))}async function wm(t){const e=xt(t),r=_o(e);let n=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:yx;for(;XD(e);)try{const a=await CD(e.localStore,n);if(a===null){e.Pa.length===0&&r.B_();break}n=a.batchId,KD(e,a)}catch(a){await Vd(e,a)}LS(e)&&MS(e)}function XD(t){return Dl(t)&&t.Pa.length<10}function KD(t,e){t.Pa.push(e);const r=_o(t);r.x_()&&r.Z_&&r.X_(e.mutations)}function LS(t){return Dl(t)&&!_o(t).M_()&&t.Pa.length>0}function MS(t){_o(t).start()}async function YD(t){_o(t).na()}async function $D(t){const e=_o(t);for(const r of t.Pa)e.X_(r.mutations)}async function QD(t,e,r){const n=t.Pa.shift(),a=kx.from(n,e,r);await PS(t,()=>t.remoteSyncer.applySuccessfulWrite(a)),await wm(t)}async function ZD(t,e){e&&_o(t).Z_&&await async function(n,a){if(function(l){return FI(l)&&l!==Ne.ABORTED}(a.code)){const o=n.Pa.shift();_o(n).N_(),await PS(n,()=>n.remoteSyncer.rejectFailedWrite(o.batchId,a)),await wm(n)}}(t,e),LS(t)&&MS(t)}async function xE(t,e){const r=xt(t);r.asyncQueue.verifyOperationInProgress(),Ye(yl,"RemoteStore received new credentials");const n=Dl(r);r.Ia.add(3),await g0(r),n&&r.Aa.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ia.delete(3),await ym(r)}async function JD(t,e){const r=xt(t);e?(r.Ia.delete(2),await ym(r)):e||(r.Ia.add(2),await g0(r),r.Aa.set("Unknown"))}function iu(t){return t.Va||(t.Va=function(r,n,a){const o=xt(r);return o.ia(),new MD(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,a)}(t.datastore,t.asyncQueue,{Zo:zD.bind(null,t),e_:GD.bind(null,t),n_:qD.bind(null,t),J_:WD.bind(null,t)}),t.da.push(async e=>{e?(t.Va.N_(),Mx(t)?Lx(t):t.Aa.set("Unknown")):(await t.Va.stop(),FS(t))})),t.Va}function _o(t){return t.ma||(t.ma=function(r,n,a){const o=xt(r);return o.ia(),new UD(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,a)}(t.datastore,t.asyncQueue,{Zo:()=>Promise.resolve(),e_:YD.bind(null,t),n_:ZD.bind(null,t),ea:$D.bind(null,t),ta:QD.bind(null,t)}),t.da.push(async e=>{e?(t.ma.N_(),await wm(t)):(await t.ma.stop(),t.Pa.length>0&&(Ye(yl,`Stopping write stream with ${t.Pa.length} pending writes`),t.Pa=[]))})),t.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ux{constructor(e,r,n,a,o){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=a,this.removalCallback=o,this.deferred=new uo,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(l=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,a,o){const l=Date.now()+n,u=new Ux(e,r,l,a,o);return u.start(n),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new $e(Ne.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Bx(t,e){if(gs("AsyncQueue",`${e}: ${t}`),au(t))return new $e(Ne.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mc{static emptySet(e){return new Mc(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||tt.comparator(r.key,n.key):(r,n)=>tt.comparator(r.key,n.key),this.keyedMap=vf(),this.sortedSet=new yr(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof Mc)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const a=r.getNext().key,o=n.getNext().key;if(!a.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new Mc;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vE{constructor(){this.fa=new yr(tt.comparator)}track(e){const r=e.doc.key,n=this.fa.get(r);n?e.type!==0&&n.type===3?this.fa=this.fa.insert(r,e):e.type===3&&n.type!==1?this.fa=this.fa.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.fa=this.fa.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.fa=this.fa.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.fa=this.fa.remove(r):e.type===1&&n.type===2?this.fa=this.fa.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.fa=this.fa.insert(r,{type:2,doc:e.doc}):ct(63341,{At:e,ga:n}):this.fa=this.fa.insert(r,e)}pa(){const e=[];return this.fa.inorderTraversal((r,n)=>{e.push(n)}),e}}class Zc{constructor(e,r,n,a,o,l,u,f,d){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=a,this.mutatedKeys=o,this.fromCache=l,this.syncStateChanged=u,this.excludesMetadataChanges=f,this.hasCachedResults=d}static fromInitialDocuments(e,r,n,a,o){const l=[];return r.forEach(u=>{l.push({type:0,doc:u})}),new Zc(e,r,Mc.emptySet(r),l,n,a,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&mm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let a=0;a<r.length;a++)if(r[a].type!==n[a].type||!r[a].doc.isEqual(n[a].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e6{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(e=>e.ba())}}class t6{constructor(){this.queries=_E(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(r,n){const a=xt(r),o=a.queries;a.queries=_E(),o.forEach((l,u)=>{for(const f of u.wa)f.onError(n)})})(this,new $e(Ne.ABORTED,"Firestore shutting down"))}}function _E(){return new Il(t=>aS(t),mm)}async function r6(t,e){const r=xt(t);let n=3;const a=e.query;let o=r.queries.get(a);o?!o.Sa()&&e.ba()&&(n=2):(o=new e6,n=e.ba()?0:1);try{switch(n){case 0:o.ya=await r.onListen(a,!0);break;case 1:o.ya=await r.onListen(a,!1);break;case 2:await r.onFirstRemoteStoreListen(a)}}catch(l){const u=Bx(l,`Initialization of query '${Ic(e.query)}' failed`);return void e.onError(u)}r.queries.set(a,o),o.wa.push(e),e.va(r.onlineState),o.ya&&e.Ca(o.ya)&&Vx(r)}async function n6(t,e){const r=xt(t),n=e.query;let a=3;const o=r.queries.get(n);if(o){const l=o.wa.indexOf(e);l>=0&&(o.wa.splice(l,1),o.wa.length===0?a=e.ba()?0:1:!o.Sa()&&e.ba()&&(a=2))}switch(a){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function a6(t,e){const r=xt(t);let n=!1;for(const a of e){const o=a.query,l=r.queries.get(o);if(l){for(const u of l.wa)u.Ca(a)&&(n=!0);l.ya=a}}n&&Vx(r)}function i6(t,e,r){const n=xt(t),a=n.queries.get(e);if(a)for(const o of a.wa)o.onError(r);n.queries.delete(e)}function Vx(t){t.Da.forEach(e=>{e.next()})}var j1,yE;(yE=j1||(j1={})).Fa="default",yE.Cache="cache";class s6{constructor(e,r,n){this.query=e,this.Ma=r,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=n||{}}Ca(e){if(!this.options.includeMetadataChanges){const n=[];for(const a of e.docChanges)a.type!==3&&n.push(a);e=new Zc(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),r=!0):this.Ba(e,this.onlineState)&&(this.La(e),r=!0),this.Oa=e,r}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let r=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),r=!0),r}Ba(e,r){if(!e.fromCache||!this.ba())return!0;const n=r!=="Offline";return(!this.options.ka||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Na(e){if(e.docChanges.length>0)return!0;const r=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}La(e){e=Zc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==j1.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class US{constructor(e){this.key=e}}class BS{constructor(e){this.key=e}}class o6{constructor(e,r){this.query=e,this.Ha=r,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=It(),this.mutatedKeys=It(),this.Xa=iS(e),this.eu=new Mc(this.Xa)}get tu(){return this.Ha}nu(e,r){const n=r?r.ru:new vE,a=r?r.eu:this.eu;let o=r?r.mutatedKeys:this.mutatedKeys,l=a,u=!1;const f=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,d=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal((m,v)=>{const _=a.get(m),E=pm(this.query,v)?v:null,S=!!_&&this.mutatedKeys.has(_.key),w=!!E&&(E.hasLocalMutations||this.mutatedKeys.has(E.key)&&E.hasCommittedMutations);let b=!1;_&&E?_.data.isEqual(E.data)?S!==w&&(n.track({type:3,doc:E}),b=!0):this.iu(_,E)||(n.track({type:2,doc:E}),b=!0,(f&&this.Xa(E,f)>0||d&&this.Xa(E,d)<0)&&(u=!0)):!_&&E?(n.track({type:0,doc:E}),b=!0):_&&!E&&(n.track({type:1,doc:_}),b=!0,(f||d)&&(u=!0)),b&&(E?(l=l.add(E),o=w?o.add(m):o.delete(m)):(l=l.delete(m),o=o.delete(m)))}),this.query.limit!==null)for(;l.size>this.query.limit;){const m=this.query.limitType==="F"?l.last():l.first();l=l.delete(m.key),o=o.delete(m.key),n.track({type:1,doc:m})}return{eu:l,ru:n,Ds:u,mutatedKeys:o}}iu(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,a){const o=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const l=e.ru.pa();l.sort((m,v)=>function(E,S){const w=b=>{switch(b){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ct(20277,{At:b})}};return w(E)-w(S)}(m.type,v.type)||this.Xa(m.doc,v.doc)),this.su(n),a=a!=null&&a;const u=r&&!a?this.ou():[],f=this.Za.size===0&&this.current&&!a?1:0,d=f!==this.Ya;return this.Ya=f,l.length!==0||d?{snapshot:new Zc(this.query,e.eu,o,l,e.mutatedKeys,f===0,d,!1,!!n&&n.resumeToken.approximateByteSize()>0),_u:u}:{_u:u}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new vE,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach(r=>this.Ha=this.Ha.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ha=this.Ha.delete(r)),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=It(),this.eu.forEach(n=>{this.au(n.key)&&(this.Za=this.Za.add(n.key))});const r=[];return e.forEach(n=>{this.Za.has(n)||r.push(new BS(n))}),this.Za.forEach(n=>{e.has(n)||r.push(new US(n))}),r}uu(e){this.Ha=e.qs,this.Za=It();const r=this.nu(e.documents);return this.applyChanges(r,!0)}cu(){return Zc.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const jx="SyncEngine";class l6{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class c6{constructor(e){this.key=e,this.lu=!1}}class u6{constructor(e,r,n,a,o,l){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=a,this.currentUser=o,this.maxConcurrentLimboResolutions=l,this.hu={},this.Pu=new Il(u=>aS(u),mm),this.Tu=new Map,this.Iu=new Set,this.du=new yr(tt.comparator),this.Eu=new Map,this.Au=new Nx,this.Ru={},this.Vu=new Map,this.mu=Qc.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function f6(t,e,r=!0){const n=qS(t);let a;const o=n.Pu.get(e);return o?(n.sharedClientState.addLocalQueryTarget(o.targetId),a=o.view.cu()):a=await VS(n,e,r,!0),a}async function h6(t,e){const r=qS(t);await VS(r,e,!0,!1)}async function VS(t,e,r,n){const a=await RD(t.localStore,Ii(e)),o=a.targetId,l=t.sharedClientState.addLocalQueryTarget(o,r);let u;return n&&(u=await d6(t,e,o,l==="current",a.resumeToken)),t.isPrimaryClient&&r&&DS(t.remoteStore,a),u}async function d6(t,e,r,n,a){t.gu=(v,_,E)=>async function(w,b,L,B){let F=b.view.nu(L);F.Ds&&(F=await hE(w.localStore,b.query,!1).then(({documents:k})=>b.view.nu(k,F)));const z=B&&B.targetChanges.get(b.targetId),q=B&&B.targetMismatches.get(b.targetId)!=null,W=b.view.applyChanges(F,w.isPrimaryClient,z,q);return EE(w,b.targetId,W._u),W.snapshot}(t,v,_,E);const o=await hE(t.localStore,e,!0),l=new o6(e,o.qs),u=l.nu(o.documents),f=p0.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",a),d=l.applyChanges(u,t.isPrimaryClient,f);EE(t,r,d._u);const m=new l6(e,r,l);return t.Pu.set(e,m),t.Tu.has(r)?t.Tu.get(r).push(e):t.Tu.set(r,[e]),d.snapshot}async function m6(t,e,r){const n=xt(t),a=n.Pu.get(e),o=n.Tu.get(a.targetId);if(o.length>1)return n.Tu.set(a.targetId,o.filter(l=>!mm(l,e))),void n.Pu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(a.targetId),n.sharedClientState.isActiveQueryTarget(a.targetId)||await B1(n.localStore,a.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(a.targetId),r&&Fx(n.remoteStore,a.targetId),H1(n,a.targetId)}).catch(nu)):(H1(n,a.targetId),await B1(n.localStore,a.targetId,!0))}async function p6(t,e){const r=xt(t),n=r.Pu.get(e),a=r.Tu.get(n.targetId);r.isPrimaryClient&&a.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Fx(r.remoteStore,n.targetId))}async function g6(t,e,r){const n=T6(t);try{const a=await function(l,u){const f=xt(l),d=fr.now(),m=u.reduce((E,S)=>E.add(S.key),It());let v,_;return f.persistence.runTransaction("Locally write mutations","readwrite",E=>{let S=xs(),w=It();return f.Os.getEntries(E,m).next(b=>{S=b,S.forEach((L,B)=>{B.isValidDocument()||(w=w.add(L))})}).next(()=>f.localDocuments.getOverlayedDocuments(E,S)).next(b=>{v=b;const L=[];for(const B of u){const F=RI(B,v.get(B.key).overlayedDocument);F!=null&&L.push(new ko(B.key,F,Yb(F.value.mapValue),ti.exists(!0)))}return f.mutationQueue.addMutationBatch(E,d,L,u)}).next(b=>{_=b;const L=b.applyToLocalDocumentSet(v,w);return f.documentOverlayCache.saveOverlays(E,b.batchId,L)})}).then(()=>({batchId:_.batchId,changes:oS(v)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(a.batchId),function(l,u,f){let d=l.Ru[l.currentUser.toKey()];d||(d=new yr(Tt)),d=d.insert(u,f),l.Ru[l.currentUser.toKey()]=d}(n,a.batchId,r),await x0(n,a.changes),await wm(n.remoteStore)}catch(a){const o=Bx(a,"Failed to persist write");r.reject(o)}}async function jS(t,e){const r=xt(t);try{const n=await AD(r.localStore,e);e.targetChanges.forEach((a,o)=>{const l=r.Eu.get(o);l&&(Xt(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?l.lu=!0:a.modifiedDocuments.size>0?Xt(l.lu,14607):a.removedDocuments.size>0&&(Xt(l.lu,42227),l.lu=!1))}),await x0(r,n,e)}catch(n){await nu(n)}}function wE(t,e,r){const n=xt(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const a=[];n.Pu.forEach((o,l)=>{const u=l.view.va(e);u.snapshot&&a.push(u.snapshot)}),function(l,u){const f=xt(l);f.onlineState=u;let d=!1;f.queries.forEach((m,v)=>{for(const _ of v.wa)_.va(u)&&(d=!0)}),d&&Vx(f)}(n.eventManager,e),a.length&&n.hu.J_(a),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function x6(t,e,r){const n=xt(t);n.sharedClientState.updateQueryState(e,"rejected",r);const a=n.Eu.get(e),o=a&&a.key;if(o){let l=new yr(tt.comparator);l=l.insert(o,In.newNoDocument(o,gt.min()));const u=It().add(o),f=new vm(gt.min(),new Map,new yr(Tt),l,u);await jS(n,f),n.du=n.du.remove(o),n.Eu.delete(e),Hx(n)}else await B1(n.localStore,e,!1).then(()=>H1(n,e,r)).catch(nu)}async function v6(t,e){const r=xt(t),n=e.batch.batchId;try{const a=await SD(r.localStore,e);zS(r,n,null),HS(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await x0(r,a)}catch(a){await nu(a)}}async function _6(t,e,r){const n=xt(t);try{const a=await function(l,u){const f=xt(l);return f.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let m;return f.mutationQueue.lookupMutationBatch(d,u).next(v=>(Xt(v!==null,37113),m=v.keys(),f.mutationQueue.removeMutationBatch(d,v))).next(()=>f.mutationQueue.performConsistencyCheck(d)).next(()=>f.documentOverlayCache.removeOverlaysForBatchId(d,m,u)).next(()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,m)).next(()=>f.localDocuments.getDocuments(d,m))})}(n.localStore,e);zS(n,e,r),HS(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await x0(n,a)}catch(a){await nu(a)}}function HS(t,e){(t.Vu.get(e)||[]).forEach(r=>{r.resolve()}),t.Vu.delete(e)}function zS(t,e,r){const n=xt(t);let a=n.Ru[n.currentUser.toKey()];if(a){const o=a.get(e);o&&(r?o.reject(r):o.resolve(),a=a.remove(e)),n.Ru[n.currentUser.toKey()]=a}}function H1(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Tu.get(e))t.Pu.delete(n),r&&t.hu.pu(n,r);t.Tu.delete(e),t.isPrimaryClient&&t.Au.zr(e).forEach(n=>{t.Au.containsKey(n)||GS(t,n)})}function GS(t,e){t.Iu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(Fx(t.remoteStore,r),t.du=t.du.remove(e),t.Eu.delete(r),Hx(t))}function EE(t,e,r){for(const n of r)n instanceof US?(t.Au.addReference(n.key,e),y6(t,n)):n instanceof BS?(Ye(jx,"Document no longer in limbo: "+n.key),t.Au.removeReference(n.key,e),t.Au.containsKey(n.key)||GS(t,n.key)):ct(19791,{yu:n})}function y6(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Iu.has(n)||(Ye(jx,"New document in limbo: "+r),t.Iu.add(n),Hx(t))}function Hx(t){for(;t.Iu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Iu.values().next().value;t.Iu.delete(e);const r=new tt(cr.fromString(e)),n=t.mu.next();t.Eu.set(n,new c6(r)),t.du=t.du.insert(r,n),DS(t.remoteStore,new no(Ii(rS(r.path)),n,"TargetPurposeLimboResolution",fm.ue))}}async function x0(t,e,r){const n=xt(t),a=[],o=[],l=[];n.Pu.isEmpty()||(n.Pu.forEach((u,f)=>{l.push(n.gu(f,e,r).then(d=>{var m;if((d||r)&&n.isPrimaryClient){const v=d?!d.fromCache:(m=r==null?void 0:r.targetChanges.get(f.targetId))===null||m===void 0?void 0:m.current;n.sharedClientState.updateQueryState(f.targetId,v?"current":"not-current")}if(d){a.push(d);const v=Dx.Es(f.targetId,d);o.push(v)}}))}),await Promise.all(l),n.hu.J_(a),await async function(f,d){const m=xt(f);try{await m.persistence.runTransaction("notifyLocalViewChanges","readwrite",v=>Oe.forEach(d,_=>Oe.forEach(_.Is,E=>m.persistence.referenceDelegate.addReference(v,_.targetId,E)).next(()=>Oe.forEach(_.ds,E=>m.persistence.referenceDelegate.removeReference(v,_.targetId,E)))))}catch(v){if(!au(v))throw v;Ye(Ox,"Failed to update sequence numbers: "+v)}for(const v of d){const _=v.targetId;if(!v.fromCache){const E=m.Fs.get(_),S=E.snapshotVersion,w=E.withLastLimboFreeSnapshotVersion(S);m.Fs=m.Fs.insert(_,w)}}}(n.localStore,o))}async function w6(t,e){const r=xt(t);if(!r.currentUser.isEqual(e)){Ye(jx,"User change. New user:",e.toKey());const n=await CS(r.localStore,e);r.currentUser=e,function(o,l){o.Vu.forEach(u=>{u.forEach(f=>{f.reject(new $e(Ne.CANCELLED,l))})}),o.Vu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await x0(r,n.Bs)}}function E6(t,e){const r=xt(t),n=r.Eu.get(e);if(n&&n.lu)return It().add(n.key);{let a=It();const o=r.Tu.get(e);if(!o)return a;for(const l of o){const u=r.Pu.get(l);a=a.unionWith(u.view.tu)}return a}}function qS(t){const e=xt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=jS.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=E6.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=x6.bind(null,e),e.hu.J_=a6.bind(null,e.eventManager),e.hu.pu=i6.bind(null,e.eventManager),e}function T6(t){const e=xt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=v6.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=_6.bind(null,e),e}class jd{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=_m(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,r){return null}Fu(e,r){return null}vu(e){return bD(this.persistence,new wD,e.initialUser,this.serializer)}Du(e){return new kS(Ix.Vi,this.serializer)}bu(e){return new ID}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}jd.provider={build:()=>new jd};class b6 extends jd{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,r){Xt(this.persistence.referenceDelegate instanceof Bd,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new sD(n,e.asyncQueue,r)}Du(e){const r=this.cacheSizeBytes!==void 0?ta.withCacheSize(this.cacheSizeBytes):ta.DEFAULT;return new kS(n=>Bd.Vi(n,r),this.serializer)}}class z1{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>wE(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=w6.bind(null,this.syncEngine),await JD(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new t6}()}createDatastore(e){const r=_m(e.databaseInfo.databaseId),n=function(o){return new LD(o)}(e.databaseInfo);return function(o,l,u,f){return new VD(o,l,u,f)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,a,o,l,u){return new HD(n,a,o,l,u)}(this.localStore,this.datastore,e.asyncQueue,r=>wE(this.syncEngine,r,0),function(){return pE.C()?new pE:new DD}())}createSyncEngine(e,r){return function(a,o,l,u,f,d,m){const v=new u6(a,o,l,u,f,d);return m&&(v.fu=!0),v}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(a){const o=xt(a);Ye(yl,"RemoteStore shutting down."),o.Ia.add(5),await g0(o),o.Ea.shutdown(),o.Aa.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}z1.provider={build:()=>new z1};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S6{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):gs("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yo="FirestoreClient";class A6{constructor(e,r,n,a,o){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=a,this.user=Cn.UNAUTHENTICATED,this.clientId=_x.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(n,async l=>{Ye(yo,"Received user=",l.uid),await this.authCredentialListener(l),this.user=l}),this.appCheckCredentials.start(n,l=>(Ye(yo,"Received new app check token=",l),this.appCheckCredentialListener(l,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new uo;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=Bx(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Qg(t,e){t.asyncQueue.verifyOperationInProgress(),Ye(yo,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async a=>{n.isEqual(a)||(await CS(e.localStore,a),n=a)}),e.persistence.setDatabaseDeletedListener(()=>{mo("Terminating Firestore due to IndexedDb database deletion"),t.terminate().then(()=>{Ye("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(a=>{mo("Terminating Firestore due to IndexedDb database deletion failed",a)})}),t._offlineComponents=e}async function TE(t,e){t.asyncQueue.verifyOperationInProgress();const r=await k6(t);Ye(yo,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>xE(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,a)=>xE(e.remoteStore,a)),t._onlineComponents=e}async function k6(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ye(yo,"Using user provided OfflineComponentProvider");try{await Qg(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(a){return a.name==="FirebaseError"?a.code===Ne.FAILED_PRECONDITION||a.code===Ne.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11}(r))throw r;mo("Error using user provided cache. Falling back to memory cache: "+r),await Qg(t,new jd)}}else Ye(yo,"Using default OfflineComponentProvider"),await Qg(t,new b6(void 0));return t._offlineComponents}async function WS(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ye(yo,"Using user provided OnlineComponentProvider"),await TE(t,t._uninitializedComponentsProvider._online)):(Ye(yo,"Using default OnlineComponentProvider"),await TE(t,new z1))),t._onlineComponents}function C6(t){return WS(t).then(e=>e.syncEngine)}async function R6(t){const e=await WS(t),r=e.eventManager;return r.onListen=f6.bind(null,e.syncEngine),r.onUnlisten=m6.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=h6.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=p6.bind(null,e.syncEngine),r}function N6(t,e,r={}){const n=new uo;return t.asyncQueue.enqueueAndForget(async()=>function(o,l,u,f,d){const m=new S6({next:_=>{m.Ou(),l.enqueueAndForget(()=>n6(o,v)),_.fromCache&&f.source==="server"?d.reject(new $e(Ne.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(_)},error:_=>d.reject(_)}),v=new s6(u,m,{includeMetadataChanges:!0,ka:!0});return r6(o,v)}(await R6(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XS(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bE=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KS="firestore.googleapis.com",SE=!0;class AE{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new $e(Ne.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=KS,this.ssl=SE}else this.host=e.host,this.ssl=(r=e.ssl)!==null&&r!==void 0?r:SE;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=AS;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<aD)throw new $e(Ne.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}zN("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=XS((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new $e(Ne.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new $e(Ne.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new $e(Ne.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,a){return n.timeoutSeconds===a.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Em{constructor(e,r,n,a){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new AE({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new $e(Ne.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new $e(Ne.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new AE(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new FN;switch(n.type){case"firstParty":return new UN(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new $e(Ne.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=bE.get(r);n&&(Ye("ComponentProvider","Removing Datastore"),bE.delete(r),n.terminate())}(this),Promise.resolve()}}function I6(t,e,r,n={}){var a;t=_l(t,Em);const o=So(e),l=t._getSettings(),u=Object.assign(Object.assign({},l),{emulatorOptions:t._getEmulatorOptions()}),f=`${e}:${r}`;o&&(hx(`https://${f}`),dx("Firestore",!0)),l.host!==KS&&l.host!==f&&mo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const d=Object.assign(Object.assign({},l),{host:f,ssl:o,emulatorOptions:n});if(!gl(d,u)&&(t._setSettings(d),n.mockUserToken)){let m,v;if(typeof n.mockUserToken=="string")m=n.mockUserToken,v=Cn.MOCK_USER;else{m=bb(n.mockUserToken,(a=t._app)===null||a===void 0?void 0:a.options.projectId);const _=n.mockUserToken.sub||n.mockUserToken.user_id;if(!_)throw new $e(Ne.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");v=new Cn(_)}t._authCredentials=new PN(new Lb(m,v))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class su{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new su(this.firestore,e,this._query)}}class Jr{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new fo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Jr(this.firestore,e,this._key)}toJSON(){return{type:Jr._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(h0(r,Jr._jsonSchema))return new Jr(e,n||null,new tt(cr.fromString(r.referencePath)))}}Jr._jsonSchemaVersion="firestore/documentReference/1.0",Jr._jsonSchema={type:Wr("string",Jr._jsonSchemaVersion),referencePath:Wr("string")};class fo extends su{constructor(e,r,n){super(e,r,rS(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Jr(this.firestore,null,new tt(e))}withConverter(e){return new fo(this.firestore,e,this._path)}}function ou(t,e,...r){if(t=gr(t),Ub("collection","path",e),t instanceof Em){const n=cr.fromString(e,...r);return Bw(n),new fo(t,null,n)}{if(!(t instanceof Jr||t instanceof fo))throw new $e(Ne.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(cr.fromString(e,...r));return Bw(n),new fo(t.firestore,null,n)}}function ki(t,e,...r){if(t=gr(t),arguments.length===1&&(e=_x.newId()),Ub("doc","path",e),t instanceof Em){const n=cr.fromString(e,...r);return Uw(n),new Jr(t,null,new tt(n))}{if(!(t instanceof Jr||t instanceof fo))throw new $e(Ne.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(cr.fromString(e,...r));return Uw(n),new Jr(t.firestore,t instanceof fo?t.converter:null,new tt(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kE="AsyncQueue";class CE{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new NS(this,"async_queue_retry"),this.oc=()=>{const n=$g();n&&Ye(kE,"Visibility state changed to "+n.visibilityState),this.F_.y_()},this._c=e;const r=$g();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const r=$g();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});const r=new uo;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!au(e))throw e;Ye(kE,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(e){const r=this._c.then(()=>(this.nc=!0,e().catch(n=>{throw this.tc=n,this.nc=!1,gs("INTERNAL UNHANDLED ERROR: ",RE(n)),n}).then(n=>(this.nc=!1,n))));return this._c=r,r}enqueueAfterDelay(e,r,n){this.ac(),this.sc.indexOf(e)>-1&&(r=0);const a=Ux.createAndSchedule(this,e,r,n,o=>this.lc(o));return this.ec.push(a),a}ac(){this.tc&&ct(47125,{hc:RE(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(const r of this.ec)if(r.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{this.ec.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.ec)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){const r=this.ec.indexOf(e);this.ec.splice(r,1)}}function RE(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class v0 extends Em{constructor(e,r,n,a){super(e,r,n,a),this.type="firestore",this._queue=new CE,this._persistenceKey=(a==null?void 0:a.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new CE(e),this._firestoreClient=void 0,await e}}}function D6(t,e){const r=typeof t=="object"?t:xx(),n=typeof t=="string"?t:Dd,a=cm(r,"firestore").getImmediate({identifier:n});if(!a._initialized){const o=wb("firestore");o&&I6(a,...o)}return a}function YS(t){if(t._terminated)throw new $e(Ne.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||O6(t),t._firestoreClient}function O6(t){var e,r,n;const a=t._freezeSettings(),o=function(u,f,d,m){return new eI(u,f,d,m.host,m.ssl,m.experimentalForceLongPolling,m.experimentalAutoDetectLongPolling,XS(m.experimentalLongPollingOptions),m.useFetchStreams,m.isUsingEmulator)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,a);t._componentsProvider||!((r=a.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=a.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:a.localCache._offlineComponentProvider,_online:a.localCache._onlineComponentProvider}),t._firestoreClient=new A6(t._authCredentials,t._appCheckCredentials,t._queue,o,t._componentsProvider&&function(u){const f=u==null?void 0:u._online.build();return{_offline:u==null?void 0:u._offline.build(f),_online:f}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ja{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ja(En.fromBase64String(e))}catch(r){throw new $e(Ne.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new ja(En.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ja._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(h0(e,ja._jsonSchema))return ja.fromBase64String(e.bytes)}}ja._jsonSchemaVersion="firestore/bytes/1.0",ja._jsonSchema={type:Wr("string",ja._jsonSchemaVersion),bytes:Wr("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tm{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new $e(Ne.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new yn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zx{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oi{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new $e(Ne.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new $e(Ne.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Tt(this._lat,e._lat)||Tt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Oi._jsonSchemaVersion}}static fromJSON(e){if(h0(e,Oi._jsonSchema))return new Oi(e.latitude,e.longitude)}}Oi._jsonSchemaVersion="firestore/geoPoint/1.0",Oi._jsonSchema={type:Wr("string",Oi._jsonSchemaVersion),latitude:Wr("number"),longitude:Wr("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fi{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,a){if(n.length!==a.length)return!1;for(let o=0;o<n.length;++o)if(n[o]!==a[o])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Fi._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(h0(e,Fi._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(r=>typeof r=="number"))return new Fi(e.vectorValues);throw new $e(Ne.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Fi._jsonSchemaVersion="firestore/vectorValue/1.0",Fi._jsonSchema={type:Wr("string",Fi._jsonSchemaVersion),vectorValues:Wr("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F6=/^__.*__$/;class P6{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new ko(e,this.data,this.fieldMask,r,this.fieldTransforms):new m0(e,this.data,r,this.fieldTransforms)}}class $S{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new ko(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function QS(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ct(40011,{Ec:t})}}class Gx{constructor(e,r,n,a,o,l){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=a,o===void 0&&this.Ac(),this.fieldTransforms=o||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new Gx(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),a=this.Rc({path:n,mc:!1});return a.fc(e),a}gc(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),a=this.Rc({path:n,mc:!1});return a.Ac(),a}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return Hd(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(QS(this.Ec)&&F6.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class L6{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||_m(e)}Dc(e,r,n,a=!1){return new Gx({Ec:e,methodName:r,bc:n,path:yn.emptyPath(),mc:!1,Sc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function qx(t){const e=t._freezeSettings(),r=_m(t._databaseId);return new L6(t._databaseId,!!e.ignoreUndefinedProperties,r)}function M6(t,e,r,n,a,o={}){const l=t.Dc(o.merge||o.mergeFields?2:0,e,r,a);Wx("Data must be an object, but it was:",l,n);const u=ZS(n,l);let f,d;if(o.merge)f=new _a(l.fieldMask),d=l.fieldTransforms;else if(o.mergeFields){const m=[];for(const v of o.mergeFields){const _=G1(e,v,r);if(!l.contains(_))throw new $e(Ne.INVALID_ARGUMENT,`Field '${_}' is specified in your field mask but missing from your input data.`);eA(m,_)||m.push(_)}f=new _a(m),d=l.fieldTransforms.filter(v=>f.covers(v.field))}else f=null,d=l.fieldTransforms;return new P6(new ra(u),f,d)}class bm extends zx{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof bm}}function U6(t,e,r,n){const a=t.Dc(1,e,r);Wx("Data must be an object, but it was:",a,n);const o=[],l=ra.empty();Ao(n,(f,d)=>{const m=Xx(e,f,r);d=gr(d);const v=a.gc(m);if(d instanceof bm)o.push(m);else{const _=_0(d,v);_!=null&&(o.push(m),l.set(m,_))}});const u=new _a(o);return new $S(l,u,a.fieldTransforms)}function B6(t,e,r,n,a,o){const l=t.Dc(1,e,r),u=[G1(e,n,r)],f=[a];if(o.length%2!=0)throw new $e(Ne.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let _=0;_<o.length;_+=2)u.push(G1(e,o[_])),f.push(o[_+1]);const d=[],m=ra.empty();for(let _=u.length-1;_>=0;--_)if(!eA(d,u[_])){const E=u[_];let S=f[_];S=gr(S);const w=l.gc(E);if(S instanceof bm)d.push(E);else{const b=_0(S,w);b!=null&&(d.push(E),m.set(E,b))}}const v=new _a(d);return new $S(m,v,l.fieldTransforms)}function V6(t,e,r,n=!1){return _0(r,t.Dc(n?4:3,e))}function _0(t,e){if(JS(t=gr(t)))return Wx("Unsupported field value:",e,t),ZS(t,e);if(t instanceof zx)return function(n,a){if(!QS(a.Ec))throw a.wc(`${n._methodName}() can only be used with update() and set()`);if(!a.path)throw a.wc(`${n._methodName}() is not currently supported inside arrays`);const o=n._toFieldTransform(a);o&&a.fieldTransforms.push(o)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return function(n,a){const o=[];let l=0;for(const u of n){let f=_0(u,a.yc(l));f==null&&(f={nullValue:"NULL_VALUE"}),o.push(f),l++}return{arrayValue:{values:o}}}(t,e)}return function(n,a){if((n=gr(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return TI(a.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const o=fr.fromDate(n);return{timestampValue:Ud(a.serializer,o)}}if(n instanceof fr){const o=new fr(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Ud(a.serializer,o)}}if(n instanceof Oi)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof ja)return{bytesValue:_S(a.serializer,n._byteString)};if(n instanceof Jr){const o=a.databaseId,l=n.firestore._databaseId;if(!l.isEqual(o))throw a.wc(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:Rx(n.firestore._databaseId||a.databaseId,n._key.path)}}if(n instanceof Fi)return function(l,u){return{mapValue:{fields:{[Xb]:{stringValue:Kb},[Od]:{arrayValue:{values:l.toArray().map(d=>{if(typeof d!="number")throw u.wc("VectorValues must only contain numeric values.");return Sx(u.serializer,d)})}}}}}}(n,a);throw a.wc(`Unsupported field value: ${um(n)}`)}(t,e)}function ZS(t,e){const r={};return jb(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ao(t,(n,a)=>{const o=_0(a,e.Vc(n));o!=null&&(r[n]=o)}),{mapValue:{fields:r}}}function JS(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof fr||t instanceof Oi||t instanceof ja||t instanceof Jr||t instanceof zx||t instanceof Fi)}function Wx(t,e,r){if(!JS(r)||!Bb(r)){const n=um(r);throw n==="an object"?e.wc(t+" a custom object"):e.wc(t+" "+n)}}function G1(t,e,r){if((e=gr(e))instanceof Tm)return e._internalPath;if(typeof e=="string")return Xx(t,e);throw Hd("Field path arguments must be of type string or ",t,!1,void 0,r)}const j6=new RegExp("[~\\*/\\[\\]]");function Xx(t,e,r){if(e.search(j6)>=0)throw Hd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new Tm(...e.split("."))._internalPath}catch{throw Hd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Hd(t,e,r,n,a){const o=n&&!n.isEmpty(),l=a!==void 0;let u=`Function ${e}() called with invalid data`;r&&(u+=" (via `toFirestore()`)"),u+=". ";let f="";return(o||l)&&(f+=" (found",o&&(f+=` in field ${n}`),l&&(f+=` in document ${a}`),f+=")"),new $e(Ne.INVALID_ARGUMENT,u+t+f)}function eA(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tA{constructor(e,r,n,a,o){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=a,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Jr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new H6(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(Kx("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class H6 extends tA{data(){return super.data()}}function Kx(t,e){return typeof e=="string"?Xx(t,e):e instanceof Tm?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z6(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new $e(Ne.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Yx{}class G6 extends Yx{}function q6(t,e,...r){let n=[];e instanceof Yx&&n.push(e),n=n.concat(r),function(o){const l=o.filter(f=>f instanceof $x).length,u=o.filter(f=>f instanceof Sm).length;if(l>1||l>0&&u>0)throw new $e(Ne.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const a of n)t=a._apply(t);return t}class Sm extends G6{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new Sm(e,r,n)}_apply(e){const r=this._parse(e);return rA(e._query,r),new su(e.firestore,e.converter,O1(e._query,r))}_parse(e){const r=qx(e.firestore);return function(o,l,u,f,d,m,v){let _;if(d.isKeyField()){if(m==="array-contains"||m==="array-contains-any")throw new $e(Ne.INVALID_ARGUMENT,`Invalid Query. You can't perform '${m}' queries on documentId().`);if(m==="in"||m==="not-in"){IE(v,m);const S=[];for(const w of v)S.push(NE(f,o,w));_={arrayValue:{values:S}}}else _=NE(f,o,v)}else m!=="in"&&m!=="not-in"&&m!=="array-contains-any"||IE(v,m),_=V6(u,l,v,m==="in"||m==="not-in");return qr.create(d,m,_)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function W6(t,e,r){const n=e,a=Kx("where",t);return Sm._create(a,n,r)}class $x extends Yx{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new $x(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:ai.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(a,o){let l=a;const u=o.getFlattenedFilters();for(const f of u)rA(l,f),l=O1(l,f)}(e._query,r),new su(e.firestore,e.converter,O1(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function NE(t,e,r){if(typeof(r=gr(r))=="string"){if(r==="")throw new $e(Ne.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!nS(e)&&r.indexOf("/")!==-1)throw new $e(Ne.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(cr.fromString(r));if(!tt.isDocumentKey(n))throw new $e(Ne.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return Xw(t,new tt(n))}if(r instanceof Jr)return Xw(t,r._key);throw new $e(Ne.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${um(r)}.`)}function IE(t,e){if(!Array.isArray(t)||t.length===0)throw new $e(Ne.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function rA(t,e){const r=function(a,o){for(const l of a)for(const u of l.getFlattenedFilters())if(o.indexOf(u.op)>=0)return u.op;return null}(t.filters,function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new $e(Ne.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new $e(Ne.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class X6{convertValue(e,r="none"){switch(vo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Fr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(xo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw ct(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Ao(e,(a,o)=>{n[a]=this.convertValue(o,r)}),n}convertVectorValue(e){var r,n,a;const o=(a=(n=(r=e.fields)===null||r===void 0?void 0:r[Od].arrayValue)===null||n===void 0?void 0:n.values)===null||a===void 0?void 0:a.map(l=>Fr(l.doubleValue));return new Fi(o)}convertGeoPoint(e){return new Oi(Fr(e.latitude),Fr(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=dm(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(zf(e));default:return null}}convertTimestamp(e){const r=go(e);return new fr(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=cr.fromString(e);Xt(SS(n),9688,{name:e});const a=new Gf(n.get(1),n.get(3)),o=new tt(n.popFirst(5));return a.isEqual(r)||gs(`Document ${o} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K6(t,e,r){let n;return n=t?t.toFirestore(e):e,n}class td{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Uc extends tA{constructor(e,r,n,a,o,l){super(e,r,n,a,l),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new Ed(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(Kx("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new $e(Ne.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=Uc._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}Uc._jsonSchemaVersion="firestore/documentSnapshot/1.0",Uc._jsonSchema={type:Wr("string",Uc._jsonSchemaVersion),bundleSource:Wr("string","DocumentSnapshot"),bundleName:Wr("string"),bundle:Wr("string")};class Ed extends Uc{data(e={}){return super.data(e)}}class Bc{constructor(e,r,n,a){this._firestore=e,this._userDataWriter=r,this._snapshot=a,this.metadata=new td(a.hasPendingWrites,a.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new Ed(this._firestore,this._userDataWriter,n.key,n,new td(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new $e(Ne.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(a,o){if(a._snapshot.oldDocs.isEmpty()){let l=0;return a._snapshot.docChanges.map(u=>{const f=new Ed(a._firestore,a._userDataWriter,u.doc.key,u.doc,new td(a._snapshot.mutatedKeys.has(u.doc.key),a._snapshot.fromCache),a.query.converter);return u.doc,{type:"added",doc:f,oldIndex:-1,newIndex:l++}})}{let l=a._snapshot.oldDocs;return a._snapshot.docChanges.filter(u=>o||u.type!==3).map(u=>{const f=new Ed(a._firestore,a._userDataWriter,u.doc.key,u.doc,new td(a._snapshot.mutatedKeys.has(u.doc.key),a._snapshot.fromCache),a.query.converter);let d=-1,m=-1;return u.type!==0&&(d=l.indexOf(u.doc.key),l=l.delete(u.doc.key)),u.type!==1&&(l=l.add(u.doc),m=l.indexOf(u.doc.key)),{type:Y6(u.type),doc:f,oldIndex:d,newIndex:m}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new $e(Ne.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Bc._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=_x.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],a=[];return this.docs.forEach(o=>{o._document!==null&&(r.push(o._document),n.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),a.push(o.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Y6(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ct(61501,{type:t})}}Bc._jsonSchemaVersion="firestore/querySnapshot/1.0",Bc._jsonSchema={type:Wr("string",Bc._jsonSchemaVersion),bundleSource:Wr("string","QuerySnapshot"),bundleName:Wr("string"),bundle:Wr("string")};class $6 extends X6{constructor(e){super(),this.firestore=e}convertBytes(e){return new ja(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Jr(this.firestore,null,r)}}function ll(t){t=_l(t,su);const e=_l(t.firestore,v0),r=YS(e),n=new $6(e);return z6(t._query),N6(r,t._query).then(a=>new Bc(e,n,t,a))}function Nf(t,e,r,...n){t=_l(t,Jr);const a=_l(t.firestore,v0),o=qx(a);let l;return l=typeof(e=gr(e))=="string"||e instanceof Tm?B6(o,"updateDoc",t._key,e,r,n):U6(o,"updateDoc",t._key,e),Qx(a,[l.toMutation(t._key,ti.exists(!0))])}function Td(t){return Qx(_l(t.firestore,v0),[new Ax(t._key,ti.none())])}function yf(t,e){const r=_l(t.firestore,v0),n=ki(t),a=K6(t.converter,e);return Qx(r,[M6(qx(t.firestore),"addDoc",n._key,a,t.converter!==null,{}).toMutation(n._key,ti.exists(!1))]).then(()=>n)}function Qx(t,e){return function(n,a){const o=new uo;return n.asyncQueue.enqueueAndForget(async()=>g6(await C6(n),a,o)),o.promise}(YS(t),e)}(function(e,r=!0){(function(a){ru=a})(Nl),xl(new ho("firestore",(n,{instanceIdentifier:a,options:o})=>{const l=n.getProvider("app").getImmediate(),u=new v0(new LN(n.getProvider("auth-internal")),new BN(l,n.getProvider("app-check-internal")),function(d,m){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new $e(Ne.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Gf(d.options.projectId,m)}(l,a),l);return o=Object.assign({useFetchStreams:r},o),u._setSettings(o),u},"PUBLIC").setMultipleInstances(!0)),Ni(Ow,Fw,e),Ni(Ow,Fw,"esm2017")})();function Zx(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(t);a<n.length;a++)e.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(t,n[a])&&(r[n[a]]=t[n[a]]);return r}function nA(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Q6=nA,aA=new u0("auth","Firebase",nA());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zd=new mx("@firebase/auth");function Z6(t,...e){zd.logLevel<=Nt.WARN&&zd.warn(`Auth (${Nl}): ${t}`,...e)}function bd(t,...e){zd.logLevel<=Nt.ERROR&&zd.error(`Auth (${Nl}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ii(t,...e){throw Jx(t,...e)}function Pi(t,...e){return Jx(t,...e)}function iA(t,e,r){const n=Object.assign(Object.assign({},Q6()),{[e]:r});return new u0("auth","Firebase",n).create(e,{appName:t.name})}function hs(t){return iA(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Jx(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return aA.create(t,...e)}function lt(t,e,...r){if(!t)throw Jx(e,...r)}function cs(t){const e="INTERNAL ASSERTION FAILED: "+t;throw bd(e),new Error(e)}function vs(t,e){t||cs(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q1(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function J6(){return DE()==="http:"||DE()==="https:"}function DE(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eO(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(J6()||fR()||"connection"in navigator)?navigator.onLine:!0}function tO(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y0{constructor(e,r){this.shortDelay=e,this.longDelay=r,vs(r>e,"Short delay should be less than long delay!"),this.isMobile=lR()||hR()}get(){return eO()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ev(t,e){vs(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sA{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;cs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;cs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;cs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rO={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nO=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],aO=new y0(3e4,6e4);function Co(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Ro(t,e,r,n,a={}){return oA(t,a,async()=>{let o={},l={};n&&(e==="GET"?l=n:o={body:JSON.stringify(n)});const u=f0(Object.assign({key:t.config.apiKey},l)).slice(1),f=await t._getAdditionalHeaders();f["Content-Type"]="application/json",t.languageCode&&(f["X-Firebase-Locale"]=t.languageCode);const d=Object.assign({method:e,headers:f},o);return uR()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&So(t.emulatorConfig.host)&&(d.credentials="include"),sA.fetch()(await lA(t,t.config.apiHost,r,u),d)})}async function oA(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},rO),e);try{const a=new sO(t),o=await Promise.race([r(),a.promise]);a.clearNetworkTimeout();const l=await o.json();if("needConfirmation"in l)throw rd(t,"account-exists-with-different-credential",l);if(o.ok&&!("errorMessage"in l))return l;{const u=o.ok?l.errorMessage:l.error.message,[f,d]=u.split(" : ");if(f==="FEDERATED_USER_ID_ALREADY_LINKED")throw rd(t,"credential-already-in-use",l);if(f==="EMAIL_EXISTS")throw rd(t,"email-already-in-use",l);if(f==="USER_DISABLED")throw rd(t,"user-disabled",l);const m=n[f]||f.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw iA(t,m,d);ii(t,m)}}catch(a){if(a instanceof Bi)throw a;ii(t,"network-request-failed",{message:String(a)})}}async function w0(t,e,r,n,a={}){const o=await Ro(t,e,r,n,a);return"mfaPendingCredential"in o&&ii(t,"multi-factor-auth-required",{_serverResponse:o}),o}async function lA(t,e,r,n){const a=`${e}${r}?${n}`,o=t,l=o.config.emulator?ev(t.config,a):`${t.config.apiScheme}://${a}`;return nO.includes(r)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(l).toString():l}function iO(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class sO{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Pi(this.auth,"network-request-failed")),aO.get())})}}function rd(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const a=Pi(t,e,n);return a.customData._tokenResponse=r,a}function OE(t){return t!==void 0&&t.enterprise!==void 0}class oO{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return iO(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function lO(t,e){return Ro(t,"GET","/v2/recaptchaConfig",Co(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cO(t,e){return Ro(t,"POST","/v1/accounts:delete",e)}async function Gd(t,e){return Ro(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function If(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function uO(t,e=!1){const r=gr(t),n=await r.getIdToken(e),a=tv(n);lt(a&&a.exp&&a.auth_time&&a.iat,r.auth,"internal-error");const o=typeof a.firebase=="object"?a.firebase:void 0,l=o==null?void 0:o.sign_in_provider;return{claims:a,token:n,authTime:If(Zg(a.auth_time)),issuedAtTime:If(Zg(a.iat)),expirationTime:If(Zg(a.exp)),signInProvider:l||null,signInSecondFactor:(o==null?void 0:o.sign_in_second_factor)||null}}function Zg(t){return Number(t)*1e3}function tv(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return bd("JWT malformed, contained fewer than 3 sections"),null;try{const a=_b(r);return a?JSON.parse(a):(bd("Failed to decode base64 JWT payload"),null)}catch(a){return bd("Caught error parsing JWT payload as JSON",a==null?void 0:a.toString()),null}}function FE(t){const e=tv(t);return lt(e,"internal-error"),lt(typeof e.exp<"u","internal-error"),lt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kf(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof Bi&&fO(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function fO({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hO{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const a=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,a)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W1{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=If(this.lastLoginAt),this.creationTime=If(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qd(t){var e;const r=t.auth,n=await t.getIdToken(),a=await Kf(t,Gd(r,{idToken:n}));lt(a==null?void 0:a.users.length,r,"internal-error");const o=a.users[0];t._notifyReloadListener(o);const l=!((e=o.providerUserInfo)===null||e===void 0)&&e.length?cA(o.providerUserInfo):[],u=mO(t.providerData,l),f=t.isAnonymous,d=!(t.email&&o.passwordHash)&&!(u!=null&&u.length),m=f?d:!1,v={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new W1(o.createdAt,o.lastLoginAt),isAnonymous:m};Object.assign(t,v)}async function dO(t){const e=gr(t);await qd(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function mO(t,e){return[...t.filter(n=>!e.some(a=>a.providerId===n.providerId)),...e]}function cA(t){return t.map(e=>{var{providerId:r}=e,n=Zx(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pO(t,e){const r=await oA(t,{},async()=>{const n=f0({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:o}=t.config,l=await lA(t,a,"/v1/token",`key=${o}`),u=await t._getAdditionalHeaders();u["Content-Type"]="application/x-www-form-urlencoded";const f={method:"POST",headers:u,body:n};return t.emulatorConfig&&So(t.emulatorConfig.host)&&(f.credentials="include"),sA.fetch()(l,f)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function gO(t,e){return Ro(t,"POST","/v2/accounts:revokeToken",Co(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){lt(e.idToken,"internal-error"),lt(typeof e.idToken<"u","internal-error"),lt(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):FE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){lt(e.length!==0,"internal-error");const r=FE(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(lt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:a,expiresIn:o}=await pO(e,r);this.updateTokensAndExpiration(n,a,Number(o))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:a,expirationTime:o}=r,l=new Vc;return n&&(lt(typeof n=="string","internal-error",{appName:e}),l.refreshToken=n),a&&(lt(typeof a=="string","internal-error",{appName:e}),l.accessToken=a),o&&(lt(typeof o=="number","internal-error",{appName:e}),l.expirationTime=o),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Vc,this.toJSON())}_performRefresh(){return cs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $s(t,e){lt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Za{constructor(e){var{uid:r,auth:n,stsTokenManager:a}=e,o=Zx(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new hO(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new W1(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const r=await Kf(this,this.stsTokenManager.getToken(this.auth,e));return lt(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return uO(this,e)}reload(){return dO(this)}_assign(e){this!==e&&(lt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Za(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){lt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await qd(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ga(this.auth.app))return Promise.reject(hs(this.auth));const e=await this.getIdToken();return await Kf(this,cO(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,a,o,l,u,f,d,m;const v=(n=r.displayName)!==null&&n!==void 0?n:void 0,_=(a=r.email)!==null&&a!==void 0?a:void 0,E=(o=r.phoneNumber)!==null&&o!==void 0?o:void 0,S=(l=r.photoURL)!==null&&l!==void 0?l:void 0,w=(u=r.tenantId)!==null&&u!==void 0?u:void 0,b=(f=r._redirectEventId)!==null&&f!==void 0?f:void 0,L=(d=r.createdAt)!==null&&d!==void 0?d:void 0,B=(m=r.lastLoginAt)!==null&&m!==void 0?m:void 0,{uid:F,emailVerified:z,isAnonymous:q,providerData:W,stsTokenManager:k}=r;lt(F&&k,e,"internal-error");const I=Vc.fromJSON(this.name,k);lt(typeof F=="string",e,"internal-error"),$s(v,e.name),$s(_,e.name),lt(typeof z=="boolean",e,"internal-error"),lt(typeof q=="boolean",e,"internal-error"),$s(E,e.name),$s(S,e.name),$s(w,e.name),$s(b,e.name),$s(L,e.name),$s(B,e.name);const A=new Za({uid:F,auth:e,email:_,emailVerified:z,displayName:v,isAnonymous:q,photoURL:S,phoneNumber:E,tenantId:w,stsTokenManager:I,createdAt:L,lastLoginAt:B});return W&&Array.isArray(W)&&(A.providerData=W.map(O=>Object.assign({},O))),b&&(A._redirectEventId=b),A}static async _fromIdTokenResponse(e,r,n=!1){const a=new Vc;a.updateFromServerResponse(r);const o=new Za({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:n});return await qd(o),o}static async _fromGetAccountInfoResponse(e,r,n){const a=r.users[0];lt(a.localId!==void 0,"internal-error");const o=a.providerUserInfo!==void 0?cA(a.providerUserInfo):[],l=!(a.email&&a.passwordHash)&&!(o!=null&&o.length),u=new Vc;u.updateFromIdToken(n);const f=new Za({uid:a.localId,auth:e,stsTokenManager:u,isAnonymous:l}),d={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:o,metadata:new W1(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!(o!=null&&o.length)};return Object.assign(f,d),f}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PE=new Map;function us(t){vs(t instanceof Function,"Expected a class definition");let e=PE.get(t);return e?(vs(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,PE.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uA{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}uA.type="NONE";const LE=uA;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sd(t,e,r){return`firebase:${t}:${e}:${r}`}class jc{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:a,name:o}=this.auth;this.fullUserKey=Sd(this.userKey,a.apiKey,o),this.fullPersistenceKey=Sd("persistence",a.apiKey,o),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await Gd(this.auth,{idToken:e}).catch(()=>{});return r?Za._fromGetAccountInfoResponse(this.auth,r,e):null}return Za._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new jc(us(LE),e,n);const a=(await Promise.all(r.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let o=a[0]||us(LE);const l=Sd(n,e.config.apiKey,e.name);let u=null;for(const d of r)try{const m=await d._get(l);if(m){let v;if(typeof m=="string"){const _=await Gd(e,{idToken:m}).catch(()=>{});if(!_)break;v=await Za._fromGetAccountInfoResponse(e,_,m)}else v=Za._fromJSON(e,m);d!==o&&(u=v),o=d;break}}catch{}const f=a.filter(d=>d._shouldAllowMigration);return!o._shouldAllowMigration||!f.length?new jc(o,e,n):(o=f[0],u&&await o._set(l,u.toJSON()),await Promise.all(r.map(async d=>{if(d!==o)try{await d._remove(l)}catch{}})),new jc(o,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ME(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(mA(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(fA(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(gA(e))return"Blackberry";if(xA(e))return"Webos";if(hA(e))return"Safari";if((e.includes("chrome/")||dA(e))&&!e.includes("edge/"))return"Chrome";if(pA(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function fA(t=Pn()){return/firefox\//i.test(t)}function hA(t=Pn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function dA(t=Pn()){return/crios\//i.test(t)}function mA(t=Pn()){return/iemobile/i.test(t)}function pA(t=Pn()){return/android/i.test(t)}function gA(t=Pn()){return/blackberry/i.test(t)}function xA(t=Pn()){return/webos/i.test(t)}function rv(t=Pn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function xO(t=Pn()){var e;return rv(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function vO(){return dR()&&document.documentMode===10}function vA(t=Pn()){return rv(t)||pA(t)||xA(t)||gA(t)||/windows phone/i.test(t)||mA(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _A(t,e=[]){let r;switch(t){case"Browser":r=ME(Pn());break;case"Worker":r=`${ME(Pn())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Nl}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _O{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=o=>new Promise((l,u)=>{try{const f=e(o);l(f)}catch(f){u(f)}});n.onAbort=r,this.queue.push(n);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const a of r)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yO(t,e={}){return Ro(t,"GET","/v2/passwordPolicy",Co(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wO=6;class EO{constructor(e){var r,n,a,o;const l=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=l.minPasswordLength)!==null&&r!==void 0?r:wO,l.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=l.maxPasswordLength),l.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=l.containsLowercaseCharacter),l.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=l.containsUppercaseCharacter),l.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=l.containsNumericCharacter),l.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=l.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(a=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&a!==void 0?a:"",this.forceUpgradeOnSignin=(o=e.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,a,o,l,u;const f={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,f),this.validatePasswordCharacterOptions(e,f),f.isValid&&(f.isValid=(r=f.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),f.isValid&&(f.isValid=(n=f.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),f.isValid&&(f.isValid=(a=f.containsLowercaseLetter)!==null&&a!==void 0?a:!0),f.isValid&&(f.isValid=(o=f.containsUppercaseLetter)!==null&&o!==void 0?o:!0),f.isValid&&(f.isValid=(l=f.containsNumericCharacter)!==null&&l!==void 0?l:!0),f.isValid&&(f.isValid=(u=f.containsNonAlphanumericCharacter)!==null&&u!==void 0?u:!0),f}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),a&&(r.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let a=0;a<e.length;a++)n=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,a,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TO{constructor(e,r,n,a){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new UE(this),this.idTokenSubscription=new UE(this),this.beforeStateQueue=new _O(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=aA,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=us(r)),this._initializationPromise=this.queue(async()=>{var n,a,o;if(!this._deleted&&(this.persistenceManager=await jc.create(this,e),(n=this._resolvePersistenceManagerAvailable)===null||n===void 0||n.call(this),!this._deleted)){if(!((a=this._popupRedirectResolver)===null||a===void 0)&&a._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((o=this.currentUser)===null||o===void 0?void 0:o.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await Gd(this,{idToken:e}),n=await Za._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(ga(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(u,u))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let a=n,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,u=a==null?void 0:a._redirectEventId,f=await this.tryRedirectSignIn(e);(!l||l===u)&&(f!=null&&f.user)&&(a=f.user,o=!0)}if(!a)return this.directlySetCurrentUser(null);if(!a._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(a)}catch(l){a=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return a?this.reloadAndSetCurrentUserOrClear(a):this.directlySetCurrentUser(null)}return lt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===a._redirectEventId?this.directlySetCurrentUser(a):this.reloadAndSetCurrentUserOrClear(a)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await qd(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=tO()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ga(this.app))return Promise.reject(hs(this));const r=e?gr(e):null;return r&&lt(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&lt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ga(this.app)?Promise.reject(hs(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ga(this.app)?Promise.reject(hs(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(us(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await yO(this),r=new EO(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new u0("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await gO(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&us(e)||this._popupRedirectResolver;lt(r,this,"argument-error"),this.redirectPersistenceManager=await jc.create(this,[us(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,a){if(this._deleted)return()=>{};const o=typeof r=="function"?r:r.next.bind(r);let l=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(lt(u,this,"internal-error"),u.then(()=>{l||o(this.currentUser)}),typeof r=="function"){const f=e.addObserver(r,n,a);return()=>{l=!0,f()}}else{const f=e.addObserver(r);return()=>{l=!0,f()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return lt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=_A(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const a=await this._getAppCheckToken();return a&&(r["X-Firebase-AppCheck"]=a),r}async _getAppCheckToken(){var e;if(ga(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&Z6(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function Ol(t){return gr(t)}class UE{constructor(e){this.auth=e,this.observer=null,this.addObserver=wR(r=>this.observer=r)}get next(){return lt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Am={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function bO(t){Am=t}function yA(t){return Am.loadJS(t)}function SO(){return Am.recaptchaEnterpriseScript}function AO(){return Am.gapiScript}function kO(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class CO{constructor(){this.enterprise=new RO}ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}class RO{ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}const NO="recaptcha-enterprise",wA="NO_RECAPTCHA";class IO{constructor(e){this.type=NO,this.auth=Ol(e)}async verify(e="verify",r=!1){async function n(o){if(!r){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(l,u)=>{lO(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(f=>{if(f.recaptchaKey===void 0)u(new Error("recaptcha Enterprise site key undefined"));else{const d=new oO(f);return o.tenantId==null?o._agentRecaptchaConfig=d:o._tenantRecaptchaConfigs[o.tenantId]=d,l(d.siteKey)}}).catch(f=>{u(f)})})}function a(o,l,u){const f=window.grecaptcha;OE(f)?f.enterprise.ready(()=>{f.enterprise.execute(o,{action:e}).then(d=>{l(d)}).catch(()=>{l(wA)})}):u(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new CO().execute("siteKey",{action:"verify"}):new Promise((o,l)=>{n(this.auth).then(u=>{if(!r&&OE(window.grecaptcha))a(u,o,l);else{if(typeof window>"u"){l(new Error("RecaptchaVerifier is only supported in browser"));return}let f=SO();f.length!==0&&(f+=u),yA(f).then(()=>{a(u,o,l)}).catch(d=>{l(d)})}}).catch(u=>{l(u)})})}}async function BE(t,e,r,n=!1,a=!1){const o=new IO(t);let l;if(a)l=wA;else try{l=await o.verify(r)}catch{l=await o.verify(r,!0)}const u=Object.assign({},e);if(r==="mfaSmsEnrollment"||r==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in u){const f=u.phoneEnrollmentInfo.phoneNumber,d=u.phoneEnrollmentInfo.recaptchaToken;Object.assign(u,{phoneEnrollmentInfo:{phoneNumber:f,recaptchaToken:d,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in u){const f=u.phoneSignInInfo.recaptchaToken;Object.assign(u,{phoneSignInInfo:{recaptchaToken:f,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return u}return n?Object.assign(u,{captchaResp:l}):Object.assign(u,{captchaResponse:l}),Object.assign(u,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(u,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),u}async function X1(t,e,r,n,a){var o;if(!((o=t._getRecaptchaConfig())===null||o===void 0)&&o.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const l=await BE(t,e,r,r==="getOobCode");return n(t,l)}else return n(t,e).catch(async l=>{if(l.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const u=await BE(t,e,r,r==="getOobCode");return n(t,u)}else return Promise.reject(l)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DO(t,e){const r=cm(t,"auth");if(r.isInitialized()){const a=r.getImmediate(),o=r.getOptions();if(gl(o,e??{}))return a;ii(a,"already-initialized")}return r.initialize({options:e})}function OO(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(us);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function FO(t,e,r){const n=Ol(t);lt(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const a=!1,o=EA(e),{host:l,port:u}=PO(e),f=u===null?"":`:${u}`,d={url:`${o}//${l}${f}/`},m=Object.freeze({host:l,port:u,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!n._canInitEmulator){lt(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),lt(gl(d,n.config.emulator)&&gl(m,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=d,n.emulatorConfig=m,n.settings.appVerificationDisabledForTesting=!0,So(l)?(hx(`${o}//${l}${f}`),dx("Auth",!0)):LO()}function EA(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function PO(t){const e=EA(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(n);if(a){const o=a[1];return{host:o,port:VE(n.substr(o.length+1))}}else{const[o,l]=n.split(":");return{host:o,port:VE(l)}}}function VE(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function LO(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nv{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return cs("not implemented")}_getIdTokenResponse(e){return cs("not implemented")}_linkToIdToken(e,r){return cs("not implemented")}_getReauthenticationResolver(e){return cs("not implemented")}}async function MO(t,e){return Ro(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UO(t,e){return w0(t,"POST","/v1/accounts:signInWithPassword",Co(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BO(t,e){return w0(t,"POST","/v1/accounts:signInWithEmailLink",Co(t,e))}async function VO(t,e){return w0(t,"POST","/v1/accounts:signInWithEmailLink",Co(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yf extends nv{constructor(e,r,n,a=null){super("password",n),this._email=e,this._password=r,this._tenantId=a}static _fromEmailAndPassword(e,r){return new Yf(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new Yf(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r!=null&&r.email&&(r!=null&&r.password)){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return X1(e,r,"signInWithPassword",UO);case"emailLink":return BO(e,{email:this._email,oobCode:this._password});default:ii(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return X1(e,n,"signUpPassword",MO);case"emailLink":return VO(e,{idToken:r,email:this._email,oobCode:this._password});default:ii(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hc(t,e){return w0(t,"POST","/v1/accounts:signInWithIdp",Co(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jO="http://localhost";class wl extends nv{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new wl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):ii("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:a}=r,o=Zx(r,["providerId","signInMethod"]);if(!n||!a)return null;const l=new wl(n,a);return l.idToken=o.idToken||void 0,l.accessToken=o.accessToken||void 0,l.secret=o.secret,l.nonce=o.nonce,l.pendingToken=o.pendingToken||null,l}_getIdTokenResponse(e){const r=this.buildRequest();return Hc(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,Hc(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,Hc(e,r)}buildRequest(){const e={requestUri:jO,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=f0(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HO(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function zO(t){const e=pf(gf(t)).link,r=e?pf(gf(e)).deep_link_id:null,n=pf(gf(t)).deep_link_id;return(n?pf(gf(n)).link:null)||n||r||e||t}class av{constructor(e){var r,n,a,o,l,u;const f=pf(gf(e)),d=(r=f.apiKey)!==null&&r!==void 0?r:null,m=(n=f.oobCode)!==null&&n!==void 0?n:null,v=HO((a=f.mode)!==null&&a!==void 0?a:null);lt(d&&m&&v,"argument-error"),this.apiKey=d,this.operation=v,this.code=m,this.continueUrl=(o=f.continueUrl)!==null&&o!==void 0?o:null,this.languageCode=(l=f.lang)!==null&&l!==void 0?l:null,this.tenantId=(u=f.tenantId)!==null&&u!==void 0?u:null}static parseLink(e){const r=zO(e);try{return new av(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lu{constructor(){this.providerId=lu.PROVIDER_ID}static credential(e,r){return Yf._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=av.parseLink(r);return lt(n,"argument-error"),Yf._fromEmailAndCode(e,n.code,n.tenantId)}}lu.PROVIDER_ID="password";lu.EMAIL_PASSWORD_SIGN_IN_METHOD="password";lu.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TA{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E0 extends TA{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zs extends E0{constructor(){super("facebook.com")}static credential(e){return wl._fromParams({providerId:Zs.PROVIDER_ID,signInMethod:Zs.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Zs.credentialFromTaggedObject(e)}static credentialFromError(e){return Zs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Zs.credential(e.oauthAccessToken)}catch{return null}}}Zs.FACEBOOK_SIGN_IN_METHOD="facebook.com";Zs.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Js extends E0{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return wl._fromParams({providerId:Js.PROVIDER_ID,signInMethod:Js.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return Js.credentialFromTaggedObject(e)}static credentialFromError(e){return Js.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return Js.credential(r,n)}catch{return null}}}Js.GOOGLE_SIGN_IN_METHOD="google.com";Js.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eo extends E0{constructor(){super("github.com")}static credential(e){return wl._fromParams({providerId:eo.PROVIDER_ID,signInMethod:eo.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return eo.credentialFromTaggedObject(e)}static credentialFromError(e){return eo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return eo.credential(e.oauthAccessToken)}catch{return null}}}eo.GITHUB_SIGN_IN_METHOD="github.com";eo.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class to extends E0{constructor(){super("twitter.com")}static credential(e,r){return wl._fromParams({providerId:to.PROVIDER_ID,signInMethod:to.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return to.credentialFromTaggedObject(e)}static credentialFromError(e){return to.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return to.credential(r,n)}catch{return null}}}to.TWITTER_SIGN_IN_METHOD="twitter.com";to.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GO(t,e){return w0(t,"POST","/v1/accounts:signUp",Co(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class El{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,a=!1){const o=await Za._fromIdTokenResponse(e,n,a),l=jE(n);return new El({user:o,providerId:l,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const a=jE(n);return new El({user:e,providerId:a,_tokenResponse:n,operationType:r})}}function jE(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wd extends Bi{constructor(e,r,n,a){var o;super(r.code,r.message),this.operationType=n,this.user=a,Object.setPrototypeOf(this,Wd.prototype),this.customData={appName:e.name,tenantId:(o=e.tenantId)!==null&&o!==void 0?o:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,a){return new Wd(e,r,n,a)}}function bA(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?Wd._fromErrorAndOperation(t,o,e,n):o})}async function qO(t,e,r=!1){const n=await Kf(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return El._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WO(t,e,r=!1){const{auth:n}=t;if(ga(n.app))return Promise.reject(hs(n));const a="reauthenticate";try{const o=await Kf(t,bA(n,a,e,t),r);lt(o.idToken,n,"internal-error");const l=tv(o.idToken);lt(l,n,"internal-error");const{sub:u}=l;return lt(t.uid===u,n,"user-mismatch"),El._forOperation(t,a,o)}catch(o){throw(o==null?void 0:o.code)==="auth/user-not-found"&&ii(n,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SA(t,e,r=!1){if(ga(t.app))return Promise.reject(hs(t));const n="signIn",a=await bA(t,n,e),o=await El._fromIdTokenResponse(t,n,a);return r||await t._updateCurrentUser(o.user),o}async function XO(t,e){return SA(Ol(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AA(t){const e=Ol(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function KO(t,e,r){if(ga(t.app))return Promise.reject(hs(t));const n=Ol(t),l=await X1(n,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",GO).catch(f=>{throw f.code==="auth/password-does-not-meet-requirements"&&AA(t),f}),u=await El._fromIdTokenResponse(n,"signIn",l);return await n._updateCurrentUser(u.user),u}function YO(t,e,r){return ga(t.app)?Promise.reject(hs(t)):XO(gr(t),lu.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&AA(t),n})}function $O(t,e,r,n){return gr(t).onIdTokenChanged(e,r,n)}function QO(t,e,r){return gr(t).beforeAuthStateChanged(e,r)}function ZO(t,e,r,n){return gr(t).onAuthStateChanged(e,r,n)}function K1(t){return gr(t).signOut()}const Xd="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kA{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(Xd,"1"),this.storage.removeItem(Xd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JO=1e3,eF=10;class CA extends kA{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=vA(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),a=this.localCache[r];n!==a&&e(r,a,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((l,u,f)=>{this.notifyListeners(l,f)});return}const n=e.key;r?this.detachListener():this.stopPolling();const a=()=>{const l=this.storage.getItem(n);!r&&this.localCache[n]===l||this.notifyListeners(n,l)},o=this.storage.getItem(n);vO()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,eF):a()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},JO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}CA.type="LOCAL";const tF=CA;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RA extends kA{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}RA.type="SESSION";const NA=RA;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rF(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class km{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(a=>a.isListeningto(e));if(r)return r;const n=new km(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:a,data:o}=r.data,l=this.handlersMap[a];if(!(l!=null&&l.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:a});const u=Array.from(l).map(async d=>d(r.origin,o)),f=await rF(u);r.ports[0].postMessage({status:"done",eventId:n,eventType:a,response:f})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}km.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iv(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nF{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let o,l;return new Promise((u,f)=>{const d=iv("",20);a.port1.start();const m=setTimeout(()=>{f(new Error("unsupported_event"))},n);l={messageChannel:a,onMessage(v){const _=v;if(_.data.eventId===d)switch(_.data.status){case"ack":clearTimeout(m),o=setTimeout(()=>{f(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),u(_.data.response);break;default:clearTimeout(m),clearTimeout(o),f(new Error("invalid_response"));break}}},this.handlers.add(l),a.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:e,eventId:d,data:r},[a.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Li(){return window}function aF(t){Li().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IA(){return typeof Li().WorkerGlobalScope<"u"&&typeof Li().importScripts=="function"}async function iF(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function sF(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function oF(){return IA()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DA="firebaseLocalStorageDb",lF=1,Kd="firebaseLocalStorage",OA="fbase_key";class T0{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function Cm(t,e){return t.transaction([Kd],e?"readwrite":"readonly").objectStore(Kd)}function cF(){const t=indexedDB.deleteDatabase(DA);return new T0(t).toPromise()}function Y1(){const t=indexedDB.open(DA,lF);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(Kd,{keyPath:OA})}catch(a){r(a)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(Kd)?e(n):(n.close(),await cF(),e(await Y1()))})})}async function HE(t,e,r){const n=Cm(t,!0).put({[OA]:e,value:r});return new T0(n).toPromise()}async function uF(t,e){const r=Cm(t,!1).get(e),n=await new T0(r).toPromise();return n===void 0?null:n.value}function zE(t,e){const r=Cm(t,!0).delete(e);return new T0(r).toPromise()}const fF=800,hF=3;class FA{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Y1(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>hF)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return IA()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=km._getInstance(oF()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await iF(),!this.activeServiceWorker)return;this.sender=new nF(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||sF()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Y1();return await HE(e,Xd,"1"),await zE(e,Xd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>HE(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>uF(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>zE(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const o=Cm(a,!1).getAll();return new T0(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:a,value:o}of e)n.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(o)&&(this.notifyListeners(a,o),r.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!n.has(a)&&(this.notifyListeners(a,null),r.push(a));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),fF)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}FA.type="LOCAL";const dF=FA;new y0(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mF(t,e){return e?us(e):(lt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sv extends nv{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Hc(e,this._buildIdpRequest())}_linkToIdToken(e,r){return Hc(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return Hc(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function pF(t){return SA(t.auth,new sv(t),t.bypassAuthState)}function gF(t){const{auth:e,user:r}=t;return lt(r,e,"internal-error"),WO(r,new sv(t),t.bypassAuthState)}async function xF(t){const{auth:e,user:r}=t;return lt(r,e,"internal-error"),qO(r,new sv(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PA{constructor(e,r,n,a,o=!1){this.auth=e,this.resolver=n,this.user=a,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:a,tenantId:o,error:l,type:u}=e;if(l){this.reject(l);return}const f={auth:this.auth,requestUri:r,sessionId:n,tenantId:o||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(f))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return pF;case"linkViaPopup":case"linkViaRedirect":return xF;case"reauthViaPopup":case"reauthViaRedirect":return gF;default:ii(this.auth,"internal-error")}}resolve(e){vs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){vs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vF=new y0(2e3,1e4);class Pc extends PA{constructor(e,r,n,a,o){super(e,r,a,o),this.provider=n,this.authWindow=null,this.pollId=null,Pc.currentPopupAction&&Pc.currentPopupAction.cancel(),Pc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return lt(e,this.auth,"internal-error"),e}async onExecution(){vs(this.filter.length===1,"Popup operations only handle one event");const e=iv();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Pi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Pi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Pc.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Pi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,vF.get())};e()}}Pc.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _F="pendingRedirect",Ad=new Map;class yF extends PA{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=Ad.get(this.auth._key());if(!e){try{const n=await wF(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}Ad.set(this.auth._key(),e)}return this.bypassAuthState||Ad.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function wF(t,e){const r=bF(e),n=TF(t);if(!await n._isAvailable())return!1;const a=await n._get(r)==="true";return await n._remove(r),a}function EF(t,e){Ad.set(t._key(),e)}function TF(t){return us(t._redirectPersistence)}function bF(t){return Sd(_F,t.config.apiKey,t.name)}async function SF(t,e,r=!1){if(ga(t.app))return Promise.reject(hs(t));const n=Ol(t),a=mF(n,e),l=await new yF(n,a,r).execute();return l&&!r&&(delete l.user._redirectEventId,await n._persistUserIfCurrent(l.user),await n._setRedirectUser(null,e)),l}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AF=10*60*1e3;class kF{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!CF(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!LA(e)){const a=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(Pi(this.auth,a))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=AF&&this.cachedEventUids.clear(),this.cachedEventUids.has(GE(e))}saveEventToCache(e){this.cachedEventUids.add(GE(e)),this.lastProcessedEventTime=Date.now()}}function GE(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function LA({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function CF(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return LA(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RF(t,e={}){return Ro(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NF=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,IF=/^https?/;async function DF(t){if(t.config.emulator)return;const{authorizedDomains:e}=await RF(t);for(const r of e)try{if(OF(r))return}catch{}ii(t,"unauthorized-domain")}function OF(t){const e=q1(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const l=new URL(t);return l.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&l.hostname===n}if(!IF.test(r))return!1;if(NF.test(t))return n===t;const a=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FF=new y0(3e4,6e4);function qE(){const t=Li().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function PF(t){return new Promise((e,r)=>{var n,a,o;function l(){qE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{qE(),r(Pi(t,"network-request-failed"))},timeout:FF.get()})}if(!((a=(n=Li().gapi)===null||n===void 0?void 0:n.iframes)===null||a===void 0)&&a.Iframe)e(gapi.iframes.getContext());else if(!((o=Li().gapi)===null||o===void 0)&&o.load)l();else{const u=kO("iframefcb");return Li()[u]=()=>{gapi.load?l():r(Pi(t,"network-request-failed"))},yA(`${AO()}?onload=${u}`).catch(f=>r(f))}}).catch(e=>{throw kd=null,e})}let kd=null;function LF(t){return kd=kd||PF(t),kd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MF=new y0(5e3,15e3),UF="__/auth/iframe",BF="emulator/auth/iframe",VF={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},jF=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function HF(t){const e=t.config;lt(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?ev(e,BF):`https://${t.config.authDomain}/${UF}`,n={apiKey:e.apiKey,appName:t.name,v:Nl},a=jF.get(t.config.apiHost);a&&(n.eid=a);const o=t._getFrameworks();return o.length&&(n.fw=o.join(",")),`${r}?${f0(n).slice(1)}`}async function zF(t){const e=await LF(t),r=Li().gapi;return lt(r,t,"internal-error"),e.open({where:document.body,url:HF(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:VF,dontclear:!0},n=>new Promise(async(a,o)=>{await n.restyle({setHideOnLeave:!1});const l=Pi(t,"network-request-failed"),u=Li().setTimeout(()=>{o(l)},MF.get());function f(){Li().clearTimeout(u),a(n)}n.ping(f).then(f,()=>{o(l)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GF={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},qF=500,WF=600,XF="_blank",KF="http://localhost";class WE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function YF(t,e,r,n=qF,a=WF){const o=Math.max((window.screen.availHeight-a)/2,0).toString(),l=Math.max((window.screen.availWidth-n)/2,0).toString();let u="";const f=Object.assign(Object.assign({},GF),{width:n.toString(),height:a.toString(),top:o,left:l}),d=Pn().toLowerCase();r&&(u=dA(d)?XF:r),fA(d)&&(e=e||KF,f.scrollbars="yes");const m=Object.entries(f).reduce((_,[E,S])=>`${_}${E}=${S},`,"");if(xO(d)&&u!=="_self")return $F(e||"",u),new WE(null);const v=window.open(e||"",u,m);lt(v,t,"popup-blocked");try{v.focus()}catch{}return new WE(v)}function $F(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QF="__/auth/handler",ZF="emulator/auth/handler",JF=encodeURIComponent("fac");async function XE(t,e,r,n,a,o){lt(t.config.authDomain,t,"auth-domain-config-required"),lt(t.config.apiKey,t,"invalid-api-key");const l={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Nl,eventId:a};if(e instanceof TA){e.setDefaultLanguage(t.languageCode),l.providerId=e.providerId||"",yR(e.getCustomParameters())||(l.customParameters=JSON.stringify(e.getCustomParameters()));for(const[m,v]of Object.entries({}))l[m]=v}if(e instanceof E0){const m=e.getScopes().filter(v=>v!=="");m.length>0&&(l.scopes=m.join(","))}t.tenantId&&(l.tid=t.tenantId);const u=l;for(const m of Object.keys(u))u[m]===void 0&&delete u[m];const f=await t._getAppCheckToken(),d=f?`#${JF}=${encodeURIComponent(f)}`:"";return`${e8(t)}?${f0(u).slice(1)}${d}`}function e8({config:t}){return t.emulator?ev(t,ZF):`https://${t.authDomain}/${QF}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jg="webStorageSupport";class t8{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=NA,this._completeRedirectFn=SF,this._overrideRedirectResult=EF}async _openPopup(e,r,n,a){var o;vs((o=this.eventManagers[e._key()])===null||o===void 0?void 0:o.manager,"_initialize() not called before _openPopup()");const l=await XE(e,r,n,q1(),a);return YF(e,l,iv())}async _openRedirect(e,r,n,a){await this._originValidation(e);const o=await XE(e,r,n,q1(),a);return aF(o),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:a,promise:o}=this.eventManagers[r];return a?Promise.resolve(a):(vs(o,"If manager is not set, promise should be"),o)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await zF(e),n=new kF(e);return r.register("authEvent",a=>(lt(a==null?void 0:a.authEvent,e,"invalid-auth-event"),{status:n.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(Jg,{type:Jg},a=>{var o;const l=(o=a==null?void 0:a[0])===null||o===void 0?void 0:o[Jg];l!==void 0&&r(!!l),ii(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=DF(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return vA()||hA()||rv()}}const r8=t8;var KE="@firebase/auth",YE="1.10.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n8{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){lt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a8(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function i8(t){xl(new ho("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:l,authDomain:u}=n.options;lt(l&&!l.includes(":"),"invalid-api-key",{appName:n.name});const f={apiKey:l,authDomain:u,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:_A(t)},d=new TO(n,a,o,f);return OO(d,r),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),xl(new ho("auth-internal",e=>{const r=Ol(e.getProvider("auth").getImmediate());return(n=>new n8(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ni(KE,YE,a8(t)),Ni(KE,YE,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s8=5*60,o8=Tb("authIdTokenMaxAge")||s8;let $E=null;const l8=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>o8)return;const a=r==null?void 0:r.token;$E!==a&&($E=a,await fetch(t,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function MA(t=xx()){const e=cm(t,"auth");if(e.isInitialized())return e.getImmediate();const r=DO(t,{popupRedirectResolver:r8,persistence:[dF,tF,NA]}),n=Tb("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(n,location.origin);if(location.origin===o.origin){const l=l8(o.toString());QO(r,l,()=>l(r.currentUser)),$O(r,u=>l(u))}}const a=yb("auth");return a&&FO(r,`http://${a}`),r}function c8(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}bO({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=a=>{const o=Pi("internal-error");o.customData=a,r(o)},n.type="text/javascript",n.charset="UTF-8",c8().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});i8("Browser");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UA="firebasestorage.googleapis.com",BA="storageBucket",u8=2*60*1e3,f8=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kr extends Bi{constructor(e,r,n=0){super(e1(e),`Firebase Storage: ${r} (${e1(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,kr.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return e1(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Sr;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Sr||(Sr={}));function e1(t){return"storage/"+t}function ov(){const t="An unknown error occurred, please check the error payload for server response.";return new kr(Sr.UNKNOWN,t)}function h8(t){return new kr(Sr.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function d8(t){return new kr(Sr.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function m8(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new kr(Sr.UNAUTHENTICATED,t)}function p8(){return new kr(Sr.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function g8(t){return new kr(Sr.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function x8(){return new kr(Sr.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function v8(){return new kr(Sr.CANCELED,"User canceled the upload/download.")}function _8(t){return new kr(Sr.INVALID_URL,"Invalid URL '"+t+"'.")}function y8(t){return new kr(Sr.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function w8(){return new kr(Sr.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+BA+"' property when initializing the app?")}function E8(){return new kr(Sr.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function T8(){return new kr(Sr.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function b8(t){return new kr(Sr.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function $1(t){return new kr(Sr.INVALID_ARGUMENT,t)}function VA(){return new kr(Sr.APP_DELETED,"The Firebase app was deleted.")}function S8(t){return new kr(Sr.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Df(t,e){return new kr(Sr.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function df(t){throw new kr(Sr.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ya{constructor(e,r){this.bucket=e,this.path_=r}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,r){let n;try{n=ya.makeFromUrl(e,r)}catch{return new ya(e,"")}if(n.path==="")return n;throw y8(e)}static makeFromUrl(e,r){let n=null;const a="([A-Za-z0-9.\\-_]+)";function o(z){z.path.charAt(z.path.length-1)==="/"&&(z.path_=z.path_.slice(0,-1))}const l="(/(.*))?$",u=new RegExp("^gs://"+a+l,"i"),f={bucket:1,path:3};function d(z){z.path_=decodeURIComponent(z.path)}const m="v[A-Za-z0-9_]+",v=r.replace(/[.]/g,"\\."),_="(/([^?#]*).*)?$",E=new RegExp(`^https?://${v}/${m}/b/${a}/o${_}`,"i"),S={bucket:1,path:3},w=r===UA?"(?:storage.googleapis.com|storage.cloud.google.com)":r,b="([^?#]*)",L=new RegExp(`^https?://${w}/${a}/${b}`,"i"),F=[{regex:u,indices:f,postModify:o},{regex:E,indices:S,postModify:d},{regex:L,indices:{bucket:1,path:2},postModify:d}];for(let z=0;z<F.length;z++){const q=F[z],W=q.regex.exec(e);if(W){const k=W[q.indices.bucket];let I=W[q.indices.path];I||(I=""),n=new ya(k,I),q.postModify(n);break}}if(n==null)throw _8(e);return n}}class A8{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k8(t,e,r){let n=1,a=null,o=null,l=!1,u=0;function f(){return u===2}let d=!1;function m(...b){d||(d=!0,e.apply(null,b))}function v(b){a=setTimeout(()=>{a=null,t(E,f())},b)}function _(){o&&clearTimeout(o)}function E(b,...L){if(d){_();return}if(b){_(),m.call(null,b,...L);return}if(f()||l){_(),m.call(null,b,...L);return}n<64&&(n*=2);let F;u===1?(u=2,F=0):F=(n+Math.random())*1e3,v(F)}let S=!1;function w(b){S||(S=!0,_(),!d&&(a!==null?(b||(u=2),clearTimeout(a),v(0)):b||(u=1)))}return v(0),o=setTimeout(()=>{l=!0,w(!0)},r),w}function C8(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R8(t){return t!==void 0}function N8(t){return typeof t=="object"&&!Array.isArray(t)}function lv(t){return typeof t=="string"||t instanceof String}function QE(t){return cv()&&t instanceof Blob}function cv(){return typeof Blob<"u"}function ZE(t,e,r,n){if(n<e)throw $1(`Invalid value for '${t}'. Expected ${e} or greater.`);if(n>r)throw $1(`Invalid value for '${t}'. Expected ${r} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b0(t,e,r){let n=e;return r==null&&(n=`https://${e}`),`${r}://${n}/v0${t}`}function jA(t){const e=encodeURIComponent;let r="?";for(const n in t)if(t.hasOwnProperty(n)){const a=e(n)+"="+e(t[n]);r=r+a+"&"}return r=r.slice(0,-1),r}var fl;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(fl||(fl={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I8(t,e){const r=t>=500&&t<600,a=[408,429].indexOf(t)!==-1,o=e.indexOf(t)!==-1;return r||a||o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D8{constructor(e,r,n,a,o,l,u,f,d,m,v,_=!0,E=!1){this.url_=e,this.method_=r,this.headers_=n,this.body_=a,this.successCodes_=o,this.additionalRetryCodes_=l,this.callback_=u,this.errorCallback_=f,this.timeout_=d,this.progressCallback_=m,this.connectionFactory_=v,this.retry=_,this.isUsingEmulator=E,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((S,w)=>{this.resolve_=S,this.reject_=w,this.start_()})}start_(){const e=(n,a)=>{if(a){n(!1,new nd(!1,null,!0));return}const o=this.connectionFactory_();this.pendingConnection_=o;const l=u=>{const f=u.loaded,d=u.lengthComputable?u.total:-1;this.progressCallback_!==null&&this.progressCallback_(f,d)};this.progressCallback_!==null&&o.addUploadProgressListener(l),o.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&o.removeUploadProgressListener(l),this.pendingConnection_=null;const u=o.getErrorCode()===fl.NO_ERROR,f=o.getStatus();if(!u||I8(f,this.additionalRetryCodes_)&&this.retry){const m=o.getErrorCode()===fl.ABORT;n(!1,new nd(!1,null,m));return}const d=this.successCodes_.indexOf(f)!==-1;n(!0,new nd(d,o))})},r=(n,a)=>{const o=this.resolve_,l=this.reject_,u=a.connection;if(a.wasSuccessCode)try{const f=this.callback_(u,u.getResponse());R8(f)?o(f):o()}catch(f){l(f)}else if(u!==null){const f=ov();f.serverResponse=u.getErrorText(),this.errorCallback_?l(this.errorCallback_(u,f)):l(f)}else if(a.canceled){const f=this.appDelete_?VA():v8();l(f)}else{const f=x8();l(f)}};this.canceled_?r(!1,new nd(!1,null,!0)):this.backoffId_=k8(e,r,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&C8(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class nd{constructor(e,r,n){this.wasSuccessCode=e,this.connection=r,this.canceled=!!n}}function O8(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function F8(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function P8(t,e){e&&(t["X-Firebase-GMPID"]=e)}function L8(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function M8(t,e,r,n,a,o,l=!0,u=!1){const f=jA(t.urlParams),d=t.url+f,m=Object.assign({},t.headers);return P8(m,e),O8(m,r),F8(m,o),L8(m,n),new D8(d,t.method,m,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,a,l,u)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U8(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function B8(...t){const e=U8();if(e!==void 0){const r=new e;for(let n=0;n<t.length;n++)r.append(t[n]);return r.getBlob()}else{if(cv())return new Blob(t);throw new kr(Sr.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function V8(t,e,r){return t.webkitSlice?t.webkitSlice(e,r):t.mozSlice?t.mozSlice(e,r):t.slice?t.slice(e,r):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j8(t){if(typeof atob>"u")throw b8("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ci={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class t1{constructor(e,r){this.data=e,this.contentType=r||null}}function H8(t,e){switch(t){case Ci.RAW:return new t1(HA(e));case Ci.BASE64:case Ci.BASE64URL:return new t1(zA(t,e));case Ci.DATA_URL:return new t1(G8(e),q8(e))}throw ov()}function HA(t){const e=[];for(let r=0;r<t.length;r++){let n=t.charCodeAt(r);if(n<=127)e.push(n);else if(n<=2047)e.push(192|n>>6,128|n&63);else if((n&64512)===55296)if(!(r<t.length-1&&(t.charCodeAt(r+1)&64512)===56320))e.push(239,191,189);else{const o=n,l=t.charCodeAt(++r);n=65536|(o&1023)<<10|l&1023,e.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|n&63)}else(n&64512)===56320?e.push(239,191,189):e.push(224|n>>12,128|n>>6&63,128|n&63)}return new Uint8Array(e)}function z8(t){let e;try{e=decodeURIComponent(t)}catch{throw Df(Ci.DATA_URL,"Malformed data URL.")}return HA(e)}function zA(t,e){switch(t){case Ci.BASE64:{const a=e.indexOf("-")!==-1,o=e.indexOf("_")!==-1;if(a||o)throw Df(t,"Invalid character '"+(a?"-":"_")+"' found: is it base64url encoded?");break}case Ci.BASE64URL:{const a=e.indexOf("+")!==-1,o=e.indexOf("/")!==-1;if(a||o)throw Df(t,"Invalid character '"+(a?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let r;try{r=j8(e)}catch(a){throw a.message.includes("polyfill")?a:Df(t,"Invalid character found")}const n=new Uint8Array(r.length);for(let a=0;a<r.length;a++)n[a]=r.charCodeAt(a);return n}class GA{constructor(e){this.base64=!1,this.contentType=null;const r=e.match(/^data:([^,]+)?,/);if(r===null)throw Df(Ci.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=r[1]||null;n!=null&&(this.base64=W8(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=e.substring(e.indexOf(",")+1)}}function G8(t){const e=new GA(t);return e.base64?zA(Ci.BASE64,e.rest):z8(e.rest)}function q8(t){return new GA(t).contentType}function W8(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ro{constructor(e,r){let n=0,a="";QE(e)?(this.data_=e,n=e.size,a=e.type):e instanceof ArrayBuffer?(r?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(r?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=a}size(){return this.size_}type(){return this.type_}slice(e,r){if(QE(this.data_)){const n=this.data_,a=V8(n,e,r);return a===null?null:new ro(a)}else{const n=new Uint8Array(this.data_.buffer,e,r-e);return new ro(n,!0)}}static getBlob(...e){if(cv()){const r=e.map(n=>n instanceof ro?n.data_:n);return new ro(B8.apply(null,r))}else{const r=e.map(l=>lv(l)?H8(Ci.RAW,l).data:l.data_);let n=0;r.forEach(l=>{n+=l.byteLength});const a=new Uint8Array(n);let o=0;return r.forEach(l=>{for(let u=0;u<l.length;u++)a[o++]=l[u]}),new ro(a,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qA(t){let e;try{e=JSON.parse(t)}catch{return null}return N8(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X8(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function K8(t,e){const r=e.split("/").filter(n=>n.length>0).join("/");return t.length===0?r:t+"/"+r}function WA(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y8(t,e){return e}class Gn{constructor(e,r,n,a){this.server=e,this.local=r||e,this.writable=!!n,this.xform=a||Y8}}let ad=null;function $8(t){return!lv(t)||t.length<2?t:WA(t)}function uv(){if(ad)return ad;const t=[];t.push(new Gn("bucket")),t.push(new Gn("generation")),t.push(new Gn("metageneration")),t.push(new Gn("name","fullPath",!0));function e(o,l){return $8(l)}const r=new Gn("name");r.xform=e,t.push(r);function n(o,l){return l!==void 0?Number(l):l}const a=new Gn("size");return a.xform=n,t.push(a),t.push(new Gn("timeCreated")),t.push(new Gn("updated")),t.push(new Gn("md5Hash",null,!0)),t.push(new Gn("cacheControl",null,!0)),t.push(new Gn("contentDisposition",null,!0)),t.push(new Gn("contentEncoding",null,!0)),t.push(new Gn("contentLanguage",null,!0)),t.push(new Gn("contentType",null,!0)),t.push(new Gn("metadata","customMetadata",!0)),ad=t,ad}function Q8(t,e){function r(){const n=t.bucket,a=t.fullPath,o=new ya(n,a);return e._makeStorageReference(o)}Object.defineProperty(t,"ref",{get:r})}function Z8(t,e,r){const n={};n.type="file";const a=r.length;for(let o=0;o<a;o++){const l=r[o];n[l.local]=l.xform(n,e[l.server])}return Q8(n,t),n}function XA(t,e,r){const n=qA(e);return n===null?null:Z8(t,n,r)}function J8(t,e,r,n){const a=qA(e);if(a===null||!lv(a.downloadTokens))return null;const o=a.downloadTokens;if(o.length===0)return null;const l=encodeURIComponent;return o.split(",").map(d=>{const m=t.bucket,v=t.fullPath,_="/b/"+l(m)+"/o/"+l(v),E=b0(_,r,n),S=jA({alt:"media",token:d});return E+S})[0]}function e5(t,e){const r={},n=e.length;for(let a=0;a<n;a++){const o=e[a];o.writable&&(r[o.server]=t[o.local])}return JSON.stringify(r)}class Rm{constructor(e,r,n,a){this.url=e,this.method=r,this.handler=n,this.timeout=a,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KA(t){if(!t)throw ov()}function YA(t,e){function r(n,a){const o=XA(t,a,e);return KA(o!==null),o}return r}function t5(t,e){function r(n,a){const o=XA(t,a,e);return KA(o!==null),J8(o,a,t.host,t._protocol)}return r}function $A(t){function e(r,n){let a;return r.getStatus()===401?r.getErrorText().includes("Firebase App Check token is invalid")?a=p8():a=m8():r.getStatus()===402?a=d8(t.bucket):r.getStatus()===403?a=g8(t.path):a=n,a.status=r.getStatus(),a.serverResponse=n.serverResponse,a}return e}function fv(t){const e=$A(t);function r(n,a){let o=e(n,a);return n.getStatus()===404&&(o=h8(t.path)),o.serverResponse=a.serverResponse,o}return r}function r5(t,e,r){const n=e.fullServerUrl(),a=b0(n,t.host,t._protocol),o="GET",l=t.maxOperationRetryTime,u=new Rm(a,o,YA(t,r),l);return u.errorHandler=fv(e),u}function n5(t,e,r){const n=e.fullServerUrl(),a=b0(n,t.host,t._protocol),o="GET",l=t.maxOperationRetryTime,u=new Rm(a,o,t5(t,r),l);return u.errorHandler=fv(e),u}function a5(t,e){const r=e.fullServerUrl(),n=b0(r,t.host,t._protocol),a="DELETE",o=t.maxOperationRetryTime;function l(f,d){}const u=new Rm(n,a,l,o);return u.successCodes=[200,204],u.errorHandler=fv(e),u}function i5(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function s5(t,e,r){const n=Object.assign({},r);return n.fullPath=t.path,n.size=e.size(),n.contentType||(n.contentType=i5(null,e)),n}function o5(t,e,r,n,a){const o=e.bucketOnlyServerUrl(),l={"X-Goog-Upload-Protocol":"multipart"};function u(){let F="";for(let z=0;z<2;z++)F=F+Math.random().toString().slice(2);return F}const f=u();l["Content-Type"]="multipart/related; boundary="+f;const d=s5(e,n,a),m=e5(d,r),v="--"+f+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+m+`\r
--`+f+`\r
Content-Type: `+d.contentType+`\r
\r
`,_=`\r
--`+f+"--",E=ro.getBlob(v,n,_);if(E===null)throw E8();const S={name:d.fullPath},w=b0(o,t.host,t._protocol),b="POST",L=t.maxUploadRetryTime,B=new Rm(w,b,YA(t,r),L);return B.urlParams=S,B.headers=l,B.body=E.uploadData(),B.errorHandler=$A(e),B}class l5{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=fl.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=fl.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=fl.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,r,n,a,o){if(this.sent_)throw df("cannot .send() more than once");if(So(e)&&n&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(r,e,!0),o!==void 0)for(const l in o)o.hasOwnProperty(l)&&this.xhr_.setRequestHeader(l,o[l].toString());return a!==void 0?this.xhr_.send(a):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw df("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw df("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw df("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw df("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class c5 extends l5{initXhr(){this.xhr_.responseType="text"}}function Nm(){return new c5}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tl{constructor(e,r){this._service=e,r instanceof ya?this._location=r:this._location=ya.makeFromUrl(r,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,r){return new Tl(e,r)}get root(){const e=new ya(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return WA(this._location.path)}get storage(){return this._service}get parent(){const e=X8(this._location.path);if(e===null)return null;const r=new ya(this._location.bucket,e);return new Tl(this._service,r)}_throwIfRoot(e){if(this._location.path==="")throw S8(e)}}function u5(t,e,r){t._throwIfRoot("uploadBytes");const n=o5(t.storage,t._location,uv(),new ro(e,!0),r);return t.storage.makeRequestWithTokens(n,Nm).then(a=>({metadata:a,ref:t}))}function f5(t){t._throwIfRoot("getMetadata");const e=r5(t.storage,t._location,uv());return t.storage.makeRequestWithTokens(e,Nm)}function h5(t){t._throwIfRoot("getDownloadURL");const e=n5(t.storage,t._location,uv());return t.storage.makeRequestWithTokens(e,Nm).then(r=>{if(r===null)throw T8();return r})}function d5(t){t._throwIfRoot("deleteObject");const e=a5(t.storage,t._location);return t.storage.makeRequestWithTokens(e,Nm)}function m5(t,e){const r=K8(t._location.path,e),n=new ya(t._location.bucket,r);return new Tl(t.storage,n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p5(t){return/^[A-Za-z]+:\/\//.test(t)}function g5(t,e){return new Tl(t,e)}function QA(t,e){if(t instanceof hv){const r=t;if(r._bucket==null)throw w8();const n=new Tl(r,r._bucket);return e!=null?QA(n,e):n}else return e!==void 0?m5(t,e):t}function x5(t,e){if(e&&p5(e)){if(t instanceof hv)return g5(t,e);throw $1("To use ref(service, url), the first argument must be a Storage instance.")}else return QA(t,e)}function JE(t,e){const r=e==null?void 0:e[BA];return r==null?null:ya.makeFromBucketSpec(r,t)}function v5(t,e,r,n={}){t.host=`${e}:${r}`;const a=So(e);a&&(hx(`https://${t.host}/b`),dx("Storage",!0)),t._isUsingEmulator=!0,t._protocol=a?"https":"http";const{mockUserToken:o}=n;o&&(t._overrideAuthToken=typeof o=="string"?o:bb(o,t.app.options.projectId))}class hv{constructor(e,r,n,a,o,l=!1){this.app=e,this._authProvider=r,this._appCheckProvider=n,this._url=a,this._firebaseVersion=o,this._isUsingEmulator=l,this._bucket=null,this._host=UA,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=u8,this._maxUploadRetryTime=f8,this._requests=new Set,a!=null?this._bucket=ya.makeFromBucketSpec(a,this._host):this._bucket=JE(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=ya.makeFromBucketSpec(this._url,e):this._bucket=JE(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){ZE("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){ZE("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const r=await e.getToken();if(r!==null)return r.accessToken}return null}async _getAppCheckToken(){if(ga(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Tl(this,e)}_makeRequest(e,r,n,a,o=!0){if(this._deleted)return new A8(VA());{const l=M8(e,this._appId,n,a,r,this._firebaseVersion,o,this._isUsingEmulator);return this._requests.add(l),l.getPromise().then(()=>this._requests.delete(l),()=>this._requests.delete(l)),l}}async makeRequestWithTokens(e,r){const[n,a]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,r,n,a).getPromise()}}const eT="@firebase/storage",tT="0.13.14";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZA="storage";function JA(t,e,r){return t=gr(t),u5(t,e,r)}function _5(t){return t=gr(t),f5(t)}function ek(t){return t=gr(t),h5(t)}function y5(t){return t=gr(t),d5(t)}function Cd(t,e){return t=gr(t),x5(t,e)}function w5(t=xx(),e){t=gr(t);const n=cm(t,ZA).getImmediate({identifier:e}),a=wb("storage");return a&&E5(n,...a),n}function E5(t,e,r,n={}){v5(t,e,r,n)}function T5(t,{instanceIdentifier:e}){const r=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),a=t.getProvider("app-check-internal");return new hv(r,n,a,e,Nl)}function b5(){xl(new ho(ZA,T5,"PUBLIC").setMultipleInstances(!0)),Ni(eT,tT,""),Ni(eT,tT,"esm2017")}b5();const tk={apiKey:"AIzaSyA1pcLUIXvnOO3Zgn9FQ5J02nOkjVpxYXU",authDomain:"licencas-a47f9.firebaseapp.com",projectId:"licencas-a47f9",storageBucket:"licencas-a47f9.firebasestorage.app",messagingSenderId:"738531068737",appId:"1:738531068737:web:0cc6a20e42a7e118e72fc0",measurementId:"G-JGXM1WF3P4"},dv=gx(tk),Xn=D6(dv),wf=MA(dv),Rd=w5(dv),Im=({className:t="h-6 w-6"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})}),Dm=({className:t="h-5 w-5"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),S0=({className:t="h-5 w-5"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),rk=({className:t="h-6 w-6"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2a1 1 0 01-.293.707l-6.414 6.414A1 1 0 0013 13.414V19a1 1 0 01-1.447.894l-4-2A1 1 0 017 17v-3.586a1 1 0 00-.293-.707L3.293 6.707A1 1 0 013 6V4z"})}),S5=({className:t="h-6 w-6"})=>y.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 17v2a2 2 0 002 2h12a2 2 0 002-2v-2"}),y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 12l4-4m0 0l4 4m-4-4v9"})]}),A5=({className:t="h-6 w-6"})=>y.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[y.jsx("rect",{x:"3",y:"4",width:"4",height:"16",rx:"1"}),y.jsx("rect",{x:"9",y:"4",width:"4",height:"16",rx:"1"}),y.jsx("rect",{x:"15",y:"4",width:"4",height:"16",rx:"1"})]});/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Yd={};Yd.version="0.18.5";var nk=1252,k5=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],mv={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},pv=function(t){k5.indexOf(t)!=-1&&(nk=mv[0]=t)};function C5(){pv(1252)}var Ja=function(t){pv(t)};function gv(){Ja(1200),C5()}function rT(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function R5(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function ak(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var Ef=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?R5(t.slice(2)):e==254&&r==255?ak(t.slice(2)):e==65279?t.slice(1):t},id=function(e){return String.fromCharCode(e)},nT=function(e){return String.fromCharCode(e)},$f,ao="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Qf(t){for(var e="",r=0,n=0,a=0,o=0,l=0,u=0,f=0,d=0;d<t.length;)r=t.charCodeAt(d++),o=r>>2,n=t.charCodeAt(d++),l=(r&3)<<4|n>>4,a=t.charCodeAt(d++),u=(n&15)<<2|a>>6,f=a&63,isNaN(n)?u=f=64:isNaN(a)&&(f=64),e+=ao.charAt(o)+ao.charAt(l)+ao.charAt(u)+ao.charAt(f);return e}function wa(t){var e="",r=0,n=0,a=0,o=0,l=0,u=0,f=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<t.length;)o=ao.indexOf(t.charAt(d++)),l=ao.indexOf(t.charAt(d++)),r=o<<2|l>>4,e+=String.fromCharCode(r),u=ao.indexOf(t.charAt(d++)),n=(l&15)<<4|u>>2,u!==64&&(e+=String.fromCharCode(n)),f=ao.indexOf(t.charAt(d++)),a=(u&3)<<6|f,f!==64&&(e+=String.fromCharCode(a));return e}var bt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),ys=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function wo(t){return bt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function aT(t){return bt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var xa=function(e){return bt?ys(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Om(t){if(typeof ArrayBuffer>"u")return xa(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function No(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function N5(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function xv(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return xv(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var un=bt?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:ys(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),a=0;for(e=0,r=0;e<t.length;r+=a,++e)if(a=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function I5(t){for(var e=[],r=0,n=t.length+250,a=wo(t.length+255),o=0;o<t.length;++o){var l=t.charCodeAt(o);if(l<128)a[r++]=l;else if(l<2048)a[r++]=192|l>>6&31,a[r++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var u=t.charCodeAt(++o)&1023;a[r++]=240|l>>8&7,a[r++]=128|l>>2&63,a[r++]=128|u>>6&15|(l&3)<<4,a[r++]=128|u&63}else a[r++]=224|l>>12&15,a[r++]=128|l>>6&63,a[r++]=128|l&63;r>n&&(e.push(a.slice(0,r)),r=0,a=wo(65535),n=65530)}return e.push(a.slice(0,r)),un(e)}var Kn=/\u0000/g,Tf=/[\u0001-\u0006]/g;function zc(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function ei(t,e){var r=""+t;return r.length>=e?r:Tr("0",e-r.length)+r}function vv(t,e){var r=""+t;return r.length>=e?r:Tr(" ",e-r.length)+r}function $d(t,e){var r=""+t;return r.length>=e?r:r+Tr(" ",e-r.length)}function D5(t,e){var r=""+Math.round(t);return r.length>=e?r:Tr("0",e-r.length)+r}function O5(t,e){var r=""+t;return r.length>=e?r:Tr("0",e-r.length)+r}var iT=Math.pow(2,32);function kc(t,e){if(t>iT||t<-iT)return D5(t,e);var r=Math.round(t);return O5(r,e)}function Qd(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var sT=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],r1=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function F5(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var at={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},oT={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},P5={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Zd(t,e,r){for(var n=t<0?-1:1,a=t*n,o=0,l=1,u=0,f=1,d=0,m=0,v=Math.floor(a);d<e&&(v=Math.floor(a),u=v*l+o,m=v*d+f,!(a-v<5e-8));)a=1/(a-v),o=l,l=u,f=d,d=m;if(m>e&&(d>e?(m=f,u=o):(m=d,u=l)),!r)return[0,n*u,m];var _=Math.floor(n*u/m);return[_,n*u-_*m,m]}function io(t,e,r){if(t>2958465||t<0)return null;var n=t|0,a=Math.floor(86400*(t-n)),o=0,l=[],u={D:n,T:a,u:86400*(t-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),e&&e.date1904&&(n+=1462),u.u>.9999&&(u.u=0,++a==86400&&(u.T=a=0,++n,++u.D)),n===60)l=r?[1317,10,29]:[1900,2,29],o=3;else if(n===0)l=r?[1317,8,29]:[1900,1,0],o=6;else{n>60&&--n;var f=new Date(1900,0,1);f.setDate(f.getDate()+n-1),l=[f.getFullYear(),f.getMonth()+1,f.getDate()],o=f.getDay(),n<60&&(o=(o+6)%7),r&&(o=j5(f,l))}return u.y=l[0],u.m=l[1],u.d=l[2],u.S=a%60,a=Math.floor(a/60),u.M=a%60,a=Math.floor(a/60),u.H=a,u.q=o,u}var ik=new Date(1899,11,31,0,0,0),L5=ik.getTime(),M5=new Date(1900,2,1,0,0,0);function sk(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=M5&&(r+=24*60*60*1e3),(r-(L5+(t.getTimezoneOffset()-ik.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function _v(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function U5(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function B5(t){var e=t<0?12:11,r=_v(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function V5(t){var e=_v(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function Zf(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=B5(t):e===10?r=t.toFixed(10).substr(0,12):r=V5(t),_v(U5(r.toUpperCase()))}function bl(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):Zf(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Ea(14,sk(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function j5(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function H5(t,e,r,n){var a="",o=0,l=0,u=r.y,f,d=0;switch(t){case 98:u=r.y+543;case 121:switch(e.length){case 1:case 2:f=u%100,d=2;break;default:f=u%1e4,d=4;break}break;case 109:switch(e.length){case 1:case 2:f=r.m,d=e.length;break;case 3:return r1[r.m-1][1];case 5:return r1[r.m-1][0];default:return r1[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:f=r.d,d=e.length;break;case 3:return sT[r.q][0];default:return sT[r.q][1]}break;case 104:switch(e.length){case 1:case 2:f=1+(r.H+11)%12,d=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:f=r.H,d=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:f=r.M,d=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?ei(r.S,e.length):(n>=2?l=n===3?1e3:100:l=n===1?10:1,o=Math.round(l*(r.S+r.u)),o>=60*l&&(o=0),e==="s"?o===0?"0":""+o/l:(a=ei(o,2+n),e==="ss"?a.substr(0,2):"."+a.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":f=r.D*24+r.H;break;case"[m]":case"[mm]":f=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":f=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}d=e.length===3?1:2;break;case 101:f=u,d=1;break}var m=d>0?ei(f,d):"";return m}function so(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var ok=/%/g;function z5(t,e,r){var n=e.replace(ok,""),a=e.length-n.length;return ds(t,n,r*Math.pow(10,2*a))+Tr("%",a)}function G5(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return ds(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function lk(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+lk(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var o=Math.floor(Math.log(e)*Math.LOG10E)%a;if(o<0&&(o+=a),r=(e/Math.pow(10,o)).toPrecision(n+1+(a+o)%a),r.indexOf("e")===-1){var l=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+o):r+="E+"+(l-o);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,f,d,m){return f+d+m.substr(0,(a+o)%a)+"."+m.substr(o)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var ck=/# (\?+)( ?)\/( ?)(\d+)/;function q5(t,e,r){var n=parseInt(t[4],10),a=Math.round(e*n),o=Math.floor(a/n),l=a-o*n,u=n;return r+(o===0?"":""+o)+" "+(l===0?Tr(" ",t[1].length+1+t[4].length):vv(l,t[1].length)+t[2]+"/"+t[3]+ei(u,t[4].length))}function W5(t,e,r){return r+(e===0?"":""+e)+Tr(" ",t[1].length+2+t[4].length)}var uk=/^#*0*\.([0#]+)/,fk=/\).*[0#]/,hk=/\(###\) ###\\?-####/;function qn(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function lT(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function cT(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function X5(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function K5(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function La(t,e,r){if(t.charCodeAt(0)===40&&!e.match(fk)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?La("n",n,r):"("+La("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return G5(t,e,r);if(e.indexOf("%")!==-1)return z5(t,e,r);if(e.indexOf("E")!==-1)return lk(e,r);if(e.charCodeAt(0)===36)return"$"+La(t,e.substr(e.charAt(1)==" "?2:1),r);var a,o,l,u,f=Math.abs(r),d=r<0?"-":"";if(e.match(/^00+$/))return d+kc(f,e.length);if(e.match(/^[#?]+$/))return a=kc(r,0),a==="0"&&(a=""),a.length>e.length?a:qn(e.substr(0,e.length-a.length))+a;if(o=e.match(ck))return q5(o,f,d);if(e.match(/^#+0+$/))return d+kc(f,e.length-e.indexOf("0"));if(o=e.match(uk))return a=lT(r,o[1].length).replace(/^([^\.]+)$/,"$1."+qn(o[1])).replace(/\.$/,"."+qn(o[1])).replace(/\.(\d*)$/,function(S,w){return"."+w+Tr("0",qn(o[1]).length-w.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),o=e.match(/^(0*)\.(#*)$/))return d+lT(f,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=e.match(/^#{1,3},##0(\.?)$/))return d+so(kc(f,0));if(o=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+La(t,e,-r):so(""+(Math.floor(r)+X5(r,o[1].length)))+"."+ei(cT(r,o[1].length),o[1].length);if(o=e.match(/^#,#*,#0/))return La(t,e.replace(/^#,#*,/,""),r);if(o=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=zc(La(t,e.replace(/[\\-]/g,""),r)),l=0,zc(zc(e.replace(/\\/g,"")).replace(/[0#]/g,function(S){return l<a.length?a.charAt(l++):S==="0"?"0":""}));if(e.match(hk))return a=La(t,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var m="";if(o=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),u=Zd(f,Math.pow(10,l)-1,!1),a=""+d,m=ds("n",o[1],u[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),a+=m+o[2]+"/"+o[3],m=$d(u[2],l),m.length<o[4].length&&(m=qn(o[4].substr(o[4].length-m.length))+m),a+=m,a;if(o=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),u=Zd(f,Math.pow(10,l)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?vv(u[1],l)+o[2]+"/"+o[3]+$d(u[2],l):Tr(" ",2*l+1+o[2].length+o[3].length));if(o=e.match(/^[#0?]+$/))return a=kc(r,0),e.length<=a.length?a:qn(e.substr(0,e.length-a.length))+a;if(o=e.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var v=e.indexOf(".")-l,_=e.length-a.length-v;return qn(e.substr(0,v)+a+e.substr(e.length-_))}if(o=e.match(/^00,000\.([#0]*0)$/))return l=cT(r,o[1].length),r<0?"-"+La(t,e,-r):so(K5(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(S){return"00,"+(S.length<3?ei(0,3-S.length):"")+S})+"."+ei(l,o[1].length);switch(e){case"###,##0.00":return La(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var E=so(kc(f,0));return E!=="0"?d+E:"";case"###,###.00":return La(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return La(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function Y5(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return ds(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function $5(t,e,r){var n=e.replace(ok,""),a=e.length-n.length;return ds(t,n,r*Math.pow(10,2*a))+Tr("%",a)}function dk(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+dk(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var o=Math.floor(Math.log(e)*Math.LOG10E)%a;if(o<0&&(o+=a),r=(e/Math.pow(10,o)).toPrecision(n+1+(a+o)%a),!r.match(/[Ee]/)){var l=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+o):r+="E+"+(l-o),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,f,d,m){return f+d+m.substr(0,(a+o)%a)+"."+m.substr(o)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function bi(t,e,r){if(t.charCodeAt(0)===40&&!e.match(fk)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?bi("n",n,r):"("+bi("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return Y5(t,e,r);if(e.indexOf("%")!==-1)return $5(t,e,r);if(e.indexOf("E")!==-1)return dk(e,r);if(e.charCodeAt(0)===36)return"$"+bi(t,e.substr(e.charAt(1)==" "?2:1),r);var a,o,l,u,f=Math.abs(r),d=r<0?"-":"";if(e.match(/^00+$/))return d+ei(f,e.length);if(e.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>e.length?a:qn(e.substr(0,e.length-a.length))+a;if(o=e.match(ck))return W5(o,f,d);if(e.match(/^#+0+$/))return d+ei(f,e.length-e.indexOf("0"));if(o=e.match(uk))return a=(""+r).replace(/^([^\.]+)$/,"$1."+qn(o[1])).replace(/\.$/,"."+qn(o[1])),a=a.replace(/\.(\d*)$/,function(S,w){return"."+w+Tr("0",qn(o[1]).length-w.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),o=e.match(/^(0*)\.(#*)$/))return d+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=e.match(/^#{1,3},##0(\.?)$/))return d+so(""+f);if(o=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+bi(t,e,-r):so(""+r)+"."+Tr("0",o[1].length);if(o=e.match(/^#,#*,#0/))return bi(t,e.replace(/^#,#*,/,""),r);if(o=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=zc(bi(t,e.replace(/[\\-]/g,""),r)),l=0,zc(zc(e.replace(/\\/g,"")).replace(/[0#]/g,function(S){return l<a.length?a.charAt(l++):S==="0"?"0":""}));if(e.match(hk))return a=bi(t,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var m="";if(o=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),u=Zd(f,Math.pow(10,l)-1,!1),a=""+d,m=ds("n",o[1],u[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),a+=m+o[2]+"/"+o[3],m=$d(u[2],l),m.length<o[4].length&&(m=qn(o[4].substr(o[4].length-m.length))+m),a+=m,a;if(o=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),u=Zd(f,Math.pow(10,l)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?vv(u[1],l)+o[2]+"/"+o[3]+$d(u[2],l):Tr(" ",2*l+1+o[2].length+o[3].length));if(o=e.match(/^[#0?]+$/))return a=""+r,e.length<=a.length?a:qn(e.substr(0,e.length-a.length))+a;if(o=e.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var v=e.indexOf(".")-l,_=e.length-a.length-v;return qn(e.substr(0,v)+a+e.substr(e.length-_))}if(o=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+bi(t,e,-r):so(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(S){return"00,"+(S.length<3?ei(0,3-S.length):"")+S})+"."+ei(0,o[1].length);switch(e){case"###,###":case"##,###":case"#,###":var E=so(""+f);return E!=="0"?d+E:"";default:if(e.match(/\.[0#?]*$/))return bi(t,e.slice(0,e.lastIndexOf(".")),r)+qn(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function ds(t,e,r){return(r|0)===r?bi(t,e,r):La(t,e,r)}function Q5(t){for(var e=[],r=!1,n=0,a=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(a,n-a),a=n+1}if(e[e.length]=t.substr(a),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var mk=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Fl(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Qd(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(mk))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function Z5(t,e,r,n){for(var a=[],o="",l=0,u="",f="t",d,m,v,_="H";l<t.length;)switch(u=t.charAt(l)){case"G":if(!Qd(t,l))throw new Error("unrecognized character "+u+" in "+t);a[a.length]={t:"G",v:"General"},l+=7;break;case'"':for(o="";(v=t.charCodeAt(++l))!==34&&l<t.length;)o+=String.fromCharCode(v);a[a.length]={t:"t",v:o},++l;break;case"\\":var E=t.charAt(++l),S=E==="("||E===")"?E:"t";a[a.length]={t:S,v:E},++l;break;case"_":a[a.length]={t:"t",v:" "},l+=2;break;case"@":a[a.length]={t:"T",v:e},++l;break;case"B":case"b":if(t.charAt(l+1)==="1"||t.charAt(l+1)==="2"){if(d==null&&(d=io(e,r,t.charAt(l+1)==="2"),d==null))return"";a[a.length]={t:"X",v:t.substr(l,2)},f=u,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||d==null&&(d=io(e,r),d==null))return"";for(o=u;++l<t.length&&t.charAt(l).toLowerCase()===u;)o+=u;u==="m"&&f.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=_),a[a.length]={t:u,v:o},f=u;break;case"A":case"a":case"":var w={t:u,v:u};if(d==null&&(d=io(e,r)),t.substr(l,3).toUpperCase()==="A/P"?(d!=null&&(w.v=d.H>=12?"P":"A"),w.t="T",_="h",l+=3):t.substr(l,5).toUpperCase()==="AM/PM"?(d!=null&&(w.v=d.H>=12?"PM":"AM"),w.t="T",l+=5,_="h"):t.substr(l,5).toUpperCase()==="/"?(d!=null&&(w.v=d.H>=12?"":""),w.t="T",l+=5,_="h"):(w.t="t",++l),d==null&&w.t==="T")return"";a[a.length]=w,f=u;break;case"[":for(o=u;t.charAt(l++)!=="]"&&l<t.length;)o+=t.charAt(l);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(mk)){if(d==null&&(d=io(e,r),d==null))return"";a[a.length]={t:"Z",v:o.toLowerCase()},f=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",Fl(t)||(a[a.length]={t:"t",v:o}));break;case".":if(d!=null){for(o=u;++l<t.length&&(u=t.charAt(l))==="0";)o+=u;a[a.length]={t:"s",v:o};break}case"0":case"#":for(o=u;++l<t.length&&"0#?.,E+-%".indexOf(u=t.charAt(l))>-1;)o+=u;a[a.length]={t:"n",v:o};break;case"?":for(o=u;t.charAt(++l)===u;)o+=u;a[a.length]={t:u,v:o},f=u;break;case"*":++l,(t.charAt(l)==" "||t.charAt(l)=="*")&&++l;break;case"(":case")":a[a.length]={t:n===1?"t":u,v:u},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=u;l<t.length&&"0123456789".indexOf(t.charAt(++l))>-1;)o+=t.charAt(l);a[a.length]={t:"D",v:o};break;case" ":a[a.length]={t:u,v:u},++l;break;case"$":a[a.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+t);a[a.length]={t:"t",v:u},++l;break}var b=0,L=0,B;for(l=a.length-1,f="t";l>=0;--l)switch(a[l].t){case"h":case"H":a[l].t=_,f="h",b<1&&(b=1);break;case"s":(B=a[l].v.match(/\.0+$/))&&(L=Math.max(L,B[0].length-1)),b<3&&(b=3);case"d":case"y":case"M":case"e":f=a[l].t;break;case"m":f==="s"&&(a[l].t="M",b<2&&(b=2));break;case"X":break;case"Z":b<1&&a[l].v.match(/[Hh]/)&&(b=1),b<2&&a[l].v.match(/[Mm]/)&&(b=2),b<3&&a[l].v.match(/[Ss]/)&&(b=3)}switch(b){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var F="",z;for(l=0;l<a.length;++l)switch(a[l].t){case"t":case"T":case" ":case"D":break;case"X":a[l].v="",a[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[l].v=H5(a[l].t.charCodeAt(0),a[l].v,d,L),a[l].t="t";break;case"n":case"?":for(z=l+1;a[z]!=null&&((u=a[z].t)==="?"||u==="D"||(u===" "||u==="t")&&a[z+1]!=null&&(a[z+1].t==="?"||a[z+1].t==="t"&&a[z+1].v==="/")||a[l].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(a[z].v==="/"||a[z].v===" "&&a[z+1]!=null&&a[z+1].t=="?"));)a[l].v+=a[z].v,a[z]={v:"",t:";"},++z;F+=a[l].v,l=z-1;break;case"G":a[l].t="t",a[l].v=bl(e,r);break}var q="",W,k;if(F.length>0){F.charCodeAt(0)==40?(W=e<0&&F.charCodeAt(0)===45?-e:e,k=ds("n",F,W)):(W=e<0&&n>1?-e:e,k=ds("n",F,W),W<0&&a[0]&&a[0].t=="t"&&(k=k.substr(1),a[0].v="-"+a[0].v)),z=k.length-1;var I=a.length;for(l=0;l<a.length;++l)if(a[l]!=null&&a[l].t!="t"&&a[l].v.indexOf(".")>-1){I=l;break}var A=a.length;if(I===a.length&&k.indexOf("E")===-1){for(l=a.length-1;l>=0;--l)a[l]==null||"n?".indexOf(a[l].t)===-1||(z>=a[l].v.length-1?(z-=a[l].v.length,a[l].v=k.substr(z+1,a[l].v.length)):z<0?a[l].v="":(a[l].v=k.substr(0,z+1),z=-1),a[l].t="t",A=l);z>=0&&A<a.length&&(a[A].v=k.substr(0,z+1)+a[A].v)}else if(I!==a.length&&k.indexOf("E")===-1){for(z=k.indexOf(".")-1,l=I;l>=0;--l)if(!(a[l]==null||"n?".indexOf(a[l].t)===-1)){for(m=a[l].v.indexOf(".")>-1&&l===I?a[l].v.indexOf(".")-1:a[l].v.length-1,q=a[l].v.substr(m+1);m>=0;--m)z>=0&&(a[l].v.charAt(m)==="0"||a[l].v.charAt(m)==="#")&&(q=k.charAt(z--)+q);a[l].v=q,a[l].t="t",A=l}for(z>=0&&A<a.length&&(a[A].v=k.substr(0,z+1)+a[A].v),z=k.indexOf(".")+1,l=I;l<a.length;++l)if(!(a[l]==null||"n?(".indexOf(a[l].t)===-1&&l!==I)){for(m=a[l].v.indexOf(".")>-1&&l===I?a[l].v.indexOf(".")+1:0,q=a[l].v.substr(0,m);m<a[l].v.length;++m)z<k.length&&(q+=k.charAt(z++));a[l].v=q,a[l].t="t",A=l}}}for(l=0;l<a.length;++l)a[l]!=null&&"n?".indexOf(a[l].t)>-1&&(W=n>1&&e<0&&l>0&&a[l-1].v==="-"?-e:e,a[l].v=ds(a[l].t,a[l].v,W),a[l].t="t");var O="";for(l=0;l!==a.length;++l)a[l]!=null&&(O+=a[l].v);return O}var uT=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function fT(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function J5(t,e){var r=Q5(t),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var o=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,o];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var l=r[0].match(uT),u=r[1].match(uT);return fT(e,l)?[n,r[0]]:fT(e,u)?[n,r[1]]:[n,r[l!=null&&u!=null?2:1]]}return[n,o]}function Ea(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:at)[t],n==null&&(n=r.table&&r.table[oT[t]]||at[oT[t]]),n==null&&(n=P5[t]||"General");break}if(Qd(n,0))return bl(e,r);e instanceof Date&&(e=sk(e,r.date1904));var a=J5(n,e);if(Qd(a[1]))return bl(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return Z5(a[1],e,r,a[0])}function Mi(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(at[r]==null){e<0&&(e=r);continue}if(at[r]==t){e=r;break}}e<0&&(e=391)}return at[e]=t,e}function A0(t){for(var e=0;e!=392;++e)t[e]!==void 0&&Mi(t[e],e)}function cu(){at=F5()}var pk={format:Ea,load:Mi,_table:at,load_table:A0,parse_date_code:io,is_date:Fl,get_table:function(){return pk._table=at}},eP={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},gk=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function tP(t){var e=typeof t=="number"?at[t]:t;return e=e.replace(gk,"(\\d+)"),new RegExp("^"+e+"$")}function rP(t,e,r){var n=-1,a=-1,o=-1,l=-1,u=-1,f=-1;(e.match(gk)||[]).forEach(function(v,_){var E=parseInt(r[_+1],10);switch(v.toLowerCase().charAt(0)){case"y":n=E;break;case"d":o=E;break;case"h":l=E;break;case"s":f=E;break;case"m":l>=0?u=E:a=E;break}}),f>=0&&u==-1&&a>=0&&(u=a,a=-1);var d=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var m=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return l==-1&&u==-1&&f==-1?d:n==-1&&a==-1&&o==-1?m:d+"T"+m}var nP=function(){var t={};t.version="1.2.0";function e(){for(var k=0,I=new Array(256),A=0;A!=256;++A)k=A,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,I[A]=k;return typeof Int32Array<"u"?new Int32Array(I):I}var r=e();function n(k){var I=0,A=0,O=0,M=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(O=0;O!=256;++O)M[O]=k[O];for(O=0;O!=256;++O)for(A=k[O],I=256+O;I<4096;I+=256)A=M[I]=A>>>8^k[A&255];var N=[];for(O=1;O!=16;++O)N[O-1]=typeof Int32Array<"u"?M.subarray(O*256,O*256+256):M.slice(O*256,O*256+256);return N}var a=n(r),o=a[0],l=a[1],u=a[2],f=a[3],d=a[4],m=a[5],v=a[6],_=a[7],E=a[8],S=a[9],w=a[10],b=a[11],L=a[12],B=a[13],F=a[14];function z(k,I){for(var A=I^-1,O=0,M=k.length;O<M;)A=A>>>8^r[(A^k.charCodeAt(O++))&255];return~A}function q(k,I){for(var A=I^-1,O=k.length-15,M=0;M<O;)A=F[k[M++]^A&255]^B[k[M++]^A>>8&255]^L[k[M++]^A>>16&255]^b[k[M++]^A>>>24]^w[k[M++]]^S[k[M++]]^E[k[M++]]^_[k[M++]]^v[k[M++]]^m[k[M++]]^d[k[M++]]^f[k[M++]]^u[k[M++]]^l[k[M++]]^o[k[M++]]^r[k[M++]];for(O+=15;M<O;)A=A>>>8^r[(A^k[M++])&255];return~A}function W(k,I){for(var A=I^-1,O=0,M=k.length,N=0,D=0;O<M;)N=k.charCodeAt(O++),N<128?A=A>>>8^r[(A^N)&255]:N<2048?(A=A>>>8^r[(A^(192|N>>6&31))&255],A=A>>>8^r[(A^(128|N&63))&255]):N>=55296&&N<57344?(N=(N&1023)+64,D=k.charCodeAt(O++)&1023,A=A>>>8^r[(A^(240|N>>8&7))&255],A=A>>>8^r[(A^(128|N>>2&63))&255],A=A>>>8^r[(A^(128|D>>6&15|(N&3)<<4))&255],A=A>>>8^r[(A^(128|D&63))&255]):(A=A>>>8^r[(A^(224|N>>12&15))&255],A=A>>>8^r[(A^(128|N>>6&63))&255],A=A>>>8^r[(A^(128|N&63))&255]);return~A}return t.table=r,t.bstr=z,t.buf=q,t.str=W,t}(),et=function(){var e={};e.version="1.2.1";function r(P,Z){for(var H=P.split("/"),G=Z.split("/"),Q=0,J=0,me=Math.min(H.length,G.length);Q<me;++Q){if(J=H[Q].length-G[Q].length)return J;if(H[Q]!=G[Q])return H[Q]<G[Q]?-1:1}return H.length-G.length}function n(P){if(P.charAt(P.length-1)=="/")return P.slice(0,-1).indexOf("/")===-1?P:n(P.slice(0,-1));var Z=P.lastIndexOf("/");return Z===-1?P:P.slice(0,Z+1)}function a(P){if(P.charAt(P.length-1)=="/")return a(P.slice(0,-1));var Z=P.lastIndexOf("/");return Z===-1?P:P.slice(Z+1)}function o(P,Z){typeof Z=="string"&&(Z=new Date(Z));var H=Z.getHours();H=H<<6|Z.getMinutes(),H=H<<5|Z.getSeconds()>>>1,P.write_shift(2,H);var G=Z.getFullYear()-1980;G=G<<4|Z.getMonth()+1,G=G<<5|Z.getDate(),P.write_shift(2,G)}function l(P){var Z=P.read_shift(2)&65535,H=P.read_shift(2)&65535,G=new Date,Q=H&31;H>>>=5;var J=H&15;H>>>=4,G.setMilliseconds(0),G.setFullYear(H+1980),G.setMonth(J-1),G.setDate(Q);var me=Z&31;Z>>>=5;var Te=Z&63;return Z>>>=6,G.setHours(Z),G.setMinutes(Te),G.setSeconds(me<<1),G}function u(P){_n(P,0);for(var Z={},H=0;P.l<=P.length-4;){var G=P.read_shift(2),Q=P.read_shift(2),J=P.l+Q,me={};switch(G){case 21589:H=P.read_shift(1),H&1&&(me.mtime=P.read_shift(4)),Q>5&&(H&2&&(me.atime=P.read_shift(4)),H&4&&(me.ctime=P.read_shift(4))),me.mtime&&(me.mt=new Date(me.mtime*1e3));break}P.l=J,Z[G]=me}return Z}var f;function d(){return f||(f={})}function m(P,Z){if(P[0]==80&&P[1]==75)return Ss(P,Z);if((P[0]|32)==109&&(P[1]|32)==105)return jl(P,Z);if(P.length<512)throw new Error("CFB file size "+P.length+" < 512");var H=3,G=512,Q=0,J=0,me=0,Te=0,le=0,xe=[],ve=P.slice(0,512);_n(ve,0);var Le=v(ve);switch(H=Le[0],H){case 3:G=512;break;case 4:G=4096;break;case 0:if(Le[1]==0)return Ss(P,Z);default:throw new Error("Major Version: Expected 3 or 4 saw "+H)}G!==512&&(ve=P.slice(0,G),_n(ve,28));var He=P.slice(0,G);_(ve,H);var Ke=ve.read_shift(4,"i");if(H===3&&Ke!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ke);ve.l+=4,me=ve.read_shift(4,"i"),ve.l+=4,ve.chk("00100000","Mini Stream Cutoff Size: "),Te=ve.read_shift(4,"i"),Q=ve.read_shift(4,"i"),le=ve.read_shift(4,"i"),J=ve.read_shift(4,"i");for(var je=-1,We=0;We<109&&(je=ve.read_shift(4,"i"),!(je<0));++We)xe[We]=je;var ft=E(P,G);b(le,J,ft,G,xe);var jt=B(ft,me,xe,G);jt[me].name="!Directory",Q>0&&Te!==D&&(jt[Te].name="!MiniFAT"),jt[xe[0]].name="!FAT",jt.fat_addrs=xe,jt.ssz=G;var Dt={},Ot=[],ia=[],ci=[];F(me,jt,ft,Ot,Q,Dt,ia,Te),S(ia,ci,Ot),Ot.shift();var Bn={FileIndex:ia,FullPaths:ci};return Z&&Z.raw&&(Bn.raw={header:He,sectors:ft}),Bn}function v(P){if(P[P.l]==80&&P[P.l+1]==75)return[0,0];P.chk(he,"Header Signature: "),P.l+=16;var Z=P.read_shift(2,"u");return[P.read_shift(2,"u"),Z]}function _(P,Z){var H=9;switch(P.l+=2,H=P.read_shift(2)){case 9:if(Z!=3)throw new Error("Sector Shift: Expected 9 saw "+H);break;case 12:if(Z!=4)throw new Error("Sector Shift: Expected 12 saw "+H);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+H)}P.chk("0600","Mini Sector Shift: "),P.chk("000000000000","Reserved: ")}function E(P,Z){for(var H=Math.ceil(P.length/Z)-1,G=[],Q=1;Q<H;++Q)G[Q-1]=P.slice(Q*Z,(Q+1)*Z);return G[H-1]=P.slice(H*Z),G}function S(P,Z,H){for(var G=0,Q=0,J=0,me=0,Te=0,le=H.length,xe=[],ve=[];G<le;++G)xe[G]=ve[G]=G,Z[G]=H[G];for(;Te<ve.length;++Te)G=ve[Te],Q=P[G].L,J=P[G].R,me=P[G].C,xe[G]===G&&(Q!==-1&&xe[Q]!==Q&&(xe[G]=xe[Q]),J!==-1&&xe[J]!==J&&(xe[G]=xe[J])),me!==-1&&(xe[me]=G),Q!==-1&&G!=xe[G]&&(xe[Q]=xe[G],ve.lastIndexOf(Q)<Te&&ve.push(Q)),J!==-1&&G!=xe[G]&&(xe[J]=xe[G],ve.lastIndexOf(J)<Te&&ve.push(J));for(G=1;G<le;++G)xe[G]===G&&(J!==-1&&xe[J]!==J?xe[G]=xe[J]:Q!==-1&&xe[Q]!==Q&&(xe[G]=xe[Q]));for(G=1;G<le;++G)if(P[G].type!==0){if(Te=G,Te!=xe[Te])do Te=xe[Te],Z[G]=Z[Te]+"/"+Z[G];while(Te!==0&&xe[Te]!==-1&&Te!=xe[Te]);xe[G]=-1}for(Z[0]+="/",G=1;G<le;++G)P[G].type!==2&&(Z[G]+="/")}function w(P,Z,H){for(var G=P.start,Q=P.size,J=[],me=G;H&&Q>0&&me>=0;)J.push(Z.slice(me*N,me*N+N)),Q-=N,me=cl(H,me*4);return J.length===0?Se(0):un(J).slice(0,P.size)}function b(P,Z,H,G,Q){var J=D;if(P===D){if(Z!==0)throw new Error("DIFAT chain shorter than expected")}else if(P!==-1){var me=H[P],Te=(G>>>2)-1;if(!me)return;for(var le=0;le<Te&&(J=cl(me,le*4))!==D;++le)Q.push(J);b(cl(me,G-4),Z-1,H,G,Q)}}function L(P,Z,H,G,Q){var J=[],me=[];Q||(Q=[]);var Te=G-1,le=0,xe=0;for(le=Z;le>=0;){Q[le]=!0,J[J.length]=le,me.push(P[le]);var ve=H[Math.floor(le*4/G)];if(xe=le*4&Te,G<4+xe)throw new Error("FAT boundary crossed: "+le+" 4 "+G);if(!P[ve])break;le=cl(P[ve],xe)}return{nodes:J,data:TT([me])}}function B(P,Z,H,G){var Q=P.length,J=[],me=[],Te=[],le=[],xe=G-1,ve=0,Le=0,He=0,Ke=0;for(ve=0;ve<Q;++ve)if(Te=[],He=ve+Z,He>=Q&&(He-=Q),!me[He]){le=[];var je=[];for(Le=He;Le>=0;){je[Le]=!0,me[Le]=!0,Te[Te.length]=Le,le.push(P[Le]);var We=H[Math.floor(Le*4/G)];if(Ke=Le*4&xe,G<4+Ke)throw new Error("FAT boundary crossed: "+Le+" 4 "+G);if(!P[We]||(Le=cl(P[We],Ke),je[Le]))break}J[He]={nodes:Te,data:TT([le])}}return J}function F(P,Z,H,G,Q,J,me,Te){for(var le=0,xe=G.length?2:0,ve=Z[P].data,Le=0,He=0,Ke;Le<ve.length;Le+=128){var je=ve.slice(Le,Le+128);_n(je,64),He=je.read_shift(2),Ke=Av(je,0,He-xe),G.push(Ke);var We={name:Ke,type:je.read_shift(1),color:je.read_shift(1),L:je.read_shift(4,"i"),R:je.read_shift(4,"i"),C:je.read_shift(4,"i"),clsid:je.read_shift(16),state:je.read_shift(4,"i"),start:0,size:0},ft=je.read_shift(2)+je.read_shift(2)+je.read_shift(2)+je.read_shift(2);ft!==0&&(We.ct=z(je,je.l-8));var jt=je.read_shift(2)+je.read_shift(2)+je.read_shift(2)+je.read_shift(2);jt!==0&&(We.mt=z(je,je.l-8)),We.start=je.read_shift(4,"i"),We.size=je.read_shift(4,"i"),We.size<0&&We.start<0&&(We.size=We.type=0,We.start=D,We.name=""),We.type===5?(le=We.start,Q>0&&le!==D&&(Z[le].name="!StreamData")):We.size>=4096?(We.storage="fat",Z[We.start]===void 0&&(Z[We.start]=L(H,We.start,Z.fat_addrs,Z.ssz)),Z[We.start].name=We.name,We.content=Z[We.start].data.slice(0,We.size)):(We.storage="minifat",We.size<0?We.size=0:le!==D&&We.start!==D&&Z[le]&&(We.content=w(We,Z[le].data,(Z[Te]||{}).data))),We.content&&_n(We.content,0),J[Ke]=We,me.push(We)}}function z(P,Z){return new Date((pa(P,Z+4)/1e7*Math.pow(2,32)+pa(P,Z)/1e7-11644473600)*1e3)}function q(P,Z){return d(),m(f.readFileSync(P),Z)}function W(P,Z){var H=Z&&Z.type;switch(H||bt&&Buffer.isBuffer(P)&&(H="buffer"),H||"base64"){case"file":return q(P,Z);case"base64":return m(xa(wa(P)),Z);case"binary":return m(xa(P),Z)}return m(P,Z)}function k(P,Z){var H=Z||{},G=H.root||"Root Entry";if(P.FullPaths||(P.FullPaths=[]),P.FileIndex||(P.FileIndex=[]),P.FullPaths.length!==P.FileIndex.length)throw new Error("inconsistent CFB structure");P.FullPaths.length===0&&(P.FullPaths[0]=G+"/",P.FileIndex[0]={name:G,type:5}),H.CLSID&&(P.FileIndex[0].clsid=H.CLSID),I(P)}function I(P){var Z="Sh33tJ5";if(!et.find(P,"/"+Z)){var H=Se(4);H[0]=55,H[1]=H[3]=50,H[2]=54,P.FileIndex.push({name:Z,type:2,content:H,size:4,L:69,R:69,C:69}),P.FullPaths.push(P.FullPaths[0]+Z),A(P)}}function A(P,Z){k(P);for(var H=!1,G=!1,Q=P.FullPaths.length-1;Q>=0;--Q){var J=P.FileIndex[Q];switch(J.type){case 0:G?H=!0:(P.FileIndex.pop(),P.FullPaths.pop());break;case 1:case 2:case 5:G=!0,isNaN(J.R*J.L*J.C)&&(H=!0),J.R>-1&&J.L>-1&&J.R==J.L&&(H=!0);break;default:H=!0;break}}if(!(!H&&!Z)){var me=new Date(1987,1,19),Te=0,le=Object.create?Object.create(null):{},xe=[];for(Q=0;Q<P.FullPaths.length;++Q)le[P.FullPaths[Q]]=!0,P.FileIndex[Q].type!==0&&xe.push([P.FullPaths[Q],P.FileIndex[Q]]);for(Q=0;Q<xe.length;++Q){var ve=n(xe[Q][0]);G=le[ve],G||(xe.push([ve,{name:a(ve).replace("/",""),type:1,clsid:ne,ct:me,mt:me,content:null}]),le[ve]=!0)}for(xe.sort(function(Ke,je){return r(Ke[0],je[0])}),P.FullPaths=[],P.FileIndex=[],Q=0;Q<xe.length;++Q)P.FullPaths[Q]=xe[Q][0],P.FileIndex[Q]=xe[Q][1];for(Q=0;Q<xe.length;++Q){var Le=P.FileIndex[Q],He=P.FullPaths[Q];if(Le.name=a(He).replace("/",""),Le.L=Le.R=Le.C=-(Le.color=1),Le.size=Le.content?Le.content.length:0,Le.start=0,Le.clsid=Le.clsid||ne,Q===0)Le.C=xe.length>1?1:-1,Le.size=0,Le.type=5;else if(He.slice(-1)=="/"){for(Te=Q+1;Te<xe.length&&n(P.FullPaths[Te])!=He;++Te);for(Le.C=Te>=xe.length?-1:Te,Te=Q+1;Te<xe.length&&n(P.FullPaths[Te])!=n(He);++Te);Le.R=Te>=xe.length?-1:Te,Le.type=1}else n(P.FullPaths[Q+1]||"")==n(He)&&(Le.R=Q+1),Le.type=2}}}function O(P,Z){var H=Z||{};if(H.fileType=="mad")return or(P,H);switch(A(P),H.fileType){case"zip":return Wa(P,H)}var G=function(Ke){for(var je=0,We=0,ft=0;ft<Ke.FileIndex.length;++ft){var jt=Ke.FileIndex[ft];if(jt.content){var Dt=jt.content.length;Dt>0&&(Dt<4096?je+=Dt+63>>6:We+=Dt+511>>9)}}for(var Ot=Ke.FullPaths.length+3>>2,ia=je+7>>3,ci=je+127>>7,Bn=ia+We+Ot+ci,$n=Bn+127>>7,ui=$n<=109?0:Math.ceil(($n-109)/127);Bn+$n+ui+127>>7>$n;)ui=++$n<=109?0:Math.ceil(($n-109)/127);var Vn=[1,ui,$n,ci,Ot,We,je,0];return Ke.FileIndex[0].size=je<<6,Vn[7]=(Ke.FileIndex[0].start=Vn[0]+Vn[1]+Vn[2]+Vn[3]+Vn[4]+Vn[5])+(Vn[6]+7>>3),Vn}(P),Q=Se(G[7]<<9),J=0,me=0;{for(J=0;J<8;++J)Q.write_shift(1,we[J]);for(J=0;J<8;++J)Q.write_shift(2,0);for(Q.write_shift(2,62),Q.write_shift(2,3),Q.write_shift(2,65534),Q.write_shift(2,9),Q.write_shift(2,6),J=0;J<3;++J)Q.write_shift(2,0);for(Q.write_shift(4,0),Q.write_shift(4,G[2]),Q.write_shift(4,G[0]+G[1]+G[2]+G[3]-1),Q.write_shift(4,0),Q.write_shift(4,4096),Q.write_shift(4,G[3]?G[0]+G[1]+G[2]-1:D),Q.write_shift(4,G[3]),Q.write_shift(-4,G[1]?G[0]-1:D),Q.write_shift(4,G[1]),J=0;J<109;++J)Q.write_shift(-4,J<G[2]?G[1]+J:-1)}if(G[1])for(me=0;me<G[1];++me){for(;J<236+me*127;++J)Q.write_shift(-4,J<G[2]?G[1]+J:-1);Q.write_shift(-4,me===G[1]-1?D:me+1)}var Te=function(Ke){for(me+=Ke;J<me-1;++J)Q.write_shift(-4,J+1);Ke&&(++J,Q.write_shift(-4,D))};for(me=J=0,me+=G[1];J<me;++J)Q.write_shift(-4,ue.DIFSECT);for(me+=G[2];J<me;++J)Q.write_shift(-4,ue.FATSECT);Te(G[3]),Te(G[4]);for(var le=0,xe=0,ve=P.FileIndex[0];le<P.FileIndex.length;++le)ve=P.FileIndex[le],ve.content&&(xe=ve.content.length,!(xe<4096)&&(ve.start=me,Te(xe+511>>9)));for(Te(G[6]+7>>3);Q.l&511;)Q.write_shift(-4,ue.ENDOFCHAIN);for(me=J=0,le=0;le<P.FileIndex.length;++le)ve=P.FileIndex[le],ve.content&&(xe=ve.content.length,!(!xe||xe>=4096)&&(ve.start=me,Te(xe+63>>6)));for(;Q.l&511;)Q.write_shift(-4,ue.ENDOFCHAIN);for(J=0;J<G[4]<<2;++J){var Le=P.FullPaths[J];if(!Le||Le.length===0){for(le=0;le<17;++le)Q.write_shift(4,0);for(le=0;le<3;++le)Q.write_shift(4,-1);for(le=0;le<12;++le)Q.write_shift(4,0);continue}ve=P.FileIndex[J],J===0&&(ve.start=ve.size?ve.start-1:D);var He=J===0&&H.root||ve.name;if(xe=2*(He.length+1),Q.write_shift(64,He,"utf16le"),Q.write_shift(2,xe),Q.write_shift(1,ve.type),Q.write_shift(1,ve.color),Q.write_shift(-4,ve.L),Q.write_shift(-4,ve.R),Q.write_shift(-4,ve.C),ve.clsid)Q.write_shift(16,ve.clsid,"hex");else for(le=0;le<4;++le)Q.write_shift(4,0);Q.write_shift(4,ve.state||0),Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(4,ve.start),Q.write_shift(4,ve.size),Q.write_shift(4,0)}for(J=1;J<P.FileIndex.length;++J)if(ve=P.FileIndex[J],ve.size>=4096)if(Q.l=ve.start+1<<9,bt&&Buffer.isBuffer(ve.content))ve.content.copy(Q,Q.l,0,ve.size),Q.l+=ve.size+511&-512;else{for(le=0;le<ve.size;++le)Q.write_shift(1,ve.content[le]);for(;le&511;++le)Q.write_shift(1,0)}for(J=1;J<P.FileIndex.length;++J)if(ve=P.FileIndex[J],ve.size>0&&ve.size<4096)if(bt&&Buffer.isBuffer(ve.content))ve.content.copy(Q,Q.l,0,ve.size),Q.l+=ve.size+63&-64;else{for(le=0;le<ve.size;++le)Q.write_shift(1,ve.content[le]);for(;le&63;++le)Q.write_shift(1,0)}if(bt)Q.l=Q.length;else for(;Q.l<Q.length;)Q.write_shift(1,0);return Q}function M(P,Z){var H=P.FullPaths.map(function(le){return le.toUpperCase()}),G=H.map(function(le){var xe=le.split("/");return xe[xe.length-(le.slice(-1)=="/"?2:1)]}),Q=!1;Z.charCodeAt(0)===47?(Q=!0,Z=H[0].slice(0,-1)+Z):Q=Z.indexOf("/")!==-1;var J=Z.toUpperCase(),me=Q===!0?H.indexOf(J):G.indexOf(J);if(me!==-1)return P.FileIndex[me];var Te=!J.match(Tf);for(J=J.replace(Kn,""),Te&&(J=J.replace(Tf,"!")),me=0;me<H.length;++me)if((Te?H[me].replace(Tf,"!"):H[me]).replace(Kn,"")==J||(Te?G[me].replace(Tf,"!"):G[me]).replace(Kn,"")==J)return P.FileIndex[me];return null}var N=64,D=-2,he="d0cf11e0a1b11ae1",we=[208,207,17,224,161,177,26,225],ne="00000000000000000000000000000000",ue={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:D,FREESECT:-1,HEADER_SIGNATURE:he,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ne,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Ve(P,Z,H){d();var G=O(P,H);f.writeFileSync(Z,G)}function ie(P){for(var Z=new Array(P.length),H=0;H<P.length;++H)Z[H]=String.fromCharCode(P[H]);return Z.join("")}function ee(P,Z){var H=O(P,Z);switch(Z&&Z.type||"buffer"){case"file":return d(),f.writeFileSync(Z.filename,H),H;case"binary":return typeof H=="string"?H:ie(H);case"base64":return Qf(typeof H=="string"?H:ie(H));case"buffer":if(bt)return Buffer.isBuffer(H)?H:ys(H);case"array":return typeof H=="string"?xa(H):H}return H}var ge;function V(P){try{var Z=P.InflateRaw,H=new Z;if(H._processChunk(new Uint8Array([3,0]),H._finishFlushFlag),H.bytesRead)ge=P;else throw new Error("zlib does not expose bytesRead")}catch(G){console.error("cannot use native zlib: "+(G.message||G))}}function K(P,Z){if(!ge)return Ts(P,Z);var H=ge.InflateRaw,G=new H,Q=G._processChunk(P.slice(P.l),G._finishFlushFlag);return P.l+=G.bytesRead,Q}function Y(P){return ge?ge.deflateRawSync(P):Re(P)}var te=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ce=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],De=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ke(P){var Z=(P<<1|P<<11)&139536|(P<<5|P<<15)&558144;return(Z>>16|Z>>8|Z)&255}for(var Fe=typeof Uint8Array<"u",ye=Fe?new Uint8Array(256):[],Be=0;Be<256;++Be)ye[Be]=ke(Be);function X(P,Z){var H=ye[P&255];return Z<=8?H>>>8-Z:(H=H<<8|ye[P>>8&255],Z<=16?H>>>16-Z:(H=H<<8|ye[P>>16&255],H>>>24-Z))}function rt(P,Z){var H=Z&7,G=Z>>>3;return(P[G]|(H<=6?0:P[G+1]<<8))>>>H&3}function nt(P,Z){var H=Z&7,G=Z>>>3;return(P[G]|(H<=5?0:P[G+1]<<8))>>>H&7}function wt(P,Z){var H=Z&7,G=Z>>>3;return(P[G]|(H<=4?0:P[G+1]<<8))>>>H&15}function ut(P,Z){var H=Z&7,G=Z>>>3;return(P[G]|(H<=3?0:P[G+1]<<8))>>>H&31}function Ue(P,Z){var H=Z&7,G=Z>>>3;return(P[G]|(H<=1?0:P[G+1]<<8))>>>H&127}function Jt(P,Z,H){var G=Z&7,Q=Z>>>3,J=(1<<H)-1,me=P[Q]>>>G;return H<8-G||(me|=P[Q+1]<<8-G,H<16-G)||(me|=P[Q+2]<<16-G,H<24-G)||(me|=P[Q+3]<<24-G),me&J}function Cr(P,Z,H){var G=Z&7,Q=Z>>>3;return G<=5?P[Q]|=(H&7)<<G:(P[Q]|=H<<G&255,P[Q+1]=(H&7)>>8-G),Z+3}function Mr(P,Z,H){var G=Z&7,Q=Z>>>3;return H=(H&1)<<G,P[Q]|=H,Z+1}function Xr(P,Z,H){var G=Z&7,Q=Z>>>3;return H<<=G,P[Q]|=H&255,H>>>=8,P[Q+1]=H,Z+8}function Ga(P,Z,H){var G=Z&7,Q=Z>>>3;return H<<=G,P[Q]|=H&255,H>>>=8,P[Q+1]=H&255,P[Q+2]=H>>>8,Z+16}function hn(P,Z){var H=P.length,G=2*H>Z?2*H:Z+5,Q=0;if(H>=Z)return P;if(bt){var J=aT(G);if(P.copy)P.copy(J);else for(;Q<P.length;++Q)J[Q]=P[Q];return J}else if(Fe){var me=new Uint8Array(G);if(me.set)me.set(P);else for(;Q<H;++Q)me[Q]=P[Q];return me}return P.length=G,P}function Rr(P){for(var Z=new Array(P),H=0;H<P;++H)Z[H]=0;return Z}function Tn(P,Z,H){var G=1,Q=0,J=0,me=0,Te=0,le=P.length,xe=Fe?new Uint16Array(32):Rr(32);for(J=0;J<32;++J)xe[J]=0;for(J=le;J<H;++J)P[J]=0;le=P.length;var ve=Fe?new Uint16Array(le):Rr(le);for(J=0;J<le;++J)xe[Q=P[J]]++,G<Q&&(G=Q),ve[J]=0;for(xe[0]=0,J=1;J<=G;++J)xe[J+16]=Te=Te+xe[J-1]<<1;for(J=0;J<le;++J)Te=P[J],Te!=0&&(ve[J]=xe[Te+16]++);var Le=0;for(J=0;J<le;++J)if(Le=P[J],Le!=0)for(Te=X(ve[J],G)>>G-Le,me=(1<<G+4-Le)-1;me>=0;--me)Z[Te|me<<Le]=Le&15|J<<4;return G}var Ut=Fe?new Uint16Array(512):Rr(512),kt=Fe?new Uint16Array(32):Rr(32);if(!Fe){for(var se=0;se<512;++se)Ut[se]=0;for(se=0;se<32;++se)kt[se]=0}(function(){for(var P=[],Z=0;Z<32;Z++)P.push(5);Tn(P,kt,32);var H=[];for(Z=0;Z<=143;Z++)H.push(8);for(;Z<=255;Z++)H.push(9);for(;Z<=279;Z++)H.push(7);for(;Z<=287;Z++)H.push(8);Tn(H,Ut,288)})();var Me=function(){for(var Z=Fe?new Uint8Array(32768):[],H=0,G=0;H<De.length-1;++H)for(;G<De[H+1];++G)Z[G]=H;for(;G<32768;++G)Z[G]=29;var Q=Fe?new Uint8Array(259):[];for(H=0,G=0;H<ce.length-1;++H)for(;G<ce[H+1];++G)Q[G]=H;function J(Te,le){for(var xe=0;xe<Te.length;){var ve=Math.min(65535,Te.length-xe),Le=xe+ve==Te.length;for(le.write_shift(1,+Le),le.write_shift(2,ve),le.write_shift(2,~ve&65535);ve-- >0;)le[le.l++]=Te[xe++]}return le.l}function me(Te,le){for(var xe=0,ve=0,Le=Fe?new Uint16Array(32768):[];ve<Te.length;){var He=Math.min(65535,Te.length-ve);if(He<10){for(xe=Cr(le,xe,+(ve+He==Te.length)),xe&7&&(xe+=8-(xe&7)),le.l=xe/8|0,le.write_shift(2,He),le.write_shift(2,~He&65535);He-- >0;)le[le.l++]=Te[ve++];xe=le.l*8;continue}xe=Cr(le,xe,+(ve+He==Te.length)+2);for(var Ke=0;He-- >0;){var je=Te[ve];Ke=(Ke<<5^je)&32767;var We=-1,ft=0;if((We=Le[Ke])&&(We|=ve&-32768,We>ve&&(We-=32768),We<ve))for(;Te[We+ft]==Te[ve+ft]&&ft<250;)++ft;if(ft>2){je=Q[ft],je<=22?xe=Xr(le,xe,ye[je+1]>>1)-1:(Xr(le,xe,3),xe+=5,Xr(le,xe,ye[je-23]>>5),xe+=3);var jt=je<8?0:je-4>>2;jt>0&&(Ga(le,xe,ft-ce[je]),xe+=jt),je=Z[ve-We],xe=Xr(le,xe,ye[je]>>3),xe-=3;var Dt=je<4?0:je-2>>1;Dt>0&&(Ga(le,xe,ve-We-De[je]),xe+=Dt);for(var Ot=0;Ot<ft;++Ot)Le[Ke]=ve&32767,Ke=(Ke<<5^Te[ve])&32767,++ve;He-=ft-1}else je<=143?je=je+48:xe=Mr(le,xe,1),xe=Xr(le,xe,ye[je]),Le[Ke]=ve&32767,++ve}xe=Xr(le,xe,0)-1}return le.l=(xe+7)/8|0,le.l}return function(le,xe){return le.length<8?J(le,xe):me(le,xe)}}();function Re(P){var Z=Se(50+Math.floor(P.length*1.1)),H=Me(P,Z);return Z.slice(0,H)}var Je=Fe?new Uint16Array(32768):Rr(32768),pt=Fe?new Uint16Array(32768):Rr(32768),mt=Fe?new Uint16Array(128):Rr(128),sr=1,qt=1;function Un(P,Z){var H=ut(P,Z)+257;Z+=5;var G=ut(P,Z)+1;Z+=5;var Q=wt(P,Z)+4;Z+=4;for(var J=0,me=Fe?new Uint8Array(19):Rr(19),Te=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],le=1,xe=Fe?new Uint8Array(8):Rr(8),ve=Fe?new Uint8Array(8):Rr(8),Le=me.length,He=0;He<Q;++He)me[te[He]]=J=nt(P,Z),le<J&&(le=J),xe[J]++,Z+=3;var Ke=0;for(xe[0]=0,He=1;He<=le;++He)ve[He]=Ke=Ke+xe[He-1]<<1;for(He=0;He<Le;++He)(Ke=me[He])!=0&&(Te[He]=ve[Ke]++);var je=0;for(He=0;He<Le;++He)if(je=me[He],je!=0){Ke=ye[Te[He]]>>8-je;for(var We=(1<<7-je)-1;We>=0;--We)mt[Ke|We<<je]=je&7|He<<3}var ft=[];for(le=1;ft.length<H+G;)switch(Ke=mt[Ue(P,Z)],Z+=Ke&7,Ke>>>=3){case 16:for(J=3+rt(P,Z),Z+=2,Ke=ft[ft.length-1];J-- >0;)ft.push(Ke);break;case 17:for(J=3+nt(P,Z),Z+=3;J-- >0;)ft.push(0);break;case 18:for(J=11+Ue(P,Z),Z+=7;J-- >0;)ft.push(0);break;default:ft.push(Ke),le<Ke&&(le=Ke);break}var jt=ft.slice(0,H),Dt=ft.slice(H);for(He=H;He<286;++He)jt[He]=0;for(He=G;He<30;++He)Dt[He]=0;return sr=Tn(jt,Je,286),qt=Tn(Dt,pt,30),Z}function Hi(P,Z){if(P[0]==3&&!(P[1]&3))return[wo(Z),2];for(var H=0,G=0,Q=aT(Z||1<<18),J=0,me=Q.length>>>0,Te=0,le=0;(G&1)==0;){if(G=nt(P,H),H+=3,G>>>1)G>>1==1?(Te=9,le=5):(H=Un(P,H),Te=sr,le=qt);else{H&7&&(H+=8-(H&7));var xe=P[H>>>3]|P[(H>>>3)+1]<<8;if(H+=32,xe>0)for(!Z&&me<J+xe&&(Q=hn(Q,J+xe),me=Q.length);xe-- >0;)Q[J++]=P[H>>>3],H+=8;continue}for(;;){!Z&&me<J+32767&&(Q=hn(Q,J+32767),me=Q.length);var ve=Jt(P,H,Te),Le=G>>>1==1?Ut[ve]:Je[ve];if(H+=Le&15,Le>>>=4,(Le>>>8&255)===0)Q[J++]=Le;else{if(Le==256)break;Le-=257;var He=Le<8?0:Le-4>>2;He>5&&(He=0);var Ke=J+ce[Le];He>0&&(Ke+=Jt(P,H,He),H+=He),ve=Jt(P,H,le),Le=G>>>1==1?kt[ve]:pt[ve],H+=Le&15,Le>>>=4;var je=Le<4?0:Le-2>>1,We=De[Le];for(je>0&&(We+=Jt(P,H,je),H+=je),!Z&&me<Ke&&(Q=hn(Q,Ke+100),me=Q.length);J<Ke;)Q[J]=Q[J-We],++J}}}return Z?[Q,H+7>>>3]:[Q.slice(0,J),H+7>>>3]}function Ts(P,Z){var H=P.slice(P.l||0),G=Hi(H,Z);return P.l+=G[1],G[0]}function bs(P,Z){if(P)typeof console<"u"&&console.error(Z);else throw new Error(Z)}function Ss(P,Z){var H=P;_n(H,0);var G=[],Q=[],J={FileIndex:G,FullPaths:Q};k(J,{root:Z.root});for(var me=H.length-4;(H[me]!=80||H[me+1]!=75||H[me+2]!=5||H[me+3]!=6)&&me>=0;)--me;H.l=me+4,H.l+=4;var Te=H.read_shift(2);H.l+=6;var le=H.read_shift(4);for(H.l=le,me=0;me<Te;++me){H.l+=20;var xe=H.read_shift(4),ve=H.read_shift(4),Le=H.read_shift(2),He=H.read_shift(2),Ke=H.read_shift(2);H.l+=8;var je=H.read_shift(4),We=u(H.slice(H.l+Le,H.l+Le+He));H.l+=Le+He+Ke;var ft=H.l;H.l=je+4,qa(H,xe,ve,J,We),H.l=ft}return J}function qa(P,Z,H,G,Q){P.l+=2;var J=P.read_shift(2),me=P.read_shift(2),Te=l(P);if(J&8257)throw new Error("Unsupported ZIP encryption");for(var le=P.read_shift(4),xe=P.read_shift(4),ve=P.read_shift(4),Le=P.read_shift(2),He=P.read_shift(2),Ke="",je=0;je<Le;++je)Ke+=String.fromCharCode(P[P.l++]);if(He){var We=u(P.slice(P.l,P.l+He));(We[21589]||{}).mt&&(Te=We[21589].mt),((Q||{})[21589]||{}).mt&&(Te=Q[21589].mt)}P.l+=He;var ft=P.slice(P.l,P.l+xe);switch(me){case 8:ft=K(P,ve);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+me)}var jt=!1;J&8&&(le=P.read_shift(4),le==134695760&&(le=P.read_shift(4),jt=!0),xe=P.read_shift(4),ve=P.read_shift(4)),xe!=Z&&bs(jt,"Bad compressed size: "+Z+" != "+xe),ve!=H&&bs(jt,"Bad uncompressed size: "+H+" != "+ve),mr(G,Ke,ft,{unsafe:!0,mt:Te})}function Wa(P,Z){var H=Z||{},G=[],Q=[],J=Se(1),me=H.compression?8:0,Te=0,le=0,xe=0,ve=0,Le=0,He=P.FullPaths[0],Ke=He,je=P.FileIndex[0],We=[],ft=0;for(le=1;le<P.FullPaths.length;++le)if(Ke=P.FullPaths[le].slice(He.length),je=P.FileIndex[le],!(!je.size||!je.content||Ke=="Sh33tJ5")){var jt=ve,Dt=Se(Ke.length);for(xe=0;xe<Ke.length;++xe)Dt.write_shift(1,Ke.charCodeAt(xe)&127);Dt=Dt.slice(0,Dt.l),We[Le]=nP.buf(je.content,0);var Ot=je.content;me==8&&(Ot=Y(Ot)),J=Se(30),J.write_shift(4,67324752),J.write_shift(2,20),J.write_shift(2,Te),J.write_shift(2,me),je.mt?o(J,je.mt):J.write_shift(4,0),J.write_shift(-4,We[Le]),J.write_shift(4,Ot.length),J.write_shift(4,je.content.length),J.write_shift(2,Dt.length),J.write_shift(2,0),ve+=J.length,G.push(J),ve+=Dt.length,G.push(Dt),ve+=Ot.length,G.push(Ot),J=Se(46),J.write_shift(4,33639248),J.write_shift(2,0),J.write_shift(2,20),J.write_shift(2,Te),J.write_shift(2,me),J.write_shift(4,0),J.write_shift(-4,We[Le]),J.write_shift(4,Ot.length),J.write_shift(4,je.content.length),J.write_shift(2,Dt.length),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(4,0),J.write_shift(4,jt),ft+=J.l,Q.push(J),ft+=Dt.length,Q.push(Dt),++Le}return J=Se(22),J.write_shift(4,101010256),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(2,Le),J.write_shift(2,Le),J.write_shift(4,ft),J.write_shift(4,ve),J.write_shift(2,0),un([un(G),un(Q),J])}var si={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ta(P,Z){if(P.ctype)return P.ctype;var H=P.name||"",G=H.match(/\.([^\.]+)$/);return G&&si[G[1]]||Z&&(G=(H=Z).match(/[\.\\]([^\.\\])+$/),G&&si[G[1]])?si[G[1]]:"application/octet-stream"}function Oo(P){for(var Z=Qf(P),H=[],G=0;G<Z.length;G+=76)H.push(Z.slice(G,G+76));return H.join(`\r
`)+`\r
`}function oi(P){var Z=P.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(xe){var ve=xe.charCodeAt(0).toString(16).toUpperCase();return"="+(ve.length==1?"0"+ve:ve)});Z=Z.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Z.charAt(0)==`
`&&(Z="=0D"+Z.slice(1)),Z=Z.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var H=[],G=Z.split(`\r
`),Q=0;Q<G.length;++Q){var J=G[Q];if(J.length==0){H.push("");continue}for(var me=0;me<J.length;){var Te=76,le=J.slice(me,me+Te);le.charAt(Te-1)=="="?Te--:le.charAt(Te-2)=="="?Te-=2:le.charAt(Te-3)=="="&&(Te-=3),le=J.slice(me,me+Te),me+=Te,me<J.length&&(le+="="),H.push(le)}}return H.join(`\r
`)}function As(P){for(var Z=[],H=0;H<P.length;++H){for(var G=P[H];H<=P.length&&G.charAt(G.length-1)=="=";)G=G.slice(0,G.length-1)+P[++H];Z.push(G)}for(var Q=0;Q<Z.length;++Q)Z[Q]=Z[Q].replace(/[=][0-9A-Fa-f]{2}/g,function(J){return String.fromCharCode(parseInt(J.slice(1),16))});return xa(Z.join(`\r
`))}function li(P,Z,H){for(var G="",Q="",J="",me,Te=0;Te<10;++Te){var le=Z[Te];if(!le||le.match(/^\s*$/))break;var xe=le.match(/^(.*?):\s*([^\s].*)$/);if(xe)switch(xe[1].toLowerCase()){case"content-location":G=xe[2].trim();break;case"content-type":J=xe[2].trim();break;case"content-transfer-encoding":Q=xe[2].trim();break}}switch(++Te,Q.toLowerCase()){case"base64":me=xa(wa(Z.slice(Te).join("")));break;case"quoted-printable":me=As(Z.slice(Te));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Q)}var ve=mr(P,G.slice(H.length),me,{unsafe:!0});J&&(ve.ctype=J)}function jl(P,Z){if(ie(P.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var H=Z&&Z.root||"",G=(bt&&Buffer.isBuffer(P)?P.toString("binary"):ie(P)).split(`\r
`),Q=0,J="";for(Q=0;Q<G.length;++Q)if(J=G[Q],!!/^Content-Location:/i.test(J)&&(J=J.slice(J.indexOf("file")),H||(H=J.slice(0,J.lastIndexOf("/")+1)),J.slice(0,H.length)!=H))for(;H.length>0&&(H=H.slice(0,H.length-1),H=H.slice(0,H.lastIndexOf("/")+1),J.slice(0,H.length)!=H););var me=(G[1]||"").match(/boundary="(.*?)"/);if(!me)throw new Error("MAD cannot find boundary");var Te="--"+(me[1]||""),le=[],xe=[],ve={FileIndex:le,FullPaths:xe};k(ve);var Le,He=0;for(Q=0;Q<G.length;++Q){var Ke=G[Q];Ke!==Te&&Ke!==Te+"--"||(He++&&li(ve,G.slice(Le,Q),H),Le=Q)}return ve}function or(P,Z){var H=Z||{},G=H.boundary||"SheetJS";G="------="+G;for(var Q=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+G.slice(2)+'"',"","",""],J=P.FullPaths[0],me=J,Te=P.FileIndex[0],le=1;le<P.FullPaths.length;++le)if(me=P.FullPaths[le].slice(J.length),Te=P.FileIndex[le],!(!Te.size||!Te.content||me=="Sh33tJ5")){me=me.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ft){return"_x"+ft.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ft){return"_u"+ft.charCodeAt(0).toString(16)+"_"});for(var xe=Te.content,ve=bt&&Buffer.isBuffer(xe)?xe.toString("binary"):ie(xe),Le=0,He=Math.min(1024,ve.length),Ke=0,je=0;je<=He;++je)(Ke=ve.charCodeAt(je))>=32&&Ke<128&&++Le;var We=Le>=He*4/5;Q.push(G),Q.push("Content-Location: "+(H.root||"file:///C:/SheetJS/")+me),Q.push("Content-Transfer-Encoding: "+(We?"quoted-printable":"base64")),Q.push("Content-Type: "+Ta(Te,me)),Q.push(""),Q.push(We?oi(ve):Oo(ve))}return Q.push(G+`--\r
`),Q.join(`\r
`)}function Nr(P){var Z={};return k(Z,P),Z}function mr(P,Z,H,G){var Q=G&&G.unsafe;Q||k(P);var J=!Q&&et.find(P,Z);if(!J){var me=P.FullPaths[0];Z.slice(0,me.length)==me?me=Z:(me.slice(-1)!="/"&&(me+="/"),me=(me+Z).replace("//","/")),J={name:a(Z),type:2},P.FileIndex.push(J),P.FullPaths.push(me),Q||et.utils.cfb_gc(P)}return J.content=H,J.size=H?H.length:0,G&&(G.CLSID&&(J.clsid=G.CLSID),G.mt&&(J.mt=G.mt),G.ct&&(J.ct=G.ct)),J}function Yn(P,Z){k(P);var H=et.find(P,Z);if(H){for(var G=0;G<P.FileIndex.length;++G)if(P.FileIndex[G]==H)return P.FileIndex.splice(G,1),P.FullPaths.splice(G,1),!0}return!1}function Fo(P,Z,H){k(P);var G=et.find(P,Z);if(G){for(var Q=0;Q<P.FileIndex.length;++Q)if(P.FileIndex[Q]==G)return P.FileIndex[Q].name=a(H),P.FullPaths[Q]=H,!0}return!1}function hu(P){A(P,!0)}return e.find=M,e.read=W,e.parse=m,e.write=ee,e.writeFile=Ve,e.utils={cfb_new:Nr,cfb_add:mr,cfb_del:Yn,cfb_mov:Fo,cfb_gc:hu,ReadShift:Of,CheckField:Uk,prep_blob:_n,bconcat:un,use_zlib:V,_deflateRaw:Re,_inflateRaw:Ts,consts:ue},e}();function aP(t){return typeof t=="string"?Om(t):Array.isArray(t)?N5(t):t}function k0(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=Om(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?Ri(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var a=new Blob([aP(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,t);if(typeof saveAs<"u")return saveAs(a,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var o=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),chrome.downloads.download({url:o,filename:t,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=t,l.href=o,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),o}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(t);return u.open("w"),u.encoding="binary",Array.isArray(e)&&(e=No(e)),u.write(e),u.close(),e}catch(f){if(!f.message||!f.message.match(/onstruct/))throw f}throw new Error("cannot save file "+t)}function iP(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Ar(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function hT(t,e){for(var r=[],n=Ar(t),a=0;a!==n.length;++a)r[t[n[a]][e]]==null&&(r[t[n[a]][e]]=n[a]);return r}function Fm(t){for(var e=[],r=Ar(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function Pm(t){for(var e=[],r=Ar(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function sP(t){for(var e=[],r=Ar(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var Jd=new Date(1899,11,30,0,0,0);function tn(t,e){var r=t.getTime(),n=Jd.getTime()+(t.getTimezoneOffset()-Jd.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var xk=new Date,oP=Jd.getTime()+(xk.getTimezoneOffset()-Jd.getTimezoneOffset())*6e4,dT=xk.getTimezoneOffset();function Lm(t){var e=new Date;return e.setTime(t*24*60*60*1e3+oP),e.getTimezoneOffset()!==dT&&e.setTime(e.getTime()+(e.getTimezoneOffset()-dT)*6e4),e}function lP(t){var e=0,r=0,n=!1,a=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var o=1;o!=a.length;++o)if(a[o]){switch(r=1,o>3&&(n=!0),a[o].slice(a[o].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[o].slice(a[o].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(a[o],10)}return e}var mT=new Date("2017-02-19T19:06:09.000Z"),vk=isNaN(mT.getFullYear())?new Date("2/19/17"):mT,cP=vk.getFullYear()==2017;function hr(t,e){var r=new Date(t);if(cP)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(vk.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=t.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return t.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function Sl(t,e){if(bt&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return Ri(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return Ri(ak(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return Ri(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return Ri(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(o){return r[o]||o})}catch{}for(var n=[],a=0;a!=t.length;++a)n.push(String.fromCharCode(t[a]));return n.join("")}function dr(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=dr(t[r]));return e}function Tr(t,e){for(var r="";r.length<e;)r+=t;return r}function ri(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,o){return r=-r,o}),!isNaN(e=Number(n)))?e/r:e}var uP=["january","february","march","april","may","june","july","august","september","october","november","december"];function Jc(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),a=e.getMonth(),o=e.getDate();if(isNaN(o))return r;var l=t.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&uP.indexOf(l)==-1)return r}else if(l.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||o>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var fP=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(t||typeof n=="string")return r.split(n);for(var o=r.split(n),l=[o[0]],u=1;u<o.length;++u)l.push(a),l.push(o[u]);return l}}();function _k(t){return t?t.content&&t.type?Sl(t.content,!0):t.data?Ef(t.data):t.asNodeBuffer&&bt?Ef(t.asNodeBuffer().toString("binary")):t.asBinary?Ef(t.asBinary()):t._data&&t._data.getContent?Ef(Sl(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function yk(t){if(!t)return null;if(t.data)return rT(t.data);if(t.asNodeBuffer&&bt)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?rT(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function hP(t){return t&&t.name.slice(-4)===".bin"?yk(t):_k(t)}function Ba(t,e){for(var r=t.FullPaths||Ar(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),o=0;o<r.length;++o){var l=r[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==l||a==l)return t.files?t.files[r[o]]:t.FileIndex[o]}return null}function yv(t,e){var r=Ba(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function zr(t,e,r){if(!r)return hP(yv(t,e));if(!e)return null;try{return zr(t,e)}catch{return null}}function va(t,e,r){if(!r)return _k(yv(t,e));if(!e)return null;try{return va(t,e)}catch{return null}}function dP(t,e,r){return yk(yv(t,e))}function pT(t){for(var e=t.FullPaths||Ar(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function yt(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return bt?n=ys(r):n=I5(r),et.utils.cfb_add(t,e,n)}et.utils.cfb_add(t,e,r)}else t.file(e,r)}function wv(){return et.utils.cfb_new()}function wk(t,e){switch(e.type){case"base64":return et.read(t,{type:"base64"});case"binary":return et.read(t,{type:"binary"});case"buffer":case"array":return et.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function bf(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var Lr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,mP=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,gT=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,pP=/<[^>]*>/g,Mn=Lr.match(gT)?gT:pP,gP=/<\w*:/,xP=/<(\/?)\w+:/;function dt(t,e,r){for(var n={},a=0,o=0;a!==t.length&&!((o=t.charCodeAt(a))===32||o===10||o===13);++a);if(e||(n[0]=t.slice(0,a)),a===t.length)return n;var l=t.match(mP),u=0,f="",d=0,m="",v="",_=1;if(l)for(d=0;d!=l.length;++d){for(v=l[d],o=0;o!=v.length&&v.charCodeAt(o)!==61;++o);for(m=v.slice(0,o).trim();v.charCodeAt(o+1)==32;)++o;for(_=(a=v.charCodeAt(o+1))==34||a==39?1:0,f=v.slice(o+1+_,v.length-_),u=0;u!=m.length&&m.charCodeAt(u)!==58;++u);if(u===m.length)m.indexOf("_")>0&&(m=m.slice(0,m.indexOf("_"))),n[m]=f,n[m.toLowerCase()]=f;else{var E=(u===5&&m.slice(0,5)==="xmlns"?"xmlns":"")+m.slice(u+1);if(n[E]&&m.slice(u-3,u)=="ext")continue;n[E]=f,n[E.toLowerCase()]=f}}return n}function Vi(t){return t.replace(xP,"<$1")}var Ek={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Ev=Fm(Ek),Bt=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",o=a.indexOf("<![CDATA[");if(o==-1)return a.replace(t,function(u,f){return Ek[u]||String.fromCharCode(parseInt(f,u.indexOf("x")>-1?16:10))||u}).replace(e,function(u,f){return String.fromCharCode(parseInt(f,16))});var l=a.indexOf("]]>");return r(a.slice(0,o))+a.slice(o+9,l)+r(a.slice(l+3))}}(),Tv=/[&<>'"]/g,vP=/[\u0000-\u0008\u000b-\u001f]/g;function Zt(t){var e=t+"";return e.replace(Tv,function(r){return Ev[r]}).replace(vP,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function xT(t){return Zt(t).replace(/ /g,"_x0020_")}var Tk=/[\u0000-\u001f]/g;function bv(t){var e=t+"";return e.replace(Tv,function(r){return Ev[r]}).replace(/\n/g,"<br/>").replace(Tk,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function _P(t){var e=t+"";return e.replace(Tv,function(r){return Ev[r]}).replace(Tk,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var vT=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function yP(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function ur(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function n1(t){for(var e="",r=0,n=0,a=0,o=0,l=0,u=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(a=t.charCodeAt(r++),n>191&&n<224){l=(n&31)<<6,l|=a&63,e+=String.fromCharCode(l);continue}if(o=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(a&63)<<6|o&63);continue}l=t.charCodeAt(r++),u=((n&7)<<18|(a&63)<<12|(o&63)<<6|l&63)-65536,e+=String.fromCharCode(55296+(u>>>10&1023)),e+=String.fromCharCode(56320+(u&1023))}return e}function _T(t){var e=wo(2*t.length),r,n,a=1,o=0,l=0,u;for(n=0;n<t.length;n+=a)a=1,(u=t.charCodeAt(n))<128?r=u:u<224?(r=(u&31)*64+(t.charCodeAt(n+1)&63),a=2):u<240?(r=(u&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),a=3):(a=4,r=(u&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,l=55296+(r>>>10&1023),r=56320+(r&1023)),l!==0&&(e[o++]=l&255,e[o++]=l>>>8,l=0),e[o++]=r%256,e[o++]=r>>>8;return e.slice(0,o).toString("ucs2")}function yT(t){return ys(t,"binary").toString("utf8")}var sd="foo bar baz",ar=bt&&(yT(sd)==n1(sd)&&yT||_T(sd)==n1(sd)&&_T)||n1,Ri=bt?function(t){return ys(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,a=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(a>>18&7))),e.push(String.fromCharCode(144+(a>>12&63))),e.push(String.fromCharCode(128+(a>>6&63))),e.push(String.fromCharCode(128+(a&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},Jf=function(){var t={};return function(r,n){var a=r+"|"+(n||"");return t[a]?t[a]:t[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),bk=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<t.length;++a)n=n.replace(t[a][0],t[a][1]);return n}}(),wP=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),EP=/<\/?(?:vt:)?variant>/g,TP=/<(?:vt:)([^>]*)>([\s\S]*)</;function wT(t,e){var r=dt(t),n=t.match(wP(r.baseType))||[],a=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(o){var l=o.replace(EP,"").match(TP);l&&a.push({v:ar(l[2]),t:l[1]})}),a}var Sk=/(^\s|\s$|\n)/;function wn(t,e){return"<"+t+(e.match(Sk)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function e0(t){return Ar(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function ze(t,e,r){return"<"+t+(r!=null?e0(r):"")+(e!=null?(e.match(Sk)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function Q1(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function bP(t,e){switch(typeof t){case"string":var r=ze("vt:lpwstr",Zt(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return ze((t|0)==t?"vt:i4":"vt:r8",Zt(String(t)));case"boolean":return ze("vt:bool",t?"true":"false")}if(t instanceof Date)return ze("vt:filetime",Q1(t));throw new Error("Unable to serialize "+t)}function Sv(t){if(bt&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return ar(No(xv(t)));throw new Error("Bad input format: expected Buffer or string")}var t0=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Zr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Pl=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],ma={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function SP(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),a=t[e+6]&15,o=5;o>=0;--o)a=a*256+t[e+o];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function AP(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,a=0,o=0,l=n?-e:e;isFinite(l)?l==0?a=o=0:(a=Math.floor(Math.log(l)/Math.LN2),o=l*Math.pow(2,52-a),a<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?a=-1022:(o-=Math.pow(2,52),a+=1023)):(a=2047,o=isNaN(e)?26985:0);for(var u=0;u<=5;++u,o/=256)t[r+u]=o&255;t[r+6]=(a&15)<<4|o&15,t[r+7]=a>>4|n}var ET=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var a=0,o=t[0][n].length;a<o;a+=r)e.push.apply(e,t[0][n].slice(a,a+r));return e},TT=bt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:ys(e)})):ET(t)}:ET,bT=function(t,e,r){for(var n=[],a=e;a<r;a+=2)n.push(String.fromCharCode(fs(t,a)));return n.join("").replace(Kn,"")},Av=bt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Kn,""):bT(t,e,r)}:bT,ST=function(t,e,r){for(var n=[],a=e;a<e+r;++a)n.push(("0"+t[a].toString(16)).slice(-2));return n.join("")},Ak=bt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):ST(t,e,r)}:ST,AT=function(t,e,r){for(var n=[],a=e;a<r;a++)n.push(String.fromCharCode(Fc(t,a)));return n.join("")},C0=bt?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):AT(e,r,n)}:AT,kk=function(t,e){var r=pa(t,e);return r>0?C0(t,e+4,e+4+r-1):""},Ck=kk,Rk=function(t,e){var r=pa(t,e);return r>0?C0(t,e+4,e+4+r-1):""},Nk=Rk,Ik=function(t,e){var r=2*pa(t,e);return r>0?C0(t,e+4,e+4+r-1):""},Dk=Ik,Ok=function(e,r){var n=pa(e,r);return n>0?Av(e,r+4,r+4+n):""},Fk=Ok,Pk=function(t,e){var r=pa(t,e);return r>0?C0(t,e+4,e+4+r):""},Lk=Pk,Mk=function(t,e){return SP(t,e)},em=Mk,kv=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};bt&&(Ck=function(e,r){if(!Buffer.isBuffer(e))return kk(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},Nk=function(e,r){if(!Buffer.isBuffer(e))return Rk(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},Dk=function(e,r){if(!Buffer.isBuffer(e))return Ik(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},Fk=function(e,r){if(!Buffer.isBuffer(e))return Ok(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},Lk=function(e,r){if(!Buffer.isBuffer(e))return Pk(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},em=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):Mk(e,r)},kv=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Fc=function(t,e){return t[e]},fs=function(t,e){return t[e+1]*256+t[e]},kP=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},pa=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},cl=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},CP=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Of(t,e){var r="",n,a,o=[],l,u,f,d;switch(e){case"dbcs":if(d=this.l,bt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(f=0;f<t;++f)r+=String.fromCharCode(fs(this,d)),d+=2;t*=2;break;case"utf8":r=C0(this,this.l,this.l+t);break;case"utf16le":t*=2,r=Av(this,this.l,this.l+t);break;case"wstr":return Of.call(this,t,"dbcs");case"lpstr-ansi":r=Ck(this,this.l),t=4+pa(this,this.l);break;case"lpstr-cp":r=Nk(this,this.l),t=4+pa(this,this.l);break;case"lpwstr":r=Dk(this,this.l),t=4+2*pa(this,this.l);break;case"lpp4":t=4+pa(this,this.l),r=Fk(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+pa(this,this.l),r=Lk(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(l=Fc(this,this.l+t++))!==0;)o.push(id(l));r=o.join("");break;case"_wstr":for(t=0,r="";(l=fs(this,this.l+t))!==0;)o.push(id(l)),t+=2;t+=2,r=o.join("");break;case"dbcs-cont":for(r="",d=this.l,f=0;f<t;++f){if(this.lens&&this.lens.indexOf(d)!==-1)return l=Fc(this,d),this.l=d+1,u=Of.call(this,t-f,l?"dbcs-cont":"sbcs-cont"),o.join("")+u;o.push(id(fs(this,d))),d+=2}r=o.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,f=0;f!=t;++f){if(this.lens&&this.lens.indexOf(d)!==-1)return l=Fc(this,d),this.l=d+1,u=Of.call(this,t-f,l?"dbcs-cont":"sbcs-cont"),o.join("")+u;o.push(id(Fc(this,d))),d+=1}r=o.join("");break;default:switch(t){case 1:return n=Fc(this,this.l),this.l++,n;case 2:return n=(e==="i"?kP:fs)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(n=(t>0?cl:CP)(this,this.l),this.l+=4,n):(a=pa(this,this.l),this.l+=4,a);case 8:case-8:if(e==="f")return t==8?a=em(this,this.l):a=em([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;t=8;case 16:r=Ak(this,this.l,t);break}}return this.l+=t,r}var RP=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},NP=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},IP=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function DP(t,e,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=e.length;++a)IP(this,e.charCodeAt(a),this.l+2*a);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=e.length;++a)this[this.l+a]=e.charCodeAt(a)&255;n=e.length}else if(r==="hex"){for(;a<t;++a)this[this.l++]=parseInt(e.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var o=Math.min(this.l+t,this.length);for(a=0;a<Math.min(e.length,t);++a){var l=e.charCodeAt(a);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,RP(this,e,this.l);break;case 8:if(n=8,r==="f"){AP(this,e,this.l);break}case 16:break;case-4:n=4,NP(this,e,this.l);break}return this.l+=n,this}function Uk(t,e){var r=Ak(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function _n(t,e){t.l=e,t.read_shift=Of,t.chk=Uk,t.write_shift=DP}function Ln(t,e){t.l+=e}function Se(t){var e=wo(t);return _n(e,0),e}function ws(t,e,r){if(t){var n,a,o;_n(t,t.l||0);for(var l=t.length,u=0,f=0;t.l<l;){u=t.read_shift(1),u&128&&(u=(u&127)+((t.read_shift(1)&127)<<7));var d=o0[u]||o0[65535];for(n=t.read_shift(1),o=n&127,a=1;a<4&&n&128;++a)o+=((n=t.read_shift(1))&127)<<7*a;f=t.l+o;var m=d.f&&d.f(t,o,r);if(t.l=f,e(m,d,u))return}}}function na(){var t=[],e=bt?256:2048,r=function(d){var m=Se(d);return _n(m,0),m},n=r(e),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},o=function(d){return n&&d<n.length-n.l?n:(a(),n=r(Math.max(d+1,e)))},l=function(){return a(),un(t)},u=function(d){a(),n=d,n.l==null&&(n.l=n.length),o(e)};return{next:o,push:u,end:l,_bufs:t}}function Pe(t,e,r,n){var a=+e,o;if(!isNaN(a)){n||(n=o0[a].p||(r||[]).length||0),o=1+(a>=128?1:0)+1,n>=128&&++o,n>=16384&&++o,n>=2097152&&++o;var l=t.next(o);a<=127?l.write_shift(1,a):(l.write_shift(1,(a&127)+128),l.write_shift(1,a>>7));for(var u=0;u!=4;++u)if(n>=128)l.write_shift(1,(n&127)+128),n>>=7;else{l.write_shift(1,n);break}n>0&&kv(r)&&t.push(r)}}function Ff(t,e,r){var n=dr(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function kT(t,e,r){var n=dr(t);return n.s=Ff(n.s,e.s,r),n.e=Ff(n.e,e.s,r),n}function Pf(t,e){if(t.cRel&&t.c<0)for(t=dr(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=dr(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=ot(t);return!t.cRel&&t.cRel!=null&&(r=PP(r)),!t.rRel&&t.rRel!=null&&(r=OP(r)),r}function a1(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+vr(t.s.c)+":"+(t.e.cRel?"":"$")+vr(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Pr(t.s.r)+":"+(t.e.rRel?"":"$")+Pr(t.e.r):Pf(t.s,e.biff)+":"+Pf(t.e,e.biff)}function Cv(t){return parseInt(FP(t),10)-1}function Pr(t){return""+(t+1)}function OP(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function FP(t){return t.replace(/\$(\d+)$/,"$1")}function Rv(t){for(var e=LP(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function vr(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function PP(t){return t.replace(/^([A-Z])/,"$$$1")}function LP(t){return t.replace(/^\$([A-Z])/,"$1")}function MP(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function _r(t){for(var e=0,r=0,n=0;n<t.length;++n){var a=t.charCodeAt(n);a>=48&&a<=57?e=10*e+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:e-1}}function ot(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function aa(t){var e=t.indexOf(":");return e==-1?{s:_r(t),e:_r(t)}:{s:_r(t.slice(0,e)),e:_r(t.slice(e+1))}}function vt(t,e){return typeof e>"u"||typeof e=="number"?vt(t.s,t.e):(typeof t!="string"&&(t=ot(t)),typeof e!="string"&&(e=ot(e)),t==e?t:t+":"+e)}function Vt(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,o=t.length;for(r=0;n<o&&!((a=t.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(e.s.c=--r,r=0;n<o&&!((a=t.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(e.s.r=--r,n===o||a!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=o&&!((a=t.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(e.e.c=--r,r=0;n!=o&&!((a=t.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return e.e.r=--r,e}function CT(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Ea(t.z,r?tn(e):e)}catch{}try{return t.w=Ea((t.XF||{}).numFmtId||(r?14:0),r?tn(e):e)}catch{return""+e}}function _s(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?Es[t.v]||t.v:e==null?CT(t,t.v):CT(t,e))}function Io(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function Bk(t,e,r){var n=r||{},a=t?Array.isArray(t):n.dense,o=t||(a?[]:{}),l=0,u=0;if(o&&n.origin!=null){if(typeof n.origin=="number")l=n.origin;else{var f=typeof n.origin=="string"?_r(n.origin):n.origin;l=f.r,u=f.c}o["!ref"]||(o["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var m=Vt(o["!ref"]);d.s.c=m.s.c,d.s.r=m.s.r,d.e.c=Math.max(d.e.c,m.e.c),d.e.r=Math.max(d.e.r,m.e.r),l==-1&&(d.e.r=l=m.e.r+1)}for(var v=0;v!=e.length;++v)if(e[v]){if(!Array.isArray(e[v]))throw new Error("aoa_to_sheet expects an array of arrays");for(var _=0;_!=e[v].length;++_)if(!(typeof e[v][_]>"u")){var E={v:e[v][_]},S=l+v,w=u+_;if(d.s.r>S&&(d.s.r=S),d.s.c>w&&(d.s.c=w),d.e.r<S&&(d.e.r=S),d.e.c<w&&(d.e.c=w),e[v][_]&&typeof e[v][_]=="object"&&!Array.isArray(e[v][_])&&!(e[v][_]instanceof Date))E=e[v][_];else if(Array.isArray(E.v)&&(E.f=e[v][_][1],E.v=E.v[0]),E.v===null)if(E.f)E.t="n";else if(n.nullError)E.t="e",E.v=0;else if(n.sheetStubs)E.t="z";else continue;else typeof E.v=="number"?E.t="n":typeof E.v=="boolean"?E.t="b":E.v instanceof Date?(E.z=n.dateNF||at[14],n.cellDates?(E.t="d",E.w=Ea(E.z,tn(E.v))):(E.t="n",E.v=tn(E.v),E.w=Ea(E.z,E.v))):E.t="s";if(a)o[S]||(o[S]=[]),o[S][w]&&o[S][w].z&&(E.z=o[S][w].z),o[S][w]=E;else{var b=ot({c:w,r:S});o[b]&&o[b].z&&(E.z=o[b].z),o[b]=E}}}return d.s.c<1e7&&(o["!ref"]=vt(d)),o}function uu(t,e){return Bk(null,t,e)}function UP(t){return t.read_shift(4,"i")}function ni(t,e){return e||(e=Se(4)),e.write_shift(4,t),e}function Fn(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function fn(t,e){var r=!1;return e==null&&(r=!0,e=Se(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function BP(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function VP(t,e){return e||(e=Se(4)),e.write_shift(2,0),e.write_shift(2,0),e}function Nv(t,e){var r=t.l,n=t.read_shift(1),a=Fn(t),o=[],l={t:a,h:a};if((n&1)!==0){for(var u=t.read_shift(4),f=0;f!=u;++f)o.push(BP(t));l.r=o}else l.r=[{ich:0,ifnt:0}];return t.l=r+e,l}function jP(t,e){var r=!1;return e==null&&(r=!0,e=Se(15+4*t.t.length)),e.write_shift(1,0),fn(t.t,e),r?e.slice(0,e.l):e}var HP=Nv;function zP(t,e){var r=!1;return e==null&&(r=!0,e=Se(23+4*t.t.length)),e.write_shift(1,1),fn(t.t,e),e.write_shift(4,1),VP({},e),r?e.slice(0,e.l):e}function za(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Ll(t,e){return e==null&&(e=Se(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function Ml(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function Ul(t,e){return e==null&&(e=Se(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var GP=Fn,Vk=fn;function Iv(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function tm(t,e){var r=!1;return e==null&&(r=!0,e=Se(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var qP=Fn,Z1=Iv,Dv=tm;function Ov(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var a=n===0?em([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):cl(e,0)>>2;return r?a/100:a}function jk(t,e){e==null&&(e=Se(4));var r=0,n=0,a=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?a:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function Hk(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function WP(t,e){return e||(e=Se(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var Bl=Hk,fu=WP;function On(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Al(t,e){return(e||Se(8)).write_shift(8,t,"f")}function XP(t){var e={},r=t.read_shift(1),n=r>>>1,a=t.read_shift(1),o=t.read_shift(2,"i"),l=t.read_shift(1),u=t.read_shift(1),f=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=a;var d=hl[a];d&&(e.rgb=n0(d));break;case 2:e.rgb=n0([l,u,f]);break;case 3:e.theme=a;break}return o!=0&&(e.tint=o>0?o/32767:o/32768),e}function rm(t,e){if(e||(e=Se(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function KP(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function YP(t,e){e||(e=Se(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function zk(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function $P(t){return zk(t,1)}function QP(t){return zk(t,2)}var Fv=2,ea=3,od=11,RT=12,nm=19,ld=64,ZP=65,JP=71,eL=4108,tL=4126,cn=80,Gk=81,rL=[cn,Gk],J1={1:{n:"CodePage",t:Fv},2:{n:"Category",t:cn},3:{n:"PresentationFormat",t:cn},4:{n:"ByteCount",t:ea},5:{n:"LineCount",t:ea},6:{n:"ParagraphCount",t:ea},7:{n:"SlideCount",t:ea},8:{n:"NoteCount",t:ea},9:{n:"HiddenCount",t:ea},10:{n:"MultimediaClipCount",t:ea},11:{n:"ScaleCrop",t:od},12:{n:"HeadingPairs",t:eL},13:{n:"TitlesOfParts",t:tL},14:{n:"Manager",t:cn},15:{n:"Company",t:cn},16:{n:"LinksUpToDate",t:od},17:{n:"CharacterCount",t:ea},19:{n:"SharedDoc",t:od},22:{n:"HyperlinksChanged",t:od},23:{n:"AppVersion",t:ea,p:"version"},24:{n:"DigSig",t:ZP},26:{n:"ContentType",t:cn},27:{n:"ContentStatus",t:cn},28:{n:"Language",t:cn},29:{n:"Version",t:cn},255:{},2147483648:{n:"Locale",t:nm},2147483651:{n:"Behavior",t:nm},1919054434:{}},ex={1:{n:"CodePage",t:Fv},2:{n:"Title",t:cn},3:{n:"Subject",t:cn},4:{n:"Author",t:cn},5:{n:"Keywords",t:cn},6:{n:"Comments",t:cn},7:{n:"Template",t:cn},8:{n:"LastAuthor",t:cn},9:{n:"RevNumber",t:cn},10:{n:"EditTime",t:ld},11:{n:"LastPrinted",t:ld},12:{n:"CreatedDate",t:ld},13:{n:"ModifiedDate",t:ld},14:{n:"PageCount",t:ea},15:{n:"WordCount",t:ea},16:{n:"CharCount",t:ea},17:{n:"Thumbnail",t:JP},18:{n:"Application",t:cn},19:{n:"DocSecurity",t:ea},255:{},2147483648:{n:"Locale",t:nm},2147483651:{n:"Behavior",t:nm},1919054434:{}},NT={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},nL=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function aL(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var iL=aL([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),hl=dr(iL),Es={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},qk={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},tx={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},cd={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Pv(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function sL(t){var e=Pv();if(!t||!t.match)return e;var r={};if((t.match(Mn)||[]).forEach(function(n){var a=dt(n);switch(a[0].replace(gP,"<")){case"<?xml":break;case"<Types":e.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":e[tx[a.ContentType]]!==void 0&&e[tx[a.ContentType]].push(a.PartName);break}}),e.xmlns!==Zr.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function Wk(t,e){var r=sP(tx),n=[],a;n[n.length]=Lr,n[n.length]=ze("Types",null,{xmlns:Zr.CT,"xmlns:xsd":Zr.xsd,"xmlns:xsi":Zr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(f){return ze("Default",null,{Extension:f[0],ContentType:f[1]})}));var o=function(f){t[f]&&t[f].length>0&&(a=t[f][0],n[n.length]=ze("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:cd[f][e.bookType]||cd[f].xlsx}))},l=function(f){(t[f]||[]).forEach(function(d){n[n.length]=ze("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:cd[f][e.bookType]||cd[f].xlsx})})},u=function(f){(t[f]||[]).forEach(function(d){n[n.length]=ze("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[f][0]})})};return o("workbooks"),l("sheets"),l("charts"),u("themes"),["strs","styles"].forEach(o),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),l("metadata"),u("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var At={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function r0(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Lf(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(Mn)||[]).forEach(function(a){var o=dt(a);if(o[0]==="<Relationship"){var l={};l.Type=o.Type,l.Target=o.Target,l.Id=o.Id,o.TargetMode&&(l.TargetMode=o.TargetMode);var u=o.TargetMode==="External"?o.Target:bf(o.Target,e);r[u]=l,n[o.Id]=l}}),r["!id"]=n,r}function Gc(t){var e=[Lr,ze("Relationships",null,{xmlns:Zr.RELS})];return Ar(t["!id"]).forEach(function(r){e[e.length]=ze("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Qt(t,e,r,n,a,o){if(a||(a={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,a.Id="rId"+e,a.Type=n,a.Target=r,[At.HLINK,At.XPATH,At.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),t["!id"][a.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][a.Id]=a,t[("/"+a.Target).replace("//","/")]=a,e}var oL="application/vnd.oasis.opendocument.spreadsheet";function lL(t,e){for(var r=Sv(t),n,a;n=t0.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=dt(n[0],!1),a.path=="/"&&a.type!==oL)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function cL(t){var e=[Lr];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function IT(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function uL(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function fL(t){var e=[Lr];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(IT(t[r][0],t[r][1])),e.push(uL("",t[r][0]));return e.push(IT("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function Xk(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Yd.version+"</meta:generator></office:meta></office:document-meta>"}var Ha=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],hL=function(){for(var t=new Array(Ha.length),e=0;e<Ha.length;++e){var r=Ha[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function Kk(t){var e={};t=ar(t);for(var r=0;r<Ha.length;++r){var n=Ha[r],a=t.match(hL[r]);a!=null&&a.length>0&&(e[n[1]]=Bt(a[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=hr(e[n[1]]))}return e}function i1(t,e,r,n,a){a[t]!=null||e==null||e===""||(a[t]=e,e=Zt(e),n[n.length]=r?ze(t,e,r):wn(t,e))}function Yk(t,e){var r=e||{},n=[Lr,ze("cp:coreProperties",null,{"xmlns:cp":Zr.CORE_PROPS,"xmlns:dc":Zr.dc,"xmlns:dcterms":Zr.dcterms,"xmlns:dcmitype":Zr.dcmitype,"xmlns:xsi":Zr.xsi})],a={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&i1("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:Q1(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),t.ModifiedDate!=null&&i1("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:Q1(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var o=0;o!=Ha.length;++o){var l=Ha[o],u=r.Props&&r.Props[l[1]]!=null?r.Props[l[1]]:t?t[l[1]]:null;u===!0?u="1":u===!1?u="0":typeof u=="number"&&(u=String(u)),u!=null&&i1(l[0],u,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var dl=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],$k=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Qk(t,e,r,n){var a=[];if(typeof t=="string")a=wT(t,n);else for(var o=0;o<t.length;++o)a=a.concat(t[o].map(function(m){return{v:m}}));var l=typeof e=="string"?wT(e,n).map(function(m){return m.v}):e,u=0,f=0;if(l.length>0)for(var d=0;d!==a.length;d+=2){switch(f=+a[d+1].v,a[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=f,r.SheetNames=l.slice(u,u+f);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=f,r.DefinedNames=l.slice(u,u+f);break;case"Charts":case"Diagramme":r.Chartsheets=f,r.ChartNames=l.slice(u,u+f);break}u+=f}}function dL(t,e,r){var n={};return e||(e={}),t=ar(t),dl.forEach(function(a){var o=(t.match(Jf(a[0]))||[])[1];switch(a[2]){case"string":o&&(e[a[1]]=Bt(o));break;case"bool":e[a[1]]=o==="true";break;case"raw":var l=t.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));l&&l.length>0&&(n[a[1]]=l[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&Qk(n.HeadingPairs,n.TitlesOfParts,e,r),e}function Zk(t){var e=[],r=ze;return t||(t={}),t.Application="SheetJS",e[e.length]=Lr,e[e.length]=ze("Properties",null,{xmlns:Zr.EXT_PROPS,"xmlns:vt":Zr.vt}),dl.forEach(function(n){if(t[n[1]]!==void 0){var a;switch(n[2]){case"string":a=Zt(String(t[n[1]]));break;case"bool":a=t[n[1]]?"true":"false";break}a!==void 0&&(e[e.length]=r(n[0],a))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+Zt(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var mL=/<[^>]+>[^<]*/g;function pL(t,e){var r={},n="",a=t.match(mL);if(a)for(var o=0;o!=a.length;++o){var l=a[o],u=dt(l);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Bt(u.name);break;case"</property>":n=null;break;default:if(l.indexOf("<vt:")===0){var f=l.split(">"),d=f[0].slice(4),m=f[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[n]=Bt(m);break;case"bool":r[n]=ur(m);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(m,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(m);break;case"filetime":case"date":r[n]=hr(m);break;case"cy":case"error":r[n]=Bt(m);break;default:if(d.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",l,d,f)}}else if(l.slice(0,2)!=="</"){if(e.WTF)throw new Error(l)}}}return r}function Jk(t){var e=[Lr,ze("Properties",null,{xmlns:Zr.CUST_PROPS,"xmlns:vt":Zr.vt})];if(!t)return e.join("");var r=1;return Ar(t).forEach(function(a){++r,e[e.length]=ze("property",bP(t[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Zt(a)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var rx={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},s1;function gL(t,e,r){s1||(s1=Fm(rx)),e=s1[e]||e,t[e]=r}function xL(t,e){var r=[];return Ar(rx).map(function(n){for(var a=0;a<Ha.length;++a)if(Ha[a][1]==n)return Ha[a];for(a=0;a<dl.length;++a)if(dl[a][1]==n)return dl[a];throw n}).forEach(function(n){if(t[n[1]]!=null){var a=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(wn(rx[n[1]]||n[1],a))}}),ze("DocumentProperties",r.join(""),{xmlns:ma.o})}function vL(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return t&&Ar(t).forEach(function(o){if(Object.prototype.hasOwnProperty.call(t,o)){for(var l=0;l<Ha.length;++l)if(o==Ha[l][1])return;for(l=0;l<dl.length;++l)if(o==dl[l][1])return;for(l=0;l<r.length;++l)if(o==r[l])return;var u=t[o],f="string";typeof u=="number"?(f="float",u=String(u)):u===!0||u===!1?(f="boolean",u=u?"1":"0"):u=String(u),a.push(ze(xT(o),u,{"dt:dt":f}))}}),e&&Ar(e).forEach(function(o){if(Object.prototype.hasOwnProperty.call(e,o)&&!(t&&Object.prototype.hasOwnProperty.call(t,o))){var l=e[o],u="string";typeof l=="number"?(u="float",l=String(l)):l===!0||l===!1?(u="boolean",l=l?"1":"0"):l instanceof Date?(u="dateTime.tz",l=l.toISOString()):l=String(l),a.push(ze(xT(o),l,{"dt:dt":u}))}}),"<"+n+' xmlns="'+ma.o+'">'+a.join("")+"</"+n+">"}function Lv(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function _L(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var o=n/Math.pow(2,32)|0;o>0&&(n=n%Math.pow(2,32),a+=o);var l=Se(8);return l.write_shift(4,n),l.write_shift(4,a),l}function e4(t,e,r){var n=t.l,a=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return a}function t4(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function r4(t,e,r){return e===31?t4(t):e4(t,e,r)}function nx(t,e,r){return r4(t,e,r===!1?0:4)}function yL(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return r4(t,e,0)}function wL(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var a=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Kn,""),t.l-a&2&&(t.l+=2)}return r}function EL(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Kn,"");return r}function TL(t){var e=t.l,r=am(t,Gk);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=am(t,ea);return[r,n]}function bL(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(TL(t));return r}function DT(t,e){for(var r=t.read_shift(4),n={},a=0;a!=r;++a){var o=t.read_shift(4),l=t.read_shift(4);n[o]=t.read_shift(l,e===1200?"utf16le":"utf8").replace(Kn,"").replace(Tf,"!"),e===1200&&l%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function n4(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function SL(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function am(t,e,r){var n=t.read_shift(2),a,o=r||{};if(t.l+=2,e!==RT&&n!==e&&rL.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===RT?n:e){case 2:return a=t.read_shift(2,"i"),o.raw||(t.l+=2),a;case 3:return a=t.read_shift(4,"i"),a;case 11:return t.read_shift(4)!==0;case 19:return a=t.read_shift(4),a;case 30:return e4(t,n,4).replace(Kn,"");case 31:return t4(t);case 64:return Lv(t);case 65:return n4(t);case 71:return SL(t);case 80:return nx(t,n,!o.raw).replace(Kn,"");case 81:return yL(t,n).replace(Kn,"");case 4108:return bL(t);case 4126:case 4127:return n==4127?wL(t):EL(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function OT(t,e){var r=Se(4),n=Se(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=Se(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=_L(e);break;case 31:case 80:for(n=Se(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return un([r,n])}function FT(t,e){var r=t.l,n=t.read_shift(4),a=t.read_shift(4),o=[],l=0,u=0,f=-1,d={};for(l=0;l!=a;++l){var m=t.read_shift(4),v=t.read_shift(4);o[l]=[m,v+r]}o.sort(function(B,F){return B[1]-F[1]});var _={};for(l=0;l!=a;++l){if(t.l!==o[l][1]){var E=!0;if(l>0&&e)switch(e[o[l-1][0]].t){case 2:t.l+2===o[l][1]&&(t.l+=2,E=!1);break;case 80:t.l<=o[l][1]&&(t.l=o[l][1],E=!1);break;case 4108:t.l<=o[l][1]&&(t.l=o[l][1],E=!1);break}if((!e||l==0)&&t.l<=o[l][1]&&(E=!1,t.l=o[l][1]),E)throw new Error("Read Error: Expected address "+o[l][1]+" at "+t.l+" :"+l)}if(e){var S=e[o[l][0]];if(_[S.n]=am(t,S.t,{raw:!0}),S.p==="version"&&(_[S.n]=String(_[S.n]>>16)+"."+("0000"+String(_[S.n]&65535)).slice(-4)),S.n=="CodePage")switch(_[S.n]){case 0:_[S.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Ja(u=_[S.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+_[S.n])}}else if(o[l][0]===1){if(u=_.CodePage=am(t,Fv),Ja(u),f!==-1){var w=t.l;t.l=o[f][1],d=DT(t,u),t.l=w}}else if(o[l][0]===0){if(u===0){f=l,t.l=o[l+1][1];continue}d=DT(t,u)}else{var b=d[o[l][0]],L;switch(t[t.l]){case 65:t.l+=4,L=n4(t);break;case 30:t.l+=4,L=nx(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,L=nx(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,L=t.read_shift(4,"i");break;case 19:t.l+=4,L=t.read_shift(4);break;case 5:t.l+=4,L=t.read_shift(8,"f");break;case 11:t.l+=4,L=Or(t,4);break;case 64:t.l+=4,L=hr(Lv(t));break;default:throw new Error("unparsed value: "+t[t.l])}_[b]=L}}return t.l=r+n,_}var a4=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function AL(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function PT(t,e,r){var n=Se(8),a=[],o=[],l=8,u=0,f=Se(8),d=Se(8);if(f.write_shift(4,2),f.write_shift(4,1200),d.write_shift(4,1),o.push(f),a.push(d),l+=8+f.length,!e){d=Se(8),d.write_shift(4,0),a.unshift(d);var m=[Se(4)];for(m[0].write_shift(4,t.length),u=0;u<t.length;++u){var v=t[u][0];for(f=Se(8+2*(v.length+1)+(v.length%2?0:2)),f.write_shift(4,u+2),f.write_shift(4,v.length+1),f.write_shift(0,v,"dbcs");f.l!=f.length;)f.write_shift(1,0);m.push(f)}f=un(m),o.unshift(f),l+=8+f.length}for(u=0;u<t.length;++u)if(!(e&&!e[t[u][0]])&&!(a4.indexOf(t[u][0])>-1||$k.indexOf(t[u][0])>-1)&&t[u][1]!=null){var _=t[u][1],E=0;if(e){E=+e[t[u][0]];var S=r[E];if(S.p=="version"&&typeof _=="string"){var w=_.split(".");_=(+w[0]<<16)+(+w[1]||0)}f=OT(S.t,_)}else{var b=AL(_);b==-1&&(b=31,_=String(_)),f=OT(b,_)}o.push(f),d=Se(8),d.write_shift(4,e?E:2+u),a.push(d),l+=8+f.length}var L=8*(o.length+1);for(u=0;u<o.length;++u)a[u].write_shift(4,L),L+=o[u].length;return n.write_shift(4,l),n.write_shift(4,o.length),un([n].concat(a).concat(o))}function LT(t,e,r){var n=t.content;if(!n)return{};_n(n,0);var a,o,l,u,f=0;n.chk("feff","Byte Order: "),n.read_shift(2);var d=n.read_shift(4),m=n.read_shift(16);if(m!==et.utils.consts.HEADER_CLSID&&m!==r)throw new Error("Bad PropertySet CLSID "+m);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(o=n.read_shift(16),u=n.read_shift(4),a===1&&u!==n.l)throw new Error("Length mismatch: "+u+" !== "+n.l);a===2&&(l=n.read_shift(16),f=n.read_shift(4));var v=FT(n,e),_={SystemIdentifier:d};for(var E in v)_[E]=v[E];if(_.FMTID=o,a===1)return _;if(f-n.l==2&&(n.l+=2),n.l!==f)throw new Error("Length mismatch 2: "+n.l+" !== "+f);var S;try{S=FT(n,null)}catch{}for(E in S)_[E]=S[E];return _.FMTID=[o,l],_}function MT(t,e,r,n,a,o){var l=Se(a?68:48),u=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,et.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,a?2:1),l.write_shift(16,e,"hex"),l.write_shift(4,a?68:48);var f=PT(t,r,n);if(u.push(f),a){var d=PT(a,null,null);l.write_shift(16,o,"hex"),l.write_shift(4,68+f.length),u.push(d)}return un(u)}function Qs(t,e){return t.read_shift(e),null}function kL(t,e){e||(e=Se(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function CL(t,e,r){for(var n=[],a=t.l+e;t.l<a;)n.push(r(t,a-t.l));if(a!==t.l)throw new Error("Slurp error");return n}function Or(t,e){return t.read_shift(e)===1}function Wn(t,e){return e||(e=Se(2)),e.write_shift(2,+!!t),e}function Gr(t){return t.read_shift(2,"u")}function Va(t,e){return e||(e=Se(2)),e.write_shift(2,t),e}function i4(t,e){return CL(t,e,Gr)}function RL(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function s4(t,e,r){return r||(r=Se(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function R0(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var o=t.read_shift(1);o&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var l=n?t.read_shift(n,a):"";return l}function NL(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,a=r&8,o=1+(r&1),l=0,u,f={};a&&(l=t.read_shift(2)),n&&(u=t.read_shift(4));var d=o==2?"dbcs-cont":"sbcs-cont",m=e===0?"":t.read_shift(e,d);return a&&(t.l+=4*l),n&&(t.l+=u),f.t=m,a||(f.raw="<t>"+f.t+"</t>",f.r=f.t),f}function IL(t){var e=t.t||"",r=Se(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=Se(2*e.length);n.write_shift(2*e.length,e,"utf16le");var a=[r,n];return un(a)}function kl(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var a=t.read_shift(1);return a===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function N0(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):kl(t,n,r)}function Vl(t,e,r){if(r.biff>5)return N0(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function o4(t,e,r){return r||(r=Se(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function DL(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function OL(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var a=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Kn,"");return n&&(t.l+=24),a}function FL(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=t.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var o=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=t.read_shift(o>>1,"utf16le").replace(Kn,"");return r+l}function PL(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return OL(t);case"0303000000000000c000000000000046":return FL(t);default:throw new Error("Unsupported Moniker "+r)}}function ud(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Kn,""):"";return r}function UT(t,e){e||(e=Se(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function LL(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=t.read_shift(2);t.l+=2;var o,l,u,f,d="",m,v;a&16&&(o=ud(t,r-t.l)),a&128&&(l=ud(t,r-t.l)),(a&257)===257&&(u=ud(t,r-t.l)),(a&257)===1&&(f=PL(t,r-t.l)),a&8&&(d=ud(t,r-t.l)),a&32&&(m=t.read_shift(16)),a&64&&(v=Lv(t)),t.l=r;var _=l||u||f||"";_&&d&&(_+="#"+d),_||(_="#"+d),a&2&&_.charAt(0)=="/"&&_.charAt(1)!="/"&&(_="file://"+_);var E={Target:_};return m&&(E.guid=m),v&&(E.time=v),o&&(E.Tooltip=o),E}function ML(t){var e=Se(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),o=a>-1?31:23;switch(n.charAt(0)){case"#":o=28;break;case".":o&=-3;break}e.write_shift(4,2),e.write_shift(4,o);var l=[8,6815827,6619237,4849780,83];for(r=0;r<l.length;++r)e.write_shift(4,l[r]);if(o==28)n=n.slice(1),UT(n,e);else if(o&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<l.length;++r)e.write_shift(1,parseInt(l[r],16));var u=a>-1?n.slice(0,a):n;for(e.write_shift(4,2*(u.length+1)),r=0;r<u.length;++r)e.write_shift(2,u.charCodeAt(r));e.write_shift(2,0),o&8&&UT(a>-1?n.slice(a+1):"",e)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<l.length;++r)e.write_shift(1,parseInt(l[r],16));for(var f=0;n.slice(f*3,f*3+3)=="../"||n.slice(f*3,f*3+3)=="..\\";)++f;for(e.write_shift(2,f),e.write_shift(4,n.length-3*f+1),r=0;r<n.length-3*f;++r)e.write_shift(1,n.charCodeAt(r+3*f)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function l4(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),a=t.read_shift(1);return[e,r,n,a]}function c4(t,e){var r=l4(t);return r[3]=0,r}function ji(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function Cl(t,e,r,n){return n||(n=Se(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function UL(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function BL(t,e,r){return e===0?"":Vl(t,e,r)}function VL(t,e,r){var n=r.biff>8?4:2,a=t.read_shift(n),o=t.read_shift(n,"i"),l=t.read_shift(n,"i");return[a,o,l]}function u4(t){var e=t.read_shift(2),r=Ov(t);return[e,r]}function jL(t,e,r){t.l+=4,e-=4;var n=t.l+e,a=R0(t,e,r),o=t.read_shift(2);if(n-=t.l,o!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+o);return t.l+=o,a}function Mm(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),a=t.read_shift(2);return{s:{c:n,r:e},e:{c:a,r}}}function f4(t,e){return e||(e=Se(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function h4(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),a=t.read_shift(1);return{s:{c:n,r:e},e:{c:a,r}}}var HL=h4;function d4(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function zL(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function GL(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function kn(t){t.l+=2,t.l+=t.read_shift(2)}var qL={0:kn,4:kn,5:kn,6:kn,7:GL,8:kn,9:kn,10:kn,11:kn,12:kn,13:zL,14:kn,15:kn,16:kn,17:kn,18:kn,19:kn,20:kn,21:d4};function WL(t,e){for(var r=t.l+e,n=[];t.l<r;){var a=t.read_shift(2);t.l-=2;try{n.push(qL[a](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function fd(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function Mv(t,e,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var o=Se(a);return o.write_shift(2,n),o.write_shift(2,e),a>4&&o.write_shift(2,29282),a>6&&o.write_shift(2,1997),a>8&&(o.write_shift(2,49161),o.write_shift(2,1),o.write_shift(2,1798),o.write_shift(2,0)),o}function XL(t,e){return e===0||t.read_shift(2),1200}function KL(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,a=Vl(t,0,r);return t.read_shift(e+n-t.l),a}function YL(t,e){var r=!e||e.biff==8,n=Se(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function $L(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function QL(t,e,r){var n=t.read_shift(4),a=t.read_shift(1)&3,o=t.read_shift(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule";break}var l=R0(t,0,r);return l.length===0&&(l="Sheet1"),{pos:n,hs:a,dt:o,name:l}}function ZL(t,e){var r=!e||e.biff>=8?2:1,n=Se(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function JL(t,e){for(var r=t.l+e,n=t.read_shift(4),a=t.read_shift(4),o=[],l=0;l!=a&&t.l<r;++l)o.push(NL(t));return o.Count=n,o.Unique=a,o}function eM(t,e){var r=Se(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],a=0;a<t.length;++a)n[a]=IL(t[a]);var o=un([r].concat(n));return o.parts=[r.length].concat(n.map(function(l){return l.length})),o}function tM(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function rM(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function nM(t){var e=UL(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function aM(t){return t.read_shift(2),t.read_shift(4)}function BT(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var a=t.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var o={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[o,a]}function iM(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),u=t.read_shift(2),f=t.read_shift(2),d=t.read_shift(2);return{Pos:[e,r],Dim:[n,a],Flags:o,CurTab:l,FirstTab:u,Selected:f,TabRatio:d}}function sM(){var t=Se(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function oM(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function lM(t){var e=Se(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function cM(){}function uM(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=R0(t,0,r),n}function fM(t,e){var r=t.name||"Arial",n=e&&e.biff==5,a=n?15+r.length:16+2*r.length,o=Se(a);return o.write_shift(2,t.sz*20),o.write_shift(4,0),o.write_shift(2,400),o.write_shift(4,0),o.write_shift(2,0),o.write_shift(1,r.length),n||o.write_shift(1,1),o.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),o}function hM(t){var e=ji(t);return e.isst=t.read_shift(4),e}function dM(t,e,r,n){var a=Se(10);return Cl(t,e,n,a),a.write_shift(4,r),a}function mM(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,a=ji(t);r.biff==2&&t.l++;var o=N0(t,n-t.l,r);return a.val=o,a}function pM(t,e,r,n,a){var o=!a||a.biff==8,l=Se(8+ +o+(1+o)*r.length);return Cl(t,e,n,l),l.write_shift(2,r.length),o&&l.write_shift(1,1),l.write_shift((1+o)*r.length,r,o?"utf16le":"sbcs"),l}function gM(t,e,r){var n=t.read_shift(2),a=Vl(t,0,r);return[n,a]}function xM(t,e,r,n){var a=r&&r.biff==5;n||(n=Se(a?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(a?1:2,e.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*e.length,e,a?"sbcs":"utf16le");var o=n.length>n.l?n.slice(0,n.l):n;return o.l==null&&(o.l=o.length),o}var vM=Vl;function VT(t,e,r){var n=t.l+e,a=r.biff==8||!r.biff?4:2,o=t.read_shift(a),l=t.read_shift(a),u=t.read_shift(2),f=t.read_shift(2);return t.l=n,{s:{r:o,c:u},e:{r:l,c:f}}}function _M(t,e){var r=e.biff==8||!e.biff?4:2,n=Se(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function yM(t){var e=t.read_shift(2),r=t.read_shift(2),n=u4(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function wM(t,e){for(var r=t.l+e-2,n=t.read_shift(2),a=t.read_shift(2),o=[];t.l<r;)o.push(u4(t));if(t.l!==r)throw new Error("MulRK read error");var l=t.read_shift(2);if(o.length!=l-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:l,rkrec:o}}function EM(t,e){for(var r=t.l+e-2,n=t.read_shift(2),a=t.read_shift(2),o=[];t.l<r;)o.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var l=t.read_shift(2);if(o.length!=l-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:l,ixfe:o}}function TM(t,e,r,n){var a={},o=t.read_shift(4),l=t.read_shift(4),u=t.read_shift(4),f=t.read_shift(2);return a.patternType=nL[u>>26],n.cellStyles&&(a.alc=o&7,a.fWrap=o>>3&1,a.alcV=o>>4&7,a.fJustLast=o>>7&1,a.trot=o>>8&255,a.cIndent=o>>16&15,a.fShrinkToFit=o>>20&1,a.iReadOrder=o>>22&2,a.fAtrNum=o>>26&1,a.fAtrFnt=o>>27&1,a.fAtrAlc=o>>28&1,a.fAtrBdr=o>>29&1,a.fAtrPat=o>>30&1,a.fAtrProt=o>>31&1,a.dgLeft=l&15,a.dgRight=l>>4&15,a.dgTop=l>>8&15,a.dgBottom=l>>12&15,a.icvLeft=l>>16&127,a.icvRight=l>>23&127,a.grbitDiag=l>>30&3,a.icvTop=u&127,a.icvBottom=u>>7&127,a.icvDiag=u>>14&127,a.dgDiag=u>>21&15,a.icvFore=f&127,a.icvBack=f>>7&127,a.fsxButton=f>>14&1),a}function bM(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=TM(t,e,n.fStyle,r),n}function jT(t,e,r,n){var a=r&&r.biff==5;n||(n=Se(a?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var o=0;return t.numFmtId>0&&a&&(o|=1024),n.write_shift(4,o),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function SM(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function AM(t){var e=Se(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function HT(t,e,r){var n=ji(t);(r.biff==2||e==9)&&++t.l;var a=RL(t);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function kM(t,e,r,n,a,o){var l=Se(8);return Cl(t,e,n,l),s4(r,o,l),l}function CM(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=ji(t),a=On(t);return n.val=a,n}function RM(t,e,r,n){var a=Se(14);return Cl(t,e,n,a),Al(r,a),a}var zT=BL;function NM(t,e,r){var n=t.l+e,a=t.read_shift(2),o=t.read_shift(2);if(r.sbcch=o,o==1025||o==14849)return[o,a];if(o<1||o>255)throw new Error("Unexpected SupBook type: "+o);for(var l=kl(t,o),u=[];n>t.l;)u.push(N0(t));return[o,a,l,u]}function GT(t,e,r){var n=t.read_shift(2),a,o={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=jL(t,e-2,r)),o.body=a||t.read_shift(e-2),typeof a=="string"&&(o.Name=a),o}var IM=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function qT(t,e,r){var n=t.l+e,a=t.read_shift(2),o=t.read_shift(1),l=t.read_shift(1),u=t.read_shift(r&&r.biff==2?1:2),f=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),f=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var d=kl(t,l,r);a&32&&(d=IM[d.charCodeAt(0)]);var m=n-t.l;r&&r.biff==2&&--m;var v=n==t.l||u===0||!(m>0)?[]:WB(t,m,r,u);return{chKey:o,Name:d,itab:f,rgce:v}}function m4(t,e,r){if(r.biff<8)return DM(t,e,r);for(var n=[],a=t.l+e,o=t.read_shift(r.biff>8?4:2);o--!==0;)n.push(VL(t,r.biff>8?12:6,r));if(t.l!=a)throw new Error("Bad ExternSheet: "+t.l+" != "+a);return n}function DM(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=R0(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function OM(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),a=t.read_shift(2),o=kl(t,n,r),l=kl(t,a,r);return[o,l]}function FM(t,e,r){var n=h4(t);t.l++;var a=t.read_shift(1);return e-=8,[XB(t,e,r),a,n]}function WT(t,e,r){var n=HL(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,GB(t,e,r)]}function PM(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function LM(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),u=Vl(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:a},u,l,o]}}function MM(t,e,r){return LM(t,e,r)}function UM(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Mm(t));return r}function BM(t){var e=Se(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)f4(t[r],e);return e}function VM(t,e,r){if(r&&r.biff<8)return HM(t,e,r);var n=d4(t),a=WL(t,e-22,n[1]);return{cmo:n,ft:a}}var jM={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var a=t.read_shift(1);return t.l+=a,t.l=r,{fmt:n}}};function HM(t,e,r){t.l+=4;var n=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var l=[];return l.push((jM[n]||Ln)(t,e,r)),{cmo:[a,n,o],ft:l}}function zM(t,e,r){var n=t.l,a="";try{t.l+=4;var o=(r.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(o)==-1?t.l+=6:l=DL(t,6,r);var u=t.read_shift(2);t.read_shift(2),Gr(t,2);var f=t.read_shift(2);t.l+=f;for(var d=1;d<t.lens.length-1;++d){if(t.l-n!=t.lens[d])throw new Error("TxO: bad continue record");var m=t[t.l],v=kl(t,t.lens[d+1]-t.lens[d]-1);if(a+=v,a.length>=(m?u:2*u))break}if(a.length!==u&&a.length!==u*2)throw new Error("cchText: "+u+" != "+a.length);return t.l=n+e,{t:a}}catch{return t.l=n+e,{t:a}}}function GM(t,e){var r=Mm(t);t.l+=16;var n=LL(t,e-24);return[r,n]}function qM(t){var e=Se(24),r=_r(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)e.write_shift(1,parseInt(n[a],16));return un([e,ML(t[1])])}function WM(t,e){t.read_shift(2);var r=Mm(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Kn,""),[r,n]}function XM(t){var e=t[1].Tooltip,r=Se(10+2*(e.length+1));r.write_shift(2,2048);var n=_r(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<e.length;++a)r.write_shift(2,e.charCodeAt(a));return r.write_shift(2,0),r}function KM(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=NT[r]||r,r=t.read_shift(2),e[1]=NT[r]||r,e}function YM(t){return t||(t=Se(4)),t.write_shift(2,1),t.write_shift(2,1),t}function $M(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(c4(t));return r}function QM(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(c4(t));return r}function ZM(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function p4(t,e,r){if(!r.cellStyles)return Ln(t,e);var n=r&&r.biff>=12?4:2,a=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(n),u=t.read_shift(n),f=t.read_shift(2);n==2&&(t.l+=2);var d={s:a,e:o,w:l,ixfe:u,flags:f};return(r.biff>=5||!r.biff)&&(d.level=f>>8&7),d}function JM(t,e){var r=Se(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function e9(t,e){var r={};return e<32||(t.l+=16,r.header=On(t),r.footer=On(t),t.l+=2),r}function t9(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var a=t.read_shift(1);return t.l+=3,a&16&&(n.area=!0),n}function r9(t){for(var e=Se(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var n9=ji,a9=i4,i9=N0;function s9(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),a={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,a}function o9(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=ji(t);++t.l;var a=Vl(t,e-7,r);return n.t="str",n.val=a,n}function l9(t){var e=ji(t);++t.l;var r=On(t);return e.t="n",e.val=r,e}function c9(t,e,r){var n=Se(15);return F0(n,t,e),n.write_shift(8,r,"f"),n}function u9(t){var e=ji(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function f9(t,e,r){var n=Se(9);return F0(n,t,e),n.write_shift(2,r),n}function h9(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function d9(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function m9(t,e,r){var n=t.l+e,a=ji(t),o=t.read_shift(2),l=kl(t,o,r);return t.l=n,a.t="str",a.val=l,a}var p9=[2,3,48,49,131,139,140,245],ax=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Fm({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(u,f){var d=[],m=wo(1);switch(f.type){case"base64":m=xa(wa(u));break;case"binary":m=xa(u);break;case"buffer":case"array":m=u;break}_n(m,0);var v=m.read_shift(1),_=!!(v&136),E=!1,S=!1;switch(v){case 2:break;case 3:break;case 48:E=!0,_=!0;break;case 49:E=!0,_=!0;break;case 131:break;case 139:break;case 140:S=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+v.toString(16))}var w=0,b=521;v==2&&(w=m.read_shift(2)),m.l+=3,v!=2&&(w=m.read_shift(4)),w>1048576&&(w=1e6),v!=2&&(b=m.read_shift(2));var L=m.read_shift(2),B=f.codepage||1252;v!=2&&(m.l+=16,m.read_shift(1),m[m.l]!==0&&(B=t[m[m.l]]),m.l+=1,m.l+=2),S&&(m.l+=36);for(var F=[],z={},q=Math.min(m.length,v==2?521:b-10-(E?264:0)),W=S?32:11;m.l<q&&m[m.l]!=13;)switch(z={},z.name=$f.utils.decode(B,m.slice(m.l,m.l+W)).replace(/[\u0000\r\n].*$/g,""),m.l+=W,z.type=String.fromCharCode(m.read_shift(1)),v!=2&&!S&&(z.offset=m.read_shift(4)),z.len=m.read_shift(1),v==2&&(z.offset=m.read_shift(2)),z.dec=m.read_shift(1),z.name.length&&F.push(z),v!=2&&(m.l+=S?13:14),z.type){case"B":(!E||z.len!=8)&&f.WTF&&console.log("Skipping "+z.name+":"+z.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+z.name+":"+z.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+z.type)}if(m[m.l]!==13&&(m.l=b-1),m.read_shift(1)!==13)throw new Error("DBF Terminator not found "+m.l+" "+m[m.l]);m.l=b;var k=0,I=0;for(d[0]=[],I=0;I!=F.length;++I)d[0][I]=F[I].name;for(;w-- >0;){if(m[m.l]===42){m.l+=L;continue}for(++m.l,d[++k]=[],I=0,I=0;I!=F.length;++I){var A=m.slice(m.l,m.l+F[I].len);m.l+=F[I].len,_n(A,0);var O=$f.utils.decode(B,A);switch(F[I].type){case"C":O.trim().length&&(d[k][I]=O.replace(/\s+$/,""));break;case"D":O.length===8?d[k][I]=new Date(+O.slice(0,4),+O.slice(4,6)-1,+O.slice(6,8)):d[k][I]=O;break;case"F":d[k][I]=parseFloat(O.trim());break;case"+":case"I":d[k][I]=S?A.read_shift(-4,"i")^2147483648:A.read_shift(4,"i");break;case"L":switch(O.trim().toUpperCase()){case"Y":case"T":d[k][I]=!0;break;case"N":case"F":d[k][I]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+O+"|")}break;case"M":if(!_)throw new Error("DBF Unexpected MEMO for type "+v.toString(16));d[k][I]="##MEMO##"+(S?parseInt(O.trim(),10):A.read_shift(4));break;case"N":O=O.replace(/\u0000/g,"").trim(),O&&O!="."&&(d[k][I]=+O||0);break;case"@":d[k][I]=new Date(A.read_shift(-8,"f")-621356832e5);break;case"T":d[k][I]=new Date((A.read_shift(4)-2440588)*864e5+A.read_shift(4));break;case"Y":d[k][I]=A.read_shift(4,"i")/1e4+A.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[k][I]=-A.read_shift(-8,"f");break;case"B":if(E&&F[I].len==8){d[k][I]=A.read_shift(8,"f");break}case"G":case"P":A.l+=F[I].len;break;case"0":if(F[I].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+F[I].type)}}}if(v!=2&&m.l<m.length&&m[m.l++]!=26)throw new Error("DBF EOF Marker missing "+(m.l-1)+" of "+m.length+" "+m[m.l-1].toString(16));return f&&f.sheetRows&&(d=d.slice(0,f.sheetRows)),f.DBF=F,d}function n(u,f){var d=f||{};d.dateNF||(d.dateNF="yyyymmdd");var m=uu(r(u,d),d);return m["!cols"]=d.DBF.map(function(v){return{wch:v.len,DBF:v}}),delete d.DBF,m}function a(u,f){try{return Io(n(u,f),f)}catch(d){if(f&&f.WTF)throw d}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function l(u,f){var d=f||{};if(+d.codepage>=0&&Ja(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var m=na(),v=om(u,{header:1,raw:!0,cellDates:!0}),_=v[0],E=v.slice(1),S=u["!cols"]||[],w=0,b=0,L=0,B=1;for(w=0;w<_.length;++w){if(((S[w]||{}).DBF||{}).name){_[w]=S[w].DBF.name,++L;continue}if(_[w]!=null){if(++L,typeof _[w]=="number"&&(_[w]=_[w].toString(10)),typeof _[w]!="string")throw new Error("DBF Invalid column name "+_[w]+" |"+typeof _[w]+"|");if(_.indexOf(_[w])!==w){for(b=0;b<1024;++b)if(_.indexOf(_[w]+"_"+b)==-1){_[w]+="_"+b;break}}}}var F=Vt(u["!ref"]),z=[],q=[],W=[];for(w=0;w<=F.e.c-F.s.c;++w){var k="",I="",A=0,O=[];for(b=0;b<E.length;++b)E[b][w]!=null&&O.push(E[b][w]);if(O.length==0||_[w]==null){z[w]="?";continue}for(b=0;b<O.length;++b){switch(typeof O[b]){case"number":I="B";break;case"string":I="C";break;case"boolean":I="L";break;case"object":I=O[b]instanceof Date?"D":"C";break;default:I="C"}A=Math.max(A,String(O[b]).length),k=k&&k!=I?"C":I}A>250&&(A=250),I=((S[w]||{}).DBF||{}).type,I=="C"&&S[w].DBF.len>A&&(A=S[w].DBF.len),k=="B"&&I=="N"&&(k="N",W[w]=S[w].DBF.dec,A=S[w].DBF.len),q[w]=k=="C"||I=="N"?A:o[k]||0,B+=q[w],z[w]=k}var M=m.next(32);for(M.write_shift(4,318902576),M.write_shift(4,E.length),M.write_shift(2,296+32*L),M.write_shift(2,B),w=0;w<4;++w)M.write_shift(4,0);for(M.write_shift(4,0|(+e[nk]||3)<<8),w=0,b=0;w<_.length;++w)if(_[w]!=null){var N=m.next(32),D=(_[w].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);N.write_shift(1,D,"sbcs"),N.write_shift(1,z[w]=="?"?"C":z[w],"sbcs"),N.write_shift(4,b),N.write_shift(1,q[w]||o[z[w]]||0),N.write_shift(1,W[w]||0),N.write_shift(1,2),N.write_shift(4,0),N.write_shift(1,0),N.write_shift(4,0),N.write_shift(4,0),b+=q[w]||o[z[w]]||0}var he=m.next(264);for(he.write_shift(4,13),w=0;w<65;++w)he.write_shift(4,0);for(w=0;w<E.length;++w){var we=m.next(B);for(we.write_shift(1,0),b=0;b<_.length;++b)if(_[b]!=null)switch(z[b]){case"L":we.write_shift(1,E[w][b]==null?63:E[w][b]?84:70);break;case"B":we.write_shift(8,E[w][b]||0,"f");break;case"N":var ne="0";for(typeof E[w][b]=="number"&&(ne=E[w][b].toFixed(W[b]||0)),L=0;L<q[b]-ne.length;++L)we.write_shift(1,32);we.write_shift(1,ne,"sbcs");break;case"D":E[w][b]?(we.write_shift(4,("0000"+E[w][b].getFullYear()).slice(-4),"sbcs"),we.write_shift(2,("00"+(E[w][b].getMonth()+1)).slice(-2),"sbcs"),we.write_shift(2,("00"+E[w][b].getDate()).slice(-2),"sbcs")):we.write_shift(8,"00000000","sbcs");break;case"C":var ue=String(E[w][b]!=null?E[w][b]:"").slice(0,q[b]);for(we.write_shift(1,ue,"sbcs"),L=0;L<q[b]-ue.length;++L)we.write_shift(1,32);break}}return m.next(1).write_shift(1,26),m.end()}return{to_workbook:a,to_sheet:n,from_sheet:l}}(),g4=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Ar(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(_,E){var S=t[E];return typeof S=="number"?nT(S):S},n=function(_,E,S){var w=E.charCodeAt(0)-32<<4|S.charCodeAt(0)-48;return w==59?_:nT(w)};t["|"]=254;function a(_,E){switch(E.type){case"base64":return o(wa(_),E);case"binary":return o(_,E);case"buffer":return o(bt&&Buffer.isBuffer(_)?_.toString("binary"):No(_),E);case"array":return o(Sl(_),E)}throw new Error("Unrecognized type "+E.type)}function o(_,E){var S=_.split(/[\n\r]+/),w=-1,b=-1,L=0,B=0,F=[],z=[],q=null,W={},k=[],I=[],A=[],O=0,M;for(+E.codepage>=0&&Ja(+E.codepage);L!==S.length;++L){O=0;var N=S[L].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),D=N.replace(/;;/g,"\0").split(";").map(function(te){return te.replace(/\u0000/g,";")}),he=D[0],we;if(N.length>0)switch(he){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":D[1].charAt(0)=="P"&&z.push(N.slice(3).replace(/;;/g,";"));break;case"C":var ne=!1,ue=!1,Ve=!1,ie=!1,ee=-1,ge=-1;for(B=1;B<D.length;++B)switch(D[B].charAt(0)){case"A":break;case"X":b=parseInt(D[B].slice(1))-1,ue=!0;break;case"Y":for(w=parseInt(D[B].slice(1))-1,ue||(b=0),M=F.length;M<=w;++M)F[M]=[];break;case"K":we=D[B].slice(1),we.charAt(0)==='"'?we=we.slice(1,we.length-1):we==="TRUE"?we=!0:we==="FALSE"?we=!1:isNaN(ri(we))?isNaN(Jc(we).getDate())||(we=hr(we)):(we=ri(we),q!==null&&Fl(q)&&(we=Lm(we))),ne=!0;break;case"E":ie=!0;var V=qc(D[B].slice(1),{r:w,c:b});F[w][b]=[F[w][b],V];break;case"S":Ve=!0,F[w][b]=[F[w][b],"S5S"];break;case"G":break;case"R":ee=parseInt(D[B].slice(1))-1;break;case"C":ge=parseInt(D[B].slice(1))-1;break;default:if(E&&E.WTF)throw new Error("SYLK bad record "+N)}if(ne&&(F[w][b]&&F[w][b].length==2?F[w][b][0]=we:F[w][b]=we,q=null),Ve){if(ie)throw new Error("SYLK shared formula cannot have own formula");var K=ee>-1&&F[ee][ge];if(!K||!K[1])throw new Error("SYLK shared formula cannot find base");F[w][b][1]=F4(K[1],{r:w-ee,c:b-ge})}break;case"F":var Y=0;for(B=1;B<D.length;++B)switch(D[B].charAt(0)){case"X":b=parseInt(D[B].slice(1))-1,++Y;break;case"Y":for(w=parseInt(D[B].slice(1))-1,M=F.length;M<=w;++M)F[M]=[];break;case"M":O=parseInt(D[B].slice(1))/20;break;case"F":break;case"G":break;case"P":q=z[parseInt(D[B].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(A=D[B].slice(1).split(" "),M=parseInt(A[0],10);M<=parseInt(A[1],10);++M)O=parseInt(A[2],10),I[M-1]=O===0?{hidden:!0}:{wch:O},Eo(I[M-1]);break;case"C":b=parseInt(D[B].slice(1))-1,I[b]||(I[b]={});break;case"R":w=parseInt(D[B].slice(1))-1,k[w]||(k[w]={}),O>0?(k[w].hpt=O,k[w].hpx=tu(O)):O===0&&(k[w].hidden=!0);break;default:if(E&&E.WTF)throw new Error("SYLK bad record "+N)}Y<1&&(q=null);break;default:if(E&&E.WTF)throw new Error("SYLK bad record "+N)}}return k.length>0&&(W["!rows"]=k),I.length>0&&(W["!cols"]=I),E&&E.sheetRows&&(F=F.slice(0,E.sheetRows)),[F,W]}function l(_,E){var S=a(_,E),w=S[0],b=S[1],L=uu(w,E);return Ar(b).forEach(function(B){L[B]=b[B]}),L}function u(_,E){return Io(l(_,E),E)}function f(_,E,S,w){var b="C;Y"+(S+1)+";X"+(w+1)+";K";switch(_.t){case"n":b+=_.v||0,_.f&&!_.F&&(b+=";E"+zv(_.f,{r:S,c:w}));break;case"b":b+=_.v?"TRUE":"FALSE";break;case"e":b+=_.w||_.v;break;case"d":b+='"'+(_.w||_.v)+'"';break;case"s":b+='"'+_.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return b}function d(_,E){E.forEach(function(S,w){var b="F;W"+(w+1)+" "+(w+1)+" ";S.hidden?b+="0":(typeof S.width=="number"&&!S.wpx&&(S.wpx=a0(S.width)),typeof S.wpx=="number"&&!S.wch&&(S.wch=i0(S.wpx)),typeof S.wch=="number"&&(b+=Math.round(S.wch))),b.charAt(b.length-1)!=" "&&_.push(b)})}function m(_,E){E.forEach(function(S,w){var b="F;";S.hidden?b+="M0;":S.hpt?b+="M"+20*S.hpt+";":S.hpx&&(b+="M"+20*s0(S.hpx)+";"),b.length>2&&_.push(b+"R"+(w+1))})}function v(_,E){var S=["ID;PWXL;N;E"],w=[],b=Vt(_["!ref"]),L,B=Array.isArray(_),F=`\r
`;S.push("P;PGeneral"),S.push("F;P0;DG0G8;M255"),_["!cols"]&&d(S,_["!cols"]),_["!rows"]&&m(S,_["!rows"]),S.push("B;Y"+(b.e.r-b.s.r+1)+";X"+(b.e.c-b.s.c+1)+";D"+[b.s.c,b.s.r,b.e.c,b.e.r].join(" "));for(var z=b.s.r;z<=b.e.r;++z)for(var q=b.s.c;q<=b.e.c;++q){var W=ot({r:z,c:q});L=B?(_[z]||[])[q]:_[W],!(!L||L.v==null&&(!L.f||L.F))&&w.push(f(L,_,z,q))}return S.join(F)+F+w.join(F)+F+"E"+F}return{to_workbook:u,to_sheet:l,from_sheet:v}}(),x4=function(){function t(o,l){switch(l.type){case"base64":return e(wa(o),l);case"binary":return e(o,l);case"buffer":return e(bt&&Buffer.isBuffer(o)?o.toString("binary"):No(o),l);case"array":return e(Sl(o),l)}throw new Error("Unrecognized type "+l.type)}function e(o,l){for(var u=o.split(`
`),f=-1,d=-1,m=0,v=[];m!==u.length;++m){if(u[m].trim()==="BOT"){v[++f]=[],d=0;continue}if(!(f<0)){var _=u[m].trim().split(","),E=_[0],S=_[1];++m;for(var w=u[m]||"";(w.match(/["]/g)||[]).length&1&&m<u.length-1;)w+=`
`+u[++m];switch(w=w.trim(),+E){case-1:if(w==="BOT"){v[++f]=[],d=0;continue}else if(w!=="EOD")throw new Error("Unrecognized DIF special command "+w);break;case 0:w==="TRUE"?v[f][d]=!0:w==="FALSE"?v[f][d]=!1:isNaN(ri(S))?isNaN(Jc(S).getDate())?v[f][d]=S:v[f][d]=hr(S):v[f][d]=ri(S),++d;break;case 1:w=w.slice(1,w.length-1),w=w.replace(/""/g,'"'),w&&w.match(/^=".*"$/)&&(w=w.slice(2,-1)),v[f][d++]=w!==""?w:null;break}if(w==="EOD")break}}return l&&l.sheetRows&&(v=v.slice(0,l.sheetRows)),v}function r(o,l){return uu(t(o,l),l)}function n(o,l){return Io(r(o,l),l)}var a=function(){var o=function(f,d,m,v,_){f.push(d),f.push(m+","+v),f.push('"'+_.replace(/"/g,'""')+'"')},l=function(f,d,m,v){f.push(d+","+m),f.push(d==1?'"'+v.replace(/"/g,'""')+'"':v)};return function(f){var d=[],m=Vt(f["!ref"]),v,_=Array.isArray(f);o(d,"TABLE",0,1,"sheetjs"),o(d,"VECTORS",0,m.e.r-m.s.r+1,""),o(d,"TUPLES",0,m.e.c-m.s.c+1,""),o(d,"DATA",0,0,"");for(var E=m.s.r;E<=m.e.r;++E){l(d,-1,0,"BOT");for(var S=m.s.c;S<=m.e.c;++S){var w=ot({r:E,c:S});if(v=_?(f[E]||[])[S]:f[w],!v){l(d,1,0,"");continue}switch(v.t){case"n":var b=v.w;!b&&v.v!=null&&(b=v.v),b==null?v.f&&!v.F?l(d,1,0,"="+v.f):l(d,1,0,""):l(d,0,b,"V");break;case"b":l(d,0,v.v?1:0,v.v?"TRUE":"FALSE");break;case"s":l(d,1,0,isNaN(v.v)?v.v:'="'+v.v+'"');break;case"d":v.w||(v.w=Ea(v.z||at[14],tn(hr(v.v)))),l(d,0,v.w,"V");break;default:l(d,1,0,"")}}}l(d,-1,0,"EOD");var L=`\r
`,B=d.join(L);return B}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),v4=function(){function t(v){return v.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(v){return v.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(v,_){for(var E=v.split(`
`),S=-1,w=-1,b=0,L=[];b!==E.length;++b){var B=E[b].trim().split(":");if(B[0]==="cell"){var F=_r(B[1]);if(L.length<=F.r)for(S=L.length;S<=F.r;++S)L[S]||(L[S]=[]);switch(S=F.r,w=F.c,B[2]){case"t":L[S][w]=t(B[3]);break;case"v":L[S][w]=+B[3];break;case"vtf":var z=B[B.length-1];case"vtc":switch(B[3]){case"nl":L[S][w]=!!+B[4];break;default:L[S][w]=+B[4];break}B[2]=="vtf"&&(L[S][w]=[L[S][w],z])}}}return _&&_.sheetRows&&(L=L.slice(0,_.sheetRows)),L}function n(v,_){return uu(r(v,_),_)}function a(v,_){return Io(n(v,_),_)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function d(v){if(!v||!v["!ref"])return"";for(var _=[],E=[],S,w="",b=aa(v["!ref"]),L=Array.isArray(v),B=b.s.r;B<=b.e.r;++B)for(var F=b.s.c;F<=b.e.c;++F)if(w=ot({r:B,c:F}),S=L?(v[B]||[])[F]:v[w],!(!S||S.v==null||S.t==="z")){switch(E=["cell",w,"t"],S.t){case"s":case"str":E.push(e(S.v));break;case"n":S.f?(E[2]="vtf",E[3]="n",E[4]=S.v,E[5]=e(S.f)):(E[2]="v",E[3]=S.v);break;case"b":E[2]="vt"+(S.f?"f":"c"),E[3]="nl",E[4]=S.v?"1":"0",E[5]=e(S.f||(S.v?"TRUE":"FALSE"));break;case"d":var z=tn(hr(S.v));E[2]="vtc",E[3]="nd",E[4]=""+z,E[5]=S.w||Ea(S.z||at[14],z);break;case"e":continue}_.push(E.join(":"))}return _.push("sheet:c:"+(b.e.c-b.s.c+1)+":r:"+(b.e.r-b.s.r+1)+":tvf:1"),_.push("valueformat:1:text-wiki"),_.join(`
`)}function m(v){return[o,l,u,l,d(v),f].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:m}}(),eu=function(){function t(m,v,_,E,S){S.raw?v[_][E]=m:m===""||(m==="TRUE"?v[_][E]=!0:m==="FALSE"?v[_][E]=!1:isNaN(ri(m))?isNaN(Jc(m).getDate())?v[_][E]=m:v[_][E]=hr(m):v[_][E]=ri(m))}function e(m,v){var _=v||{},E=[];if(!m||m.length===0)return E;for(var S=m.split(/[\r\n]/),w=S.length-1;w>=0&&S[w].length===0;)--w;for(var b=10,L=0,B=0;B<=w;++B)L=S[B].indexOf(" "),L==-1?L=S[B].length:L++,b=Math.max(b,L);for(B=0;B<=w;++B){E[B]=[];var F=0;for(t(S[B].slice(0,b).trim(),E,B,F,_),F=1;F<=(S[B].length-b)/10+1;++F)t(S[B].slice(b+(F-1)*10,b+F*10).trim(),E,B,F,_)}return _.sheetRows&&(E=E.slice(0,_.sheetRows)),E}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(m){for(var v={},_=!1,E=0,S=0;E<m.length;++E)(S=m.charCodeAt(E))==34?_=!_:!_&&S in r&&(v[S]=(v[S]||0)+1);S=[];for(E in v)Object.prototype.hasOwnProperty.call(v,E)&&S.push([v[E],E]);if(!S.length){v=n;for(E in v)Object.prototype.hasOwnProperty.call(v,E)&&S.push([v[E],E])}return S.sort(function(w,b){return w[0]-b[0]||n[w[1]]-n[b[1]]}),r[S.pop()[1]]||44}function o(m,v){var _=v||{},E="",S=_.dense?[]:{},w={s:{c:0,r:0},e:{c:0,r:0}};m.slice(0,4)=="sep="?m.charCodeAt(5)==13&&m.charCodeAt(6)==10?(E=m.charAt(4),m=m.slice(7)):m.charCodeAt(5)==13||m.charCodeAt(5)==10?(E=m.charAt(4),m=m.slice(6)):E=a(m.slice(0,1024)):_&&_.FS?E=_.FS:E=a(m.slice(0,1024));var b=0,L=0,B=0,F=0,z=0,q=E.charCodeAt(0),W=!1,k=0,I=m.charCodeAt(0);m=m.replace(/\r\n/mg,`
`);var A=_.dateNF!=null?tP(_.dateNF):null;function O(){var M=m.slice(F,z),N={};if(M.charAt(0)=='"'&&M.charAt(M.length-1)=='"'&&(M=M.slice(1,-1).replace(/""/g,'"')),M.length===0)N.t="z";else if(_.raw)N.t="s",N.v=M;else if(M.trim().length===0)N.t="s",N.v=M;else if(M.charCodeAt(0)==61)M.charCodeAt(1)==34&&M.charCodeAt(M.length-1)==34?(N.t="s",N.v=M.slice(2,-1).replace(/""/g,'"')):NU(M)?(N.t="n",N.f=M.slice(1)):(N.t="s",N.v=M);else if(M=="TRUE")N.t="b",N.v=!0;else if(M=="FALSE")N.t="b",N.v=!1;else if(!isNaN(B=ri(M)))N.t="n",_.cellText!==!1&&(N.w=M),N.v=B;else if(!isNaN(Jc(M).getDate())||A&&M.match(A)){N.z=_.dateNF||at[14];var D=0;A&&M.match(A)&&(M=rP(M,_.dateNF,M.match(A)||[]),D=1),_.cellDates?(N.t="d",N.v=hr(M,D)):(N.t="n",N.v=tn(hr(M,D))),_.cellText!==!1&&(N.w=Ea(N.z,N.v instanceof Date?tn(N.v):N.v)),_.cellNF||delete N.z}else N.t="s",N.v=M;if(N.t=="z"||(_.dense?(S[b]||(S[b]=[]),S[b][L]=N):S[ot({c:L,r:b})]=N),F=z+1,I=m.charCodeAt(F),w.e.c<L&&(w.e.c=L),w.e.r<b&&(w.e.r=b),k==q)++L;else if(L=0,++b,_.sheetRows&&_.sheetRows<=b)return!0}e:for(;z<m.length;++z)switch(k=m.charCodeAt(z)){case 34:I===34&&(W=!W);break;case q:case 10:case 13:if(!W&&O())break e;break}return z-F>0&&O(),S["!ref"]=vt(w),S}function l(m,v){return!(v&&v.PRN)||v.FS||m.slice(0,4)=="sep="||m.indexOf("	")>=0||m.indexOf(",")>=0||m.indexOf(";")>=0?o(m,v):uu(e(m,v),v)}function u(m,v){var _="",E=v.type=="string"?[0,0,0,0]:Qv(m,v);switch(v.type){case"base64":_=wa(m);break;case"binary":_=m;break;case"buffer":v.codepage==65001?_=m.toString("utf8"):v.codepage&&typeof $f<"u"||(_=bt&&Buffer.isBuffer(m)?m.toString("binary"):No(m));break;case"array":_=Sl(m);break;case"string":_=m;break;default:throw new Error("Unrecognized type "+v.type)}return E[0]==239&&E[1]==187&&E[2]==191?_=ar(_.slice(3)):v.type!="string"&&v.type!="buffer"&&v.codepage==65001?_=ar(_):v.type=="binary"&&typeof $f<"u",_.slice(0,19)=="socialcalc:version:"?v4.to_sheet(v.type=="string"?_:ar(_),v):l(_,v)}function f(m,v){return Io(u(m,v),v)}function d(m){for(var v=[],_=Vt(m["!ref"]),E,S=Array.isArray(m),w=_.s.r;w<=_.e.r;++w){for(var b=[],L=_.s.c;L<=_.e.c;++L){var B=ot({r:w,c:L});if(E=S?(m[w]||[])[L]:m[B],!E||E.v==null){b.push("          ");continue}for(var F=(E.w||(_s(E),E.w)||"").slice(0,10);F.length<10;)F+=" ";b.push(F+(L===0?" ":""))}v.push(b.join(""))}return v.join(`
`)}return{to_workbook:f,to_sheet:u,from_sheet:d}}();function g9(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var a=g4.to_workbook(t,r);return r.WTF=n,a}catch(o){if(r.WTF=n,!o.message.match(/SYLK bad record ID/)&&n)throw o;return eu.to_workbook(t,e)}}var ml=function(){function t(V,K,Y){if(V){_n(V,V.l||0);for(var te=Y.Enum||ee;V.l<V.length;){var ce=V.read_shift(2),De=te[ce]||te[65535],ke=V.read_shift(2),Fe=V.l+ke,ye=De.f&&De.f(V,ke,Y);if(V.l=Fe,K(ye,De,ce))return}}}function e(V,K){switch(K.type){case"base64":return r(xa(wa(V)),K);case"binary":return r(xa(V),K);case"buffer":case"array":return r(V,K)}throw"Unsupported type "+K.type}function r(V,K){if(!V)return V;var Y=K||{},te=Y.dense?[]:{},ce="Sheet1",De="",ke=0,Fe={},ye=[],Be=[],X={s:{r:0,c:0},e:{r:0,c:0}},rt=Y.sheetRows||0;if(V[2]==0&&(V[3]==8||V[3]==9)&&V.length>=16&&V[14]==5&&V[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(V[2]==2)Y.Enum=ee,t(V,function(Ue,Jt,Cr){switch(Cr){case 0:Y.vers=Ue,Ue>=4096&&(Y.qpro=!0);break;case 6:X=Ue;break;case 204:Ue&&(De=Ue);break;case 222:De=Ue;break;case 15:case 51:Y.qpro||(Ue[1].v=Ue[1].v.slice(1));case 13:case 14:case 16:Cr==14&&(Ue[2]&112)==112&&(Ue[2]&15)>1&&(Ue[2]&15)<15&&(Ue[1].z=Y.dateNF||at[14],Y.cellDates&&(Ue[1].t="d",Ue[1].v=Lm(Ue[1].v))),Y.qpro&&Ue[3]>ke&&(te["!ref"]=vt(X),Fe[ce]=te,ye.push(ce),te=Y.dense?[]:{},X={s:{r:0,c:0},e:{r:0,c:0}},ke=Ue[3],ce=De||"Sheet"+(ke+1),De="");var Mr=Y.dense?(te[Ue[0].r]||[])[Ue[0].c]:te[ot(Ue[0])];if(Mr){Mr.t=Ue[1].t,Mr.v=Ue[1].v,Ue[1].z!=null&&(Mr.z=Ue[1].z),Ue[1].f!=null&&(Mr.f=Ue[1].f);break}Y.dense?(te[Ue[0].r]||(te[Ue[0].r]=[]),te[Ue[0].r][Ue[0].c]=Ue[1]):te[ot(Ue[0])]=Ue[1];break}},Y);else if(V[2]==26||V[2]==14)Y.Enum=ge,V[2]==14&&(Y.qpro=!0,V.l=0),t(V,function(Ue,Jt,Cr){switch(Cr){case 204:ce=Ue;break;case 22:Ue[1].v=Ue[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ue[3]>ke&&(te["!ref"]=vt(X),Fe[ce]=te,ye.push(ce),te=Y.dense?[]:{},X={s:{r:0,c:0},e:{r:0,c:0}},ke=Ue[3],ce="Sheet"+(ke+1)),rt>0&&Ue[0].r>=rt)break;Y.dense?(te[Ue[0].r]||(te[Ue[0].r]=[]),te[Ue[0].r][Ue[0].c]=Ue[1]):te[ot(Ue[0])]=Ue[1],X.e.c<Ue[0].c&&(X.e.c=Ue[0].c),X.e.r<Ue[0].r&&(X.e.r=Ue[0].r);break;case 27:Ue[14e3]&&(Be[Ue[14e3][0]]=Ue[14e3][1]);break;case 1537:Be[Ue[0]]=Ue[1],Ue[0]==ke&&(ce=Ue[1]);break}},Y);else throw new Error("Unrecognized LOTUS BOF "+V[2]);if(te["!ref"]=vt(X),Fe[De||ce]=te,ye.push(De||ce),!Be.length)return{SheetNames:ye,Sheets:Fe};for(var nt={},wt=[],ut=0;ut<Be.length;++ut)Fe[ye[ut]]?(wt.push(Be[ut]||ye[ut]),nt[Be[ut]]=Fe[Be[ut]]||Fe[ye[ut]]):(wt.push(Be[ut]),nt[Be[ut]]={"!ref":"A1"});return{SheetNames:wt,Sheets:nt}}function n(V,K){var Y=K||{};if(+Y.codepage>=0&&Ja(+Y.codepage),Y.type=="string")throw new Error("Cannot write WK1 to JS string");var te=na(),ce=Vt(V["!ref"]),De=Array.isArray(V),ke=[];qe(te,0,o(1030)),qe(te,6,f(ce));for(var Fe=Math.min(ce.e.r,8191),ye=ce.s.r;ye<=Fe;++ye)for(var Be=Pr(ye),X=ce.s.c;X<=ce.e.c;++X){ye===ce.s.r&&(ke[X]=vr(X));var rt=ke[X]+Be,nt=De?(V[ye]||[])[X]:V[rt];if(!(!nt||nt.t=="z"))if(nt.t=="n")(nt.v|0)==nt.v&&nt.v>=-32768&&nt.v<=32767?qe(te,13,E(ye,X,nt.v)):qe(te,14,w(ye,X,nt.v));else{var wt=_s(nt);qe(te,15,v(ye,X,wt.slice(0,239)))}}return qe(te,1),te.end()}function a(V,K){var Y=K||{};if(+Y.codepage>=0&&Ja(+Y.codepage),Y.type=="string")throw new Error("Cannot write WK3 to JS string");var te=na();qe(te,0,l(V));for(var ce=0,De=0;ce<V.SheetNames.length;++ce)(V.Sheets[V.SheetNames[ce]]||{})["!ref"]&&qe(te,27,ie(V.SheetNames[ce],De++));var ke=0;for(ce=0;ce<V.SheetNames.length;++ce){var Fe=V.Sheets[V.SheetNames[ce]];if(!(!Fe||!Fe["!ref"])){for(var ye=Vt(Fe["!ref"]),Be=Array.isArray(Fe),X=[],rt=Math.min(ye.e.r,8191),nt=ye.s.r;nt<=rt;++nt)for(var wt=Pr(nt),ut=ye.s.c;ut<=ye.e.c;++ut){nt===ye.s.r&&(X[ut]=vr(ut));var Ue=X[ut]+wt,Jt=Be?(Fe[nt]||[])[ut]:Fe[Ue];if(!(!Jt||Jt.t=="z"))if(Jt.t=="n")qe(te,23,O(nt,ut,ke,Jt.v));else{var Cr=_s(Jt);qe(te,22,k(nt,ut,ke,Cr.slice(0,239)))}}++ke}}return qe(te,1),te.end()}function o(V){var K=Se(2);return K.write_shift(2,V),K}function l(V){var K=Se(26);K.write_shift(2,4096),K.write_shift(2,4),K.write_shift(4,0);for(var Y=0,te=0,ce=0,De=0;De<V.SheetNames.length;++De){var ke=V.SheetNames[De],Fe=V.Sheets[ke];if(!(!Fe||!Fe["!ref"])){++ce;var ye=aa(Fe["!ref"]);Y<ye.e.r&&(Y=ye.e.r),te<ye.e.c&&(te=ye.e.c)}}return Y>8191&&(Y=8191),K.write_shift(2,Y),K.write_shift(1,ce),K.write_shift(1,te),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(1,1),K.write_shift(1,2),K.write_shift(4,0),K.write_shift(4,0),K}function u(V,K,Y){var te={s:{c:0,r:0},e:{c:0,r:0}};return K==8&&Y.qpro?(te.s.c=V.read_shift(1),V.l++,te.s.r=V.read_shift(2),te.e.c=V.read_shift(1),V.l++,te.e.r=V.read_shift(2),te):(te.s.c=V.read_shift(2),te.s.r=V.read_shift(2),K==12&&Y.qpro&&(V.l+=2),te.e.c=V.read_shift(2),te.e.r=V.read_shift(2),K==12&&Y.qpro&&(V.l+=2),te.s.c==65535&&(te.s.c=te.e.c=te.s.r=te.e.r=0),te)}function f(V){var K=Se(8);return K.write_shift(2,V.s.c),K.write_shift(2,V.s.r),K.write_shift(2,V.e.c),K.write_shift(2,V.e.r),K}function d(V,K,Y){var te=[{c:0,r:0},{t:"n",v:0},0,0];return Y.qpro&&Y.vers!=20768?(te[0].c=V.read_shift(1),te[3]=V.read_shift(1),te[0].r=V.read_shift(2),V.l+=2):(te[2]=V.read_shift(1),te[0].c=V.read_shift(2),te[0].r=V.read_shift(2)),te}function m(V,K,Y){var te=V.l+K,ce=d(V,K,Y);if(ce[1].t="s",Y.vers==20768){V.l++;var De=V.read_shift(1);return ce[1].v=V.read_shift(De,"utf8"),ce}return Y.qpro&&V.l++,ce[1].v=V.read_shift(te-V.l,"cstr"),ce}function v(V,K,Y){var te=Se(7+Y.length);te.write_shift(1,255),te.write_shift(2,K),te.write_shift(2,V),te.write_shift(1,39);for(var ce=0;ce<te.length;++ce){var De=Y.charCodeAt(ce);te.write_shift(1,De>=128?95:De)}return te.write_shift(1,0),te}function _(V,K,Y){var te=d(V,K,Y);return te[1].v=V.read_shift(2,"i"),te}function E(V,K,Y){var te=Se(7);return te.write_shift(1,255),te.write_shift(2,K),te.write_shift(2,V),te.write_shift(2,Y,"i"),te}function S(V,K,Y){var te=d(V,K,Y);return te[1].v=V.read_shift(8,"f"),te}function w(V,K,Y){var te=Se(13);return te.write_shift(1,255),te.write_shift(2,K),te.write_shift(2,V),te.write_shift(8,Y,"f"),te}function b(V,K,Y){var te=V.l+K,ce=d(V,K,Y);if(ce[1].v=V.read_shift(8,"f"),Y.qpro)V.l=te;else{var De=V.read_shift(2);z(V.slice(V.l,V.l+De),ce),V.l+=De}return ce}function L(V,K,Y){var te=K&32768;return K&=-32769,K=(te?V:0)+(K>=8192?K-16384:K),(te?"":"$")+(Y?vr(K):Pr(K))}var B={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},F=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function z(V,K){_n(V,0);for(var Y=[],te=0,ce="",De="",ke="",Fe="";V.l<V.length;){var ye=V[V.l++];switch(ye){case 0:Y.push(V.read_shift(8,"f"));break;case 1:De=L(K[0].c,V.read_shift(2),!0),ce=L(K[0].r,V.read_shift(2),!1),Y.push(De+ce);break;case 2:{var Be=L(K[0].c,V.read_shift(2),!0),X=L(K[0].r,V.read_shift(2),!1);De=L(K[0].c,V.read_shift(2),!0),ce=L(K[0].r,V.read_shift(2),!1),Y.push(Be+X+":"+De+ce)}break;case 3:if(V.l<V.length){console.error("WK1 premature formula end");return}break;case 4:Y.push("("+Y.pop()+")");break;case 5:Y.push(V.read_shift(2));break;case 6:{for(var rt="";ye=V[V.l++];)rt+=String.fromCharCode(ye);Y.push('"'+rt.replace(/"/g,'""')+'"')}break;case 8:Y.push("-"+Y.pop());break;case 23:Y.push("+"+Y.pop());break;case 22:Y.push("NOT("+Y.pop()+")");break;case 20:case 21:Fe=Y.pop(),ke=Y.pop(),Y.push(["AND","OR"][ye-20]+"("+ke+","+Fe+")");break;default:if(ye<32&&F[ye])Fe=Y.pop(),ke=Y.pop(),Y.push(ke+F[ye]+Fe);else if(B[ye]){if(te=B[ye][1],te==69&&(te=V[V.l++]),te>Y.length){console.error("WK1 bad formula parse 0x"+ye.toString(16)+":|"+Y.join("|")+"|");return}var nt=Y.slice(-te);Y.length-=te,Y.push(B[ye][0]+"("+nt.join(",")+")")}else return ye<=7?console.error("WK1 invalid opcode "+ye.toString(16)):ye<=24?console.error("WK1 unsupported op "+ye.toString(16)):ye<=30?console.error("WK1 invalid opcode "+ye.toString(16)):ye<=115?console.error("WK1 unsupported function opcode "+ye.toString(16)):console.error("WK1 unrecognized opcode "+ye.toString(16))}}Y.length==1?K[1].f=""+Y[0]:console.error("WK1 bad formula parse |"+Y.join("|")+"|")}function q(V){var K=[{c:0,r:0},{t:"n",v:0},0];return K[0].r=V.read_shift(2),K[3]=V[V.l++],K[0].c=V[V.l++],K}function W(V,K){var Y=q(V);return Y[1].t="s",Y[1].v=V.read_shift(K-4,"cstr"),Y}function k(V,K,Y,te){var ce=Se(6+te.length);ce.write_shift(2,V),ce.write_shift(1,Y),ce.write_shift(1,K),ce.write_shift(1,39);for(var De=0;De<te.length;++De){var ke=te.charCodeAt(De);ce.write_shift(1,ke>=128?95:ke)}return ce.write_shift(1,0),ce}function I(V,K){var Y=q(V);Y[1].v=V.read_shift(2);var te=Y[1].v>>1;if(Y[1].v&1)switch(te&7){case 0:te=(te>>3)*5e3;break;case 1:te=(te>>3)*500;break;case 2:te=(te>>3)/20;break;case 3:te=(te>>3)/200;break;case 4:te=(te>>3)/2e3;break;case 5:te=(te>>3)/2e4;break;case 6:te=(te>>3)/16;break;case 7:te=(te>>3)/64;break}return Y[1].v=te,Y}function A(V,K){var Y=q(V),te=V.read_shift(4),ce=V.read_shift(4),De=V.read_shift(2);if(De==65535)return te===0&&ce===3221225472?(Y[1].t="e",Y[1].v=15):te===0&&ce===3489660928?(Y[1].t="e",Y[1].v=42):Y[1].v=0,Y;var ke=De&32768;return De=(De&32767)-16446,Y[1].v=(1-ke*2)*(ce*Math.pow(2,De+32)+te*Math.pow(2,De)),Y}function O(V,K,Y,te){var ce=Se(14);if(ce.write_shift(2,V),ce.write_shift(1,Y),ce.write_shift(1,K),te==0)return ce.write_shift(4,0),ce.write_shift(4,0),ce.write_shift(2,65535),ce;var De=0,ke=0,Fe=0,ye=0;return te<0&&(De=1,te=-te),ke=Math.log2(te)|0,te/=Math.pow(2,ke-31),ye=te>>>0,(ye&2147483648)==0&&(te/=2,++ke,ye=te>>>0),te-=ye,ye|=2147483648,ye>>>=0,te*=Math.pow(2,32),Fe=te>>>0,ce.write_shift(4,Fe),ce.write_shift(4,ye),ke+=16383+(De?32768:0),ce.write_shift(2,ke),ce}function M(V,K){var Y=A(V);return V.l+=K-14,Y}function N(V,K){var Y=q(V),te=V.read_shift(4);return Y[1].v=te>>6,Y}function D(V,K){var Y=q(V),te=V.read_shift(8,"f");return Y[1].v=te,Y}function he(V,K){var Y=D(V);return V.l+=K-10,Y}function we(V,K){return V[V.l+K-1]==0?V.read_shift(K,"cstr"):""}function ne(V,K){var Y=V[V.l++];Y>K-1&&(Y=K-1);for(var te="";te.length<Y;)te+=String.fromCharCode(V[V.l++]);return te}function ue(V,K,Y){if(!(!Y.qpro||K<21)){var te=V.read_shift(1);V.l+=17,V.l+=1,V.l+=2;var ce=V.read_shift(K-21,"cstr");return[te,ce]}}function Ve(V,K){for(var Y={},te=V.l+K;V.l<te;){var ce=V.read_shift(2);if(ce==14e3){for(Y[ce]=[0,""],Y[ce][0]=V.read_shift(2);V[V.l];)Y[ce][1]+=String.fromCharCode(V[V.l]),V.l++;V.l++}}return Y}function ie(V,K){var Y=Se(5+V.length);Y.write_shift(2,14e3),Y.write_shift(2,K);for(var te=0;te<V.length;++te){var ce=V.charCodeAt(te);Y[Y.l++]=ce>127?95:ce}return Y[Y.l++]=0,Y}var ee={0:{n:"BOF",f:Gr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:_},14:{n:"NUMBER",f:S},15:{n:"LABEL",f:m},16:{n:"FORMULA",f:b},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:m},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:we},222:{n:"SHEETNAMELP",f:ne},65535:{n:""}},ge={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:W},23:{n:"NUMBER17",f:A},24:{n:"NUMBER18",f:I},25:{n:"FORMULA19",f:M},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Ve},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:N},38:{n:"??"},39:{n:"NUMBER27",f:D},40:{n:"FORMULA28",f:he},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:we},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ue},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:e}}();function x9(t){var e={},r=t.match(Mn),n=0,a=!1;if(r)for(;n!=r.length;++n){var o=dt(r[n]);switch(o[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(o.val=="1")break;e.cp=mv[parseInt(o.val,10)];break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=o.val;break;case"<sz":e.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(o.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(o.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":o.rgb&&(e.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(o[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+o[0])}}return e}var v9=function(){var t=Jf("t"),e=Jf("rPr");function r(o){var l=o.match(t);if(!l)return{t:"s",v:""};var u={t:"s",v:Bt(l[1])},f=o.match(e);return f&&(u.s=x9(f[1])),u}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(l){return l.replace(n,"").split(a).map(r).filter(function(u){return u.v})}}(),_9=function(){var e=/(\r\n|\n)/g;function r(a,o,l){var u=[];a.u&&u.push("text-decoration: underline;"),a.uval&&u.push("text-underline-style:"+a.uval+";"),a.sz&&u.push("font-size:"+a.sz+"pt;"),a.outline&&u.push("text-effect: outline;"),a.shadow&&u.push("text-shadow: auto;"),o.push('<span style="'+u.join("")+'">'),a.b&&(o.push("<b>"),l.push("</b>")),a.i&&(o.push("<i>"),l.push("</i>")),a.strike&&(o.push("<s>"),l.push("</s>"));var f=a.valign||"";return f=="superscript"||f=="super"?f="sup":f=="subscript"&&(f="sub"),f!=""&&(o.push("<"+f+">"),l.push("</"+f+">")),l.push("</span>"),a}function n(a){var o=[[],a.v,[]];return a.v?(a.s&&r(a.s,o[0],o[2]),o[0].join("")+o[1].replace(e,"<br/>")+o[2].join("")):""}return function(o){return o.map(n).join("")}}(),y9=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,w9=/<(?:\w+:)?r>/,E9=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Uv(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Bt(ar(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=ar(t),r&&(n.h=bv(n.t))):t.match(w9)&&(n.r=ar(t),n.t=Bt(ar((t.replace(E9,"").match(y9)||[]).join("").replace(Mn,""))),r&&(n.h=_9(v9(n.r)))),n):{t:""}}var T9=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,b9=/<(?:\w+:)?(?:si|sstItem)>/g,S9=/<\/(?:\w+:)?(?:si|sstItem)>/;function A9(t,e){var r=[],n="";if(!t)return r;var a=t.match(T9);if(a){n=a[2].replace(b9,"").split(S9);for(var o=0;o!=n.length;++o){var l=Uv(n[o].trim(),e);l!=null&&(r[r.length]=l)}a=dt(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var k9=/^\s|\s$|[\t\n\r]/;function _4(t,e){if(!e.bookSST)return"";var r=[Lr];r[r.length]=ze("sst",null,{xmlns:Pl[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var a=t[n],o="<si>";a.r?o+=a.r:(o+="<t",a.t||(a.t=""),a.t.match(k9)&&(o+=' xml:space="preserve"'),o+=">"+Zt(a.t)+"</t>"),o+="</si>",r[r.length]=o}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function C9(t){return[t.read_shift(4),t.read_shift(4)]}function R9(t,e){var r=[],n=!1;return ws(t,function(o,l,u){switch(u){case 159:r.Count=o[0],r.Unique=o[1];break;case 19:r.push(o);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(l.T,!n||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function N9(t,e){return e||(e=Se(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var I9=jP;function D9(t){var e=na();Pe(e,159,N9(t));for(var r=0;r<t.length;++r)Pe(e,19,I9(t[r]));return Pe(e,160),e.end()}function y4(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function ms(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function O9(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=ms(t,4),e.U=ms(t,4),e.W=ms(t,4),e}function F9(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},a=t.read_shift(4),o=[];a-- >0;)o.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=o,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function P9(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(F9(t));return e}function L9(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function M9(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=ms(t,4),e.U=ms(t,4),e.W=ms(t,4),e}function U9(t){var e=M9(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function w4(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function E4(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function B9(t){var e=ms(t);switch(e.Minor){case 2:return[e.Minor,V9(t)];case 3:return[e.Minor,j9()];case 4:return[e.Minor,H9(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function V9(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=w4(t,r),a=E4(t,t.length-t.l);return{t:"Std",h:n,v:a}}function j9(){throw new Error("File is password-protected: ECMA-376 Extensible")}function H9(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(Mn,function(o){var l=dt(o);switch(Vi(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(u){n[u]=l[u]});break;case"<dataIntegrity":n.encryptedHmacKey=l.encryptedHmacKey,n.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(l);break;default:throw l[0]}}),n}function z9(t,e){var r={},n=r.EncryptionVersionInfo=ms(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var a=t.read_shift(4);return e-=4,r.EncryptionHeader=w4(t,a),e-=a,r.EncryptionVerifier=E4(t,e),r}function G9(t){var e={},r=e.EncryptionVersionInfo=ms(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function Bv(t){var e=0,r,n=y4(t),a=n.length+1,o,l,u,f,d;for(r=wo(a),r[0]=n.length,o=1;o!=a;++o)r[o]=n[o-1];for(o=a-1;o>=0;--o)l=r[o],u=(e&16384)===0?0:1,f=e<<1&32767,d=u|f,e=d^l;return e^52811}var T4=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(l){return(l/2|l*128)&255},a=function(l,u){return n(l^u)},o=function(l){for(var u=e[l.length-1],f=104,d=l.length-1;d>=0;--d)for(var m=l[d],v=0;v!=7;++v)m&64&&(u^=r[f]),m*=2,--f;return u};return function(l){for(var u=y4(l),f=o(u),d=u.length,m=wo(16),v=0;v!=16;++v)m[v]=0;var _,E,S;for((d&1)===1&&(_=f>>8,m[d]=a(t[0],_),--d,_=f&255,E=u[u.length-1],m[d]=a(E,_));d>0;)--d,_=f>>8,m[d]=a(u[d],_),--d,_=f&255,m[d]=a(u[d],_);for(d=15,S=15-u.length;S>0;)_=f>>8,m[d]=a(t[S],_),--d,--S,_=f&255,m[d]=a(u[d],_),--d,--S;return m}}(),q9=function(t,e,r,n,a){a||(a=e),n||(n=T4(t));var o,l;for(o=0;o!=e.length;++o)l=e[o],l^=n[r],l=(l>>5|l<<3)&255,a[o]=l,++r;return[a,r,n]},W9=function(t){var e=0,r=T4(t);return function(n){var a=q9("",n,e,r);return e=a[1],a[0]}};function X9(t,e,r,n){var a={key:Gr(t),verificationBytes:Gr(t)};return r.password&&(a.verifier=Bv(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=W9(r.password)),a}function K9(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=G9(t):n.Data=z9(t,e),n}function Y9(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?K9(t,e-2,n):X9(t,r.biff>=8?e:e-2,r,n),n}var b4=function(){function t(a,o){switch(o.type){case"base64":return e(wa(a),o);case"binary":return e(a,o);case"buffer":return e(bt&&Buffer.isBuffer(a)?a.toString("binary"):No(a),o);case"array":return e(Sl(a),o)}throw new Error("Unrecognized type "+o.type)}function e(a,o){var l=o||{},u=l.dense?[]:{},f=a.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(m,v){Array.isArray(u)&&(u[v]=[]);for(var _=/\\\w+\b/g,E=0,S,w=-1;S=_.exec(m);){switch(S[0]){case"\\cell":var b=m.slice(E,_.lastIndex-S[0].length);if(b[0]==" "&&(b=b.slice(1)),++w,b.length){var L={v:b,t:"s"};Array.isArray(u)?u[v][w]=L:u[ot({r:v,c:w})]=L}break}E=_.lastIndex}w>d.e.c&&(d.e.c=w)}),u["!ref"]=vt(d),u}function r(a,o){return Io(t(a,o),o)}function n(a){for(var o=["{\\rtf1\\ansi"],l=Vt(a["!ref"]),u,f=Array.isArray(a),d=l.s.r;d<=l.e.r;++d){o.push("\\trowd\\trautofit1");for(var m=l.s.c;m<=l.e.c;++m)o.push("\\cellx"+(m+1));for(o.push("\\pard\\intbl"),m=l.s.c;m<=l.e.c;++m){var v=ot({r:d,c:m});u=f?(a[d]||[])[m]:a[v],!(!u||u.v==null&&(!u.f||u.F))&&(o.push(" "+(u.w||(_s(u),u.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function $9(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function n0(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function Q9(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,a=Math.max(e,r,n),o=Math.min(e,r,n),l=a-o;if(l===0)return[0,0,e];var u=0,f=0,d=a+o;switch(f=l/(d>1?2-d:d),a){case e:u=((r-n)/l+6)%6;break;case r:u=(n-e)/l+2;break;case n:u=(e-r)/l+4;break}return[u/6,f,d/2]}function Z9(t){var e=t[0],r=t[1],n=t[2],a=r*2*(n<.5?n:1-n),o=n-a/2,l=[o,o,o],u=6*e,f;if(r!==0)switch(u|0){case 0:case 6:f=a*u,l[0]+=a,l[1]+=f;break;case 1:f=a*(2-u),l[0]+=f,l[1]+=a;break;case 2:f=a*(u-2),l[1]+=a,l[2]+=f;break;case 3:f=a*(4-u),l[1]+=f,l[2]+=a;break;case 4:f=a*(u-4),l[2]+=a,l[0]+=f;break;case 5:f=a*(6-u),l[2]+=f,l[0]+=a;break}for(var d=0;d!=3;++d)l[d]=Math.round(l[d]*255);return l}function im(t,e){if(e===0)return t;var r=Q9($9(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),n0(Z9(r))}var S4=6,J9=15,e7=1,Dn=S4;function a0(t){return Math.floor((t+Math.round(128/Dn)/256)*Dn)}function i0(t){return Math.floor((t-5)/Dn*100+.5)/100}function sm(t){return Math.round((t*Dn+5)/Dn*256)/256}function o1(t){return sm(i0(a0(t)))}function Vv(t){var e=Math.abs(t-o1(t)),r=Dn;if(e>.005)for(Dn=e7;Dn<J9;++Dn)Math.abs(t-o1(t))<=e&&(e=Math.abs(t-o1(t)),r=Dn);Dn=r}function Eo(t){t.width?(t.wpx=a0(t.width),t.wch=i0(t.wpx),t.MDW=Dn):t.wpx?(t.wch=i0(t.wpx),t.width=sm(t.wch),t.MDW=Dn):typeof t.wch=="number"&&(t.width=sm(t.wch),t.wpx=a0(t.width),t.MDW=Dn),t.customWidth&&delete t.customWidth}var t7=96,A4=t7;function s0(t){return t*96/A4}function tu(t){return t*A4/96}var r7={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function n7(t,e,r,n){e.Borders=[];var a={},o=!1;(t[0].match(Mn)||[]).forEach(function(l){var u=dt(l);switch(Vi(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},u.diagonalUp&&(a.diagonalUp=ur(u.diagonalUp)),u.diagonalDown&&(a.diagonalDown=ur(u.diagonalDown)),e.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+u[0]+" in borders")}})}function a7(t,e,r,n){e.Fills=[];var a={},o=!1;(t[0].match(Mn)||[]).forEach(function(l){var u=dt(l);switch(Vi(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},e.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":u.patternType&&(a.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),u.indexed&&(a.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(a.bgColor.theme=parseInt(u.theme,10)),u.tint&&(a.bgColor.tint=parseFloat(u.tint)),u.rgb&&(a.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),u.theme&&(a.fgColor.theme=parseInt(u.theme,10)),u.tint&&(a.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(a.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+u[0]+" in fills")}})}function i7(t,e,r,n){e.Fonts=[];var a={},o=!1;(t[0].match(Mn)||[]).forEach(function(l){var u=dt(l);switch(Vi(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(a),a={};break;case"<name":u.val&&(a.name=ar(u.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=u.val?ur(u.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=u.val?ur(u.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(u.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=u.val?ur(u.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=u.val?ur(u.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=u.val?ur(u.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=u.val?ur(u.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=u.val?ur(u.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":u.val&&(a.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(a.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(a.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(a.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=mv[parseInt(u.val,10)];break;case"<color":if(a.color||(a.color={}),u.auto&&(a.color.auto=ur(u.auto)),u.rgb)a.color.rgb=u.rgb.slice(-6);else if(u.indexed){a.color.index=parseInt(u.indexed,10);var f=hl[a.color.index];a.color.index==81&&(f=hl[1]),f||(f=hl[1]),a.color.rgb=f[0].toString(16)+f[1].toString(16)+f[2].toString(16)}else u.theme&&(a.color.theme=parseInt(u.theme,10),u.tint&&(a.color.tint=parseFloat(u.tint)),u.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=im(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":o=!0;break;case"</AlternateContent>":o=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+u[0]+" in fonts")}})}function s7(t,e,r){e.NumberFmt=[];for(var n=Ar(at),a=0;a<n.length;++a)e.NumberFmt[n[a]]=at[n[a]];var o=t[0].match(Mn);if(o)for(a=0;a<o.length;++a){var l=dt(o[a]);switch(Vi(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=Bt(ar(l.formatCode)),f=parseInt(l.numFmtId,10);if(e.NumberFmt[f]=u,f>0){if(f>392){for(f=392;f>60&&e.NumberFmt[f]!=null;--f);e.NumberFmt[f]=u}Mi(u,f)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}function o7(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=ze("numFmt",null,{numFmtId:n,formatCode:Zt(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=ze("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var hd=["numFmtId","fillId","fontId","borderId","xfId"],dd=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function l7(t,e,r){e.CellXf=[];var n,a=!1;(t[0].match(Mn)||[]).forEach(function(o){var l=dt(o),u=0;switch(Vi(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=l,delete n[0],u=0;u<hd.length;++u)n[hd[u]]&&(n[hd[u]]=parseInt(n[hd[u]],10));for(u=0;u<dd.length;++u)n[dd[u]]&&(n[dd[u]]=ur(n[dd[u]]));if(e.NumberFmt&&n.numFmtId>392){for(u=392;u>60;--u)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[u]){n.numFmtId=u;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var f={};l.vertical&&(f.vertical=l.vertical),l.horizontal&&(f.horizontal=l.horizontal),l.textRotation!=null&&(f.textRotation=l.textRotation),l.indent&&(f.indent=l.indent),l.wrapText&&(f.wrapText=ur(l.wrapText)),n.alignment=f;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}function c7(t){var e=[];return e[e.length]=ze("cellXfs",null),t.forEach(function(r){e[e.length]=ze("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=ze("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var u7=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,o=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,f,d){var m={};if(!u)return m;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var v;return(v=u.match(e))&&s7(v,m,d),(v=u.match(a))&&i7(v,m,f,d),(v=u.match(n))&&a7(v,m,f,d),(v=u.match(o))&&n7(v,m,f,d),(v=u.match(r))&&l7(v,m,d),m}}();function k4(t,e){var r=[Lr,ze("styleSheet",null,{xmlns:Pl[0],"xmlns:vt":Zr.vt})],n;return t.SSF&&(n=o7(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=c7(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function f7(t,e){var r=t.read_shift(2),n=Fn(t);return[r,n]}function h7(t,e,r){r||(r=Se(6+4*e.length)),r.write_shift(2,t),fn(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function d7(t,e,r){var n={};n.sz=t.read_shift(2)/20;var a=KP(t);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var o=t.read_shift(2);switch(o===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var l=t.read_shift(1);l!=0&&(n.underline=l);var u=t.read_shift(1);u>0&&(n.family=u);var f=t.read_shift(1);switch(f>0&&(n.charset=f),t.l++,n.color=XP(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Fn(t),n}function m7(t,e){e||(e=Se(25+4*32)),e.write_shift(2,t.sz*20),YP(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),rm(t.color,e);var n=0;return n=2,e.write_shift(1,n),fn(t.name,e),e.length>e.l?e.slice(0,e.l):e}var p7=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],l1,g7=Ln;function XT(t,e){e||(e=Se(4*3+8*7+16*1)),l1||(l1=Fm(p7));var r=l1[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(rm({auto:1},e),rm({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function x7(t,e){var r=t.l+e,n=t.read_shift(2),a=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:a}}function C4(t,e,r){r||(r=Se(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function mf(t,e){return e||(e=Se(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var v7=Ln;function _7(t,e){return e||(e=Se(51)),e.write_shift(1,0),mf(null,e),mf(null,e),mf(null,e),mf(null,e),mf(null,e),e.length>e.l?e.slice(0,e.l):e}function y7(t,e){return e||(e=Se(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),tm(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function w7(t,e,r){var n=Se(2052);return n.write_shift(4,t),tm(e,n),tm(r,n),n.length>n.l?n.slice(0,n.l):n}function E7(t,e,r){var n={};n.NumberFmt=[];for(var a in at)n.NumberFmt[a]=at[a];n.CellXf=[],n.Fonts=[];var o=[],l=!1;return ws(t,function(f,d,m){switch(m){case 44:n.NumberFmt[f[0]]=f[1],Mi(f[1],f[0]);break;case 43:n.Fonts.push(f),f.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(f.color.rgb=im(e.themeElements.clrScheme[f.color.theme].rgb,f.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:o[o.length-1]==617&&n.CellXf.push(f);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:o.push(m),l=!0;break;case 38:o.pop(),l=!1;break;default:if(d.T>0)o.push(m);else if(d.T<0)o.pop();else if(!l||r.WTF&&o[o.length-1]!=37)throw new Error("Unexpected record 0x"+m.toString(16))}}),n}function T7(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&++r}),r!=0&&(Pe(t,615,ni(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&Pe(t,44,h7(a,e[a]))}),Pe(t,616))}}function b7(t){var e=1;Pe(t,611,ni(e)),Pe(t,43,m7({sz:12,color:{theme:1},name:"Calibri",family:2})),Pe(t,612)}function S7(t){var e=2;Pe(t,603,ni(e)),Pe(t,45,XT({patternType:"none"})),Pe(t,45,XT({patternType:"gray125"})),Pe(t,604)}function A7(t){var e=1;Pe(t,613,ni(e)),Pe(t,46,_7()),Pe(t,614)}function k7(t){var e=1;Pe(t,626,ni(e)),Pe(t,47,C4({numFmtId:0},65535)),Pe(t,627)}function C7(t,e){Pe(t,617,ni(e.length)),e.forEach(function(r){Pe(t,47,C4(r,0))}),Pe(t,618)}function R7(t){var e=1;Pe(t,619,ni(e)),Pe(t,48,y7({xfId:0,name:"Normal"})),Pe(t,620)}function N7(t){var e=0;Pe(t,505,ni(e)),Pe(t,506)}function I7(t){var e=0;Pe(t,508,w7(e,"TableStyleMedium9","PivotStyleMedium4")),Pe(t,509)}function D7(t,e){var r=na();return Pe(r,278),T7(r,t.SSF),b7(r),S7(r),A7(r),k7(r),C7(r,e.cellXfs),R7(r),N7(r),I7(r),Pe(r,279),r.end()}var O7=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function F7(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(Mn)||[]).forEach(function(a){var o=dt(a);switch(o[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=o.val;break;case"<a:sysClr":n.rgb=o.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":o[0].charAt(1)==="/"?(e.themeElements.clrScheme[O7.indexOf(o[0])]=n,n={}):n.name=o[0].slice(3,o[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+o[0]+" in clrScheme")}})}function P7(){}function L7(){}var M7=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,U7=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,B7=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function V7(t,e,r){e.themeElements={};var n;[["clrScheme",M7,F7],["fontScheme",U7,P7],["fmtScheme",B7,L7]].forEach(function(a){if(!(n=t.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,e,r)})}var j7=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function R4(t,e){(!t||t.length===0)&&(t=jv());var r,n={};if(!(r=t.match(j7)))throw new Error("themeElements not found in theme");return V7(r[0],n,e),n.raw=t,n}function jv(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[Lr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function H7(t,e,r){var n=t.l+e,a=t.read_shift(4);if(a!==124226){if(!r.cellStyles){t.l=n;return}var o=t.slice(t.l);t.l=n;var l;try{l=wk(o,{type:"array"})}catch{return}var u=va(l,"theme/theme/theme1.xml",!0);if(u)return R4(u,r)}}function z7(t){return t.read_shift(4)}function G7(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=q7(t,4);break;case 2:e.xclrValue=l4(t);break;case 3:e.xclrValue=z7(t);break;case 4:t.l+=4;break}return t.l+=8,e}function q7(t,e){return Ln(t,e)}function W7(t,e){return Ln(t,e)}function X7(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=G7(t);break;case 6:n[1]=W7(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function K7(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var a=t.read_shift(2),o=[];a-- >0;)o.push(X7(t,r-t.l));return{ixfe:n,ext:o}}function Y7(t,e){e.forEach(function(r){r[0]})}function $7(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:Fn(t)}}function Q7(t){var e=Se(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),fn(t.name,e),e.slice(0,e.l)}function Z7(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function J7(t){var e=Se(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function eU(t,e){var r=Se(8+2*e.length);return r.write_shift(4,t),fn(e,r),r.slice(0,r.l)}function tU(t){return t.l+=4,t.read_shift(4)!=0}function rU(t,e){var r=Se(8);return r.write_shift(4,t),r.write_shift(4,1),r}function nU(t,e,r){var n={Types:[],Cell:[],Value:[]},a=r||{},o=[],l=!1,u=2;return ws(t,function(f,d,m){switch(m){case 335:n.Types.push({name:f.name});break;case 51:f.forEach(function(v){u==1?n.Cell.push({type:n.Types[v[0]-1].name,index:v[1]}):u==0&&n.Value.push({type:n.Types[v[0]-1].name,index:v[1]})});break;case 337:u=f?1:0;break;case 338:u=2;break;case 35:o.push(m),l=!0;break;case 36:o.pop(),l=!1;break;default:if(!d.T){if(!l||a.WTF&&o[o.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}}),n}function aU(){var t=na();return Pe(t,332),Pe(t,334,ni(1)),Pe(t,335,Q7({name:"XLDAPR",version:12e4,flags:3496657072})),Pe(t,336),Pe(t,339,eU(1,"XLDAPR")),Pe(t,52),Pe(t,35,ni(514)),Pe(t,4096,ni(0)),Pe(t,4097,Va(1)),Pe(t,36),Pe(t,53),Pe(t,340),Pe(t,337,rU(1)),Pe(t,51,J7([[1,0]])),Pe(t,338),Pe(t,333),t.end()}function iU(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var a=!1,o=2,l;return t.replace(Mn,function(u){var f=dt(u);switch(Vi(f[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:f.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<n.Types.length;++d)n.Types[d].name==f.name&&(l=n.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":o==1?n.Cell.push({type:n.Types[f.t-1].name,index:+f.v}):o==0&&n.Value.push({type:n.Types[f.t-1].name,index:+f.v});break;case"</rc>":break;case"<cellMetadata":o=1;break;case"</cellMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"</valueMetadata>":o=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+f.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+f[0]+" in metadata")}return u}),n}function N4(){var t=[Lr];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function sU(t){var e=[];if(!t)return e;var r=1;return(t.match(Mn)||[]).forEach(function(n){var a=dt(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,e.push(a);break}}),e}function oU(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=ot(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function lU(t,e,r){var n=[];return ws(t,function(o,l,u){switch(u){case 63:n.push(o);break;default:if(!l.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function cU(t,e,r,n){if(!t)return t;var a=n||{},o=!1;ws(t,function(u,f,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!f.T){if(!o||a.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},a)}function uU(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var Lc=1024;function I4(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[ze("xml",null,{"xmlns:v":ma.v,"xmlns:o":ma.o,"xmlns:x":ma.x,"xmlns:mv":ma.mv}).replace(/\/>/,">"),ze("o:shapelayout",ze("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),ze("v:shapetype",[ze("v:stroke",null,{joinstyle:"miter"}),ze("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Lc<t*1e3;)Lc+=1e3;return e.forEach(function(o){var l=_r(o[0]),u={color2:"#BEFF82",type:"gradient"};u.type=="gradient"&&(u.angle="-180");var f=u.type=="gradient"?ze("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=ze("v:fill",f,u),m={on:"t",obscured:"t"};++Lc,a=a.concat(["<v:shape"+e0({id:"_x0000_s"+Lc,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(o[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,ze("v:shadow",null,m),ze("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",wn("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),wn("x:AutoFill","False"),wn("x:Row",String(l.r)),wn("x:Column",String(l.c)),o[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function KT(t,e,r,n){var a=Array.isArray(t),o;e.forEach(function(l){var u=_r(l.ref);if(a?(t[u.r]||(t[u.r]=[]),o=t[u.r][u.c]):o=t[l.ref],!o){o={t:"z"},a?t[u.r][u.c]=o:t[l.ref]=o;var f=Vt(t["!ref"]||"BDWGO1000001:A1");f.s.r>u.r&&(f.s.r=u.r),f.e.r<u.r&&(f.e.r=u.r),f.s.c>u.c&&(f.s.c=u.c),f.e.c<u.c&&(f.e.c=u.c);var d=vt(f);d!==t["!ref"]&&(t["!ref"]=d)}o.c||(o.c=[]);var m={a:l.author,t:l.t,r:l.r,T:r};l.h&&(m.h=l.h);for(var v=o.c.length-1;v>=0;--v){if(!r&&o.c[v].T)return;r&&!o.c[v].T&&o.c.splice(v,1)}if(r&&n){for(v=0;v<n.length;++v)if(m.a==n[v].id){m.a=n[v].name||m.a;break}}o.c.push(m)})}function fU(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var u=l.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&r.push(u[1])}});var o=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return o&&o[1]&&o[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var u=l.match(/<(?:\w+:)?comment[^>]*>/);if(u){var f=dt(u[0]),d={author:f.authorId&&r[f.authorId]||"sheetjsghost",ref:f.ref,guid:f.guid},m=_r(f.ref);if(!(e.sheetRows&&e.sheetRows<=m.r)){var v=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),_=!!v&&!!v[1]&&Uv(v[1])||{r:"",t:"",h:""};d.r=_.r,_.r=="<t></t>"&&(_.t=_.h=""),d.t=(_.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(d.h=_.h),n.push(d)}}}}),n}function D4(t){var e=[Lr,ze("comments",null,{xmlns:Pl[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(a){var o=Zt(a.a);r.indexOf(o)==-1&&(r.push(o),e.push("<author>"+o+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),e.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var a=0,o=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(f){f.a&&(a=r.indexOf(Zt(f.a))),o.push(f.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),o.length<=1)e.push(wn("t",Zt(o[0]||"")));else{for(var l=`Comment:
    `+o[0]+`
`,u=1;u<o.length;++u)l+=`Reply:
    `+o[u]+`
`;e.push(wn("t",Zt(l)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function hU(t,e){var r=[],n=!1,a={},o=0;return t.replace(Mn,function(u,f){var d=dt(u);switch(Vi(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":o=f+u.length;break;case"</text>":a.t=t.slice(o,f).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return u}),r}function dU(t,e,r){var n=[Lr,ze("ThreadedComments",null,{xmlns:Zr.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(a){var o="";(a[1]||[]).forEach(function(l,u){if(!l.T){delete l.ID;return}l.a&&e.indexOf(l.a)==-1&&e.push(l.a);var f={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};u==0?o=f.id:f.parentId=o,l.ID=f.id,l.a&&(f.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(l.a)).slice(-12)+"}"),n.push(ze("threadedComment",wn("text",l.t||""),f))})}),n.push("</ThreadedComments>"),n.join("")}function mU(t,e){var r=[],n=!1;return t.replace(Mn,function(o){var l=dt(o);switch(Vi(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return o}),r}function pU(t){var e=[Lr,ze("personList",null,{xmlns:Zr.TCMNT,"xmlns:x":Pl[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(ze("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function gU(t){var e={};e.iauthor=t.read_shift(4);var r=Bl(t);return e.rfx=r.s,e.ref=ot(r.s),t.l+=16,e}function xU(t,e){return e==null&&(e=Se(36)),e.write_shift(4,t[1].iauthor),fu(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var vU=Fn;function _U(t){return fn(t.slice(0,54))}function yU(t,e){var r=[],n=[],a={},o=!1;return ws(t,function(u,f,d){switch(d){case 632:n.push(u);break;case 635:a=u;break;case 637:a.t=u.t,a.h=u.h,a.r=u.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,e.sheetRows&&a.rfx&&e.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!f.T){if(!o||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function wU(t){var e=na(),r=[];return Pe(e,628),Pe(e,630),t.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),Pe(e,632,_U(a.a)))})}),Pe(e,631),Pe(e,633),t.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var o={s:_r(n[0]),e:_r(n[0])};Pe(e,635,xU([o,a])),a.t&&a.t.length>0&&Pe(e,637,zP(a)),Pe(e,636),delete a.iauthor})}),Pe(e,634),Pe(e,629),e.end()}var EU="application/vnd.ms-office.vbaProject";function TU(t){var e=et.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");et.utils.cfb_add(e,a,t.FileIndex[n].content)}}),et.write(e)}function bU(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&et.utils.cfb_add(t,a,e.FileIndex[n].content)}})}var O4=["xlsb","xlsm","xlam","biff8","xla"];function SU(){return{"!type":"dialog"}}function AU(){return{"!type":"dialog"}}function kU(){return{"!type":"macro"}}function CU(){return{"!type":"macro"}}var qc=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,a,o,l){var u=!1,f=!1;o.length==0?f=!0:o.charAt(0)=="["&&(f=!0,o=o.slice(1,-1)),l.length==0?u=!0:l.charAt(0)=="["&&(u=!0,l=l.slice(1,-1));var d=o.length>0?parseInt(o,10)|0:0,m=l.length>0?parseInt(l,10)|0:0;return u?m+=e.c:--m,f?d+=e.r:--d,a+(u?"":"$")+vr(m)+(f?"":"$")+Pr(d)}return function(a,o){return e=o,a.replace(t,r)}}(),Hv=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,zv=function(){return function(e,r){return e.replace(Hv,function(n,a,o,l,u,f){var d=Rv(l)-(o?0:r.c),m=Cv(f)-(u?0:r.r),v=m==0?"":u?m+1:"["+m+"]",_=d==0?"":o?d+1:"["+d+"]";return a+"R"+v+"C"+_})}}();function F4(t,e){return t.replace(Hv,function(r,n,a,o,l,u){return n+(a=="$"?a+o:vr(Rv(o)+e.c))+(l=="$"?l+u:Pr(Cv(u)+e.r))})}function RU(t,e,r){var n=aa(e),a=n.s,o=_r(r),l={r:o.r-a.r,c:o.c-a.c};return F4(t,l)}function NU(t){return t.length!=1}function YT(t){return t.replace(/_xlfn\./g,"")}function jr(t){t.l+=1}function To(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function P4(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return L4(t);r.biff==12&&(n=4)}var a=t.read_shift(n),o=t.read_shift(n),l=To(t),u=To(t);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:o,c:u[0],cRel:u[1],rRel:u[2]}}}function L4(t){var e=To(t),r=To(t),n=t.read_shift(1),a=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function IU(t,e,r){if(r.biff<8)return L4(t);var n=t.read_shift(r.biff==12?4:2),a=t.read_shift(r.biff==12?4:2),o=To(t),l=To(t);return{s:{r:n,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function M4(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return DU(t);var n=t.read_shift(r&&r.biff==12?4:2),a=To(t);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function DU(t){var e=To(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function OU(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function FU(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return PU(t);var a=t.read_shift(n>=12?4:2),o=t.read_shift(2),l=(o&16384)>>14,u=(o&32768)>>15;if(o&=16383,u==1)for(;a>524287;)a-=1048576;if(l==1)for(;o>8191;)o=o-16384;return{r:a,c:o,cRel:l,rRel:u}}function PU(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,a=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),a==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:a,rRel:n}}function LU(t,e,r){var n=(t[t.l++]&96)>>5,a=P4(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function MU(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2,"i"),o=8;if(r)switch(r.biff){case 5:t.l+=12,o=6;break;case 12:o=12;break}var l=P4(t,o,r);return[n,a,l]}function UU(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function BU(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2),o=8;if(r)switch(r.biff){case 5:t.l+=12,o=6;break;case 12:o=12;break}return t.l+=o,[n,a]}function VU(t,e,r){var n=(t[t.l++]&96)>>5,a=IU(t,e-1,r);return[n,a]}function jU(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function $T(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function HU(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),a=[],o=0;o<=n;++o)a.push(t.read_shift(r&&r.biff==2?1:2));return a}function zU(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function GU(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function qU(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function WU(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function U4(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function XU(t){return t.read_shift(2),U4(t)}function KU(t){return t.read_shift(2),U4(t)}function YU(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=M4(t,0,r);return[n,a]}function $U(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=FU(t,0,r);return[n,a]}function QU(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var o=M4(t,0,r);return[n,a,o]}function ZU(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(r&&r.biff<=3?1:2);return[tV[a],j4[a],n]}function JU(t,e,r){var n=t[t.l++],a=t.read_shift(1),o=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:eB(t);return[a,(o[0]===0?j4:eV)[o[1]]]}function eB(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function tB(t,e,r){t.l+=r&&r.biff==2?3:4}function rB(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function nB(t){return t.l++,Es[t.read_shift(1)]}function aB(t){return t.l++,t.read_shift(2)}function iB(t){return t.l++,t.read_shift(1)!==0}function sB(t){return t.l++,On(t)}function oB(t,e,r){return t.l++,R0(t,e-1,r)}function lB(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Or(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=Es[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=On(t);break;case 2:r[1]=Vl(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function cB(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),a=[],o=0;o!=n;++o)a.push((r.biff==12?Bl:Mm)(t));return a}function uB(t,e,r){var n=0,a=0;r.biff==12?(n=t.read_shift(4),a=t.read_shift(4)):(a=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var o=0,l=[];o!=n&&(l[o]=[]);++o)for(var u=0;u!=a;++u)l[o][u]=lB(t,r.biff);return l}function fB(t,e,r){var n=t.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,o=t.read_shift(a);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,o]}function hB(t,e,r){if(r.biff==5)return dB(t);var n=t.read_shift(1)>>>5&3,a=t.read_shift(2),o=t.read_shift(4);return[n,a,o]}function dB(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function mB(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function pB(t,e,r){var n=t.read_shift(1)>>>5&3,a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function gB(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function xB(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2),o=4;if(r)switch(r.biff){case 5:o=15;break;case 12:o=6;break}return t.l+=o,[n,a]}var vB=Ln,_B=Ln,yB=Ln;function I0(t,e,r){return t.l+=2,[OU(t)]}function Gv(t){return t.l+=6,[]}var wB=I0,EB=Gv,TB=Gv,bB=I0;function B4(t){return t.l+=2,[Gr(t),t.read_shift(2)&1]}var SB=I0,AB=B4,kB=Gv,CB=I0,RB=I0,NB=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function IB(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),a=t.read_shift(2),o=t.read_shift(2),l=NB[r>>2&31];return{ixti:e,coltype:r&3,rt:l,idx:n,c:a,C:o}}function DB(t){return t.l+=2,[t.read_shift(4)]}function OB(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function FB(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function PB(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function LB(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function MB(t){return t.l+=4,[0,0]}var QT={1:{n:"PtgExp",f:rB},2:{n:"PtgTbl",f:yB},3:{n:"PtgAdd",f:jr},4:{n:"PtgSub",f:jr},5:{n:"PtgMul",f:jr},6:{n:"PtgDiv",f:jr},7:{n:"PtgPower",f:jr},8:{n:"PtgConcat",f:jr},9:{n:"PtgLt",f:jr},10:{n:"PtgLe",f:jr},11:{n:"PtgEq",f:jr},12:{n:"PtgGe",f:jr},13:{n:"PtgGt",f:jr},14:{n:"PtgNe",f:jr},15:{n:"PtgIsect",f:jr},16:{n:"PtgUnion",f:jr},17:{n:"PtgRange",f:jr},18:{n:"PtgUplus",f:jr},19:{n:"PtgUminus",f:jr},20:{n:"PtgPercent",f:jr},21:{n:"PtgParen",f:jr},22:{n:"PtgMissArg",f:jr},23:{n:"PtgStr",f:oB},26:{n:"PtgSheet",f:OB},27:{n:"PtgEndSheet",f:FB},28:{n:"PtgErr",f:nB},29:{n:"PtgBool",f:iB},30:{n:"PtgInt",f:aB},31:{n:"PtgNum",f:sB},32:{n:"PtgArray",f:jU},33:{n:"PtgFunc",f:ZU},34:{n:"PtgFuncVar",f:JU},35:{n:"PtgName",f:fB},36:{n:"PtgRef",f:YU},37:{n:"PtgArea",f:LU},38:{n:"PtgMemArea",f:mB},39:{n:"PtgMemErr",f:vB},40:{n:"PtgMemNoMem",f:_B},41:{n:"PtgMemFunc",f:pB},42:{n:"PtgRefErr",f:gB},43:{n:"PtgAreaErr",f:UU},44:{n:"PtgRefN",f:$U},45:{n:"PtgAreaN",f:VU},46:{n:"PtgMemAreaN",f:PB},47:{n:"PtgMemNoMemN",f:LB},57:{n:"PtgNameX",f:hB},58:{n:"PtgRef3d",f:QU},59:{n:"PtgArea3d",f:MU},60:{n:"PtgRefErr3d",f:xB},61:{n:"PtgAreaErr3d",f:BU},255:{}},UB={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},BB={1:{n:"PtgElfLel",f:B4},2:{n:"PtgElfRw",f:CB},3:{n:"PtgElfCol",f:wB},6:{n:"PtgElfRwV",f:RB},7:{n:"PtgElfColV",f:bB},10:{n:"PtgElfRadical",f:SB},11:{n:"PtgElfRadicalS",f:kB},13:{n:"PtgElfColS",f:EB},15:{n:"PtgElfColSV",f:TB},16:{n:"PtgElfRadicalLel",f:AB},25:{n:"PtgList",f:IB},29:{n:"PtgSxName",f:DB},255:{}},VB={0:{n:"PtgAttrNoop",f:MB},1:{n:"PtgAttrSemi",f:WU},2:{n:"PtgAttrIf",f:GU},4:{n:"PtgAttrChoose",f:HU},8:{n:"PtgAttrGoto",f:zU},16:{n:"PtgAttrSum",f:tB},32:{n:"PtgAttrBaxcel",f:$T},33:{n:"PtgAttrBaxcel",f:$T},64:{n:"PtgAttrSpace",f:XU},65:{n:"PtgAttrSpaceSemi",f:KU},128:{n:"PtgAttrIfError",f:qU},255:{}};function D0(t,e,r,n){if(n.biff<8)return Ln(t,e);for(var a=t.l+e,o=[],l=0;l!==r.length;++l)switch(r[l][0]){case"PtgArray":r[l][1]=uB(t,0,n),o.push(r[l][1]);break;case"PtgMemArea":r[l][2]=cB(t,r[l][1],n),o.push(r[l][2]);break;case"PtgExp":n&&n.biff==12&&(r[l][1][1]=t.read_shift(4),o.push(r[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[l][0]}return e=a-t.l,e!==0&&o.push(Ln(t,e)),o}function O0(t,e,r){for(var n=t.l+e,a,o,l=[];n!=t.l;)e=n-t.l,o=t[t.l],a=QT[o]||QT[UB[o]],(o===24||o===25)&&(a=(o===24?BB:VB)[t[t.l+1]]),!a||!a.f?Ln(t,e):l.push([a.n,a.f(t,e,r)]);return l}function jB(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],a=[],o=0;o<n.length;++o){var l=n[o];if(l)switch(l[0]){case 2:a.push('"'+l[1].replace(/"/g,'""')+'"');break;default:a.push(l[1])}else a.push("")}e.push(a.join(","))}return e.join(";")}var HB={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function zB(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function V4(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(t[n[0]][0]){case 357:return a=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?a:a+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return t[n[0]][0][3]?(a=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function ZT(t,e,r){var n=V4(t,e,r);return n=="#REF"?n:zB(n,r)}function Nn(t,e,r,n,a){var o=a&&a.biff||8,l={s:{c:0,r:0}},u=[],f,d,m,v=0,_=0,E,S="";if(!t[0]||!t[0][0])return"";for(var w=-1,b="",L=0,B=t[0].length;L<B;++L){var F=t[0][L];switch(F[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=u.pop(),d=u.pop(),w>=0){switch(t[0][w][1][0]){case 0:b=Tr(" ",t[0][w][1][1]);break;case 1:b=Tr("\r",t[0][w][1][1]);break;default:if(b="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][w][1][0])}d=d+b,w=-1}u.push(d+HB[F[0]]+f);break;case"PtgIsect":f=u.pop(),d=u.pop(),u.push(d+" "+f);break;case"PtgUnion":f=u.pop(),d=u.pop(),u.push(d+","+f);break;case"PtgRange":f=u.pop(),d=u.pop(),u.push(d+":"+f);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":m=Ff(F[1][1],l,a),u.push(Pf(m,o));break;case"PtgRefN":m=r?Ff(F[1][1],r,a):F[1][1],u.push(Pf(m,o));break;case"PtgRef3d":v=F[1][1],m=Ff(F[1][2],l,a),S=ZT(n,v,a),u.push(S+"!"+Pf(m,o));break;case"PtgFunc":case"PtgFuncVar":var z=F[1][0],q=F[1][1];z||(z=0),z&=127;var W=z==0?[]:u.slice(-z);u.length-=z,q==="User"&&(q=W.shift()),u.push(q+"("+W.join(",")+")");break;case"PtgBool":u.push(F[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(F[1]);break;case"PtgNum":u.push(String(F[1]));break;case"PtgStr":u.push('"'+F[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(F[1]);break;case"PtgAreaN":E=kT(F[1][1],r?{s:r}:l,a),u.push(a1(E,a));break;case"PtgArea":E=kT(F[1][1],l,a),u.push(a1(E,a));break;case"PtgArea3d":v=F[1][1],E=F[1][2],S=ZT(n,v,a),u.push(S+"!"+a1(E,a));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":_=F[1][2];var k=(n.names||[])[_-1]||(n[0]||[])[_],I=k?k.Name:"SH33TJSNAME"+String(_);I&&I.slice(0,6)=="_xlfn."&&!a.xlfn&&(I=I.slice(6)),u.push(I);break;case"PtgNameX":var A=F[1][1];_=F[1][2];var O;if(a.biff<=5)A<0&&(A=-A),n[A]&&(O=n[A][_]);else{var M="";if(((n[A]||[])[0]||[])[0]==14849||(((n[A]||[])[0]||[])[0]==1025?n[A][_]&&n[A][_].itab>0&&(M=n.SheetNames[n[A][_].itab-1]+"!"):M=n.SheetNames[_-1]+"!"),n[A]&&n[A][_])M+=n[A][_].Name;else if(n[0]&&n[0][_])M+=n[0][_].Name;else{var N=(V4(n,A,a)||"").split(";;");N[_-1]?M=N[_-1]:M+="SH33TJSERRX"}u.push(M);break}O||(O={Name:"SH33TJSERRY"}),u.push(O.Name);break;case"PtgParen":var D="(",he=")";if(w>=0){switch(b="",t[0][w][1][0]){case 2:D=Tr(" ",t[0][w][1][1])+D;break;case 3:D=Tr("\r",t[0][w][1][1])+D;break;case 4:he=Tr(" ",t[0][w][1][1])+he;break;case 5:he=Tr("\r",t[0][w][1][1])+he;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][w][1][0])}w=-1}u.push(D+u.pop()+he);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":m={c:F[1][1],r:F[1][0]};var we={c:r.c,r:r.r};if(n.sharedf[ot(m)]){var ne=n.sharedf[ot(m)];u.push(Nn(ne,l,we,n,a))}else{var ue=!1;for(f=0;f!=n.arrayf.length;++f)if(d=n.arrayf[f],!(m.c<d[0].s.c||m.c>d[0].e.c)&&!(m.r<d[0].s.r||m.r>d[0].e.r)){u.push(Nn(d[1],l,we,n,a)),ue=!0;break}ue||u.push(F[1])}break;case"PtgArray":u.push("{"+jB(F[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":w=L;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+F[1].idx+"[#"+F[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(F));default:throw new Error("Unrecognized Formula Token: "+String(F))}var Ve=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&w>=0&&Ve.indexOf(t[0][L][0])==-1){F=t[0][w];var ie=!0;switch(F[1][0]){case 4:ie=!1;case 0:b=Tr(" ",F[1][1]);break;case 5:ie=!1;case 1:b=Tr("\r",F[1][1]);break;default:if(b="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+F[1][0])}u.push((ie?b:"")+u.pop()+(ie?"":b)),w=-1}}if(u.length>1&&a.WTF)throw new Error("bad formula stack");return u[0]}function GB(t,e,r){var n=t.l+e,a=r.biff==2?1:2,o,l=t.read_shift(a);if(l==65535)return[[],Ln(t,e-2)];var u=O0(t,l,r);return e!==l+a&&(o=D0(t,e-l-a,u,r)),t.l=n,[u,o]}function qB(t,e,r){var n=t.l+e,a=r.biff==2?1:2,o,l=t.read_shift(a);if(l==65535)return[[],Ln(t,e-2)];var u=O0(t,l,r);return e!==l+a&&(o=D0(t,e-l-a,u,r)),t.l=n,[u,o]}function WB(t,e,r,n){var a=t.l+e,o=O0(t,n,r),l;return a!==t.l&&(l=D0(t,a-t.l,o,r)),[o,l]}function XB(t,e,r){var n=t.l+e,a,o=t.read_shift(2),l=O0(t,o,r);return o==65535?[[],Ln(t,e-2)]:(e!==o+2&&(a=D0(t,n-o-2,l,r)),[l,a])}function KB(t){var e;if(fs(t,t.l+6)!==65535)return[On(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function YB(t){if(t==null){var e=Se(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return Al(t);return Al(0)}function c1(t,e,r){var n=t.l+e,a=ji(t);r.biff==2&&++t.l;var o=KB(t),l=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var u=qB(t,n-t.l,r);return{cell:a,val:o[0],formula:u,shared:l>>3&1,tt:o[1]}}function $B(t,e,r,n,a){var o=Cl(e,r,a),l=YB(t.v),u=Se(6),f=33;u.write_shift(2,f),u.write_shift(4,0);for(var d=Se(t.bf.length),m=0;m<t.bf.length;++m)d[m]=t.bf[m];var v=un([o,l,u,d]);return v}function Um(t,e,r){var n=t.read_shift(4),a=O0(t,n,r),o=t.read_shift(4),l=o>0?D0(t,o,a,r):null;return[a,l]}var QB=Um,Bm=Um,ZB=Um,JB=Um,eV={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},j4={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},tV={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function JT(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function rV(t){var e="of:="+t.replace(Hv,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function u1(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function nV(t){return t.replace(/\./,"!")}var Mf={},Wc={},Uf=typeof Map<"u";function qv(t,e,r){var n=0,a=t.length;if(r){if(Uf?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var o=Uf?r.get(e):r[e];n<o.length;++n)if(t[o[n]].t===e)return t.Count++,o[n]}}else for(;n<a;++n)if(t[n].t===e)return t.Count++,n;return t[a]={t:e},t.Count++,t.Unique++,r&&(Uf?(r.has(e)||r.set(e,[]),r.get(e).push(a)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(a))),a}function Vm(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(Dn=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=i0(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=sm(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function pl(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function Do(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],a=60,o=t.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){Mi(e.z,a),r.ssf[a]=e.z,r.revssf[e.z]=n=a;break}}for(a=0;a!=o;++a)if(t[a].numFmtId===n)return a;return t[o]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},o}function H4(t,e,r,n,a,o){try{n.cellNF&&(t.z=at[e])}catch(u){if(n.WTF)throw u}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=hr(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(at[e]==null&&Mi(eP[e]||"General",e),t.t==="e")t.w=t.w||Es[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Zf(t.v);else if(t.t==="d"){var l=tn(t.v);(l|0)===l?t.w=l.toString(10):t.w=Zf(l)}else{if(t.v===void 0)return"";t.w=bl(t.v,Wc)}else t.t==="d"?t.w=Ea(e,tn(t.v),Wc):t.w=Ea(e,t.v,Wc)}catch(u){if(n.WTF)throw u}if(n.cellStyles&&r!=null)try{t.s=o.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=im(a.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=a.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=im(a.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=a.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(u){if(n.WTF&&o.Fills)throw u}}}function aV(t,e,r){if(t&&t["!ref"]){var n=Vt(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function iV(t,e){var r=Vt(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=vt(r))}var sV=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,oV=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,lV=/<(?:\w:)?hyperlink [^>]*>/mg,cV=/"(\w*:\w*)"/,uV=/<(?:\w:)?col\b[^>]*[\/]?>/g,fV=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,hV=/<(?:\w:)?pageMargins[^>]*\/>/g,z4=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,dV=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,mV=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function pV(t,e,r,n,a,o,l){if(!t)return t;n||(n={"!id":{}});var u=e.dense?[]:{},f={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",m="",v=t.match(oV);v?(d=t.slice(0,v.index),m=t.slice(v.index+v[0].length)):d=m=t;var _=d.match(z4);_?Wv(_[0],u,a,r):(_=d.match(dV))&&xV(_[0],_[1]||"",u,a,r);var E=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(E>0){var S=d.slice(E,E+50).match(cV);S&&iV(u,S[1])}var w=d.match(mV);w&&w[1]&&NV(w[1],a);var b=[];if(e.cellStyles){var L=d.match(uV);L&&SV(b,L)}v&&OV(v[1],u,e,f,o,l);var B=m.match(fV);B&&(u["!autofilter"]=kV(B[0]));var F=[],z=m.match(sV);if(z)for(E=0;E!=z.length;++E)F[E]=Vt(z[E].slice(z[E].indexOf('"')+1));var q=m.match(lV);q&&EV(u,q,n);var W=m.match(hV);if(W&&(u["!margins"]=TV(dt(W[0]))),!u["!ref"]&&f.e.c>=f.s.c&&f.e.r>=f.s.r&&(u["!ref"]=vt(f)),e.sheetRows>0&&u["!ref"]){var k=Vt(u["!ref"]);e.sheetRows<=+k.e.r&&(k.e.r=e.sheetRows-1,k.e.r>f.e.r&&(k.e.r=f.e.r),k.e.r<k.s.r&&(k.s.r=k.e.r),k.e.c>f.e.c&&(k.e.c=f.e.c),k.e.c<k.s.c&&(k.s.c=k.e.c),u["!fullref"]=u["!ref"],u["!ref"]=vt(k))}return b.length>0&&(u["!cols"]=b),F.length>0&&(u["!merges"]=F),u}function gV(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+vt(t[r])+'"/>';return e+"</mergeCells>"}function Wv(t,e,r,n){var a=dt(t);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=Bt(ar(a.codeName)))}function xV(t,e,r,n,a){Wv(t.slice(0,t.indexOf(">")),r,n,a)}function vV(t,e,r,n,a){var o=!1,l={},u=null;if(n.bookType!=="xlsx"&&e.vbaraw){var f=e.SheetNames[r];try{e.Workbook&&(f=e.Workbook.Sheets[r].CodeName||f)}catch{}o=!0,l.codeName=Ri(Zt(f))}if(t&&t["!outline"]){var d={summaryBelow:1,summaryRight:1};t["!outline"].above&&(d.summaryBelow=0),t["!outline"].left&&(d.summaryRight=0),u=(u||"")+ze("outlinePr",null,d)}!o&&!u||(a[a.length]=ze("sheetPr",u,l))}var _V=["objects","scenarios","selectLockedCells","selectUnlockedCells"],yV=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function wV(t){var e={sheet:1};return _V.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),yV.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=Bv(t.password).toString(16).toUpperCase()),ze("sheetProtection",null,e)}function EV(t,e,r){for(var n=Array.isArray(t),a=0;a!=e.length;++a){var o=dt(ar(e[a]),!0);if(!o.ref)return;var l=((r||{})["!id"]||[])[o.id];l?(o.Target=l.Target,o.location&&(o.Target+="#"+Bt(o.location))):(o.Target="#"+Bt(o.location),l={Target:o.Target,TargetMode:"Internal"}),o.Rel=l,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip);for(var u=Vt(o.ref),f=u.s.r;f<=u.e.r;++f)for(var d=u.s.c;d<=u.e.c;++d){var m=ot({c:d,r:f});n?(t[f]||(t[f]=[]),t[f][d]||(t[f][d]={t:"z",v:void 0}),t[f][d].l=o):(t[m]||(t[m]={t:"z",v:void 0}),t[m].l=o)}}}function TV(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function bV(t){return pl(t),ze("pageMargins",null,t)}function SV(t,e){for(var r=!1,n=0;n!=e.length;++n){var a=dt(e[n],!0);a.hidden&&(a.hidden=ur(a.hidden));var o=parseInt(a.min,10)-1,l=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,Vv(a.width)),Eo(a);o<=l;)t[o++]=dr(a)}}function AV(t,e){for(var r=["<cols>"],n,a=0;a!=e.length;++a)(n=e[a])&&(r[r.length]=ze("col",null,Vm(a,n)));return r[r.length]="</cols>",r.join("")}function kV(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function CV(t,e,r,n){var a=typeof t.ref=="string"?t.ref:vt(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=aa(a);l.s.r==l.e.r&&(l.e.r=aa(e["!ref"]).e.r,a=vt(l));for(var u=0;u<o.length;++u){var f=o[u];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==n){f.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return u==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),ze("autoFilter",null,{ref:a})}var RV=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function NV(t,e){e.Views||(e.Views=[{}]),(t.match(RV)||[]).forEach(function(r,n){var a=dt(r);e.Views[n]||(e.Views[n]={}),+a.zoomScale&&(e.Views[n].zoom=+a.zoomScale),ur(a.rightToLeft)&&(e.Views[n].RTL=!0)})}function IV(t,e,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),ze("sheetViews",ze("sheetView",null,a),{})}function DV(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var a="",o=t.t,l=t.v;if(t.t!=="z")switch(t.t){case"b":a=t.v?"1":"0";break;case"n":a=""+t.v;break;case"e":a=Es[t.v];break;case"d":n&&n.cellDates?a=hr(t.v,-1).toISOString():(t=dr(t),t.t="n",a=""+(t.v=tn(hr(t.v)))),typeof t.z>"u"&&(t.z=at[14]);break;default:a=t.v;break}var u=wn("v",Zt(a)),f={r:e},d=Do(n.cellXfs,t,n);switch(d!==0&&(f.s=d),t.t){case"n":break;case"d":f.t="d";break;case"b":f.t="b";break;case"e":f.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){u=wn("v",""+qv(n.Strings,t.v,n.revStrings)),f.t="s";break}f.t="str";break}if(t.t!=o&&(t.t=o,t.v=l),typeof t.f=="string"&&t.f){var m=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;u=ze("f",Zt(t.f),m)+(t.v!=null?u:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(f.cm=1),ze("c",u,f)}var OV=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,o=Jf("v"),l=Jf("f");return function(f,d,m,v,_,E){for(var S=0,w="",b=[],L=[],B=0,F=0,z=0,q="",W,k,I=0,A=0,O,M,N=0,D=0,he=Array.isArray(E.CellXf),we,ne=[],ue=[],Ve=Array.isArray(d),ie=[],ee={},ge=!1,V=!!m.sheetStubs,K=f.split(e),Y=0,te=K.length;Y!=te;++Y){w=K[Y].trim();var ce=w.length;if(ce!==0){var De=0;e:for(S=0;S<ce;++S)switch(w[S]){case">":if(w[S-1]!="/"){++S;break e}if(m&&m.cellStyles){if(k=dt(w.slice(De,S),!0),I=k.r!=null?parseInt(k.r,10):I+1,A=-1,m.sheetRows&&m.sheetRows<I)continue;ee={},ge=!1,k.ht&&(ge=!0,ee.hpt=parseFloat(k.ht),ee.hpx=tu(ee.hpt)),k.hidden=="1"&&(ge=!0,ee.hidden=!0),k.outlineLevel!=null&&(ge=!0,ee.level=+k.outlineLevel),ge&&(ie[I-1]=ee)}break;case"<":De=S;break}if(De>=S)break;if(k=dt(w.slice(De,S),!0),I=k.r!=null?parseInt(k.r,10):I+1,A=-1,!(m.sheetRows&&m.sheetRows<I)){v.s.r>I-1&&(v.s.r=I-1),v.e.r<I-1&&(v.e.r=I-1),m&&m.cellStyles&&(ee={},ge=!1,k.ht&&(ge=!0,ee.hpt=parseFloat(k.ht),ee.hpx=tu(ee.hpt)),k.hidden=="1"&&(ge=!0,ee.hidden=!0),k.outlineLevel!=null&&(ge=!0,ee.level=+k.outlineLevel),ge&&(ie[I-1]=ee)),b=w.slice(S).split(t);for(var ke=0;ke!=b.length&&b[ke].trim().charAt(0)=="<";++ke);for(b=b.slice(ke),S=0;S!=b.length;++S)if(w=b[S].trim(),w.length!==0){if(L=w.match(r),B=S,F=0,z=0,w="<c "+(w.slice(0,1)=="<"?">":"")+w,L!=null&&L.length===2){for(B=0,q=L[1],F=0;F!=q.length&&!((z=q.charCodeAt(F)-64)<1||z>26);++F)B=26*B+z;--B,A=B}else++A;for(F=0;F!=w.length&&w.charCodeAt(F)!==62;++F);if(++F,k=dt(w.slice(0,F),!0),k.r||(k.r=ot({r:I-1,c:A})),q=w.slice(F),W={t:""},(L=q.match(o))!=null&&L[1]!==""&&(W.v=Bt(L[1])),m.cellFormula){if((L=q.match(l))!=null&&L[1]!==""){if(W.f=Bt(ar(L[1])).replace(/\r\n/g,`
`),m.xlfn||(W.f=YT(W.f)),L[0].indexOf('t="array"')>-1)W.F=(q.match(a)||[])[1],W.F.indexOf(":")>-1&&ne.push([Vt(W.F),W.F]);else if(L[0].indexOf('t="shared"')>-1){M=dt(L[0]);var Fe=Bt(ar(L[1]));m.xlfn||(Fe=YT(Fe)),ue[parseInt(M.si,10)]=[M,Fe,k.r]}}else(L=q.match(/<f[^>]*\/>/))&&(M=dt(L[0]),ue[M.si]&&(W.f=RU(ue[M.si][1],ue[M.si][2],k.r)));var ye=_r(k.r);for(F=0;F<ne.length;++F)ye.r>=ne[F][0].s.r&&ye.r<=ne[F][0].e.r&&ye.c>=ne[F][0].s.c&&ye.c<=ne[F][0].e.c&&(W.F=ne[F][1])}if(k.t==null&&W.v===void 0)if(W.f||W.F)W.v=0,W.t="n";else if(V)W.t="z";else continue;else W.t=k.t||"n";switch(v.s.c>A&&(v.s.c=A),v.e.c<A&&(v.e.c=A),W.t){case"n":if(W.v==""||W.v==null){if(!V)continue;W.t="z"}else W.v=parseFloat(W.v);break;case"s":if(typeof W.v>"u"){if(!V)continue;W.t="z"}else O=Mf[parseInt(W.v,10)],W.v=O.t,W.r=O.r,m.cellHTML&&(W.h=O.h);break;case"str":W.t="s",W.v=W.v!=null?ar(W.v):"",m.cellHTML&&(W.h=bv(W.v));break;case"inlineStr":L=q.match(n),W.t="s",L!=null&&(O=Uv(L[1]))?(W.v=O.t,m.cellHTML&&(W.h=O.h)):W.v="";break;case"b":W.v=ur(W.v);break;case"d":m.cellDates?W.v=hr(W.v,1):(W.v=tn(hr(W.v,1)),W.t="n");break;case"e":(!m||m.cellText!==!1)&&(W.w=W.v),W.v=qk[W.v];break}if(N=D=0,we=null,he&&k.s!==void 0&&(we=E.CellXf[k.s],we!=null&&(we.numFmtId!=null&&(N=we.numFmtId),m.cellStyles&&we.fillId!=null&&(D=we.fillId))),H4(W,N,D,m,_,E),m.cellDates&&he&&W.t=="n"&&Fl(at[N])&&(W.t="d",W.v=Lm(W.v)),k.cm&&m.xlmeta){var Be=(m.xlmeta.Cell||[])[+k.cm-1];Be&&Be.type=="XLDAPR"&&(W.D=!0)}if(Ve){var X=_r(k.r);d[X.r]||(d[X.r]=[]),d[X.r][X.c]=W}else d[k.r]=W}}}}ie.length>0&&(d["!rows"]=ie)}}();function FV(t,e,r,n){var a=[],o=[],l=Vt(t["!ref"]),u="",f,d="",m=[],v=0,_=0,E=t["!rows"],S=Array.isArray(t),w={r:d},b,L=-1;for(_=l.s.c;_<=l.e.c;++_)m[_]=vr(_);for(v=l.s.r;v<=l.e.r;++v){for(o=[],d=Pr(v),_=l.s.c;_<=l.e.c;++_){f=m[_]+d;var B=S?(t[v]||[])[_]:t[f];B!==void 0&&(u=DV(B,f,t,e))!=null&&o.push(u)}(o.length>0||E&&E[v])&&(w={r:d},E&&E[v]&&(b=E[v],b.hidden&&(w.hidden=1),L=-1,b.hpx?L=s0(b.hpx):b.hpt&&(L=b.hpt),L>-1&&(w.ht=L,w.customHeight=1),b.level&&(w.outlineLevel=b.level)),a[a.length]=ze("row",o.join(""),w))}if(E)for(;v<E.length;++v)E&&E[v]&&(w={r:v+1},b=E[v],b.hidden&&(w.hidden=1),L=-1,b.hpx?L=s0(b.hpx):b.hpt&&(L=b.hpt),L>-1&&(w.ht=L,w.customHeight=1),b.level&&(w.outlineLevel=b.level),a[a.length]=ze("row","",w));return a.join("")}function G4(t,e,r,n){var a=[Lr,ze("worksheet",null,{xmlns:Pl[0],"xmlns:r":Zr.r})],o=r.SheetNames[t],l=0,u="",f=r.Sheets[o];f==null&&(f={});var d=f["!ref"]||"A1",m=Vt(d);if(m.e.c>16383||m.e.r>1048575){if(e.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");m.e.c=Math.min(m.e.c,16383),m.e.r=Math.min(m.e.c,1048575),d=vt(m)}n||(n={}),f["!comments"]=[];var v=[];vV(f,r,t,e,a),a[a.length]=ze("dimension",null,{ref:d}),a[a.length]=IV(f,e,t,r),e.sheetFormat&&(a[a.length]=ze("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),f["!cols"]!=null&&f["!cols"].length>0&&(a[a.length]=AV(f,f["!cols"])),a[l=a.length]="<sheetData/>",f["!links"]=[],f["!ref"]!=null&&(u=FV(f,e),u.length>0&&(a[a.length]=u)),a.length>l+1&&(a[a.length]="</sheetData>",a[l]=a[l].replace("/>",">")),f["!protect"]&&(a[a.length]=wV(f["!protect"])),f["!autofilter"]!=null&&(a[a.length]=CV(f["!autofilter"],f,r,t)),f["!merges"]!=null&&f["!merges"].length>0&&(a[a.length]=gV(f["!merges"]));var _=-1,E,S=-1;return f["!links"].length>0&&(a[a.length]="<hyperlinks>",f["!links"].forEach(function(w){w[1].Target&&(E={ref:w[0]},w[1].Target.charAt(0)!="#"&&(S=Qt(n,-1,Zt(w[1].Target).replace(/#.*$/,""),At.HLINK),E["r:id"]="rId"+S),(_=w[1].Target.indexOf("#"))>-1&&(E.location=Zt(w[1].Target.slice(_+1))),w[1].Tooltip&&(E.tooltip=Zt(w[1].Tooltip)),a[a.length]=ze("hyperlink",null,E))}),a[a.length]="</hyperlinks>"),delete f["!links"],f["!margins"]!=null&&(a[a.length]=bV(f["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(a[a.length]=wn("ignoredErrors",ze("ignoredError",null,{numberStoredAsText:1,sqref:d}))),v.length>0&&(S=Qt(n,-1,"../drawings/drawing"+(t+1)+".xml",At.DRAW),a[a.length]=ze("drawing",null,{"r:id":"rId"+S}),f["!drawing"]=v),f["!comments"].length>0&&(S=Qt(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",At.VML),a[a.length]=ze("legacyDrawing",null,{"r:id":"rId"+S}),f["!legacy"]=S),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function PV(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var a=t.read_shift(2);t.l+=1;var o=t.read_shift(1);return t.l=n,o&7&&(r.level=o&7),o&16&&(r.hidden=!0),o&32&&(r.hpt=a/20),r}function LV(t,e,r){var n=Se(145),a=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var o=320;a.hpx?o=s0(a.hpx)*20:a.hpt&&(o=a.hpt*20),n.write_shift(2,o),n.write_shift(1,0);var l=0;a.level&&(l|=a.level),a.hidden&&(l|=16),(a.hpx||a.hpt)&&(l|=32),n.write_shift(1,l),n.write_shift(1,0);var u=0,f=n.l;n.l+=4;for(var d={r:t,c:0},m=0;m<16;++m)if(!(e.s.c>m+1<<10||e.e.c<m<<10)){for(var v=-1,_=-1,E=m<<10;E<m+1<<10;++E){d.c=E;var S=Array.isArray(r)?(r[d.r]||[])[d.c]:r[ot(d)];S&&(v<0&&(v=E),_=E)}v<0||(++u,n.write_shift(4,v),n.write_shift(4,_))}var w=n.l;return n.l=f,n.write_shift(4,u),n.l=w,n.length>n.l?n.slice(0,n.l):n}function MV(t,e,r,n){var a=LV(n,r,e);(a.length>17||(e["!rows"]||[])[n])&&Pe(t,0,a)}var UV=Bl,BV=fu;function VV(){}function jV(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=GP(t),r}function HV(t,e,r){r==null&&(r=Se(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return rm({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),Vk(t,r),r.slice(0,r.l)}function zV(t){var e=za(t);return[e]}function GV(t,e,r){return r==null&&(r=Se(8)),Ll(e,r)}function qV(t){var e=Ml(t);return[e]}function WV(t,e,r){return r==null&&(r=Se(4)),Ul(e,r)}function XV(t){var e=za(t),r=t.read_shift(1);return[e,r,"b"]}function KV(t,e,r){return r==null&&(r=Se(9)),Ll(e,r),r.write_shift(1,t.v?1:0),r}function YV(t){var e=Ml(t),r=t.read_shift(1);return[e,r,"b"]}function $V(t,e,r){return r==null&&(r=Se(5)),Ul(e,r),r.write_shift(1,t.v?1:0),r}function QV(t){var e=za(t),r=t.read_shift(1);return[e,r,"e"]}function ZV(t,e,r){return r==null&&(r=Se(9)),Ll(e,r),r.write_shift(1,t.v),r}function JV(t){var e=Ml(t),r=t.read_shift(1);return[e,r,"e"]}function ej(t,e,r){return r==null&&(r=Se(8)),Ul(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function tj(t){var e=za(t),r=t.read_shift(4);return[e,r,"s"]}function rj(t,e,r){return r==null&&(r=Se(12)),Ll(e,r),r.write_shift(4,e.v),r}function nj(t){var e=Ml(t),r=t.read_shift(4);return[e,r,"s"]}function aj(t,e,r){return r==null&&(r=Se(8)),Ul(e,r),r.write_shift(4,e.v),r}function ij(t){var e=za(t),r=On(t);return[e,r,"n"]}function sj(t,e,r){return r==null&&(r=Se(16)),Ll(e,r),Al(t.v,r),r}function q4(t){var e=Ml(t),r=On(t);return[e,r,"n"]}function oj(t,e,r){return r==null&&(r=Se(12)),Ul(e,r),Al(t.v,r),r}function lj(t){var e=za(t),r=Ov(t);return[e,r,"n"]}function cj(t,e,r){return r==null&&(r=Se(12)),Ll(e,r),jk(t.v,r),r}function uj(t){var e=Ml(t),r=Ov(t);return[e,r,"n"]}function fj(t,e,r){return r==null&&(r=Se(8)),Ul(e,r),jk(t.v,r),r}function hj(t){var e=za(t),r=Nv(t);return[e,r,"is"]}function dj(t){var e=za(t),r=Fn(t);return[e,r,"str"]}function mj(t,e,r){return r==null&&(r=Se(12+4*t.v.length)),Ll(e,r),fn(t.v,r),r.length>r.l?r.slice(0,r.l):r}function pj(t){var e=Ml(t),r=Fn(t);return[e,r,"str"]}function gj(t,e,r){return r==null&&(r=Se(8+4*t.v.length)),Ul(e,r),fn(t.v,r),r.length>r.l?r.slice(0,r.l):r}function xj(t,e,r){var n=t.l+e,a=za(t);a.r=r["!row"];var o=t.read_shift(1),l=[a,o,"b"];if(r.cellFormula){t.l+=2;var u=Bm(t,n-t.l,r);l[3]=Nn(u,null,a,r.supbooks,r)}else t.l=n;return l}function vj(t,e,r){var n=t.l+e,a=za(t);a.r=r["!row"];var o=t.read_shift(1),l=[a,o,"e"];if(r.cellFormula){t.l+=2;var u=Bm(t,n-t.l,r);l[3]=Nn(u,null,a,r.supbooks,r)}else t.l=n;return l}function _j(t,e,r){var n=t.l+e,a=za(t);a.r=r["!row"];var o=On(t),l=[a,o,"n"];if(r.cellFormula){t.l+=2;var u=Bm(t,n-t.l,r);l[3]=Nn(u,null,a,r.supbooks,r)}else t.l=n;return l}function yj(t,e,r){var n=t.l+e,a=za(t);a.r=r["!row"];var o=Fn(t),l=[a,o,"str"];if(r.cellFormula){t.l+=2;var u=Bm(t,n-t.l,r);l[3]=Nn(u,null,a,r.supbooks,r)}else t.l=n;return l}var wj=Bl,Ej=fu;function Tj(t,e){return e==null&&(e=Se(4)),e.write_shift(4,t),e}function bj(t,e){var r=t.l+e,n=Bl(t),a=Iv(t),o=Fn(t),l=Fn(t),u=Fn(t);t.l=r;var f={rfx:n,relId:a,loc:o,display:u};return l&&(f.Tooltip=l),f}function Sj(t,e){var r=Se(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));fu({s:_r(t[0]),e:_r(t[0])},r),Dv("rId"+e,r);var n=t[1].Target.indexOf("#"),a=n==-1?"":t[1].Target.slice(n+1);return fn(a||"",r),fn(t[1].Tooltip||"",r),fn("",r),r.slice(0,r.l)}function Aj(){}function kj(t,e,r){var n=t.l+e,a=Hk(t),o=t.read_shift(1),l=[a];if(l[2]=o,r.cellFormula){var u=QB(t,n-t.l,r);l[1]=u}else t.l=n;return l}function Cj(t,e,r){var n=t.l+e,a=Bl(t),o=[a];if(r.cellFormula){var l=JB(t,n-t.l,r);o[1]=l,t.l=n}else t.l=n;return o}function Rj(t,e,r){r==null&&(r=Se(18));var n=Vm(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return e.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),e.level&&(a|=e.level<<8),r.write_shift(2,a),r}var W4=["left","right","top","bottom","header","footer"];function Nj(t){var e={};return W4.forEach(function(r){e[r]=On(t)}),e}function Ij(t,e){return e==null&&(e=Se(6*8)),pl(t),W4.forEach(function(r){Al(t[r],e)}),e}function Dj(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function Oj(t,e,r){r==null&&(r=Se(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function Fj(t){var e=Se(24);return e.write_shift(4,4),e.write_shift(4,1),fu(t,e),e}function Pj(t,e){return e==null&&(e=Se(16*4+2)),e.write_shift(2,t.password?Bv(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function Lj(){}function Mj(){}function Uj(t,e,r,n,a,o,l){if(!t)return t;var u=e||{};n||(n={"!id":{}});var f=u.dense?[]:{},d,m={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=!1,_=!1,E,S,w,b,L,B,F,z,q,W=[];u.biff=12,u["!row"]=0;var k=0,I=!1,A=[],O={},M=u.supbooks||a.supbooks||[[]];if(M.sharedf=O,M.arrayf=A,M.SheetNames=a.SheetNames||a.Sheets.map(function(Ve){return Ve.name}),!u.supbooks&&(u.supbooks=M,a.Names))for(var N=0;N<a.Names.length;++N)M[0][N+1]=a.Names[N];var D=[],he=[],we=!1;o0[16]={n:"BrtShortReal",f:q4};var ne;if(ws(t,function(ie,ee,ge){if(!_)switch(ge){case 148:d=ie;break;case 0:E=ie,u.sheetRows&&u.sheetRows<=E.r&&(_=!0),z=Pr(b=E.r),u["!row"]=E.r,(ie.hidden||ie.hpt||ie.level!=null)&&(ie.hpt&&(ie.hpx=tu(ie.hpt)),he[ie.r]=ie);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(S={t:ie[2]},ie[2]){case"n":S.v=ie[1];break;case"s":F=Mf[ie[1]],S.v=F.t,S.r=F.r;break;case"b":S.v=!!ie[1];break;case"e":S.v=ie[1],u.cellText!==!1&&(S.w=Es[S.v]);break;case"str":S.t="s",S.v=ie[1];break;case"is":S.t="s",S.v=ie[1].t;break}if((w=l.CellXf[ie[0].iStyleRef])&&H4(S,w.numFmtId,null,u,o,l),L=ie[0].c==-1?L+1:ie[0].c,u.dense?(f[b]||(f[b]=[]),f[b][L]=S):f[vr(L)+z]=S,u.cellFormula){for(I=!1,k=0;k<A.length;++k){var V=A[k];E.r>=V[0].s.r&&E.r<=V[0].e.r&&L>=V[0].s.c&&L<=V[0].e.c&&(S.F=vt(V[0]),I=!0)}!I&&ie.length>3&&(S.f=ie[3])}if(m.s.r>E.r&&(m.s.r=E.r),m.s.c>L&&(m.s.c=L),m.e.r<E.r&&(m.e.r=E.r),m.e.c<L&&(m.e.c=L),u.cellDates&&w&&S.t=="n"&&Fl(at[w.numFmtId])){var K=io(S.v);K&&(S.t="d",S.v=new Date(K.y,K.m-1,K.d,K.H,K.M,K.S,K.u))}ne&&(ne.type=="XLDAPR"&&(S.D=!0),ne=void 0);break;case 1:case 12:if(!u.sheetStubs||v)break;S={t:"z",v:void 0},L=ie[0].c==-1?L+1:ie[0].c,u.dense?(f[b]||(f[b]=[]),f[b][L]=S):f[vr(L)+z]=S,m.s.r>E.r&&(m.s.r=E.r),m.s.c>L&&(m.s.c=L),m.e.r<E.r&&(m.e.r=E.r),m.e.c<L&&(m.e.c=L),ne&&(ne.type=="XLDAPR"&&(S.D=!0),ne=void 0);break;case 176:W.push(ie);break;case 49:ne=((u.xlmeta||{}).Cell||[])[ie-1];break;case 494:var Y=n["!id"][ie.relId];for(Y?(ie.Target=Y.Target,ie.loc&&(ie.Target+="#"+ie.loc),ie.Rel=Y):ie.relId==""&&(ie.Target="#"+ie.loc),b=ie.rfx.s.r;b<=ie.rfx.e.r;++b)for(L=ie.rfx.s.c;L<=ie.rfx.e.c;++L)u.dense?(f[b]||(f[b]=[]),f[b][L]||(f[b][L]={t:"z",v:void 0}),f[b][L].l=ie):(B=ot({c:L,r:b}),f[B]||(f[B]={t:"z",v:void 0}),f[B].l=ie);break;case 426:if(!u.cellFormula)break;A.push(ie),q=u.dense?f[b][L]:f[vr(L)+z],q.f=Nn(ie[1],m,{r:E.r,c:L},M,u),q.F=vt(ie[0]);break;case 427:if(!u.cellFormula)break;O[ot(ie[0].s)]=ie[1],q=u.dense?f[b][L]:f[vr(L)+z],q.f=Nn(ie[1],m,{r:E.r,c:L},M,u);break;case 60:if(!u.cellStyles)break;for(;ie.e>=ie.s;)D[ie.e--]={width:ie.w/256,hidden:!!(ie.flags&1),level:ie.level},we||(we=!0,Vv(ie.w/256)),Eo(D[ie.e+1]);break;case 161:f["!autofilter"]={ref:vt(ie)};break;case 476:f["!margins"]=ie;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),ie.name&&(a.Sheets[r].CodeName=ie.name),(ie.above||ie.left)&&(f["!outline"]={above:ie.above,left:ie.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),ie.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:v=!0;break;case 36:v=!1;break;case 37:v=!0;break;case 38:v=!1;break;default:if(!ee.T){if(!v||u.WTF)throw new Error("Unexpected record 0x"+ge.toString(16))}}},u),delete u.supbooks,delete u["!row"],!f["!ref"]&&(m.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(f["!ref"]=vt(d||m)),u.sheetRows&&f["!ref"]){var ue=Vt(f["!ref"]);u.sheetRows<=+ue.e.r&&(ue.e.r=u.sheetRows-1,ue.e.r>m.e.r&&(ue.e.r=m.e.r),ue.e.r<ue.s.r&&(ue.s.r=ue.e.r),ue.e.c>m.e.c&&(ue.e.c=m.e.c),ue.e.c<ue.s.c&&(ue.s.c=ue.e.c),f["!fullref"]=f["!ref"],f["!ref"]=vt(ue))}return W.length>0&&(f["!merges"]=W),D.length>0&&(f["!cols"]=D),he.length>0&&(f["!rows"]=he),f}function Bj(t,e,r,n,a,o,l){if(e.v===void 0)return!1;var u="";switch(e.t){case"b":u=e.v?"1":"0";break;case"d":e=dr(e),e.z=e.z||at[14],e.v=tn(hr(e.v)),e.t="n";break;case"n":case"e":u=""+e.v;break;default:u=e.v;break}var f={r,c:n};switch(f.s=Do(a.cellXfs,e,a),e.l&&o["!links"].push([ot(f),e.l]),e.c&&o["!comments"].push([ot(f),e.c]),e.t){case"s":case"str":return a.bookSST?(u=qv(a.Strings,e.v,a.revStrings),f.t="s",f.v=u,l?Pe(t,18,aj(e,f)):Pe(t,7,rj(e,f))):(f.t="str",l?Pe(t,17,gj(e,f)):Pe(t,6,mj(e,f))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?l?Pe(t,13,fj(e,f)):Pe(t,2,cj(e,f)):l?Pe(t,16,oj(e,f)):Pe(t,5,sj(e,f)),!0;case"b":return f.t="b",l?Pe(t,15,$V(e,f)):Pe(t,4,KV(e,f)),!0;case"e":return f.t="e",l?Pe(t,14,ej(e,f)):Pe(t,3,ZV(e,f)),!0}return l?Pe(t,12,WV(e,f)):Pe(t,1,GV(e,f)),!0}function Vj(t,e,r,n){var a=Vt(e["!ref"]||"A1"),o,l="",u=[];Pe(t,145);var f=Array.isArray(e),d=a.e.r;e["!rows"]&&(d=Math.max(a.e.r,e["!rows"].length-1));for(var m=a.s.r;m<=d;++m){l=Pr(m),MV(t,e,a,m);var v=!1;if(m<=a.e.r)for(var _=a.s.c;_<=a.e.c;++_){m===a.s.r&&(u[_]=vr(_)),o=u[_]+l;var E=f?(e[m]||[])[_]:e[o];if(!E){v=!1;continue}v=Bj(t,E,m,_,n,e,v)}}Pe(t,146)}function jj(t,e){!e||!e["!merges"]||(Pe(t,177,Tj(e["!merges"].length)),e["!merges"].forEach(function(r){Pe(t,176,Ej(r))}),Pe(t,178))}function Hj(t,e){!e||!e["!cols"]||(Pe(t,390),e["!cols"].forEach(function(r,n){r&&Pe(t,60,Rj(n,r))}),Pe(t,391))}function zj(t,e){!e||!e["!ref"]||(Pe(t,648),Pe(t,649,Fj(Vt(e["!ref"]))),Pe(t,650))}function Gj(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var a=Qt(r,-1,n[1].Target.replace(/#.*$/,""),At.HLINK);Pe(t,494,Sj(n,a))}}),delete e["!links"]}function qj(t,e,r,n){if(e["!comments"].length>0){var a=Qt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",At.VML);Pe(t,551,Dv("rId"+a)),e["!legacy"]=a}}function Wj(t,e,r,n){if(e["!autofilter"]){var a=e["!autofilter"],o=typeof a.ref=="string"?a.ref:vt(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,u=aa(o);u.s.r==u.e.r&&(u.e.r=aa(e["!ref"]).e.r,o=vt(u));for(var f=0;f<l.length;++f){var d=l[f];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==n){d.Ref="'"+r.SheetNames[n]+"'!"+o;break}}f==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+o}),Pe(t,161,fu(Vt(o))),Pe(t,162)}}function Xj(t,e,r){Pe(t,133),Pe(t,137,Oj(e,r)),Pe(t,138),Pe(t,134)}function Kj(t,e){e["!protect"]&&Pe(t,535,Pj(e["!protect"]))}function Yj(t,e,r,n){var a=na(),o=r.SheetNames[t],l=r.Sheets[o]||{},u=o;try{r&&r.Workbook&&(u=r.Workbook.Sheets[t].CodeName||u)}catch{}var f=Vt(l["!ref"]||"A1");if(f.e.c>16383||f.e.r>1048575){if(e.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],Pe(a,129),(r.vbaraw||l["!outline"])&&Pe(a,147,HV(u,l["!outline"])),Pe(a,148,BV(f)),Xj(a,l,r.Workbook),Hj(a,l),Vj(a,l,t,e),Kj(a,l),Wj(a,l,r,t),jj(a,l),Gj(a,l,n),l["!margins"]&&Pe(a,476,Ij(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&zj(a,l),qj(a,l,t,n),Pe(a,130),a.end()}function $j(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(o){var l=o.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(e[+l[1]]=r?+l[2]:l[2])});var a=Bt((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(o){n=o.replace(/<.*?>/g,"")}),[e,a,n]}function Qj(t,e,r,n,a,o){var l=o||{"!type":"chart"};if(!t)return o;var u=0,f=0,d="A",m={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(v){var _=$j(v);m.s.r=m.s.c=0,m.e.c=u,d=vr(u),_[0].forEach(function(E,S){l[d+Pr(S)]={t:"n",v:E,z:_[1]},f=S}),m.e.r<f&&(m.e.r=f),++u}),u>0&&(l["!ref"]=vt(m)),l}function Zj(t,e,r,n,a){if(!t)return t;n||(n={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},l,u=t.match(z4);return u&&Wv(u[0],o,a,r),(l=t.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=l[1]),n["!id"][o["!rel"]]&&(o["!drawel"]=n["!id"][o["!rel"]]),o}function Jj(t,e){t.l+=10;var r=Fn(t);return{name:r}}function eH(t,e,r,n,a){if(!t)return t;n||(n={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},l=!1;return ws(t,function(f,d,m){switch(m){case 550:o["!rel"]=f;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),f.name&&(a.Sheets[r].CodeName=f.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!l||e.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}},e),n["!id"][o["!rel"]]&&(o["!drawel"]=n["!id"][o["!rel"]]),o}var Xv=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],tH=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],rH=[],nH=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function eb(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],a=0;a!=e.length;++a){var o=e[a];if(n[o[0]]==null)n[o[0]]=o[1];else switch(o[2]){case"bool":typeof n[o[0]]=="string"&&(n[o[0]]=ur(n[o[0]]));break;case"int":typeof n[o[0]]=="string"&&(n[o[0]]=parseInt(n[o[0]],10));break}}}function tb(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=ur(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function X4(t){tb(t.WBProps,Xv),tb(t.CalcPr,nH),eb(t.WBView,tH),eb(t.Sheets,rH),Wc.date1904=ur(t.WBProps.date1904)}function aH(t){return!t.Workbook||!t.Workbook.WBProps?"false":ur(t.Workbook.WBProps.date1904)?"true":"false"}var iH="][*?/\\".split("");function K4(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return iH.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function sH(t,e,r){t.forEach(function(n,a){K4(n);for(var o=0;o<a;++o)if(n==t[o])throw new Error("Duplicate Sheet Name: "+n);if(r){var l=e&&e[a]&&e[a].CodeName||n;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function oH(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];sH(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)aV(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var lH=/<\w+:workbook/;function cH(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",o={},l=0;if(t.replace(Mn,function(f,d){var m=dt(f);switch(Vi(m[0])){case"<?xml":break;case"<workbook":f.match(lH)&&(a="xmlns"+f.match(/<(\w+):/)[1]),r.xmlns=m[a];break;case"</workbook>":break;case"<fileVersion":delete m[0],r.AppVersion=m;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Xv.forEach(function(v){if(m[v[0]]!=null)switch(v[2]){case"bool":r.WBProps[v[0]]=ur(m[v[0]]);break;case"int":r.WBProps[v[0]]=parseInt(m[v[0]],10);break;default:r.WBProps[v[0]]=m[v[0]]}}),m.codeName&&(r.WBProps.CodeName=ar(m.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete m[0],r.WBView.push(m);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(m.state){case"hidden":m.Hidden=1;break;case"veryHidden":m.Hidden=2;break;default:m.Hidden=0}delete m.state,m.name=Bt(ar(m.name)),delete m[0],r.Sheets.push(m);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":o={},o.Name=ar(m.name),m.comment&&(o.Comment=m.comment),m.localSheetId&&(o.Sheet=+m.localSheetId),ur(m.hidden||"0")&&(o.Hidden=!0),l=d+f.length;break;case"</definedName>":o.Ref=Bt(ar(t.slice(l,d))),r.Names.push(o);break;case"<definedName/>":break;case"<calcPr":delete m[0],r.CalcPr=m;break;case"<calcPr/>":delete m[0],r.CalcPr=m;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+m[0]+" in workbook")}return f}),Pl.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return X4(r),r}function Y4(t){var e=[Lr];e[e.length]=ze("workbook",null,{xmlns:Pl[0],"xmlns:r":Zr.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(Xv.forEach(function(u){t.Workbook.WBProps[u[0]]!=null&&t.Workbook.WBProps[u[0]]!=u[1]&&(n[u[0]]=t.Workbook.WBProps[u[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=ze("workbookPr",null,n);var a=t.Workbook&&t.Workbook.Sheets||[],o=0;if(a&&a[0]&&a[0].Hidden){for(e[e.length]="<bookViews>",o=0;o!=t.SheetNames.length&&!(!a[o]||!a[o].Hidden);++o);o==t.SheetNames.length&&(o=0),e[e.length]='<workbookView firstSheet="'+o+'" activeTab="'+o+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",o=0;o!=t.SheetNames.length;++o){var l={name:Zt(t.SheetNames[o].slice(0,31))};if(l.sheetId=""+(o+1),l["r:id"]="rId"+(o+1),a[o])switch(a[o].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}e[e.length]=ze("sheet",null,l)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(u){var f={name:u.Name};u.Comment&&(f.comment=u.Comment),u.Sheet!=null&&(f.localSheetId=""+u.Sheet),u.Hidden&&(f.hidden="1"),u.Ref&&(e[e.length]=ze("definedName",Zt(u.Ref),f))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function uH(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=Z1(t),r.name=Fn(t),r}function fH(t,e){return e||(e=Se(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),Dv(t.strRelID,e),fn(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function hH(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var a=e>8?Fn(t):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function dH(t,e){e||(e=Se(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),Vk(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function mH(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function pH(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var a=t.read_shift(4),o=qP(t),l=ZB(t,0,r),u=Iv(t);t.l=n;var f={Name:o,Ptg:l};return a<268435455&&(f.Sheet=a),u&&(f.Comment=u),f}function gH(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;e||(e={}),e.biff=12;var o=[],l=[[]];return l.SheetNames=[],l.XTI=[],o0[16]={n:"BrtFRTArchID$",f:mH},ws(t,function(f,d,m){switch(m){case 156:l.SheetNames.push(f.name),r.Sheets.push(f);break;case 153:r.WBProps=f;break;case 39:f.Sheet!=null&&(e.SID=f.Sheet),f.Ref=Nn(f.Ptg,null,null,l,e),delete e.SID,delete f.Ptg,o.push(f);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([m,f]):l[0]=[m,f],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(f),l.XTI=l.XTI.concat(f);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(m),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(m),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!d.T){if(!a||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}},e),X4(r),r.Names=o,r.supbooks=l,r}function xH(t,e){Pe(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};Pe(t,156,fH(a))}Pe(t,144)}function vH(t,e){e||(e=Se(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return fn("SheetJS",e),fn(Yd.version,e),fn(Yd.version,e),fn("7262",e),e.length>e.l?e.slice(0,e.l):e}function _H(t,e){e||(e=Se(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function yH(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,a=-1,o=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&o==-1&&(o=n);o>a||(Pe(t,135),Pe(t,158,_H(a)),Pe(t,136))}}function wH(t,e){var r=na();return Pe(r,131),Pe(r,128,vH()),Pe(r,153,dH(t.Workbook&&t.Workbook.WBProps||null)),yH(r,t),xH(r,t),Pe(r,132),r.end()}function EH(t,e,r){return e.slice(-4)===".bin"?gH(t,r):cH(t,r)}function TH(t,e,r,n,a,o,l,u){return e.slice(-4)===".bin"?Uj(t,n,r,a,o,l,u):pV(t,n,r,a,o,l,u)}function bH(t,e,r,n,a,o,l,u){return e.slice(-4)===".bin"?eH(t,n,r,a,o):Zj(t,n,r,a,o)}function SH(t,e,r,n,a,o,l,u){return e.slice(-4)===".bin"?kU():CU()}function AH(t,e,r,n,a,o,l,u){return e.slice(-4)===".bin"?SU():AU()}function kH(t,e,r,n){return e.slice(-4)===".bin"?E7(t,r,n):u7(t,r,n)}function CH(t,e,r){return R4(t,r)}function RH(t,e,r){return e.slice(-4)===".bin"?R9(t,r):A9(t,r)}function NH(t,e,r){return e.slice(-4)===".bin"?yU(t,r):fU(t,r)}function IH(t,e,r){return e.slice(-4)===".bin"?lU(t):sU(t)}function DH(t,e,r,n){return r.slice(-4)===".bin"?cU(t,e,r,n):void 0}function OH(t,e,r){return e.slice(-4)===".bin"?nU(t,e,r):iU(t,e,r)}function FH(t,e,r){return(e.slice(-4)===".bin"?wH:Y4)(t)}function PH(t,e,r,n,a){return(e.slice(-4)===".bin"?Yj:G4)(t,r,n,a)}function LH(t,e,r){return(e.slice(-4)===".bin"?D7:k4)(t,r)}function MH(t,e,r){return(e.slice(-4)===".bin"?D9:_4)(t,r)}function UH(t,e,r){return(e.slice(-4)===".bin"?wU:D4)(t)}function BH(t){return(t.slice(-4)===".bin"?aU:N4)()}var $4=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Q4=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Qa(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=t.match($4),o,l,u,f;if(a)for(f=0;f!=a.length;++f)o=a[f].match(Q4),(l=o[1].indexOf(":"))===-1?n[o[1]]=o[2].slice(1,o[2].length-1):(o[1].slice(0,6)==="xmlns:"?u="xmlns"+o[1].slice(6):u=o[1].slice(l+1),n[u]=o[2].slice(1,o[2].length-1));return n}function VH(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match($4),a,o,l,u;if(n)for(u=0;u!=n.length;++u)a=n[u].match(Q4),(o=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(o+1),r[l]=a[2].slice(1,a[2].length-1));return r}var Bf;function jH(t,e){var r=Bf[t]||Bt(t);return r==="General"?bl(e):Ea(r,e)}function HH(t,e,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=ur(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=hr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[Bt(e)]=a}function zH(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||Es[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Zf(t.v):t.w=bl(t.v):t.w=jH(e||"General",t.v)}catch(o){if(r.WTF)throw o}try{var n=Bf[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&Fl(n)){var a=io(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(o){if(r.WTF)throw o}}}function GH(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=r7[n.Pattern]||n.Pattern)}t[e.ID]=e}function qH(t,e,r,n,a,o,l,u,f,d){var m="General",v=n.StyleID,_={};d=d||{};var E=[],S=0;for(v===void 0&&u&&(v=u.StyleID),v===void 0&&l&&(v=l.StyleID);o[v]!==void 0&&(o[v].nf&&(m=o[v].nf),o[v].Interior&&E.push(o[v].Interior),!!o[v].Parent);)v=o[v].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=ur(t);break;case"String":n.t="s",n.r=vT(Bt(t)),n.v=t.indexOf("<")>-1?Bt(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(hr(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Bt(t):n.v<60&&(n.v=n.v-1),(!m||m=="General")&&(m="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=qk[t],d.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=vT(e||t));break}if(zH(n,m,d),d.cellFormula!==!1)if(n.Formula){var w=Bt(n.Formula);w.charCodeAt(0)==61&&(w=w.slice(1)),n.f=qc(w,a),delete n.Formula,n.ArrayRange=="RC"?n.F=qc("RC:RC",a):n.ArrayRange&&(n.F=qc(n.ArrayRange,a),f.push([Vt(n.F),n.F]))}else for(S=0;S<f.length;++S)a.r>=f[S][0].s.r&&a.r<=f[S][0].e.r&&a.c>=f[S][0].s.c&&a.c<=f[S][0].e.c&&(n.F=f[S][1]);d.cellStyles&&(E.forEach(function(b){!_.patternType&&b.patternType&&(_.patternType=b.patternType)}),n.s=_),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function WH(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function f1(t,e){var r=e||{};cu();var n=Ef(Sv(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=ar(n));var a=n.slice(0,1024).toLowerCase(),o=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var l=dr(r);return l.type="string",eu.to_workbook(n,l)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Jt){a.indexOf("<"+Jt)>=0&&(o=!0)}),o)return Iz(n,r);Bf={"General Number":"General","General Date":at[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":at[15],"Short Date":at[14],"Long Time":at[19],"Medium Time":at[18],"Short Time":at[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:at[2],Standard:at[4],Percent:at[10],Scientific:at[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,f=[],d,m={},v=[],_=r.dense?[]:{},E="",S={},w={},b=Qa('<Data ss:Type="String">'),L=0,B=0,F=0,z={s:{r:2e6,c:2e6},e:{r:0,c:0}},q={},W={},k="",I=0,A=[],O={},M={},N=0,D=[],he=[],we={},ne=[],ue,Ve=!1,ie=[],ee=[],ge={},V=0,K=0,Y={Sheets:[],WBProps:{date1904:!1}},te={};t0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ce="";u=t0.exec(n);)switch(u[3]=(ce=u[3]).toLowerCase()){case"data":if(ce=="data"){if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&f.push([u[3],!0]);break}if(f[f.length-1][1])break;u[1]==="/"?qH(n.slice(L,u.index),k,b,f[f.length-1][0]=="comment"?we:S,{c:B,r:F},q,ne[B],w,ie,r):(k="",b=Qa(u[0]),L=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(he.length>0&&(S.c=he),(!r.sheetRows||r.sheetRows>F)&&S.v!==void 0&&(r.dense?(_[F]||(_[F]=[]),_[F][B]=S):_[vr(B)+Pr(F)]=S),S.HRef&&(S.l={Target:Bt(S.HRef)},S.HRefScreenTip&&(S.l.Tooltip=S.HRefScreenTip),delete S.HRef,delete S.HRefScreenTip),(S.MergeAcross||S.MergeDown)&&(V=B+(parseInt(S.MergeAcross,10)|0),K=F+(parseInt(S.MergeDown,10)|0),A.push({s:{c:B,r:F},e:{c:V,r:K}})),!r.sheetStubs)S.MergeAcross?B=V+1:++B;else if(S.MergeAcross||S.MergeDown){for(var De=B;De<=V;++De)for(var ke=F;ke<=K;++ke)(De>B||ke>F)&&(r.dense?(_[ke]||(_[ke]=[]),_[ke][De]={t:"z"}):_[vr(De)+Pr(ke)]={t:"z"});B=V+1}else++B;else S=VH(u[0]),S.Index&&(B=+S.Index-1),B<z.s.c&&(z.s.c=B),B>z.e.c&&(z.e.c=B),u[0].slice(-2)==="/>"&&++B,he=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(F<z.s.r&&(z.s.r=F),F>z.e.r&&(z.e.r=F),u[0].slice(-2)==="/>"&&(w=Qa(u[0]),w.Index&&(F=+w.Index-1)),B=0,++F):(w=Qa(u[0]),w.Index&&(F=+w.Index-1),ge={},(w.AutoFitHeight=="0"||w.Height)&&(ge.hpx=parseInt(w.Height,10),ge.hpt=s0(ge.hpx),ee[F]=ge),w.Hidden=="1"&&(ge.hidden=!0,ee[F]=ge));break;case"worksheet":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));v.push(E),z.s.r<=z.e.r&&z.s.c<=z.e.c&&(_["!ref"]=vt(z),r.sheetRows&&r.sheetRows<=z.e.r&&(_["!fullref"]=_["!ref"],z.e.r=r.sheetRows-1,_["!ref"]=vt(z))),A.length&&(_["!merges"]=A),ne.length>0&&(_["!cols"]=ne),ee.length>0&&(_["!rows"]=ee),m[E]=_}else z={s:{r:2e6,c:2e6},e:{r:0,c:0}},F=B=0,f.push([u[3],!1]),d=Qa(u[0]),E=Bt(d.Name),_=r.dense?[]:{},A=[],ie=[],ee=[],te={name:E,Hidden:0},Y.Sheets.push(te);break;case"table":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else{if(u[0].slice(-2)=="/>")break;f.push([u[3],!1]),ne=[],Ve=!1}break;case"style":u[1]==="/"?GH(q,W,r):W=Qa(u[0]);break;case"numberformat":W.nf=Bt(Qa(u[0]).Format||"General"),Bf[W.nf]&&(W.nf=Bf[W.nf]);for(var Fe=0;Fe!=392&&at[Fe]!=W.nf;++Fe);if(Fe==392){for(Fe=57;Fe!=392;++Fe)if(at[Fe]==null){Mi(W.nf,Fe);break}}break;case"column":if(f[f.length-1][0]!=="table")break;if(ue=Qa(u[0]),ue.Hidden&&(ue.hidden=!0,delete ue.Hidden),ue.Width&&(ue.wpx=parseInt(ue.Width,10)),!Ve&&ue.wpx>10){Ve=!0,Dn=S4;for(var ye=0;ye<ne.length;++ye)ne[ye]&&Eo(ne[ye])}Ve&&Eo(ue),ne[ue.Index-1||ne.length]=ue;for(var Be=0;Be<+ue.Span;++Be)ne[ne.length]=dr(ue);break;case"namedrange":if(u[1]==="/")break;Y.Names||(Y.Names=[]);var X=dt(u[0]),rt={Name:X.Name,Ref:qc(X.RefersTo.slice(1),{r:0,c:0})};Y.Sheets.length>0&&(rt.Sheet=Y.Sheets.length-1),Y.Names.push(rt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?k+=n.slice(I,u.index):I=u.index+u[0].length;break;case"interior":if(!r.cellStyles)break;W.Interior=Qa(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?gL(O,ce,n.slice(N,u.index)):N=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else f.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));WH(we),he.push(we)}else f.push([u[3],!1]),d=Qa(u[0]),we={a:d.Author};break;case"autofilter":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var nt=Qa(u[0]);_["!autofilter"]={ref:qc(nt.Range).replace(/\$/g,"")},f.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&f.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&f.push([u[3],!0]);break;case"null":break;default:if(f.length==0&&u[3]=="document"||f.length==0&&u[3]=="uof")return sb(n,r);var wt=!0;switch(f[f.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:wt=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:wt=!1}break;case"excelworkbook":switch(u[3]){case"date1904":Y.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:wt=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:wt=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(n.slice(N,u.index)){case"SheetHidden":te.Hidden=1;break;case"SheetVeryHidden":te.Hidden=2;break}else N=u.index+u[0].length;break;case"header":_["!margins"]||pl(_["!margins"]={},"xlml"),isNaN(+dt(u[0]).Margin)||(_["!margins"].header=+dt(u[0]).Margin);break;case"footer":_["!margins"]||pl(_["!margins"]={},"xlml"),isNaN(+dt(u[0]).Margin)||(_["!margins"].footer=+dt(u[0]).Margin);break;case"pagemargins":var ut=dt(u[0]);_["!margins"]||pl(_["!margins"]={},"xlml"),isNaN(+ut.Top)||(_["!margins"].top=+ut.Top),isNaN(+ut.Left)||(_["!margins"].left=+ut.Left),isNaN(+ut.Right)||(_["!margins"].right=+ut.Right),isNaN(+ut.Bottom)||(_["!margins"].bottom=+ut.Bottom);break;case"displayrighttoleft":Y.Views||(Y.Views=[]),Y.Views[0]||(Y.Views[0]={}),Y.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:wt=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:wt=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:wt=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:wt=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:wt=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:wt=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:wt=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:wt=!1}break;case"smarttags":break;default:wt=!1;break}if(wt||u[3].match(/!\[CDATA/))break;if(!f[f.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+f.join("|");if(f[f.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?HH(M,ce,D,n.slice(N,u.index)):(D=u,N=u.index+u[0].length);break}if(r.WTF)throw"Unrecognized tag: "+u[3]+"|"+f.join("|")}var Ue={};return!r.bookSheets&&!r.bookProps&&(Ue.Sheets=m),Ue.SheetNames=v,Ue.Workbook=Y,Ue.SSF=dr(at),Ue.Props=O,Ue.Custprops=M,Ue}function ix(t,e){switch(Yv(e=e||{}),e.type||"base64"){case"base64":return f1(wa(t),e);case"binary":case"buffer":case"file":return f1(t,e);case"array":return f1(No(t),e)}}function XH(t,e){var r=[];return t.Props&&r.push(xL(t.Props,e)),t.Custprops&&r.push(vL(t.Props,t.Custprops)),r.join("")}function KH(){return""}function YH(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,a){var o=[];o.push(ze("NumberFormat",null,{"ss:Format":Zt(at[n.numFmtId])}));var l={"ss:ID":"s"+(21+a)};r.push(ze("Style",o.join(""),l))}),ze("Styles",r.join(""))}function Z4(t){return ze("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+zv(t.Ref,{r:0,c:0})})}function $H(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var a=e[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(Z4(a)))}return ze("Names",r.join(""))}function QH(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,o=[],l=0;l<a.length;++l){var u=a[l];u.Sheet==r&&(u.Name.match(/^_xlfn\./)||o.push(Z4(u)))}return o.join("")}function ZH(t,e,r,n){if(!t)return"";var a=[];if(t["!margins"]&&(a.push("<PageSetup>"),t["!margins"].header&&a.push(ze("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&a.push(ze("Footer",null,{"x:Margin":t["!margins"].footer})),a.push(ze("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(ze("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var o=0;o<r&&!(n.Workbook.Sheets[o]&&!n.Workbook.Sheets[o].Hidden);++o);o==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),t["!protect"]&&(a.push(wn("ProtectContents","True")),t["!protect"].objects&&a.push(wn("ProtectObjects","True")),t["!protect"].scenarios&&a.push(wn("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?a.push(wn("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&a.push(wn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){t["!protect"][l[0]]&&a.push("<"+l[1]+"/>")})),a.length==0?"":ze("WorksheetOptions",a.join(""),{xmlns:ma.x})}function JH(t){return t.map(function(e){var r=yP(e.t||""),n=ze("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return ze("Comment",n,{"ss:Author":e.a})}).join("")}function ez(t,e,r,n,a,o,l){if(!t||t.v==null&&t.f==null)return"";var u={};if(t.f&&(u["ss:Formula"]="="+Zt(zv(t.f,l))),t.F&&t.F.slice(0,e.length)==e){var f=_r(t.F.slice(e.length+1));u["ss:ArrayRange"]="RC:R"+(f.r==l.r?"":"["+(f.r-l.r)+"]")+"C"+(f.c==l.c?"":"["+(f.c-l.c)+"]")}if(t.l&&t.l.Target&&(u["ss:HRef"]=Zt(t.l.Target),t.l.Tooltip&&(u["x:HRefScreenTip"]=Zt(t.l.Tooltip))),r["!merges"])for(var d=r["!merges"],m=0;m!=d.length;++m)d[m].s.c!=l.c||d[m].s.r!=l.r||(d[m].e.c>d[m].s.c&&(u["ss:MergeAcross"]=d[m].e.c-d[m].s.c),d[m].e.r>d[m].s.r&&(u["ss:MergeDown"]=d[m].e.r-d[m].s.r));var v="",_="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":v="Number",_=String(t.v);break;case"b":v="Boolean",_=t.v?"1":"0";break;case"e":v="Error",_=Es[t.v];break;case"d":v="DateTime",_=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||at[14]);break;case"s":v="String",_=_P(t.v||"");break}var E=Do(n.cellXfs,t,n);u["ss:StyleID"]="s"+(21+E),u["ss:Index"]=l.c+1;var S=t.v!=null?_:"",w=t.t=="z"?"":'<Data ss:Type="'+v+'">'+S+"</Data>";return(t.c||[]).length>0&&(w+=JH(t.c)),ze("Cell",w,u)}function tz(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=tu(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function rz(t,e,r,n){if(!t["!ref"])return"";var a=Vt(t["!ref"]),o=t["!merges"]||[],l=0,u=[];t["!cols"]&&t["!cols"].forEach(function(b,L){Eo(b);var B=!!b.width,F=Vm(L,b),z={"ss:Index":L+1};B&&(z["ss:Width"]=a0(F.width)),b.hidden&&(z["ss:Hidden"]="1"),u.push(ze("Column",null,z))});for(var f=Array.isArray(t),d=a.s.r;d<=a.e.r;++d){for(var m=[tz(d,(t["!rows"]||[])[d])],v=a.s.c;v<=a.e.c;++v){var _=!1;for(l=0;l!=o.length;++l)if(!(o[l].s.c>v)&&!(o[l].s.r>d)&&!(o[l].e.c<v)&&!(o[l].e.r<d)){(o[l].s.c!=v||o[l].s.r!=d)&&(_=!0);break}if(!_){var E={r:d,c:v},S=ot(E),w=f?(t[d]||[])[v]:t[S];m.push(ez(w,S,t,e,r,n,E))}}m.push("</Row>"),m.length>2&&u.push(m.join(""))}return u.join("")}function nz(t,e,r){var n=[],a=r.SheetNames[t],o=r.Sheets[a],l=o?QH(o,e,t,r):"";return l.length>0&&n.push("<Names>"+l+"</Names>"),l=o?rz(o,e,t,r):"",l.length>0&&n.push("<Table>"+l+"</Table>"),n.push(ZH(o,e,t,r)),n.join("")}function az(t,e){e||(e={}),t.SSF||(t.SSF=dr(at)),t.SSF&&(cu(),A0(t.SSF),e.revssf=Pm(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],Do(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(XH(t,e)),r.push(KH()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(ze("Worksheet",nz(n,e,t),{"ss:Name":Zt(t.SheetNames[n])}));return r[2]=YH(t,e),r[3]=$H(t),Lr+ze("Workbook",r.join(""),{xmlns:ma.ss,"xmlns:o":ma.o,"xmlns:x":ma.x,"xmlns:ss":ma.ss,"xmlns:dt":ma.dt,"xmlns:html":ma.html})}function iz(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=$P(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=QP(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var sz=[60,1084,2066,2165,2175];function oz(t,e,r,n,a){var o=n,l=[],u=r.slice(r.l,r.l+o);if(a&&a.enc&&a.enc.insitu&&u.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(u)}l.push(u),r.l+=o;for(var f=fs(r,r.l),d=sx[f],m=0;d!=null&&sz.indexOf(f)>-1;)o=fs(r,r.l+2),m=r.l+4,f==2066?m+=4:(f==2165||f==2175)&&(m+=12),u=r.slice(m,r.l+4+o),l.push(u),r.l+=4+o,d=sx[f=fs(r,r.l)];var v=un(l);_n(v,0);var _=0;v.lens=[];for(var E=0;E<l.length;++E)v.lens.push(_),_+=l[E].length;if(v.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+v.length+" < "+n;return e.f(v,v.length,a)}function Ti(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=at[n])}catch(o){if(e.WTF)throw o}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Es[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Zf(t.v):t.w=bl(t.v):t.w=Ea(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(o){if(e.WTF)throw o}if(e.cellDates&&n&&t.t=="n"&&Fl(at[n]||String(n))){var a=io(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function md(t,e,r){return{v:t,ixfe:e,t:r}}function lz(t,e){var r={opts:{}},n={},a=e.dense?[]:{},o={},l={},u=null,f=[],d="",m={},v,_="",E,S,w,b,L={},B=[],F,z,q=[],W=[],k={Sheets:[],WBProps:{date1904:!1},Views:[{}]},I={},A=function(Re){return Re<8?hl[Re]:Re<64&&W[Re-8]||hl[Re]},O=function(Re,Je,pt){var mt=Je.XF.data;if(!(!mt||!mt.patternType||!pt||!pt.cellStyles)){Je.s={},Je.s.patternType=mt.patternType;var sr;(sr=n0(A(mt.icvFore)))&&(Je.s.fgColor={rgb:sr}),(sr=n0(A(mt.icvBack)))&&(Je.s.bgColor={rgb:sr})}},M=function(Re,Je,pt){if(!(ge>1)&&!(pt.sheetRows&&Re.r>=pt.sheetRows)){if(pt.cellStyles&&Je.XF&&Je.XF.data&&O(Re,Je,pt),delete Je.ixfe,delete Je.XF,v=Re,_=ot(Re),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),Re.r<l.s.r&&(l.s.r=Re.r),Re.c<l.s.c&&(l.s.c=Re.c),Re.r+1>l.e.r&&(l.e.r=Re.r+1),Re.c+1>l.e.c&&(l.e.c=Re.c+1),pt.cellFormula&&Je.f){for(var mt=0;mt<B.length;++mt)if(!(B[mt][0].s.c>Re.c||B[mt][0].s.r>Re.r)&&!(B[mt][0].e.c<Re.c||B[mt][0].e.r<Re.r)){Je.F=vt(B[mt][0]),(B[mt][0].s.c!=Re.c||B[mt][0].s.r!=Re.r)&&delete Je.f,Je.f&&(Je.f=""+Nn(B[mt][1],l,Re,ie,N));break}}pt.dense?(a[Re.r]||(a[Re.r]=[]),a[Re.r][Re.c]=Je):a[_]=Je}},N={enc:!1,sbcch:0,snames:[],sharedf:L,arrayf:B,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(N.password=e.password);var D,he=[],we=[],ne=[],ue=[],Ve=!1,ie=[];ie.SheetNames=N.snames,ie.sharedf=N.sharedf,ie.arrayf=N.arrayf,ie.names=[],ie.XTI=[];var ee=0,ge=0,V=0,K=[],Y=[],te;N.codepage=1200,Ja(1200);for(var ce=!1;t.l<t.length-1;){var De=t.l,ke=t.read_shift(2);if(ke===0&&ee===10)break;var Fe=t.l===t.length?0:t.read_shift(2),ye=sx[ke];if(ye&&ye.f){if(e.bookSheets&&ee===133&&ke!==133)break;if(ee=ke,ye.r===2||ye.r==12){var Be=t.read_shift(2);if(Fe-=2,!N.enc&&Be!==ke&&((Be&255)<<8|Be>>8)!==ke)throw new Error("rt mismatch: "+Be+"!="+ke);ye.r==12&&(t.l+=10,Fe-=10)}var X={};if(ke===10?X=ye.f(t,Fe,N):X=oz(ke,ye,t,Fe,N),ge==0&&[9,521,1033,2057].indexOf(ee)===-1)continue;switch(ke){case 34:r.opts.Date1904=k.WBProps.date1904=X;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(N.enc||(t.l=0),N.enc=X,!e.password)throw new Error("File is password-protected");if(X.valid==null)throw new Error("Encryption scheme unsupported");if(!X.valid)throw new Error("Password is incorrect");break;case 92:N.lastuser=X;break;case 66:var rt=Number(X);switch(rt){case 21010:rt=1200;break;case 32768:rt=1e4;break;case 32769:rt=1252;break}Ja(N.codepage=rt),ce=!0;break;case 317:N.rrtabid=X;break;case 25:N.winlocked=X;break;case 439:r.opts.RefreshAll=X;break;case 12:r.opts.CalcCount=X;break;case 16:r.opts.CalcDelta=X;break;case 17:r.opts.CalcIter=X;break;case 13:r.opts.CalcMode=X;break;case 14:r.opts.CalcPrecision=X;break;case 95:r.opts.CalcSaveRecalc=X;break;case 15:N.CalcRefMode=X;break;case 2211:r.opts.FullCalc=X;break;case 129:X.fDialog&&(a["!type"]="dialog"),X.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),X.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:q.push(X);break;case 430:ie.push([X]),ie[ie.length-1].XTI=[];break;case 35:case 547:ie[ie.length-1].push(X);break;case 24:case 536:te={Name:X.Name,Ref:Nn(X.rgce,l,null,ie,N)},X.itab>0&&(te.Sheet=X.itab-1),ie.names.push(te),ie[0]||(ie[0]=[],ie[0].XTI=[]),ie[ie.length-1].push(X),X.Name=="_xlnm._FilterDatabase"&&X.itab>0&&X.rgce&&X.rgce[0]&&X.rgce[0][0]&&X.rgce[0][0][0]=="PtgArea3d"&&(Y[X.itab-1]={ref:vt(X.rgce[0][0][1][2])});break;case 22:N.ExternCount=X;break;case 23:ie.length==0&&(ie[0]=[],ie[0].XTI=[]),ie[ie.length-1].XTI=ie[ie.length-1].XTI.concat(X),ie.XTI=ie.XTI.concat(X);break;case 2196:if(N.biff<8)break;te!=null&&(te.Comment=X[1]);break;case 18:a["!protect"]=X;break;case 19:X!==0&&N.WTF&&console.error("Password verifier: "+X);break;case 133:o[X.pos]=X,N.snames.push(X.name);break;case 10:{if(--ge)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,a["!ref"]=vt(l),e.sheetRows&&e.sheetRows<=l.e.r){var nt=l.e.r;l.e.r=e.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=vt(l),l.e.r=nt}l.e.r++,l.e.c++}he.length>0&&(a["!merges"]=he),we.length>0&&(a["!objects"]=we),ne.length>0&&(a["!cols"]=ne),ue.length>0&&(a["!rows"]=ue),k.Sheets.push(I)}d===""?m=a:n[d]=a,a=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(N.biff===8&&(N.biff={9:2,521:3,1033:4}[ke]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[X.BIFFVer]||8),N.biffguess=X.BIFFVer==0,X.BIFFVer==0&&X.dt==4096&&(N.biff=5,ce=!0,Ja(N.codepage=28591)),N.biff==8&&X.BIFFVer==0&&X.dt==16&&(N.biff=2),ge++)break;if(a=e.dense?[]:{},N.biff<8&&!ce&&(ce=!0,Ja(N.codepage=e.codepage||1252)),N.biff<5||X.BIFFVer==0&&X.dt==4096){d===""&&(d="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var wt={pos:t.l-Fe,name:d};o[wt.pos]=wt,N.snames.push(d)}else d=(o[De]||{name:""}).name;X.dt==32&&(a["!type"]="chart"),X.dt==64&&(a["!type"]="macro"),he=[],we=[],N.arrayf=B=[],ne=[],ue=[],Ve=!1,I={Hidden:(o[De]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(e.dense?(a[X.r]||[])[X.c]:a[ot({c:X.c,r:X.r})])&&++X.c,F={ixfe:X.ixfe,XF:q[X.ixfe]||{},v:X.val,t:"n"},V>0&&(F.z=K[F.ixfe>>8&63]),Ti(F,e,r.opts.Date1904),M({c:X.c,r:X.r},F,e);break;case 5:case 517:F={ixfe:X.ixfe,XF:q[X.ixfe],v:X.val,t:X.t},V>0&&(F.z=K[F.ixfe>>8&63]),Ti(F,e,r.opts.Date1904),M({c:X.c,r:X.r},F,e);break;case 638:F={ixfe:X.ixfe,XF:q[X.ixfe],v:X.rknum,t:"n"},V>0&&(F.z=K[F.ixfe>>8&63]),Ti(F,e,r.opts.Date1904),M({c:X.c,r:X.r},F,e);break;case 189:for(var ut=X.c;ut<=X.C;++ut){var Ue=X.rkrec[ut-X.c][0];F={ixfe:Ue,XF:q[Ue],v:X.rkrec[ut-X.c][1],t:"n"},V>0&&(F.z=K[F.ixfe>>8&63]),Ti(F,e,r.opts.Date1904),M({c:ut,r:X.r},F,e)}break;case 6:case 518:case 1030:{if(X.val=="String"){u=X;break}if(F=md(X.val,X.cell.ixfe,X.tt),F.XF=q[F.ixfe],e.cellFormula){var Jt=X.formula;if(Jt&&Jt[0]&&Jt[0][0]&&Jt[0][0][0]=="PtgExp"){var Cr=Jt[0][0][1][0],Mr=Jt[0][0][1][1],Xr=ot({r:Cr,c:Mr});L[Xr]?F.f=""+Nn(X.formula,l,X.cell,ie,N):F.F=((e.dense?(a[Cr]||[])[Mr]:a[Xr])||{}).F}else F.f=""+Nn(X.formula,l,X.cell,ie,N)}V>0&&(F.z=K[F.ixfe>>8&63]),Ti(F,e,r.opts.Date1904),M(X.cell,F,e),u=X}break;case 7:case 519:if(u)u.val=X,F=md(X,u.cell.ixfe,"s"),F.XF=q[F.ixfe],e.cellFormula&&(F.f=""+Nn(u.formula,l,u.cell,ie,N)),V>0&&(F.z=K[F.ixfe>>8&63]),Ti(F,e,r.opts.Date1904),M(u.cell,F,e),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{B.push(X);var Ga=ot(X[0].s);if(E=e.dense?(a[X[0].s.r]||[])[X[0].s.c]:a[Ga],e.cellFormula&&E){if(!u||!Ga||!E)break;E.f=""+Nn(X[1],l,X[0],ie,N),E.F=vt(X[0])}}break;case 1212:{if(!e.cellFormula)break;if(_){if(!u)break;L[ot(u.cell)]=X[0],E=e.dense?(a[u.cell.r]||[])[u.cell.c]:a[ot(u.cell)],(E||{}).f=""+Nn(X[0],l,v,ie,N)}}break;case 253:F=md(f[X.isst].t,X.ixfe,"s"),f[X.isst].h&&(F.h=f[X.isst].h),F.XF=q[F.ixfe],V>0&&(F.z=K[F.ixfe>>8&63]),Ti(F,e,r.opts.Date1904),M({c:X.c,r:X.r},F,e);break;case 513:e.sheetStubs&&(F={ixfe:X.ixfe,XF:q[X.ixfe],t:"z"},V>0&&(F.z=K[F.ixfe>>8&63]),Ti(F,e,r.opts.Date1904),M({c:X.c,r:X.r},F,e));break;case 190:if(e.sheetStubs)for(var hn=X.c;hn<=X.C;++hn){var Rr=X.ixfe[hn-X.c];F={ixfe:Rr,XF:q[Rr],t:"z"},V>0&&(F.z=K[F.ixfe>>8&63]),Ti(F,e,r.opts.Date1904),M({c:hn,r:X.r},F,e)}break;case 214:case 516:case 4:F=md(X.val,X.ixfe,"s"),F.XF=q[F.ixfe],V>0&&(F.z=K[F.ixfe>>8&63]),Ti(F,e,r.opts.Date1904),M({c:X.c,r:X.r},F,e);break;case 0:case 512:ge===1&&(l=X);break;case 252:f=X;break;case 1054:if(N.biff==4){K[V++]=X[1];for(var Tn=0;Tn<V+163&&at[Tn]!=X[1];++Tn);Tn>=163&&Mi(X[1],V+163)}else Mi(X[1],X[0]);break;case 30:{K[V++]=X;for(var Ut=0;Ut<V+163&&at[Ut]!=X;++Ut);Ut>=163&&Mi(X,V+163)}break;case 229:he=he.concat(X);break;case 93:we[X.cmo[0]]=N.lastobj=X;break;case 438:N.lastobj.TxO=X;break;case 127:N.lastobj.ImData=X;break;case 440:for(b=X[0].s.r;b<=X[0].e.r;++b)for(w=X[0].s.c;w<=X[0].e.c;++w)E=e.dense?(a[b]||[])[w]:a[ot({c:w,r:b})],E&&(E.l=X[1]);break;case 2048:for(b=X[0].s.r;b<=X[0].e.r;++b)for(w=X[0].s.c;w<=X[0].e.c;++w)E=e.dense?(a[b]||[])[w]:a[ot({c:w,r:b})],E&&E.l&&(E.l.Tooltip=X[1]);break;case 28:{if(N.biff<=5&&N.biff>=2)break;E=e.dense?(a[X[0].r]||[])[X[0].c]:a[ot(X[0])];var kt=we[X[2]];E||(e.dense?(a[X[0].r]||(a[X[0].r]=[]),E=a[X[0].r][X[0].c]={t:"z"}):E=a[ot(X[0])]={t:"z"},l.e.r=Math.max(l.e.r,X[0].r),l.s.r=Math.min(l.s.r,X[0].r),l.e.c=Math.max(l.e.c,X[0].c),l.s.c=Math.min(l.s.c,X[0].c)),E.c||(E.c=[]),S={a:X[1],t:kt.TxO.t},E.c.push(S)}break;case 2173:Y7(q[X.ixfe],X.ext);break;case 125:{if(!N.cellStyles)break;for(;X.e>=X.s;)ne[X.e--]={width:X.w/256,level:X.level||0,hidden:!!(X.flags&1)},Ve||(Ve=!0,Vv(X.w/256)),Eo(ne[X.e+1])}break;case 520:{var se={};X.level!=null&&(ue[X.r]=se,se.level=X.level),X.hidden&&(ue[X.r]=se,se.hidden=!0),X.hpt&&(ue[X.r]=se,se.hpt=X.hpt,se.hpx=tu(X.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||pl(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ke]]=X;break;case 161:a["!margins"]||pl(a["!margins"]={}),a["!margins"].header=X.header,a["!margins"].footer=X.footer;break;case 574:X.RTL&&(k.Views[0].RTL=!0);break;case 146:W=X;break;case 2198:D=X;break;case 140:z=X;break;case 442:d?I.CodeName=X||I.name:k.WBProps.CodeName=X||"ThisWorkbook";break}}else ye||console.error("Missing Info for XLS Record 0x"+ke.toString(16)),t.l+=Fe}return r.SheetNames=Ar(o).sort(function(Me,Re){return Number(Me)-Number(Re)}).map(function(Me){return o[Me].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&m["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=m)):r.Preamble=m,r.Sheets&&Y.forEach(function(Me,Re){r.Sheets[r.SheetNames[Re]]["!autofilter"]=Me}),r.Strings=f,r.SSF=dr(at),N.enc&&(r.Encryption=N.enc),D&&(r.Themes=D),r.Metadata={},z!==void 0&&(r.Metadata.Country=z),ie.names.length>0&&(k.Names=ie.names),r.Workbook=k,r}var Vf={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function cz(t,e,r){var n=et.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=LT(n,J1,Vf.DSI);for(var o in a)e[o]=a[o]}catch(d){if(r.WTF)throw d}var l=et.find(t,"/!SummaryInformation");if(l&&l.size>0)try{var u=LT(l,ex,Vf.SI);for(var f in u)e[f]==null&&(e[f]=u[f])}catch(d){if(r.WTF)throw d}e.HeadingPairs&&e.TitlesOfParts&&(Qk(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function uz(t,e){var r=[],n=[],a=[],o=0,l,u=hT(J1,"n"),f=hT(ex,"n");if(t.Props)for(l=Ar(t.Props),o=0;o<l.length;++o)(Object.prototype.hasOwnProperty.call(u,l[o])?r:Object.prototype.hasOwnProperty.call(f,l[o])?n:a).push([l[o],t.Props[l[o]]]);if(t.Custprops)for(l=Ar(t.Custprops),o=0;o<l.length;++o)Object.prototype.hasOwnProperty.call(t.Props||{},l[o])||(Object.prototype.hasOwnProperty.call(u,l[o])?r:Object.prototype.hasOwnProperty.call(f,l[o])?n:a).push([l[o],t.Custprops[l[o]]]);var d=[];for(o=0;o<a.length;++o)a4.indexOf(a[o][0])>-1||$k.indexOf(a[o][0])>-1||a[o][1]!=null&&d.push(a[o]);n.length&&et.utils.cfb_add(e,"/SummaryInformation",MT(n,Vf.SI,f,ex)),(r.length||d.length)&&et.utils.cfb_add(e,"/DocumentSummaryInformation",MT(r,Vf.DSI,u,J1,d.length?d:null,Vf.UDI))}function J4(t,e){e||(e={}),Yv(e),gv(),e.codepage&&pv(e.codepage);var r,n;if(t.FullPaths){if(et.find(t,"/encryption"))throw new Error("File is password-protected");r=et.find(t,"!CompObj"),n=et.find(t,"/Workbook")||et.find(t,"/Book")}else{switch(e.type){case"base64":t=xa(wa(t));break;case"binary":t=xa(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}_n(t,0),n={content:t}}var a,o;if(r&&iz(r),e.bookProps&&!e.bookSheets)a={};else{var l=bt?"buffer":"array";if(n&&n.content)a=lz(n.content,e);else if((o=et.find(t,"PerfectOffice_MAIN"))&&o.content)a=ml.to_workbook(o.content,(e.type=l,e));else if((o=et.find(t,"NativeContent_MAIN"))&&o.content)a=ml.to_workbook(o.content,(e.type=l,e));else throw(o=et.find(t,"MN0"))&&o.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&et.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=TU(t))}var u={};return t.FullPaths&&cz(t,u,e),a.Props=a.Custprops=u,e.bookFiles&&(a.cfb=t),a}function fz(t,e){var r=e||{},n=et.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return et.utils.cfb_add(n,a,eC(t,r)),r.biff==8&&(t.Props||t.Custprops)&&uz(t,n),r.biff==8&&t.vbaraw&&bU(n,et.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var o0={0:{f:PV},1:{f:zV},2:{f:lj},3:{f:QV},4:{f:XV},5:{f:ij},6:{f:dj},7:{f:tj},8:{f:yj},9:{f:_j},10:{f:xj},11:{f:vj},12:{f:qV},13:{f:uj},14:{f:JV},15:{f:YV},16:{f:q4},17:{f:pj},18:{f:nj},19:{f:Nv},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:pH},40:{},42:{},43:{f:d7},44:{f:f7},45:{f:g7},46:{f:v7},47:{f:x7},48:{},49:{f:UP},50:{},51:{f:Z7},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:p4},62:{f:hj},63:{f:oU},64:{f:Lj},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ln,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Dj},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:jV},148:{f:UV,p:16},151:{f:Aj},152:{},153:{f:hH},154:{},155:{},156:{f:uH},157:{},158:{},159:{T:1,f:C9},160:{T:-1},161:{T:1,f:Bl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:wj},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:$7},336:{T:-1},337:{f:tU,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Z1},357:{},358:{},359:{},360:{T:1},361:{},362:{f:m4},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:kj},427:{f:Cj},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Nj},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:VV},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:bj},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Z1},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:vU},633:{T:1},634:{T:-1},635:{T:1,f:gU},636:{T:-1},637:{f:HP},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Jj},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Mj},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},sx={6:{f:c1},10:{f:Qs},12:{f:Gr},13:{f:Gr},14:{f:Or},15:{f:Or},16:{f:On},17:{f:Or},18:{f:Or},19:{f:Gr},20:{f:zT},21:{f:zT},23:{f:m4},24:{f:qT},25:{f:Or},26:{},27:{},28:{f:MM},29:{},34:{f:Or},35:{f:GT},38:{f:On},39:{f:On},40:{f:On},41:{f:On},42:{f:Or},43:{f:Or},47:{f:Y9},49:{f:uM},51:{f:Gr},60:{},61:{f:iM},64:{f:Or},65:{f:cM},66:{f:Gr},77:{},80:{},81:{},82:{},85:{f:Gr},89:{},90:{},91:{},92:{f:KL},93:{f:VM},94:{},95:{f:Or},96:{},97:{},99:{f:Or},125:{f:p4},128:{f:SM},129:{f:$L},130:{f:Gr},131:{f:Or},132:{f:Or},133:{f:QL},134:{},140:{f:KM},141:{f:Gr},144:{},146:{f:QM},151:{},152:{},153:{},154:{},155:{},156:{f:Gr},157:{},158:{},160:{f:a9},161:{f:e9},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:wM},190:{f:EM},193:{f:Qs},197:{},198:{},199:{},200:{},201:{},202:{f:Or},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Gr},220:{},221:{f:Or},222:{},224:{f:bM},225:{f:XL},226:{f:Qs},227:{},229:{f:UM},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:JL},253:{f:hM},255:{f:tM},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:i4},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Or},353:{f:Qs},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:NM},431:{f:Or},432:{},433:{},434:{},437:{},438:{f:zM},439:{f:Or},440:{f:GM},441:{},442:{f:N0},443:{},444:{f:Gr},445:{},446:{},448:{f:Qs},449:{f:aM,r:2},450:{f:Qs},512:{f:VT},513:{f:n9},515:{f:CM},516:{f:mM},517:{f:HT},519:{f:i9},520:{f:rM},523:{},545:{f:WT},549:{f:BT},566:{},574:{f:oM},638:{f:yM},659:{},1048:{},1054:{f:gM},1084:{},1212:{f:FM},2048:{f:WM},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:fd},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Qs},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:ZM,r:12},2173:{f:K7,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Or,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:OM,r:12},2197:{},2198:{f:H7,r:12},2199:{},2200:{},2201:{},2202:{f:PM,r:12},2203:{f:Qs},2204:{},2205:{},2206:{},2207:{},2211:{f:nM},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Gr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:t9},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:$M},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:VT},1:{},2:{f:u9},3:{f:l9},4:{f:o9},5:{f:HT},7:{f:h9},8:{},9:{f:fd},11:{},22:{f:Gr},30:{f:vM},31:{},32:{},33:{f:WT},36:{},37:{f:BT},50:{f:d9},62:{},52:{},67:{},68:{f:Gr},69:{},86:{},126:{},127:{f:s9},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:m9},223:{},234:{},354:{},421:{},518:{f:c1},521:{f:fd},536:{f:qT},547:{f:GT},561:{},579:{},1030:{f:c1},1033:{f:fd},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function qe(t,e,r,n){var a=e;if(!isNaN(a)){var o=n||(r||[]).length||0,l=t.next(4);l.write_shift(2,a),l.write_shift(2,o),o>0&&kv(r)&&t.push(r)}}function hz(t,e,r,n){var a=(r||[]).length||0;if(a<=8224)return qe(t,e,r,a);var o=e;if(!isNaN(o)){for(var l=r.parts||[],u=0,f=0,d=0;d+(l[u]||8224)<=8224;)d+=l[u]||8224,u++;var m=t.next(4);for(m.write_shift(2,o),m.write_shift(2,d),t.push(r.slice(f,f+d)),f+=d;f<a;){for(m=t.next(4),m.write_shift(2,60),d=0;d+(l[u]||8224)<=8224;)d+=l[u]||8224,u++;m.write_shift(2,d),t.push(r.slice(f,f+d)),f+=d}}}function F0(t,e,r){return t||(t=Se(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function dz(t,e,r,n){var a=Se(9);return F0(a,t,e),s4(r,n||"b",a),a}function mz(t,e,r){var n=Se(8+2*r.length);return F0(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function pz(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var a=e.t=="d"?tn(hr(e.v)):e.v;a==(a|0)&&a>=0&&a<65536?qe(t,2,f9(r,n,a)):qe(t,3,c9(r,n,a));return;case"b":case"e":qe(t,5,dz(r,n,e.v,e.t));return;case"s":case"str":qe(t,4,mz(r,n,(e.v||"").slice(0,255)));return}qe(t,1,F0(null,r,n))}function gz(t,e,r,n){var a=Array.isArray(e),o=Vt(e["!ref"]||"A1"),l,u="",f=[];if(o.e.c>255||o.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");o.e.c=Math.min(o.e.c,255),o.e.r=Math.min(o.e.c,16383),l=vt(o)}for(var d=o.s.r;d<=o.e.r;++d){u=Pr(d);for(var m=o.s.c;m<=o.e.c;++m){d===o.s.r&&(f[m]=vr(m)),l=f[m]+u;var v=a?(e[d]||[])[m]:e[l];v&&pz(t,v,d,m)}}}function xz(t,e){for(var r=e||{},n=na(),a=0,o=0;o<t.SheetNames.length;++o)t.SheetNames[o]==r.sheet&&(a=o);if(a==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return qe(n,r.biff==4?1033:r.biff==3?521:9,Mv(t,16,r)),gz(n,t.Sheets[t.SheetNames[a]],a,r),qe(n,10),n.end()}function vz(t,e,r){qe(t,49,fM({sz:12,name:"Arial"},r))}function _z(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&qe(t,1054,xM(a,e[a],r))})}function yz(t,e){var r=Se(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),qe(t,2151,r),r=Se(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),f4(Vt(e["!ref"]||"A1"),r),r.write_shift(4,4),qe(t,2152,r)}function wz(t,e){for(var r=0;r<16;++r)qe(t,224,jT({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){qe(t,224,jT(n,0,e))})}function Ez(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];qe(t,440,qM(n)),n[1].Tooltip&&qe(t,2048,XM(n))}delete e["!links"]}function Tz(t,e){if(e){var r=0;e.forEach(function(n,a){++r<=256&&n&&qe(t,125,JM(Vm(a,n),a))})}}function bz(t,e,r,n,a){var o=16+Do(a.cellXfs,e,a);if(e.v==null&&!e.bf){qe(t,513,Cl(r,n,o));return}if(e.bf)qe(t,6,$B(e,r,n,a,o));else switch(e.t){case"d":case"n":var l=e.t=="d"?tn(hr(e.v)):e.v;qe(t,515,RM(r,n,l,o));break;case"b":case"e":qe(t,517,kM(r,n,e.v,o,a,e.t));break;case"s":case"str":if(a.bookSST){var u=qv(a.Strings,e.v,a.revStrings);qe(t,253,dM(r,n,u,o))}else qe(t,516,pM(r,n,(e.v||"").slice(0,255),o,a));break;default:qe(t,513,Cl(r,n,o))}}function Sz(t,e,r){var n=na(),a=r.SheetNames[t],o=r.Sheets[a]||{},l=(r||{}).Workbook||{},u=(l.Sheets||[])[t]||{},f=Array.isArray(o),d=e.biff==8,m,v="",_=[],E=Vt(o["!ref"]||"A1"),S=d?65536:16384;if(E.e.c>255||E.e.r>=S){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:IV16384");E.e.c=Math.min(E.e.c,255),E.e.r=Math.min(E.e.c,S-1)}qe(n,2057,Mv(r,16,e)),qe(n,13,Va(1)),qe(n,12,Va(100)),qe(n,15,Wn(!0)),qe(n,17,Wn(!1)),qe(n,16,Al(.001)),qe(n,95,Wn(!0)),qe(n,42,Wn(!1)),qe(n,43,Wn(!1)),qe(n,130,Va(1)),qe(n,128,AM()),qe(n,131,Wn(!1)),qe(n,132,Wn(!1)),d&&Tz(n,o["!cols"]),qe(n,512,_M(E,e)),d&&(o["!links"]=[]);for(var w=E.s.r;w<=E.e.r;++w){v=Pr(w);for(var b=E.s.c;b<=E.e.c;++b){w===E.s.r&&(_[b]=vr(b)),m=_[b]+v;var L=f?(o[w]||[])[b]:o[m];L&&(bz(n,L,w,b,e),d&&L.l&&o["!links"].push([m,L.l]))}}var B=u.CodeName||u.name||a;return d&&qe(n,574,lM((l.Views||[])[0])),d&&(o["!merges"]||[]).length&&qe(n,229,BM(o["!merges"])),d&&Ez(n,o),qe(n,442,o4(B)),d&&yz(n,o),qe(n,10),n.end()}function Az(t,e,r){var n=na(),a=(t||{}).Workbook||{},o=a.Sheets||[],l=a.WBProps||{},u=r.biff==8,f=r.biff==5;if(qe(n,2057,Mv(t,5,r)),r.bookType=="xla"&&qe(n,135),qe(n,225,u?Va(1200):null),qe(n,193,kL(2)),f&&qe(n,191),f&&qe(n,192),qe(n,226),qe(n,92,YL("SheetJS",r)),qe(n,66,Va(u?1200:1252)),u&&qe(n,353,Va(0)),u&&qe(n,448),qe(n,317,r9(t.SheetNames.length)),u&&t.vbaraw&&qe(n,211),u&&t.vbaraw){var d=l.CodeName||"ThisWorkbook";qe(n,442,o4(d))}qe(n,156,Va(17)),qe(n,25,Wn(!1)),qe(n,18,Wn(!1)),qe(n,19,Va(0)),u&&qe(n,431,Wn(!1)),u&&qe(n,444,Va(0)),qe(n,61,sM()),qe(n,64,Wn(!1)),qe(n,141,Va(0)),qe(n,34,Wn(aH(t)=="true")),qe(n,14,Wn(!0)),u&&qe(n,439,Wn(!1)),qe(n,218,Va(0)),vz(n,t,r),_z(n,t.SSF,r),wz(n,r),u&&qe(n,352,Wn(!1));var m=n.end(),v=na();u&&qe(v,140,YM()),u&&r.Strings&&hz(v,252,eM(r.Strings)),qe(v,10);var _=v.end(),E=na(),S=0,w=0;for(w=0;w<t.SheetNames.length;++w)S+=(u?12:11)+(u?2:1)*t.SheetNames[w].length;var b=m.length+S+_.length;for(w=0;w<t.SheetNames.length;++w){var L=o[w]||{};qe(E,133,ZL({pos:b,hs:L.Hidden||0,dt:0,name:t.SheetNames[w]},r)),b+=e[w].length}var B=E.end();if(S!=B.length)throw new Error("BS8 "+S+" != "+B.length);var F=[];return m.length&&F.push(m),B.length&&F.push(B),_.length&&F.push(_),un(F)}function kz(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=dr(at)),t&&t.SSF&&(cu(),A0(t.SSF),r.revssf=Pm(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,$v(r),r.cellXfs=[],Do(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var a=0;a<t.SheetNames.length;++a)n[n.length]=Sz(a,r,t);return n.unshift(Az(t,n,r)),un(n)}function eC(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var a=aa(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var o=e||{};switch(o.biff||2){case 8:case 5:return kz(t,e);case 4:case 3:case 2:return xz(t,e)}throw new Error("invalid type "+o.bookType+" for BIFF")}function rb(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var a=t.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var o=t.match(/<\/table/i),l=a.index,u=o&&o.index||t.length,f=fP(t.slice(l,u),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,m=0,v=0,_=0,E={s:{r:1e7,c:1e7},e:{r:0,c:0}},S=[];for(l=0;l<f.length;++l){var w=f[l].trim(),b=w.slice(0,3).toLowerCase();if(b=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}m=0;continue}if(!(b!="<td"&&b!="<th")){var L=w.split(/<\/t[dh]>/i);for(u=0;u<L.length;++u){var B=L[u].trim();if(B.match(/<t[dh]/i)){for(var F=B,z=0;F.charAt(0)=="<"&&(z=F.indexOf(">"))>-1;)F=F.slice(z+1);for(var q=0;q<S.length;++q){var W=S[q];W.s.c==m&&W.s.r<d&&d<=W.e.r&&(m=W.e.c+1,q=-1)}var k=dt(B.slice(0,B.indexOf(">")));_=k.colspan?+k.colspan:1,((v=+k.rowspan)>1||_>1)&&S.push({s:{r:d,c:m},e:{r:d+(v||1)-1,c:m+_-1}});var I=k.t||k["data-t"]||"";if(!F.length){m+=_;continue}if(F=bk(F),E.s.r>d&&(E.s.r=d),E.e.r<d&&(E.e.r=d),E.s.c>m&&(E.s.c=m),E.e.c<m&&(E.e.c=m),!F.length){m+=_;continue}var A={t:"s",v:F};r.raw||!F.trim().length||I=="s"||(F==="TRUE"?A={t:"b",v:!0}:F==="FALSE"?A={t:"b",v:!1}:isNaN(ri(F))?isNaN(Jc(F).getDate())||(A={t:"d",v:hr(F)},r.cellDates||(A={t:"n",v:tn(A.v)}),A.z=r.dateNF||at[14]):A={t:"n",v:ri(F)}),r.dense?(n[d]||(n[d]=[]),n[d][m]=A):n[ot({r:d,c:m})]=A,m+=_}}}}return n["!ref"]=vt(E),S.length&&(n["!merges"]=S),n}function Cz(t,e,r,n){for(var a=t["!merges"]||[],o=[],l=e.s.c;l<=e.e.c;++l){for(var u=0,f=0,d=0;d<a.length;++d)if(!(a[d].s.r>r||a[d].s.c>l)&&!(a[d].e.r<r||a[d].e.c<l)){if(a[d].s.r<r||a[d].s.c<l){u=-1;break}u=a[d].e.r-a[d].s.r+1,f=a[d].e.c-a[d].s.c+1;break}if(!(u<0)){var m=ot({r,c:l}),v=n.dense?(t[r]||[])[l]:t[m],_=v&&v.v!=null&&(v.h||bv(v.w||(_s(v),v.w)||""))||"",E={};u>1&&(E.rowspan=u),f>1&&(E.colspan=f),n.editable?_='<span contenteditable="true">'+_+"</span>":v&&(E["data-t"]=v&&v.t||"z",v.v!=null&&(E["data-v"]=v.v),v.z!=null&&(E["data-z"]=v.z),v.l&&(v.l.Target||"#").charAt(0)!="#"&&(_='<a href="'+v.l.Target+'">'+_+"</a>")),E.id=(n.id||"sjs")+"-"+m,o.push(ze("td",_,E))}}var S="<tr>";return S+o.join("")+"</tr>"}var Rz='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Nz="</body></html>";function Iz(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Io(rb(r[0],e),e);var n=Jv();return r.forEach(function(a,o){e_(n,rb(a,e),"Sheet"+(o+1))}),n}function Dz(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function tC(t,e){var r=e||{},n=r.header!=null?r.header:Rz,a=r.footer!=null?r.footer:Nz,o=[n],l=aa(t["!ref"]);r.dense=Array.isArray(t),o.push(Dz(t,l,r));for(var u=l.s.r;u<=l.e.r;++u)o.push(Cz(t,l,u,r));return o.push("</table>"+a),o.join("")}function rC(t,e,r){var n=r||{},a=0,o=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?_r(n.origin):n.origin;a=l.r,o=l.c}var u=e.getElementsByTagName("tr"),f=Math.min(n.sheetRows||1e7,u.length),d={s:{r:0,c:0},e:{r:a,c:o}};if(t["!ref"]){var m=aa(t["!ref"]);d.s.r=Math.min(d.s.r,m.s.r),d.s.c=Math.min(d.s.c,m.s.c),d.e.r=Math.max(d.e.r,m.e.r),d.e.c=Math.max(d.e.c,m.e.c),a==-1&&(d.e.r=a=m.e.r+1)}var v=[],_=0,E=t["!rows"]||(t["!rows"]=[]),S=0,w=0,b=0,L=0,B=0,F=0;for(t["!cols"]||(t["!cols"]=[]);S<u.length&&w<f;++S){var z=u[S];if(nb(z)){if(n.display)continue;E[w]={hidden:!0}}var q=z.children;for(b=L=0;b<q.length;++b){var W=q[b];if(!(n.display&&nb(W))){var k=W.hasAttribute("data-v")?W.getAttribute("data-v"):W.hasAttribute("v")?W.getAttribute("v"):bk(W.innerHTML),I=W.getAttribute("data-z")||W.getAttribute("z");for(_=0;_<v.length;++_){var A=v[_];A.s.c==L+o&&A.s.r<w+a&&w+a<=A.e.r&&(L=A.e.c+1-o,_=-1)}F=+W.getAttribute("colspan")||1,((B=+W.getAttribute("rowspan")||1)>1||F>1)&&v.push({s:{r:w+a,c:L+o},e:{r:w+a+(B||1)-1,c:L+o+(F||1)-1}});var O={t:"s",v:k},M=W.getAttribute("data-t")||W.getAttribute("t")||"";k!=null&&(k.length==0?O.t=M||"z":n.raw||k.trim().length==0||M=="s"||(k==="TRUE"?O={t:"b",v:!0}:k==="FALSE"?O={t:"b",v:!1}:isNaN(ri(k))?isNaN(Jc(k).getDate())||(O={t:"d",v:hr(k)},n.cellDates||(O={t:"n",v:tn(O.v)}),O.z=n.dateNF||at[14]):O={t:"n",v:ri(k)})),O.z===void 0&&I!=null&&(O.z=I);var N="",D=W.getElementsByTagName("A");if(D&&D.length)for(var he=0;he<D.length&&!(D[he].hasAttribute("href")&&(N=D[he].getAttribute("href"),N.charAt(0)!="#"));++he);N&&N.charAt(0)!="#"&&(O.l={Target:N}),n.dense?(t[w+a]||(t[w+a]=[]),t[w+a][L+o]=O):t[ot({c:L+o,r:w+a})]=O,d.e.c<L+o&&(d.e.c=L+o),L+=F}}++w}return v.length&&(t["!merges"]=(t["!merges"]||[]).concat(v)),d.e.r=Math.max(d.e.r,w-1+a),t["!ref"]=vt(d),w>=f&&(t["!fullref"]=vt((d.e.r=u.length-S+w-1+a,d))),t}function nC(t,e){var r=e||{},n=r.dense?[]:{};return rC(n,t,e)}function Oz(t,e){return Io(nC(t,e),e)}function nb(t){var e="",r=Fz(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function Fz(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Pz(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Bt(e.replace(/<[^>]*>/g,""));return[r]}var ab={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function aC(t,e){var r=e||{},n=Sv(t),a=[],o,l,u={name:""},f="",d=0,m,v,_={},E=[],S=r.dense?[]:{},w,b,L={value:""},B="",F=0,z=[],q=-1,W=-1,k={s:{r:1e6,c:1e7},e:{r:0,c:0}},I=0,A={},O=[],M={},N=0,D=0,he=[],we=1,ne=1,ue=[],Ve={Names:[]},ie={},ee=["",""],ge=[],V={},K="",Y=0,te=!1,ce=!1,De=0;for(t0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");w=t0.exec(n);)switch(w[3]=w[3].replace(/_.*$/,"")){case"table":case"":w[1]==="/"?(k.e.c>=k.s.c&&k.e.r>=k.s.r?S["!ref"]=vt(k):S["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=k.e.r&&(S["!fullref"]=S["!ref"],k.e.r=r.sheetRows-1,S["!ref"]=vt(k)),O.length&&(S["!merges"]=O),he.length&&(S["!rows"]=he),m.name=m.||m.name,typeof JSON<"u"&&JSON.stringify(m),E.push(m.name),_[m.name]=S,ce=!1):w[0].charAt(w[0].length-2)!=="/"&&(m=dt(w[0],!1),q=W=-1,k.s.r=k.s.c=1e7,k.e.r=k.e.c=0,S=r.dense?[]:{},O=[],he=[],ce=!0);break;case"table-row-group":w[1]==="/"?--I:++I;break;case"table-row":case"":if(w[1]==="/"){q+=we,we=1;break}if(v=dt(w[0],!1),v.?q=v.-1:q==-1&&(q=0),we=+v["number-rows-repeated"]||1,we<10)for(De=0;De<we;++De)I>0&&(he[q+De]={level:I});W=-1;break;case"covered-table-cell":w[1]!=="/"&&++W,r.sheetStubs&&(r.dense?(S[q]||(S[q]=[]),S[q][W]={t:"z"}):S[ot({r:q,c:W})]={t:"z"}),B="",z=[];break;case"table-cell":case"":if(w[0].charAt(w[0].length-2)==="/")++W,L=dt(w[0],!1),ne=parseInt(L["number-columns-repeated"]||"1",10),b={t:"z",v:null},L.formula&&r.cellFormula!=!1&&(b.f=JT(Bt(L.formula))),(L.||L["value-type"])=="string"&&(b.t="s",b.v=Bt(L["string-value"]||""),r.dense?(S[q]||(S[q]=[]),S[q][W]=b):S[ot({r:q,c:W})]=b),W+=ne-1;else if(w[1]!=="/"){++W,B="",F=0,z=[],ne=1;var ke=we?q+we-1:q;if(W>k.e.c&&(k.e.c=W),W<k.s.c&&(k.s.c=W),q<k.s.r&&(k.s.r=q),ke>k.e.r&&(k.e.r=ke),L=dt(w[0],!1),ge=[],V={},b={t:L.||L["value-type"],v:null},r.cellFormula)if(L.formula&&(L.formula=Bt(L.formula)),L["number-matrix-columns-spanned"]&&L["number-matrix-rows-spanned"]&&(N=parseInt(L["number-matrix-rows-spanned"],10)||0,D=parseInt(L["number-matrix-columns-spanned"],10)||0,M={s:{r:q,c:W},e:{r:q+N-1,c:W+D-1}},b.F=vt(M),ue.push([M,b.F])),L.formula)b.f=JT(L.formula);else for(De=0;De<ue.length;++De)q>=ue[De][0].s.r&&q<=ue[De][0].e.r&&W>=ue[De][0].s.c&&W<=ue[De][0].e.c&&(b.F=ue[De][1]);switch((L["number-columns-spanned"]||L["number-rows-spanned"])&&(N=parseInt(L["number-rows-spanned"],10)||0,D=parseInt(L["number-columns-spanned"],10)||0,M={s:{r:q,c:W},e:{r:q+N-1,c:W+D-1}},O.push(M)),L["number-columns-repeated"]&&(ne=parseInt(L["number-columns-repeated"],10)),b.t){case"boolean":b.t="b",b.v=ur(L["boolean-value"]);break;case"float":b.t="n",b.v=parseFloat(L.value);break;case"percentage":b.t="n",b.v=parseFloat(L.value);break;case"currency":b.t="n",b.v=parseFloat(L.value);break;case"date":b.t="d",b.v=hr(L["date-value"]),r.cellDates||(b.t="n",b.v=tn(b.v)),b.z="m/d/yy";break;case"time":b.t="n",b.v=lP(L["time-value"])/86400,r.cellDates&&(b.t="d",b.v=Lm(b.v)),b.z="HH:MM:SS";break;case"number":b.t="n",b.v=parseFloat(L.);break;default:if(b.t==="string"||b.t==="text"||!b.t)b.t="s",L["string-value"]!=null&&(B=Bt(L["string-value"]),z=[]);else throw new Error("Unsupported value type "+b.t)}}else{if(te=!1,b.t==="s"&&(b.v=B||"",z.length&&(b.R=z),te=F==0),ie.Target&&(b.l=ie),ge.length>0&&(b.c=ge,ge=[]),B&&r.cellText!==!1&&(b.w=B),te&&(b.t="z",delete b.v),(!te||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=q))for(var Fe=0;Fe<we;++Fe){if(ne=parseInt(L["number-columns-repeated"]||"1",10),r.dense)for(S[q+Fe]||(S[q+Fe]=[]),S[q+Fe][W]=Fe==0?b:dr(b);--ne>0;)S[q+Fe][W+ne]=dr(b);else for(S[ot({r:q+Fe,c:W})]=b;--ne>0;)S[ot({r:q+Fe,c:W+ne})]=dr(b);k.e.c<=W&&(k.e.c=W)}ne=parseInt(L["number-columns-repeated"]||"1",10),W+=ne-1,ne=0,b={},B="",z=[]}ie={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(w[1]==="/"){if((o=a.pop())[0]!==w[3])throw"Bad state: "+o}else w[0].charAt(w[0].length-2)!=="/"&&a.push([w[3],!0]);break;case"annotation":if(w[1]==="/"){if((o=a.pop())[0]!==w[3])throw"Bad state: "+o;V.t=B,z.length&&(V.R=z),V.a=K,ge.push(V)}else w[0].charAt(w[0].length-2)!=="/"&&a.push([w[3],!1]);K="",Y=0,B="",F=0,z=[];break;case"creator":w[1]==="/"?K=n.slice(Y,w.index):Y=w.index+w[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(w[1]==="/"){if((o=a.pop())[0]!==w[3])throw"Bad state: "+o}else w[0].charAt(w[0].length-2)!=="/"&&a.push([w[3],!1]);B="",F=0,z=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(w[1]==="/"){if(A[u.name]=f,(o=a.pop())[0]!==w[3])throw"Bad state: "+o}else w[0].charAt(w[0].length-2)!=="/"&&(f="",u=dt(w[0],!1),a.push([w[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":l=dt(w[0],!1),f+=ab[w[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":l=dt(w[0],!1),f+=ab[w[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(w[0].slice(-2)==="/>")break;if(w[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":f+=n.slice(d,w.index);break}else d=w.index+w[0].length;break;case"named-range":l=dt(w[0],!1),ee=u1(l["cell-range-address"]);var ye={Name:l.name,Ref:ee[0]+"!"+ee[1]};ce&&(ye.Sheet=E.length),Ve.Names.push(ye);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(w[1]==="/"&&(!L||!L["string-value"])){var Be=Pz(n.slice(F,w.index));B=(B.length>0?B+`
`:"")+Be[0]}else dt(w[0],!1),F=w.index+w[0].length;break;case"s":break;case"database-range":if(w[1]==="/")break;try{ee=u1(dt(w[0])["target-range-address"]),_[ee[0]]["!autofilter"]={ref:ee[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(w[1]!=="/"){if(ie=dt(w[0],!1),!ie.href)break;ie.Target=Bt(ie.href),delete ie.href,ie.Target.charAt(0)=="#"&&ie.Target.indexOf(".")>-1?(ee=u1(ie.Target.slice(1)),ie.Target="#"+ee[0]+"!"+ee[1]):ie.Target.match(/^\.\.[\\\/]/)&&(ie.Target=ie.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(w[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(w)}}var X={Sheets:_,SheetNames:E,Workbook:Ve};return r.bookSheets&&delete X.Sheets,X}function ib(t,e){e=e||{},Ba(t,"META-INF/manifest.xml")&&lL(zr(t,"META-INF/manifest.xml"),e);var r=va(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=aC(ar(r),e);return Ba(t,"meta.xml")&&(n.Props=Kk(zr(t,"meta.xml"))),n}function sb(t,e){return aC(t,e)}var Lz=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+e0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Lr+e}}(),ob=function(){var t=function(o){return Zt(o).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(o,l,u){var f=[];f.push('      <table:table table:name="'+Zt(l.SheetNames[u])+`" table:style-name="ta1">
`);var d=0,m=0,v=aa(o["!ref"]||"A1"),_=o["!merges"]||[],E=0,S=Array.isArray(o);if(o["!cols"])for(m=0;m<=v.e.c;++m)f.push("        <table:table-column"+(o["!cols"][m]?' table:style-name="co'+o["!cols"][m].ods+'"':"")+`></table:table-column>
`);var w="",b=o["!rows"]||[];for(d=0;d<v.s.r;++d)w=b[d]?' table:style-name="ro'+b[d].ods+'"':"",f.push("        <table:table-row"+w+`></table:table-row>
`);for(;d<=v.e.r;++d){for(w=b[d]?' table:style-name="ro'+b[d].ods+'"':"",f.push("        <table:table-row"+w+`>
`),m=0;m<v.s.c;++m)f.push(e);for(;m<=v.e.c;++m){var L=!1,B={},F="";for(E=0;E!=_.length;++E)if(!(_[E].s.c>m)&&!(_[E].s.r>d)&&!(_[E].e.c<m)&&!(_[E].e.r<d)){(_[E].s.c!=m||_[E].s.r!=d)&&(L=!0),B["table:number-columns-spanned"]=_[E].e.c-_[E].s.c+1,B["table:number-rows-spanned"]=_[E].e.r-_[E].s.r+1;break}if(L){f.push(r);continue}var z=ot({r:d,c:m}),q=S?(o[d]||[])[m]:o[z];if(q&&q.f&&(B["table:formula"]=Zt(rV(q.f)),q.F&&q.F.slice(0,z.length)==z)){var W=aa(q.F);B["table:number-matrix-columns-spanned"]=W.e.c-W.s.c+1,B["table:number-matrix-rows-spanned"]=W.e.r-W.s.r+1}if(!q){f.push(e);continue}switch(q.t){case"b":F=q.v?"TRUE":"FALSE",B["office:value-type"]="boolean",B["office:boolean-value"]=q.v?"true":"false";break;case"n":F=q.w||String(q.v||0),B["office:value-type"]="float",B["office:value"]=q.v||0;break;case"s":case"str":F=q.v==null?"":q.v,B["office:value-type"]="string";break;case"d":F=q.w||hr(q.v).toISOString(),B["office:value-type"]="date",B["office:date-value"]=hr(q.v).toISOString(),B["table:style-name"]="ce1";break;default:f.push(e);continue}var k=t(F);if(q.l&&q.l.Target){var I=q.l.Target;I=I.charAt(0)=="#"?"#"+nV(I.slice(1)):I,I.charAt(0)!="#"&&!I.match(/^\w+:/)&&(I="../"+I),k=ze("text:a",k,{"xlink:href":I.replace(/&/g,"&amp;")})}f.push("          "+ze("table:table-cell",ze("text:p",k,{}),B)+`
`)}f.push(`        </table:table-row>
`)}return f.push(`      </table:table>
`),f.join("")},a=function(o,l){o.push(` <office:automatic-styles>
`),o.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),o.push(`   <number:month number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:day number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:year/>
`),o.push(`  </number:date-style>
`);var u=0;l.SheetNames.map(function(d){return l.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var m=0;m<d["!cols"].length;++m)if(d["!cols"][m]){var v=d["!cols"][m];if(v.width==null&&v.wpx==null&&v.wch==null)continue;Eo(v),v.ods=u;var _=d["!cols"][m].wpx+"px";o.push('  <style:style style:name="co'+u+`" style:family="table-column">
`),o.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+_+`"/>
`),o.push(`  </style:style>
`),++u}}});var f=0;l.SheetNames.map(function(d){return l.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var m=0;m<d["!rows"].length;++m)if(d["!rows"][m]){d["!rows"][m].ods=f;var v=d["!rows"][m].hpx+"px";o.push('  <style:style style:name="ro'+f+`" style:family="table-row">
`),o.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+v+`"/>
`),o.push(`  </style:style>
`),++f}}}),o.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),o.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),o.push(`  </style:style>
`),o.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),o.push(` </office:automatic-styles>
`)};return function(l,u){var f=[Lr],d=e0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),m=e0({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});u.bookType=="fods"?(f.push("<office:document"+d+m+`>
`),f.push(Xk().replace(/office:document-meta/g,"office:meta"))):f.push("<office:document-content"+d+`>
`),a(f,l),f.push(`  <office:body>
`),f.push(`    <office:spreadsheet>
`);for(var v=0;v!=l.SheetNames.length;++v)f.push(n(l.Sheets[l.SheetNames[v]],l,v));return f.push(`    </office:spreadsheet>
`),f.push(`  </office:body>
`),u.bookType=="fods"?f.push("</office:document>"):f.push("</office:document-content>"),f.join("")}}();function iC(t,e){if(e.bookType=="fods")return ob(t,e);var r=wv(),n="",a=[],o=[];return n="mimetype",yt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",yt(r,n,ob(t,e)),a.push([n,"text/xml"]),o.push([n,"ContentFile"]),n="styles.xml",yt(r,n,Lz(t,e)),a.push([n,"text/xml"]),o.push([n,"StylesFile"]),n="meta.xml",yt(r,n,Lr+Xk()),a.push([n,"text/xml"]),o.push([n,"MetadataFile"]),n="manifest.rdf",yt(r,n,fL(o)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",yt(r,n,cL(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Rl(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function ox(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):ar(No(t))}function Mz(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):xa(Ri(t))}function Uz(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function bo(t){var e=t.reduce(function(a,o){return a+o.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(a){r.set(a,n),n+=a.length}),r}function lb(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function Bz(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,a=e+13;a>=e;--a)n=n*256+t[a];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function Vz(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var o=0;a>=1;++o,a/=256)t[e+o]=a&255;t[e+15]|=r>=0?0:128}function l0(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function $t(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function br(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function zt(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],a=l0(t,r),o=a&7;a=Math.floor(a/8);var l=0,u;if(a==0)break;switch(o){case 0:{for(var f=r[0];t[r[0]++]>=128;);u=t.slice(f,r[0])}break;case 5:l=4,u=t.slice(r[0],r[0]+l),r[0]+=l;break;case 1:l=8,u=t.slice(r[0],r[0]+l),r[0]+=l;break;case 2:l=l0(t,r),u=t.slice(r[0],r[0]+l),r[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(o," for Field ").concat(a," at offset ").concat(n))}var d={data:u,type:o};e[a]==null?e[a]=[d]:e[a].push(d)}return e}function xn(t){var e=[];return t.forEach(function(r,n){r.forEach(function(a){a.data&&(e.push($t(n*8+a.type)),a.type==2&&e.push($t(a.data.length)),e.push(a.data))})}),bo(e)}function Kv(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function Ma(t){for(var e,r=[],n=[0];n[0]<t.length;){var a=l0(t,n),o=zt(t.slice(n[0],n[0]+a));n[0]+=a;var l={id:br(o[1][0].data),messages:[]};o[2].forEach(function(u){var f=zt(u.data),d=br(f[3][0].data);l.messages.push({meta:f,data:t.slice(n[0],n[0]+d)}),n[0]+=d}),(e=o[3])!=null&&e[0]&&(l.merge=br(o[3][0].data)>>>0>0),r.push(l)}return r}function Cc(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:$t(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:$t(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(l){a.push(l.data),l.meta[3]=[{type:0,data:$t(l.data.length)}],n[2].push({data:xn(l.meta),type:2})});var o=xn(n);e.push($t(o.length)),e.push(o),a.forEach(function(l){return e.push(l)})}),bo(e)}function jz(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=l0(e,r),a=[];r[0]<e.length;){var o=e[r[0]]&3;if(o==0){var l=e[r[0]++]>>2;if(l<60)++l;else{var u=l-59;l=e[r[0]],u>1&&(l|=e[r[0]+1]<<8),u>2&&(l|=e[r[0]+2]<<16),u>3&&(l|=e[r[0]+3]<<24),l>>>=0,l++,r[0]+=u}a.push(e.slice(r[0],r[0]+l)),r[0]+=l;continue}else{var f=0,d=0;if(o==1?(d=(e[r[0]]>>2&7)+4,f=(e[r[0]++]&224)<<3,f|=e[r[0]++]):(d=(e[r[0]++]>>2)+1,o==2?(f=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(f=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),a=[bo(a)],f==0)throw new Error("Invalid offset 0");if(f>a[0].length)throw new Error("Invalid offset beyond length");if(d>=f)for(a.push(a[0].slice(-f)),d-=f;d>=a[a.length-1].length;)a.push(a[a.length-1]),d-=a[a.length-1].length;a.push(a[0].slice(-f,-f+d))}}var m=bo(a);if(m.length!=n)throw new Error("Unexpected length: ".concat(m.length," != ").concat(n));return m}function Ua(t){for(var e=[],r=0;r<t.length;){var n=t[r++],a=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(jz(n,t.slice(r,r+a))),r+=a}if(r!==t.length)throw new Error("data is not a valid framed stream!");return bo(e)}function Rc(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),a=new Uint8Array(4);e.push(a);var o=$t(n),l=o.length;e.push(o),n<=60?(l++,e.push(new Uint8Array([n-1<<2]))):n<=256?(l+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(l+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(l+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(l+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),l+=n,a[0]=0,a[1]=l&255,a[2]=l>>8&255,a[3]=l>>16&255,r+=n}return bo(e)}function Hz(t,e,r,n){var a=Rl(t),o=a.getUint32(4,!0),l=(n>1?12:8)+lb(o&(n>1?3470:398))*4,u=-1,f=-1,d=NaN,m=new Date(2001,0,1);o&512&&(u=a.getUint32(l,!0),l+=4),l+=lb(o&(n>1?12288:4096))*4,o&16&&(f=a.getUint32(l,!0),l+=4),o&32&&(d=a.getFloat64(l,!0),l+=8),o&64&&(m.setTime(m.getTime()+a.getFloat64(l,!0)*1e3),l+=8);var v;switch(t[2]){case 0:break;case 2:v={t:"n",v:d};break;case 3:v={t:"s",v:e[f]};break;case 5:v={t:"d",v:m};break;case 6:v={t:"b",v:d>0};break;case 7:v={t:"n",v:d/86400};break;case 8:v={t:"e",v:0};break;case 9:if(u>-1)v={t:"s",v:r[u]};else if(f>-1)v={t:"s",v:e[f]};else if(!isNaN(d))v={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return v}function zz(t,e,r){var n=Rl(t),a=n.getUint32(8,!0),o=12,l=-1,u=-1,f=NaN,d=NaN,m=new Date(2001,0,1);a&1&&(f=Bz(t,o),o+=16),a&2&&(d=n.getFloat64(o,!0),o+=8),a&4&&(m.setTime(m.getTime()+n.getFloat64(o,!0)*1e3),o+=8),a&8&&(u=n.getUint32(o,!0),o+=4),a&16&&(l=n.getUint32(o,!0),o+=4);var v;switch(t[1]){case 0:break;case 2:v={t:"n",v:f};break;case 3:v={t:"s",v:e[u]};break;case 5:v={t:"d",v:m};break;case 6:v={t:"b",v:d>0};break;case 7:v={t:"n",v:d/86400};break;case 8:v={t:"e",v:0};break;case 9:if(l>-1)v={t:"s",v:r[l]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)));break;case 10:v={t:"n",v:f};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)))}return v}function h1(t,e){var r=new Uint8Array(32),n=Rl(r),a=12,o=0;switch(r[0]=5,t.t){case"n":r[1]=2,Vz(r,a,t.v),o|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,t.v?1:0,!0),o|=2,a+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(a,e.indexOf(t.v),!0),o|=8,a+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,o,!0),r.slice(0,a)}function d1(t,e){var r=new Uint8Array(32),n=Rl(r),a=12,o=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(a,t.v,!0),o|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,t.v?1:0,!0),o|=32,a+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(a,e.indexOf(t.v),!0),o|=16,a+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,o,!0),r.slice(0,a)}function Gz(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return Hz(t,e,r,t[0]);case 5:return zz(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Rn(t){var e=zt(t);return l0(e[1][0].data)}function cb(t,e){var r=zt(e.data),n=br(r[1][0].data),a=r[3],o=[];return(a||[]).forEach(function(l){var u=zt(l.data),f=br(u[1][0].data)>>>0;switch(n){case 1:o[f]=ox(u[3][0].data);break;case 8:{var d=t[Rn(u[9][0].data)][0],m=zt(d.data),v=t[Rn(m[1][0].data)][0],_=br(v.meta[1][0].data);if(_!=2001)throw new Error("2000 unexpected reference to ".concat(_));var E=zt(v.data);o[f]=E[3].map(function(S){return ox(S.data)}).join("")}break}}),o}function qz(t,e){var r,n,a,o,l,u,f,d,m,v,_,E,S,w,b=zt(t),L=br(b[1][0].data)>>>0,B=br(b[2][0].data)>>>0,F=((n=(r=b[8])==null?void 0:r[0])==null?void 0:n.data)&&br(b[8][0].data)>0||!1,z,q;if((o=(a=b[7])==null?void 0:a[0])!=null&&o.data&&e!=0)z=(u=(l=b[7])==null?void 0:l[0])==null?void 0:u.data,q=(d=(f=b[6])==null?void 0:f[0])==null?void 0:d.data;else if((v=(m=b[4])==null?void 0:m[0])!=null&&v.data&&e!=1)z=(E=(_=b[4])==null?void 0:_[0])==null?void 0:E.data,q=(w=(S=b[3])==null?void 0:S[0])==null?void 0:w.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var W=F?4:1,k=Rl(z),I=[],A=0;A<z.length/2;++A){var O=k.getUint16(A*2,!0);O<65535&&I.push([A,O])}if(I.length!=B)throw"Expected ".concat(B," cells, found ").concat(I.length);var M=[];for(A=0;A<I.length-1;++A)M[I[A][0]]=q.subarray(I[A][1]*W,I[A+1][1]*W);return I.length>=1&&(M[I[I.length-1][0]]=q.subarray(I[I.length-1][1]*W)),{R:L,cells:M}}function Wz(t,e){var r,n=zt(e.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?br(n[7][0].data)>>>0>0?1:0:-1,o=Kv(n[5],function(l){return qz(l,a)});return{nrows:br(n[4][0].data)>>>0,data:o.reduce(function(l,u){return l[u.R]||(l[u.R]=[]),u.cells.forEach(function(f,d){if(l[u.R][d])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(d));l[u.R][d]=f}),l},[])}}function Xz(t,e,r){var n,a=zt(e.data),o={s:{r:0,c:0},e:{r:0,c:0}};if(o.e.r=(br(a[6][0].data)>>>0)-1,o.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(o.e.c=(br(a[7][0].data)>>>0)-1,o.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=vt(o);var l=zt(a[4][0].data),u=cb(t,t[Rn(l[4][0].data)][0]),f=(n=l[17])!=null&&n[0]?cb(t,t[Rn(l[17][0].data)][0]):[],d=zt(l[3][0].data),m=0;d[1].forEach(function(v){var _=zt(v.data),E=t[Rn(_[2][0].data)][0],S=br(E.meta[1][0].data);if(S!=6002)throw new Error("6001 unexpected reference to ".concat(S));var w=Wz(t,E);w.data.forEach(function(b,L){b.forEach(function(B,F){var z=ot({r:m+L,c:F}),q=Gz(B,u,f);q&&(r[z]=q)})}),m+=w.nrows})}function Kz(t,e){var r=zt(e.data),n={"!ref":"A1"},a=t[Rn(r[2][0].data)],o=br(a[0].meta[1][0].data);if(o!=6001)throw new Error("6000 unexpected reference to ".concat(o));return Xz(t,a[0],n),n}function Yz(t,e){var r,n=zt(e.data),a={name:(r=n[1])!=null&&r[0]?ox(n[1][0].data):"",sheets:[]},o=Kv(n[2],Rn);return o.forEach(function(l){t[l].forEach(function(u){var f=br(u.meta[1][0].data);f==6e3&&a.sheets.push(Kz(t,u))})}),a}function $z(t,e){var r=Jv(),n=zt(e.data),a=Kv(n[1],Rn);if(a.forEach(function(o){t[o].forEach(function(l){var u=br(l.meta[1][0].data);if(u==2){var f=Yz(t,l);f.sheets.forEach(function(d,m){e_(r,d,m==0?f.name:f.name+"_"+m,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function m1(t){var e,r,n,a,o={},l=[];if(t.FullPaths.forEach(function(f){if(f.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(f){if(f.name.match(/\.iwa$/)){var d;try{d=Ua(f.content)}catch(v){return console.log("?? "+f.content.length+" "+(v.message||v))}var m;try{m=Ma(d)}catch(v){return console.log("## "+(v.message||v))}m.forEach(function(v){o[v.id]=v.messages,l.push(v.id)})}}),!l.length)throw new Error("File has no messages");var u=((a=(n=(r=(e=o==null?void 0:o[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&br(o[1][0].meta[1][0].data)==1&&o[1][0];if(u||l.forEach(function(f){o[f].forEach(function(d){var m=br(d.meta[1][0].data)>>>0;if(m==1)if(!u)u=d;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return $z(o,u)}function Qz(t,e,r){var n,a,o,l;if(!((n=t[6])!=null&&n[0])||!((a=t[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var u=((l=(o=t[8])==null?void 0:o[0])==null?void 0:l.data)&&br(t[8][0].data)>0||!1;if(u)throw"Math only works with normal offsets";for(var f=0,d=Rl(t[7][0].data),m=0,v=[],_=Rl(t[4][0].data),E=0,S=[],w=0;w<e.length;++w){if(e[w]==null){d.setUint16(w*2,65535,!0),_.setUint16(w*2,65535);continue}d.setUint16(w*2,m,!0),_.setUint16(w*2,E,!0);var b,L;switch(typeof e[w]){case"string":b=h1({t:"s",v:e[w]},r),L=d1({t:"s",v:e[w]},r);break;case"number":b=h1({t:"n",v:e[w]},r),L=d1({t:"n",v:e[w]},r);break;case"boolean":b=h1({t:"b",v:e[w]},r),L=d1({t:"b",v:e[w]},r);break;default:throw new Error("Unsupported value "+e[w])}v.push(b),m+=b.length,S.push(L),E+=L.length,++f}for(t[2][0].data=$t(f);w<t[7][0].data.length/2;++w)d.setUint16(w*2,65535,!0),_.setUint16(w*2,65535,!0);return t[6][0].data=bo(v),t[3][0].data=bo(S),f}function Zz(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=aa(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(vt(n)));var o=om(r,{range:n,header:1}),l=["~Sh33tJ5~"];o.forEach(function(K){return K.forEach(function(Y){typeof Y=="string"&&l.push(Y)})});var u={},f=[],d=et.read(e.numbers,{type:"base64"});d.FileIndex.map(function(K,Y){return[K,d.FullPaths[Y]]}).forEach(function(K){var Y=K[0],te=K[1];if(Y.type==2&&Y.name.match(/\.iwa/)){var ce=Y.content,De=Ua(ce),ke=Ma(De);ke.forEach(function(Fe){f.push(Fe.id),u[Fe.id]={deps:[],location:te,type:br(Fe.messages[0].meta[1][0].data)}})}}),f.sort(function(K,Y){return K-Y});var m=f.filter(function(K){return K>1}).map(function(K){return[K,$t(K)]});d.FileIndex.map(function(K,Y){return[K,d.FullPaths[Y]]}).forEach(function(K){var Y=K[0];if(K[1],!!Y.name.match(/\.iwa/)){var te=Ma(Ua(Y.content));te.forEach(function(ce){ce.messages.forEach(function(De){m.forEach(function(ke){ce.messages.some(function(Fe){return br(Fe.meta[1][0].data)!=11006&&Uz(Fe.data,ke[1])})&&u[ke[0]].deps.push(ce.id)})})})}});for(var v=et.find(d,u[1].location),_=Ma(Ua(v.content)),E,S=0;S<_.length;++S){var w=_[S];w.id==1&&(E=w)}var b=Rn(zt(E.messages[0].data)[1][0].data);for(v=et.find(d,u[b].location),_=Ma(Ua(v.content)),S=0;S<_.length;++S)w=_[S],w.id==b&&(E=w);for(b=Rn(zt(E.messages[0].data)[2][0].data),v=et.find(d,u[b].location),_=Ma(Ua(v.content)),S=0;S<_.length;++S)w=_[S],w.id==b&&(E=w);for(b=Rn(zt(E.messages[0].data)[2][0].data),v=et.find(d,u[b].location),_=Ma(Ua(v.content)),S=0;S<_.length;++S)w=_[S],w.id==b&&(E=w);var L=zt(E.messages[0].data);{L[6][0].data=$t(n.e.r+1),L[7][0].data=$t(n.e.c+1);var B=Rn(L[46][0].data),F=et.find(d,u[B].location),z=Ma(Ua(F.content));{for(var q=0;q<z.length&&z[q].id!=B;++q);if(z[q].id!=B)throw"Bad ColumnRowUIDMapArchive";var W=zt(z[q].messages[0].data);W[1]=[],W[2]=[],W[3]=[];for(var k=0;k<=n.e.c;++k){var I=[];I[1]=I[2]=[{type:0,data:$t(k+420690)}],W[1].push({type:2,data:xn(I)}),W[2].push({type:0,data:$t(k)}),W[3].push({type:0,data:$t(k)})}W[4]=[],W[5]=[],W[6]=[];for(var A=0;A<=n.e.r;++A)I=[],I[1]=I[2]=[{type:0,data:$t(A+726270)}],W[4].push({type:2,data:xn(I)}),W[5].push({type:0,data:$t(A)}),W[6].push({type:0,data:$t(A)});z[q].messages[0].data=xn(W)}F.content=Rc(Cc(z)),F.size=F.content.length,delete L[46];var O=zt(L[4][0].data);{O[7][0].data=$t(n.e.r+1);var M=zt(O[1][0].data),N=Rn(M[2][0].data);F=et.find(d,u[N].location),z=Ma(Ua(F.content));{if(z[0].id!=N)throw"Bad HeaderStorageBucket";var D=zt(z[0].messages[0].data);for(A=0;A<o.length;++A){var he=zt(D[2][0].data);he[1][0].data=$t(A),he[4][0].data=$t(o[A].length),D[2][A]={type:D[2][0].type,data:xn(he)}}z[0].messages[0].data=xn(D)}F.content=Rc(Cc(z)),F.size=F.content.length;var we=Rn(O[2][0].data);F=et.find(d,u[we].location),z=Ma(Ua(F.content));{if(z[0].id!=we)throw"Bad HeaderStorageBucket";for(D=zt(z[0].messages[0].data),k=0;k<=n.e.c;++k)he=zt(D[2][0].data),he[1][0].data=$t(k),he[4][0].data=$t(n.e.r+1),D[2][k]={type:D[2][0].type,data:xn(he)};z[0].messages[0].data=xn(D)}F.content=Rc(Cc(z)),F.size=F.content.length;var ne=Rn(O[4][0].data);(function(){for(var K=et.find(d,u[ne].location),Y=Ma(Ua(K.content)),te,ce=0;ce<Y.length;++ce){var De=Y[ce];De.id==ne&&(te=De)}var ke=zt(te.messages[0].data);{ke[3]=[];var Fe=[];l.forEach(function(X,rt){Fe[1]=[{type:0,data:$t(rt)}],Fe[2]=[{type:0,data:$t(1)}],Fe[3]=[{type:2,data:Mz(X)}],ke[3].push({type:2,data:xn(Fe)})})}te.messages[0].data=xn(ke);var ye=Cc(Y),Be=Rc(ye);K.content=Be,K.size=K.content.length})();var ue=zt(O[3][0].data);{var Ve=ue[1][0];delete ue[2];var ie=zt(Ve.data);{var ee=Rn(ie[2][0].data);(function(){for(var K=et.find(d,u[ee].location),Y=Ma(Ua(K.content)),te,ce=0;ce<Y.length;++ce){var De=Y[ce];De.id==ee&&(te=De)}var ke=zt(te.messages[0].data);{delete ke[6],delete ue[7];var Fe=new Uint8Array(ke[5][0].data);ke[5]=[];for(var ye=0,Be=0;Be<=n.e.r;++Be){var X=zt(Fe);ye+=Qz(X,o[Be],l),X[1][0].data=$t(Be),ke[5].push({data:xn(X),type:2})}ke[1]=[{type:0,data:$t(n.e.c+1)}],ke[2]=[{type:0,data:$t(n.e.r+1)}],ke[3]=[{type:0,data:$t(ye)}],ke[4]=[{type:0,data:$t(n.e.r+1)}]}te.messages[0].data=xn(ke);var rt=Cc(Y),nt=Rc(rt);K.content=nt,K.size=K.content.length})()}Ve.data=xn(ie)}O[3][0].data=xn(ue)}L[4][0].data=xn(O)}E.messages[0].data=xn(L);var ge=Cc(_),V=Rc(ge);return v.content=V,v.size=v.content.length,d}function sC(t){return function(r){for(var n=0;n!=t.length;++n){var a=t[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function Yv(t){sC([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function $v(t){sC([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function Jz(t){return At.WS.indexOf(t)>-1?"sheet":t==At.CS?"chart":t==At.DS?"dialog":t==At.MS?"macro":t&&t.length?t:"sheet"}function eG(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,Jz(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function tG(t,e,r,n,a,o,l,u,f,d,m,v){try{o[n]=Lf(va(t,r,!0),e);var _=zr(t,e),E;switch(u){case"sheet":E=TH(_,e,a,f,o[n],d,m,v);break;case"chart":if(E=bH(_,e,a,f,o[n],d,m,v),!E||!E["!drawel"])break;var S=bf(E["!drawel"].Target,e),w=r0(S),b=uU(va(t,S,!0),Lf(va(t,w,!0),S)),L=bf(b,S),B=r0(L);E=Qj(va(t,L,!0),L,f,Lf(va(t,B,!0),L),d,E);break;case"macro":E=SH(_,e,a,f,o[n],d,m,v);break;case"dialog":E=AH(_,e,a,f,o[n],d,m,v);break;default:throw new Error("Unrecognized sheet type "+u)}l[n]=E;var F=[];o&&o[n]&&Ar(o[n]).forEach(function(z){var q="";if(o[n][z].Type==At.CMNT){q=bf(o[n][z].Target,e);var W=NH(zr(t,q,!0),q,f);if(!W||!W.length)return;KT(E,W,!1)}o[n][z].Type==At.TCMNT&&(q=bf(o[n][z].Target,e),F=F.concat(hU(zr(t,q,!0),f)))}),F&&F.length&&KT(E,F,!0,f.people||[])}catch(z){if(f.WTF)throw z}}function Pa(t){return t.charAt(0)=="/"?t.slice(1):t}function rG(t,e){if(cu(),e=e||{},Yv(e),Ba(t,"META-INF/manifest.xml")||Ba(t,"objectdata.xml"))return ib(t,e);if(Ba(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof m1<"u"){if(t.FileIndex)return m1(t);var r=et.utils.cfb_new();return pT(t).forEach(function(he){yt(r,he,dP(t,he))}),m1(r)}throw new Error("Unsupported NUMBERS file")}if(!Ba(t,"[Content_Types].xml"))throw Ba(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Ba(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=pT(t),a=sL(va(t,"[Content_Types].xml")),o=!1,l,u;if(a.workbooks.length===0&&(u="xl/workbook.xml",zr(t,u,!0)&&a.workbooks.push(u)),a.workbooks.length===0){if(u="xl/workbook.bin",!zr(t,u,!0))throw new Error("Could not find workbook");a.workbooks.push(u),o=!0}a.workbooks[0].slice(-3)=="bin"&&(o=!0);var f={},d={};if(!e.bookSheets&&!e.bookProps){if(Mf=[],a.sst)try{Mf=RH(zr(t,Pa(a.sst)),a.sst,e)}catch(he){if(e.WTF)throw he}e.cellStyles&&a.themes.length&&(f=CH(va(t,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],e)),a.style&&(d=kH(zr(t,Pa(a.style)),a.style,f,e))}a.links.map(function(he){try{var we=Lf(va(t,r0(Pa(he))),he);return DH(zr(t,Pa(he)),we,he,e)}catch{}});var m=EH(zr(t,Pa(a.workbooks[0])),a.workbooks[0],e),v={},_="";a.coreprops.length&&(_=zr(t,Pa(a.coreprops[0]),!0),_&&(v=Kk(_)),a.extprops.length!==0&&(_=zr(t,Pa(a.extprops[0]),!0),_&&dL(_,v,e)));var E={};(!e.bookSheets||e.bookProps)&&a.custprops.length!==0&&(_=va(t,Pa(a.custprops[0]),!0),_&&(E=pL(_,e)));var S={};if((e.bookSheets||e.bookProps)&&(m.Sheets?l=m.Sheets.map(function(we){return we.name}):v.Worksheets&&v.SheetNames.length>0&&(l=v.SheetNames),e.bookProps&&(S.Props=v,S.Custprops=E),e.bookSheets&&typeof l<"u"&&(S.SheetNames=l),e.bookSheets?S.SheetNames:e.bookProps))return S;l={};var w={};e.bookDeps&&a.calcchain&&(w=IH(zr(t,Pa(a.calcchain)),a.calcchain));var b=0,L={},B,F;{var z=m.Sheets;v.Worksheets=z.length,v.SheetNames=[];for(var q=0;q!=z.length;++q)v.SheetNames[q]=z[q].name}var W=o?"bin":"xml",k=a.workbooks[0].lastIndexOf("/"),I=(a.workbooks[0].slice(0,k+1)+"_rels/"+a.workbooks[0].slice(k+1)+".rels").replace(/^\//,"");Ba(t,I)||(I="xl/_rels/workbook."+W+".rels");var A=Lf(va(t,I,!0),I.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(e.xlmeta=OH(zr(t,Pa(a.metadata[0])),a.metadata[0],e)),(a.people||[]).length>=1&&(e.people=mU(zr(t,Pa(a.people[0])),e)),A&&(A=eG(A,m.Sheets));var O=zr(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(b=0;b!=v.Worksheets;++b){var M="sheet";if(A&&A[b]?(B="xl/"+A[b][1].replace(/[\/]?xl\//,""),Ba(t,B)||(B=A[b][1]),Ba(t,B)||(B=I.replace(/_rels\/.*$/,"")+A[b][1]),M=A[b][2]):(B="xl/worksheets/sheet"+(b+1-O)+"."+W,B=B.replace(/sheet0\./,"sheet.")),F=B.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(b!=e.sheets)continue e;break;case"string":if(v.SheetNames[b].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var N=!1,D=0;D!=e.sheets.length;++D)typeof e.sheets[D]=="number"&&e.sheets[D]==b&&(N=1),typeof e.sheets[D]=="string"&&e.sheets[D].toLowerCase()==v.SheetNames[b].toLowerCase()&&(N=1);if(!N)continue e}}tG(t,B,F,v.SheetNames[b],b,L,l,M,e,m,f,d)}return S={Directory:a,Workbook:m,Props:v,Custprops:E,Deps:w,Sheets:l,SheetNames:v.SheetNames,Strings:Mf,Styles:d,Themes:f,SSF:dr(at)},e&&e.bookFiles&&(t.files?(S.keys=n,S.files=t.files):(S.keys=[],S.files={},t.FullPaths.forEach(function(he,we){he=he.replace(/^Root Entry[\/]/,""),S.keys.push(he),S.files[he]=t.FileIndex[we]}))),e&&e.bookVBA&&(a.vba.length>0?S.vbaraw=zr(t,Pa(a.vba[0]),!0):a.defaults&&a.defaults.bin===EU&&(S.vbaraw=zr(t,"xl/vbaProject.bin",!0))),S}function nG(t,e){var r=e||{},n="Workbook",a=et.find(t,n);try{if(n="/!DataSpaces/Version",a=et.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(O9(a.content),n="/!DataSpaces/DataSpaceMap",a=et.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=P9(a.content);if(o.length!==1||o[0].comps.length!==1||o[0].comps[0].t!==0||o[0].name!=="StrongEncryptionDataSpace"||o[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=et.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=L9(a.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=et.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);U9(a.content)}catch{}if(n="/EncryptionInfo",a=et.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var u=B9(a.content);if(n="/EncryptedPackage",a=et.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],a.content,r.password||"",r);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function aG(t,e){return e.bookType=="ods"?iC(t,e):e.bookType=="numbers"?Zz(t,e):e.bookType=="xlsb"?iG(t,e):sG(t,e)}function iG(t,e){Lc=1024,t&&!t.SSF&&(t.SSF=dr(at)),t&&t.SSF&&(cu(),A0(t.SSF),e.revssf=Pm(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Uf?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=O4.indexOf(e.bookType)>-1,a=Pv();$v(e=e||{});var o=wv(),l="",u=0;if(e.cellXfs=[],Do(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),l="docProps/core.xml",yt(o,l,Yk(t.Props,e)),a.coreprops.push(l),Qt(e.rels,2,l,At.CORE_PROPS),l="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var f=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&f.push(t.SheetNames[d]);t.Props.SheetNames=f}for(t.Props.Worksheets=t.Props.SheetNames.length,yt(o,l,Zk(t.Props)),a.extprops.push(l),Qt(e.rels,3,l,At.EXT_PROPS),t.Custprops!==t.Props&&Ar(t.Custprops||{}).length>0&&(l="docProps/custom.xml",yt(o,l,Jk(t.Custprops)),a.custprops.push(l),Qt(e.rels,4,l,At.CUST_PROPS)),u=1;u<=t.SheetNames.length;++u){var m={"!id":{}},v=t.Sheets[t.SheetNames[u-1]],_=(v||{})["!type"]||"sheet";switch(_){case"chart":default:l="xl/worksheets/sheet"+u+"."+r,yt(o,l,PH(u-1,l,e,t,m)),a.sheets.push(l),Qt(e.wbrels,-1,"worksheets/sheet"+u+"."+r,At.WS[0])}if(v){var E=v["!comments"],S=!1,w="";E&&E.length>0&&(w="xl/comments"+u+"."+r,yt(o,w,UH(E,w)),a.comments.push(w),Qt(m,-1,"../comments"+u+"."+r,At.CMNT),S=!0),v["!legacy"]&&S&&yt(o,"xl/drawings/vmlDrawing"+u+".vml",I4(u,v["!comments"])),delete v["!comments"],delete v["!legacy"]}m["!id"].rId1&&yt(o,r0(l),Gc(m))}return e.Strings!=null&&e.Strings.length>0&&(l="xl/sharedStrings."+r,yt(o,l,MH(e.Strings,l,e)),a.strs.push(l),Qt(e.wbrels,-1,"sharedStrings."+r,At.SST)),l="xl/workbook."+r,yt(o,l,FH(t,l)),a.workbooks.push(l),Qt(e.rels,1,l,At.WB),l="xl/theme/theme1.xml",yt(o,l,jv(t.Themes,e)),a.themes.push(l),Qt(e.wbrels,-1,"theme/theme1.xml",At.THEME),l="xl/styles."+r,yt(o,l,LH(t,l,e)),a.styles.push(l),Qt(e.wbrels,-1,"styles."+r,At.STY),t.vbaraw&&n&&(l="xl/vbaProject.bin",yt(o,l,t.vbaraw),a.vba.push(l),Qt(e.wbrels,-1,"vbaProject.bin",At.VBA)),l="xl/metadata."+r,yt(o,l,BH(l)),a.metadata.push(l),Qt(e.wbrels,-1,"metadata."+r,At.XLMETA),yt(o,"[Content_Types].xml",Wk(a,e)),yt(o,"_rels/.rels",Gc(e.rels)),yt(o,"xl/_rels/workbook."+r+".rels",Gc(e.wbrels)),delete e.revssf,delete e.ssf,o}function sG(t,e){Lc=1024,t&&!t.SSF&&(t.SSF=dr(at)),t&&t.SSF&&(cu(),A0(t.SSF),e.revssf=Pm(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Uf?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=O4.indexOf(e.bookType)>-1,a=Pv();$v(e=e||{});var o=wv(),l="",u=0;if(e.cellXfs=[],Do(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),l="docProps/core.xml",yt(o,l,Yk(t.Props,e)),a.coreprops.push(l),Qt(e.rels,2,l,At.CORE_PROPS),l="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var f=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&f.push(t.SheetNames[d]);t.Props.SheetNames=f}t.Props.Worksheets=t.Props.SheetNames.length,yt(o,l,Zk(t.Props)),a.extprops.push(l),Qt(e.rels,3,l,At.EXT_PROPS),t.Custprops!==t.Props&&Ar(t.Custprops||{}).length>0&&(l="docProps/custom.xml",yt(o,l,Jk(t.Custprops)),a.custprops.push(l),Qt(e.rels,4,l,At.CUST_PROPS));var m=["SheetJ5"];for(e.tcid=0,u=1;u<=t.SheetNames.length;++u){var v={"!id":{}},_=t.Sheets[t.SheetNames[u-1]],E=(_||{})["!type"]||"sheet";switch(E){case"chart":default:l="xl/worksheets/sheet"+u+"."+r,yt(o,l,G4(u-1,e,t,v)),a.sheets.push(l),Qt(e.wbrels,-1,"worksheets/sheet"+u+"."+r,At.WS[0])}if(_){var S=_["!comments"],w=!1,b="";if(S&&S.length>0){var L=!1;S.forEach(function(B){B[1].forEach(function(F){F.T==!0&&(L=!0)})}),L&&(b="xl/threadedComments/threadedComment"+u+"."+r,yt(o,b,dU(S,m,e)),a.threadedcomments.push(b),Qt(v,-1,"../threadedComments/threadedComment"+u+"."+r,At.TCMNT)),b="xl/comments"+u+"."+r,yt(o,b,D4(S)),a.comments.push(b),Qt(v,-1,"../comments"+u+"."+r,At.CMNT),w=!0}_["!legacy"]&&w&&yt(o,"xl/drawings/vmlDrawing"+u+".vml",I4(u,_["!comments"])),delete _["!comments"],delete _["!legacy"]}v["!id"].rId1&&yt(o,r0(l),Gc(v))}return e.Strings!=null&&e.Strings.length>0&&(l="xl/sharedStrings."+r,yt(o,l,_4(e.Strings,e)),a.strs.push(l),Qt(e.wbrels,-1,"sharedStrings."+r,At.SST)),l="xl/workbook."+r,yt(o,l,Y4(t)),a.workbooks.push(l),Qt(e.rels,1,l,At.WB),l="xl/theme/theme1.xml",yt(o,l,jv(t.Themes,e)),a.themes.push(l),Qt(e.wbrels,-1,"theme/theme1.xml",At.THEME),l="xl/styles."+r,yt(o,l,k4(t,e)),a.styles.push(l),Qt(e.wbrels,-1,"styles."+r,At.STY),t.vbaraw&&n&&(l="xl/vbaProject.bin",yt(o,l,t.vbaraw),a.vba.push(l),Qt(e.wbrels,-1,"vbaProject.bin",At.VBA)),l="xl/metadata."+r,yt(o,l,N4()),a.metadata.push(l),Qt(e.wbrels,-1,"metadata."+r,At.XLMETA),m.length>1&&(l="xl/persons/person.xml",yt(o,l,pU(m)),a.people.push(l),Qt(e.wbrels,-1,"persons/person.xml",At.PEOPLE)),yt(o,"[Content_Types].xml",Wk(a,e)),yt(o,"_rels/.rels",Gc(e.rels)),yt(o,"xl/_rels/workbook."+r+".rels",Gc(e.wbrels)),delete e.revssf,delete e.ssf,o}function Qv(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=wa(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function oG(t,e){return et.find(t,"EncryptedPackage")?nG(t,e):J4(t,e)}function lG(t,e){var r,n=t,a=e||{};return a.type||(a.type=bt&&Buffer.isBuffer(t)?"buffer":"base64"),r=wk(n,a),rG(r,a)}function oC(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return ix(t.slice(r),e);default:break e}return eu.to_workbook(t,e)}function cG(t,e){var r="",n=Qv(t,e);switch(e.type){case"base64":r=wa(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=Sl(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=ar(r)),e.type="binary",oC(r,e)}function uG(t,e){var r=t;return e.type=="base64"&&(r=wa(r)),r=$f.utils.decode(1200,r.slice(2),"str"),e.type="binary",oC(r,e)}function fG(t){return t.match(/[^\x00-\x7F]/)?Ri(t):t}function p1(t,e,r,n){return n?(r.type="string",eu.to_workbook(t,r)):eu.to_workbook(e,r)}function lx(t,e){gv();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return lx(new Uint8Array(t),(r=dr(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,a=[0,0,0,0],o=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Wc={},r.dateNF&&(Wc.dateNF=r.dateNF),r.type||(r.type=bt&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=bt?"buffer":"binary",n=iP(t),typeof Uint8Array<"u"&&!bt&&(r.type="array")),r.type=="string"&&(o=!0,r.type="binary",r.codepage=65001,n=fG(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),u=new Uint8Array(l);if(u.foo="bar",!u.foo)return r=dr(r),r.type="array",lx(xv(n),r)}switch((a=Qv(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return oG(et.read(n,r),r);break;case 9:if(a[1]<=8)return J4(n,r);break;case 60:return ix(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return g9(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return x4.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?lG(n,r):p1(t,n,r,o);case 239:return a[3]===60?ix(n,r):p1(t,n,r,o);case 255:if(a[1]===254)return uG(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return ml.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return ml.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return ax.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return b4.to_workbook(n,r);break;case 10:case 13:case 32:return cG(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return p9.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?ax.to_workbook(n,r):p1(t,n,r,o)}function lC(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return k0(e.file,et.write(t,{type:bt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return et.write(t,e)}function hG(t,e){var r=dr(e||{}),n=aG(t,r);return dG(n,r)}function dG(t,e){var r={},n=bt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var a=t.FullPaths?et.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(e.type=="binary"||e.type=="base64")return a;a=new Uint8Array(Om(a))}return e.password&&typeof encrypt_agile<"u"?lC(encrypt_agile(a,e.password),e):e.type==="file"?k0(e.file,a):e.type=="string"?ar(a):a}function mG(t,e){var r=e||{},n=fz(t,r);return lC(n,r)}function Si(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return Qf(Ri(n));case"binary":return Ri(n);case"string":return t;case"file":return k0(e.file,n,"utf8");case"buffer":return bt?ys(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Si(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function pG(t,e){switch(e.type){case"base64":return Qf(t);case"binary":return t;case"string":return t;case"file":return k0(e.file,t,"binary");case"buffer":return bt?ys(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function pd(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?Qf(r):e.type=="string"?ar(r):r;case"file":return k0(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function cC(t,e){gv(),oH(t);var r=dr(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=cC(t,r);return r.type="array",Om(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=t.SheetNames.indexOf(r.sheet),!t.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Si(az(t,r),r);case"slk":case"sylk":return Si(g4.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"htm":case"html":return Si(tC(t.Sheets[t.SheetNames[a]],r),r);case"txt":return pG(uC(t.Sheets[t.SheetNames[a]],r),r);case"csv":return Si(Zv(t.Sheets[t.SheetNames[a]],r),r,"\uFEFF");case"dif":return Si(x4.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"dbf":return pd(ax.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"prn":return Si(eu.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"rtf":return Si(b4.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"eth":return Si(v4.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"fods":return Si(iC(t,r),r);case"wk1":return pd(ml.sheet_to_wk1(t.Sheets[t.SheetNames[a]],r),r);case"wk3":return pd(ml.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),pd(eC(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),mG(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return hG(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function gG(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function xG(t,e,r){var n={};return n.type="file",n.file=e,gG(n),cC(t,n)}function vG(t,e,r,n,a,o,l,u){var f=Pr(r),d=u.defval,m=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),v=!0,_=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(_,"__rowNum__",{value:r,enumerable:!1})}catch{_.__rowNum__=r}else _.__rowNum__=r;if(!l||t[r])for(var E=e.s.c;E<=e.e.c;++E){var S=l?t[r][E]:t[n[E]+f];if(S===void 0||S.t===void 0){if(d===void 0)continue;o[E]!=null&&(_[o[E]]=d);continue}var w=S.v;switch(S.t){case"z":if(w==null)break;continue;case"e":w=w==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+S.t)}if(o[E]!=null){if(w==null)if(S.t=="e"&&w===null)_[o[E]]=null;else if(d!==void 0)_[o[E]]=d;else if(m&&w===null)_[o[E]]=null;else continue;else _[o[E]]=m&&(S.t!=="n"||S.t==="n"&&u.rawNumbers!==!1)?w:_s(S,w,u);w!=null&&(v=!1)}}return{row:_,isempty:v}}function om(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,o=[],l=0,u="",f={s:{r:0,c:0},e:{r:0,c:0}},d=e||{},m=d.range!=null?d.range:t["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)?n=3:d.header==null&&(n=0),typeof m){case"string":f=Vt(m);break;case"number":f=Vt(t["!ref"]),f.s.r=m;break;default:f=m}n>0&&(a=0);var v=Pr(f.s.r),_=[],E=[],S=0,w=0,b=Array.isArray(t),L=f.s.r,B=0,F={};b&&!t[L]&&(t[L]=[]);var z=d.skipHidden&&t["!cols"]||[],q=d.skipHidden&&t["!rows"]||[];for(B=f.s.c;B<=f.e.c;++B)if(!(z[B]||{}).hidden)switch(_[B]=vr(B),r=b?t[L][B]:t[_[B]+v],n){case 1:o[B]=B-f.s.c;break;case 2:o[B]=_[B];break;case 3:o[B]=d.header[B-f.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),u=l=_s(r,null,d),w=F[l]||0,!w)F[l]=1;else{do u=l+"_"+w++;while(F[u]);F[l]=w,F[u]=1}o[B]=u}for(L=f.s.r+a;L<=f.e.r;++L)if(!(q[L]||{}).hidden){var W=vG(t,f,L,_,n,o,b,d);(W.isempty===!1||(n===1?d.blankrows!==!1:d.blankrows))&&(E[S++]=W.row)}return E.length=S,E}var ub=/"/g;function _G(t,e,r,n,a,o,l,u){for(var f=!0,d=[],m="",v=Pr(r),_=e.s.c;_<=e.e.c;++_)if(n[_]){var E=u.dense?(t[r]||[])[_]:t[n[_]+v];if(E==null)m="";else if(E.v!=null){f=!1,m=""+(u.rawNumbers&&E.t=="n"?E.v:_s(E,null,u));for(var S=0,w=0;S!==m.length;++S)if((w=m.charCodeAt(S))===a||w===o||w===34||u.forceQuotes){m='"'+m.replace(ub,'""')+'"';break}m=="ID"&&(m='"ID"')}else E.f!=null&&!E.F?(f=!1,m="="+E.f,m.indexOf(",")>=0&&(m='"'+m.replace(ub,'""')+'"')):m="";d.push(m)}return u.blankrows===!1&&f?null:d.join(l)}function Zv(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var a=Vt(t["!ref"]),o=n.FS!==void 0?n.FS:",",l=o.charCodeAt(0),u=n.RS!==void 0?n.RS:`
`,f=u.charCodeAt(0),d=new RegExp((o=="|"?"\\|":o)+"+$"),m="",v=[];n.dense=Array.isArray(t);for(var _=n.skipHidden&&t["!cols"]||[],E=n.skipHidden&&t["!rows"]||[],S=a.s.c;S<=a.e.c;++S)(_[S]||{}).hidden||(v[S]=vr(S));for(var w=0,b=a.s.r;b<=a.e.r;++b)(E[b]||{}).hidden||(m=_G(t,a,b,v,l,f,o,n),m!=null&&(n.strip&&(m=m.replace(d,"")),(m||n.blankrows!==!1)&&r.push((w++?u:"")+m)));return delete n.dense,r.join("")}function uC(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=Zv(t,e);return r}function yG(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var a=Vt(t["!ref"]),o="",l=[],u,f=[],d=Array.isArray(t);for(u=a.s.c;u<=a.e.c;++u)l[u]=vr(u);for(var m=a.s.r;m<=a.e.r;++m)for(o=Pr(m),u=a.s.c;u<=a.e.c;++u)if(e=l[u]+o,r=d?(t[m]||[])[u]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}f[f.length]=e+"="+n}return f}function fC(t,e,r){var n=r||{},a=+!n.skipHeader,o=t||{},l=0,u=0;if(o&&n.origin!=null)if(typeof n.origin=="number")l=n.origin;else{var f=typeof n.origin=="string"?_r(n.origin):n.origin;l=f.r,u=f.c}var d,m={s:{c:0,r:0},e:{c:u,r:l+e.length-1+a}};if(o["!ref"]){var v=Vt(o["!ref"]);m.e.c=Math.max(m.e.c,v.e.c),m.e.r=Math.max(m.e.r,v.e.r),l==-1&&(l=v.e.r+1,m.e.r=l+e.length-1+a)}else l==-1&&(l=0,m.e.r=e.length-1+a);var _=n.header||[],E=0;e.forEach(function(w,b){Ar(w).forEach(function(L){(E=_.indexOf(L))==-1&&(_[E=_.length]=L);var B=w[L],F="z",z="",q=ot({c:u+E,r:l+b+a});d=c0(o,q),B&&typeof B=="object"&&!(B instanceof Date)?o[q]=B:(typeof B=="number"?F="n":typeof B=="boolean"?F="b":typeof B=="string"?F="s":B instanceof Date?(F="d",n.cellDates||(F="n",B=tn(B)),z=n.dateNF||at[14]):B===null&&n.nullError&&(F="e",B=0),d?(d.t=F,d.v=B,delete d.w,delete d.R,z&&(d.z=z)):o[q]=d={t:F,v:B},z&&(d.z=z))})}),m.e.c=Math.max(m.e.c,u+_.length-1);var S=Pr(l);if(a)for(E=0;E<_.length;++E)o[vr(E+u)+S]={t:"s",v:_[E]};return o["!ref"]=vt(m),o}function wG(t,e){return fC(null,t,e)}function c0(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=_r(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?c0(t,ot(e)):c0(t,ot({r:e,c:r||0}))}function EG(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function Jv(){return{SheetNames:[],Sheets:{}}}function e_(t,e,r,n){var a=1;if(!r)for(;a<=65535&&t.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var o=r.match(/(^.*?)(\d+)$/);a=o&&+o[2]||0;var l=o&&o[1]||r;for(++a;a<=65535&&t.SheetNames.indexOf(r=l+a)!=-1;++a);}if(K4(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function TG(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=EG(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function bG(t,e){return t.z=e,t}function hC(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function SG(t,e,r){return hC(t,"#"+e,r)}function AG(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function kG(t,e,r,n){for(var a=typeof e!="string"?e:Vt(e),o=typeof e=="string"?e:vt(e),l=a.s.r;l<=a.e.r;++l)for(var u=a.s.c;u<=a.e.c;++u){var f=c0(t,l,u);f.t="n",f.F=o,delete f.v,l==a.s.r&&u==a.s.c&&(f.f=r,n&&(f.D=!0))}return t}var gd={encode_col:vr,encode_row:Pr,encode_cell:ot,encode_range:vt,decode_col:Rv,decode_row:Cv,split_cell:MP,decode_cell:_r,decode_range:aa,format_cell:_s,sheet_add_aoa:Bk,sheet_add_json:fC,sheet_add_dom:rC,aoa_to_sheet:uu,json_to_sheet:wG,table_to_sheet:nC,table_to_book:Oz,sheet_to_csv:Zv,sheet_to_txt:uC,sheet_to_json:om,sheet_to_html:tC,sheet_to_formulae:yG,sheet_to_row_object_array:om,sheet_get_cell:c0,book_new:Jv,book_append_sheet:e_,book_set_sheet_visibility:TG,cell_set_number_format:bG,cell_set_hyperlink:hC,cell_set_internal_link:SG,cell_add_comment:AG,sheet_set_array_formula:kG,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const g1=["Unidade","Licena","N-Ano","Descrio","rgo licenciador","FCEI-N do processo","Data emisso","Vencimento","Observao"],CG=({open:t,onClose:e,branches:r,licenseTypes:n,onAddBranch:a,onImport:o})=>{const l=Xe.useRef(null),[u,f]=Xe.useState(!1),[d,m]=Xe.useState(null),v=()=>{const S=gd.aoa_to_sheet([g1]),w=gd.book_new();gd.book_append_sheet(w,S,"Licenas"),xG(w,"modelo_licencas.xlsx")},_=async S=>{var b,L;const w=(b=S.target.files)==null?void 0:b[0];if(w){f(!0),m(null);try{const B=await w.arrayBuffer(),F=lx(B),z=F.Sheets[F.SheetNames[0]],q=gd.sheet_to_json(z,{header:1,defval:""});if(!q.length||q[0].length<g1.length){m("Arquivo invlido ou colunas insuficientes."),f(!1);return}const W=q[0].map(O=>O.trim());if(JSON.stringify(W)!==JSON.stringify(g1)){m("As colunas do arquivo no correspondem ao modelo."),f(!1);return}const k=q.slice(1).filter(O=>O.some(M=>M)),I={};for(const O of k){const M=(L=O[0])==null?void 0:L.trim();if(!M)continue;let N=r.find(D=>D.name.trim().toLowerCase()===M.toLowerCase());if(!N&&!I[M]){const he=await a({name:M,cnpj:"",address:"",city:"",state:"",contact:"",status:"Ativa"});I[M]=typeof he=="string"?he:""}else N&&(I[M]=N.id)}const A=k.map(O=>{var we;const M=n.find(ne=>ne.name===O[1]),N=E(O[7]);let D="",he="";if(M&&N){const ne=new Date(N+"T00:00:00");if(ne.setDate(ne.getDate()-(M.renewalProtocolDays||0)),D=isNaN(ne.getTime())?"":ne.toISOString().slice(0,10),D&&M.processStartDays){const ue=new Date(D+"T00:00:00");ue.setDate(ue.getDate()-(M.processStartDays||0)),he=isNaN(ue.getTime())?"":ue.toISOString().slice(0,10)}}return{unitId:I[(we=O[0])==null?void 0:we.trim()]||"",licenseType:O[1],numberYear:O[2],description:O[3],licensingAgency:O[4],processNumber:O[5],issueDate:E(O[6]),originalExpiryDate:N,prorrogaDate:D,processStartDate:he,observation:O[8],active:!0,inactiveObservation:""}});if(A.some(O=>!O.unitId||!O.licenseType)){m("Algumas linhas esto sem Unidade ou Licena."),f(!1);return}await o(A),m("Licenas importadas com sucesso!")}catch(B){m("Erro ao importar: "+B.message)}f(!1)}};function E(S){if(!S)return"";if(typeof S=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(S))return S;if(typeof S=="number"){const w=pk.parse_date_code(S);if(!w)return"";const b=String(w.m).padStart(2,"0"),L=String(w.d).padStart(2,"0");return`${w.y}-${b}-${L}`}return""}return t?y.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-30",children:y.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 w-full max-w-md relative",children:[y.jsx("button",{className:"absolute top-2 right-2 text-gray-400 hover:text-gray-700",onClick:e,children:""}),y.jsx("h3",{className:"text-lg font-bold mb-4",children:"Importar Licenas"}),y.jsxs("div",{className:"space-y-4",children:[y.jsx("button",{onClick:v,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Baixar modelo Excel"}),y.jsx("div",{children:y.jsx("input",{type:"file",accept:".xlsx,.xls",ref:l,onChange:_,disabled:u,className:"block w-full text-sm text-gray-700"})}),u&&y.jsx("div",{className:"text-blue-600",children:"Importando..."}),d&&y.jsx("div",{className:"text-sm text-center",style:{color:d.includes("sucesso")?"green":"red"},children:d})]})]})}):null},RG=({license:t,open:e,onClose:r,onUpdate:n,branches:a,licenseTypes:o})=>{const[l,u]=Xe.useState("details"),[f,d]=Xe.useState(!1),[m,v]=Xe.useState(null),[_,E]=Xe.useState(!1),[S,w]=Xe.useState(null),[b,L]=Xe.useState(!1),B=async N=>{if(!(!N.attachments||N.attachments.length===0)){L(!0);try{const D=[];for(const ne of N.attachments)try{if(ne.storagePath){const ue=Cd(Rd,ne.storagePath);await _5(ue),D.push(ne)}else D.push(ne)}catch{console.log(`Arquivo deletado detectado: ${ne.fileName}`)}const he=D.length>0,we=N.fileUrl&&D.length<N.attachments.length;if(D.length<N.attachments.length||we){const ne={...N,attachments:D,...he&&{fileUrl:"",fileName:""}};v(ne),n(ne)}}catch(D){console.error("Erro ao verificar anexos:",D)}finally{L(!1)}}};if(Xe.useEffect(()=>{t&&e&&(v(t),B(t))},[t,e]),!e||!t)return null;const F=N=>{var D;return((D=a.find(he=>he.id===N))==null?void 0:D.name)||"Desconhecida"},z=N=>{const D=new Date;D.setHours(0,0,0,0);const we=new Date(N+"T00:00:00").getTime()-D.getTime();return Math.ceil(we/(1e3*60*60*24))},q=(N=t)=>{if(!N.active)return y.jsx("span",{className:"px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-100 text-gray-800",children:"Desativada"});const D=z(N.originalExpiryDate),he=o.find(ne=>ne.name===N.licenseType),we=he?(he.renewalProtocolDays||0)+(he.processStartDays||0):180;return D<0?y.jsxs("span",{className:"px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800",children:["Vencida h ",Math.abs(D)," dia(s)"]}):D<=we?y.jsxs("span",{className:"px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800",children:["Vence em ",D," dia(s)"]}):y.jsx("span",{className:"px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:"Vigente"})},W=(N,D)=>{m&&v({...m,[N]:D})},k=()=>{m&&(n(m),d(!1))},I=async N=>{if(N.target.files&&N.target.files[0]&&m){const D=N.target.files[0];E(!0);try{const he=`licenses/${m.id}/${Date.now()}_${D.name}`,we=Cd(Rd,he),ne=await JA(we,D),ue=await ek(ne.ref),Ve={id:Date.now().toString(),fileName:D.name,fileUrl:ue,uploadedAt:new Date().toISOString(),storagePath:he},ie=m.attachments||[];v({...m,attachments:[...ie,Ve]})}catch(he){console.error("Erro ao fazer upload do arquivo:",he),alert("Erro ao fazer upload do arquivo.")}finally{E(!1),N.target.value=""}}},A=async N=>{if(!(!m||!window.confirm("Tem certeza que deseja excluir este anexo?"))){w(N.id);try{if(N.storagePath)try{const he=Cd(Rd,N.storagePath);await y5(he)}catch(he){console.warn("Arquivo j foi deletado ou no existe no Storage:",he)}const D=(m.attachments||[]).filter(he=>he.id!==N.id);v({...m,attachments:D})}catch(D){console.error("Erro ao deletar arquivo:",D),alert("Erro ao deletar o arquivo.")}finally{w(null)}}},O=m||t,M=((O==null?void 0:O.attachments)||[]).filter(N=>N!=null);return y.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:y.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col",children:[y.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-start",children:[y.jsxs("div",{children:[y.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:O.licenseType}),y.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:O.numberYear})]}),y.jsxs("div",{className:"flex items-center gap-2",children:[!f&&y.jsx("button",{onClick:()=>d(!0),className:"px-3 py-1 bg-blue-500 text-white rounded text-sm font-medium hover:bg-blue-600 transition-colors",children:" Editar"}),y.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",children:y.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),y.jsxs("div",{className:"px-6 border-b border-gray-200 dark:border-gray-700 flex gap-4",children:[y.jsx("button",{onClick:()=>u("details"),className:`py-3 px-1 border-b-2 font-medium text-sm transition-colors ${l==="details"?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-300"}`,children:"Detalhes"}),y.jsxs("button",{onClick:()=>u("attachments"),className:`py-3 px-1 border-b-2 font-medium text-sm transition-colors ${l==="attachments"?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-300"}`,children:["Anexos ",M.length>0&&`(${M.length})`,b&&y.jsx("span",{className:"ml-1 animate-spin",children:""})]})]}),y.jsx("div",{className:"flex-1 overflow-y-auto px-6 py-4",children:l==="details"?y.jsxs("div",{className:"space-y-6",children:[y.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[y.jsxs("div",{children:[y.jsx("h3",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Status"}),y.jsx("div",{className:"mt-2",children:q(O)})]}),y.jsxs("div",{children:[y.jsx("h3",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Categoria"}),f?y.jsxs("select",{value:O.category||"Ambiental",onChange:N=>W("category",N.target.value),className:"mt-2 p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm",children:[y.jsx("option",{value:"Ambiental",children:"Ambiental"}),y.jsx("option",{value:"SGA",children:"SGA"})]}):y.jsx("p",{className:"mt-2 text-sm font-medium text-gray-900 dark:text-white",children:O.category||"Ambiental"})]})]}),y.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[y.jsxs("div",{children:[y.jsx("h3",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Unidade/Filial"}),f?y.jsxs("select",{value:O.unitId,onChange:N=>W("unitId",N.target.value),className:"mt-2 p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm w-full",children:[y.jsx("option",{value:"",children:"Selecione uma unidade"}),a.map(N=>y.jsx("option",{value:N.id,children:N.name},N.id))]}):y.jsx("p",{className:"mt-2 text-sm font-medium text-gray-900 dark:text-white",children:F(O.unitId)})]}),y.jsxs("div",{children:[y.jsx("h3",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Tipo de Licena"}),f?y.jsxs("select",{value:O.licenseType,onChange:N=>W("licenseType",N.target.value),className:"mt-2 p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm w-full",children:[y.jsx("option",{value:"",children:"Selecione um tipo"}),o.map(N=>y.jsx("option",{value:N.name,children:N.name},N.id))]}):y.jsx("p",{className:"mt-2 text-sm font-medium text-gray-900 dark:text-white",children:O.licenseType})]})]}),y.jsxs("div",{children:[y.jsx("h3",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"N/Ano"}),f?y.jsx("input",{type:"text",value:O.numberYear,onChange:N=>W("numberYear",N.target.value),className:"mt-2 w-full p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm"}):y.jsx("p",{className:"mt-2 text-sm font-medium text-gray-900 dark:text-white",children:O.numberYear})]}),y.jsxs("div",{children:[y.jsx("h3",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Descrio"}),f?y.jsx("textarea",{value:O.description,onChange:N=>W("description",N.target.value),rows:3,className:"mt-2 w-full p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm"}):y.jsx("p",{className:"mt-2 text-sm text-gray-900 dark:text-white",children:O.description||"-"})]}),y.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[y.jsxs("div",{children:[y.jsx("h3",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"rgo Licenciador"}),f?y.jsx("input",{type:"text",value:O.licensingAgency,onChange:N=>W("licensingAgency",N.target.value),className:"mt-2 w-full p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm"}):y.jsx("p",{className:"mt-2 text-sm text-gray-900 dark:text-white",children:O.licensingAgency||"-"})]}),y.jsxs("div",{children:[y.jsx("h3",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Responsvel"}),f?y.jsx("input",{type:"text",value:O.responsible||"",onChange:N=>W("responsible",N.target.value),className:"mt-2 w-full p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm"}):y.jsx("p",{className:"mt-2 text-sm text-gray-900 dark:text-white",children:O.responsible||"-"})]})]}),y.jsxs("div",{children:[y.jsx("h3",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"N do Processo (FCEI)"}),f?y.jsx("input",{type:"text",value:O.processNumber,onChange:N=>W("processNumber",N.target.value),className:"mt-2 w-full p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm"}):y.jsx("p",{className:"mt-2 text-sm text-gray-900 dark:text-white",children:O.processNumber||"-"})]}),y.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[y.jsxs("div",{children:[y.jsx("h3",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Data de Emisso"}),f?y.jsx("input",{type:"date",value:O.issueDate,onChange:N=>W("issueDate",N.target.value),className:"mt-2 w-full p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm"}):y.jsx("p",{className:"mt-2 text-sm text-gray-900 dark:text-white",children:O.issueDate?new Date(O.issueDate+"T00:00:00").toLocaleDateString("pt-BR"):"-"})]}),y.jsxs("div",{children:[y.jsx("h3",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Data de Vencimento"}),f?y.jsx("input",{type:"date",value:O.originalExpiryDate,onChange:N=>W("originalExpiryDate",N.target.value),className:"mt-2 w-full p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm"}):y.jsx("p",{className:"mt-2 text-sm text-gray-900 dark:text-white",children:O.originalExpiryDate?new Date(O.originalExpiryDate+"T00:00:00").toLocaleDateString("pt-BR"):"-"})]})]}),y.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[y.jsxs("div",{children:[y.jsx("h3",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Prazo Prorrogao"}),f?y.jsx("input",{type:"date",value:O.prorrogaDate,onChange:N=>W("prorrogaDate",N.target.value),className:"mt-2 w-full p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm"}):y.jsx("p",{className:"mt-2 text-sm text-gray-900 dark:text-white",children:O.prorrogaDate?new Date(O.prorrogaDate+"T00:00:00").toLocaleDateString("pt-BR"):"-"})]}),y.jsxs("div",{children:[y.jsx("h3",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Incio do Processo"}),f?y.jsx("input",{type:"date",value:O.processStartDate,onChange:N=>W("processStartDate",N.target.value),className:"mt-2 w-full p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm"}):y.jsx("p",{className:"mt-2 text-sm text-gray-900 dark:text-white",children:O.processStartDate?new Date(O.processStartDate+"T00:00:00").toLocaleDateString("pt-BR"):"-"})]})]}),f&&y.jsxs("div",{className:"flex items-center gap-2 p-3 bg-gray-50 dark:bg-gray-700/50 rounded",children:[y.jsx("input",{type:"checkbox",id:"active",checked:O.active,onChange:N=>W("active",N.target.checked),className:"accent-blue-600"}),y.jsx("label",{htmlFor:"active",className:"text-sm font-medium text-gray-900 dark:text-white",children:"Licena Vigente"})]}),y.jsxs("div",{children:[y.jsx("h3",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Observao"}),f?y.jsx("textarea",{value:O.observation,onChange:N=>W("observation",N.target.value),rows:2,className:"mt-2 w-full p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm"}):y.jsx("p",{className:"mt-2 text-sm text-gray-900 dark:text-white",children:O.observation||"-"})]}),!O.active&&y.jsxs("div",{children:[y.jsx("h3",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Motivo da Desativao"}),f?y.jsx("textarea",{value:O.inactiveObservation||"",onChange:N=>W("inactiveObservation",N.target.value),rows:2,className:"mt-2 w-full p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm"}):y.jsx("p",{className:"mt-2 text-sm text-gray-900 dark:text-white",children:O.inactiveObservation||"-"})]})]}):y.jsxs("div",{className:"space-y-4",children:[f&&y.jsx("div",{className:"border-2 border-dashed border-blue-300 dark:border-blue-700 rounded-lg p-6 text-center hover:border-blue-400 dark:hover:border-blue-600 transition-colors",children:y.jsxs("label",{className:"cursor-pointer block",children:[y.jsxs("div",{className:"flex flex-col items-center gap-2",children:[y.jsx("svg",{className:"w-8 h-8 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),y.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:_?"Enviando...":"Clique para adicionar anexo"}),y.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"ou arraste um arquivo aqui"})]}),y.jsx("input",{type:"file",onChange:I,disabled:_,className:"hidden"})]})}),M.length>0?y.jsx("div",{className:"space-y-2",children:M.map(N=>y.jsxs("div",{className:"border border-gray-200 dark:border-gray-600 rounded-lg p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[y.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[y.jsx("div",{className:"text-2xl flex-shrink-0",children:""}),y.jsxs("div",{className:"min-w-0",children:[y.jsx("a",{href:N.fileUrl,download:N.fileName,target:"_blank",rel:"noopener noreferrer",className:"text-sm font-medium text-blue-600 dark:text-blue-400 hover:underline truncate block",children:N.fileName}),y.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:new Date(N.uploadedAt).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})})]})]}),y.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0 ml-4",children:[y.jsx("a",{href:N.fileUrl,download:N.fileName,target:"_blank",rel:"noopener noreferrer",className:"p-2 rounded-lg bg-blue-100 dark:bg-blue-900/50 text-blue-600 dark:text-blue-400 hover:bg-blue-200 dark:hover:bg-blue-900 transition-colors",title:"Baixar",children:y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})})}),f&&y.jsx("button",{onClick:()=>A(N),disabled:S===N.id,className:"p-2 rounded-lg bg-red-100 dark:bg-red-900/50 text-red-600 dark:text-red-400 hover:bg-red-200 dark:hover:bg-red-900 transition-colors disabled:opacity-50",title:"Excluir",children:y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},N.id))}):y.jsxs("div",{className:"border border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-8 text-center",children:[y.jsx("div",{className:"text-4xl mb-2",children:""}),y.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Nenhum arquivo anexado a esta licena"})]})]})}),y.jsx("div",{className:"px-6 py-4 border-t border-gray-200 dark:border-gray-700 flex justify-end gap-2",children:f?y.jsxs(y.Fragment,{children:[y.jsx("button",{onClick:()=>{d(!1),v(t)},className:"px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-900 dark:text-white rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors font-medium",children:"Cancelar"}),y.jsx("button",{onClick:k,className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors font-medium",children:"Salvar Alteraes"})]}):y.jsx("button",{onClick:r,className:"px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-900 dark:text-white rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors font-medium",children:"Fechar"})})]})})},x1={unitId:"",licenseType:"",numberYear:"",description:"",licensingAgency:"",processNumber:"",issueDate:"",originalExpiryDate:"",prorrogaDate:"",processStartDate:"",observation:"",active:!0,inactiveObservation:"",category:"Ambiental",responsible:"",fileUrl:"",fileName:""},dC=[{label:"Unidade",key:"unitId",visible:!0},{label:"Licena",key:"licenseType",visible:!0},{label:"N/Ano",key:"numberYear",visible:!0},{label:"Descrio",key:"description",visible:!0},{label:"rgo Licenciador",key:"licensingAgency",visible:!0},{label:"FCEI-N do Processo",key:"processNumber",visible:!0},{label:"Responsvel",key:"responsible",visible:!0},{label:"Arquivo",key:"fileUrl",visible:!0},{label:"Data Emisso",key:"issueDate",visible:!0},{label:"Data Vencimento",key:"originalExpiryDate",visible:!0},{label:"Prazo Prorrogao",key:"prorrogaDate",visible:!0},{label:"Incio Processo",key:"processStartDate",visible:!0},{label:"Alerta",key:"alert",visible:!0},{label:"Observao",key:"observation",visible:!0},{label:"Aes",key:"actions",visible:!0}];function NG(){const t=localStorage.getItem("licenseTableColumns");return t?JSON.parse(t):dC}const fb=({licenses:t,branches:e,licenseTypes:r,onAddLicense:n,onUpdateLicense:a,onDeleteLicense:o,onAddBranch:l,category:u="Ambiental"})=>{const[f,d]=Xe.useState(x1),[m,v]=Xe.useState(!1),[_,E]=Xe.useState(null),[S,w]=Xe.useState(!1),[b,L]=Xe.useState({branchId:"",licenseType:"",onlyAlert:!1}),[B,F]=Xe.useState({key:"originalExpiryDate",direction:"asc"}),[z,q]=Xe.useState(!1),[W,k]=Xe.useState(!1),[I,A]=Xe.useState(NG()),[O,M]=Xe.useState(()=>{const se=localStorage.getItem("licenseTableColWidths");return se?JSON.parse(se):{}}),[N,D]=Xe.useState(!1),[he,we]=Xe.useState(null),[ne,ue]=Xe.useState(!1);Xe.useEffect(()=>{localStorage.setItem("licenseTableColumns",JSON.stringify(I))},[I]),Xe.useEffect(()=>{localStorage.setItem("licenseTableColWidths",JSON.stringify(O))},[O]);function Ve(se){A(Me=>Me.map((Re,Je)=>Je===se?{...Re,visible:!Re.visible}:Re))}function ie(se,Me){A(Re=>{const Je=[...Re],[pt]=Je.splice(se,1);return Je.splice(Me,0,pt),Je})}function ee(){A(dC)}const ge=()=>{E(null),d({...x1,category:u}),v(!0)},V=se=>{E(se);const{id:Me,...Re}=se;d(Re),v(!0)},K=()=>{v(!1),E(null),d(x1)},Y=se=>{const{name:Me,value:Re}=se.target;d(Je=>{let pt={...Je,[Me]:Re};if(Me==="originalExpiryDate"||Me==="licenseType"){const mt=r.find(qt=>qt.name===(Me==="licenseType"?Re:Je.licenseType)),sr=Me==="originalExpiryDate"?Re:Je.originalExpiryDate;if(mt&&sr){const qt=new Date(sr+"T00:00:00");if(qt.setDate(qt.getDate()-(mt.renewalProtocolDays||0)),pt.prorrogaDate=isNaN(qt.getTime())?"":qt.toISOString().slice(0,10),pt.prorrogaDate&&mt.processStartDays){const Un=new Date(pt.prorrogaDate+"T00:00:00");Un.setDate(Un.getDate()-(mt.processStartDays||0)),pt.processStartDate=isNaN(Un.getTime())?"":Un.toISOString().slice(0,10)}else pt.processStartDate=""}else pt.prorrogaDate="",pt.processStartDate=""}return pt})},te=se=>{if(se.preventDefault(),!f.unitId||!f.licenseType){alert("Por favor, selecione uma unidade e um tipo de licena.");return}_?a({...f,id:_.id}):n(f),K()},ce=se=>{var Me;return((Me=e.find(Re=>Re.id===se))==null?void 0:Me.name)||"Desconhecida"},De=se=>{const Me=new Date;Me.setHours(0,0,0,0);const Je=new Date(se+"T00:00:00").getTime()-Me.getTime();return Math.ceil(Je/(1e3*60*60*24))},ke=se=>{F(Me=>Me.key===se?{key:se,direction:Me.direction==="asc"?"desc":"asc"}:{key:se,direction:"asc"})};function Fe(se,Me){if(["issueDate","originalExpiryDate","prorrogaDate","processStartDate"].includes(Me))return se[Me]?new Date(se[Me]):new Date(0);if(Me==="alert"){const Re=De(se.originalExpiryDate),Je=r.find(mt=>mt.name===se.licenseType),pt=Je?(Je.renewalProtocolDays||0)+(Je.processStartDays||0):180;return Re<0?0:Re<=pt?1:2}return(se[Me]||"").toString().toLowerCase()}function ye(se,Me){M(Re=>({...Re,[se]:Math.max(80,Me)}))}const Be=[...e].sort((se,Me)=>se.name.localeCompare(Me.name)),X=[...r].sort((se,Me)=>se.name.localeCompare(Me.name)),wt=[...t.filter(se=>se.active).filter(se=>(!b.branchId||se.unitId===b.branchId)&&(!b.licenseType||se.licenseType===b.licenseType)&&(!b.onlyAlert||Fe(se,"alert")!==2)&&(u==="Ambiental"?!se.category||se.category==="Ambiental":se.category===u))].sort((se,Me)=>{const Re=Fe(se,B.key),Je=Fe(Me,B.key);return Re<Je?B.direction==="asc"?-1:1:Re>Je?B.direction==="asc"?1:-1:0}),ut=(se,Me)=>{const Re=De(se),Je=r.find(mt=>mt.name===Me),pt=Je?(Je.renewalProtocolDays||0)+(Je.processStartDays||0):180;return Re<0?y.jsxs("span",{className:"px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800",children:["Vencida h ",Math.abs(Re)," dia(s)"]}):Re<=pt?y.jsxs("span",{className:"px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800",children:["Vence em ",Re," dia(s)"]}):y.jsx("span",{className:"px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:"Ativa"})},[Ue,Jt]=Xe.useState(null),[Cr,Mr]=Xe.useState(!1);function Xr(se,Me){if(Cr){se.preventDefault();return}Jt(Me),se.dataTransfer.effectAllowed="move"}function Ga(se,Me){se.preventDefault(),se.dataTransfer.dropEffect="move"}function hn(se,Me){if(se.preventDefault(),Ue===null||Ue===Me)return;const Re=I.filter(qt=>qt.visible),Je=Re[Ue],pt=Re[Me],mt=I.findIndex(qt=>qt.key===Je.key),sr=I.findIndex(qt=>qt.key===pt.key);ie(mt,sr),Jt(null)}const Rr=async se=>{if(se.target.files&&se.target.files[0]){const Me=se.target.files[0];D(!0);try{const Re=Cd(Rd,`licenses/${Date.now()}_${Me.name}`),Je=await JA(Re,Me),pt=await ek(Je.ref);d(mt=>({...mt,fileUrl:pt,fileName:Me.name}))}catch(Re){console.error("Error uploading file: ",Re),alert("Erro ao fazer upload do arquivo.")}finally{D(!1)}}},Tn=se=>{we(se),ue(!0)},Ut=()=>{ue(!1),we(null)},kt=async se=>{await a(se)};return gb.useEffect(()=>{if(he&&ne){const se=t.find(Me=>Me.id===he.id);se&&we(se)}},[t,ne]),y.jsxs("div",{className:"space-y-6",children:[y.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg",children:[y.jsxs("div",{className:"flex justify-between items-center mb-4",children:[y.jsxs("h2",{className:"text-2xl font-bold text-gray-700 dark:text-white flex items-center gap-2",children:[_?"Editar Licena":"Cadastro de Licenas",y.jsx("button",{type:"button",onClick:()=>w(se=>!se),className:"ml-2 p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition",children:y.jsx(rk,{})}),y.jsx("button",{type:"button",onClick:()=>k(!0),className:"ml-2 p-2 rounded hover:bg-gray-100 transition",title:"Configurar colunas",children:y.jsx(A5,{})})]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("button",{type:"button",onClick:()=>q(!0),className:"p-2 rounded hover:bg-gray-100 transition",title:"Importar planilha",children:y.jsx(S5,{})}),y.jsx("button",{onClick:m?K:ge,className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white font-semibold rounded-lg hover:bg-blue-600 transition-transform transform hover:scale-105",children:m?"Fechar Formulrio":y.jsxs(y.Fragment,{children:[y.jsx(Im,{})," Nova Licena"]})})]})]}),S&&y.jsxs("div",{className:"mb-4 bg-gray-50 dark:bg-gray-700/60 border border-gray-200 dark:border-gray-600 rounded-lg p-4 flex flex-col md:flex-row gap-4 items-center",children:[y.jsxs("div",{className:"flex flex-col",children:[y.jsx("label",{className:"text-xs font-semibold text-gray-600 dark:text-gray-200 mb-1",children:"Filtrar por Filial"}),y.jsxs("select",{value:b.branchId,onChange:se=>L(Me=>({...Me,branchId:se.target.value})),className:"p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-100",children:[y.jsx("option",{value:"",children:"Todas"}),Be.map(se=>y.jsx("option",{value:se.id,children:se.name},se.id))]})]}),y.jsxs("div",{className:"flex flex-col",children:[y.jsx("label",{className:"text-xs font-semibold text-gray-600 dark:text-gray-200 mb-1",children:"Filtrar por Tipo de Licena"}),y.jsxs("select",{value:b.licenseType,onChange:se=>L(Me=>({...Me,licenseType:se.target.value})),className:"p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-100",children:[y.jsx("option",{value:"",children:"Todas"}),X.map(se=>y.jsx("option",{value:se.name,children:se.name},se.id))]})]}),y.jsxs("div",{className:"flex flex-col",children:[y.jsx("label",{className:"text-xs font-semibold text-gray-600 dark:text-gray-200 mb-1",children:""}),y.jsxs("label",{className:"inline-flex items-center text-sm text-gray-700 dark:text-gray-200",children:[y.jsx("input",{type:"checkbox",checked:b.onlyAlert,onChange:se=>L(Me=>({...Me,onlyAlert:se.target.checked})),className:"mr-2 accent-blue-600"}),"Mostrar apenas licenas em alerta"]})]}),y.jsx("button",{onClick:()=>L({branchId:"",licenseType:"",onlyAlert:!1}),className:"mt-4 md:mt-6 px-4 py-2 bg-gray-300 dark:bg-gray-600 text-gray-700 dark:text-gray-100 rounded hover:bg-gray-400 dark:hover:bg-gray-500 transition",children:"Limpar Filtros"})]}),m&&y.jsxs("form",{onSubmit:te,className:"grid grid-cols-1 md:grid-cols-2 gap-6 animate-fade-in",children:[y.jsxs("div",{className:"flex flex-col",children:[y.jsx("label",{htmlFor:"unitId",className:"mb-1 font-semibold text-gray-600",children:"Unidade"}),y.jsxs("select",{name:"unitId",id:"unitId",value:f.unitId,onChange:Y,required:!0,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition",children:[y.jsx("option",{value:"",disabled:!0,children:"Selecione uma Filial"}),Be.map(se=>y.jsx("option",{value:se.id,children:se.name},se.id))]})]}),y.jsxs("div",{className:"flex flex-col",children:[y.jsx("label",{htmlFor:"licenseType",className:"mb-1 font-semibold text-gray-600",children:"Licena"}),y.jsxs("select",{name:"licenseType",id:"licenseType",value:f.licenseType,onChange:Y,required:!0,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition",children:[y.jsx("option",{value:"",disabled:!0,children:"Selecione o tipo"}),X.map(se=>y.jsx("option",{value:se.name,children:se.name},se.id))]})]}),y.jsxs("div",{className:"flex flex-col",children:[y.jsx("label",{htmlFor:"numberYear",className:"mb-1 font-semibold text-gray-600",children:"N/Ano"}),y.jsx("input",{type:"text",name:"numberYear",id:"numberYear",value:f.numberYear,onChange:Y,required:!0,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition"})]}),y.jsxs("div",{className:"flex flex-col",children:[y.jsx("label",{htmlFor:"description",className:"mb-1 font-semibold text-gray-600",children:"Descrio"}),y.jsx("textarea",{name:"description",id:"description",value:f.description,onChange:Y,rows:2,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition"})]}),y.jsxs("div",{className:"flex flex-col",children:[y.jsx("label",{htmlFor:"licensingAgency",className:"mb-1 font-semibold text-gray-600",children:"rgo Licenciador"}),y.jsx("input",{type:"text",name:"licensingAgency",id:"licensingAgency",value:f.licensingAgency,onChange:Y,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition"})]}),y.jsxs("div",{className:"flex flex-col",children:[y.jsx("label",{htmlFor:"processNumber",className:"mb-1 font-semibold text-gray-600",children:"FCEI-N do Processo"}),y.jsx("input",{type:"text",name:"processNumber",id:"processNumber",value:f.processNumber,onChange:Y,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition"})]}),y.jsxs("div",{className:"flex flex-col",children:[y.jsx("label",{htmlFor:"responsible",className:"mb-1 font-semibold text-gray-600",children:"Responsvel"}),y.jsx("input",{type:"text",name:"responsible",id:"responsible",value:f.responsible||"",onChange:Y,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition"})]}),y.jsxs("div",{className:"flex flex-col",children:[y.jsx("label",{htmlFor:"file",className:"mb-1 font-semibold text-gray-600",children:"Anexar Arquivo"}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("input",{type:"file",id:"file",onChange:Rr,className:"p-2 border border-gray-300 rounded-lg w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100",disabled:N}),N&&y.jsx("span",{className:"text-sm text-blue-500",children:"Enviando..."})]}),f.fileName&&y.jsxs("span",{className:"text-xs text-green-600 mt-1",children:["Arquivo atual: ",f.fileName]})]}),y.jsxs("div",{className:"flex flex-col",children:[y.jsx("label",{htmlFor:"issueDate",className:"mb-1 font-semibold text-gray-600",children:"Data Emisso"}),y.jsx("input",{type:"date",name:"issueDate",id:"issueDate",value:f.issueDate,onChange:Y,required:!0,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition"})]}),y.jsxs("div",{className:"flex flex-col",children:[y.jsx("label",{htmlFor:"originalExpiryDate",className:"mb-1 font-semibold text-gray-600",children:"Data Vencimento"}),y.jsx("input",{type:"date",name:"originalExpiryDate",id:"originalExpiryDate",value:f.originalExpiryDate,onChange:Y,required:!0,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition"})]}),y.jsxs("div",{className:"flex flex-col",children:[y.jsx("label",{htmlFor:"prorrogaDate",className:"mb-1 font-semibold text-gray-600",children:"Prazo para Prorrogao"}),y.jsx("input",{type:"date",name:"prorrogaDate",id:"prorrogaDate",value:f.prorrogaDate,onChange:Y,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition"})]}),y.jsxs("div",{className:"flex flex-col",children:[y.jsx("label",{htmlFor:"processStartDate",className:"mb-1 font-semibold text-gray-600",children:"Incio do Processo"}),y.jsx("input",{type:"date",name:"processStartDate",id:"processStartDate",value:f.processStartDate,onChange:Y,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition"})]}),y.jsxs("div",{className:"flex items-center md:col-span-2",children:[y.jsx("input",{type:"checkbox",id:"active",name:"active",checked:f.active,onChange:se=>d(Me=>({...Me,active:se.target.checked,inactiveObservation:se.target.checked?"":Me.inactiveObservation})),className:"mr-2"}),y.jsx("label",{htmlFor:"active",className:"font-semibold text-gray-600",children:"Licena Vigente"})]}),!f.active&&y.jsxs("div",{className:"md:col-span-2 flex flex-col",children:[y.jsx("label",{htmlFor:"inactiveObservation",className:"mb-1 font-semibold text-gray-600",children:"Observao da Desativao"}),y.jsx("textarea",{name:"inactiveObservation",id:"inactiveObservation",value:f.inactiveObservation,onChange:Y,rows:2,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition",required:!f.active})]}),y.jsxs("div",{className:"md:col-span-2 flex flex-col",children:[y.jsx("label",{htmlFor:"observation",className:"mb-1 font-semibold text-gray-600",children:"Observao"}),y.jsx("textarea",{name:"observation",id:"observation",value:f.observation,onChange:Y,rows:2,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition"})]}),y.jsxs("div",{className:"md:col-span-2 flex justify-end gap-4",children:[y.jsx("button",{type:"button",onClick:K,className:"px-6 py-3 bg-gray-500 text-white font-bold rounded-lg hover:bg-gray-600 transition-colors",children:"Cancelar"}),y.jsx("button",{type:"submit",className:"px-6 py-3 bg-green-500 text-white font-bold rounded-lg hover:bg-green-600 transition-colors",children:_?"Salvar Alteraes":"Salvar Licena"})]})]})]}),y.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg",children:[y.jsx("h2",{className:"text-2xl font-bold text-gray-700 dark:text-white mb-4",children:"Licenas Registradas"}),y.jsx("div",{className:"overflow-x-auto table-scrollbar",style:{transform:"rotateX(180deg)"},children:y.jsxs("table",{className:"min-w-full bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700 table-fixed",style:{transform:"rotateX(180deg)"},children:[y.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:y.jsx("tr",{children:I.filter(se=>se.visible).map((se,Me)=>y.jsxs("th",{draggable:se.key!=="actions"&&!Cr,onDragStart:Re=>Xr(Re,Me),onDragOver:Re=>Ga(Re),onDrop:Re=>hn(Re,Me),className:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider select-none relative group border-r border-transparent hover:border-gray-300 transition-colors ${Ue===Me?"opacity-50 bg-gray-100":""}`,style:{width:O[se.key]?O[se.key]+"px":void 0,minWidth:80,cursor:se.key!=="actions"?"grab":"default"},onClick:se.key&&se.key!=="alert"&&se.key!=="actions"?()=>ke(se.key):void 0,children:[y.jsxs("div",{className:"flex items-center justify-between",children:[y.jsx("span",{className:"truncate",title:se.label,children:se.label}),se.key&&B.key===se.key&&y.jsx("span",{className:"ml-1 flex-shrink-0",children:B.direction==="asc"?"":""})]}),se.key!=="actions"&&se.key!=="alert"&&y.jsx("div",{className:"absolute right-0 top-0 h-full w-4 cursor-col-resize hover:bg-blue-400/20 z-10 flex justify-end",onMouseDown:Re=>{Re.stopPropagation(),Re.preventDefault(),Mr(!0);const Je=Re.clientX,pt=Re.currentTarget.parentElement;if(!pt)return;const mt=pt.offsetWidth;function sr(Un){ye(String(se.key),mt+(Un.clientX-Je))}function qt(){Mr(!1),window.removeEventListener("mousemove",sr),window.removeEventListener("mouseup",qt)}window.addEventListener("mousemove",sr),window.addEventListener("mouseup",qt)},title:"Arraste para redimensionar",children:y.jsx("div",{className:"w-1 h-full bg-transparent hover:bg-blue-400 transition-colors"})})]},se.key))})}),y.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:wt.map((se,Me)=>y.jsx("tr",{onClick:()=>Tn(se),className:"bg-white dark:bg-gray-800 transition-all duration-200 ease-out hover:bg-gray-50 hover:shadow-md hover:-translate-y-0.5 dark:hover:bg-gray-700 cursor-pointer",children:I.filter(Re=>Re.visible).map((Re,Je)=>{switch(Re.key){case"unitId":return y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white overflow-hidden text-ellipsis",children:ce(se.unitId)},Re.key);case"licenseType":return y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300 overflow-hidden text-ellipsis",children:se.licenseType},Re.key);case"numberYear":return y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300 overflow-hidden text-ellipsis",children:se.numberYear},Re.key);case"description":return y.jsx("td",{className:"px-6 py-4 whitespace-normal text-sm text-gray-600 dark:text-gray-300 overflow-hidden text-ellipsis",children:se.description},Re.key);case"licensingAgency":return y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300 overflow-hidden text-ellipsis",children:se.licensingAgency},Re.key);case"processNumber":return y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300 overflow-hidden text-ellipsis",children:se.processNumber},Re.key);case"responsible":return y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300 overflow-hidden text-ellipsis",children:se.responsible||"-"},Re.key);case"fileUrl":const pt=(se.attachments||[]).filter(sr=>sr&&sr.fileUrl),mt=pt.length>0?pt[0]:null;return y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300 overflow-hidden text-ellipsis",children:mt?y.jsxs("a",{href:mt.fileUrl,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline flex items-center gap-1",children:[" ",y.jsx("span",{className:"truncate max-w-[100px]",children:mt.fileName})]}):se.fileUrl?y.jsxs("a",{href:se.fileUrl,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline flex items-center gap-1",children:[" ",y.jsx("span",{className:"truncate max-w-[100px]",children:se.fileName||"Arquivo"})]}):"-"},Re.key);case"issueDate":return y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300 overflow-hidden text-ellipsis",children:se.issueDate?new Date(se.issueDate+"T00:00:00").toLocaleDateString("pt-BR"):""},Re.key);case"originalExpiryDate":return y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300 overflow-hidden text-ellipsis",children:se.originalExpiryDate?new Date(se.originalExpiryDate+"T00:00:00").toLocaleDateString("pt-BR"):""},Re.key);case"prorrogaDate":return y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300 overflow-hidden text-ellipsis",children:se.prorrogaDate?new Date(se.prorrogaDate+"T00:00:00").toLocaleDateString("pt-BR"):""},Re.key);case"processStartDate":return y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300 overflow-hidden text-ellipsis",children:se.processStartDate?new Date(se.processStartDate+"T00:00:00").toLocaleDateString("pt-BR"):""},Re.key);case"alert":return y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:ut(se.originalExpiryDate,se.licenseType)},Re.key);case"observation":return y.jsx("td",{className:"px-6 py-4 whitespace-normal text-sm text-gray-600 dark:text-gray-300 overflow-hidden text-ellipsis",children:se.active?se.observation:se.inactiveObservation},Re.key);case"actions":return y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("button",{onClick:()=>V(se),className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300 transition-colors",children:y.jsx(S0,{})}),y.jsx("button",{onClick:()=>o(se.id),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300 transition-colors",children:y.jsx(Dm,{})})]})},Re.key);default:return null}})},se.id))})]})})]}),y.jsx(CG,{open:z,onClose:()=>q(!1),branches:e,licenseTypes:r,onAddBranch:l,onImport:async se=>{for(const Me of se)await n(Me);q(!1)}}),y.jsx(RG,{license:he,open:ne,onClose:Ut,onUpdate:kt,branches:e,licenseTypes:r}),W&&y.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-30",children:y.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 w-full max-w-md relative",children:[y.jsx("button",{className:"absolute top-2 right-2 text-gray-400 hover:text-gray-700",onClick:()=>k(!1),children:""}),y.jsx("h3",{className:"text-lg font-bold mb-4",children:"Configurar Colunas"}),y.jsx("div",{className:"space-y-2",children:I.map((se,Me)=>y.jsxs("div",{className:"flex items-center gap-2 cursor-move",draggable:!0,onDragStart:Re=>Re.dataTransfer.setData("colIdx",String(Me)),onDrop:Re=>{Re.preventDefault(),ie(Number(Re.dataTransfer.getData("colIdx")),Me)},onDragOver:Re=>Re.preventDefault(),children:[y.jsx("input",{type:"checkbox",checked:se.visible,onChange:()=>Ve(Me),id:`col-${se.key}`}),y.jsx("label",{htmlFor:`col-${se.key}`,children:se.label}),y.jsx("span",{className:"ml-auto text-gray-400",children:""})]},se.key))}),y.jsx("button",{onClick:ee,className:"mt-4 px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400 transition",children:"Restaurar padro"})]})})]})},v1={name:"",renewalProtocolDays:0,processStartDays:0},IG=({licenseTypes:t,onAddLicenseType:e,onUpdateLicenseType:r,onDeleteLicenseType:n})=>{const[a,o]=Xe.useState(v1),[l,u]=Xe.useState(!1),[f,d]=Xe.useState(null),[m,v]=Xe.useState({key:"name",direction:"asc"}),_=()=>{d(null),o(v1),u(!0)},E=z=>{d(z);const{id:q,...W}=z;o(W),u(!0)},S=()=>{u(!1),d(null),o(v1)},w=z=>{const{name:q,value:W}=z.target;o(k=>({...k,[q]:z.target.type==="number"?parseInt(W,10)||0:W}))},b=z=>{z.preventDefault(),f?r({...a,id:f.id}):e(a),S()},L=z=>{v(q=>q.key===z?{key:z,direction:q.direction==="asc"?"desc":"asc"}:{key:z,direction:"asc"})};function B(z,q){return(z[q]||"").toString().toLowerCase()}const F=[...t].sort((z,q)=>{const W=B(z,m.key),k=B(q,m.key);return W<k?m.direction==="asc"?-1:1:W>k?m.direction==="asc"?1:-1:0});return y.jsxs("div",{className:"space-y-6",children:[y.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg dark:bg-gray-900 dark:border dark:border-gray-700",children:[y.jsxs("div",{className:"flex justify-between items-center mb-4",children:[y.jsx("h2",{className:"text-2xl font-bold text-gray-700 dark:text-gray-200",children:f?"Editar Tipo de Licena":"Cadastro de Tipos de Licena"}),y.jsx("button",{onClick:l?S:_,className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white font-semibold rounded-lg hover:bg-blue-600 transition-transform transform hover:scale-105",children:l?"Fechar Formulrio":y.jsxs(y.Fragment,{children:[y.jsx(Im,{})," Novo Tipo de Licena"]})})]}),l&&y.jsxs("form",{onSubmit:b,className:"grid grid-cols-1 md:grid-cols-3 gap-6 animate-fade-in",children:[y.jsxs("div",{className:"flex flex-col",children:[y.jsx("label",{htmlFor:"name",className:"mb-1 font-semibold text-gray-600 dark:text-gray-300",children:"Tipo de Licena"}),y.jsx("input",{type:"text",id:"name",name:"name",value:a.name,onChange:w,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition",required:!0})]}),y.jsxs("div",{className:"flex flex-col",children:[y.jsx("label",{htmlFor:"renewalProtocolDays",className:"mb-1 font-semibold text-gray-600 dark:text-gray-300",children:"Prazo para Protocolo (dias)"}),y.jsx("input",{type:"number",id:"renewalProtocolDays",name:"renewalProtocolDays",value:a.renewalProtocolDays,onChange:w,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition",required:!0})]}),y.jsxs("div",{className:"flex flex-col",children:[y.jsx("label",{htmlFor:"processStartDays",className:"mb-1 font-semibold text-gray-600 dark:text-gray-300",children:"Prazo para Incio (dias)"}),y.jsx("input",{type:"number",id:"processStartDays",name:"processStartDays",value:a.processStartDays,onChange:w,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition",required:!0})]}),y.jsxs("div",{className:"md:col-span-3 flex justify-end gap-4",children:[y.jsx("button",{type:"button",onClick:S,className:"px-6 py-3 bg-gray-500 text-white font-bold rounded-lg hover:bg-gray-600 transition-colors",children:"Cancelar"}),y.jsx("button",{type:"submit",className:"px-6 py-3 bg-green-500 text-white font-bold rounded-lg hover:bg-green-600 transition-colors",children:f?"Salvar Alteraes":"Salvar Tipo"})]})]})]}),y.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg dark:bg-gray-900 dark:border dark:border-gray-700",children:[y.jsx("h2",{className:"text-2xl font-bold text-gray-700 dark:text-gray-200 mb-4",children:"Tipos de Licena Registrados"}),y.jsx("div",{className:"overflow-x-auto",children:y.jsxs("table",{className:"min-w-full bg-white divide-y divide-gray-200 dark:bg-gray-900 dark:divide-gray-700",children:[y.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:y.jsx("tr",{children:[{label:"Tipo de Licena",key:"name"},{label:"Prazo Protocolo (dias)",key:"renewalProtocolDays"},{label:"Prazo Incio (dias)",key:"processStartDays"},{label:"Aes",key:""}].map(z=>y.jsxs("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer select-none",onClick:z.key?()=>L(z.key):void 0,children:[z.label,z.key&&m.key===z.key&&y.jsx("span",{className:"ml-1",children:m.direction==="asc"?"":""})]},z.label))})}),y.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:F.map(z=>y.jsxs("tr",{className:"bg-white dark:bg-gray-900 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-100",children:z.name}),y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:z.renewalProtocolDays}),y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:z.processStartDays}),y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("button",{onClick:()=>E(z),className:"text-blue-600 hover:text-blue-900 transition-colors",children:y.jsx(S0,{})}),y.jsx("button",{onClick:()=>n(z.id),className:"text-red-600 hover:text-red-900 transition-colors",children:y.jsx(Dm,{})})]})})]},z.id))})]})})]})]})},_1={name:"",cnpj:"",address:"",city:"",state:"",contact:"",status:"Ativa"},DG=({branches:t,onAddBranch:e,onUpdateBranch:r,onDeleteBranch:n})=>{const[a,o]=Xe.useState(_1),[l,u]=Xe.useState(!1),[f,d]=Xe.useState(null),[m,v]=Xe.useState({key:"name",direction:"asc"}),_=()=>{d(null),o(_1),u(!0)},E=q=>{d(q);const{id:W,...k}=q;o(k),u(!0)},S=()=>{u(!1),d(null),o(_1)},w=q=>{const{name:W,value:k}=q.target;o(I=>({...I,[W]:k}))},b=q=>{if(q.preventDefault(),!a.name){alert("Por favor, preencha o nome da filial.");return}f?r({...a,id:f.id}):e(a),S()},L=q=>{v(W=>W.key===q?{key:q,direction:W.direction==="asc"?"desc":"asc"}:{key:q,direction:"asc"})};function B(q,W){return(q[W]||"").toString().toLowerCase()}const F=[...t].sort((q,W)=>{const k=B(q,m.key),I=B(W,m.key);return k<I?m.direction==="asc"?-1:1:k>I?m.direction==="asc"?1:-1:0}),z=q=>{switch(q){case"Ativa":return"bg-green-100 text-green-800";case"Vencida":return"bg-red-100 text-red-800";case"Em Renovao":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}};return y.jsxs("div",{className:"space-y-6",children:[y.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg dark:bg-gray-900 dark:border dark:border-gray-700",children:[y.jsxs("div",{className:"flex justify-between items-center mb-4",children:[y.jsx("h2",{className:"text-2xl font-bold text-gray-700 dark:text-gray-200",children:f?"Editar Filial":"Cadastro de Filiais"}),y.jsx("button",{onClick:l?S:_,className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white font-semibold rounded-lg hover:bg-blue-600 transition-transform transform hover:scale-105",children:l?"Fechar Formulrio":y.jsxs(y.Fragment,{children:[y.jsx(Im,{})," Nova Filial"]})})]}),l&&y.jsxs("form",{onSubmit:b,className:"grid grid-cols-1 md:grid-cols-2 gap-6 animate-fade-in",children:[y.jsxs("div",{className:"flex flex-col",children:[y.jsx("label",{htmlFor:"name",className:"mb-1 font-semibold text-gray-600 dark:text-gray-300",children:"Nome da Filial"}),y.jsx("input",{type:"text",id:"name",name:"name",value:a.name,onChange:w,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition",required:!0})]}),y.jsxs("div",{className:"flex flex-col",children:[y.jsx("label",{htmlFor:"cnpj",className:"mb-1 font-semibold text-gray-600 dark:text-gray-300",children:"CNPJ"}),y.jsx("input",{type:"text",id:"cnpj",name:"cnpj",value:a.cnpj,onChange:w,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition"})]}),y.jsxs("div",{className:"flex flex-col",children:[y.jsx("label",{htmlFor:"address",className:"mb-1 font-semibold text-gray-600 dark:text-gray-300",children:"Endereo"}),y.jsx("input",{type:"text",id:"address",name:"address",value:a.address,onChange:w,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition"})]}),y.jsxs("div",{className:"flex flex-col",children:[y.jsx("label",{htmlFor:"city",className:"mb-1 font-semibold text-gray-600 dark:text-gray-300",children:"Cidade"}),y.jsx("input",{type:"text",id:"city",name:"city",value:a.city,onChange:w,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition"})]}),y.jsxs("div",{className:"flex flex-col",children:[y.jsx("label",{htmlFor:"state",className:"mb-1 font-semibold text-gray-600 dark:text-gray-300",children:"Estado"}),y.jsx("input",{type:"text",id:"state",name:"state",value:a.state,onChange:w,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition"})]}),y.jsxs("div",{className:"flex flex-col",children:[y.jsx("label",{htmlFor:"contact",className:"mb-1 font-semibold text-gray-600 dark:text-gray-300",children:"Contato"}),y.jsx("input",{type:"text",id:"contact",name:"contact",value:a.contact,onChange:w,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition"})]}),y.jsxs("div",{className:"flex flex-col",children:[y.jsx("label",{htmlFor:"status",className:"mb-1 font-semibold text-gray-600 dark:text-gray-300",children:"Situao"}),y.jsxs("select",{name:"status",id:"status",value:a.status,onChange:w,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition",children:[y.jsx("option",{value:"Ativa",children:"Ativa"}),y.jsx("option",{value:"Vencida",children:"Vencida"}),y.jsx("option",{value:"Em Renovao",children:"Em Renovao"})]})]}),y.jsxs("div",{className:"md:col-span-2 flex justify-end gap-4",children:[y.jsx("button",{type:"button",onClick:S,className:"px-6 py-3 bg-gray-500 text-white font-bold rounded-lg hover:bg-gray-600 transition-colors",children:"Cancelar"}),y.jsx("button",{type:"submit",className:"px-6 py-3 bg-green-500 text-white font-bold rounded-lg hover:bg-green-600 transition-colors",children:f?"Salvar Alteraes":"Salvar Filial"})]})]})]}),y.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg dark:bg-gray-900 dark:border dark:border-gray-700",children:[y.jsx("h2",{className:"text-2xl font-bold text-gray-700 dark:text-gray-200 mb-4",children:"Filiais Registradas"}),y.jsx("div",{className:"overflow-x-auto",children:y.jsxs("table",{className:"min-w-full bg-white divide-y divide-gray-200 dark:bg-gray-900 dark:divide-gray-700",children:[y.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:y.jsx("tr",{children:[{label:"Nome",key:"name"},{label:"CNPJ",key:"cnpj"},{label:"Endereo",key:"address"},{label:"Cidade",key:"city"},{label:"Estado",key:"state"},{label:"Contato",key:"contact"},{label:"Situao",key:"status"},{label:"Aes",key:""}].map(q=>y.jsxs("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer select-none",onClick:q.key?()=>L(q.key):void 0,children:[q.label,q.key&&m.key===q.key&&y.jsx("span",{className:"ml-1",children:m.direction==="asc"?"":""})]},q.label))})}),y.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:F.map(q=>y.jsxs("tr",{className:"bg-white dark:bg-gray-900 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-100",children:q.name}),y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:q.cnpj}),y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:q.address}),y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:q.city}),y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:q.state}),y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:q.contact}),y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:y.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${z(q.status)}`,children:q.status})}),y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("button",{onClick:()=>E(q),className:"text-blue-600 hover:text-blue-900 transition-colors",children:y.jsx(S0,{})}),y.jsx("button",{onClick:()=>n(q.id),className:"text-red-600 hover:text-red-900 transition-colors",children:y.jsx(Dm,{})})]})})]},q.id))})]})})]})]})},OG=({licenses:t,branches:e,licenseTypes:r,onUpdateLicense:n})=>{const[a,o]=Xe.useState(null),[l,u]=Xe.useState(null),[f,d]=Xe.useState({key:"originalExpiryDate",direction:"asc"}),[m,v]=Xe.useState(!1),[_,E]=Xe.useState({branchId:"",licenseType:""}),S=A=>{var O;return((O=e.find(M=>M.id===A))==null?void 0:O.name)||"Desconhecida"},w=A=>{o(A),u(A)},b=()=>{o(null),u(null)},L=A=>{const{name:O,value:M,type:N,checked:D}=A.target;u(he=>he?{...he,[O]:N==="checkbox"?D:M}:null)},B=A=>{A.preventDefault(),l&&(n(l),b())},F=A=>{d(O=>O.key===A?{key:A,direction:O.direction==="asc"?"desc":"asc"}:{key:A,direction:"asc"})};function z(A,O){return["issueDate","originalExpiryDate","prorrogaDate","processStartDate"].includes(O)?A[O]?new Date(A[O]):new Date(0):(A[O]||"").toString().toLowerCase()}const q=[...e].sort((A,O)=>A.name.localeCompare(O.name)),W=[...r].sort((A,O)=>A.name.localeCompare(O.name)),I=[...t.filter(A=>(!_.branchId||A.unitId===_.branchId)&&(!_.licenseType||A.licenseType===_.licenseType))].sort((A,O)=>{const M=z(A,f.key),N=z(O,f.key);return M<N?f.direction==="asc"?-1:1:M>N?f.direction==="asc"?1:-1:0});return y.jsxs("div",{className:"space-y-6",children:[y.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg dark:bg-gray-900 dark:border dark:border-gray-700",children:[y.jsxs("h2",{className:"text-2xl font-bold text-gray-700 dark:text-white mb-4 flex items-center gap-2",children:["Licenas Desativadas",y.jsx("button",{type:"button",onClick:()=>v(A=>!A),className:"ml-2 p-2 rounded hover:bg-gray-100 transition",children:y.jsx(rk,{})})]}),m&&y.jsxs("div",{className:"mb-4 bg-gray-50 border border-gray-200 rounded-lg p-4 flex flex-col md:flex-row gap-4 items-center",children:[y.jsxs("div",{className:"flex flex-col",children:[y.jsx("label",{className:"text-xs font-semibold text-gray-600 dark:text-gray-300 mb-1",children:"Filtrar por Filial"}),y.jsxs("select",{value:_.branchId,onChange:A=>E(O=>({...O,branchId:A.target.value})),className:"p-2 border border-gray-300 rounded",children:[y.jsx("option",{value:"",children:"Todas"}),q.map(A=>y.jsx("option",{value:A.id,children:A.name},A.id))]})]}),y.jsxs("div",{className:"flex flex-col",children:[y.jsx("label",{className:"text-xs font-semibold text-gray-600 dark:text-gray-300 mb-1",children:"Filtrar por Tipo de Licena"}),y.jsxs("select",{value:_.licenseType,onChange:A=>E(O=>({...O,licenseType:A.target.value})),className:"p-2 border border-gray-300 rounded",children:[y.jsx("option",{value:"",children:"Todas"}),W.map(A=>y.jsx("option",{value:A.name,children:A.name},A.id))]})]}),y.jsx("button",{onClick:()=>E({branchId:"",licenseType:""}),className:"mt-4 md:mt-6 px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400 transition",children:"Limpar Filtros"})]}),y.jsx("div",{className:"overflow-x-auto",children:y.jsxs("table",{className:"min-w-full bg-white divide-y divide-gray-200 dark:bg-gray-900 dark:divide-gray-700",children:[y.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:y.jsx("tr",{children:[{label:"Unidade",key:"unitId"},{label:"Licena",key:"licenseType"},{label:"N/Ano",key:"numberYear"},{label:"Descrio",key:"description"},{label:"rgo Licenciador",key:"licensingAgency"},{label:"FCEI-N do Processo",key:"processNumber"},{label:"Data Emisso",key:"issueDate"},{label:"Data Vencimento",key:"originalExpiryDate"},{label:"Prazo Prorrogao",key:"prorrogaDate"},{label:"Incio Processo",key:"processStartDate"},{label:"Observao da Desativao",key:"inactiveObservation"},{label:"Aes",key:""}].map(A=>y.jsxs("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer select-none",onClick:A.key?()=>F(A.key):void 0,children:[A.label,A.key&&f.key===A.key&&y.jsx("span",{className:"ml-1",children:f.direction==="asc"?"":""})]},A.label))})}),y.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:I.map(A=>y.jsxs("tr",{className:"bg-white dark:bg-gray-900 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-100",children:S(A.unitId)}),y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:A.licenseType}),y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:A.numberYear}),y.jsx("td",{className:"px-6 py-4 whitespace-normal text-sm text-gray-600 dark:text-gray-300 max-w-xs",children:A.description}),y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:A.licensingAgency}),y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:A.processNumber}),y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:A.issueDate?new Date(A.issueDate+"T00:00:00").toLocaleDateString("pt-BR"):""}),y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:A.originalExpiryDate?new Date(A.originalExpiryDate+"T00:00:00").toLocaleDateString("pt-BR"):""}),y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:A.prorrogaDate?new Date(A.prorrogaDate+"T00:00:00").toLocaleDateString("pt-BR"):""}),y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:A.processStartDate?new Date(A.processStartDate+"T00:00:00").toLocaleDateString("pt-BR"):""}),y.jsx("td",{className:"px-6 py-4 whitespace-normal text-sm text-red-600 max-w-xs",children:A.inactiveObservation}),y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:y.jsx("button",{onClick:()=>w(A),className:"text-blue-600 hover:text-blue-900 transition-colors",children:y.jsx(S0,{})})})]},A.id))})]})})]}),a&&l&&y.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg dark:bg-gray-900 dark:border dark:border-gray-700 mt-6",children:[y.jsx("h3",{className:"text-xl font-bold text-gray-700 mb-4",children:"Editar Licena Desativada"}),y.jsxs("form",{onSubmit:B,className:"grid grid-cols-1 md:grid-cols-2 gap-6 animate-fade-in",children:[y.jsxs("div",{className:"flex flex-col",children:[y.jsx("label",{htmlFor:"inactiveObservation",className:"mb-1 font-semibold text-gray-600 dark:text-gray-300",children:"Observao da Desativao"}),y.jsx("textarea",{name:"inactiveObservation",id:"inactiveObservation",value:l.inactiveObservation||"",onChange:L,rows:2,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition",required:!0})]}),y.jsxs("div",{className:"flex items-center md:col-span-2",children:[y.jsx("input",{type:"checkbox",id:"active",name:"active",checked:l.active,onChange:L,className:"mr-2"}),y.jsx("label",{htmlFor:"active",className:"font-semibold text-gray-600 dark:text-gray-300",children:"Reativar Licena"})]}),y.jsxs("div",{className:"md:col-span-2 flex justify-end gap-4",children:[y.jsx("button",{type:"button",onClick:b,className:"px-6 py-3 bg-gray-500 text-white font-bold rounded-lg hover:bg-gray-600 transition-colors",children:"Cancelar"}),y.jsx("button",{type:"submit",className:"px-6 py-3 bg-green-500 text-white font-bold rounded-lg hover:bg-green-600 transition-colors",children:"Salvar Alteraes"})]})]})]})]})},FG="/licencas/assets/meioambiental-Cjp3hbnE.jpeg",PG=({onLogin:t})=>{const[e,r]=Xe.useState(""),[n,a]=Xe.useState(""),[o,l]=Xe.useState(""),[u,f]=Xe.useState(!1),d=async m=>{m.preventDefault(),f(!0),l("");try{await YO(wf,e,n),t()}catch{l("Usurio ou senha invlidos, ou usurio no autorizado.")}finally{f(!1)}};return y.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-cover bg-center bg-no-repeat relative",style:{backgroundImage:`url(${FG})`},children:[y.jsx("div",{className:"absolute inset-0 bg-black/50"}),y.jsxs("form",{onSubmit:d,className:"relative z-10 bg-white/95 backdrop-blur-sm p-8 rounded-xl shadow-2xl w-full max-w-sm space-y-6",children:[y.jsx("h2",{className:"text-2xl font-bold text-center text-gray-700",children:"Login"}),y.jsxs("div",{className:"flex flex-col gap-2",children:[y.jsx("label",{htmlFor:"email",className:"font-semibold text-gray-600",children:"E-mail"}),y.jsx("input",{id:"email",type:"email",value:e,onChange:m=>r(m.target.value),className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition",required:!0,autoFocus:!0})]}),y.jsxs("div",{className:"flex flex-col gap-2",children:[y.jsx("label",{htmlFor:"password",className:"font-semibold text-gray-600",children:"Senha"}),y.jsx("input",{id:"password",type:"password",value:n,onChange:m=>a(m.target.value),className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition",required:!0})]}),o&&y.jsx("div",{className:"text-red-600 text-sm text-center",children:o}),y.jsx("button",{type:"submit",className:"w-full py-3 bg-blue-500 text-white font-bold rounded-lg hover:bg-blue-600 transition-colors",disabled:u,children:u?"Entrando...":"Entrar"})]})]})},cx=({className:t="h-6 w-6"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),ux=({className:t="h-6 w-6"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),mC=({className:t="h-6 w-6"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),LG=({licenses:t,branches:e,licenseTypes:r})=>{const n=t.filter(w=>w.active);t.filter(w=>!w.active);const a=new Date;a.setHours(0,0,0,0);const o=w=>{const L=new Date(w+"T00:00:00").getTime()-a.getTime();return Math.ceil(L/(1e3*60*60*24))},l=n.map(w=>{const b=o(w.originalExpiryDate),L=r.find(z=>z.name===w.licenseType),B=L?(L.renewalProtocolDays||0)+(L.processStartDays||0):180;let F="ok";return b<0?F="expired":b<=B&&(F="warning"),{...w,days:b,status:F}}),u=n.length,f=l.filter(w=>w.status==="expired").length,d=l.filter(w=>w.status==="warning").length,m=e.length,v=l.sort((w,b)=>w.days-b.days).slice(0,10),_=r.map(w=>{const b=n.filter(L=>L.licenseType===w.name).length;return{...w,count:b}}).filter(w=>w.count>0).sort((w,b)=>b.count-w.count),E=e.map(w=>{const b=n.filter(L=>L.unitId===w.id).length;return{...w,count:b}}).filter(w=>w.count>0).sort((w,b)=>b.count-w.count),S=({title:w,value:b,icon:L,color:B,bgColor:F})=>y.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 flex items-center justify-between border border-gray-100 dark:border-gray-700",children:[y.jsxs("div",{children:[y.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:w}),y.jsx("p",{className:"text-3xl font-bold text-gray-800 dark:text-white mt-2",children:b})]}),y.jsx("div",{className:`p-3 rounded-full ${F} ${B}`,children:L})]});return y.jsxs("div",{className:"space-y-6 animate-fade-in",children:[y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[y.jsx(S,{title:"Licenas Ativas",value:u,icon:y.jsx(cx,{className:"h-8 w-8"}),color:"text-blue-700",bgColor:"bg-blue-100 dark:bg-blue-900/20"}),y.jsx(S,{title:"Em Alerta",value:d,icon:y.jsx(ux,{className:"h-8 w-8"}),color:"text-yellow-700",bgColor:"bg-yellow-100 dark:bg-yellow-900/20"}),y.jsx(S,{title:"Vencidas (Ativas)",value:f,icon:y.jsx(ux,{className:"h-8 w-8"}),color:"text-red-700",bgColor:"bg-red-100 dark:bg-red-900/20"}),y.jsx(S,{title:"Filiais",value:m,icon:y.jsx(mC,{className:"h-8 w-8"}),color:"text-green-700",bgColor:"bg-green-100 dark:bg-green-900/20"})]}),y.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[y.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 p-6",children:[y.jsx("h3",{className:"text-lg font-bold text-gray-800 dark:text-white mb-4",children:"Prximos Vencimentos"}),y.jsx("div",{className:"overflow-x-auto",style:{transform:"rotateX(180deg)"},children:y.jsxs("table",{className:"min-w-full",style:{transform:"rotateX(180deg)"},children:[y.jsx("thead",{children:y.jsxs("tr",{className:"text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-b border-gray-200 dark:border-gray-700",children:[y.jsx("th",{className:"pb-3",children:"Filial"}),y.jsx("th",{className:"pb-3",children:"Licena"}),y.jsx("th",{className:"pb-3",children:"Vencimento"}),y.jsx("th",{className:"pb-3",children:"Status"})]})}),y.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:v.length>0?v.map(w=>{var b;return y.jsxs("tr",{children:[y.jsx("td",{className:"py-3 text-sm text-gray-700 dark:text-gray-300",children:(b=e.find(L=>L.id===w.unitId))==null?void 0:b.name}),y.jsx("td",{className:"py-3 text-sm text-gray-700 dark:text-gray-300",children:w.licenseType}),y.jsx("td",{className:"py-3 text-sm text-gray-700 dark:text-gray-300",children:new Date(w.originalExpiryDate+"T00:00:00").toLocaleDateString("pt-BR")}),y.jsx("td",{className:"py-3",children:y.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${w.status==="expired"?"bg-red-100 text-red-800 dark:bg-red-900/90 dark:text-red-200":w.status==="warning"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/90 dark:text-yellow-200":"bg-green-100 text-green-800 dark:bg-green-900/90 dark:text-green-200"}`,children:w.status==="expired"?"Vencida":`${w.days} dias`})})]},w.id)}):y.jsx("tr",{children:y.jsx("td",{colSpan:4,className:"py-4 text-center text-gray-500 text-sm",children:"Nenhuma licena prxima do vencimento."})})})]})})]}),y.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 p-6",children:[y.jsx("h3",{className:"text-lg font-bold text-gray-800 dark:text-white mb-4",children:"Distribuies"}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[y.jsxs("div",{children:[y.jsx("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3",children:"Por Tipo"}),y.jsx("div",{className:"space-y-4 max-h-[620px] overflow-y-auto pr-2",children:_.map(w=>{const b=Math.round(w.count/u*100)||0;return y.jsxs("div",{children:[y.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[y.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:w.name}),y.jsxs("span",{className:"text-gray-500 dark:text-gray-400",children:[w.count," (",b,"%)"]})]}),y.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-400 rounded-full h-2",children:y.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${b}%`}})})]},w.id)})})]}),y.jsxs("div",{children:[y.jsx("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3",children:"Por Filial"}),y.jsx("div",{className:"space-y-4 max-h-[620px] overflow-y-auto pr-2",children:E.map(w=>{const b=Math.round(w.count/u*100)||0;return y.jsxs("div",{children:[y.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[y.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:w.name}),y.jsxs("span",{className:"text-gray-500 dark:text-gray-400",children:[w.count," (",b,"%)"]})]}),y.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-400 rounded-full h-2",children:y.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${b}%`}})})]},w.id)})})]})]})]})]})]})},y1=[{id:"dashboard",label:"Dashboard"},{id:"licenses",label:"Licenas Vigentes"},{id:"sgaLicenses",label:"Licenas SGA"},{id:"deactivatedLicenses",label:"Licenas Vencidas"},{id:"licenseTypes",label:"Tipos de Licena"},{id:"branches",label:"Filiais"},{id:"users",label:"Usurios"}],MG=({branches:t=[],licenseTypes:e=[]})=>{const[r,n]=Xe.useState([]),[a,o]=Xe.useState(!0),[l,u]=Xe.useState(!1),[f,d]=Xe.useState(null),[m,v]=Xe.useState({allowedScreens:[],visibleBranchIds:[],visibleLicenseTypes:[],name:"",email:"",password:"",role:"colaborador"}),[_,E]=Xe.useState(""),S=D=>{v(he=>{const we=new Set(he.allowedScreens);return we.has(D)?we.delete(D):we.add(D),{...he,allowedScreens:Array.from(we)}})},w=D=>{v(he=>{const we=new Set(he.visibleBranchIds);return we.has(D)?we.delete(D):we.add(D),{...he,visibleBranchIds:Array.from(we)}})},b=()=>{v(D=>{if(!t||t.length===0)return D;const he=t.map(ne=>ne.id),we=D.visibleBranchIds.length===he.length;return{...D,visibleBranchIds:we?[]:he}})},L=D=>{v(he=>{const we=new Set(he.visibleLicenseTypes);return we.has(D)?we.delete(D):we.add(D),{...he,visibleLicenseTypes:Array.from(we)}})},B=()=>{v(D=>{if(!e||e.length===0)return D;const he=e.map(ne=>ne.name),we=D.visibleLicenseTypes.length===he.length;return{...D,visibleLicenseTypes:we?[]:he}})},[F,z]=Xe.useState(""),q=ou(Xn,"users"),W=async()=>{o(!0);try{const he=(await ll(q)).docs.map(we=>({...we.data(),id:we.id}));n(he)}catch(D){console.error("Error fetching users:",D)}finally{o(!1)}};Xe.useEffect(()=>{W()},[]);const k=D=>{const{name:he,value:we}=D.target;v(ne=>{let ue={...ne,[he]:we};if(he==="role"&&we==="admin"){const Ve=y1.map(ie=>ie.id);ue={...ue,allowedScreens:Ve,visibleBranchIds:t.map(ie=>ie.id),visibleLicenseTypes:e.map(ie=>ie.name)}}return ue})},I=()=>{v({name:"",email:"",password:"",role:"colaborador",allowedScreens:[],visibleBranchIds:[],visibleLicenseTypes:[]}),d(null),E(""),z(""),u(!1)},A=async D=>{if(D.preventDefault(),E(""),z(""),m.role==="admin"&&(m.allowedScreens=y1.map(he=>he.id),m.visibleBranchIds=t.map(he=>he.id),m.visibleLicenseTypes=e.map(he=>he.name)),f)try{const he=ki(Xn,"users",f.id);await Nf(he,{allowedScreens:m.allowedScreens||[],visibleBranchIds:m.visibleBranchIds||[],visibleLicenseTypes:m.visibleLicenseTypes||[],name:m.name,role:m.role}),z("Usurio atualizado com sucesso!"),W(),setTimeout(I,1500)}catch(he){E("Erro ao atualizar usurio: "+he.message)}else{if(!m.password||m.password.length<6){E("A senha deve ter pelo menos 6 caracteres.");return}try{const he=gx(tk,"Secondary"),we=MA(he),ue=(await KO(we,m.email,m.password)).user.uid;await K1(we),await wN(he),await yf(q,{uid:ue,name:m.name,email:m.email,role:m.role,allowedScreens:m.allowedScreens||[],visibleBranchIds:m.visibleBranchIds||[],visibleLicenseTypes:m.visibleLicenseTypes||[],active:!0,createdAt:new Date().toISOString()}),z("Usurio criado com sucesso!"),W(),setTimeout(I,1500)}catch(he){console.error(he),he.code==="auth/email-already-in-use"?E("Este e-mail j est em uso."):E("Erro ao criar usurio: "+he.message)}}},O=D=>{d(D),v({name:D.name,email:D.email,password:"",role:D.role,allowedScreens:D.allowedScreens||[],visibleBranchIds:D.visibleBranchIds||[],visibleLicenseTypes:D.visibleLicenseTypes||[]}),u(!0)},M=async D=>{if(window.confirm("Tem certeza que deseja excluir este usurio? O acesso dele ser revogado."))try{await Td(ki(Xn,"users",D)),W()}catch(he){alert("Erro ao excluir usurio: "+he.message)}},N=async D=>{try{const he=ki(Xn,"users",D.id);await Nf(he,{active:!D.active}),W()}catch(he){alert("Erro ao alterar status: "+he.message)}};return y.jsxs("div",{className:"space-y-6 animate-fade-in",children:[y.jsxs("div",{className:"flex justify-between items-center",children:[y.jsx("h2",{className:"text-xl font-semibold text-gray-800 dark:text-white",children:"Gerenciamento de Usurios"}),y.jsxs("button",{onClick:()=>{I(),u(!0)},className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-sm",children:[y.jsx(Im,{className:"h-5 w-5 mr-2"}),"Novo Usurio"]})]}),y.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden",children:y.jsx("div",{className:"overflow-x-auto",children:y.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[y.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700/90",children:y.jsxs("tr",{children:[y.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Nome"}),y.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Email"}),y.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Funo"}),y.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Status"}),y.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Aes"})]})}),y.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:a?y.jsx("tr",{children:y.jsx("td",{colSpan:5,className:"px-6 py-4 text-center text-black dark:text-gray-400",children:"Carregando..."})}):r.length===0?y.jsx("tr",{children:y.jsx("td",{colSpan:5,className:"px-6 py-4 text-center text-black dark:text-gray-400",children:"Nenhum usurio encontrado."})}):r.map(D=>y.jsxs("tr",{className:"bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700/90 transition-colors",children:[y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:D.name}),y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-black dark:text-gray-300",children:D.email}),y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-black dark:text-gray-300",children:y.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${D.role==="admin"?"bg-purple-100 text-purple-800 dark:bg-purple-900/90 dark:text-purple-200":"bg-blue-100 text-blue-800 dark:bg-blue-900/90 dark:text-blue-200"}`,children:D.role==="admin"?"Administrador":"Colaborador"})}),y.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:y.jsx("button",{onClick:()=>N(D),className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full cursor-pointer ${D.active?"bg-green-100 text-green-800 dark:bg-green-900/90 dark:text-green-200":"bg-red-100 text-red-800 dark:bg-red-900/90 dark:text-red-200"}`,children:D.active?"Ativo":"Inativo"})}),y.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[y.jsx("button",{onClick:()=>O(D),className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300 mr-3",children:y.jsx(S0,{className:"h-5 w-5"})}),y.jsx("button",{onClick:()=>M(D.id),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300",children:y.jsx(Dm,{className:"h-5 w-5"})})]})]},D.id))})]})})}),l&&y.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:y.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-xl max-w-md w-full p-6 animate-fade-in",children:[y.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4",children:f?"Editar Usurio":"Novo Usurio"}),_&&y.jsx("div",{className:"mb-4 p-3 bg-red-100 text-red-700 rounded-lg text-sm",children:_}),F&&y.jsx("div",{className:"mb-4 p-3 bg-green-100 text-green-700 rounded-lg text-sm",children:F}),y.jsxs("form",{onSubmit:A,className:"space-y-4",children:[y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Nome"}),y.jsx("input",{type:"text",name:"name",value:m.name,onChange:k,className:"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 outline-none",required:!0})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Email"}),y.jsx("input",{type:"email",name:"email",value:m.email,onChange:k,className:"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 outline-none disabled:opacity-50",required:!0,disabled:!!f})]}),!f&&y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Senha"}),y.jsx("input",{type:"password",name:"password",value:m.password,onChange:k,className:"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 outline-none",required:!f,minLength:6})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Funo"}),y.jsxs("select",{name:"role",value:m.role,onChange:k,className:"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 outline-none",children:[y.jsx("option",{value:"colaborador",children:"Colaborador"}),y.jsx("option",{value:"admin",children:"Administrador"})]})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Permisses (telas)"}),y.jsx("div",{className:"grid grid-cols-2 gap-2",children:y1.map(D=>y.jsxs("label",{className:"inline-flex items-center gap-2",children:[y.jsx("input",{type:"checkbox",checked:m.allowedScreens.includes(D.id),onChange:()=>S(D.id),disabled:m.role==="admin"}),y.jsx("span",{className:"text-sm",children:D.label})]},D.id))})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Acesso por Filial"}),y.jsx("div",{className:"flex items-center gap-2 mb-2",children:y.jsxs("label",{className:"inline-flex items-center gap-2",children:[y.jsx("input",{type:"checkbox",checked:t.length>0&&m.visibleBranchIds.length===t.length,onChange:b}),y.jsx("span",{className:"text-sm font-medium",children:"Selecionar todos"})]})}),y.jsx("div",{className:"grid grid-cols-1 max-h-32 overflow-y-auto gap-2 p-1 border rounded",children:t.map(D=>y.jsxs("label",{className:"inline-flex items-center gap-2",children:[y.jsx("input",{type:"checkbox",checked:m.visibleBranchIds.includes(D.id),onChange:()=>w(D.id),disabled:m.role==="admin"}),y.jsx("span",{className:"text-sm",children:D.name})]},D.id))})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Acesso por Tipo de Licena"}),y.jsx("div",{className:"flex items-center gap-2 mb-2",children:y.jsxs("label",{className:"inline-flex items-center gap-2",children:[y.jsx("input",{type:"checkbox",checked:e.length>0&&m.visibleLicenseTypes.length===e.length,onChange:B}),y.jsx("span",{className:"text-sm font-medium",children:"Selecionar todos"})]})}),y.jsx("div",{className:"grid grid-cols-1 max-h-32 overflow-y-auto gap-2 p-1 border rounded",children:e.map(D=>y.jsxs("label",{className:"inline-flex items-center gap-2",children:[y.jsx("input",{type:"checkbox",checked:m.visibleLicenseTypes.includes(D.name),onChange:()=>L(D.name),disabled:m.role==="admin"}),y.jsx("span",{className:"text-sm",children:D.name})]},D.id))})]}),y.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[y.jsx("button",{type:"button",onClick:I,className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:"Cancelar"}),y.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:f?"Salvar Alteraes":"Criar Usurio"})]})]})]})})]})},UG=({className:t="h-6 w-6"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})}),BG=({className:t="h-6 w-6"})=>y.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"}),y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 5a2 2 0 012-2h4a2 2 0 012 2v6H8V5z"})]}),VG=({className:t="h-6 w-6"})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),jG="/licencas/assets/ambiental-C3pQG8id.svg",HG=ou(Xn,"units"),hb=ou(Xn,"licenses"),db=ou(Xn,"licenseTypes"),mb=ou(Xn,"branches"),zG=()=>{var De,ke,Fe;const[t,e]=Xe.useState("dashboard"),[r,n]=Xe.useState([]),[a,o]=Xe.useState([]),[l,u]=Xe.useState([]),[f,d]=Xe.useState([]),[m,v]=Xe.useState(!0),[_,E]=Xe.useState(null),[S,w]=Xe.useState(null),[b,L]=Xe.useState(null),[B,F]=Xe.useState(!0),[z,q]=Xe.useState(!0),[W,k]=Xe.useState(()=>typeof window<"u"&&localStorage.getItem("theme")||"light");Xe.useEffect(()=>{typeof window>"u"||(W==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),localStorage.setItem("theme",W))},[W]);const I=()=>{k(ye=>ye==="light"?"dark":"light")},A=Xe.useCallback(async()=>{const Be=(await ll(HG)).docs.map(X=>({...X.data(),id:X.id}));n(Be)},[]),O=Xe.useCallback(async()=>{const Be=(await ll(hb)).docs.map(X=>{const rt=X.data();let nt=rt.attachments||[];return(rt.fileUrl||rt.fileName)&&nt.length===0&&rt.fileUrl&&(nt=[{id:Date.now().toString(),fileName:rt.fileName||"Arquivo",fileUrl:rt.fileUrl,uploadedAt:new Date().toISOString()}]),{...rt,id:X.id,attachments:nt}});o(Be)},[]),M=Xe.useCallback(async()=>{const Be=(await ll(db)).docs.map(X=>({...X.data(),id:X.id}));u(Be)},[]),N=Xe.useCallback(async()=>{const Be=(await ll(mb)).docs.map(X=>({...X.data(),id:X.id}));d(Be)},[]);if(Xe.useEffect(()=>{(async()=>{v(!0);try{await Promise.all([A(),O(),M(),N()])}catch(Be){console.error("Failed to fetch data from Firebase:",Be)}finally{v(!1)}})()},[A,O,M,N]),Xe.useEffect(()=>{const ye=ZO(wf,Be=>{E(Be),F(!1)});return()=>ye()},[]),Xe.useEffect(()=>{(async()=>{var Be,X;if(_){const rt=ou(Xn,"users"),nt=q6(rt,W6("uid","==",_.uid)),wt=await ll(nt);if(wt.empty)if((await ll(rt)).empty){const Ue=await yf(rt,{uid:_.uid,name:_.displayName||((Be=_.email)==null?void 0:Be.split("@")[0])||"Admin",email:_.email,role:"admin",active:!0,allowedScreens:["dashboard","licenses","sgaLicenses","deactivatedLicenses","licenseTypes","branches","users"],visibleBranchIds:[],visibleLicenseTypes:[],createdAt:new Date().toISOString()});w("admin"),L({id:Ue.id,uid:_.uid,name:_.displayName||((X=_.email)==null?void 0:X.split("@")[0])||"Admin",email:_.email,role:"admin",active:!0,allowedScreens:["dashboard","licenses","sgaLicenses","deactivatedLicenses","licenseTypes","branches","users"]})}else w("colaborador"),L({id:"",uid:_.uid,name:_.displayName||"",email:_.email||"",role:"colaborador",active:!0,allowedScreens:["dashboard"]});else{const ut=wt.docs[0].data();L({id:wt.docs[0].id,...ut}),w(ut.role)}}else w(null)})()},[_]),B)return y.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:y.jsxs("div",{className:"text-center",children:[y.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-blue-600 mx-auto"}),y.jsx("p",{className:"mt-4 text-xl font-semibold text-gray-700",children:"Verificando autenticao..."})]})});if(!_)return y.jsx(PG,{onLogin:()=>E(wf.currentUser)});const D=async ye=>{const Be={...ye,attachments:ye.attachments||[]};await yf(hb,Be),await O()},he=async ye=>{const{id:Be,...X}=ye,rt={...X,attachments:X.attachments||[]},nt=ki(Xn,"licenses",Be);await Nf(nt,rt),await O()},we=async ye=>{const Be=ki(Xn,"licenses",ye);await Td(Be),await O()},ne=async ye=>{const Be={...ye,renewalProtocolDays:Number(ye.renewalProtocolDays)||0,processStartDays:Number(ye.processStartDays)||0};await yf(db,Be),await M()},ue=async ye=>{const{id:Be,...X}=ye,rt={...X,renewalProtocolDays:Number(X.renewalProtocolDays)||0,processStartDays:Number(X.processStartDays)||0},nt=ki(Xn,"licenseTypes",Be);await Nf(nt,rt),await M()},Ve=async ye=>{const Be=ki(Xn,"licenseTypes",ye);await Td(Be),await M()},ie=async ye=>{const Be=await yf(mb,ye);return await N(),Be.id},ee=async ye=>{const{id:Be,...X}=ye,rt=ki(Xn,"branches",Be);await Nf(rt,{...X}),await N()},ge=async ye=>{const Be=ki(Xn,"branches",ye);await Td(Be),await N()},V=({icon:ye,label:Be,active:X,onClick:rt})=>y.jsxs("li",{onClick:rt,className:"flex items-center cursor-pointer p-3 rounded-lg transition-colors duration-200 mb-1 hover:bg-slate-700",style:X?{backgroundColor:"#3b82f6",color:"#ffffff"}:{color:"#94a3b8"},children:[y.jsx("div",{className:"mr-3",style:X?{color:"#ffffff"}:{color:"#94a3b8"},children:ye}),y.jsx("span",{className:"whitespace-nowrap",children:Be})]}),K=ye=>{var Be;return S==="admin"?!0:!!((Be=b==null?void 0:b.allowedScreens)!=null&&Be.includes(ye))};if(m)return y.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:y.jsxs("div",{className:"text-center",children:[y.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-blue-600 mx-auto"}),y.jsx("p",{className:"mt-4 text-xl font-semibold text-gray-700",children:"Carregando dados..."})]})});const Y=S==="admin"||!b?a:a.filter(ye=>{const Be=!(b!=null&&b.visibleBranchIds)||b.visibleBranchIds.length===0||b.visibleBranchIds.includes(ye.unitId),X=!(b!=null&&b.visibleLicenseTypes)||b.visibleLicenseTypes.length===0||b.visibleLicenseTypes.includes(ye.licenseType);return Be&&X}),te=S==="admin"||!b?f:f.filter(ye=>!(b!=null&&b.visibleBranchIds)||b.visibleBranchIds.length===0||b.visibleBranchIds.includes(ye.id)),ce=S==="admin"||!b?l:l.filter(ye=>!(b!=null&&b.visibleLicenseTypes)||b.visibleLicenseTypes.length===0||b.visibleLicenseTypes.includes(ye.name));return y.jsxs("div",{className:`flex min-h-screen bg-gray-100 text-gray-800 ${W==="dark"?"dark bg-gray-900 text-gray-100":""}`,children:[y.jsx("button",{onClick:()=>q(!z),className:"fixed top-1/2 -translate-y-1/2 p-1.5 rounded-full bg-slate-600 hover:bg-slate-500 transition-all duration-300 text-white shadow-lg z-30",style:{left:z?"240px":"8px"},"aria-label":z?"Recolher sidebar":"Expandir sidebar",children:y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 12h16M4 18h16"})})}),y.jsx("aside",{className:`${z?"w-64":"w-0"} flex flex-col sticky top-0 h-screen shrink-0 z-20 transition-all duration-300 overflow-hidden`,style:{backgroundColor:"#1e293b"},children:y.jsxs("div",{className:`${z?"opacity-100":"opacity-0"} flex flex-col h-full transition-opacity duration-200`,children:[y.jsx("div",{className:"h-32 flex items-center justify-center shrink-0 p-4 border-b border-slate-700/50",children:y.jsx("img",{src:jG,alt:"Logo Ambiental",className:"max-h-full max-w-full object-contain"})}),y.jsx("nav",{className:"flex-1 py-4 overflow-hidden",children:y.jsxs("ul",{className:"px-3 space-y-1",children:[K("dashboard")&&y.jsx(V,{icon:y.jsx(BG,{}),label:"Dashboard",active:t==="dashboard",onClick:()=>e("dashboard")}),K("licenses")&&y.jsx(V,{icon:y.jsx(cx,{}),label:"Licenas Vigentes",active:t==="licenses",onClick:()=>e("licenses")}),K("sgaLicenses")&&y.jsx(V,{icon:y.jsx(cx,{}),label:"Licenas SGA",active:t==="sgaLicenses",onClick:()=>e("sgaLicenses")}),K("deactivatedLicenses")&&y.jsx(V,{icon:y.jsx(ux,{}),label:"Licenas Vencidas",active:t==="deactivatedLicenses",onClick:()=>e("deactivatedLicenses")}),K("licenseTypes")&&y.jsx(V,{icon:y.jsx(UG,{}),label:"Tipos de Licena",active:t==="licenseTypes",onClick:()=>e("licenseTypes")}),K("branches")&&y.jsx(V,{icon:y.jsx(mC,{}),label:"Filiais",active:t==="branches",onClick:()=>e("branches")}),K("users")&&y.jsx(V,{icon:y.jsx(VG,{}),label:"Usurios",active:t==="users",onClick:()=>e("users")})]})}),y.jsx("div",{className:"p-4 shrink-0",children:y.jsxs("div",{className:"flex items-center p-2 rounded-lg cursor-pointer transition-colors hover:bg-slate-700",onClick:()=>K1(wf),title:"Clique para sair",children:[y.jsx("div",{className:"h-10 w-10 rounded-full bg-blue-500 flex items-center justify-center text-white font-bold text-lg shrink-0",children:((De=b==null?void 0:b.name)==null?void 0:De.charAt(0).toUpperCase())||((ke=_==null?void 0:_.email)==null?void 0:ke.charAt(0).toUpperCase())}),y.jsxs("div",{className:"ml-3 overflow-hidden",children:[y.jsx("p",{className:"text-white font-medium text-sm truncate",children:(b==null?void 0:b.name)||((Fe=_==null?void 0:_.email)==null?void 0:Fe.split("@")[0])}),y.jsx("p",{className:"text-slate-400 text-xs truncate",children:_==null?void 0:_.email})]})]})})]})}),y.jsxs("div",{className:"flex-1 flex flex-col min-h-screen min-w-0",children:[y.jsxs("header",{className:"h-14 flex items-center justify-between px-6 sticky top-0 z-10",style:{backgroundColor:"#1e293b"},children:[y.jsx("div",{className:"flex items-center gap-4 min-w-[200px]"}),y.jsx("h1",{className:"text-lg font-semibold text-white",children:"Gesto de Licenas Ambientais"}),y.jsxs("div",{className:"flex items-center gap-2 min-w-[200px] justify-end",children:[y.jsx("button",{onClick:I,className:"p-2 rounded-lg hover:bg-slate-700 transition-colors text-white","aria-label":"Alternar tema",children:W==="dark"?y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}):y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})})}),y.jsx("button",{onClick:()=>K1(wf),className:"px-4 py-1.5 bg-red-500 hover:bg-red-600 text-white text-sm font-medium rounded-lg transition-colors",children:"Sair"})]})]}),y.jsx("main",{className:"flex-1 p-6 lg:p-8 overflow-x-hidden",children:y.jsxs("div",{className:"w-full",children:[t==="dashboard"&&y.jsx(LG,{licenses:Y,branches:f,licenseTypes:l}),t==="licenses"&&y.jsx(fb,{licenses:Y,branches:te,licenseTypes:ce,onAddLicense:D,onUpdateLicense:he,onDeleteLicense:we,onAddBranch:ie,category:"Ambiental"}),t==="sgaLicenses"&&y.jsx(fb,{licenses:Y,branches:te,licenseTypes:ce,onAddLicense:D,onUpdateLicense:he,onDeleteLicense:we,onAddBranch:ie,category:"SGA"}),t==="deactivatedLicenses"&&y.jsx(OG,{licenses:Y.filter(ye=>!ye.active),branches:te,licenseTypes:ce,onUpdateLicense:he}),t==="licenseTypes"&&y.jsx(IG,{licenseTypes:l,onAddLicenseType:ne,onUpdateLicenseType:ue,onDeleteLicenseType:Ve}),t==="branches"&&y.jsx(DG,{branches:f,onAddBranch:ie,onUpdateBranch:ee,onDeleteBranch:ge}),t==="users"&&y.jsx(MG,{branches:f,licenseTypes:l})]})}),y.jsx("footer",{className:"text-center text-gray-500 py-6 text-sm border-t border-gray-200 dark:border-gray-800 mt-auto bg-white dark:bg-gray-800",children:y.jsxs("p",{children:[" ",new Date().getFullYear()," Gesto Ambiental. Todos os direitos reservados."]})})]})]})},pC=document.getElementById("root");if(!pC)throw new Error("Could not find root element to mount to");const GG=$3.createRoot(pC);GG.render(y.jsx(gb.StrictMode,{children:y.jsx(zG,{})}));
