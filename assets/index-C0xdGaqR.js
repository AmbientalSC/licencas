(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}})();function Vb(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Yg={exports:{}},kf={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nw;function y3(){if(Nw)return kf;Nw=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function r(n,a,s){var l=null;if(s!==void 0&&(l=""+s),a.key!==void 0&&(l=""+a.key),"key"in a){s={};for(var u in a)u!=="key"&&(s[u]=a[u])}else s=a;return a=s.ref,{$$typeof:t,type:n,key:l,ref:a!==void 0?a:null,props:s}}return kf.Fragment=e,kf.jsx=r,kf.jsxs=r,kf}var Iw;function _3(){return Iw||(Iw=1,Yg.exports=y3()),Yg.exports}var x=_3(),Qg={exports:{}},It={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rw;function w3(){if(Rw)return It;Rw=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),y=Symbol.iterator;function _(J){return J===null||typeof J!="object"?null:(J=y&&J[y]||J["@@iterator"],typeof J=="function"?J:null)}var E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,w={};function S(J,ge,V){this.props=J,this.context=ge,this.refs=w,this.updater=V||E}S.prototype.isReactComponent={},S.prototype.setState=function(J,ge){if(typeof J!="object"&&typeof J!="function"&&J!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,J,ge,"setState")},S.prototype.forceUpdate=function(J){this.updater.enqueueForceUpdate(this,J,"forceUpdate")};function M(){}M.prototype=S.prototype;function j(J,ge,V){this.props=J,this.context=ge,this.refs=w,this.updater=V||E}var F=j.prototype=new M;F.constructor=j,b(F,S.prototype),F.isPureReactComponent=!0;var G=Array.isArray,W={H:null,A:null,T:null,S:null,V:null},B=Object.prototype.hasOwnProperty;function A(J,ge,V,X,Z,te){return V=te.ref,{$$typeof:t,type:J,key:ge,ref:V!==void 0?V:null,props:te}}function D(J,ge){return A(J.type,ge,void 0,void 0,void 0,J.props)}function k(J){return typeof J=="object"&&J!==null&&J.$$typeof===t}function O(J){var ge={"=":"=0",":":"=2"};return"$"+J.replace(/[=:]/g,function(V){return ge[V]})}var P=/\/+/g;function N(J,ge){return typeof J=="object"&&J!==null&&J.key!=null?O(""+J.key):ge.toString(36)}function R(){}function he(J){switch(J.status){case"fulfilled":return J.value;case"rejected":throw J.reason;default:switch(typeof J.status=="string"?J.then(R,R):(J.status="pending",J.then(function(ge){J.status==="pending"&&(J.status="fulfilled",J.value=ge)},function(ge){J.status==="pending"&&(J.status="rejected",J.reason=ge)})),J.status){case"fulfilled":return J.value;case"rejected":throw J.reason}}throw J}function xe(J,ge,V,X,Z){var te=typeof J;(te==="undefined"||te==="boolean")&&(J=null);var fe=!1;if(J===null)fe=!0;else switch(te){case"bigint":case"string":case"number":fe=!0;break;case"object":switch(J.$$typeof){case t:case e:fe=!0;break;case m:return fe=J._init,xe(fe(J._payload),ge,V,X,Z)}}if(fe)return Z=Z(J),fe=X===""?"."+N(J,0):X,G(Z)?(V="",fe!=null&&(V=fe.replace(P,"$&/")+"/"),xe(Z,ge,V,"",function(Ne){return Ne})):Z!=null&&(k(Z)&&(Z=D(Z,V+(Z.key==null||J&&J.key===Z.key?"":(""+Z.key).replace(P,"$&/")+"/")+fe)),ge.push(Z)),1;fe=0;var Se=X===""?".":X+":";if(G(J))for(var ke=0;ke<J.length;ke++)X=J[ke],te=Se+N(X,ke),fe+=xe(X,ge,V,te,Z);else if(ke=_(J),typeof ke=="function")for(J=ke.call(J),ke=0;!(X=J.next()).done;)X=X.value,te=Se+N(X,ke++),fe+=xe(X,ge,V,te,Z);else if(te==="object"){if(typeof J.then=="function")return xe(he(J),ge,V,X,Z);throw ge=String(J),Error("Objects are not valid as a React child (found: "+(ge==="[object Object]"?"object with keys {"+Object.keys(J).join(", ")+"}":ge)+"). If you meant to render a collection of children, use an array instead.")}return fe}function ne(J,ge,V){if(J==null)return J;var X=[],Z=0;return xe(J,X,"","",function(te){return ge.call(V,te,Z++)}),X}function le(J){if(J._status===-1){var ge=J._result;ge=ge(),ge.then(function(V){(J._status===0||J._status===-1)&&(J._status=1,J._result=V)},function(V){(J._status===0||J._status===-1)&&(J._status=2,J._result=V)}),J._status===-1&&(J._status=0,J._result=ge)}if(J._status===1)return J._result.default;throw J._result}var He=typeof reportError=="function"?reportError:function(J){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ge=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof J=="object"&&J!==null&&typeof J.message=="string"?String(J.message):String(J),error:J});if(!window.dispatchEvent(ge))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",J);return}console.error(J)};function ie(){}return It.Children={map:ne,forEach:function(J,ge,V){ne(J,function(){ge.apply(this,arguments)},V)},count:function(J){var ge=0;return ne(J,function(){ge++}),ge},toArray:function(J){return ne(J,function(ge){return ge})||[]},only:function(J){if(!k(J))throw Error("React.Children.only expected to receive a single React element child.");return J}},It.Component=S,It.Fragment=r,It.Profiler=a,It.PureComponent=j,It.StrictMode=n,It.Suspense=f,It.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=W,It.__COMPILER_RUNTIME={__proto__:null,c:function(J){return W.H.useMemoCache(J)}},It.cache=function(J){return function(){return J.apply(null,arguments)}},It.cloneElement=function(J,ge,V){if(J==null)throw Error("The argument must be a React element, but you passed "+J+".");var X=b({},J.props),Z=J.key,te=void 0;if(ge!=null)for(fe in ge.ref!==void 0&&(te=void 0),ge.key!==void 0&&(Z=""+ge.key),ge)!B.call(ge,fe)||fe==="key"||fe==="__self"||fe==="__source"||fe==="ref"&&ge.ref===void 0||(X[fe]=ge[fe]);var fe=arguments.length-2;if(fe===1)X.children=V;else if(1<fe){for(var Se=Array(fe),ke=0;ke<fe;ke++)Se[ke]=arguments[ke+2];X.children=Se}return A(J.type,Z,void 0,void 0,te,X)},It.createContext=function(J){return J={$$typeof:l,_currentValue:J,_currentValue2:J,_threadCount:0,Provider:null,Consumer:null},J.Provider=J,J.Consumer={$$typeof:s,_context:J},J},It.createElement=function(J,ge,V){var X,Z={},te=null;if(ge!=null)for(X in ge.key!==void 0&&(te=""+ge.key),ge)B.call(ge,X)&&X!=="key"&&X!=="__self"&&X!=="__source"&&(Z[X]=ge[X]);var fe=arguments.length-2;if(fe===1)Z.children=V;else if(1<fe){for(var Se=Array(fe),ke=0;ke<fe;ke++)Se[ke]=arguments[ke+2];Z.children=Se}if(J&&J.defaultProps)for(X in fe=J.defaultProps,fe)Z[X]===void 0&&(Z[X]=fe[X]);return A(J,te,void 0,void 0,null,Z)},It.createRef=function(){return{current:null}},It.forwardRef=function(J){return{$$typeof:u,render:J}},It.isValidElement=k,It.lazy=function(J){return{$$typeof:m,_payload:{_status:-1,_result:J},_init:le}},It.memo=function(J,ge){return{$$typeof:d,type:J,compare:ge===void 0?null:ge}},It.startTransition=function(J){var ge=W.T,V={};W.T=V;try{var X=J(),Z=W.S;Z!==null&&Z(V,X),typeof X=="object"&&X!==null&&typeof X.then=="function"&&X.then(ie,He)}catch(te){He(te)}finally{W.T=ge}},It.unstable_useCacheRefresh=function(){return W.H.useCacheRefresh()},It.use=function(J){return W.H.use(J)},It.useActionState=function(J,ge,V){return W.H.useActionState(J,ge,V)},It.useCallback=function(J,ge){return W.H.useCallback(J,ge)},It.useContext=function(J){return W.H.useContext(J)},It.useDebugValue=function(){},It.useDeferredValue=function(J,ge){return W.H.useDeferredValue(J,ge)},It.useEffect=function(J,ge,V){var X=W.H;if(typeof V=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return X.useEffect(J,ge)},It.useId=function(){return W.H.useId()},It.useImperativeHandle=function(J,ge,V){return W.H.useImperativeHandle(J,ge,V)},It.useInsertionEffect=function(J,ge){return W.H.useInsertionEffect(J,ge)},It.useLayoutEffect=function(J,ge){return W.H.useLayoutEffect(J,ge)},It.useMemo=function(J,ge){return W.H.useMemo(J,ge)},It.useOptimistic=function(J,ge){return W.H.useOptimistic(J,ge)},It.useReducer=function(J,ge,V){return W.H.useReducer(J,ge,V)},It.useRef=function(J){return W.H.useRef(J)},It.useState=function(J){return W.H.useState(J)},It.useSyncExternalStore=function(J,ge,V){return W.H.useSyncExternalStore(J,ge,V)},It.useTransition=function(){return W.H.useTransition()},It.version="19.1.0",It}var Dw;function N1(){return Dw||(Dw=1,Qg.exports=w3()),Qg.exports}var je=N1();const zb=Vb(je);var Jg={exports:{}},Af={},Zg={exports:{}},ex={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ow;function E3(){return Ow||(Ow=1,function(t){function e(ne,le){var He=ne.length;ne.push(le);e:for(;0<He;){var ie=He-1>>>1,J=ne[ie];if(0<a(J,le))ne[ie]=le,ne[He]=J,He=ie;else break e}}function r(ne){return ne.length===0?null:ne[0]}function n(ne){if(ne.length===0)return null;var le=ne[0],He=ne.pop();if(He!==le){ne[0]=He;e:for(var ie=0,J=ne.length,ge=J>>>1;ie<ge;){var V=2*(ie+1)-1,X=ne[V],Z=V+1,te=ne[Z];if(0>a(X,He))Z<J&&0>a(te,X)?(ne[ie]=te,ne[Z]=He,ie=Z):(ne[ie]=X,ne[V]=He,ie=V);else if(Z<J&&0>a(te,He))ne[ie]=te,ne[Z]=He,ie=Z;else break e}}return le}function a(ne,le){var He=ne.sortIndex-le.sortIndex;return He!==0?He:ne.id-le.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var l=Date,u=l.now();t.unstable_now=function(){return l.now()-u}}var f=[],d=[],m=1,y=null,_=3,E=!1,b=!1,w=!1,S=!1,M=typeof setTimeout=="function"?setTimeout:null,j=typeof clearTimeout=="function"?clearTimeout:null,F=typeof setImmediate<"u"?setImmediate:null;function G(ne){for(var le=r(d);le!==null;){if(le.callback===null)n(d);else if(le.startTime<=ne)n(d),le.sortIndex=le.expirationTime,e(f,le);else break;le=r(d)}}function W(ne){if(w=!1,G(ne),!b)if(r(f)!==null)b=!0,B||(B=!0,N());else{var le=r(d);le!==null&&xe(W,le.startTime-ne)}}var B=!1,A=-1,D=5,k=-1;function O(){return S?!0:!(t.unstable_now()-k<D)}function P(){if(S=!1,B){var ne=t.unstable_now();k=ne;var le=!0;try{e:{b=!1,w&&(w=!1,j(A),A=-1),E=!0;var He=_;try{t:{for(G(ne),y=r(f);y!==null&&!(y.expirationTime>ne&&O());){var ie=y.callback;if(typeof ie=="function"){y.callback=null,_=y.priorityLevel;var J=ie(y.expirationTime<=ne);if(ne=t.unstable_now(),typeof J=="function"){y.callback=J,G(ne),le=!0;break t}y===r(f)&&n(f),G(ne)}else n(f);y=r(f)}if(y!==null)le=!0;else{var ge=r(d);ge!==null&&xe(W,ge.startTime-ne),le=!1}}break e}finally{y=null,_=He,E=!1}le=void 0}}finally{le?N():B=!1}}}var N;if(typeof F=="function")N=function(){F(P)};else if(typeof MessageChannel<"u"){var R=new MessageChannel,he=R.port2;R.port1.onmessage=P,N=function(){he.postMessage(null)}}else N=function(){M(P,0)};function xe(ne,le){A=M(function(){ne(t.unstable_now())},le)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ne){ne.callback=null},t.unstable_forceFrameRate=function(ne){0>ne||125<ne?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<ne?Math.floor(1e3/ne):5},t.unstable_getCurrentPriorityLevel=function(){return _},t.unstable_next=function(ne){switch(_){case 1:case 2:case 3:var le=3;break;default:le=_}var He=_;_=le;try{return ne()}finally{_=He}},t.unstable_requestPaint=function(){S=!0},t.unstable_runWithPriority=function(ne,le){switch(ne){case 1:case 2:case 3:case 4:case 5:break;default:ne=3}var He=_;_=ne;try{return le()}finally{_=He}},t.unstable_scheduleCallback=function(ne,le,He){var ie=t.unstable_now();switch(typeof He=="object"&&He!==null?(He=He.delay,He=typeof He=="number"&&0<He?ie+He:ie):He=ie,ne){case 1:var J=-1;break;case 2:J=250;break;case 5:J=1073741823;break;case 4:J=1e4;break;default:J=5e3}return J=He+J,ne={id:m++,callback:le,priorityLevel:ne,startTime:He,expirationTime:J,sortIndex:-1},He>ie?(ne.sortIndex=He,e(d,ne),r(f)===null&&ne===r(d)&&(w?(j(A),A=-1):w=!0,xe(W,He-ie))):(ne.sortIndex=J,e(f,ne),b||E||(b=!0,B||(B=!0,N()))),ne},t.unstable_shouldYield=O,t.unstable_wrapCallback=function(ne){var le=_;return function(){var He=_;_=le;try{return ne.apply(this,arguments)}finally{_=He}}}}(ex)),ex}var Fw;function T3(){return Fw||(Fw=1,Zg.exports=E3()),Zg.exports}var tx={exports:{}},Hn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lw;function b3(){if(Lw)return Hn;Lw=1;var t=N1();function e(f){var d="https://react.dev/errors/"+f;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)d+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+f+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(e(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},a=Symbol.for("react.portal");function s(f,d,m){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:y==null?null:""+y,children:f,containerInfo:d,implementation:m}}var l=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(f,d){if(f==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return Hn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Hn.createPortal=function(f,d){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return s(f,d,null,m)},Hn.flushSync=function(f){var d=l.T,m=n.p;try{if(l.T=null,n.p=2,f)return f()}finally{l.T=d,n.p=m,n.d.f()}},Hn.preconnect=function(f,d){typeof f=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,n.d.C(f,d))},Hn.prefetchDNS=function(f){typeof f=="string"&&n.d.D(f)},Hn.preinit=function(f,d){if(typeof f=="string"&&d&&typeof d.as=="string"){var m=d.as,y=u(m,d.crossOrigin),_=typeof d.integrity=="string"?d.integrity:void 0,E=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;m==="style"?n.d.S(f,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:y,integrity:_,fetchPriority:E}):m==="script"&&n.d.X(f,{crossOrigin:y,integrity:_,fetchPriority:E,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},Hn.preinitModule=function(f,d){if(typeof f=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var m=u(d.as,d.crossOrigin);n.d.M(f,{crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&n.d.M(f)},Hn.preload=function(f,d){if(typeof f=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var m=d.as,y=u(m,d.crossOrigin);n.d.L(f,m,{crossOrigin:y,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},Hn.preloadModule=function(f,d){if(typeof f=="string")if(d){var m=u(d.as,d.crossOrigin);n.d.m(f,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else n.d.m(f)},Hn.requestFormReset=function(f){n.d.r(f)},Hn.unstable_batchedUpdates=function(f,d){return f(d)},Hn.useFormState=function(f,d,m){return l.H.useFormState(f,d,m)},Hn.useFormStatus=function(){return l.H.useHostTransitionStatus()},Hn.version="19.1.0",Hn}var Mw;function S3(){if(Mw)return tx.exports;Mw=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),tx.exports=b3(),tx.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pw;function k3(){if(Pw)return Af;Pw=1;var t=T3(),e=N1(),r=S3();function n(i){var o="https://react.dev/errors/"+i;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)o+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+i+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function s(i){var o=i,c=i;if(i.alternate)for(;o.return;)o=o.return;else{i=o;do o=i,(o.flags&4098)!==0&&(c=o.return),i=o.return;while(i)}return o.tag===3?c:null}function l(i){if(i.tag===13){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function u(i){if(s(i)!==i)throw Error(n(188))}function f(i){var o=i.alternate;if(!o){if(o=s(i),o===null)throw Error(n(188));return o!==i?null:i}for(var c=i,h=o;;){var g=c.return;if(g===null)break;var v=g.alternate;if(v===null){if(h=g.return,h!==null){c=h;continue}break}if(g.child===v.child){for(v=g.child;v;){if(v===c)return u(g),i;if(v===h)return u(g),o;v=v.sibling}throw Error(n(188))}if(c.return!==h.return)c=g,h=v;else{for(var I=!1,U=g.child;U;){if(U===c){I=!0,c=g,h=v;break}if(U===h){I=!0,h=g,c=v;break}U=U.sibling}if(!I){for(U=v.child;U;){if(U===c){I=!0,c=v,h=g;break}if(U===h){I=!0,h=v,c=g;break}U=U.sibling}if(!I)throw Error(n(189))}}if(c.alternate!==h)throw Error(n(190))}if(c.tag!==3)throw Error(n(188));return c.stateNode.current===c?i:o}function d(i){var o=i.tag;if(o===5||o===26||o===27||o===6)return i;for(i=i.child;i!==null;){if(o=d(i),o!==null)return o;i=i.sibling}return null}var m=Object.assign,y=Symbol.for("react.element"),_=Symbol.for("react.transitional.element"),E=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),M=Symbol.for("react.provider"),j=Symbol.for("react.consumer"),F=Symbol.for("react.context"),G=Symbol.for("react.forward_ref"),W=Symbol.for("react.suspense"),B=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),D=Symbol.for("react.lazy"),k=Symbol.for("react.activity"),O=Symbol.for("react.memo_cache_sentinel"),P=Symbol.iterator;function N(i){return i===null||typeof i!="object"?null:(i=P&&i[P]||i["@@iterator"],typeof i=="function"?i:null)}var R=Symbol.for("react.client.reference");function he(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===R?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case b:return"Fragment";case S:return"Profiler";case w:return"StrictMode";case W:return"Suspense";case B:return"SuspenseList";case k:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case E:return"Portal";case F:return(i.displayName||"Context")+".Provider";case j:return(i._context.displayName||"Context")+".Consumer";case G:var o=i.render;return i=i.displayName,i||(i=o.displayName||o.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case A:return o=i.displayName||null,o!==null?o:he(i.type)||"Memo";case D:o=i._payload,i=i._init;try{return he(i(o))}catch{}}return null}var xe=Array.isArray,ne=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,le=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,He={pending:!1,data:null,method:null,action:null},ie=[],J=-1;function ge(i){return{current:i}}function V(i){0>J||(i.current=ie[J],ie[J]=null,J--)}function X(i,o){J++,ie[J]=i.current,i.current=o}var Z=ge(null),te=ge(null),fe=ge(null),Se=ge(null);function ke(i,o){switch(X(fe,o),X(te,i),X(Z,null),o.nodeType){case 9:case 11:i=(i=o.documentElement)&&(i=i.namespaceURI)?nw(i):0;break;default:if(i=o.tagName,o=o.namespaceURI)o=nw(o),i=aw(o,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}V(Z),X(Z,i)}function Ne(){V(Z),V(te),V(fe)}function Oe(i){i.memoizedState!==null&&X(Se,i);var o=Z.current,c=aw(o,i.type);o!==c&&(X(te,i),X(Z,c))}function ot(i){te.current===i&&(V(Z),V(te)),Se.current===i&&(V(Se),wf._currentValue=He)}var ee=Object.prototype.hasOwnProperty,Pt=t.unstable_scheduleCallback,_t=t.unstable_cancelCallback,Dt=t.unstable_shouldYield,nt=t.unstable_requestPaint,Ge=t.unstable_now,tr=t.unstable_getCurrentPriorityLevel,Jt=t.unstable_ImmediatePriority,Ct=t.unstable_UserBlockingPriority,wr=t.unstable_NormalPriority,_n=t.unstable_LowPriority,Dr=t.unstable_IdlePriority,mr=t.log,en=t.unstable_setDisableYieldValue,jt=null,oe=null;function ze(i){if(typeof mr=="function"&&en(i),oe&&typeof oe.setStrictMode=="function")try{oe.setStrictMode(jt,i)}catch{}}var Ve=Math.clz32?Math.clz32:Ae,Je=Math.log,ft=Math.LN2;function Ae(i){return i>>>=0,i===0?32:31-(Je(i)/ft|0)|0}var Me=256,Xe=4194304;function ct(i){var o=i&42;if(o!==0)return o;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function sr(i,o,c){var h=i.pendingLanes;if(h===0)return 0;var g=0,v=i.suspendedLanes,I=i.pingedLanes;i=i.warmLanes;var U=h&134217727;return U!==0?(h=U&~v,h!==0?g=ct(h):(I&=U,I!==0?g=ct(I):c||(c=U&~i,c!==0&&(g=ct(c))))):(U=h&~v,U!==0?g=ct(U):I!==0?g=ct(I):c||(c=h&~i,c!==0&&(g=ct(c)))),g===0?0:o!==0&&o!==g&&(o&v)===0&&(v=g&-g,c=o&-o,v>=c||v===32&&(c&4194048)!==0)?o:g}function Or(i,o){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&o)===0}function fn(i,o){switch(i){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Rn(){var i=Me;return Me<<=1,(Me&4194048)===0&&(Me=256),i}function li(){var i=Xe;return Xe<<=1,(Xe&62914560)===0&&(Xe=4194304),i}function se(i){for(var o=[],c=0;31>c;c++)o.push(i);return o}function Ue(i,o){i.pendingLanes|=o,o!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function Qe(i,o,c,h,g,v){var I=i.pendingLanes;i.pendingLanes=c,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=c,i.entangledLanes&=c,i.errorRecoveryDisabledLanes&=c,i.shellSuspendCounter=0;var U=i.entanglements,re=i.expirationTimes,ve=i.hiddenUpdates;for(c=I&~c;0<c;){var Ie=31-Ve(c),Fe=1<<Ie;U[Ie]=0,re[Ie]=-1;var we=ve[Ie];if(we!==null)for(ve[Ie]=null,Ie=0;Ie<we.length;Ie++){var Ee=we[Ie];Ee!==null&&(Ee.lane&=-536870913)}c&=~Fe}h!==0&&lt(i,h,0),v!==0&&g===0&&i.tag!==0&&(i.suspendedLanes|=v&~(I&~o))}function lt(i,o,c){i.pendingLanes|=o,i.suspendedLanes&=~o;var h=31-Ve(o);i.entangledLanes|=o,i.entanglements[h]=i.entanglements[h]|1073741824|c&4194090}function st(i,o){var c=i.entangledLanes|=o;for(i=i.entanglements;c;){var h=31-Ve(c),g=1<<h;g&o|i[h]&o&&(i[h]|=o),c&=~g}}function Fr(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function wn(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function Ur(){var i=le.p;return i!==0?i:(i=window.event,i===void 0?32:Tw(i.type))}function Ot(i,o){var c=le.p;try{return le.p=i,o()}finally{le.p=c}}var et=Math.random().toString(36).slice(2),bt="__reactFiber$"+et,Ht="__reactProps$"+et,Nt="__reactContainer$"+et,Ta="__reactEvents$"+et,pr="__reactListeners$"+et,L="__reactHandles$"+et,K="__reactResources$"+et,H="__reactMarker$"+et;function q(i){delete i[bt],delete i[Ht],delete i[Ta],delete i[pr],delete i[L]}function Q(i){var o=i[bt];if(o)return o;for(var c=i.parentNode;c;){if(o=c[Nt]||c[bt]){if(c=o.alternate,o.child!==null||c!==null&&c.child!==null)for(i=lw(i);i!==null;){if(c=i[bt])return c;i=lw(i)}return o}i=c,c=i.parentNode}return null}function Y(i){if(i=i[bt]||i[Nt]){var o=i.tag;if(o===5||o===6||o===13||o===26||o===27||o===3)return i}return null}function de(i){var o=i.tag;if(o===5||o===26||o===27||o===6)return i.stateNode;throw Error(n(33))}function Te(i){var o=i[K];return o||(o=i[K]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function ce(i){i[H]=!0}var ye=new Set,_e={};function Be(i,o){We(i,o),We(i+"Capture",o)}function We(i,o){for(_e[i]=o,i=0;i<o.length;i++)ye.add(o[i])}var tt=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),qe={},Ze={};function wt(i){return ee.call(Ze,i)?!0:ee.call(qe,i)?!1:tt.test(i)?Ze[i]=!0:(qe[i]=!0,!1)}function rr(i,o,c){if(wt(o))if(c===null)i.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":i.removeAttribute(o);return;case"boolean":var h=o.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){i.removeAttribute(o);return}}i.setAttribute(o,""+c)}}function Wt(i,o,c){if(c===null)i.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(o);return}i.setAttribute(o,""+c)}}function Xt(i,o,c,h){if(h===null)i.removeAttribute(c);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(c);return}i.setAttributeNS(o,c,""+h)}}var ba,wi;function ra(i){if(ba===void 0)try{throw Error()}catch(c){var o=c.stack.trim().match(/\n( *(at )?)/);ba=o&&o[1]||"",wi=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ba+i+wi}var da=!1;function Ei(i,o){if(!i||da)return"";da=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(o){var Fe=function(){throw Error()};if(Object.defineProperty(Fe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Fe,[])}catch(Ee){var we=Ee}Reflect.construct(i,[],Fe)}else{try{Fe.call()}catch(Ee){we=Ee}i.call(Fe.prototype)}}else{try{throw Error()}catch(Ee){we=Ee}(Fe=i())&&typeof Fe.catch=="function"&&Fe.catch(function(){})}}catch(Ee){if(Ee&&we&&typeof Ee.stack=="string")return[Ee.stack,we.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var v=h.DetermineComponentFrameRoot(),I=v[0],U=v[1];if(I&&U){var re=I.split(`
`),ve=U.split(`
`);for(g=h=0;h<re.length&&!re[h].includes("DetermineComponentFrameRoot");)h++;for(;g<ve.length&&!ve[g].includes("DetermineComponentFrameRoot");)g++;if(h===re.length||g===ve.length)for(h=re.length-1,g=ve.length-1;1<=h&&0<=g&&re[h]!==ve[g];)g--;for(;1<=h&&0<=g;h--,g--)if(re[h]!==ve[g]){if(h!==1||g!==1)do if(h--,g--,0>g||re[h]!==ve[g]){var Ie=`
`+re[h].replace(" at new "," at ");return i.displayName&&Ie.includes("<anonymous>")&&(Ie=Ie.replace("<anonymous>",i.displayName)),Ie}while(1<=h&&0<=g);break}}}finally{da=!1,Error.prepareStackTrace=c}return(c=i?i.displayName||i.name:"")?ra(c):""}function na(i){switch(i.tag){case 26:case 27:case 5:return ra(i.type);case 16:return ra("Lazy");case 13:return ra("Suspense");case 19:return ra("SuspenseList");case 0:case 15:return Ei(i.type,!1);case 11:return Ei(i.type.render,!1);case 1:return Ei(i.type,!0);case 31:return ra("Activity");default:return""}}function Jl(i){try{var o="";do o+=na(i),i=i.return;while(i);return o}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}function aa(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Cu(i){var o=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function ep(i){var o=Cu(i)?"checked":"value",c=Object.getOwnPropertyDescriptor(i.constructor.prototype,o),h=""+i[o];if(!i.hasOwnProperty(o)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var g=c.get,v=c.set;return Object.defineProperty(i,o,{configurable:!0,get:function(){return g.call(this)},set:function(I){h=""+I,v.call(this,I)}}),Object.defineProperty(i,o,{enumerable:c.enumerable}),{getValue:function(){return h},setValue:function(I){h=""+I},stopTracking:function(){i._valueTracker=null,delete i[o]}}}}function Zl(i){i._valueTracker||(i._valueTracker=ep(i))}function Nu(i){if(!i)return!1;var o=i._valueTracker;if(!o)return!0;var c=o.getValue(),h="";return i&&(h=Cu(i)?i.checked?"true":"false":i.value),i=h,i!==c?(o.setValue(i),!0):!1}function qo(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var tp=/[\n"\\]/g;function tn(i){return i.replace(tp,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function Sa(i,o,c,h,g,v,I,U){i.name="",I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"?i.type=I:i.removeAttribute("type"),o!=null?I==="number"?(o===0&&i.value===""||i.value!=o)&&(i.value=""+aa(o)):i.value!==""+aa(o)&&(i.value=""+aa(o)):I!=="submit"&&I!=="reset"||i.removeAttribute("value"),o!=null?Ls(i,I,aa(o)):c!=null?Ls(i,I,aa(c)):h!=null&&i.removeAttribute("value"),g==null&&v!=null&&(i.defaultChecked=!!v),g!=null&&(i.checked=g&&typeof g!="function"&&typeof g!="symbol"),U!=null&&typeof U!="function"&&typeof U!="symbol"&&typeof U!="boolean"?i.name=""+aa(U):i.removeAttribute("name")}function Wo(i,o,c,h,g,v,I,U){if(v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(i.type=v),o!=null||c!=null){if(!(v!=="submit"&&v!=="reset"||o!=null))return;c=c!=null?""+aa(c):"",o=o!=null?""+aa(o):c,U||o===i.value||(i.value=o),i.defaultValue=o}h=h??g,h=typeof h!="function"&&typeof h!="symbol"&&!!h,i.checked=U?i.checked:!!h,i.defaultChecked=!!h,I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"&&(i.name=I)}function Ls(i,o,c){o==="number"&&qo(i.ownerDocument)===i||i.defaultValue===""+c||(i.defaultValue=""+c)}function Zi(i,o,c,h){if(i=i.options,o){o={};for(var g=0;g<c.length;g++)o["$"+c[g]]=!0;for(c=0;c<i.length;c++)g=o.hasOwnProperty("$"+i[c].value),i[c].selected!==g&&(i[c].selected=g),g&&h&&(i[c].defaultSelected=!0)}else{for(c=""+aa(c),o=null,g=0;g<i.length;g++){if(i[g].value===c){i[g].selected=!0,h&&(i[g].defaultSelected=!0);return}o!==null||i[g].disabled||(o=i[g])}o!==null&&(o.selected=!0)}}function gr(i,o,c){if(o!=null&&(o=""+aa(o),o!==i.value&&(i.value=o),c==null)){i.defaultValue!==o&&(i.defaultValue=o);return}i.defaultValue=c!=null?""+aa(c):""}function Xo(i,o,c,h){if(o==null){if(h!=null){if(c!=null)throw Error(n(92));if(xe(h)){if(1<h.length)throw Error(n(93));h=h[0]}c=h}c==null&&(c=""),o=c}c=aa(o),i.defaultValue=c,h=i.textContent,h===c&&h!==""&&h!==null&&(i.value=h)}function za(i,o){if(o){var c=i.firstChild;if(c&&c===i.lastChild&&c.nodeType===3){c.nodeValue=o;return}}i.textContent=o}var $o=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Q0(i,o,c){var h=o.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?h?i.setProperty(o,""):o==="float"?i.cssFloat="":i[o]="":h?i.setProperty(o,c):typeof c!="number"||c===0||$o.has(o)?o==="float"?i.cssFloat=c:i[o]=(""+c).trim():i[o]=c+"px"}function Iu(i,o,c){if(o!=null&&typeof o!="object")throw Error(n(62));if(i=i.style,c!=null){for(var h in c)!c.hasOwnProperty(h)||o!=null&&o.hasOwnProperty(h)||(h.indexOf("--")===0?i.setProperty(h,""):h==="float"?i.cssFloat="":i[h]="");for(var g in o)h=o[g],o.hasOwnProperty(g)&&c[g]!==h&&Q0(i,g,h)}else for(var v in o)o.hasOwnProperty(v)&&Q0(i,v,o[v])}function Ru(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var rp=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),np=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ec(i){return np.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}var es=null;function Ha(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var ts=null,rs=null;function Du(i){var o=Y(i);if(o&&(i=o.stateNode)){var c=i[Ht]||null;e:switch(i=o.stateNode,o.type){case"input":if(Sa(i,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),o=c.name,c.type==="radio"&&o!=null){for(c=i;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+tn(""+o)+'"][type="radio"]'),o=0;o<c.length;o++){var h=c[o];if(h!==i&&h.form===i.form){var g=h[Ht]||null;if(!g)throw Error(n(90));Sa(h,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(o=0;o<c.length;o++)h=c[o],h.form===i.form&&Nu(h)}break e;case"textarea":gr(i,c.value,c.defaultValue);break e;case"select":o=c.value,o!=null&&Zi(i,!!c.multiple,o,!1)}}}var Ti=!1;function J0(i,o,c){if(Ti)return i(o,c);Ti=!0;try{var h=i(o);return h}finally{if(Ti=!1,(ts!==null||rs!==null)&&(qh(),ts&&(o=ts,i=rs,rs=ts=null,Du(o),i)))for(o=0;o<i.length;o++)Du(i[o])}}function Ko(i,o){var c=i.stateNode;if(c===null)return null;var h=c[Ht]||null;if(h===null)return null;c=h[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(i=i.type,h=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!h;break e;default:i=!1}if(i)return null;if(c&&typeof c!="function")throw Error(n(231,o,typeof c));return c}var ci=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ga=!1;if(ci)try{var Yo={};Object.defineProperty(Yo,"passive",{get:function(){Ga=!0}}),window.addEventListener("test",Yo,Yo),window.removeEventListener("test",Yo,Yo)}catch{Ga=!1}var bi=null,Ms=null,ns=null;function Ou(){if(ns)return ns;var i,o=Ms,c=o.length,h,g="value"in bi?bi.value:bi.textContent,v=g.length;for(i=0;i<c&&o[i]===g[i];i++);var I=c-i;for(h=1;h<=I&&o[c-h]===g[v-h];h++);return ns=g.slice(i,1<h?1-h:void 0)}function Si(i){var o=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&o===13&&(i=13)):i=o,i===10&&(i=13),32<=i||i===13?i:0}function ki(){return!0}function Fu(){return!1}function En(i){function o(c,h,g,v,I){this._reactName=c,this._targetInst=g,this.type=h,this.nativeEvent=v,this.target=I,this.currentTarget=null;for(var U in i)i.hasOwnProperty(U)&&(c=i[U],this[U]=c?c(v):v[U]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?ki:Fu,this.isPropagationStopped=Fu,this}return m(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=ki)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=ki)},persist:function(){},isPersistent:ki}),o}var or={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},tc=En(or),Qo=m({},or,{view:0,detail:0}),Z0=En(Qo),rc,nc,Ai,Jo=m({},Qo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:tl,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Ai&&(Ai&&i.type==="mousemove"?(rc=i.screenX-Ai.screenX,nc=i.screenY-Ai.screenY):nc=rc=0,Ai=i),rc)},movementY:function(i){return"movementY"in i?i.movementY:nc}}),qa=En(Jo),eh=m({},Jo,{dataTransfer:0}),ap=En(eh),Zo=m({},Qo,{relatedTarget:0}),ac=En(Zo),Lu=m({},or,{animationName:0,elapsedTime:0,pseudoElement:0}),ic=En(Lu),th=m({},or,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),sc=En(th),ip=m({},or,{data:0}),Mu=En(ip),el={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},rh={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},nh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pu(i){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(i):(i=nh[i])?!!o[i]:!1}function tl(){return Pu}var ah=m({},Qo,{key:function(i){if(i.key){var o=el[i.key]||i.key;if(o!=="Unidentified")return o}return i.type==="keypress"?(i=Si(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?rh[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:tl,charCode:function(i){return i.type==="keypress"?Si(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Si(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),oc=En(ah),ih=m({},Jo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ju=En(ih),as=m({},Qo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:tl}),sh=En(as),oh=m({},or,{propertyName:0,elapsedTime:0,pseudoElement:0}),lh=En(oh),ch=m({},Jo,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),lc=En(ch),ia=m({},or,{newState:0,oldState:0}),uh=En(ia),fh=[9,13,27,32],Ci=ci&&"CompositionEvent"in window,p=null;ci&&"documentMode"in document&&(p=document.documentMode);var T=ci&&"TextEvent"in window&&!p,C=ci&&(!Ci||p&&8<p&&11>=p),z=" ",me=!1;function be(i,o){switch(i){case"keyup":return fh.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ke(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var $t=!1;function hn(i,o){switch(i){case"compositionend":return Ke(o);case"keypress":return o.which!==32?null:(me=!0,z);case"textInput":return i=o.data,i===z&&me?null:i;default:return null}}function Kt(i,o){if($t)return i==="compositionend"||!Ci&&be(i,o)?(i=Ou(),ns=Ms=bi=null,$t=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return C&&o.locale!=="ko"?null:o.data;default:return null}}var Tn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function dn(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o==="input"?!!Tn[i.type]:o==="textarea"}function is(i,o,c,h){ts?rs?rs.push(h):rs=[h]:ts=h,o=Qh(o,"onChange"),0<o.length&&(c=new tc("onChange","change",null,c,h),i.push({event:c,listeners:o}))}var Dn=null,Ni=null;function Uu(i){J2(i,0)}function hh(i){var o=de(i);if(Nu(o))return i}function yy(i,o){if(i==="change")return o}var _y=!1;if(ci){var sp;if(ci){var op="oninput"in document;if(!op){var wy=document.createElement("div");wy.setAttribute("oninput","return;"),op=typeof wy.oninput=="function"}sp=op}else sp=!1;_y=sp&&(!document.documentMode||9<document.documentMode)}function Ey(){Dn&&(Dn.detachEvent("onpropertychange",Ty),Ni=Dn=null)}function Ty(i){if(i.propertyName==="value"&&hh(Ni)){var o=[];is(o,Ni,i,Ha(i)),J0(Uu,o)}}function KC(i,o,c){i==="focusin"?(Ey(),Dn=o,Ni=c,Dn.attachEvent("onpropertychange",Ty)):i==="focusout"&&Ey()}function YC(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return hh(Ni)}function QC(i,o){if(i==="click")return hh(o)}function JC(i,o){if(i==="input"||i==="change")return hh(o)}function ZC(i,o){return i===o&&(i!==0||1/i===1/o)||i!==i&&o!==o}var ka=typeof Object.is=="function"?Object.is:ZC;function Bu(i,o){if(ka(i,o))return!0;if(typeof i!="object"||i===null||typeof o!="object"||o===null)return!1;var c=Object.keys(i),h=Object.keys(o);if(c.length!==h.length)return!1;for(h=0;h<c.length;h++){var g=c[h];if(!ee.call(o,g)||!ka(i[g],o[g]))return!1}return!0}function by(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Sy(i,o){var c=by(i);i=0;for(var h;c;){if(c.nodeType===3){if(h=i+c.textContent.length,i<=o&&h>=o)return{node:c,offset:o-i};i=h}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=by(c)}}function ky(i,o){return i&&o?i===o?!0:i&&i.nodeType===3?!1:o&&o.nodeType===3?ky(i,o.parentNode):"contains"in i?i.contains(o):i.compareDocumentPosition?!!(i.compareDocumentPosition(o)&16):!1:!1}function Ay(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var o=qo(i.document);o instanceof i.HTMLIFrameElement;){try{var c=typeof o.contentWindow.location.href=="string"}catch{c=!1}if(c)i=o.contentWindow;else break;o=qo(i.document)}return o}function lp(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o&&(o==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||o==="textarea"||i.contentEditable==="true")}var eN=ci&&"documentMode"in document&&11>=document.documentMode,cc=null,cp=null,Vu=null,up=!1;function Cy(i,o,c){var h=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;up||cc==null||cc!==qo(h)||(h=cc,"selectionStart"in h&&lp(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),Vu&&Bu(Vu,h)||(Vu=h,h=Qh(cp,"onSelect"),0<h.length&&(o=new tc("onSelect","select",null,o,c),i.push({event:o,listeners:h}),o.target=cc)))}function rl(i,o){var c={};return c[i.toLowerCase()]=o.toLowerCase(),c["Webkit"+i]="webkit"+o,c["Moz"+i]="moz"+o,c}var uc={animationend:rl("Animation","AnimationEnd"),animationiteration:rl("Animation","AnimationIteration"),animationstart:rl("Animation","AnimationStart"),transitionrun:rl("Transition","TransitionRun"),transitionstart:rl("Transition","TransitionStart"),transitioncancel:rl("Transition","TransitionCancel"),transitionend:rl("Transition","TransitionEnd")},fp={},Ny={};ci&&(Ny=document.createElement("div").style,"AnimationEvent"in window||(delete uc.animationend.animation,delete uc.animationiteration.animation,delete uc.animationstart.animation),"TransitionEvent"in window||delete uc.transitionend.transition);function nl(i){if(fp[i])return fp[i];if(!uc[i])return i;var o=uc[i],c;for(c in o)if(o.hasOwnProperty(c)&&c in Ny)return fp[i]=o[c];return i}var Iy=nl("animationend"),Ry=nl("animationiteration"),Dy=nl("animationstart"),tN=nl("transitionrun"),rN=nl("transitionstart"),nN=nl("transitioncancel"),Oy=nl("transitionend"),Fy=new Map,hp="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");hp.push("scrollEnd");function ui(i,o){Fy.set(i,o),Be(o,[i])}var Ly=new WeakMap;function Wa(i,o){if(typeof i=="object"&&i!==null){var c=Ly.get(i);return c!==void 0?c:(o={value:i,source:o,stack:Jl(o)},Ly.set(i,o),o)}return{value:i,source:o,stack:Jl(o)}}var Xa=[],fc=0,dp=0;function dh(){for(var i=fc,o=dp=fc=0;o<i;){var c=Xa[o];Xa[o++]=null;var h=Xa[o];Xa[o++]=null;var g=Xa[o];Xa[o++]=null;var v=Xa[o];if(Xa[o++]=null,h!==null&&g!==null){var I=h.pending;I===null?g.next=g:(g.next=I.next,I.next=g),h.pending=g}v!==0&&My(c,g,v)}}function mh(i,o,c,h){Xa[fc++]=i,Xa[fc++]=o,Xa[fc++]=c,Xa[fc++]=h,dp|=h,i.lanes|=h,i=i.alternate,i!==null&&(i.lanes|=h)}function mp(i,o,c,h){return mh(i,o,c,h),ph(i)}function hc(i,o){return mh(i,null,null,o),ph(i)}function My(i,o,c){i.lanes|=c;var h=i.alternate;h!==null&&(h.lanes|=c);for(var g=!1,v=i.return;v!==null;)v.childLanes|=c,h=v.alternate,h!==null&&(h.childLanes|=c),v.tag===22&&(i=v.stateNode,i===null||i._visibility&1||(g=!0)),i=v,v=v.return;return i.tag===3?(v=i.stateNode,g&&o!==null&&(g=31-Ve(c),i=v.hiddenUpdates,h=i[g],h===null?i[g]=[o]:h.push(o),o.lane=c|536870912),v):null}function ph(i){if(50<df)throw df=0,_g=null,Error(n(185));for(var o=i.return;o!==null;)i=o,o=i.return;return i.tag===3?i.stateNode:null}var dc={};function aN(i,o,c,h){this.tag=i,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Aa(i,o,c,h){return new aN(i,o,c,h)}function pp(i){return i=i.prototype,!(!i||!i.isReactComponent)}function ss(i,o){var c=i.alternate;return c===null?(c=Aa(i.tag,o,i.key,i.mode),c.elementType=i.elementType,c.type=i.type,c.stateNode=i.stateNode,c.alternate=i,i.alternate=c):(c.pendingProps=o,c.type=i.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=i.flags&65011712,c.childLanes=i.childLanes,c.lanes=i.lanes,c.child=i.child,c.memoizedProps=i.memoizedProps,c.memoizedState=i.memoizedState,c.updateQueue=i.updateQueue,o=i.dependencies,c.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},c.sibling=i.sibling,c.index=i.index,c.ref=i.ref,c.refCleanup=i.refCleanup,c}function Py(i,o){i.flags&=65011714;var c=i.alternate;return c===null?(i.childLanes=0,i.lanes=o,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=c.childLanes,i.lanes=c.lanes,i.child=c.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=c.memoizedProps,i.memoizedState=c.memoizedState,i.updateQueue=c.updateQueue,i.type=c.type,o=c.dependencies,i.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),i}function gh(i,o,c,h,g,v){var I=0;if(h=i,typeof i=="function")pp(i)&&(I=1);else if(typeof i=="string")I=s3(i,c,Z.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case k:return i=Aa(31,c,o,g),i.elementType=k,i.lanes=v,i;case b:return al(c.children,g,v,o);case w:I=8,g|=24;break;case S:return i=Aa(12,c,o,g|2),i.elementType=S,i.lanes=v,i;case W:return i=Aa(13,c,o,g),i.elementType=W,i.lanes=v,i;case B:return i=Aa(19,c,o,g),i.elementType=B,i.lanes=v,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case M:case F:I=10;break e;case j:I=9;break e;case G:I=11;break e;case A:I=14;break e;case D:I=16,h=null;break e}I=29,c=Error(n(130,i===null?"null":typeof i,"")),h=null}return o=Aa(I,c,o,g),o.elementType=i,o.type=h,o.lanes=v,o}function al(i,o,c,h){return i=Aa(7,i,h,o),i.lanes=c,i}function gp(i,o,c){return i=Aa(6,i,null,o),i.lanes=c,i}function xp(i,o,c){return o=Aa(4,i.children!==null?i.children:[],i.key,o),o.lanes=c,o.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},o}var mc=[],pc=0,xh=null,vh=0,$a=[],Ka=0,il=null,os=1,ls="";function sl(i,o){mc[pc++]=vh,mc[pc++]=xh,xh=i,vh=o}function jy(i,o,c){$a[Ka++]=os,$a[Ka++]=ls,$a[Ka++]=il,il=i;var h=os;i=ls;var g=32-Ve(h)-1;h&=~(1<<g),c+=1;var v=32-Ve(o)+g;if(30<v){var I=g-g%5;v=(h&(1<<I)-1).toString(32),h>>=I,g-=I,os=1<<32-Ve(o)+g|c<<g|h,ls=v+i}else os=1<<v|c<<g|h,ls=i}function vp(i){i.return!==null&&(sl(i,1),jy(i,1,0))}function yp(i){for(;i===xh;)xh=mc[--pc],mc[pc]=null,vh=mc[--pc],mc[pc]=null;for(;i===il;)il=$a[--Ka],$a[Ka]=null,ls=$a[--Ka],$a[Ka]=null,os=$a[--Ka],$a[Ka]=null}var sa=null,Br=null,ir=!1,ol=null,Ii=!1,_p=Error(n(519));function ll(i){var o=Error(n(418,""));throw Gu(Wa(o,i)),_p}function Uy(i){var o=i.stateNode,c=i.type,h=i.memoizedProps;switch(o[bt]=i,o[Ht]=h,c){case"dialog":zt("cancel",o),zt("close",o);break;case"iframe":case"object":case"embed":zt("load",o);break;case"video":case"audio":for(c=0;c<pf.length;c++)zt(pf[c],o);break;case"source":zt("error",o);break;case"img":case"image":case"link":zt("error",o),zt("load",o);break;case"details":zt("toggle",o);break;case"input":zt("invalid",o),Wo(o,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0),Zl(o);break;case"select":zt("invalid",o);break;case"textarea":zt("invalid",o),Xo(o,h.value,h.defaultValue,h.children),Zl(o)}c=h.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||o.textContent===""+c||h.suppressHydrationWarning===!0||rw(o.textContent,c)?(h.popover!=null&&(zt("beforetoggle",o),zt("toggle",o)),h.onScroll!=null&&zt("scroll",o),h.onScrollEnd!=null&&zt("scrollend",o),h.onClick!=null&&(o.onclick=Jh),o=!0):o=!1,o||ll(i)}function By(i){for(sa=i.return;sa;)switch(sa.tag){case 5:case 13:Ii=!1;return;case 27:case 3:Ii=!0;return;default:sa=sa.return}}function zu(i){if(i!==sa)return!1;if(!ir)return By(i),ir=!0,!1;var o=i.tag,c;if((c=o!==3&&o!==27)&&((c=o===5)&&(c=i.type,c=!(c!=="form"&&c!=="button")||Mg(i.type,i.memoizedProps)),c=!c),c&&Br&&ll(i),By(i),o===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(317));e:{for(i=i.nextSibling,o=0;i;){if(i.nodeType===8)if(c=i.data,c==="/$"){if(o===0){Br=hi(i.nextSibling);break e}o--}else c!=="$"&&c!=="$!"&&c!=="$?"||o++;i=i.nextSibling}Br=null}}else o===27?(o=Br,Js(i.type)?(i=Bg,Bg=null,Br=i):Br=o):Br=sa?hi(i.stateNode.nextSibling):null;return!0}function Hu(){Br=sa=null,ir=!1}function Vy(){var i=ol;return i!==null&&(ga===null?ga=i:ga.push.apply(ga,i),ol=null),i}function Gu(i){ol===null?ol=[i]:ol.push(i)}var wp=ge(null),cl=null,cs=null;function Ps(i,o,c){X(wp,o._currentValue),o._currentValue=c}function us(i){i._currentValue=wp.current,V(wp)}function Ep(i,o,c){for(;i!==null;){var h=i.alternate;if((i.childLanes&o)!==o?(i.childLanes|=o,h!==null&&(h.childLanes|=o)):h!==null&&(h.childLanes&o)!==o&&(h.childLanes|=o),i===c)break;i=i.return}}function Tp(i,o,c,h){var g=i.child;for(g!==null&&(g.return=i);g!==null;){var v=g.dependencies;if(v!==null){var I=g.child;v=v.firstContext;e:for(;v!==null;){var U=v;v=g;for(var re=0;re<o.length;re++)if(U.context===o[re]){v.lanes|=c,U=v.alternate,U!==null&&(U.lanes|=c),Ep(v.return,c,i),h||(I=null);break e}v=U.next}}else if(g.tag===18){if(I=g.return,I===null)throw Error(n(341));I.lanes|=c,v=I.alternate,v!==null&&(v.lanes|=c),Ep(I,c,i),I=null}else I=g.child;if(I!==null)I.return=g;else for(I=g;I!==null;){if(I===i){I=null;break}if(g=I.sibling,g!==null){g.return=I.return,I=g;break}I=I.return}g=I}}function qu(i,o,c,h){i=null;for(var g=o,v=!1;g!==null;){if(!v){if((g.flags&524288)!==0)v=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var I=g.alternate;if(I===null)throw Error(n(387));if(I=I.memoizedProps,I!==null){var U=g.type;ka(g.pendingProps.value,I.value)||(i!==null?i.push(U):i=[U])}}else if(g===Se.current){if(I=g.alternate,I===null)throw Error(n(387));I.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(i!==null?i.push(wf):i=[wf])}g=g.return}i!==null&&Tp(o,i,c,h),o.flags|=262144}function yh(i){for(i=i.firstContext;i!==null;){if(!ka(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function ul(i){cl=i,cs=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function zn(i){return zy(cl,i)}function _h(i,o){return cl===null&&ul(i),zy(i,o)}function zy(i,o){var c=o._currentValue;if(o={context:o,memoizedValue:c,next:null},cs===null){if(i===null)throw Error(n(308));cs=o,i.dependencies={lanes:0,firstContext:o},i.flags|=524288}else cs=cs.next=o;return c}var iN=typeof AbortController<"u"?AbortController:function(){var i=[],o=this.signal={aborted:!1,addEventListener:function(c,h){i.push(h)}};this.abort=function(){o.aborted=!0,i.forEach(function(c){return c()})}},sN=t.unstable_scheduleCallback,oN=t.unstable_NormalPriority,mn={$$typeof:F,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function bp(){return{controller:new iN,data:new Map,refCount:0}}function Wu(i){i.refCount--,i.refCount===0&&sN(oN,function(){i.controller.abort()})}var Xu=null,Sp=0,gc=0,xc=null;function lN(i,o){if(Xu===null){var c=Xu=[];Sp=0,gc=Ag(),xc={status:"pending",value:void 0,then:function(h){c.push(h)}}}return Sp++,o.then(Hy,Hy),o}function Hy(){if(--Sp===0&&Xu!==null){xc!==null&&(xc.status="fulfilled");var i=Xu;Xu=null,gc=0,xc=null;for(var o=0;o<i.length;o++)(0,i[o])()}}function cN(i,o){var c=[],h={status:"pending",value:null,reason:null,then:function(g){c.push(g)}};return i.then(function(){h.status="fulfilled",h.value=o;for(var g=0;g<c.length;g++)(0,c[g])(o)},function(g){for(h.status="rejected",h.reason=g,g=0;g<c.length;g++)(0,c[g])(void 0)}),h}var Gy=ne.S;ne.S=function(i,o){typeof o=="object"&&o!==null&&typeof o.then=="function"&&lN(i,o),Gy!==null&&Gy(i,o)};var fl=ge(null);function kp(){var i=fl.current;return i!==null?i:Tr.pooledCache}function wh(i,o){o===null?X(fl,fl.current):X(fl,o.pool)}function qy(){var i=kp();return i===null?null:{parent:mn._currentValue,pool:i}}var $u=Error(n(460)),Wy=Error(n(474)),Eh=Error(n(542)),Ap={then:function(){}};function Xy(i){return i=i.status,i==="fulfilled"||i==="rejected"}function Th(){}function $y(i,o,c){switch(c=i[c],c===void 0?i.push(o):c!==o&&(o.then(Th,Th),o=c),o.status){case"fulfilled":return o.value;case"rejected":throw i=o.reason,Yy(i),i;default:if(typeof o.status=="string")o.then(Th,Th);else{if(i=Tr,i!==null&&100<i.shellSuspendCounter)throw Error(n(482));i=o,i.status="pending",i.then(function(h){if(o.status==="pending"){var g=o;g.status="fulfilled",g.value=h}},function(h){if(o.status==="pending"){var g=o;g.status="rejected",g.reason=h}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw i=o.reason,Yy(i),i}throw Ku=o,$u}}var Ku=null;function Ky(){if(Ku===null)throw Error(n(459));var i=Ku;return Ku=null,i}function Yy(i){if(i===$u||i===Eh)throw Error(n(483))}var js=!1;function Cp(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Np(i,o){i=i.updateQueue,o.updateQueue===i&&(o.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function Us(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function Bs(i,o,c){var h=i.updateQueue;if(h===null)return null;if(h=h.shared,(cr&2)!==0){var g=h.pending;return g===null?o.next=o:(o.next=g.next,g.next=o),h.pending=o,o=ph(i),My(i,null,c),o}return mh(i,h,o,c),ph(i)}function Yu(i,o,c){if(o=o.updateQueue,o!==null&&(o=o.shared,(c&4194048)!==0)){var h=o.lanes;h&=i.pendingLanes,c|=h,o.lanes=c,st(i,c)}}function Ip(i,o){var c=i.updateQueue,h=i.alternate;if(h!==null&&(h=h.updateQueue,c===h)){var g=null,v=null;if(c=c.firstBaseUpdate,c!==null){do{var I={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};v===null?g=v=I:v=v.next=I,c=c.next}while(c!==null);v===null?g=v=o:v=v.next=o}else g=v=o;c={baseState:h.baseState,firstBaseUpdate:g,lastBaseUpdate:v,shared:h.shared,callbacks:h.callbacks},i.updateQueue=c;return}i=c.lastBaseUpdate,i===null?c.firstBaseUpdate=o:i.next=o,c.lastBaseUpdate=o}var Rp=!1;function Qu(){if(Rp){var i=xc;if(i!==null)throw i}}function Ju(i,o,c,h){Rp=!1;var g=i.updateQueue;js=!1;var v=g.firstBaseUpdate,I=g.lastBaseUpdate,U=g.shared.pending;if(U!==null){g.shared.pending=null;var re=U,ve=re.next;re.next=null,I===null?v=ve:I.next=ve,I=re;var Ie=i.alternate;Ie!==null&&(Ie=Ie.updateQueue,U=Ie.lastBaseUpdate,U!==I&&(U===null?Ie.firstBaseUpdate=ve:U.next=ve,Ie.lastBaseUpdate=re))}if(v!==null){var Fe=g.baseState;I=0,Ie=ve=re=null,U=v;do{var we=U.lane&-536870913,Ee=we!==U.lane;if(Ee?(Yt&we)===we:(h&we)===we){we!==0&&we===gc&&(Rp=!0),Ie!==null&&(Ie=Ie.next={lane:0,tag:U.tag,payload:U.payload,callback:null,next:null});e:{var Et=i,pt=U;we=o;var yr=c;switch(pt.tag){case 1:if(Et=pt.payload,typeof Et=="function"){Fe=Et.call(yr,Fe,we);break e}Fe=Et;break e;case 3:Et.flags=Et.flags&-65537|128;case 0:if(Et=pt.payload,we=typeof Et=="function"?Et.call(yr,Fe,we):Et,we==null)break e;Fe=m({},Fe,we);break e;case 2:js=!0}}we=U.callback,we!==null&&(i.flags|=64,Ee&&(i.flags|=8192),Ee=g.callbacks,Ee===null?g.callbacks=[we]:Ee.push(we))}else Ee={lane:we,tag:U.tag,payload:U.payload,callback:U.callback,next:null},Ie===null?(ve=Ie=Ee,re=Fe):Ie=Ie.next=Ee,I|=we;if(U=U.next,U===null){if(U=g.shared.pending,U===null)break;Ee=U,U=Ee.next,Ee.next=null,g.lastBaseUpdate=Ee,g.shared.pending=null}}while(!0);Ie===null&&(re=Fe),g.baseState=re,g.firstBaseUpdate=ve,g.lastBaseUpdate=Ie,v===null&&(g.shared.lanes=0),$s|=I,i.lanes=I,i.memoizedState=Fe}}function Qy(i,o){if(typeof i!="function")throw Error(n(191,i));i.call(o)}function Jy(i,o){var c=i.callbacks;if(c!==null)for(i.callbacks=null,i=0;i<c.length;i++)Qy(c[i],o)}var vc=ge(null),bh=ge(0);function Zy(i,o){i=xs,X(bh,i),X(vc,o),xs=i|o.baseLanes}function Dp(){X(bh,xs),X(vc,vc.current)}function Op(){xs=bh.current,V(vc),V(bh)}var Vs=0,Ft=null,xr=null,rn=null,Sh=!1,yc=!1,hl=!1,kh=0,Zu=0,_c=null,uN=0;function $r(){throw Error(n(321))}function Fp(i,o){if(o===null)return!1;for(var c=0;c<o.length&&c<i.length;c++)if(!ka(i[c],o[c]))return!1;return!0}function Lp(i,o,c,h,g,v){return Vs=v,Ft=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,ne.H=i===null||i.memoizedState===null?M_:P_,hl=!1,v=c(h,g),hl=!1,yc&&(v=t_(o,c,h,g)),e_(i),v}function e_(i){ne.H=Dh;var o=xr!==null&&xr.next!==null;if(Vs=0,rn=xr=Ft=null,Sh=!1,Zu=0,_c=null,o)throw Error(n(300));i===null||bn||(i=i.dependencies,i!==null&&yh(i)&&(bn=!0))}function t_(i,o,c,h){Ft=i;var g=0;do{if(yc&&(_c=null),Zu=0,yc=!1,25<=g)throw Error(n(301));if(g+=1,rn=xr=null,i.updateQueue!=null){var v=i.updateQueue;v.lastEffect=null,v.events=null,v.stores=null,v.memoCache!=null&&(v.memoCache.index=0)}ne.H=xN,v=o(c,h)}while(yc);return v}function fN(){var i=ne.H,o=i.useState()[0];return o=typeof o.then=="function"?ef(o):o,i=i.useState()[0],(xr!==null?xr.memoizedState:null)!==i&&(Ft.flags|=1024),o}function Mp(){var i=kh!==0;return kh=0,i}function Pp(i,o,c){o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~c}function jp(i){if(Sh){for(i=i.memoizedState;i!==null;){var o=i.queue;o!==null&&(o.pending=null),i=i.next}Sh=!1}Vs=0,rn=xr=Ft=null,yc=!1,Zu=kh=0,_c=null}function ma(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return rn===null?Ft.memoizedState=rn=i:rn=rn.next=i,rn}function nn(){if(xr===null){var i=Ft.alternate;i=i!==null?i.memoizedState:null}else i=xr.next;var o=rn===null?Ft.memoizedState:rn.next;if(o!==null)rn=o,xr=i;else{if(i===null)throw Ft.alternate===null?Error(n(467)):Error(n(310));xr=i,i={memoizedState:xr.memoizedState,baseState:xr.baseState,baseQueue:xr.baseQueue,queue:xr.queue,next:null},rn===null?Ft.memoizedState=rn=i:rn=rn.next=i}return rn}function Up(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function ef(i){var o=Zu;return Zu+=1,_c===null&&(_c=[]),i=$y(_c,i,o),o=Ft,(rn===null?o.memoizedState:rn.next)===null&&(o=o.alternate,ne.H=o===null||o.memoizedState===null?M_:P_),i}function Ah(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return ef(i);if(i.$$typeof===F)return zn(i)}throw Error(n(438,String(i)))}function Bp(i){var o=null,c=Ft.updateQueue;if(c!==null&&(o=c.memoCache),o==null){var h=Ft.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(o={data:h.data.map(function(g){return g.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),c===null&&(c=Up(),Ft.updateQueue=c),c.memoCache=o,c=o.data[o.index],c===void 0)for(c=o.data[o.index]=Array(i),h=0;h<i;h++)c[h]=O;return o.index++,c}function fs(i,o){return typeof o=="function"?o(i):o}function Ch(i){var o=nn();return Vp(o,xr,i)}function Vp(i,o,c){var h=i.queue;if(h===null)throw Error(n(311));h.lastRenderedReducer=c;var g=i.baseQueue,v=h.pending;if(v!==null){if(g!==null){var I=g.next;g.next=v.next,v.next=I}o.baseQueue=g=v,h.pending=null}if(v=i.baseState,g===null)i.memoizedState=v;else{o=g.next;var U=I=null,re=null,ve=o,Ie=!1;do{var Fe=ve.lane&-536870913;if(Fe!==ve.lane?(Yt&Fe)===Fe:(Vs&Fe)===Fe){var we=ve.revertLane;if(we===0)re!==null&&(re=re.next={lane:0,revertLane:0,action:ve.action,hasEagerState:ve.hasEagerState,eagerState:ve.eagerState,next:null}),Fe===gc&&(Ie=!0);else if((Vs&we)===we){ve=ve.next,we===gc&&(Ie=!0);continue}else Fe={lane:0,revertLane:ve.revertLane,action:ve.action,hasEagerState:ve.hasEagerState,eagerState:ve.eagerState,next:null},re===null?(U=re=Fe,I=v):re=re.next=Fe,Ft.lanes|=we,$s|=we;Fe=ve.action,hl&&c(v,Fe),v=ve.hasEagerState?ve.eagerState:c(v,Fe)}else we={lane:Fe,revertLane:ve.revertLane,action:ve.action,hasEagerState:ve.hasEagerState,eagerState:ve.eagerState,next:null},re===null?(U=re=we,I=v):re=re.next=we,Ft.lanes|=Fe,$s|=Fe;ve=ve.next}while(ve!==null&&ve!==o);if(re===null?I=v:re.next=U,!ka(v,i.memoizedState)&&(bn=!0,Ie&&(c=xc,c!==null)))throw c;i.memoizedState=v,i.baseState=I,i.baseQueue=re,h.lastRenderedState=v}return g===null&&(h.lanes=0),[i.memoizedState,h.dispatch]}function zp(i){var o=nn(),c=o.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=i;var h=c.dispatch,g=c.pending,v=o.memoizedState;if(g!==null){c.pending=null;var I=g=g.next;do v=i(v,I.action),I=I.next;while(I!==g);ka(v,o.memoizedState)||(bn=!0),o.memoizedState=v,o.baseQueue===null&&(o.baseState=v),c.lastRenderedState=v}return[v,h]}function r_(i,o,c){var h=Ft,g=nn(),v=ir;if(v){if(c===void 0)throw Error(n(407));c=c()}else c=o();var I=!ka((xr||g).memoizedState,c);I&&(g.memoizedState=c,bn=!0),g=g.queue;var U=i_.bind(null,h,g,i);if(tf(2048,8,U,[i]),g.getSnapshot!==o||I||rn!==null&&rn.memoizedState.tag&1){if(h.flags|=2048,wc(9,Nh(),a_.bind(null,h,g,c,o),null),Tr===null)throw Error(n(349));v||(Vs&124)!==0||n_(h,o,c)}return c}function n_(i,o,c){i.flags|=16384,i={getSnapshot:o,value:c},o=Ft.updateQueue,o===null?(o=Up(),Ft.updateQueue=o,o.stores=[i]):(c=o.stores,c===null?o.stores=[i]:c.push(i))}function a_(i,o,c,h){o.value=c,o.getSnapshot=h,s_(o)&&o_(i)}function i_(i,o,c){return c(function(){s_(o)&&o_(i)})}function s_(i){var o=i.getSnapshot;i=i.value;try{var c=o();return!ka(i,c)}catch{return!0}}function o_(i){var o=hc(i,2);o!==null&&Da(o,i,2)}function Hp(i){var o=ma();if(typeof i=="function"){var c=i;if(i=c(),hl){ze(!0);try{c()}finally{ze(!1)}}}return o.memoizedState=o.baseState=i,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:fs,lastRenderedState:i},o}function l_(i,o,c,h){return i.baseState=c,Vp(i,xr,typeof h=="function"?h:fs)}function hN(i,o,c,h,g){if(Rh(i))throw Error(n(485));if(i=o.action,i!==null){var v={payload:g,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(I){v.listeners.push(I)}};ne.T!==null?c(!0):v.isTransition=!1,h(v),c=o.pending,c===null?(v.next=o.pending=v,c_(o,v)):(v.next=c.next,o.pending=c.next=v)}}function c_(i,o){var c=o.action,h=o.payload,g=i.state;if(o.isTransition){var v=ne.T,I={};ne.T=I;try{var U=c(g,h),re=ne.S;re!==null&&re(I,U),u_(i,o,U)}catch(ve){Gp(i,o,ve)}finally{ne.T=v}}else try{v=c(g,h),u_(i,o,v)}catch(ve){Gp(i,o,ve)}}function u_(i,o,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(h){f_(i,o,h)},function(h){return Gp(i,o,h)}):f_(i,o,c)}function f_(i,o,c){o.status="fulfilled",o.value=c,h_(o),i.state=c,o=i.pending,o!==null&&(c=o.next,c===o?i.pending=null:(c=c.next,o.next=c,c_(i,c)))}function Gp(i,o,c){var h=i.pending;if(i.pending=null,h!==null){h=h.next;do o.status="rejected",o.reason=c,h_(o),o=o.next;while(o!==h)}i.action=null}function h_(i){i=i.listeners;for(var o=0;o<i.length;o++)(0,i[o])()}function d_(i,o){return o}function m_(i,o){if(ir){var c=Tr.formState;if(c!==null){e:{var h=Ft;if(ir){if(Br){t:{for(var g=Br,v=Ii;g.nodeType!==8;){if(!v){g=null;break t}if(g=hi(g.nextSibling),g===null){g=null;break t}}v=g.data,g=v==="F!"||v==="F"?g:null}if(g){Br=hi(g.nextSibling),h=g.data==="F!";break e}}ll(h)}h=!1}h&&(o=c[0])}}return c=ma(),c.memoizedState=c.baseState=o,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:d_,lastRenderedState:o},c.queue=h,c=O_.bind(null,Ft,h),h.dispatch=c,h=Hp(!1),v=Kp.bind(null,Ft,!1,h.queue),h=ma(),g={state:o,dispatch:null,action:i,pending:null},h.queue=g,c=hN.bind(null,Ft,g,v,c),g.dispatch=c,h.memoizedState=i,[o,c,!1]}function p_(i){var o=nn();return g_(o,xr,i)}function g_(i,o,c){if(o=Vp(i,o,d_)[0],i=Ch(fs)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var h=ef(o)}catch(I){throw I===$u?Eh:I}else h=o;o=nn();var g=o.queue,v=g.dispatch;return c!==o.memoizedState&&(Ft.flags|=2048,wc(9,Nh(),dN.bind(null,g,c),null)),[h,v,i]}function dN(i,o){i.action=o}function x_(i){var o=nn(),c=xr;if(c!==null)return g_(o,c,i);nn(),o=o.memoizedState,c=nn();var h=c.queue.dispatch;return c.memoizedState=i,[o,h,!1]}function wc(i,o,c,h){return i={tag:i,create:c,deps:h,inst:o,next:null},o=Ft.updateQueue,o===null&&(o=Up(),Ft.updateQueue=o),c=o.lastEffect,c===null?o.lastEffect=i.next=i:(h=c.next,c.next=i,i.next=h,o.lastEffect=i),i}function Nh(){return{destroy:void 0,resource:void 0}}function v_(){return nn().memoizedState}function Ih(i,o,c,h){var g=ma();h=h===void 0?null:h,Ft.flags|=i,g.memoizedState=wc(1|o,Nh(),c,h)}function tf(i,o,c,h){var g=nn();h=h===void 0?null:h;var v=g.memoizedState.inst;xr!==null&&h!==null&&Fp(h,xr.memoizedState.deps)?g.memoizedState=wc(o,v,c,h):(Ft.flags|=i,g.memoizedState=wc(1|o,v,c,h))}function y_(i,o){Ih(8390656,8,i,o)}function __(i,o){tf(2048,8,i,o)}function w_(i,o){return tf(4,2,i,o)}function E_(i,o){return tf(4,4,i,o)}function T_(i,o){if(typeof o=="function"){i=i();var c=o(i);return function(){typeof c=="function"?c():o(null)}}if(o!=null)return i=i(),o.current=i,function(){o.current=null}}function b_(i,o,c){c=c!=null?c.concat([i]):null,tf(4,4,T_.bind(null,o,i),c)}function qp(){}function S_(i,o){var c=nn();o=o===void 0?null:o;var h=c.memoizedState;return o!==null&&Fp(o,h[1])?h[0]:(c.memoizedState=[i,o],i)}function k_(i,o){var c=nn();o=o===void 0?null:o;var h=c.memoizedState;if(o!==null&&Fp(o,h[1]))return h[0];if(h=i(),hl){ze(!0);try{i()}finally{ze(!1)}}return c.memoizedState=[h,o],h}function Wp(i,o,c){return c===void 0||(Vs&1073741824)!==0?i.memoizedState=o:(i.memoizedState=c,i=N2(),Ft.lanes|=i,$s|=i,c)}function A_(i,o,c,h){return ka(c,o)?c:vc.current!==null?(i=Wp(i,c,h),ka(i,o)||(bn=!0),i):(Vs&42)===0?(bn=!0,i.memoizedState=c):(i=N2(),Ft.lanes|=i,$s|=i,o)}function C_(i,o,c,h,g){var v=le.p;le.p=v!==0&&8>v?v:8;var I=ne.T,U={};ne.T=U,Kp(i,!1,o,c);try{var re=g(),ve=ne.S;if(ve!==null&&ve(U,re),re!==null&&typeof re=="object"&&typeof re.then=="function"){var Ie=cN(re,h);rf(i,o,Ie,Ra(i))}else rf(i,o,h,Ra(i))}catch(Fe){rf(i,o,{then:function(){},status:"rejected",reason:Fe},Ra())}finally{le.p=v,ne.T=I}}function mN(){}function Xp(i,o,c,h){if(i.tag!==5)throw Error(n(476));var g=N_(i).queue;C_(i,g,o,He,c===null?mN:function(){return I_(i),c(h)})}function N_(i){var o=i.memoizedState;if(o!==null)return o;o={memoizedState:He,baseState:He,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:fs,lastRenderedState:He},next:null};var c={};return o.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:fs,lastRenderedState:c},next:null},i.memoizedState=o,i=i.alternate,i!==null&&(i.memoizedState=o),o}function I_(i){var o=N_(i).next.queue;rf(i,o,{},Ra())}function $p(){return zn(wf)}function R_(){return nn().memoizedState}function D_(){return nn().memoizedState}function pN(i){for(var o=i.return;o!==null;){switch(o.tag){case 24:case 3:var c=Ra();i=Us(c);var h=Bs(o,i,c);h!==null&&(Da(h,o,c),Yu(h,o,c)),o={cache:bp()},i.payload=o;return}o=o.return}}function gN(i,o,c){var h=Ra();c={lane:h,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null},Rh(i)?F_(o,c):(c=mp(i,o,c,h),c!==null&&(Da(c,i,h),L_(c,o,h)))}function O_(i,o,c){var h=Ra();rf(i,o,c,h)}function rf(i,o,c,h){var g={lane:h,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null};if(Rh(i))F_(o,g);else{var v=i.alternate;if(i.lanes===0&&(v===null||v.lanes===0)&&(v=o.lastRenderedReducer,v!==null))try{var I=o.lastRenderedState,U=v(I,c);if(g.hasEagerState=!0,g.eagerState=U,ka(U,I))return mh(i,o,g,0),Tr===null&&dh(),!1}catch{}finally{}if(c=mp(i,o,g,h),c!==null)return Da(c,i,h),L_(c,o,h),!0}return!1}function Kp(i,o,c,h){if(h={lane:2,revertLane:Ag(),action:h,hasEagerState:!1,eagerState:null,next:null},Rh(i)){if(o)throw Error(n(479))}else o=mp(i,c,h,2),o!==null&&Da(o,i,2)}function Rh(i){var o=i.alternate;return i===Ft||o!==null&&o===Ft}function F_(i,o){yc=Sh=!0;var c=i.pending;c===null?o.next=o:(o.next=c.next,c.next=o),i.pending=o}function L_(i,o,c){if((c&4194048)!==0){var h=o.lanes;h&=i.pendingLanes,c|=h,o.lanes=c,st(i,c)}}var Dh={readContext:zn,use:Ah,useCallback:$r,useContext:$r,useEffect:$r,useImperativeHandle:$r,useLayoutEffect:$r,useInsertionEffect:$r,useMemo:$r,useReducer:$r,useRef:$r,useState:$r,useDebugValue:$r,useDeferredValue:$r,useTransition:$r,useSyncExternalStore:$r,useId:$r,useHostTransitionStatus:$r,useFormState:$r,useActionState:$r,useOptimistic:$r,useMemoCache:$r,useCacheRefresh:$r},M_={readContext:zn,use:Ah,useCallback:function(i,o){return ma().memoizedState=[i,o===void 0?null:o],i},useContext:zn,useEffect:y_,useImperativeHandle:function(i,o,c){c=c!=null?c.concat([i]):null,Ih(4194308,4,T_.bind(null,o,i),c)},useLayoutEffect:function(i,o){return Ih(4194308,4,i,o)},useInsertionEffect:function(i,o){Ih(4,2,i,o)},useMemo:function(i,o){var c=ma();o=o===void 0?null:o;var h=i();if(hl){ze(!0);try{i()}finally{ze(!1)}}return c.memoizedState=[h,o],h},useReducer:function(i,o,c){var h=ma();if(c!==void 0){var g=c(o);if(hl){ze(!0);try{c(o)}finally{ze(!1)}}}else g=o;return h.memoizedState=h.baseState=g,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:g},h.queue=i,i=i.dispatch=gN.bind(null,Ft,i),[h.memoizedState,i]},useRef:function(i){var o=ma();return i={current:i},o.memoizedState=i},useState:function(i){i=Hp(i);var o=i.queue,c=O_.bind(null,Ft,o);return o.dispatch=c,[i.memoizedState,c]},useDebugValue:qp,useDeferredValue:function(i,o){var c=ma();return Wp(c,i,o)},useTransition:function(){var i=Hp(!1);return i=C_.bind(null,Ft,i.queue,!0,!1),ma().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,o,c){var h=Ft,g=ma();if(ir){if(c===void 0)throw Error(n(407));c=c()}else{if(c=o(),Tr===null)throw Error(n(349));(Yt&124)!==0||n_(h,o,c)}g.memoizedState=c;var v={value:c,getSnapshot:o};return g.queue=v,y_(i_.bind(null,h,v,i),[i]),h.flags|=2048,wc(9,Nh(),a_.bind(null,h,v,c,o),null),c},useId:function(){var i=ma(),o=Tr.identifierPrefix;if(ir){var c=ls,h=os;c=(h&~(1<<32-Ve(h)-1)).toString(32)+c,o=""+o+"R"+c,c=kh++,0<c&&(o+="H"+c.toString(32)),o+=""}else c=uN++,o=""+o+"r"+c.toString(32)+"";return i.memoizedState=o},useHostTransitionStatus:$p,useFormState:m_,useActionState:m_,useOptimistic:function(i){var o=ma();o.memoizedState=o.baseState=i;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=c,o=Kp.bind(null,Ft,!0,c),c.dispatch=o,[i,o]},useMemoCache:Bp,useCacheRefresh:function(){return ma().memoizedState=pN.bind(null,Ft)}},P_={readContext:zn,use:Ah,useCallback:S_,useContext:zn,useEffect:__,useImperativeHandle:b_,useInsertionEffect:w_,useLayoutEffect:E_,useMemo:k_,useReducer:Ch,useRef:v_,useState:function(){return Ch(fs)},useDebugValue:qp,useDeferredValue:function(i,o){var c=nn();return A_(c,xr.memoizedState,i,o)},useTransition:function(){var i=Ch(fs)[0],o=nn().memoizedState;return[typeof i=="boolean"?i:ef(i),o]},useSyncExternalStore:r_,useId:R_,useHostTransitionStatus:$p,useFormState:p_,useActionState:p_,useOptimistic:function(i,o){var c=nn();return l_(c,xr,i,o)},useMemoCache:Bp,useCacheRefresh:D_},xN={readContext:zn,use:Ah,useCallback:S_,useContext:zn,useEffect:__,useImperativeHandle:b_,useInsertionEffect:w_,useLayoutEffect:E_,useMemo:k_,useReducer:zp,useRef:v_,useState:function(){return zp(fs)},useDebugValue:qp,useDeferredValue:function(i,o){var c=nn();return xr===null?Wp(c,i,o):A_(c,xr.memoizedState,i,o)},useTransition:function(){var i=zp(fs)[0],o=nn().memoizedState;return[typeof i=="boolean"?i:ef(i),o]},useSyncExternalStore:r_,useId:R_,useHostTransitionStatus:$p,useFormState:x_,useActionState:x_,useOptimistic:function(i,o){var c=nn();return xr!==null?l_(c,xr,i,o):(c.baseState=i,[i,c.queue.dispatch])},useMemoCache:Bp,useCacheRefresh:D_},Ec=null,nf=0;function Oh(i){var o=nf;return nf+=1,Ec===null&&(Ec=[]),$y(Ec,i,o)}function af(i,o){o=o.props.ref,i.ref=o!==void 0?o:null}function Fh(i,o){throw o.$$typeof===y?Error(n(525)):(i=Object.prototype.toString.call(o),Error(n(31,i==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":i)))}function j_(i){var o=i._init;return o(i._payload)}function U_(i){function o(ue,ae){if(i){var pe=ue.deletions;pe===null?(ue.deletions=[ae],ue.flags|=16):pe.push(ae)}}function c(ue,ae){if(!i)return null;for(;ae!==null;)o(ue,ae),ae=ae.sibling;return null}function h(ue){for(var ae=new Map;ue!==null;)ue.key!==null?ae.set(ue.key,ue):ae.set(ue.index,ue),ue=ue.sibling;return ae}function g(ue,ae){return ue=ss(ue,ae),ue.index=0,ue.sibling=null,ue}function v(ue,ae,pe){return ue.index=pe,i?(pe=ue.alternate,pe!==null?(pe=pe.index,pe<ae?(ue.flags|=67108866,ae):pe):(ue.flags|=67108866,ae)):(ue.flags|=1048576,ae)}function I(ue){return i&&ue.alternate===null&&(ue.flags|=67108866),ue}function U(ue,ae,pe,Re){return ae===null||ae.tag!==6?(ae=gp(pe,ue.mode,Re),ae.return=ue,ae):(ae=g(ae,pe),ae.return=ue,ae)}function re(ue,ae,pe,Re){var it=pe.type;return it===b?Ie(ue,ae,pe.props.children,Re,pe.key):ae!==null&&(ae.elementType===it||typeof it=="object"&&it!==null&&it.$$typeof===D&&j_(it)===ae.type)?(ae=g(ae,pe.props),af(ae,pe),ae.return=ue,ae):(ae=gh(pe.type,pe.key,pe.props,null,ue.mode,Re),af(ae,pe),ae.return=ue,ae)}function ve(ue,ae,pe,Re){return ae===null||ae.tag!==4||ae.stateNode.containerInfo!==pe.containerInfo||ae.stateNode.implementation!==pe.implementation?(ae=xp(pe,ue.mode,Re),ae.return=ue,ae):(ae=g(ae,pe.children||[]),ae.return=ue,ae)}function Ie(ue,ae,pe,Re,it){return ae===null||ae.tag!==7?(ae=al(pe,ue.mode,Re,it),ae.return=ue,ae):(ae=g(ae,pe),ae.return=ue,ae)}function Fe(ue,ae,pe){if(typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint")return ae=gp(""+ae,ue.mode,pe),ae.return=ue,ae;if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case _:return pe=gh(ae.type,ae.key,ae.props,null,ue.mode,pe),af(pe,ae),pe.return=ue,pe;case E:return ae=xp(ae,ue.mode,pe),ae.return=ue,ae;case D:var Re=ae._init;return ae=Re(ae._payload),Fe(ue,ae,pe)}if(xe(ae)||N(ae))return ae=al(ae,ue.mode,pe,null),ae.return=ue,ae;if(typeof ae.then=="function")return Fe(ue,Oh(ae),pe);if(ae.$$typeof===F)return Fe(ue,_h(ue,ae),pe);Fh(ue,ae)}return null}function we(ue,ae,pe,Re){var it=ae!==null?ae.key:null;if(typeof pe=="string"&&pe!==""||typeof pe=="number"||typeof pe=="bigint")return it!==null?null:U(ue,ae,""+pe,Re);if(typeof pe=="object"&&pe!==null){switch(pe.$$typeof){case _:return pe.key===it?re(ue,ae,pe,Re):null;case E:return pe.key===it?ve(ue,ae,pe,Re):null;case D:return it=pe._init,pe=it(pe._payload),we(ue,ae,pe,Re)}if(xe(pe)||N(pe))return it!==null?null:Ie(ue,ae,pe,Re,null);if(typeof pe.then=="function")return we(ue,ae,Oh(pe),Re);if(pe.$$typeof===F)return we(ue,ae,_h(ue,pe),Re);Fh(ue,pe)}return null}function Ee(ue,ae,pe,Re,it){if(typeof Re=="string"&&Re!==""||typeof Re=="number"||typeof Re=="bigint")return ue=ue.get(pe)||null,U(ae,ue,""+Re,it);if(typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case _:return ue=ue.get(Re.key===null?pe:Re.key)||null,re(ae,ue,Re,it);case E:return ue=ue.get(Re.key===null?pe:Re.key)||null,ve(ae,ue,Re,it);case D:var Ut=Re._init;return Re=Ut(Re._payload),Ee(ue,ae,pe,Re,it)}if(xe(Re)||N(Re))return ue=ue.get(pe)||null,Ie(ae,ue,Re,it,null);if(typeof Re.then=="function")return Ee(ue,ae,pe,Oh(Re),it);if(Re.$$typeof===F)return Ee(ue,ae,pe,_h(ae,Re),it);Fh(ae,Re)}return null}function Et(ue,ae,pe,Re){for(var it=null,Ut=null,ut=ae,gt=ae=0,kn=null;ut!==null&&gt<pe.length;gt++){ut.index>gt?(kn=ut,ut=null):kn=ut.sibling;var nr=we(ue,ut,pe[gt],Re);if(nr===null){ut===null&&(ut=kn);break}i&&ut&&nr.alternate===null&&o(ue,ut),ae=v(nr,ae,gt),Ut===null?it=nr:Ut.sibling=nr,Ut=nr,ut=kn}if(gt===pe.length)return c(ue,ut),ir&&sl(ue,gt),it;if(ut===null){for(;gt<pe.length;gt++)ut=Fe(ue,pe[gt],Re),ut!==null&&(ae=v(ut,ae,gt),Ut===null?it=ut:Ut.sibling=ut,Ut=ut);return ir&&sl(ue,gt),it}for(ut=h(ut);gt<pe.length;gt++)kn=Ee(ut,ue,gt,pe[gt],Re),kn!==null&&(i&&kn.alternate!==null&&ut.delete(kn.key===null?gt:kn.key),ae=v(kn,ae,gt),Ut===null?it=kn:Ut.sibling=kn,Ut=kn);return i&&ut.forEach(function(no){return o(ue,no)}),ir&&sl(ue,gt),it}function pt(ue,ae,pe,Re){if(pe==null)throw Error(n(151));for(var it=null,Ut=null,ut=ae,gt=ae=0,kn=null,nr=pe.next();ut!==null&&!nr.done;gt++,nr=pe.next()){ut.index>gt?(kn=ut,ut=null):kn=ut.sibling;var no=we(ue,ut,nr.value,Re);if(no===null){ut===null&&(ut=kn);break}i&&ut&&no.alternate===null&&o(ue,ut),ae=v(no,ae,gt),Ut===null?it=no:Ut.sibling=no,Ut=no,ut=kn}if(nr.done)return c(ue,ut),ir&&sl(ue,gt),it;if(ut===null){for(;!nr.done;gt++,nr=pe.next())nr=Fe(ue,nr.value,Re),nr!==null&&(ae=v(nr,ae,gt),Ut===null?it=nr:Ut.sibling=nr,Ut=nr);return ir&&sl(ue,gt),it}for(ut=h(ut);!nr.done;gt++,nr=pe.next())nr=Ee(ut,ue,gt,nr.value,Re),nr!==null&&(i&&nr.alternate!==null&&ut.delete(nr.key===null?gt:nr.key),ae=v(nr,ae,gt),Ut===null?it=nr:Ut.sibling=nr,Ut=nr);return i&&ut.forEach(function(v3){return o(ue,v3)}),ir&&sl(ue,gt),it}function yr(ue,ae,pe,Re){if(typeof pe=="object"&&pe!==null&&pe.type===b&&pe.key===null&&(pe=pe.props.children),typeof pe=="object"&&pe!==null){switch(pe.$$typeof){case _:e:{for(var it=pe.key;ae!==null;){if(ae.key===it){if(it=pe.type,it===b){if(ae.tag===7){c(ue,ae.sibling),Re=g(ae,pe.props.children),Re.return=ue,ue=Re;break e}}else if(ae.elementType===it||typeof it=="object"&&it!==null&&it.$$typeof===D&&j_(it)===ae.type){c(ue,ae.sibling),Re=g(ae,pe.props),af(Re,pe),Re.return=ue,ue=Re;break e}c(ue,ae);break}else o(ue,ae);ae=ae.sibling}pe.type===b?(Re=al(pe.props.children,ue.mode,Re,pe.key),Re.return=ue,ue=Re):(Re=gh(pe.type,pe.key,pe.props,null,ue.mode,Re),af(Re,pe),Re.return=ue,ue=Re)}return I(ue);case E:e:{for(it=pe.key;ae!==null;){if(ae.key===it)if(ae.tag===4&&ae.stateNode.containerInfo===pe.containerInfo&&ae.stateNode.implementation===pe.implementation){c(ue,ae.sibling),Re=g(ae,pe.children||[]),Re.return=ue,ue=Re;break e}else{c(ue,ae);break}else o(ue,ae);ae=ae.sibling}Re=xp(pe,ue.mode,Re),Re.return=ue,ue=Re}return I(ue);case D:return it=pe._init,pe=it(pe._payload),yr(ue,ae,pe,Re)}if(xe(pe))return Et(ue,ae,pe,Re);if(N(pe)){if(it=N(pe),typeof it!="function")throw Error(n(150));return pe=it.call(pe),pt(ue,ae,pe,Re)}if(typeof pe.then=="function")return yr(ue,ae,Oh(pe),Re);if(pe.$$typeof===F)return yr(ue,ae,_h(ue,pe),Re);Fh(ue,pe)}return typeof pe=="string"&&pe!==""||typeof pe=="number"||typeof pe=="bigint"?(pe=""+pe,ae!==null&&ae.tag===6?(c(ue,ae.sibling),Re=g(ae,pe),Re.return=ue,ue=Re):(c(ue,ae),Re=gp(pe,ue.mode,Re),Re.return=ue,ue=Re),I(ue)):c(ue,ae)}return function(ue,ae,pe,Re){try{nf=0;var it=yr(ue,ae,pe,Re);return Ec=null,it}catch(ut){if(ut===$u||ut===Eh)throw ut;var Ut=Aa(29,ut,null,ue.mode);return Ut.lanes=Re,Ut.return=ue,Ut}finally{}}}var Tc=U_(!0),B_=U_(!1),Ya=ge(null),Ri=null;function zs(i){var o=i.alternate;X(pn,pn.current&1),X(Ya,i),Ri===null&&(o===null||vc.current!==null||o.memoizedState!==null)&&(Ri=i)}function V_(i){if(i.tag===22){if(X(pn,pn.current),X(Ya,i),Ri===null){var o=i.alternate;o!==null&&o.memoizedState!==null&&(Ri=i)}}else Hs()}function Hs(){X(pn,pn.current),X(Ya,Ya.current)}function hs(i){V(Ya),Ri===i&&(Ri=null),V(pn)}var pn=ge(0);function Lh(i){for(var o=i;o!==null;){if(o.tag===13){var c=o.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||Ug(c)))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}function Yp(i,o,c,h){o=i.memoizedState,c=c(h,o),c=c==null?o:m({},o,c),i.memoizedState=c,i.lanes===0&&(i.updateQueue.baseState=c)}var Qp={enqueueSetState:function(i,o,c){i=i._reactInternals;var h=Ra(),g=Us(h);g.payload=o,c!=null&&(g.callback=c),o=Bs(i,g,h),o!==null&&(Da(o,i,h),Yu(o,i,h))},enqueueReplaceState:function(i,o,c){i=i._reactInternals;var h=Ra(),g=Us(h);g.tag=1,g.payload=o,c!=null&&(g.callback=c),o=Bs(i,g,h),o!==null&&(Da(o,i,h),Yu(o,i,h))},enqueueForceUpdate:function(i,o){i=i._reactInternals;var c=Ra(),h=Us(c);h.tag=2,o!=null&&(h.callback=o),o=Bs(i,h,c),o!==null&&(Da(o,i,c),Yu(o,i,c))}};function z_(i,o,c,h,g,v,I){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(h,v,I):o.prototype&&o.prototype.isPureReactComponent?!Bu(c,h)||!Bu(g,v):!0}function H_(i,o,c,h){i=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(c,h),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(c,h),o.state!==i&&Qp.enqueueReplaceState(o,o.state,null)}function dl(i,o){var c=o;if("ref"in o){c={};for(var h in o)h!=="ref"&&(c[h]=o[h])}if(i=i.defaultProps){c===o&&(c=m({},c));for(var g in i)c[g]===void 0&&(c[g]=i[g])}return c}var Mh=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)};function G_(i){Mh(i)}function q_(i){console.error(i)}function W_(i){Mh(i)}function Ph(i,o){try{var c=i.onUncaughtError;c(o.value,{componentStack:o.stack})}catch(h){setTimeout(function(){throw h})}}function X_(i,o,c){try{var h=i.onCaughtError;h(c.value,{componentStack:c.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function Jp(i,o,c){return c=Us(c),c.tag=3,c.payload={element:null},c.callback=function(){Ph(i,o)},c}function $_(i){return i=Us(i),i.tag=3,i}function K_(i,o,c,h){var g=c.type.getDerivedStateFromError;if(typeof g=="function"){var v=h.value;i.payload=function(){return g(v)},i.callback=function(){X_(o,c,h)}}var I=c.stateNode;I!==null&&typeof I.componentDidCatch=="function"&&(i.callback=function(){X_(o,c,h),typeof g!="function"&&(Ks===null?Ks=new Set([this]):Ks.add(this));var U=h.stack;this.componentDidCatch(h.value,{componentStack:U!==null?U:""})})}function vN(i,o,c,h,g){if(c.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(o=c.alternate,o!==null&&qu(o,c,g,!0),c=Ya.current,c!==null){switch(c.tag){case 13:return Ri===null?Eg():c.alternate===null&&Vr===0&&(Vr=3),c.flags&=-257,c.flags|=65536,c.lanes=g,h===Ap?c.flags|=16384:(o=c.updateQueue,o===null?c.updateQueue=new Set([h]):o.add(h),bg(i,h,g)),!1;case 22:return c.flags|=65536,h===Ap?c.flags|=16384:(o=c.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([h])},c.updateQueue=o):(c=o.retryQueue,c===null?o.retryQueue=new Set([h]):c.add(h)),bg(i,h,g)),!1}throw Error(n(435,c.tag))}return bg(i,h,g),Eg(),!1}if(ir)return o=Ya.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=g,h!==_p&&(i=Error(n(422),{cause:h}),Gu(Wa(i,c)))):(h!==_p&&(o=Error(n(423),{cause:h}),Gu(Wa(o,c))),i=i.current.alternate,i.flags|=65536,g&=-g,i.lanes|=g,h=Wa(h,c),g=Jp(i.stateNode,h,g),Ip(i,g),Vr!==4&&(Vr=2)),!1;var v=Error(n(520),{cause:h});if(v=Wa(v,c),hf===null?hf=[v]:hf.push(v),Vr!==4&&(Vr=2),o===null)return!0;h=Wa(h,c),c=o;do{switch(c.tag){case 3:return c.flags|=65536,i=g&-g,c.lanes|=i,i=Jp(c.stateNode,h,i),Ip(c,i),!1;case 1:if(o=c.type,v=c.stateNode,(c.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(Ks===null||!Ks.has(v))))return c.flags|=65536,g&=-g,c.lanes|=g,g=$_(g),K_(g,i,c,h),Ip(c,g),!1}c=c.return}while(c!==null);return!1}var Y_=Error(n(461)),bn=!1;function On(i,o,c,h){o.child=i===null?B_(o,null,c,h):Tc(o,i.child,c,h)}function Q_(i,o,c,h,g){c=c.render;var v=o.ref;if("ref"in h){var I={};for(var U in h)U!=="ref"&&(I[U]=h[U])}else I=h;return ul(o),h=Lp(i,o,c,I,v,g),U=Mp(),i!==null&&!bn?(Pp(i,o,g),ds(i,o,g)):(ir&&U&&vp(o),o.flags|=1,On(i,o,h,g),o.child)}function J_(i,o,c,h,g){if(i===null){var v=c.type;return typeof v=="function"&&!pp(v)&&v.defaultProps===void 0&&c.compare===null?(o.tag=15,o.type=v,Z_(i,o,v,h,g)):(i=gh(c.type,null,h,o,o.mode,g),i.ref=o.ref,i.return=o,o.child=i)}if(v=i.child,!sg(i,g)){var I=v.memoizedProps;if(c=c.compare,c=c!==null?c:Bu,c(I,h)&&i.ref===o.ref)return ds(i,o,g)}return o.flags|=1,i=ss(v,h),i.ref=o.ref,i.return=o,o.child=i}function Z_(i,o,c,h,g){if(i!==null){var v=i.memoizedProps;if(Bu(v,h)&&i.ref===o.ref)if(bn=!1,o.pendingProps=h=v,sg(i,g))(i.flags&131072)!==0&&(bn=!0);else return o.lanes=i.lanes,ds(i,o,g)}return Zp(i,o,c,h,g)}function e2(i,o,c){var h=o.pendingProps,g=h.children,v=i!==null?i.memoizedState:null;if(h.mode==="hidden"){if((o.flags&128)!==0){if(h=v!==null?v.baseLanes|c:c,i!==null){for(g=o.child=i.child,v=0;g!==null;)v=v|g.lanes|g.childLanes,g=g.sibling;o.childLanes=v&~h}else o.childLanes=0,o.child=null;return t2(i,o,h,c)}if((c&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},i!==null&&wh(o,v!==null?v.cachePool:null),v!==null?Zy(o,v):Dp(),V_(o);else return o.lanes=o.childLanes=536870912,t2(i,o,v!==null?v.baseLanes|c:c,c)}else v!==null?(wh(o,v.cachePool),Zy(o,v),Hs(),o.memoizedState=null):(i!==null&&wh(o,null),Dp(),Hs());return On(i,o,g,c),o.child}function t2(i,o,c,h){var g=kp();return g=g===null?null:{parent:mn._currentValue,pool:g},o.memoizedState={baseLanes:c,cachePool:g},i!==null&&wh(o,null),Dp(),V_(o),i!==null&&qu(i,o,h,!0),null}function jh(i,o){var c=o.ref;if(c===null)i!==null&&i.ref!==null&&(o.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(n(284));(i===null||i.ref!==c)&&(o.flags|=4194816)}}function Zp(i,o,c,h,g){return ul(o),c=Lp(i,o,c,h,void 0,g),h=Mp(),i!==null&&!bn?(Pp(i,o,g),ds(i,o,g)):(ir&&h&&vp(o),o.flags|=1,On(i,o,c,g),o.child)}function r2(i,o,c,h,g,v){return ul(o),o.updateQueue=null,c=t_(o,h,c,g),e_(i),h=Mp(),i!==null&&!bn?(Pp(i,o,v),ds(i,o,v)):(ir&&h&&vp(o),o.flags|=1,On(i,o,c,v),o.child)}function n2(i,o,c,h,g){if(ul(o),o.stateNode===null){var v=dc,I=c.contextType;typeof I=="object"&&I!==null&&(v=zn(I)),v=new c(h,v),o.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,v.updater=Qp,o.stateNode=v,v._reactInternals=o,v=o.stateNode,v.props=h,v.state=o.memoizedState,v.refs={},Cp(o),I=c.contextType,v.context=typeof I=="object"&&I!==null?zn(I):dc,v.state=o.memoizedState,I=c.getDerivedStateFromProps,typeof I=="function"&&(Yp(o,c,I,h),v.state=o.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(I=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),I!==v.state&&Qp.enqueueReplaceState(v,v.state,null),Ju(o,h,v,g),Qu(),v.state=o.memoizedState),typeof v.componentDidMount=="function"&&(o.flags|=4194308),h=!0}else if(i===null){v=o.stateNode;var U=o.memoizedProps,re=dl(c,U);v.props=re;var ve=v.context,Ie=c.contextType;I=dc,typeof Ie=="object"&&Ie!==null&&(I=zn(Ie));var Fe=c.getDerivedStateFromProps;Ie=typeof Fe=="function"||typeof v.getSnapshotBeforeUpdate=="function",U=o.pendingProps!==U,Ie||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(U||ve!==I)&&H_(o,v,h,I),js=!1;var we=o.memoizedState;v.state=we,Ju(o,h,v,g),Qu(),ve=o.memoizedState,U||we!==ve||js?(typeof Fe=="function"&&(Yp(o,c,Fe,h),ve=o.memoizedState),(re=js||z_(o,c,re,h,we,ve,I))?(Ie||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(o.flags|=4194308)):(typeof v.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=h,o.memoizedState=ve),v.props=h,v.state=ve,v.context=I,h=re):(typeof v.componentDidMount=="function"&&(o.flags|=4194308),h=!1)}else{v=o.stateNode,Np(i,o),I=o.memoizedProps,Ie=dl(c,I),v.props=Ie,Fe=o.pendingProps,we=v.context,ve=c.contextType,re=dc,typeof ve=="object"&&ve!==null&&(re=zn(ve)),U=c.getDerivedStateFromProps,(ve=typeof U=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(I!==Fe||we!==re)&&H_(o,v,h,re),js=!1,we=o.memoizedState,v.state=we,Ju(o,h,v,g),Qu();var Ee=o.memoizedState;I!==Fe||we!==Ee||js||i!==null&&i.dependencies!==null&&yh(i.dependencies)?(typeof U=="function"&&(Yp(o,c,U,h),Ee=o.memoizedState),(Ie=js||z_(o,c,Ie,h,we,Ee,re)||i!==null&&i.dependencies!==null&&yh(i.dependencies))?(ve||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(h,Ee,re),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(h,Ee,re)),typeof v.componentDidUpdate=="function"&&(o.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof v.componentDidUpdate!="function"||I===i.memoizedProps&&we===i.memoizedState||(o.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||I===i.memoizedProps&&we===i.memoizedState||(o.flags|=1024),o.memoizedProps=h,o.memoizedState=Ee),v.props=h,v.state=Ee,v.context=re,h=Ie):(typeof v.componentDidUpdate!="function"||I===i.memoizedProps&&we===i.memoizedState||(o.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||I===i.memoizedProps&&we===i.memoizedState||(o.flags|=1024),h=!1)}return v=h,jh(i,o),h=(o.flags&128)!==0,v||h?(v=o.stateNode,c=h&&typeof c.getDerivedStateFromError!="function"?null:v.render(),o.flags|=1,i!==null&&h?(o.child=Tc(o,i.child,null,g),o.child=Tc(o,null,c,g)):On(i,o,c,g),o.memoizedState=v.state,i=o.child):i=ds(i,o,g),i}function a2(i,o,c,h){return Hu(),o.flags|=256,On(i,o,c,h),o.child}var eg={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function tg(i){return{baseLanes:i,cachePool:qy()}}function rg(i,o,c){return i=i!==null?i.childLanes&~c:0,o&&(i|=Qa),i}function i2(i,o,c){var h=o.pendingProps,g=!1,v=(o.flags&128)!==0,I;if((I=v)||(I=i!==null&&i.memoizedState===null?!1:(pn.current&2)!==0),I&&(g=!0,o.flags&=-129),I=(o.flags&32)!==0,o.flags&=-33,i===null){if(ir){if(g?zs(o):Hs(),ir){var U=Br,re;if(re=U){e:{for(re=U,U=Ii;re.nodeType!==8;){if(!U){U=null;break e}if(re=hi(re.nextSibling),re===null){U=null;break e}}U=re}U!==null?(o.memoizedState={dehydrated:U,treeContext:il!==null?{id:os,overflow:ls}:null,retryLane:536870912,hydrationErrors:null},re=Aa(18,null,null,0),re.stateNode=U,re.return=o,o.child=re,sa=o,Br=null,re=!0):re=!1}re||ll(o)}if(U=o.memoizedState,U!==null&&(U=U.dehydrated,U!==null))return Ug(U)?o.lanes=32:o.lanes=536870912,null;hs(o)}return U=h.children,h=h.fallback,g?(Hs(),g=o.mode,U=Uh({mode:"hidden",children:U},g),h=al(h,g,c,null),U.return=o,h.return=o,U.sibling=h,o.child=U,g=o.child,g.memoizedState=tg(c),g.childLanes=rg(i,I,c),o.memoizedState=eg,h):(zs(o),ng(o,U))}if(re=i.memoizedState,re!==null&&(U=re.dehydrated,U!==null)){if(v)o.flags&256?(zs(o),o.flags&=-257,o=ag(i,o,c)):o.memoizedState!==null?(Hs(),o.child=i.child,o.flags|=128,o=null):(Hs(),g=h.fallback,U=o.mode,h=Uh({mode:"visible",children:h.children},U),g=al(g,U,c,null),g.flags|=2,h.return=o,g.return=o,h.sibling=g,o.child=h,Tc(o,i.child,null,c),h=o.child,h.memoizedState=tg(c),h.childLanes=rg(i,I,c),o.memoizedState=eg,o=g);else if(zs(o),Ug(U)){if(I=U.nextSibling&&U.nextSibling.dataset,I)var ve=I.dgst;I=ve,h=Error(n(419)),h.stack="",h.digest=I,Gu({value:h,source:null,stack:null}),o=ag(i,o,c)}else if(bn||qu(i,o,c,!1),I=(c&i.childLanes)!==0,bn||I){if(I=Tr,I!==null&&(h=c&-c,h=(h&42)!==0?1:Fr(h),h=(h&(I.suspendedLanes|c))!==0?0:h,h!==0&&h!==re.retryLane))throw re.retryLane=h,hc(i,h),Da(I,i,h),Y_;U.data==="$?"||Eg(),o=ag(i,o,c)}else U.data==="$?"?(o.flags|=192,o.child=i.child,o=null):(i=re.treeContext,Br=hi(U.nextSibling),sa=o,ir=!0,ol=null,Ii=!1,i!==null&&($a[Ka++]=os,$a[Ka++]=ls,$a[Ka++]=il,os=i.id,ls=i.overflow,il=o),o=ng(o,h.children),o.flags|=4096);return o}return g?(Hs(),g=h.fallback,U=o.mode,re=i.child,ve=re.sibling,h=ss(re,{mode:"hidden",children:h.children}),h.subtreeFlags=re.subtreeFlags&65011712,ve!==null?g=ss(ve,g):(g=al(g,U,c,null),g.flags|=2),g.return=o,h.return=o,h.sibling=g,o.child=h,h=g,g=o.child,U=i.child.memoizedState,U===null?U=tg(c):(re=U.cachePool,re!==null?(ve=mn._currentValue,re=re.parent!==ve?{parent:ve,pool:ve}:re):re=qy(),U={baseLanes:U.baseLanes|c,cachePool:re}),g.memoizedState=U,g.childLanes=rg(i,I,c),o.memoizedState=eg,h):(zs(o),c=i.child,i=c.sibling,c=ss(c,{mode:"visible",children:h.children}),c.return=o,c.sibling=null,i!==null&&(I=o.deletions,I===null?(o.deletions=[i],o.flags|=16):I.push(i)),o.child=c,o.memoizedState=null,c)}function ng(i,o){return o=Uh({mode:"visible",children:o},i.mode),o.return=i,i.child=o}function Uh(i,o){return i=Aa(22,i,null,o),i.lanes=0,i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},i}function ag(i,o,c){return Tc(o,i.child,null,c),i=ng(o,o.pendingProps.children),i.flags|=2,o.memoizedState=null,i}function s2(i,o,c){i.lanes|=o;var h=i.alternate;h!==null&&(h.lanes|=o),Ep(i.return,o,c)}function ig(i,o,c,h,g){var v=i.memoizedState;v===null?i.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:h,tail:c,tailMode:g}:(v.isBackwards=o,v.rendering=null,v.renderingStartTime=0,v.last=h,v.tail=c,v.tailMode=g)}function o2(i,o,c){var h=o.pendingProps,g=h.revealOrder,v=h.tail;if(On(i,o,h.children,c),h=pn.current,(h&2)!==0)h=h&1|2,o.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=o.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&s2(i,c,o);else if(i.tag===19)s2(i,c,o);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===o)break e;for(;i.sibling===null;){if(i.return===null||i.return===o)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}h&=1}switch(X(pn,h),g){case"forwards":for(c=o.child,g=null;c!==null;)i=c.alternate,i!==null&&Lh(i)===null&&(g=c),c=c.sibling;c=g,c===null?(g=o.child,o.child=null):(g=c.sibling,c.sibling=null),ig(o,!1,g,c,v);break;case"backwards":for(c=null,g=o.child,o.child=null;g!==null;){if(i=g.alternate,i!==null&&Lh(i)===null){o.child=g;break}i=g.sibling,g.sibling=c,c=g,g=i}ig(o,!0,c,null,v);break;case"together":ig(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function ds(i,o,c){if(i!==null&&(o.dependencies=i.dependencies),$s|=o.lanes,(c&o.childLanes)===0)if(i!==null){if(qu(i,o,c,!1),(c&o.childLanes)===0)return null}else return null;if(i!==null&&o.child!==i.child)throw Error(n(153));if(o.child!==null){for(i=o.child,c=ss(i,i.pendingProps),o.child=c,c.return=o;i.sibling!==null;)i=i.sibling,c=c.sibling=ss(i,i.pendingProps),c.return=o;c.sibling=null}return o.child}function sg(i,o){return(i.lanes&o)!==0?!0:(i=i.dependencies,!!(i!==null&&yh(i)))}function yN(i,o,c){switch(o.tag){case 3:ke(o,o.stateNode.containerInfo),Ps(o,mn,i.memoizedState.cache),Hu();break;case 27:case 5:Oe(o);break;case 4:ke(o,o.stateNode.containerInfo);break;case 10:Ps(o,o.type,o.memoizedProps.value);break;case 13:var h=o.memoizedState;if(h!==null)return h.dehydrated!==null?(zs(o),o.flags|=128,null):(c&o.child.childLanes)!==0?i2(i,o,c):(zs(o),i=ds(i,o,c),i!==null?i.sibling:null);zs(o);break;case 19:var g=(i.flags&128)!==0;if(h=(c&o.childLanes)!==0,h||(qu(i,o,c,!1),h=(c&o.childLanes)!==0),g){if(h)return o2(i,o,c);o.flags|=128}if(g=o.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),X(pn,pn.current),h)break;return null;case 22:case 23:return o.lanes=0,e2(i,o,c);case 24:Ps(o,mn,i.memoizedState.cache)}return ds(i,o,c)}function l2(i,o,c){if(i!==null)if(i.memoizedProps!==o.pendingProps)bn=!0;else{if(!sg(i,c)&&(o.flags&128)===0)return bn=!1,yN(i,o,c);bn=(i.flags&131072)!==0}else bn=!1,ir&&(o.flags&1048576)!==0&&jy(o,vh,o.index);switch(o.lanes=0,o.tag){case 16:e:{i=o.pendingProps;var h=o.elementType,g=h._init;if(h=g(h._payload),o.type=h,typeof h=="function")pp(h)?(i=dl(h,i),o.tag=1,o=n2(null,o,h,i,c)):(o.tag=0,o=Zp(null,o,h,i,c));else{if(h!=null){if(g=h.$$typeof,g===G){o.tag=11,o=Q_(null,o,h,i,c);break e}else if(g===A){o.tag=14,o=J_(null,o,h,i,c);break e}}throw o=he(h)||h,Error(n(306,o,""))}}return o;case 0:return Zp(i,o,o.type,o.pendingProps,c);case 1:return h=o.type,g=dl(h,o.pendingProps),n2(i,o,h,g,c);case 3:e:{if(ke(o,o.stateNode.containerInfo),i===null)throw Error(n(387));h=o.pendingProps;var v=o.memoizedState;g=v.element,Np(i,o),Ju(o,h,null,c);var I=o.memoizedState;if(h=I.cache,Ps(o,mn,h),h!==v.cache&&Tp(o,[mn],c,!0),Qu(),h=I.element,v.isDehydrated)if(v={element:h,isDehydrated:!1,cache:I.cache},o.updateQueue.baseState=v,o.memoizedState=v,o.flags&256){o=a2(i,o,h,c);break e}else if(h!==g){g=Wa(Error(n(424)),o),Gu(g),o=a2(i,o,h,c);break e}else{switch(i=o.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(Br=hi(i.firstChild),sa=o,ir=!0,ol=null,Ii=!0,c=B_(o,null,h,c),o.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(Hu(),h===g){o=ds(i,o,c);break e}On(i,o,h,c)}o=o.child}return o;case 26:return jh(i,o),i===null?(c=hw(o.type,null,o.pendingProps,null))?o.memoizedState=c:ir||(c=o.type,i=o.pendingProps,h=Zh(fe.current).createElement(c),h[bt]=o,h[Ht]=i,Ln(h,c,i),ce(h),o.stateNode=h):o.memoizedState=hw(o.type,i.memoizedProps,o.pendingProps,i.memoizedState),null;case 27:return Oe(o),i===null&&ir&&(h=o.stateNode=cw(o.type,o.pendingProps,fe.current),sa=o,Ii=!0,g=Br,Js(o.type)?(Bg=g,Br=hi(h.firstChild)):Br=g),On(i,o,o.pendingProps.children,c),jh(i,o),i===null&&(o.flags|=4194304),o.child;case 5:return i===null&&ir&&((g=h=Br)&&(h=XN(h,o.type,o.pendingProps,Ii),h!==null?(o.stateNode=h,sa=o,Br=hi(h.firstChild),Ii=!1,g=!0):g=!1),g||ll(o)),Oe(o),g=o.type,v=o.pendingProps,I=i!==null?i.memoizedProps:null,h=v.children,Mg(g,v)?h=null:I!==null&&Mg(g,I)&&(o.flags|=32),o.memoizedState!==null&&(g=Lp(i,o,fN,null,null,c),wf._currentValue=g),jh(i,o),On(i,o,h,c),o.child;case 6:return i===null&&ir&&((i=c=Br)&&(c=$N(c,o.pendingProps,Ii),c!==null?(o.stateNode=c,sa=o,Br=null,i=!0):i=!1),i||ll(o)),null;case 13:return i2(i,o,c);case 4:return ke(o,o.stateNode.containerInfo),h=o.pendingProps,i===null?o.child=Tc(o,null,h,c):On(i,o,h,c),o.child;case 11:return Q_(i,o,o.type,o.pendingProps,c);case 7:return On(i,o,o.pendingProps,c),o.child;case 8:return On(i,o,o.pendingProps.children,c),o.child;case 12:return On(i,o,o.pendingProps.children,c),o.child;case 10:return h=o.pendingProps,Ps(o,o.type,h.value),On(i,o,h.children,c),o.child;case 9:return g=o.type._context,h=o.pendingProps.children,ul(o),g=zn(g),h=h(g),o.flags|=1,On(i,o,h,c),o.child;case 14:return J_(i,o,o.type,o.pendingProps,c);case 15:return Z_(i,o,o.type,o.pendingProps,c);case 19:return o2(i,o,c);case 31:return h=o.pendingProps,c=o.mode,h={mode:h.mode,children:h.children},i===null?(c=Uh(h,c),c.ref=o.ref,o.child=c,c.return=o,o=c):(c=ss(i.child,h),c.ref=o.ref,o.child=c,c.return=o,o=c),o;case 22:return e2(i,o,c);case 24:return ul(o),h=zn(mn),i===null?(g=kp(),g===null&&(g=Tr,v=bp(),g.pooledCache=v,v.refCount++,v!==null&&(g.pooledCacheLanes|=c),g=v),o.memoizedState={parent:h,cache:g},Cp(o),Ps(o,mn,g)):((i.lanes&c)!==0&&(Np(i,o),Ju(o,null,null,c),Qu()),g=i.memoizedState,v=o.memoizedState,g.parent!==h?(g={parent:h,cache:h},o.memoizedState=g,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=g),Ps(o,mn,h)):(h=v.cache,Ps(o,mn,h),h!==g.cache&&Tp(o,[mn],c,!0))),On(i,o,o.pendingProps.children,c),o.child;case 29:throw o.pendingProps}throw Error(n(156,o.tag))}function ms(i){i.flags|=4}function c2(i,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!xw(o)){if(o=Ya.current,o!==null&&((Yt&4194048)===Yt?Ri!==null:(Yt&62914560)!==Yt&&(Yt&536870912)===0||o!==Ri))throw Ku=Ap,Wy;i.flags|=8192}}function Bh(i,o){o!==null&&(i.flags|=4),i.flags&16384&&(o=i.tag!==22?li():536870912,i.lanes|=o,Ac|=o)}function sf(i,o){if(!ir)switch(i.tailMode){case"hidden":o=i.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?i.tail=null:c.sibling=null;break;case"collapsed":c=i.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?o||i.tail===null?i.tail=null:i.tail.sibling=null:h.sibling=null}}function Lr(i){var o=i.alternate!==null&&i.alternate.child===i.child,c=0,h=0;if(o)for(var g=i.child;g!==null;)c|=g.lanes|g.childLanes,h|=g.subtreeFlags&65011712,h|=g.flags&65011712,g.return=i,g=g.sibling;else for(g=i.child;g!==null;)c|=g.lanes|g.childLanes,h|=g.subtreeFlags,h|=g.flags,g.return=i,g=g.sibling;return i.subtreeFlags|=h,i.childLanes=c,o}function _N(i,o,c){var h=o.pendingProps;switch(yp(o),o.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Lr(o),null;case 1:return Lr(o),null;case 3:return c=o.stateNode,h=null,i!==null&&(h=i.memoizedState.cache),o.memoizedState.cache!==h&&(o.flags|=2048),us(mn),Ne(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(i===null||i.child===null)&&(zu(o)?ms(o):i===null||i.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,Vy())),Lr(o),null;case 26:return c=o.memoizedState,i===null?(ms(o),c!==null?(Lr(o),c2(o,c)):(Lr(o),o.flags&=-16777217)):c?c!==i.memoizedState?(ms(o),Lr(o),c2(o,c)):(Lr(o),o.flags&=-16777217):(i.memoizedProps!==h&&ms(o),Lr(o),o.flags&=-16777217),null;case 27:ot(o),c=fe.current;var g=o.type;if(i!==null&&o.stateNode!=null)i.memoizedProps!==h&&ms(o);else{if(!h){if(o.stateNode===null)throw Error(n(166));return Lr(o),null}i=Z.current,zu(o)?Uy(o):(i=cw(g,h,c),o.stateNode=i,ms(o))}return Lr(o),null;case 5:if(ot(o),c=o.type,i!==null&&o.stateNode!=null)i.memoizedProps!==h&&ms(o);else{if(!h){if(o.stateNode===null)throw Error(n(166));return Lr(o),null}if(i=Z.current,zu(o))Uy(o);else{switch(g=Zh(fe.current),i){case 1:i=g.createElementNS("http://www.w3.org/2000/svg",c);break;case 2:i=g.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;default:switch(c){case"svg":i=g.createElementNS("http://www.w3.org/2000/svg",c);break;case"math":i=g.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;case"script":i=g.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild);break;case"select":i=typeof h.is=="string"?g.createElement("select",{is:h.is}):g.createElement("select"),h.multiple?i.multiple=!0:h.size&&(i.size=h.size);break;default:i=typeof h.is=="string"?g.createElement(c,{is:h.is}):g.createElement(c)}}i[bt]=o,i[Ht]=h;e:for(g=o.child;g!==null;){if(g.tag===5||g.tag===6)i.appendChild(g.stateNode);else if(g.tag!==4&&g.tag!==27&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===o)break e;for(;g.sibling===null;){if(g.return===null||g.return===o)break e;g=g.return}g.sibling.return=g.return,g=g.sibling}o.stateNode=i;e:switch(Ln(i,c,h),c){case"button":case"input":case"select":case"textarea":i=!!h.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&ms(o)}}return Lr(o),o.flags&=-16777217,null;case 6:if(i&&o.stateNode!=null)i.memoizedProps!==h&&ms(o);else{if(typeof h!="string"&&o.stateNode===null)throw Error(n(166));if(i=fe.current,zu(o)){if(i=o.stateNode,c=o.memoizedProps,h=null,g=sa,g!==null)switch(g.tag){case 27:case 5:h=g.memoizedProps}i[bt]=o,i=!!(i.nodeValue===c||h!==null&&h.suppressHydrationWarning===!0||rw(i.nodeValue,c)),i||ll(o)}else i=Zh(i).createTextNode(h),i[bt]=o,o.stateNode=i}return Lr(o),null;case 13:if(h=o.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(g=zu(o),h!==null&&h.dehydrated!==null){if(i===null){if(!g)throw Error(n(318));if(g=o.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(n(317));g[bt]=o}else Hu(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Lr(o),g=!1}else g=Vy(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=g),g=!0;if(!g)return o.flags&256?(hs(o),o):(hs(o),null)}if(hs(o),(o.flags&128)!==0)return o.lanes=c,o;if(c=h!==null,i=i!==null&&i.memoizedState!==null,c){h=o.child,g=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(g=h.alternate.memoizedState.cachePool.pool);var v=null;h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(v=h.memoizedState.cachePool.pool),v!==g&&(h.flags|=2048)}return c!==i&&c&&(o.child.flags|=8192),Bh(o,o.updateQueue),Lr(o),null;case 4:return Ne(),i===null&&Rg(o.stateNode.containerInfo),Lr(o),null;case 10:return us(o.type),Lr(o),null;case 19:if(V(pn),g=o.memoizedState,g===null)return Lr(o),null;if(h=(o.flags&128)!==0,v=g.rendering,v===null)if(h)sf(g,!1);else{if(Vr!==0||i!==null&&(i.flags&128)!==0)for(i=o.child;i!==null;){if(v=Lh(i),v!==null){for(o.flags|=128,sf(g,!1),i=v.updateQueue,o.updateQueue=i,Bh(o,i),o.subtreeFlags=0,i=c,c=o.child;c!==null;)Py(c,i),c=c.sibling;return X(pn,pn.current&1|2),o.child}i=i.sibling}g.tail!==null&&Ge()>Hh&&(o.flags|=128,h=!0,sf(g,!1),o.lanes=4194304)}else{if(!h)if(i=Lh(v),i!==null){if(o.flags|=128,h=!0,i=i.updateQueue,o.updateQueue=i,Bh(o,i),sf(g,!0),g.tail===null&&g.tailMode==="hidden"&&!v.alternate&&!ir)return Lr(o),null}else 2*Ge()-g.renderingStartTime>Hh&&c!==536870912&&(o.flags|=128,h=!0,sf(g,!1),o.lanes=4194304);g.isBackwards?(v.sibling=o.child,o.child=v):(i=g.last,i!==null?i.sibling=v:o.child=v,g.last=v)}return g.tail!==null?(o=g.tail,g.rendering=o,g.tail=o.sibling,g.renderingStartTime=Ge(),o.sibling=null,i=pn.current,X(pn,h?i&1|2:i&1),o):(Lr(o),null);case 22:case 23:return hs(o),Op(),h=o.memoizedState!==null,i!==null?i.memoizedState!==null!==h&&(o.flags|=8192):h&&(o.flags|=8192),h?(c&536870912)!==0&&(o.flags&128)===0&&(Lr(o),o.subtreeFlags&6&&(o.flags|=8192)):Lr(o),c=o.updateQueue,c!==null&&Bh(o,c.retryQueue),c=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),h=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(h=o.memoizedState.cachePool.pool),h!==c&&(o.flags|=2048),i!==null&&V(fl),null;case 24:return c=null,i!==null&&(c=i.memoizedState.cache),o.memoizedState.cache!==c&&(o.flags|=2048),us(mn),Lr(o),null;case 25:return null;case 30:return null}throw Error(n(156,o.tag))}function wN(i,o){switch(yp(o),o.tag){case 1:return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 3:return us(mn),Ne(),i=o.flags,(i&65536)!==0&&(i&128)===0?(o.flags=i&-65537|128,o):null;case 26:case 27:case 5:return ot(o),null;case 13:if(hs(o),i=o.memoizedState,i!==null&&i.dehydrated!==null){if(o.alternate===null)throw Error(n(340));Hu()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 19:return V(pn),null;case 4:return Ne(),null;case 10:return us(o.type),null;case 22:case 23:return hs(o),Op(),i!==null&&V(fl),i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 24:return us(mn),null;case 25:return null;default:return null}}function u2(i,o){switch(yp(o),o.tag){case 3:us(mn),Ne();break;case 26:case 27:case 5:ot(o);break;case 4:Ne();break;case 13:hs(o);break;case 19:V(pn);break;case 10:us(o.type);break;case 22:case 23:hs(o),Op(),i!==null&&V(fl);break;case 24:us(mn)}}function of(i,o){try{var c=o.updateQueue,h=c!==null?c.lastEffect:null;if(h!==null){var g=h.next;c=g;do{if((c.tag&i)===i){h=void 0;var v=c.create,I=c.inst;h=v(),I.destroy=h}c=c.next}while(c!==g)}}catch(U){Er(o,o.return,U)}}function Gs(i,o,c){try{var h=o.updateQueue,g=h!==null?h.lastEffect:null;if(g!==null){var v=g.next;h=v;do{if((h.tag&i)===i){var I=h.inst,U=I.destroy;if(U!==void 0){I.destroy=void 0,g=o;var re=c,ve=U;try{ve()}catch(Ie){Er(g,re,Ie)}}}h=h.next}while(h!==v)}}catch(Ie){Er(o,o.return,Ie)}}function f2(i){var o=i.updateQueue;if(o!==null){var c=i.stateNode;try{Jy(o,c)}catch(h){Er(i,i.return,h)}}}function h2(i,o,c){c.props=dl(i.type,i.memoizedProps),c.state=i.memoizedState;try{c.componentWillUnmount()}catch(h){Er(i,o,h)}}function lf(i,o){try{var c=i.ref;if(c!==null){switch(i.tag){case 26:case 27:case 5:var h=i.stateNode;break;case 30:h=i.stateNode;break;default:h=i.stateNode}typeof c=="function"?i.refCleanup=c(h):c.current=h}}catch(g){Er(i,o,g)}}function Di(i,o){var c=i.ref,h=i.refCleanup;if(c!==null)if(typeof h=="function")try{h()}catch(g){Er(i,o,g)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(g){Er(i,o,g)}else c.current=null}function d2(i){var o=i.type,c=i.memoizedProps,h=i.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":c.autoFocus&&h.focus();break e;case"img":c.src?h.src=c.src:c.srcSet&&(h.srcset=c.srcSet)}}catch(g){Er(i,i.return,g)}}function og(i,o,c){try{var h=i.stateNode;zN(h,i.type,c,o),h[Ht]=o}catch(g){Er(i,i.return,g)}}function m2(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&Js(i.type)||i.tag===4}function lg(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||m2(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&Js(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function cg(i,o,c){var h=i.tag;if(h===5||h===6)i=i.stateNode,o?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(i,o):(o=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,o.appendChild(i),c=c._reactRootContainer,c!=null||o.onclick!==null||(o.onclick=Jh));else if(h!==4&&(h===27&&Js(i.type)&&(c=i.stateNode,o=null),i=i.child,i!==null))for(cg(i,o,c),i=i.sibling;i!==null;)cg(i,o,c),i=i.sibling}function Vh(i,o,c){var h=i.tag;if(h===5||h===6)i=i.stateNode,o?c.insertBefore(i,o):c.appendChild(i);else if(h!==4&&(h===27&&Js(i.type)&&(c=i.stateNode),i=i.child,i!==null))for(Vh(i,o,c),i=i.sibling;i!==null;)Vh(i,o,c),i=i.sibling}function p2(i){var o=i.stateNode,c=i.memoizedProps;try{for(var h=i.type,g=o.attributes;g.length;)o.removeAttributeNode(g[0]);Ln(o,h,c),o[bt]=i,o[Ht]=c}catch(v){Er(i,i.return,v)}}var ps=!1,Kr=!1,ug=!1,g2=typeof WeakSet=="function"?WeakSet:Set,Sn=null;function EN(i,o){if(i=i.containerInfo,Fg=id,i=Ay(i),lp(i)){if("selectionStart"in i)var c={start:i.selectionStart,end:i.selectionEnd};else e:{c=(c=i.ownerDocument)&&c.defaultView||window;var h=c.getSelection&&c.getSelection();if(h&&h.rangeCount!==0){c=h.anchorNode;var g=h.anchorOffset,v=h.focusNode;h=h.focusOffset;try{c.nodeType,v.nodeType}catch{c=null;break e}var I=0,U=-1,re=-1,ve=0,Ie=0,Fe=i,we=null;t:for(;;){for(var Ee;Fe!==c||g!==0&&Fe.nodeType!==3||(U=I+g),Fe!==v||h!==0&&Fe.nodeType!==3||(re=I+h),Fe.nodeType===3&&(I+=Fe.nodeValue.length),(Ee=Fe.firstChild)!==null;)we=Fe,Fe=Ee;for(;;){if(Fe===i)break t;if(we===c&&++ve===g&&(U=I),we===v&&++Ie===h&&(re=I),(Ee=Fe.nextSibling)!==null)break;Fe=we,we=Fe.parentNode}Fe=Ee}c=U===-1||re===-1?null:{start:U,end:re}}else c=null}c=c||{start:0,end:0}}else c=null;for(Lg={focusedElem:i,selectionRange:c},id=!1,Sn=o;Sn!==null;)if(o=Sn,i=o.child,(o.subtreeFlags&1024)!==0&&i!==null)i.return=o,Sn=i;else for(;Sn!==null;){switch(o=Sn,v=o.alternate,i=o.flags,o.tag){case 0:break;case 11:case 15:break;case 1:if((i&1024)!==0&&v!==null){i=void 0,c=o,g=v.memoizedProps,v=v.memoizedState,h=c.stateNode;try{var Et=dl(c.type,g,c.elementType===c.type);i=h.getSnapshotBeforeUpdate(Et,v),h.__reactInternalSnapshotBeforeUpdate=i}catch(pt){Er(c,c.return,pt)}}break;case 3:if((i&1024)!==0){if(i=o.stateNode.containerInfo,c=i.nodeType,c===9)jg(i);else if(c===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":jg(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(n(163))}if(i=o.sibling,i!==null){i.return=o.return,Sn=i;break}Sn=o.return}}function x2(i,o,c){var h=c.flags;switch(c.tag){case 0:case 11:case 15:qs(i,c),h&4&&of(5,c);break;case 1:if(qs(i,c),h&4)if(i=c.stateNode,o===null)try{i.componentDidMount()}catch(I){Er(c,c.return,I)}else{var g=dl(c.type,o.memoizedProps);o=o.memoizedState;try{i.componentDidUpdate(g,o,i.__reactInternalSnapshotBeforeUpdate)}catch(I){Er(c,c.return,I)}}h&64&&f2(c),h&512&&lf(c,c.return);break;case 3:if(qs(i,c),h&64&&(i=c.updateQueue,i!==null)){if(o=null,c.child!==null)switch(c.child.tag){case 27:case 5:o=c.child.stateNode;break;case 1:o=c.child.stateNode}try{Jy(i,o)}catch(I){Er(c,c.return,I)}}break;case 27:o===null&&h&4&&p2(c);case 26:case 5:qs(i,c),o===null&&h&4&&d2(c),h&512&&lf(c,c.return);break;case 12:qs(i,c);break;case 13:qs(i,c),h&4&&_2(i,c),h&64&&(i=c.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(c=RN.bind(null,c),KN(i,c))));break;case 22:if(h=c.memoizedState!==null||ps,!h){o=o!==null&&o.memoizedState!==null||Kr,g=ps;var v=Kr;ps=h,(Kr=o)&&!v?Ws(i,c,(c.subtreeFlags&8772)!==0):qs(i,c),ps=g,Kr=v}break;case 30:break;default:qs(i,c)}}function v2(i){var o=i.alternate;o!==null&&(i.alternate=null,v2(o)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(o=i.stateNode,o!==null&&q(o)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var Rr=null,pa=!1;function gs(i,o,c){for(c=c.child;c!==null;)y2(i,o,c),c=c.sibling}function y2(i,o,c){if(oe&&typeof oe.onCommitFiberUnmount=="function")try{oe.onCommitFiberUnmount(jt,c)}catch{}switch(c.tag){case 26:Kr||Di(c,o),gs(i,o,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:Kr||Di(c,o);var h=Rr,g=pa;Js(c.type)&&(Rr=c.stateNode,pa=!1),gs(i,o,c),xf(c.stateNode),Rr=h,pa=g;break;case 5:Kr||Di(c,o);case 6:if(h=Rr,g=pa,Rr=null,gs(i,o,c),Rr=h,pa=g,Rr!==null)if(pa)try{(Rr.nodeType===9?Rr.body:Rr.nodeName==="HTML"?Rr.ownerDocument.body:Rr).removeChild(c.stateNode)}catch(v){Er(c,o,v)}else try{Rr.removeChild(c.stateNode)}catch(v){Er(c,o,v)}break;case 18:Rr!==null&&(pa?(i=Rr,ow(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,c.stateNode),Sf(i)):ow(Rr,c.stateNode));break;case 4:h=Rr,g=pa,Rr=c.stateNode.containerInfo,pa=!0,gs(i,o,c),Rr=h,pa=g;break;case 0:case 11:case 14:case 15:Kr||Gs(2,c,o),Kr||Gs(4,c,o),gs(i,o,c);break;case 1:Kr||(Di(c,o),h=c.stateNode,typeof h.componentWillUnmount=="function"&&h2(c,o,h)),gs(i,o,c);break;case 21:gs(i,o,c);break;case 22:Kr=(h=Kr)||c.memoizedState!==null,gs(i,o,c),Kr=h;break;default:gs(i,o,c)}}function _2(i,o){if(o.memoizedState===null&&(i=o.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{Sf(i)}catch(c){Er(o,o.return,c)}}function TN(i){switch(i.tag){case 13:case 19:var o=i.stateNode;return o===null&&(o=i.stateNode=new g2),o;case 22:return i=i.stateNode,o=i._retryCache,o===null&&(o=i._retryCache=new g2),o;default:throw Error(n(435,i.tag))}}function fg(i,o){var c=TN(i);o.forEach(function(h){var g=DN.bind(null,i,h);c.has(h)||(c.add(h),h.then(g,g))})}function Ca(i,o){var c=o.deletions;if(c!==null)for(var h=0;h<c.length;h++){var g=c[h],v=i,I=o,U=I;e:for(;U!==null;){switch(U.tag){case 27:if(Js(U.type)){Rr=U.stateNode,pa=!1;break e}break;case 5:Rr=U.stateNode,pa=!1;break e;case 3:case 4:Rr=U.stateNode.containerInfo,pa=!0;break e}U=U.return}if(Rr===null)throw Error(n(160));y2(v,I,g),Rr=null,pa=!1,v=g.alternate,v!==null&&(v.return=null),g.return=null}if(o.subtreeFlags&13878)for(o=o.child;o!==null;)w2(o,i),o=o.sibling}var fi=null;function w2(i,o){var c=i.alternate,h=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:Ca(o,i),Na(i),h&4&&(Gs(3,i,i.return),of(3,i),Gs(5,i,i.return));break;case 1:Ca(o,i),Na(i),h&512&&(Kr||c===null||Di(c,c.return)),h&64&&ps&&(i=i.updateQueue,i!==null&&(h=i.callbacks,h!==null&&(c=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=c===null?h:c.concat(h))));break;case 26:var g=fi;if(Ca(o,i),Na(i),h&512&&(Kr||c===null||Di(c,c.return)),h&4){var v=c!==null?c.memoizedState:null;if(h=i.memoizedState,c===null)if(h===null)if(i.stateNode===null){e:{h=i.type,c=i.memoizedProps,g=g.ownerDocument||g;t:switch(h){case"title":v=g.getElementsByTagName("title")[0],(!v||v[H]||v[bt]||v.namespaceURI==="http://www.w3.org/2000/svg"||v.hasAttribute("itemprop"))&&(v=g.createElement(h),g.head.insertBefore(v,g.querySelector("head > title"))),Ln(v,h,c),v[bt]=i,ce(v),h=v;break e;case"link":var I=pw("link","href",g).get(h+(c.href||""));if(I){for(var U=0;U<I.length;U++)if(v=I[U],v.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&v.getAttribute("rel")===(c.rel==null?null:c.rel)&&v.getAttribute("title")===(c.title==null?null:c.title)&&v.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){I.splice(U,1);break t}}v=g.createElement(h),Ln(v,h,c),g.head.appendChild(v);break;case"meta":if(I=pw("meta","content",g).get(h+(c.content||""))){for(U=0;U<I.length;U++)if(v=I[U],v.getAttribute("content")===(c.content==null?null:""+c.content)&&v.getAttribute("name")===(c.name==null?null:c.name)&&v.getAttribute("property")===(c.property==null?null:c.property)&&v.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&v.getAttribute("charset")===(c.charSet==null?null:c.charSet)){I.splice(U,1);break t}}v=g.createElement(h),Ln(v,h,c),g.head.appendChild(v);break;default:throw Error(n(468,h))}v[bt]=i,ce(v),h=v}i.stateNode=h}else gw(g,i.type,i.stateNode);else i.stateNode=mw(g,h,i.memoizedProps);else v!==h?(v===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):v.count--,h===null?gw(g,i.type,i.stateNode):mw(g,h,i.memoizedProps)):h===null&&i.stateNode!==null&&og(i,i.memoizedProps,c.memoizedProps)}break;case 27:Ca(o,i),Na(i),h&512&&(Kr||c===null||Di(c,c.return)),c!==null&&h&4&&og(i,i.memoizedProps,c.memoizedProps);break;case 5:if(Ca(o,i),Na(i),h&512&&(Kr||c===null||Di(c,c.return)),i.flags&32){g=i.stateNode;try{za(g,"")}catch(Ee){Er(i,i.return,Ee)}}h&4&&i.stateNode!=null&&(g=i.memoizedProps,og(i,g,c!==null?c.memoizedProps:g)),h&1024&&(ug=!0);break;case 6:if(Ca(o,i),Na(i),h&4){if(i.stateNode===null)throw Error(n(162));h=i.memoizedProps,c=i.stateNode;try{c.nodeValue=h}catch(Ee){Er(i,i.return,Ee)}}break;case 3:if(rd=null,g=fi,fi=ed(o.containerInfo),Ca(o,i),fi=g,Na(i),h&4&&c!==null&&c.memoizedState.isDehydrated)try{Sf(o.containerInfo)}catch(Ee){Er(i,i.return,Ee)}ug&&(ug=!1,E2(i));break;case 4:h=fi,fi=ed(i.stateNode.containerInfo),Ca(o,i),Na(i),fi=h;break;case 12:Ca(o,i),Na(i);break;case 13:Ca(o,i),Na(i),i.child.flags&8192&&i.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(xg=Ge()),h&4&&(h=i.updateQueue,h!==null&&(i.updateQueue=null,fg(i,h)));break;case 22:g=i.memoizedState!==null;var re=c!==null&&c.memoizedState!==null,ve=ps,Ie=Kr;if(ps=ve||g,Kr=Ie||re,Ca(o,i),Kr=Ie,ps=ve,Na(i),h&8192)e:for(o=i.stateNode,o._visibility=g?o._visibility&-2:o._visibility|1,g&&(c===null||re||ps||Kr||ml(i)),c=null,o=i;;){if(o.tag===5||o.tag===26){if(c===null){re=c=o;try{if(v=re.stateNode,g)I=v.style,typeof I.setProperty=="function"?I.setProperty("display","none","important"):I.display="none";else{U=re.stateNode;var Fe=re.memoizedProps.style,we=Fe!=null&&Fe.hasOwnProperty("display")?Fe.display:null;U.style.display=we==null||typeof we=="boolean"?"":(""+we).trim()}}catch(Ee){Er(re,re.return,Ee)}}}else if(o.tag===6){if(c===null){re=o;try{re.stateNode.nodeValue=g?"":re.memoizedProps}catch(Ee){Er(re,re.return,Ee)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===i)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break e;for(;o.sibling===null;){if(o.return===null||o.return===i)break e;c===o&&(c=null),o=o.return}c===o&&(c=null),o.sibling.return=o.return,o=o.sibling}h&4&&(h=i.updateQueue,h!==null&&(c=h.retryQueue,c!==null&&(h.retryQueue=null,fg(i,c))));break;case 19:Ca(o,i),Na(i),h&4&&(h=i.updateQueue,h!==null&&(i.updateQueue=null,fg(i,h)));break;case 30:break;case 21:break;default:Ca(o,i),Na(i)}}function Na(i){var o=i.flags;if(o&2){try{for(var c,h=i.return;h!==null;){if(m2(h)){c=h;break}h=h.return}if(c==null)throw Error(n(160));switch(c.tag){case 27:var g=c.stateNode,v=lg(i);Vh(i,v,g);break;case 5:var I=c.stateNode;c.flags&32&&(za(I,""),c.flags&=-33);var U=lg(i);Vh(i,U,I);break;case 3:case 4:var re=c.stateNode.containerInfo,ve=lg(i);cg(i,ve,re);break;default:throw Error(n(161))}}catch(Ie){Er(i,i.return,Ie)}i.flags&=-3}o&4096&&(i.flags&=-4097)}function E2(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var o=i;E2(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),i=i.sibling}}function qs(i,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)x2(i,o.alternate,o),o=o.sibling}function ml(i){for(i=i.child;i!==null;){var o=i;switch(o.tag){case 0:case 11:case 14:case 15:Gs(4,o,o.return),ml(o);break;case 1:Di(o,o.return);var c=o.stateNode;typeof c.componentWillUnmount=="function"&&h2(o,o.return,c),ml(o);break;case 27:xf(o.stateNode);case 26:case 5:Di(o,o.return),ml(o);break;case 22:o.memoizedState===null&&ml(o);break;case 30:ml(o);break;default:ml(o)}i=i.sibling}}function Ws(i,o,c){for(c=c&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var h=o.alternate,g=i,v=o,I=v.flags;switch(v.tag){case 0:case 11:case 15:Ws(g,v,c),of(4,v);break;case 1:if(Ws(g,v,c),h=v,g=h.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(ve){Er(h,h.return,ve)}if(h=v,g=h.updateQueue,g!==null){var U=h.stateNode;try{var re=g.shared.hiddenCallbacks;if(re!==null)for(g.shared.hiddenCallbacks=null,g=0;g<re.length;g++)Qy(re[g],U)}catch(ve){Er(h,h.return,ve)}}c&&I&64&&f2(v),lf(v,v.return);break;case 27:p2(v);case 26:case 5:Ws(g,v,c),c&&h===null&&I&4&&d2(v),lf(v,v.return);break;case 12:Ws(g,v,c);break;case 13:Ws(g,v,c),c&&I&4&&_2(g,v);break;case 22:v.memoizedState===null&&Ws(g,v,c),lf(v,v.return);break;case 30:break;default:Ws(g,v,c)}o=o.sibling}}function hg(i,o){var c=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),i=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(i=o.memoizedState.cachePool.pool),i!==c&&(i!=null&&i.refCount++,c!=null&&Wu(c))}function dg(i,o){i=null,o.alternate!==null&&(i=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==i&&(o.refCount++,i!=null&&Wu(i))}function Oi(i,o,c,h){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)T2(i,o,c,h),o=o.sibling}function T2(i,o,c,h){var g=o.flags;switch(o.tag){case 0:case 11:case 15:Oi(i,o,c,h),g&2048&&of(9,o);break;case 1:Oi(i,o,c,h);break;case 3:Oi(i,o,c,h),g&2048&&(i=null,o.alternate!==null&&(i=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==i&&(o.refCount++,i!=null&&Wu(i)));break;case 12:if(g&2048){Oi(i,o,c,h),i=o.stateNode;try{var v=o.memoizedProps,I=v.id,U=v.onPostCommit;typeof U=="function"&&U(I,o.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(re){Er(o,o.return,re)}}else Oi(i,o,c,h);break;case 13:Oi(i,o,c,h);break;case 23:break;case 22:v=o.stateNode,I=o.alternate,o.memoizedState!==null?v._visibility&2?Oi(i,o,c,h):cf(i,o):v._visibility&2?Oi(i,o,c,h):(v._visibility|=2,bc(i,o,c,h,(o.subtreeFlags&10256)!==0)),g&2048&&hg(I,o);break;case 24:Oi(i,o,c,h),g&2048&&dg(o.alternate,o);break;default:Oi(i,o,c,h)}}function bc(i,o,c,h,g){for(g=g&&(o.subtreeFlags&10256)!==0,o=o.child;o!==null;){var v=i,I=o,U=c,re=h,ve=I.flags;switch(I.tag){case 0:case 11:case 15:bc(v,I,U,re,g),of(8,I);break;case 23:break;case 22:var Ie=I.stateNode;I.memoizedState!==null?Ie._visibility&2?bc(v,I,U,re,g):cf(v,I):(Ie._visibility|=2,bc(v,I,U,re,g)),g&&ve&2048&&hg(I.alternate,I);break;case 24:bc(v,I,U,re,g),g&&ve&2048&&dg(I.alternate,I);break;default:bc(v,I,U,re,g)}o=o.sibling}}function cf(i,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var c=i,h=o,g=h.flags;switch(h.tag){case 22:cf(c,h),g&2048&&hg(h.alternate,h);break;case 24:cf(c,h),g&2048&&dg(h.alternate,h);break;default:cf(c,h)}o=o.sibling}}var uf=8192;function Sc(i){if(i.subtreeFlags&uf)for(i=i.child;i!==null;)b2(i),i=i.sibling}function b2(i){switch(i.tag){case 26:Sc(i),i.flags&uf&&i.memoizedState!==null&&l3(fi,i.memoizedState,i.memoizedProps);break;case 5:Sc(i);break;case 3:case 4:var o=fi;fi=ed(i.stateNode.containerInfo),Sc(i),fi=o;break;case 22:i.memoizedState===null&&(o=i.alternate,o!==null&&o.memoizedState!==null?(o=uf,uf=16777216,Sc(i),uf=o):Sc(i));break;default:Sc(i)}}function S2(i){var o=i.alternate;if(o!==null&&(i=o.child,i!==null)){o.child=null;do o=i.sibling,i.sibling=null,i=o;while(i!==null)}}function ff(i){var o=i.deletions;if((i.flags&16)!==0){if(o!==null)for(var c=0;c<o.length;c++){var h=o[c];Sn=h,A2(h,i)}S2(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)k2(i),i=i.sibling}function k2(i){switch(i.tag){case 0:case 11:case 15:ff(i),i.flags&2048&&Gs(9,i,i.return);break;case 3:ff(i);break;case 12:ff(i);break;case 22:var o=i.stateNode;i.memoizedState!==null&&o._visibility&2&&(i.return===null||i.return.tag!==13)?(o._visibility&=-3,zh(i)):ff(i);break;default:ff(i)}}function zh(i){var o=i.deletions;if((i.flags&16)!==0){if(o!==null)for(var c=0;c<o.length;c++){var h=o[c];Sn=h,A2(h,i)}S2(i)}for(i=i.child;i!==null;){switch(o=i,o.tag){case 0:case 11:case 15:Gs(8,o,o.return),zh(o);break;case 22:c=o.stateNode,c._visibility&2&&(c._visibility&=-3,zh(o));break;default:zh(o)}i=i.sibling}}function A2(i,o){for(;Sn!==null;){var c=Sn;switch(c.tag){case 0:case 11:case 15:Gs(8,c,o);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var h=c.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:Wu(c.memoizedState.cache)}if(h=c.child,h!==null)h.return=c,Sn=h;else e:for(c=i;Sn!==null;){h=Sn;var g=h.sibling,v=h.return;if(v2(h),h===c){Sn=null;break e}if(g!==null){g.return=v,Sn=g;break e}Sn=v}}}var bN={getCacheForType:function(i){var o=zn(mn),c=o.data.get(i);return c===void 0&&(c=i(),o.data.set(i,c)),c}},SN=typeof WeakMap=="function"?WeakMap:Map,cr=0,Tr=null,Vt=null,Yt=0,ur=0,Ia=null,Xs=!1,kc=!1,mg=!1,xs=0,Vr=0,$s=0,pl=0,pg=0,Qa=0,Ac=0,hf=null,ga=null,gg=!1,xg=0,Hh=1/0,Gh=null,Ks=null,Fn=0,Ys=null,Cc=null,Nc=0,vg=0,yg=null,C2=null,df=0,_g=null;function Ra(){if((cr&2)!==0&&Yt!==0)return Yt&-Yt;if(ne.T!==null){var i=gc;return i!==0?i:Ag()}return Ur()}function N2(){Qa===0&&(Qa=(Yt&536870912)===0||ir?Rn():536870912);var i=Ya.current;return i!==null&&(i.flags|=32),Qa}function Da(i,o,c){(i===Tr&&(ur===2||ur===9)||i.cancelPendingCommit!==null)&&(Ic(i,0),Qs(i,Yt,Qa,!1)),Ue(i,c),((cr&2)===0||i!==Tr)&&(i===Tr&&((cr&2)===0&&(pl|=c),Vr===4&&Qs(i,Yt,Qa,!1)),Fi(i))}function I2(i,o,c){if((cr&6)!==0)throw Error(n(327));var h=!c&&(o&124)===0&&(o&i.expiredLanes)===0||Or(i,o),g=h?CN(i,o):Tg(i,o,!0),v=h;do{if(g===0){kc&&!h&&Qs(i,o,0,!1);break}else{if(c=i.current.alternate,v&&!kN(c)){g=Tg(i,o,!1),v=!1;continue}if(g===2){if(v=o,i.errorRecoveryDisabledLanes&v)var I=0;else I=i.pendingLanes&-536870913,I=I!==0?I:I&536870912?536870912:0;if(I!==0){o=I;e:{var U=i;g=hf;var re=U.current.memoizedState.isDehydrated;if(re&&(Ic(U,I).flags|=256),I=Tg(U,I,!1),I!==2){if(mg&&!re){U.errorRecoveryDisabledLanes|=v,pl|=v,g=4;break e}v=ga,ga=g,v!==null&&(ga===null?ga=v:ga.push.apply(ga,v))}g=I}if(v=!1,g!==2)continue}}if(g===1){Ic(i,0),Qs(i,o,0,!0);break}e:{switch(h=i,v=g,v){case 0:case 1:throw Error(n(345));case 4:if((o&4194048)!==o)break;case 6:Qs(h,o,Qa,!Xs);break e;case 2:ga=null;break;case 3:case 5:break;default:throw Error(n(329))}if((o&62914560)===o&&(g=xg+300-Ge(),10<g)){if(Qs(h,o,Qa,!Xs),sr(h,0,!0)!==0)break e;h.timeoutHandle=iw(R2.bind(null,h,c,ga,Gh,gg,o,Qa,pl,Ac,Xs,v,2,-0,0),g);break e}R2(h,c,ga,Gh,gg,o,Qa,pl,Ac,Xs,v,0,-0,0)}}break}while(!0);Fi(i)}function R2(i,o,c,h,g,v,I,U,re,ve,Ie,Fe,we,Ee){if(i.timeoutHandle=-1,Fe=o.subtreeFlags,(Fe&8192||(Fe&16785408)===16785408)&&(_f={stylesheets:null,count:0,unsuspend:o3},b2(o),Fe=c3(),Fe!==null)){i.cancelPendingCommit=Fe(j2.bind(null,i,o,v,c,h,g,I,U,re,Ie,1,we,Ee)),Qs(i,v,I,!ve);return}j2(i,o,v,c,h,g,I,U,re)}function kN(i){for(var o=i;;){var c=o.tag;if((c===0||c===11||c===15)&&o.flags&16384&&(c=o.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var h=0;h<c.length;h++){var g=c[h],v=g.getSnapshot;g=g.value;try{if(!ka(v(),g))return!1}catch{return!1}}if(c=o.child,o.subtreeFlags&16384&&c!==null)c.return=o,o=c;else{if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Qs(i,o,c,h){o&=~pg,o&=~pl,i.suspendedLanes|=o,i.pingedLanes&=~o,h&&(i.warmLanes|=o),h=i.expirationTimes;for(var g=o;0<g;){var v=31-Ve(g),I=1<<v;h[v]=-1,g&=~I}c!==0&&lt(i,c,o)}function qh(){return(cr&6)===0?(mf(0),!1):!0}function wg(){if(Vt!==null){if(ur===0)var i=Vt.return;else i=Vt,cs=cl=null,jp(i),Ec=null,nf=0,i=Vt;for(;i!==null;)u2(i.alternate,i),i=i.return;Vt=null}}function Ic(i,o){var c=i.timeoutHandle;c!==-1&&(i.timeoutHandle=-1,GN(c)),c=i.cancelPendingCommit,c!==null&&(i.cancelPendingCommit=null,c()),wg(),Tr=i,Vt=c=ss(i.current,null),Yt=o,ur=0,Ia=null,Xs=!1,kc=Or(i,o),mg=!1,Ac=Qa=pg=pl=$s=Vr=0,ga=hf=null,gg=!1,(o&8)!==0&&(o|=o&32);var h=i.entangledLanes;if(h!==0)for(i=i.entanglements,h&=o;0<h;){var g=31-Ve(h),v=1<<g;o|=i[g],h&=~v}return xs=o,dh(),c}function D2(i,o){Ft=null,ne.H=Dh,o===$u||o===Eh?(o=Ky(),ur=3):o===Wy?(o=Ky(),ur=4):ur=o===Y_?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,Ia=o,Vt===null&&(Vr=1,Ph(i,Wa(o,i.current)))}function O2(){var i=ne.H;return ne.H=Dh,i===null?Dh:i}function F2(){var i=ne.A;return ne.A=bN,i}function Eg(){Vr=4,Xs||(Yt&4194048)!==Yt&&Ya.current!==null||(kc=!0),($s&134217727)===0&&(pl&134217727)===0||Tr===null||Qs(Tr,Yt,Qa,!1)}function Tg(i,o,c){var h=cr;cr|=2;var g=O2(),v=F2();(Tr!==i||Yt!==o)&&(Gh=null,Ic(i,o)),o=!1;var I=Vr;e:do try{if(ur!==0&&Vt!==null){var U=Vt,re=Ia;switch(ur){case 8:wg(),I=6;break e;case 3:case 2:case 9:case 6:Ya.current===null&&(o=!0);var ve=ur;if(ur=0,Ia=null,Rc(i,U,re,ve),c&&kc){I=0;break e}break;default:ve=ur,ur=0,Ia=null,Rc(i,U,re,ve)}}AN(),I=Vr;break}catch(Ie){D2(i,Ie)}while(!0);return o&&i.shellSuspendCounter++,cs=cl=null,cr=h,ne.H=g,ne.A=v,Vt===null&&(Tr=null,Yt=0,dh()),I}function AN(){for(;Vt!==null;)L2(Vt)}function CN(i,o){var c=cr;cr|=2;var h=O2(),g=F2();Tr!==i||Yt!==o?(Gh=null,Hh=Ge()+500,Ic(i,o)):kc=Or(i,o);e:do try{if(ur!==0&&Vt!==null){o=Vt;var v=Ia;t:switch(ur){case 1:ur=0,Ia=null,Rc(i,o,v,1);break;case 2:case 9:if(Xy(v)){ur=0,Ia=null,M2(o);break}o=function(){ur!==2&&ur!==9||Tr!==i||(ur=7),Fi(i)},v.then(o,o);break e;case 3:ur=7;break e;case 4:ur=5;break e;case 7:Xy(v)?(ur=0,Ia=null,M2(o)):(ur=0,Ia=null,Rc(i,o,v,7));break;case 5:var I=null;switch(Vt.tag){case 26:I=Vt.memoizedState;case 5:case 27:var U=Vt;if(!I||xw(I)){ur=0,Ia=null;var re=U.sibling;if(re!==null)Vt=re;else{var ve=U.return;ve!==null?(Vt=ve,Wh(ve)):Vt=null}break t}}ur=0,Ia=null,Rc(i,o,v,5);break;case 6:ur=0,Ia=null,Rc(i,o,v,6);break;case 8:wg(),Vr=6;break e;default:throw Error(n(462))}}NN();break}catch(Ie){D2(i,Ie)}while(!0);return cs=cl=null,ne.H=h,ne.A=g,cr=c,Vt!==null?0:(Tr=null,Yt=0,dh(),Vr)}function NN(){for(;Vt!==null&&!Dt();)L2(Vt)}function L2(i){var o=l2(i.alternate,i,xs);i.memoizedProps=i.pendingProps,o===null?Wh(i):Vt=o}function M2(i){var o=i,c=o.alternate;switch(o.tag){case 15:case 0:o=r2(c,o,o.pendingProps,o.type,void 0,Yt);break;case 11:o=r2(c,o,o.pendingProps,o.type.render,o.ref,Yt);break;case 5:jp(o);default:u2(c,o),o=Vt=Py(o,xs),o=l2(c,o,xs)}i.memoizedProps=i.pendingProps,o===null?Wh(i):Vt=o}function Rc(i,o,c,h){cs=cl=null,jp(o),Ec=null,nf=0;var g=o.return;try{if(vN(i,g,o,c,Yt)){Vr=1,Ph(i,Wa(c,i.current)),Vt=null;return}}catch(v){if(g!==null)throw Vt=g,v;Vr=1,Ph(i,Wa(c,i.current)),Vt=null;return}o.flags&32768?(ir||h===1?i=!0:kc||(Yt&536870912)!==0?i=!1:(Xs=i=!0,(h===2||h===9||h===3||h===6)&&(h=Ya.current,h!==null&&h.tag===13&&(h.flags|=16384))),P2(o,i)):Wh(o)}function Wh(i){var o=i;do{if((o.flags&32768)!==0){P2(o,Xs);return}i=o.return;var c=_N(o.alternate,o,xs);if(c!==null){Vt=c;return}if(o=o.sibling,o!==null){Vt=o;return}Vt=o=i}while(o!==null);Vr===0&&(Vr=5)}function P2(i,o){do{var c=wN(i.alternate,i);if(c!==null){c.flags&=32767,Vt=c;return}if(c=i.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!o&&(i=i.sibling,i!==null)){Vt=i;return}Vt=i=c}while(i!==null);Vr=6,Vt=null}function j2(i,o,c,h,g,v,I,U,re){i.cancelPendingCommit=null;do Xh();while(Fn!==0);if((cr&6)!==0)throw Error(n(327));if(o!==null){if(o===i.current)throw Error(n(177));if(v=o.lanes|o.childLanes,v|=dp,Qe(i,c,v,I,U,re),i===Tr&&(Vt=Tr=null,Yt=0),Cc=o,Ys=i,Nc=c,vg=v,yg=g,C2=h,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,ON(wr,function(){return H2(),null})):(i.callbackNode=null,i.callbackPriority=0),h=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||h){h=ne.T,ne.T=null,g=le.p,le.p=2,I=cr,cr|=4;try{EN(i,o,c)}finally{cr=I,le.p=g,ne.T=h}}Fn=1,U2(),B2(),V2()}}function U2(){if(Fn===1){Fn=0;var i=Ys,o=Cc,c=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||c){c=ne.T,ne.T=null;var h=le.p;le.p=2;var g=cr;cr|=4;try{w2(o,i);var v=Lg,I=Ay(i.containerInfo),U=v.focusedElem,re=v.selectionRange;if(I!==U&&U&&U.ownerDocument&&ky(U.ownerDocument.documentElement,U)){if(re!==null&&lp(U)){var ve=re.start,Ie=re.end;if(Ie===void 0&&(Ie=ve),"selectionStart"in U)U.selectionStart=ve,U.selectionEnd=Math.min(Ie,U.value.length);else{var Fe=U.ownerDocument||document,we=Fe&&Fe.defaultView||window;if(we.getSelection){var Ee=we.getSelection(),Et=U.textContent.length,pt=Math.min(re.start,Et),yr=re.end===void 0?pt:Math.min(re.end,Et);!Ee.extend&&pt>yr&&(I=yr,yr=pt,pt=I);var ue=Sy(U,pt),ae=Sy(U,yr);if(ue&&ae&&(Ee.rangeCount!==1||Ee.anchorNode!==ue.node||Ee.anchorOffset!==ue.offset||Ee.focusNode!==ae.node||Ee.focusOffset!==ae.offset)){var pe=Fe.createRange();pe.setStart(ue.node,ue.offset),Ee.removeAllRanges(),pt>yr?(Ee.addRange(pe),Ee.extend(ae.node,ae.offset)):(pe.setEnd(ae.node,ae.offset),Ee.addRange(pe))}}}}for(Fe=[],Ee=U;Ee=Ee.parentNode;)Ee.nodeType===1&&Fe.push({element:Ee,left:Ee.scrollLeft,top:Ee.scrollTop});for(typeof U.focus=="function"&&U.focus(),U=0;U<Fe.length;U++){var Re=Fe[U];Re.element.scrollLeft=Re.left,Re.element.scrollTop=Re.top}}id=!!Fg,Lg=Fg=null}finally{cr=g,le.p=h,ne.T=c}}i.current=o,Fn=2}}function B2(){if(Fn===2){Fn=0;var i=Ys,o=Cc,c=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||c){c=ne.T,ne.T=null;var h=le.p;le.p=2;var g=cr;cr|=4;try{x2(i,o.alternate,o)}finally{cr=g,le.p=h,ne.T=c}}Fn=3}}function V2(){if(Fn===4||Fn===3){Fn=0,nt();var i=Ys,o=Cc,c=Nc,h=C2;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?Fn=5:(Fn=0,Cc=Ys=null,z2(i,i.pendingLanes));var g=i.pendingLanes;if(g===0&&(Ks=null),wn(c),o=o.stateNode,oe&&typeof oe.onCommitFiberRoot=="function")try{oe.onCommitFiberRoot(jt,o,void 0,(o.current.flags&128)===128)}catch{}if(h!==null){o=ne.T,g=le.p,le.p=2,ne.T=null;try{for(var v=i.onRecoverableError,I=0;I<h.length;I++){var U=h[I];v(U.value,{componentStack:U.stack})}}finally{ne.T=o,le.p=g}}(Nc&3)!==0&&Xh(),Fi(i),g=i.pendingLanes,(c&4194090)!==0&&(g&42)!==0?i===_g?df++:(df=0,_g=i):df=0,mf(0)}}function z2(i,o){(i.pooledCacheLanes&=o)===0&&(o=i.pooledCache,o!=null&&(i.pooledCache=null,Wu(o)))}function Xh(i){return U2(),B2(),V2(),H2()}function H2(){if(Fn!==5)return!1;var i=Ys,o=vg;vg=0;var c=wn(Nc),h=ne.T,g=le.p;try{le.p=32>c?32:c,ne.T=null,c=yg,yg=null;var v=Ys,I=Nc;if(Fn=0,Cc=Ys=null,Nc=0,(cr&6)!==0)throw Error(n(331));var U=cr;if(cr|=4,k2(v.current),T2(v,v.current,I,c),cr=U,mf(0,!1),oe&&typeof oe.onPostCommitFiberRoot=="function")try{oe.onPostCommitFiberRoot(jt,v)}catch{}return!0}finally{le.p=g,ne.T=h,z2(i,o)}}function G2(i,o,c){o=Wa(c,o),o=Jp(i.stateNode,o,2),i=Bs(i,o,2),i!==null&&(Ue(i,2),Fi(i))}function Er(i,o,c){if(i.tag===3)G2(i,i,c);else for(;o!==null;){if(o.tag===3){G2(o,i,c);break}else if(o.tag===1){var h=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(Ks===null||!Ks.has(h))){i=Wa(c,i),c=$_(2),h=Bs(o,c,2),h!==null&&(K_(c,h,o,i),Ue(h,2),Fi(h));break}}o=o.return}}function bg(i,o,c){var h=i.pingCache;if(h===null){h=i.pingCache=new SN;var g=new Set;h.set(o,g)}else g=h.get(o),g===void 0&&(g=new Set,h.set(o,g));g.has(c)||(mg=!0,g.add(c),i=IN.bind(null,i,o,c),o.then(i,i))}function IN(i,o,c){var h=i.pingCache;h!==null&&h.delete(o),i.pingedLanes|=i.suspendedLanes&c,i.warmLanes&=~c,Tr===i&&(Yt&c)===c&&(Vr===4||Vr===3&&(Yt&62914560)===Yt&&300>Ge()-xg?(cr&2)===0&&Ic(i,0):pg|=c,Ac===Yt&&(Ac=0)),Fi(i)}function q2(i,o){o===0&&(o=li()),i=hc(i,o),i!==null&&(Ue(i,o),Fi(i))}function RN(i){var o=i.memoizedState,c=0;o!==null&&(c=o.retryLane),q2(i,c)}function DN(i,o){var c=0;switch(i.tag){case 13:var h=i.stateNode,g=i.memoizedState;g!==null&&(c=g.retryLane);break;case 19:h=i.stateNode;break;case 22:h=i.stateNode._retryCache;break;default:throw Error(n(314))}h!==null&&h.delete(o),q2(i,c)}function ON(i,o){return Pt(i,o)}var $h=null,Dc=null,Sg=!1,Kh=!1,kg=!1,gl=0;function Fi(i){i!==Dc&&i.next===null&&(Dc===null?$h=Dc=i:Dc=Dc.next=i),Kh=!0,Sg||(Sg=!0,LN())}function mf(i,o){if(!kg&&Kh){kg=!0;do for(var c=!1,h=$h;h!==null;){if(i!==0){var g=h.pendingLanes;if(g===0)var v=0;else{var I=h.suspendedLanes,U=h.pingedLanes;v=(1<<31-Ve(42|i)+1)-1,v&=g&~(I&~U),v=v&201326741?v&201326741|1:v?v|2:0}v!==0&&(c=!0,K2(h,v))}else v=Yt,v=sr(h,h===Tr?v:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(v&3)===0||Or(h,v)||(c=!0,K2(h,v));h=h.next}while(c);kg=!1}}function FN(){W2()}function W2(){Kh=Sg=!1;var i=0;gl!==0&&(HN()&&(i=gl),gl=0);for(var o=Ge(),c=null,h=$h;h!==null;){var g=h.next,v=X2(h,o);v===0?(h.next=null,c===null?$h=g:c.next=g,g===null&&(Dc=c)):(c=h,(i!==0||(v&3)!==0)&&(Kh=!0)),h=g}mf(i)}function X2(i,o){for(var c=i.suspendedLanes,h=i.pingedLanes,g=i.expirationTimes,v=i.pendingLanes&-62914561;0<v;){var I=31-Ve(v),U=1<<I,re=g[I];re===-1?((U&c)===0||(U&h)!==0)&&(g[I]=fn(U,o)):re<=o&&(i.expiredLanes|=U),v&=~U}if(o=Tr,c=Yt,c=sr(i,i===o?c:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),h=i.callbackNode,c===0||i===o&&(ur===2||ur===9)||i.cancelPendingCommit!==null)return h!==null&&h!==null&&_t(h),i.callbackNode=null,i.callbackPriority=0;if((c&3)===0||Or(i,c)){if(o=c&-c,o===i.callbackPriority)return o;switch(h!==null&&_t(h),wn(c)){case 2:case 8:c=Ct;break;case 32:c=wr;break;case 268435456:c=Dr;break;default:c=wr}return h=$2.bind(null,i),c=Pt(c,h),i.callbackPriority=o,i.callbackNode=c,o}return h!==null&&h!==null&&_t(h),i.callbackPriority=2,i.callbackNode=null,2}function $2(i,o){if(Fn!==0&&Fn!==5)return i.callbackNode=null,i.callbackPriority=0,null;var c=i.callbackNode;if(Xh()&&i.callbackNode!==c)return null;var h=Yt;return h=sr(i,i===Tr?h:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),h===0?null:(I2(i,h,o),X2(i,Ge()),i.callbackNode!=null&&i.callbackNode===c?$2.bind(null,i):null)}function K2(i,o){if(Xh())return null;I2(i,o,!0)}function LN(){qN(function(){(cr&6)!==0?Pt(Jt,FN):W2()})}function Ag(){return gl===0&&(gl=Rn()),gl}function Y2(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:ec(""+i)}function Q2(i,o){var c=o.ownerDocument.createElement("input");return c.name=o.name,c.value=o.value,i.id&&c.setAttribute("form",i.id),o.parentNode.insertBefore(c,o),i=new FormData(i),c.parentNode.removeChild(c),i}function MN(i,o,c,h,g){if(o==="submit"&&c&&c.stateNode===g){var v=Y2((g[Ht]||null).action),I=h.submitter;I&&(o=(o=I[Ht]||null)?Y2(o.formAction):I.getAttribute("formAction"),o!==null&&(v=o,I=null));var U=new tc("action","action",null,h,g);i.push({event:U,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(gl!==0){var re=I?Q2(g,I):new FormData(g);Xp(c,{pending:!0,data:re,method:g.method,action:v},null,re)}}else typeof v=="function"&&(U.preventDefault(),re=I?Q2(g,I):new FormData(g),Xp(c,{pending:!0,data:re,method:g.method,action:v},v,re))},currentTarget:g}]})}}for(var Cg=0;Cg<hp.length;Cg++){var Ng=hp[Cg],PN=Ng.toLowerCase(),jN=Ng[0].toUpperCase()+Ng.slice(1);ui(PN,"on"+jN)}ui(Iy,"onAnimationEnd"),ui(Ry,"onAnimationIteration"),ui(Dy,"onAnimationStart"),ui("dblclick","onDoubleClick"),ui("focusin","onFocus"),ui("focusout","onBlur"),ui(tN,"onTransitionRun"),ui(rN,"onTransitionStart"),ui(nN,"onTransitionCancel"),ui(Oy,"onTransitionEnd"),We("onMouseEnter",["mouseout","mouseover"]),We("onMouseLeave",["mouseout","mouseover"]),We("onPointerEnter",["pointerout","pointerover"]),We("onPointerLeave",["pointerout","pointerover"]),Be("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Be("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Be("onBeforeInput",["compositionend","keypress","textInput","paste"]),Be("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Be("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Be("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var pf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),UN=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(pf));function J2(i,o){o=(o&4)!==0;for(var c=0;c<i.length;c++){var h=i[c],g=h.event;h=h.listeners;e:{var v=void 0;if(o)for(var I=h.length-1;0<=I;I--){var U=h[I],re=U.instance,ve=U.currentTarget;if(U=U.listener,re!==v&&g.isPropagationStopped())break e;v=U,g.currentTarget=ve;try{v(g)}catch(Ie){Mh(Ie)}g.currentTarget=null,v=re}else for(I=0;I<h.length;I++){if(U=h[I],re=U.instance,ve=U.currentTarget,U=U.listener,re!==v&&g.isPropagationStopped())break e;v=U,g.currentTarget=ve;try{v(g)}catch(Ie){Mh(Ie)}g.currentTarget=null,v=re}}}}function zt(i,o){var c=o[Ta];c===void 0&&(c=o[Ta]=new Set);var h=i+"__bubble";c.has(h)||(Z2(o,i,2,!1),c.add(h))}function Ig(i,o,c){var h=0;o&&(h|=4),Z2(c,i,h,o)}var Yh="_reactListening"+Math.random().toString(36).slice(2);function Rg(i){if(!i[Yh]){i[Yh]=!0,ye.forEach(function(c){c!=="selectionchange"&&(UN.has(c)||Ig(c,!1,i),Ig(c,!0,i))});var o=i.nodeType===9?i:i.ownerDocument;o===null||o[Yh]||(o[Yh]=!0,Ig("selectionchange",!1,o))}}function Z2(i,o,c,h){switch(Tw(o)){case 2:var g=h3;break;case 8:g=d3;break;default:g=qg}c=g.bind(null,o,c,i),g=void 0,!Ga||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(g=!0),h?g!==void 0?i.addEventListener(o,c,{capture:!0,passive:g}):i.addEventListener(o,c,!0):g!==void 0?i.addEventListener(o,c,{passive:g}):i.addEventListener(o,c,!1)}function Dg(i,o,c,h,g){var v=h;if((o&1)===0&&(o&2)===0&&h!==null)e:for(;;){if(h===null)return;var I=h.tag;if(I===3||I===4){var U=h.stateNode.containerInfo;if(U===g)break;if(I===4)for(I=h.return;I!==null;){var re=I.tag;if((re===3||re===4)&&I.stateNode.containerInfo===g)return;I=I.return}for(;U!==null;){if(I=Q(U),I===null)return;if(re=I.tag,re===5||re===6||re===26||re===27){h=v=I;continue e}U=U.parentNode}}h=h.return}J0(function(){var ve=v,Ie=Ha(c),Fe=[];e:{var we=Fy.get(i);if(we!==void 0){var Ee=tc,Et=i;switch(i){case"keypress":if(Si(c)===0)break e;case"keydown":case"keyup":Ee=oc;break;case"focusin":Et="focus",Ee=ac;break;case"focusout":Et="blur",Ee=ac;break;case"beforeblur":case"afterblur":Ee=ac;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ee=qa;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ee=ap;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ee=sh;break;case Iy:case Ry:case Dy:Ee=ic;break;case Oy:Ee=lh;break;case"scroll":case"scrollend":Ee=Z0;break;case"wheel":Ee=lc;break;case"copy":case"cut":case"paste":Ee=sc;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ee=ju;break;case"toggle":case"beforetoggle":Ee=uh}var pt=(o&4)!==0,yr=!pt&&(i==="scroll"||i==="scrollend"),ue=pt?we!==null?we+"Capture":null:we;pt=[];for(var ae=ve,pe;ae!==null;){var Re=ae;if(pe=Re.stateNode,Re=Re.tag,Re!==5&&Re!==26&&Re!==27||pe===null||ue===null||(Re=Ko(ae,ue),Re!=null&&pt.push(gf(ae,Re,pe))),yr)break;ae=ae.return}0<pt.length&&(we=new Ee(we,Et,null,c,Ie),Fe.push({event:we,listeners:pt}))}}if((o&7)===0){e:{if(we=i==="mouseover"||i==="pointerover",Ee=i==="mouseout"||i==="pointerout",we&&c!==es&&(Et=c.relatedTarget||c.fromElement)&&(Q(Et)||Et[Nt]))break e;if((Ee||we)&&(we=Ie.window===Ie?Ie:(we=Ie.ownerDocument)?we.defaultView||we.parentWindow:window,Ee?(Et=c.relatedTarget||c.toElement,Ee=ve,Et=Et?Q(Et):null,Et!==null&&(yr=s(Et),pt=Et.tag,Et!==yr||pt!==5&&pt!==27&&pt!==6)&&(Et=null)):(Ee=null,Et=ve),Ee!==Et)){if(pt=qa,Re="onMouseLeave",ue="onMouseEnter",ae="mouse",(i==="pointerout"||i==="pointerover")&&(pt=ju,Re="onPointerLeave",ue="onPointerEnter",ae="pointer"),yr=Ee==null?we:de(Ee),pe=Et==null?we:de(Et),we=new pt(Re,ae+"leave",Ee,c,Ie),we.target=yr,we.relatedTarget=pe,Re=null,Q(Ie)===ve&&(pt=new pt(ue,ae+"enter",Et,c,Ie),pt.target=pe,pt.relatedTarget=yr,Re=pt),yr=Re,Ee&&Et)t:{for(pt=Ee,ue=Et,ae=0,pe=pt;pe;pe=Oc(pe))ae++;for(pe=0,Re=ue;Re;Re=Oc(Re))pe++;for(;0<ae-pe;)pt=Oc(pt),ae--;for(;0<pe-ae;)ue=Oc(ue),pe--;for(;ae--;){if(pt===ue||ue!==null&&pt===ue.alternate)break t;pt=Oc(pt),ue=Oc(ue)}pt=null}else pt=null;Ee!==null&&ew(Fe,we,Ee,pt,!1),Et!==null&&yr!==null&&ew(Fe,yr,Et,pt,!0)}}e:{if(we=ve?de(ve):window,Ee=we.nodeName&&we.nodeName.toLowerCase(),Ee==="select"||Ee==="input"&&we.type==="file")var it=yy;else if(dn(we))if(_y)it=JC;else{it=YC;var Ut=KC}else Ee=we.nodeName,!Ee||Ee.toLowerCase()!=="input"||we.type!=="checkbox"&&we.type!=="radio"?ve&&Ru(ve.elementType)&&(it=yy):it=QC;if(it&&(it=it(i,ve))){is(Fe,it,c,Ie);break e}Ut&&Ut(i,we,ve),i==="focusout"&&ve&&we.type==="number"&&ve.memoizedProps.value!=null&&Ls(we,"number",we.value)}switch(Ut=ve?de(ve):window,i){case"focusin":(dn(Ut)||Ut.contentEditable==="true")&&(cc=Ut,cp=ve,Vu=null);break;case"focusout":Vu=cp=cc=null;break;case"mousedown":up=!0;break;case"contextmenu":case"mouseup":case"dragend":up=!1,Cy(Fe,c,Ie);break;case"selectionchange":if(eN)break;case"keydown":case"keyup":Cy(Fe,c,Ie)}var ut;if(Ci)e:{switch(i){case"compositionstart":var gt="onCompositionStart";break e;case"compositionend":gt="onCompositionEnd";break e;case"compositionupdate":gt="onCompositionUpdate";break e}gt=void 0}else $t?be(i,c)&&(gt="onCompositionEnd"):i==="keydown"&&c.keyCode===229&&(gt="onCompositionStart");gt&&(C&&c.locale!=="ko"&&($t||gt!=="onCompositionStart"?gt==="onCompositionEnd"&&$t&&(ut=Ou()):(bi=Ie,Ms="value"in bi?bi.value:bi.textContent,$t=!0)),Ut=Qh(ve,gt),0<Ut.length&&(gt=new Mu(gt,i,null,c,Ie),Fe.push({event:gt,listeners:Ut}),ut?gt.data=ut:(ut=Ke(c),ut!==null&&(gt.data=ut)))),(ut=T?hn(i,c):Kt(i,c))&&(gt=Qh(ve,"onBeforeInput"),0<gt.length&&(Ut=new Mu("onBeforeInput","beforeinput",null,c,Ie),Fe.push({event:Ut,listeners:gt}),Ut.data=ut)),MN(Fe,i,ve,c,Ie)}J2(Fe,o)})}function gf(i,o,c){return{instance:i,listener:o,currentTarget:c}}function Qh(i,o){for(var c=o+"Capture",h=[];i!==null;){var g=i,v=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||v===null||(g=Ko(i,c),g!=null&&h.unshift(gf(i,g,v)),g=Ko(i,o),g!=null&&h.push(gf(i,g,v))),i.tag===3)return h;i=i.return}return[]}function Oc(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function ew(i,o,c,h,g){for(var v=o._reactName,I=[];c!==null&&c!==h;){var U=c,re=U.alternate,ve=U.stateNode;if(U=U.tag,re!==null&&re===h)break;U!==5&&U!==26&&U!==27||ve===null||(re=ve,g?(ve=Ko(c,v),ve!=null&&I.unshift(gf(c,ve,re))):g||(ve=Ko(c,v),ve!=null&&I.push(gf(c,ve,re)))),c=c.return}I.length!==0&&i.push({event:o,listeners:I})}var BN=/\r\n?/g,VN=/\u0000|\uFFFD/g;function tw(i){return(typeof i=="string"?i:""+i).replace(BN,`
`).replace(VN,"")}function rw(i,o){return o=tw(o),tw(i)===o}function Jh(){}function vr(i,o,c,h,g,v){switch(c){case"children":typeof h=="string"?o==="body"||o==="textarea"&&h===""||za(i,h):(typeof h=="number"||typeof h=="bigint")&&o!=="body"&&za(i,""+h);break;case"className":Wt(i,"class",h);break;case"tabIndex":Wt(i,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":Wt(i,c,h);break;case"style":Iu(i,h,v);break;case"data":if(o!=="object"){Wt(i,"data",h);break}case"src":case"href":if(h===""&&(o!=="a"||c!=="href")){i.removeAttribute(c);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){i.removeAttribute(c);break}h=ec(""+h),i.setAttribute(c,h);break;case"action":case"formAction":if(typeof h=="function"){i.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof v=="function"&&(c==="formAction"?(o!=="input"&&vr(i,o,"name",g.name,g,null),vr(i,o,"formEncType",g.formEncType,g,null),vr(i,o,"formMethod",g.formMethod,g,null),vr(i,o,"formTarget",g.formTarget,g,null)):(vr(i,o,"encType",g.encType,g,null),vr(i,o,"method",g.method,g,null),vr(i,o,"target",g.target,g,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){i.removeAttribute(c);break}h=ec(""+h),i.setAttribute(c,h);break;case"onClick":h!=null&&(i.onclick=Jh);break;case"onScroll":h!=null&&zt("scroll",i);break;case"onScrollEnd":h!=null&&zt("scrollend",i);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(n(61));if(c=h.__html,c!=null){if(g.children!=null)throw Error(n(60));i.innerHTML=c}}break;case"multiple":i.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":i.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){i.removeAttribute("xlink:href");break}c=ec(""+h),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?i.setAttribute(c,""+h):i.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?i.setAttribute(c,""):i.removeAttribute(c);break;case"capture":case"download":h===!0?i.setAttribute(c,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?i.setAttribute(c,h):i.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?i.setAttribute(c,h):i.removeAttribute(c);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?i.removeAttribute(c):i.setAttribute(c,h);break;case"popover":zt("beforetoggle",i),zt("toggle",i),rr(i,"popover",h);break;case"xlinkActuate":Xt(i,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":Xt(i,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":Xt(i,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":Xt(i,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":Xt(i,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":Xt(i,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":Xt(i,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":Xt(i,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":Xt(i,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":rr(i,"is",h);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=rp.get(c)||c,rr(i,c,h))}}function Og(i,o,c,h,g,v){switch(c){case"style":Iu(i,h,v);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(n(61));if(c=h.__html,c!=null){if(g.children!=null)throw Error(n(60));i.innerHTML=c}}break;case"children":typeof h=="string"?za(i,h):(typeof h=="number"||typeof h=="bigint")&&za(i,""+h);break;case"onScroll":h!=null&&zt("scroll",i);break;case"onScrollEnd":h!=null&&zt("scrollend",i);break;case"onClick":h!=null&&(i.onclick=Jh);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!_e.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(g=c.endsWith("Capture"),o=c.slice(2,g?c.length-7:void 0),v=i[Ht]||null,v=v!=null?v[c]:null,typeof v=="function"&&i.removeEventListener(o,v,g),typeof h=="function")){typeof v!="function"&&v!==null&&(c in i?i[c]=null:i.hasAttribute(c)&&i.removeAttribute(c)),i.addEventListener(o,h,g);break e}c in i?i[c]=h:h===!0?i.setAttribute(c,""):rr(i,c,h)}}}function Ln(i,o,c){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":zt("error",i),zt("load",i);var h=!1,g=!1,v;for(v in c)if(c.hasOwnProperty(v)){var I=c[v];if(I!=null)switch(v){case"src":h=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:vr(i,o,v,I,c,null)}}g&&vr(i,o,"srcSet",c.srcSet,c,null),h&&vr(i,o,"src",c.src,c,null);return;case"input":zt("invalid",i);var U=v=I=g=null,re=null,ve=null;for(h in c)if(c.hasOwnProperty(h)){var Ie=c[h];if(Ie!=null)switch(h){case"name":g=Ie;break;case"type":I=Ie;break;case"checked":re=Ie;break;case"defaultChecked":ve=Ie;break;case"value":v=Ie;break;case"defaultValue":U=Ie;break;case"children":case"dangerouslySetInnerHTML":if(Ie!=null)throw Error(n(137,o));break;default:vr(i,o,h,Ie,c,null)}}Wo(i,v,U,re,ve,I,g,!1),Zl(i);return;case"select":zt("invalid",i),h=I=v=null;for(g in c)if(c.hasOwnProperty(g)&&(U=c[g],U!=null))switch(g){case"value":v=U;break;case"defaultValue":I=U;break;case"multiple":h=U;default:vr(i,o,g,U,c,null)}o=v,c=I,i.multiple=!!h,o!=null?Zi(i,!!h,o,!1):c!=null&&Zi(i,!!h,c,!0);return;case"textarea":zt("invalid",i),v=g=h=null;for(I in c)if(c.hasOwnProperty(I)&&(U=c[I],U!=null))switch(I){case"value":h=U;break;case"defaultValue":g=U;break;case"children":v=U;break;case"dangerouslySetInnerHTML":if(U!=null)throw Error(n(91));break;default:vr(i,o,I,U,c,null)}Xo(i,h,g,v),Zl(i);return;case"option":for(re in c)if(c.hasOwnProperty(re)&&(h=c[re],h!=null))switch(re){case"selected":i.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:vr(i,o,re,h,c,null)}return;case"dialog":zt("beforetoggle",i),zt("toggle",i),zt("cancel",i),zt("close",i);break;case"iframe":case"object":zt("load",i);break;case"video":case"audio":for(h=0;h<pf.length;h++)zt(pf[h],i);break;case"image":zt("error",i),zt("load",i);break;case"details":zt("toggle",i);break;case"embed":case"source":case"link":zt("error",i),zt("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ve in c)if(c.hasOwnProperty(ve)&&(h=c[ve],h!=null))switch(ve){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:vr(i,o,ve,h,c,null)}return;default:if(Ru(o)){for(Ie in c)c.hasOwnProperty(Ie)&&(h=c[Ie],h!==void 0&&Og(i,o,Ie,h,c,void 0));return}}for(U in c)c.hasOwnProperty(U)&&(h=c[U],h!=null&&vr(i,o,U,h,c,null))}function zN(i,o,c,h){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,v=null,I=null,U=null,re=null,ve=null,Ie=null;for(Ee in c){var Fe=c[Ee];if(c.hasOwnProperty(Ee)&&Fe!=null)switch(Ee){case"checked":break;case"value":break;case"defaultValue":re=Fe;default:h.hasOwnProperty(Ee)||vr(i,o,Ee,null,h,Fe)}}for(var we in h){var Ee=h[we];if(Fe=c[we],h.hasOwnProperty(we)&&(Ee!=null||Fe!=null))switch(we){case"type":v=Ee;break;case"name":g=Ee;break;case"checked":ve=Ee;break;case"defaultChecked":Ie=Ee;break;case"value":I=Ee;break;case"defaultValue":U=Ee;break;case"children":case"dangerouslySetInnerHTML":if(Ee!=null)throw Error(n(137,o));break;default:Ee!==Fe&&vr(i,o,we,Ee,h,Fe)}}Sa(i,I,U,re,ve,Ie,v,g);return;case"select":Ee=I=U=we=null;for(v in c)if(re=c[v],c.hasOwnProperty(v)&&re!=null)switch(v){case"value":break;case"multiple":Ee=re;default:h.hasOwnProperty(v)||vr(i,o,v,null,h,re)}for(g in h)if(v=h[g],re=c[g],h.hasOwnProperty(g)&&(v!=null||re!=null))switch(g){case"value":we=v;break;case"defaultValue":U=v;break;case"multiple":I=v;default:v!==re&&vr(i,o,g,v,h,re)}o=U,c=I,h=Ee,we!=null?Zi(i,!!c,we,!1):!!h!=!!c&&(o!=null?Zi(i,!!c,o,!0):Zi(i,!!c,c?[]:"",!1));return;case"textarea":Ee=we=null;for(U in c)if(g=c[U],c.hasOwnProperty(U)&&g!=null&&!h.hasOwnProperty(U))switch(U){case"value":break;case"children":break;default:vr(i,o,U,null,h,g)}for(I in h)if(g=h[I],v=c[I],h.hasOwnProperty(I)&&(g!=null||v!=null))switch(I){case"value":we=g;break;case"defaultValue":Ee=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(n(91));break;default:g!==v&&vr(i,o,I,g,h,v)}gr(i,we,Ee);return;case"option":for(var Et in c)if(we=c[Et],c.hasOwnProperty(Et)&&we!=null&&!h.hasOwnProperty(Et))switch(Et){case"selected":i.selected=!1;break;default:vr(i,o,Et,null,h,we)}for(re in h)if(we=h[re],Ee=c[re],h.hasOwnProperty(re)&&we!==Ee&&(we!=null||Ee!=null))switch(re){case"selected":i.selected=we&&typeof we!="function"&&typeof we!="symbol";break;default:vr(i,o,re,we,h,Ee)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var pt in c)we=c[pt],c.hasOwnProperty(pt)&&we!=null&&!h.hasOwnProperty(pt)&&vr(i,o,pt,null,h,we);for(ve in h)if(we=h[ve],Ee=c[ve],h.hasOwnProperty(ve)&&we!==Ee&&(we!=null||Ee!=null))switch(ve){case"children":case"dangerouslySetInnerHTML":if(we!=null)throw Error(n(137,o));break;default:vr(i,o,ve,we,h,Ee)}return;default:if(Ru(o)){for(var yr in c)we=c[yr],c.hasOwnProperty(yr)&&we!==void 0&&!h.hasOwnProperty(yr)&&Og(i,o,yr,void 0,h,we);for(Ie in h)we=h[Ie],Ee=c[Ie],!h.hasOwnProperty(Ie)||we===Ee||we===void 0&&Ee===void 0||Og(i,o,Ie,we,h,Ee);return}}for(var ue in c)we=c[ue],c.hasOwnProperty(ue)&&we!=null&&!h.hasOwnProperty(ue)&&vr(i,o,ue,null,h,we);for(Fe in h)we=h[Fe],Ee=c[Fe],!h.hasOwnProperty(Fe)||we===Ee||we==null&&Ee==null||vr(i,o,Fe,we,h,Ee)}var Fg=null,Lg=null;function Zh(i){return i.nodeType===9?i:i.ownerDocument}function nw(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function aw(i,o){if(i===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&o==="foreignObject"?0:i}function Mg(i,o){return i==="textarea"||i==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Pg=null;function HN(){var i=window.event;return i&&i.type==="popstate"?i===Pg?!1:(Pg=i,!0):(Pg=null,!1)}var iw=typeof setTimeout=="function"?setTimeout:void 0,GN=typeof clearTimeout=="function"?clearTimeout:void 0,sw=typeof Promise=="function"?Promise:void 0,qN=typeof queueMicrotask=="function"?queueMicrotask:typeof sw<"u"?function(i){return sw.resolve(null).then(i).catch(WN)}:iw;function WN(i){setTimeout(function(){throw i})}function Js(i){return i==="head"}function ow(i,o){var c=o,h=0,g=0;do{var v=c.nextSibling;if(i.removeChild(c),v&&v.nodeType===8)if(c=v.data,c==="/$"){if(0<h&&8>h){c=h;var I=i.ownerDocument;if(c&1&&xf(I.documentElement),c&2&&xf(I.body),c&4)for(c=I.head,xf(c),I=c.firstChild;I;){var U=I.nextSibling,re=I.nodeName;I[H]||re==="SCRIPT"||re==="STYLE"||re==="LINK"&&I.rel.toLowerCase()==="stylesheet"||c.removeChild(I),I=U}}if(g===0){i.removeChild(v),Sf(o);return}g--}else c==="$"||c==="$?"||c==="$!"?g++:h=c.charCodeAt(0)-48;else h=0;c=v}while(c);Sf(o)}function jg(i){var o=i.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var c=o;switch(o=o.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":jg(c),q(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}i.removeChild(c)}}function XN(i,o,c,h){for(;i.nodeType===1;){var g=c;if(i.nodeName.toLowerCase()!==o.toLowerCase()){if(!h&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(h){if(!i[H])switch(o){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(v=i.getAttribute("rel"),v==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(v!==g.rel||i.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||i.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||i.getAttribute("title")!==(g.title==null?null:g.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(v=i.getAttribute("src"),(v!==(g.src==null?null:g.src)||i.getAttribute("type")!==(g.type==null?null:g.type)||i.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&v&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(o==="input"&&i.type==="hidden"){var v=g.name==null?null:""+g.name;if(g.type==="hidden"&&i.getAttribute("name")===v)return i}else return i;if(i=hi(i.nextSibling),i===null)break}return null}function $N(i,o,c){if(o==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!c||(i=hi(i.nextSibling),i===null))return null;return i}function Ug(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState==="complete"}function KN(i,o){var c=i.ownerDocument;if(i.data!=="$?"||c.readyState==="complete")o();else{var h=function(){o(),c.removeEventListener("DOMContentLoaded",h)};c.addEventListener("DOMContentLoaded",h),i._reactRetry=h}}function hi(i){for(;i!=null;i=i.nextSibling){var o=i.nodeType;if(o===1||o===3)break;if(o===8){if(o=i.data,o==="$"||o==="$!"||o==="$?"||o==="F!"||o==="F")break;if(o==="/$")return null}}return i}var Bg=null;function lw(i){i=i.previousSibling;for(var o=0;i;){if(i.nodeType===8){var c=i.data;if(c==="$"||c==="$!"||c==="$?"){if(o===0)return i;o--}else c==="/$"&&o++}i=i.previousSibling}return null}function cw(i,o,c){switch(o=Zh(c),i){case"html":if(i=o.documentElement,!i)throw Error(n(452));return i;case"head":if(i=o.head,!i)throw Error(n(453));return i;case"body":if(i=o.body,!i)throw Error(n(454));return i;default:throw Error(n(451))}}function xf(i){for(var o=i.attributes;o.length;)i.removeAttributeNode(o[0]);q(i)}var Ja=new Map,uw=new Set;function ed(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var vs=le.d;le.d={f:YN,r:QN,D:JN,C:ZN,L:e3,m:t3,X:n3,S:r3,M:a3};function YN(){var i=vs.f(),o=qh();return i||o}function QN(i){var o=Y(i);o!==null&&o.tag===5&&o.type==="form"?I_(o):vs.r(i)}var Fc=typeof document>"u"?null:document;function fw(i,o,c){var h=Fc;if(h&&typeof o=="string"&&o){var g=tn(o);g='link[rel="'+i+'"][href="'+g+'"]',typeof c=="string"&&(g+='[crossorigin="'+c+'"]'),uw.has(g)||(uw.add(g),i={rel:i,crossOrigin:c,href:o},h.querySelector(g)===null&&(o=h.createElement("link"),Ln(o,"link",i),ce(o),h.head.appendChild(o)))}}function JN(i){vs.D(i),fw("dns-prefetch",i,null)}function ZN(i,o){vs.C(i,o),fw("preconnect",i,o)}function e3(i,o,c){vs.L(i,o,c);var h=Fc;if(h&&i&&o){var g='link[rel="preload"][as="'+tn(o)+'"]';o==="image"&&c&&c.imageSrcSet?(g+='[imagesrcset="'+tn(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(g+='[imagesizes="'+tn(c.imageSizes)+'"]')):g+='[href="'+tn(i)+'"]';var v=g;switch(o){case"style":v=Lc(i);break;case"script":v=Mc(i)}Ja.has(v)||(i=m({rel:"preload",href:o==="image"&&c&&c.imageSrcSet?void 0:i,as:o},c),Ja.set(v,i),h.querySelector(g)!==null||o==="style"&&h.querySelector(vf(v))||o==="script"&&h.querySelector(yf(v))||(o=h.createElement("link"),Ln(o,"link",i),ce(o),h.head.appendChild(o)))}}function t3(i,o){vs.m(i,o);var c=Fc;if(c&&i){var h=o&&typeof o.as=="string"?o.as:"script",g='link[rel="modulepreload"][as="'+tn(h)+'"][href="'+tn(i)+'"]',v=g;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":v=Mc(i)}if(!Ja.has(v)&&(i=m({rel:"modulepreload",href:i},o),Ja.set(v,i),c.querySelector(g)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(yf(v)))return}h=c.createElement("link"),Ln(h,"link",i),ce(h),c.head.appendChild(h)}}}function r3(i,o,c){vs.S(i,o,c);var h=Fc;if(h&&i){var g=Te(h).hoistableStyles,v=Lc(i);o=o||"default";var I=g.get(v);if(!I){var U={loading:0,preload:null};if(I=h.querySelector(vf(v)))U.loading=5;else{i=m({rel:"stylesheet",href:i,"data-precedence":o},c),(c=Ja.get(v))&&Vg(i,c);var re=I=h.createElement("link");ce(re),Ln(re,"link",i),re._p=new Promise(function(ve,Ie){re.onload=ve,re.onerror=Ie}),re.addEventListener("load",function(){U.loading|=1}),re.addEventListener("error",function(){U.loading|=2}),U.loading|=4,td(I,o,h)}I={type:"stylesheet",instance:I,count:1,state:U},g.set(v,I)}}}function n3(i,o){vs.X(i,o);var c=Fc;if(c&&i){var h=Te(c).hoistableScripts,g=Mc(i),v=h.get(g);v||(v=c.querySelector(yf(g)),v||(i=m({src:i,async:!0},o),(o=Ja.get(g))&&zg(i,o),v=c.createElement("script"),ce(v),Ln(v,"link",i),c.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},h.set(g,v))}}function a3(i,o){vs.M(i,o);var c=Fc;if(c&&i){var h=Te(c).hoistableScripts,g=Mc(i),v=h.get(g);v||(v=c.querySelector(yf(g)),v||(i=m({src:i,async:!0,type:"module"},o),(o=Ja.get(g))&&zg(i,o),v=c.createElement("script"),ce(v),Ln(v,"link",i),c.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},h.set(g,v))}}function hw(i,o,c,h){var g=(g=fe.current)?ed(g):null;if(!g)throw Error(n(446));switch(i){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(o=Lc(c.href),c=Te(g).hoistableStyles,h=c.get(o),h||(h={type:"style",instance:null,count:0,state:null},c.set(o,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){i=Lc(c.href);var v=Te(g).hoistableStyles,I=v.get(i);if(I||(g=g.ownerDocument||g,I={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},v.set(i,I),(v=g.querySelector(vf(i)))&&!v._p&&(I.instance=v,I.state.loading=5),Ja.has(i)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},Ja.set(i,c),v||i3(g,i,c,I.state))),o&&h===null)throw Error(n(528,""));return I}if(o&&h!==null)throw Error(n(529,""));return null;case"script":return o=c.async,c=c.src,typeof c=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=Mc(c),c=Te(g).hoistableScripts,h=c.get(o),h||(h={type:"script",instance:null,count:0,state:null},c.set(o,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,i))}}function Lc(i){return'href="'+tn(i)+'"'}function vf(i){return'link[rel="stylesheet"]['+i+"]"}function dw(i){return m({},i,{"data-precedence":i.precedence,precedence:null})}function i3(i,o,c,h){i.querySelector('link[rel="preload"][as="style"]['+o+"]")?h.loading=1:(o=i.createElement("link"),h.preload=o,o.addEventListener("load",function(){return h.loading|=1}),o.addEventListener("error",function(){return h.loading|=2}),Ln(o,"link",c),ce(o),i.head.appendChild(o))}function Mc(i){return'[src="'+tn(i)+'"]'}function yf(i){return"script[async]"+i}function mw(i,o,c){if(o.count++,o.instance===null)switch(o.type){case"style":var h=i.querySelector('style[data-href~="'+tn(c.href)+'"]');if(h)return o.instance=h,ce(h),h;var g=m({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return h=(i.ownerDocument||i).createElement("style"),ce(h),Ln(h,"style",g),td(h,c.precedence,i),o.instance=h;case"stylesheet":g=Lc(c.href);var v=i.querySelector(vf(g));if(v)return o.state.loading|=4,o.instance=v,ce(v),v;h=dw(c),(g=Ja.get(g))&&Vg(h,g),v=(i.ownerDocument||i).createElement("link"),ce(v);var I=v;return I._p=new Promise(function(U,re){I.onload=U,I.onerror=re}),Ln(v,"link",h),o.state.loading|=4,td(v,c.precedence,i),o.instance=v;case"script":return v=Mc(c.src),(g=i.querySelector(yf(v)))?(o.instance=g,ce(g),g):(h=c,(g=Ja.get(v))&&(h=m({},c),zg(h,g)),i=i.ownerDocument||i,g=i.createElement("script"),ce(g),Ln(g,"link",h),i.head.appendChild(g),o.instance=g);case"void":return null;default:throw Error(n(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(h=o.instance,o.state.loading|=4,td(h,c.precedence,i));return o.instance}function td(i,o,c){for(var h=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=h.length?h[h.length-1]:null,v=g,I=0;I<h.length;I++){var U=h[I];if(U.dataset.precedence===o)v=U;else if(v!==g)break}v?v.parentNode.insertBefore(i,v.nextSibling):(o=c.nodeType===9?c.head:c,o.insertBefore(i,o.firstChild))}function Vg(i,o){i.crossOrigin==null&&(i.crossOrigin=o.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=o.referrerPolicy),i.title==null&&(i.title=o.title)}function zg(i,o){i.crossOrigin==null&&(i.crossOrigin=o.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=o.referrerPolicy),i.integrity==null&&(i.integrity=o.integrity)}var rd=null;function pw(i,o,c){if(rd===null){var h=new Map,g=rd=new Map;g.set(c,h)}else g=rd,h=g.get(c),h||(h=new Map,g.set(c,h));if(h.has(i))return h;for(h.set(i,null),c=c.getElementsByTagName(i),g=0;g<c.length;g++){var v=c[g];if(!(v[H]||v[bt]||i==="link"&&v.getAttribute("rel")==="stylesheet")&&v.namespaceURI!=="http://www.w3.org/2000/svg"){var I=v.getAttribute(o)||"";I=i+I;var U=h.get(I);U?U.push(v):h.set(I,[v])}}return h}function gw(i,o,c){i=i.ownerDocument||i,i.head.insertBefore(c,o==="title"?i.querySelector("head > title"):null)}function s3(i,o,c){if(c===1||o.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return i=o.disabled,typeof o.precedence=="string"&&i==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function xw(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}var _f=null;function o3(){}function l3(i,o,c){if(_f===null)throw Error(n(475));var h=_f;if(o.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var g=Lc(c.href),v=i.querySelector(vf(g));if(v){i=v._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(h.count++,h=nd.bind(h),i.then(h,h)),o.state.loading|=4,o.instance=v,ce(v);return}v=i.ownerDocument||i,c=dw(c),(g=Ja.get(g))&&Vg(c,g),v=v.createElement("link"),ce(v);var I=v;I._p=new Promise(function(U,re){I.onload=U,I.onerror=re}),Ln(v,"link",c),o.instance=v}h.stylesheets===null&&(h.stylesheets=new Map),h.stylesheets.set(o,i),(i=o.state.preload)&&(o.state.loading&3)===0&&(h.count++,o=nd.bind(h),i.addEventListener("load",o),i.addEventListener("error",o))}}function c3(){if(_f===null)throw Error(n(475));var i=_f;return i.stylesheets&&i.count===0&&Hg(i,i.stylesheets),0<i.count?function(o){var c=setTimeout(function(){if(i.stylesheets&&Hg(i,i.stylesheets),i.unsuspend){var h=i.unsuspend;i.unsuspend=null,h()}},6e4);return i.unsuspend=o,function(){i.unsuspend=null,clearTimeout(c)}}:null}function nd(){if(this.count--,this.count===0){if(this.stylesheets)Hg(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var ad=null;function Hg(i,o){i.stylesheets=null,i.unsuspend!==null&&(i.count++,ad=new Map,o.forEach(u3,i),ad=null,nd.call(i))}function u3(i,o){if(!(o.state.loading&4)){var c=ad.get(i);if(c)var h=c.get(null);else{c=new Map,ad.set(i,c);for(var g=i.querySelectorAll("link[data-precedence],style[data-precedence]"),v=0;v<g.length;v++){var I=g[v];(I.nodeName==="LINK"||I.getAttribute("media")!=="not all")&&(c.set(I.dataset.precedence,I),h=I)}h&&c.set(null,h)}g=o.instance,I=g.getAttribute("data-precedence"),v=c.get(I)||h,v===h&&c.set(null,g),c.set(I,g),this.count++,h=nd.bind(this),g.addEventListener("load",h),g.addEventListener("error",h),v?v.parentNode.insertBefore(g,v.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(g,i.firstChild)),o.state.loading|=4}}var wf={$$typeof:F,Provider:null,Consumer:null,_currentValue:He,_currentValue2:He,_threadCount:0};function f3(i,o,c,h,g,v,I,U){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=se(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=se(0),this.hiddenUpdates=se(null),this.identifierPrefix=h,this.onUncaughtError=g,this.onCaughtError=v,this.onRecoverableError=I,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=U,this.incompleteTransitions=new Map}function vw(i,o,c,h,g,v,I,U,re,ve,Ie,Fe){return i=new f3(i,o,c,I,U,re,ve,Fe),o=1,v===!0&&(o|=24),v=Aa(3,null,null,o),i.current=v,v.stateNode=i,o=bp(),o.refCount++,i.pooledCache=o,o.refCount++,v.memoizedState={element:h,isDehydrated:c,cache:o},Cp(v),i}function yw(i){return i?(i=dc,i):dc}function _w(i,o,c,h,g,v){g=yw(g),h.context===null?h.context=g:h.pendingContext=g,h=Us(o),h.payload={element:c},v=v===void 0?null:v,v!==null&&(h.callback=v),c=Bs(i,h,o),c!==null&&(Da(c,i,o),Yu(c,i,o))}function ww(i,o){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var c=i.retryLane;i.retryLane=c!==0&&c<o?c:o}}function Gg(i,o){ww(i,o),(i=i.alternate)&&ww(i,o)}function Ew(i){if(i.tag===13){var o=hc(i,67108864);o!==null&&Da(o,i,67108864),Gg(i,67108864)}}var id=!0;function h3(i,o,c,h){var g=ne.T;ne.T=null;var v=le.p;try{le.p=2,qg(i,o,c,h)}finally{le.p=v,ne.T=g}}function d3(i,o,c,h){var g=ne.T;ne.T=null;var v=le.p;try{le.p=8,qg(i,o,c,h)}finally{le.p=v,ne.T=g}}function qg(i,o,c,h){if(id){var g=Wg(h);if(g===null)Dg(i,o,h,sd,c),bw(i,h);else if(p3(g,i,o,c,h))h.stopPropagation();else if(bw(i,h),o&4&&-1<m3.indexOf(i)){for(;g!==null;){var v=Y(g);if(v!==null)switch(v.tag){case 3:if(v=v.stateNode,v.current.memoizedState.isDehydrated){var I=ct(v.pendingLanes);if(I!==0){var U=v;for(U.pendingLanes|=2,U.entangledLanes|=2;I;){var re=1<<31-Ve(I);U.entanglements[1]|=re,I&=~re}Fi(v),(cr&6)===0&&(Hh=Ge()+500,mf(0))}}break;case 13:U=hc(v,2),U!==null&&Da(U,v,2),qh(),Gg(v,2)}if(v=Wg(h),v===null&&Dg(i,o,h,sd,c),v===g)break;g=v}g!==null&&h.stopPropagation()}else Dg(i,o,h,null,c)}}function Wg(i){return i=Ha(i),Xg(i)}var sd=null;function Xg(i){if(sd=null,i=Q(i),i!==null){var o=s(i);if(o===null)i=null;else{var c=o.tag;if(c===13){if(i=l(o),i!==null)return i;i=null}else if(c===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;i=null}else o!==i&&(i=null)}}return sd=i,null}function Tw(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(tr()){case Jt:return 2;case Ct:return 8;case wr:case _n:return 32;case Dr:return 268435456;default:return 32}default:return 32}}var $g=!1,Zs=null,eo=null,to=null,Ef=new Map,Tf=new Map,ro=[],m3="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function bw(i,o){switch(i){case"focusin":case"focusout":Zs=null;break;case"dragenter":case"dragleave":eo=null;break;case"mouseover":case"mouseout":to=null;break;case"pointerover":case"pointerout":Ef.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Tf.delete(o.pointerId)}}function bf(i,o,c,h,g,v){return i===null||i.nativeEvent!==v?(i={blockedOn:o,domEventName:c,eventSystemFlags:h,nativeEvent:v,targetContainers:[g]},o!==null&&(o=Y(o),o!==null&&Ew(o)),i):(i.eventSystemFlags|=h,o=i.targetContainers,g!==null&&o.indexOf(g)===-1&&o.push(g),i)}function p3(i,o,c,h,g){switch(o){case"focusin":return Zs=bf(Zs,i,o,c,h,g),!0;case"dragenter":return eo=bf(eo,i,o,c,h,g),!0;case"mouseover":return to=bf(to,i,o,c,h,g),!0;case"pointerover":var v=g.pointerId;return Ef.set(v,bf(Ef.get(v)||null,i,o,c,h,g)),!0;case"gotpointercapture":return v=g.pointerId,Tf.set(v,bf(Tf.get(v)||null,i,o,c,h,g)),!0}return!1}function Sw(i){var o=Q(i.target);if(o!==null){var c=s(o);if(c!==null){if(o=c.tag,o===13){if(o=l(c),o!==null){i.blockedOn=o,Ot(i.priority,function(){if(c.tag===13){var h=Ra();h=Fr(h);var g=hc(c,h);g!==null&&Da(g,c,h),Gg(c,h)}});return}}else if(o===3&&c.stateNode.current.memoizedState.isDehydrated){i.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}i.blockedOn=null}function od(i){if(i.blockedOn!==null)return!1;for(var o=i.targetContainers;0<o.length;){var c=Wg(i.nativeEvent);if(c===null){c=i.nativeEvent;var h=new c.constructor(c.type,c);es=h,c.target.dispatchEvent(h),es=null}else return o=Y(c),o!==null&&Ew(o),i.blockedOn=c,!1;o.shift()}return!0}function kw(i,o,c){od(i)&&c.delete(o)}function g3(){$g=!1,Zs!==null&&od(Zs)&&(Zs=null),eo!==null&&od(eo)&&(eo=null),to!==null&&od(to)&&(to=null),Ef.forEach(kw),Tf.forEach(kw)}function ld(i,o){i.blockedOn===o&&(i.blockedOn=null,$g||($g=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,g3)))}var cd=null;function Aw(i){cd!==i&&(cd=i,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){cd===i&&(cd=null);for(var o=0;o<i.length;o+=3){var c=i[o],h=i[o+1],g=i[o+2];if(typeof h!="function"){if(Xg(h||c)===null)continue;break}var v=Y(c);v!==null&&(i.splice(o,3),o-=3,Xp(v,{pending:!0,data:g,method:c.method,action:h},h,g))}}))}function Sf(i){function o(re){return ld(re,i)}Zs!==null&&ld(Zs,i),eo!==null&&ld(eo,i),to!==null&&ld(to,i),Ef.forEach(o),Tf.forEach(o);for(var c=0;c<ro.length;c++){var h=ro[c];h.blockedOn===i&&(h.blockedOn=null)}for(;0<ro.length&&(c=ro[0],c.blockedOn===null);)Sw(c),c.blockedOn===null&&ro.shift();if(c=(i.ownerDocument||i).$$reactFormReplay,c!=null)for(h=0;h<c.length;h+=3){var g=c[h],v=c[h+1],I=g[Ht]||null;if(typeof v=="function")I||Aw(c);else if(I){var U=null;if(v&&v.hasAttribute("formAction")){if(g=v,I=v[Ht]||null)U=I.formAction;else if(Xg(g)!==null)continue}else U=I.action;typeof U=="function"?c[h+1]=U:(c.splice(h,3),h-=3),Aw(c)}}}function Kg(i){this._internalRoot=i}ud.prototype.render=Kg.prototype.render=function(i){var o=this._internalRoot;if(o===null)throw Error(n(409));var c=o.current,h=Ra();_w(c,h,i,o,null,null)},ud.prototype.unmount=Kg.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var o=i.containerInfo;_w(i.current,2,null,i,null,null),qh(),o[Nt]=null}};function ud(i){this._internalRoot=i}ud.prototype.unstable_scheduleHydration=function(i){if(i){var o=Ur();i={blockedOn:null,target:i,priority:o};for(var c=0;c<ro.length&&o!==0&&o<ro[c].priority;c++);ro.splice(c,0,i),c===0&&Sw(i)}};var Cw=e.version;if(Cw!=="19.1.0")throw Error(n(527,Cw,"19.1.0"));le.findDOMNode=function(i){var o=i._reactInternals;if(o===void 0)throw typeof i.render=="function"?Error(n(188)):(i=Object.keys(i).join(","),Error(n(268,i)));return i=f(o),i=i!==null?d(i):null,i=i===null?null:i.stateNode,i};var x3={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:ne,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var fd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!fd.isDisabled&&fd.supportsFiber)try{jt=fd.inject(x3),oe=fd}catch{}}return Af.createRoot=function(i,o){if(!a(i))throw Error(n(299));var c=!1,h="",g=G_,v=q_,I=W_,U=null;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(h=o.identifierPrefix),o.onUncaughtError!==void 0&&(g=o.onUncaughtError),o.onCaughtError!==void 0&&(v=o.onCaughtError),o.onRecoverableError!==void 0&&(I=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&(U=o.unstable_transitionCallbacks)),o=vw(i,1,!1,null,null,c,h,g,v,I,U,null),i[Nt]=o.current,Rg(i),new Kg(o)},Af.hydrateRoot=function(i,o,c){if(!a(i))throw Error(n(299));var h=!1,g="",v=G_,I=q_,U=W_,re=null,ve=null;return c!=null&&(c.unstable_strictMode===!0&&(h=!0),c.identifierPrefix!==void 0&&(g=c.identifierPrefix),c.onUncaughtError!==void 0&&(v=c.onUncaughtError),c.onCaughtError!==void 0&&(I=c.onCaughtError),c.onRecoverableError!==void 0&&(U=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(re=c.unstable_transitionCallbacks),c.formState!==void 0&&(ve=c.formState)),o=vw(i,1,!0,o,c??null,h,g,v,I,U,re,ve),o.context=yw(null),c=o.current,h=Ra(),h=Fr(h),g=Us(h),g.callback=null,Bs(c,g,h),c=h,o.current.lanes=c,Ue(o,c),Fi(o),i[Nt]=o.current,Rg(i),new ud(o)},Af.version="19.1.0",Af}var jw;function A3(){if(jw)return Jg.exports;jw=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Jg.exports=k3(),Jg.exports}var C3=A3();const N3=Vb(C3),I3=()=>{};var Uw={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hb=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let a=t.charCodeAt(n);a<128?e[r++]=a:a<2048?(e[r++]=a>>6|192,e[r++]=a&63|128):(a&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(a=65536+((a&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=a>>18|240,e[r++]=a>>12&63|128,e[r++]=a>>6&63|128,e[r++]=a&63|128):(e[r++]=a>>12|224,e[r++]=a>>6&63|128,e[r++]=a&63|128)}return e},R3=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const a=t[r++];if(a<128)e[n++]=String.fromCharCode(a);else if(a>191&&a<224){const s=t[r++];e[n++]=String.fromCharCode((a&31)<<6|s&63)}else if(a>239&&a<365){const s=t[r++],l=t[r++],u=t[r++],f=((a&7)<<18|(s&63)<<12|(l&63)<<6|u&63)-65536;e[n++]=String.fromCharCode(55296+(f>>10)),e[n++]=String.fromCharCode(56320+(f&1023))}else{const s=t[r++],l=t[r++];e[n++]=String.fromCharCode((a&15)<<12|(s&63)<<6|l&63)}}return e.join("")},Gb={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let a=0;a<t.length;a+=3){const s=t[a],l=a+1<t.length,u=l?t[a+1]:0,f=a+2<t.length,d=f?t[a+2]:0,m=s>>2,y=(s&3)<<4|u>>4;let _=(u&15)<<2|d>>6,E=d&63;f||(E=64,l||(_=64)),n.push(r[m],r[y],r[_],r[E])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Hb(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):R3(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let a=0;a<t.length;){const s=r[t.charAt(a++)],u=a<t.length?r[t.charAt(a)]:0;++a;const d=a<t.length?r[t.charAt(a)]:64;++a;const y=a<t.length?r[t.charAt(a)]:64;if(++a,s==null||u==null||d==null||y==null)throw new D3;const _=s<<2|u>>4;if(n.push(_),d!==64){const E=u<<4&240|d>>2;if(n.push(E),y!==64){const b=d<<6&192|y;n.push(b)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class D3 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const O3=function(t){const e=Hb(t);return Gb.encodeByteArray(e,!0)},Hd=function(t){return O3(t).replace(/\./g,"")},qb=function(t){try{return Gb.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F3(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L3=()=>F3().__FIREBASE_DEFAULTS__,M3=()=>{if(typeof process>"u"||typeof Uw>"u")return;const t=Uw.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},P3=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&qb(t[1]);return e&&JSON.parse(e)},Em=()=>{try{return I3()||L3()||M3()||P3()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Wb=t=>{var e,r;return(r=(e=Em())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},Xb=t=>{const e=Wb(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},$b=()=>{var t;return(t=Em())===null||t===void 0?void 0:t.config},Kb=t=>{var e;return(e=Em())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j3{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Po(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function I1(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yb(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",a=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:a,exp:a+3600,auth_time:a,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Hd(JSON.stringify(r)),Hd(JSON.stringify(l)),""].join(".")}const Bf={};function U3(){const t={prod:[],emulator:[]};for(const e of Object.keys(Bf))Bf[e]?t.emulator.push(e):t.prod.push(e);return t}function B3(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let Bw=!1;function R1(t,e){if(typeof window>"u"||typeof document>"u"||!Po(window.location.host)||Bf[t]===e||Bf[t]||Bw)return;Bf[t]=e;function r(_){return`__firebase__banner__${_}`}const n="__firebase__banner",s=U3().prod.length>0;function l(){const _=document.getElementById(n);_&&_.remove()}function u(_){_.style.display="flex",_.style.background="#7faaf0",_.style.position="fixed",_.style.bottom="5px",_.style.left="5px",_.style.padding=".5em",_.style.borderRadius="5px",_.style.alignItems="center"}function f(_,E){_.setAttribute("width","24"),_.setAttribute("id",E),_.setAttribute("height","24"),_.setAttribute("viewBox","0 0 24 24"),_.setAttribute("fill","none"),_.style.marginLeft="-6px"}function d(){const _=document.createElement("span");return _.style.cursor="pointer",_.style.marginLeft="16px",_.style.fontSize="24px",_.innerHTML=" &times;",_.onclick=()=>{Bw=!0,l()},_}function m(_,E){_.setAttribute("id",E),_.innerText="Learn more",_.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",_.setAttribute("target","__blank"),_.style.paddingLeft="5px",_.style.textDecoration="underline"}function y(){const _=B3(n),E=r("text"),b=document.getElementById(E)||document.createElement("span"),w=r("learnmore"),S=document.getElementById(w)||document.createElement("a"),M=r("preprendIcon"),j=document.getElementById(M)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(_.created){const F=_.element;u(F),m(S,w);const G=d();f(j,M),F.append(j,b,S,G),document.body.appendChild(F)}s?(b.innerText="Preview backend disconnected.",j.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(j.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,b.innerText="Preview backend running in this workspace."),b.setAttribute("id",E)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",y):y()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function V3(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Zn())}function z3(){var t;const e=(t=Em())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function H3(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function G3(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function q3(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function W3(){const t=Zn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function X3(){return!z3()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function $3(){try{return typeof indexedDB=="object"}catch{return!1}}function K3(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(n);a.onsuccess=()=>{a.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},a.onupgradeneeded=()=>{r=!1},a.onerror=()=>{var s;e(((s=a.error)===null||s===void 0?void 0:s.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y3="FirebaseError";class Yi extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=Y3,Object.setPrototypeOf(this,Yi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,k0.prototype.create)}}class k0{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},a=`${this.service}/${e}`,s=this.errors[e],l=s?Q3(s,n):"Error",u=`${this.serviceName}: ${l} (${a}).`;return new Yi(a,u,n)}}function Q3(t,e){return t.replace(J3,(r,n)=>{const a=e[n];return a!=null?String(a):`<${n}?>`})}const J3=/\{\$([^}]+)}/g;function Z3(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Cl(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const a of r){if(!n.includes(a))return!1;const s=t[a],l=e[a];if(Vw(s)&&Vw(l)){if(!Cl(s,l))return!1}else if(s!==l)return!1}for(const a of n)if(!r.includes(a))return!1;return!0}function Vw(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A0(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(a=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Rf(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[a,s]=n.split("=");e[decodeURIComponent(a)]=decodeURIComponent(s)}}),e}function Df(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function eI(t,e){const r=new tI(t,e);return r.subscribe.bind(r)}class tI{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let a;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");rI(e,["next","error","complete"])?a=e:a={next:e,error:r,complete:n},a.next===void 0&&(a.next=rx),a.error===void 0&&(a.error=rx),a.complete===void 0&&(a.complete=rx);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function rI(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function rx(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sr(t){return t&&t._delegate?t._delegate:t}class bo{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xl="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nI{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new j3;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:r});a&&n.resolve(a)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),a=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(a)return null;throw s}else{if(a)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(iI(e))try{this.getOrInitializeService({instanceIdentifier:xl})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);try{const s=this.getOrInitializeService({instanceIdentifier:a});n.resolve(s)}catch{}}}}clearInstance(e=xl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=xl){return this.instances.has(e)}getOptions(e=xl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[s,l]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(s);n===u&&l.resolve(a)}return a}onInit(e,r){var n;const a=this.normalizeInstanceIdentifier(r),s=(n=this.onInitCallbacks.get(a))!==null&&n!==void 0?n:new Set;s.add(e),this.onInitCallbacks.set(a,s);const l=this.instances.get(a);return l&&e(l,a),()=>{s.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const a of n)try{a(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:aI(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=xl){return this.component?this.component.multipleInstances?e:xl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function aI(t){return t===xl?void 0:t}function iI(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sI{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new nI(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Gt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Gt||(Gt={}));const oI={debug:Gt.DEBUG,verbose:Gt.VERBOSE,info:Gt.INFO,warn:Gt.WARN,error:Gt.ERROR,silent:Gt.SILENT},lI=Gt.INFO,cI={[Gt.DEBUG]:"log",[Gt.VERBOSE]:"log",[Gt.INFO]:"info",[Gt.WARN]:"warn",[Gt.ERROR]:"error"},uI=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),a=cI[e];if(a)console[a](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class D1{constructor(e){this.name=e,this._logLevel=lI,this._logHandler=uI,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Gt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?oI[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Gt.DEBUG,...e),this._logHandler(this,Gt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Gt.VERBOSE,...e),this._logHandler(this,Gt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Gt.INFO,...e),this._logHandler(this,Gt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Gt.WARN,...e),this._logHandler(this,Gt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Gt.ERROR,...e),this._logHandler(this,Gt.ERROR,...e)}}const fI=(t,e)=>e.some(r=>t instanceof r);let zw,Hw;function hI(){return zw||(zw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function dI(){return Hw||(Hw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Qb=new WeakMap,jx=new WeakMap,Jb=new WeakMap,nx=new WeakMap,O1=new WeakMap;function mI(t){const e=new Promise((r,n)=>{const a=()=>{t.removeEventListener("success",s),t.removeEventListener("error",l)},s=()=>{r(vo(t.result)),a()},l=()=>{n(t.error),a()};t.addEventListener("success",s),t.addEventListener("error",l)});return e.then(r=>{r instanceof IDBCursor&&Qb.set(r,t)}).catch(()=>{}),O1.set(e,t),e}function pI(t){if(jx.has(t))return;const e=new Promise((r,n)=>{const a=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",l),t.removeEventListener("abort",l)},s=()=>{r(),a()},l=()=>{n(t.error||new DOMException("AbortError","AbortError")),a()};t.addEventListener("complete",s),t.addEventListener("error",l),t.addEventListener("abort",l)});jx.set(t,e)}let Ux={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return jx.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Jb.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return vo(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function gI(t){Ux=t(Ux)}function xI(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(ax(this),e,...r);return Jb.set(n,e.sort?e.sort():[e]),vo(n)}:dI().includes(t)?function(...e){return t.apply(ax(this),e),vo(Qb.get(this))}:function(...e){return vo(t.apply(ax(this),e))}}function vI(t){return typeof t=="function"?xI(t):(t instanceof IDBTransaction&&pI(t),fI(t,hI())?new Proxy(t,Ux):t)}function vo(t){if(t instanceof IDBRequest)return mI(t);if(nx.has(t))return nx.get(t);const e=vI(t);return e!==t&&(nx.set(t,e),O1.set(e,t)),e}const ax=t=>O1.get(t);function yI(t,e,{blocked:r,upgrade:n,blocking:a,terminated:s}={}){const l=indexedDB.open(t,e),u=vo(l);return n&&l.addEventListener("upgradeneeded",f=>{n(vo(l.result),f.oldVersion,f.newVersion,vo(l.transaction),f)}),r&&l.addEventListener("blocked",f=>r(f.oldVersion,f.newVersion,f)),u.then(f=>{s&&f.addEventListener("close",()=>s()),a&&f.addEventListener("versionchange",d=>a(d.oldVersion,d.newVersion,d))}).catch(()=>{}),u}const _I=["get","getKey","getAll","getAllKeys","count"],wI=["put","add","delete","clear"],ix=new Map;function Gw(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(ix.get(e))return ix.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,a=wI.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(a||_I.includes(r)))return;const s=async function(l,...u){const f=this.transaction(l,a?"readwrite":"readonly");let d=f.store;return n&&(d=d.index(u.shift())),(await Promise.all([d[r](...u),a&&f.done]))[0]};return ix.set(e,s),s}gI(t=>({...t,get:(e,r,n)=>Gw(e,r)||t.get(e,r,n),has:(e,r)=>!!Gw(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EI{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(TI(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function TI(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Bx="@firebase/app",qw="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ks=new D1("@firebase/app"),bI="@firebase/app-compat",SI="@firebase/analytics-compat",kI="@firebase/analytics",AI="@firebase/app-check-compat",CI="@firebase/app-check",NI="@firebase/auth",II="@firebase/auth-compat",RI="@firebase/database",DI="@firebase/data-connect",OI="@firebase/database-compat",FI="@firebase/functions",LI="@firebase/functions-compat",MI="@firebase/installations",PI="@firebase/installations-compat",jI="@firebase/messaging",UI="@firebase/messaging-compat",BI="@firebase/performance",VI="@firebase/performance-compat",zI="@firebase/remote-config",HI="@firebase/remote-config-compat",GI="@firebase/storage",qI="@firebase/storage-compat",WI="@firebase/firestore",XI="@firebase/ai",$I="@firebase/firestore-compat",KI="firebase",YI="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vx="[DEFAULT]",QI={[Bx]:"fire-core",[bI]:"fire-core-compat",[kI]:"fire-analytics",[SI]:"fire-analytics-compat",[CI]:"fire-app-check",[AI]:"fire-app-check-compat",[NI]:"fire-auth",[II]:"fire-auth-compat",[RI]:"fire-rtdb",[DI]:"fire-data-connect",[OI]:"fire-rtdb-compat",[FI]:"fire-fn",[LI]:"fire-fn-compat",[MI]:"fire-iid",[PI]:"fire-iid-compat",[jI]:"fire-fcm",[UI]:"fire-fcm-compat",[BI]:"fire-perf",[VI]:"fire-perf-compat",[zI]:"fire-rc",[HI]:"fire-rc-compat",[GI]:"fire-gcs",[qI]:"fire-gcs-compat",[WI]:"fire-fst",[$I]:"fire-fst-compat",[XI]:"fire-vertex","fire-js":"fire-js",[KI]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cu=new Map,zx=new Map,Hx=new Map;function Ww(t,e){try{t.container.addComponent(e)}catch(r){ks.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Nl(t){const e=t.name;if(Hx.has(e))return ks.debug(`There were multiple attempts to register component ${e}.`),!1;Hx.set(e,t);for(const r of cu.values())Ww(r,t);for(const r of zx.values())Ww(r,t);return!0}function Tm(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function La(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JI={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},yo=new k0("app","Firebase",JI);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZI{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new bo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw yo.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vl=YI;function F1(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:Vx,automaticDataCollectionEnabled:!0},e),a=n.name;if(typeof a!="string"||!a)throw yo.create("bad-app-name",{appName:String(a)});if(r||(r=$b()),!r)throw yo.create("no-options");const s=cu.get(a);if(s){if(Cl(r,s.options)&&Cl(n,s.config))return s;throw yo.create("duplicate-app",{appName:a})}const l=new sI(a);for(const f of Hx.values())l.addComponent(f);const u=new ZI(r,n,l);return cu.set(a,u),u}function L1(t=Vx){const e=cu.get(t);if(!e&&t===Vx&&$b())return F1();if(!e)throw yo.create("no-app",{appName:t});return e}async function eR(t){let e=!1;const r=t.name;cu.has(r)?(e=!0,cu.delete(r)):zx.has(r)&&t.decRefCount()<=0&&(zx.delete(r),e=!0),e&&(await Promise.all(t.container.getProviders().map(n=>n.delete())),t.isDeleted=!0)}function Vi(t,e,r){var n;let a=(n=QI[t])!==null&&n!==void 0?n:t;r&&(a+=`-${r}`);const s=a.match(/\s|\//),l=e.match(/\s|\//);if(s||l){const u=[`Unable to register library "${a}" with version "${e}":`];s&&u.push(`library name "${a}" contains illegal characters (whitespace or "/")`),s&&l&&u.push("and"),l&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ks.warn(u.join(" "));return}Nl(new bo(`${a}-version`,()=>({library:a,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tR="firebase-heartbeat-database",rR=1,r0="firebase-heartbeat-store";let sx=null;function Zb(){return sx||(sx=yI(tR,rR,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(r0)}catch(r){console.warn(r)}}}}).catch(t=>{throw yo.create("idb-open",{originalErrorMessage:t.message})})),sx}async function nR(t){try{const r=(await Zb()).transaction(r0),n=await r.objectStore(r0).get(eS(t));return await r.done,n}catch(e){if(e instanceof Yi)ks.warn(e.message);else{const r=yo.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ks.warn(r.message)}}}async function Xw(t,e){try{const n=(await Zb()).transaction(r0,"readwrite");await n.objectStore(r0).put(e,eS(t)),await n.done}catch(r){if(r instanceof Yi)ks.warn(r.message);else{const n=yo.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});ks.warn(n.message)}}}function eS(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aR=1024,iR=30;class sR{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new lR(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=$w();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(l=>l.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:a}),this._heartbeatsCache.heartbeats.length>iR){const l=cR(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){ks.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=$w(),{heartbeatsToSend:n,unsentEntries:a}=oR(this._heartbeatsCache.heartbeats),s=Hd(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(r){return ks.warn(r),""}}}function $w(){return new Date().toISOString().substring(0,10)}function oR(t,e=aR){const r=[];let n=t.slice();for(const a of t){const s=r.find(l=>l.agent===a.agent);if(s){if(s.dates.push(a.date),Kw(r)>e){s.dates.pop();break}}else if(r.push({agent:a.agent,dates:[a.date]}),Kw(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class lR{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return $3()?K3().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await nR(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const a=await this.read();return Xw(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:a.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const a=await this.read();return Xw(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...e.heartbeats]})}else return}}function Kw(t){return Hd(JSON.stringify({version:2,heartbeats:t})).length}function cR(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uR(t){Nl(new bo("platform-logger",e=>new EI(e),"PRIVATE")),Nl(new bo("heartbeat",e=>new sR(e),"PRIVATE")),Vi(Bx,qw,t),Vi(Bx,qw,"esm2017"),Vi("fire-js","")}uR("");var fR="firebase",hR="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Vi(fR,hR,"app");var Yw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var _o,tS;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(A,D){function k(){}k.prototype=D.prototype,A.D=D.prototype,A.prototype=new k,A.prototype.constructor=A,A.C=function(O,P,N){for(var R=Array(arguments.length-2),he=2;he<arguments.length;he++)R[he-2]=arguments[he];return D.prototype[P].apply(O,R)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(A,D,k){k||(k=0);var O=Array(16);if(typeof D=="string")for(var P=0;16>P;++P)O[P]=D.charCodeAt(k++)|D.charCodeAt(k++)<<8|D.charCodeAt(k++)<<16|D.charCodeAt(k++)<<24;else for(P=0;16>P;++P)O[P]=D[k++]|D[k++]<<8|D[k++]<<16|D[k++]<<24;D=A.g[0],k=A.g[1],P=A.g[2];var N=A.g[3],R=D+(N^k&(P^N))+O[0]+3614090360&4294967295;D=k+(R<<7&4294967295|R>>>25),R=N+(P^D&(k^P))+O[1]+3905402710&4294967295,N=D+(R<<12&4294967295|R>>>20),R=P+(k^N&(D^k))+O[2]+606105819&4294967295,P=N+(R<<17&4294967295|R>>>15),R=k+(D^P&(N^D))+O[3]+3250441966&4294967295,k=P+(R<<22&4294967295|R>>>10),R=D+(N^k&(P^N))+O[4]+4118548399&4294967295,D=k+(R<<7&4294967295|R>>>25),R=N+(P^D&(k^P))+O[5]+1200080426&4294967295,N=D+(R<<12&4294967295|R>>>20),R=P+(k^N&(D^k))+O[6]+2821735955&4294967295,P=N+(R<<17&4294967295|R>>>15),R=k+(D^P&(N^D))+O[7]+4249261313&4294967295,k=P+(R<<22&4294967295|R>>>10),R=D+(N^k&(P^N))+O[8]+1770035416&4294967295,D=k+(R<<7&4294967295|R>>>25),R=N+(P^D&(k^P))+O[9]+2336552879&4294967295,N=D+(R<<12&4294967295|R>>>20),R=P+(k^N&(D^k))+O[10]+4294925233&4294967295,P=N+(R<<17&4294967295|R>>>15),R=k+(D^P&(N^D))+O[11]+2304563134&4294967295,k=P+(R<<22&4294967295|R>>>10),R=D+(N^k&(P^N))+O[12]+1804603682&4294967295,D=k+(R<<7&4294967295|R>>>25),R=N+(P^D&(k^P))+O[13]+4254626195&4294967295,N=D+(R<<12&4294967295|R>>>20),R=P+(k^N&(D^k))+O[14]+2792965006&4294967295,P=N+(R<<17&4294967295|R>>>15),R=k+(D^P&(N^D))+O[15]+1236535329&4294967295,k=P+(R<<22&4294967295|R>>>10),R=D+(P^N&(k^P))+O[1]+4129170786&4294967295,D=k+(R<<5&4294967295|R>>>27),R=N+(k^P&(D^k))+O[6]+3225465664&4294967295,N=D+(R<<9&4294967295|R>>>23),R=P+(D^k&(N^D))+O[11]+643717713&4294967295,P=N+(R<<14&4294967295|R>>>18),R=k+(N^D&(P^N))+O[0]+3921069994&4294967295,k=P+(R<<20&4294967295|R>>>12),R=D+(P^N&(k^P))+O[5]+3593408605&4294967295,D=k+(R<<5&4294967295|R>>>27),R=N+(k^P&(D^k))+O[10]+38016083&4294967295,N=D+(R<<9&4294967295|R>>>23),R=P+(D^k&(N^D))+O[15]+3634488961&4294967295,P=N+(R<<14&4294967295|R>>>18),R=k+(N^D&(P^N))+O[4]+3889429448&4294967295,k=P+(R<<20&4294967295|R>>>12),R=D+(P^N&(k^P))+O[9]+568446438&4294967295,D=k+(R<<5&4294967295|R>>>27),R=N+(k^P&(D^k))+O[14]+3275163606&4294967295,N=D+(R<<9&4294967295|R>>>23),R=P+(D^k&(N^D))+O[3]+4107603335&4294967295,P=N+(R<<14&4294967295|R>>>18),R=k+(N^D&(P^N))+O[8]+1163531501&4294967295,k=P+(R<<20&4294967295|R>>>12),R=D+(P^N&(k^P))+O[13]+2850285829&4294967295,D=k+(R<<5&4294967295|R>>>27),R=N+(k^P&(D^k))+O[2]+4243563512&4294967295,N=D+(R<<9&4294967295|R>>>23),R=P+(D^k&(N^D))+O[7]+1735328473&4294967295,P=N+(R<<14&4294967295|R>>>18),R=k+(N^D&(P^N))+O[12]+2368359562&4294967295,k=P+(R<<20&4294967295|R>>>12),R=D+(k^P^N)+O[5]+4294588738&4294967295,D=k+(R<<4&4294967295|R>>>28),R=N+(D^k^P)+O[8]+2272392833&4294967295,N=D+(R<<11&4294967295|R>>>21),R=P+(N^D^k)+O[11]+1839030562&4294967295,P=N+(R<<16&4294967295|R>>>16),R=k+(P^N^D)+O[14]+4259657740&4294967295,k=P+(R<<23&4294967295|R>>>9),R=D+(k^P^N)+O[1]+2763975236&4294967295,D=k+(R<<4&4294967295|R>>>28),R=N+(D^k^P)+O[4]+1272893353&4294967295,N=D+(R<<11&4294967295|R>>>21),R=P+(N^D^k)+O[7]+4139469664&4294967295,P=N+(R<<16&4294967295|R>>>16),R=k+(P^N^D)+O[10]+3200236656&4294967295,k=P+(R<<23&4294967295|R>>>9),R=D+(k^P^N)+O[13]+681279174&4294967295,D=k+(R<<4&4294967295|R>>>28),R=N+(D^k^P)+O[0]+3936430074&4294967295,N=D+(R<<11&4294967295|R>>>21),R=P+(N^D^k)+O[3]+3572445317&4294967295,P=N+(R<<16&4294967295|R>>>16),R=k+(P^N^D)+O[6]+76029189&4294967295,k=P+(R<<23&4294967295|R>>>9),R=D+(k^P^N)+O[9]+3654602809&4294967295,D=k+(R<<4&4294967295|R>>>28),R=N+(D^k^P)+O[12]+3873151461&4294967295,N=D+(R<<11&4294967295|R>>>21),R=P+(N^D^k)+O[15]+530742520&4294967295,P=N+(R<<16&4294967295|R>>>16),R=k+(P^N^D)+O[2]+3299628645&4294967295,k=P+(R<<23&4294967295|R>>>9),R=D+(P^(k|~N))+O[0]+4096336452&4294967295,D=k+(R<<6&4294967295|R>>>26),R=N+(k^(D|~P))+O[7]+1126891415&4294967295,N=D+(R<<10&4294967295|R>>>22),R=P+(D^(N|~k))+O[14]+2878612391&4294967295,P=N+(R<<15&4294967295|R>>>17),R=k+(N^(P|~D))+O[5]+4237533241&4294967295,k=P+(R<<21&4294967295|R>>>11),R=D+(P^(k|~N))+O[12]+1700485571&4294967295,D=k+(R<<6&4294967295|R>>>26),R=N+(k^(D|~P))+O[3]+2399980690&4294967295,N=D+(R<<10&4294967295|R>>>22),R=P+(D^(N|~k))+O[10]+4293915773&4294967295,P=N+(R<<15&4294967295|R>>>17),R=k+(N^(P|~D))+O[1]+2240044497&4294967295,k=P+(R<<21&4294967295|R>>>11),R=D+(P^(k|~N))+O[8]+1873313359&4294967295,D=k+(R<<6&4294967295|R>>>26),R=N+(k^(D|~P))+O[15]+4264355552&4294967295,N=D+(R<<10&4294967295|R>>>22),R=P+(D^(N|~k))+O[6]+2734768916&4294967295,P=N+(R<<15&4294967295|R>>>17),R=k+(N^(P|~D))+O[13]+1309151649&4294967295,k=P+(R<<21&4294967295|R>>>11),R=D+(P^(k|~N))+O[4]+4149444226&4294967295,D=k+(R<<6&4294967295|R>>>26),R=N+(k^(D|~P))+O[11]+3174756917&4294967295,N=D+(R<<10&4294967295|R>>>22),R=P+(D^(N|~k))+O[2]+718787259&4294967295,P=N+(R<<15&4294967295|R>>>17),R=k+(N^(P|~D))+O[9]+3951481745&4294967295,A.g[0]=A.g[0]+D&4294967295,A.g[1]=A.g[1]+(P+(R<<21&4294967295|R>>>11))&4294967295,A.g[2]=A.g[2]+P&4294967295,A.g[3]=A.g[3]+N&4294967295}n.prototype.u=function(A,D){D===void 0&&(D=A.length);for(var k=D-this.blockSize,O=this.B,P=this.h,N=0;N<D;){if(P==0)for(;N<=k;)a(this,A,N),N+=this.blockSize;if(typeof A=="string"){for(;N<D;)if(O[P++]=A.charCodeAt(N++),P==this.blockSize){a(this,O),P=0;break}}else for(;N<D;)if(O[P++]=A[N++],P==this.blockSize){a(this,O),P=0;break}}this.h=P,this.o+=D},n.prototype.v=function(){var A=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);A[0]=128;for(var D=1;D<A.length-8;++D)A[D]=0;var k=8*this.o;for(D=A.length-8;D<A.length;++D)A[D]=k&255,k/=256;for(this.u(A),A=Array(16),D=k=0;4>D;++D)for(var O=0;32>O;O+=8)A[k++]=this.g[D]>>>O&255;return A};function s(A,D){var k=u;return Object.prototype.hasOwnProperty.call(k,A)?k[A]:k[A]=D(A)}function l(A,D){this.h=D;for(var k=[],O=!0,P=A.length-1;0<=P;P--){var N=A[P]|0;O&&N==D||(k[P]=N,O=!1)}this.g=k}var u={};function f(A){return-128<=A&&128>A?s(A,function(D){return new l([D|0],0>D?-1:0)}):new l([A|0],0>A?-1:0)}function d(A){if(isNaN(A)||!isFinite(A))return y;if(0>A)return S(d(-A));for(var D=[],k=1,O=0;A>=k;O++)D[O]=A/k|0,k*=4294967296;return new l(D,0)}function m(A,D){if(A.length==0)throw Error("number format error: empty string");if(D=D||10,2>D||36<D)throw Error("radix out of range: "+D);if(A.charAt(0)=="-")return S(m(A.substring(1),D));if(0<=A.indexOf("-"))throw Error('number format error: interior "-" character');for(var k=d(Math.pow(D,8)),O=y,P=0;P<A.length;P+=8){var N=Math.min(8,A.length-P),R=parseInt(A.substring(P,P+N),D);8>N?(N=d(Math.pow(D,N)),O=O.j(N).add(d(R))):(O=O.j(k),O=O.add(d(R)))}return O}var y=f(0),_=f(1),E=f(16777216);t=l.prototype,t.m=function(){if(w(this))return-S(this).m();for(var A=0,D=1,k=0;k<this.g.length;k++){var O=this.i(k);A+=(0<=O?O:4294967296+O)*D,D*=4294967296}return A},t.toString=function(A){if(A=A||10,2>A||36<A)throw Error("radix out of range: "+A);if(b(this))return"0";if(w(this))return"-"+S(this).toString(A);for(var D=d(Math.pow(A,6)),k=this,O="";;){var P=G(k,D).g;k=M(k,P.j(D));var N=((0<k.g.length?k.g[0]:k.h)>>>0).toString(A);if(k=P,b(k))return N+O;for(;6>N.length;)N="0"+N;O=N+O}},t.i=function(A){return 0>A?0:A<this.g.length?this.g[A]:this.h};function b(A){if(A.h!=0)return!1;for(var D=0;D<A.g.length;D++)if(A.g[D]!=0)return!1;return!0}function w(A){return A.h==-1}t.l=function(A){return A=M(this,A),w(A)?-1:b(A)?0:1};function S(A){for(var D=A.g.length,k=[],O=0;O<D;O++)k[O]=~A.g[O];return new l(k,~A.h).add(_)}t.abs=function(){return w(this)?S(this):this},t.add=function(A){for(var D=Math.max(this.g.length,A.g.length),k=[],O=0,P=0;P<=D;P++){var N=O+(this.i(P)&65535)+(A.i(P)&65535),R=(N>>>16)+(this.i(P)>>>16)+(A.i(P)>>>16);O=R>>>16,N&=65535,R&=65535,k[P]=R<<16|N}return new l(k,k[k.length-1]&-2147483648?-1:0)};function M(A,D){return A.add(S(D))}t.j=function(A){if(b(this)||b(A))return y;if(w(this))return w(A)?S(this).j(S(A)):S(S(this).j(A));if(w(A))return S(this.j(S(A)));if(0>this.l(E)&&0>A.l(E))return d(this.m()*A.m());for(var D=this.g.length+A.g.length,k=[],O=0;O<2*D;O++)k[O]=0;for(O=0;O<this.g.length;O++)for(var P=0;P<A.g.length;P++){var N=this.i(O)>>>16,R=this.i(O)&65535,he=A.i(P)>>>16,xe=A.i(P)&65535;k[2*O+2*P]+=R*xe,j(k,2*O+2*P),k[2*O+2*P+1]+=N*xe,j(k,2*O+2*P+1),k[2*O+2*P+1]+=R*he,j(k,2*O+2*P+1),k[2*O+2*P+2]+=N*he,j(k,2*O+2*P+2)}for(O=0;O<D;O++)k[O]=k[2*O+1]<<16|k[2*O];for(O=D;O<2*D;O++)k[O]=0;return new l(k,0)};function j(A,D){for(;(A[D]&65535)!=A[D];)A[D+1]+=A[D]>>>16,A[D]&=65535,D++}function F(A,D){this.g=A,this.h=D}function G(A,D){if(b(D))throw Error("division by zero");if(b(A))return new F(y,y);if(w(A))return D=G(S(A),D),new F(S(D.g),S(D.h));if(w(D))return D=G(A,S(D)),new F(S(D.g),D.h);if(30<A.g.length){if(w(A)||w(D))throw Error("slowDivide_ only works with positive integers.");for(var k=_,O=D;0>=O.l(A);)k=W(k),O=W(O);var P=B(k,1),N=B(O,1);for(O=B(O,2),k=B(k,2);!b(O);){var R=N.add(O);0>=R.l(A)&&(P=P.add(k),N=R),O=B(O,1),k=B(k,1)}return D=M(A,P.j(D)),new F(P,D)}for(P=y;0<=A.l(D);){for(k=Math.max(1,Math.floor(A.m()/D.m())),O=Math.ceil(Math.log(k)/Math.LN2),O=48>=O?1:Math.pow(2,O-48),N=d(k),R=N.j(D);w(R)||0<R.l(A);)k-=O,N=d(k),R=N.j(D);b(N)&&(N=_),P=P.add(N),A=M(A,R)}return new F(P,A)}t.A=function(A){return G(this,A).h},t.and=function(A){for(var D=Math.max(this.g.length,A.g.length),k=[],O=0;O<D;O++)k[O]=this.i(O)&A.i(O);return new l(k,this.h&A.h)},t.or=function(A){for(var D=Math.max(this.g.length,A.g.length),k=[],O=0;O<D;O++)k[O]=this.i(O)|A.i(O);return new l(k,this.h|A.h)},t.xor=function(A){for(var D=Math.max(this.g.length,A.g.length),k=[],O=0;O<D;O++)k[O]=this.i(O)^A.i(O);return new l(k,this.h^A.h)};function W(A){for(var D=A.g.length+1,k=[],O=0;O<D;O++)k[O]=A.i(O)<<1|A.i(O-1)>>>31;return new l(k,A.h)}function B(A,D){var k=D>>5;D%=32;for(var O=A.g.length-k,P=[],N=0;N<O;N++)P[N]=0<D?A.i(N+k)>>>D|A.i(N+k+1)<<32-D:A.i(N+k);return new l(P,A.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,tS=n,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.A,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=d,l.fromString=m,_o=l}).apply(typeof Yw<"u"?Yw:typeof self<"u"?self:typeof window<"u"?window:{});var hd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var rS,Of,nS,Dd,Gx,aS,iS,sS;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(p,T,C){return p==Array.prototype||p==Object.prototype||(p[T]=C.value),p};function r(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof hd=="object"&&hd];for(var T=0;T<p.length;++T){var C=p[T];if(C&&C.Math==Math)return C}throw Error("Cannot find global object")}var n=r(this);function a(p,T){if(T)e:{var C=n;p=p.split(".");for(var z=0;z<p.length-1;z++){var me=p[z];if(!(me in C))break e;C=C[me]}p=p[p.length-1],z=C[p],T=T(z),T!=z&&T!=null&&e(C,p,{configurable:!0,writable:!0,value:T})}}function s(p,T){p instanceof String&&(p+="");var C=0,z=!1,me={next:function(){if(!z&&C<p.length){var be=C++;return{value:T(be,p[be]),done:!1}}return z=!0,{done:!0,value:void 0}}};return me[Symbol.iterator]=function(){return me},me}a("Array.prototype.values",function(p){return p||function(){return s(this,function(T,C){return C})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var l=l||{},u=this||self;function f(p){var T=typeof p;return T=T!="object"?T:p?Array.isArray(p)?"array":T:"null",T=="array"||T=="object"&&typeof p.length=="number"}function d(p){var T=typeof p;return T=="object"&&p!=null||T=="function"}function m(p,T,C){return p.call.apply(p.bind,arguments)}function y(p,T,C){if(!p)throw Error();if(2<arguments.length){var z=Array.prototype.slice.call(arguments,2);return function(){var me=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(me,z),p.apply(T,me)}}return function(){return p.apply(T,arguments)}}function _(p,T,C){return _=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?m:y,_.apply(null,arguments)}function E(p,T){var C=Array.prototype.slice.call(arguments,1);return function(){var z=C.slice();return z.push.apply(z,arguments),p.apply(this,z)}}function b(p,T){function C(){}C.prototype=T.prototype,p.aa=T.prototype,p.prototype=new C,p.prototype.constructor=p,p.Qb=function(z,me,be){for(var Ke=Array(arguments.length-2),$t=2;$t<arguments.length;$t++)Ke[$t-2]=arguments[$t];return T.prototype[me].apply(z,Ke)}}function w(p){const T=p.length;if(0<T){const C=Array(T);for(let z=0;z<T;z++)C[z]=p[z];return C}return[]}function S(p,T){for(let C=1;C<arguments.length;C++){const z=arguments[C];if(f(z)){const me=p.length||0,be=z.length||0;p.length=me+be;for(let Ke=0;Ke<be;Ke++)p[me+Ke]=z[Ke]}else p.push(z)}}class M{constructor(T,C){this.i=T,this.j=C,this.h=0,this.g=null}get(){let T;return 0<this.h?(this.h--,T=this.g,this.g=T.next,T.next=null):T=this.i(),T}}function j(p){return/^[\s\xa0]*$/.test(p)}function F(){var p=u.navigator;return p&&(p=p.userAgent)?p:""}function G(p){return G[" "](p),p}G[" "]=function(){};var W=F().indexOf("Gecko")!=-1&&!(F().toLowerCase().indexOf("webkit")!=-1&&F().indexOf("Edge")==-1)&&!(F().indexOf("Trident")!=-1||F().indexOf("MSIE")!=-1)&&F().indexOf("Edge")==-1;function B(p,T,C){for(const z in p)T.call(C,p[z],z,p)}function A(p,T){for(const C in p)T.call(void 0,p[C],C,p)}function D(p){const T={};for(const C in p)T[C]=p[C];return T}const k="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function O(p,T){let C,z;for(let me=1;me<arguments.length;me++){z=arguments[me];for(C in z)p[C]=z[C];for(let be=0;be<k.length;be++)C=k[be],Object.prototype.hasOwnProperty.call(z,C)&&(p[C]=z[C])}}function P(p){var T=1;p=p.split(":");const C=[];for(;0<T&&p.length;)C.push(p.shift()),T--;return p.length&&C.push(p.join(":")),C}function N(p){u.setTimeout(()=>{throw p},0)}function R(){var p=ie;let T=null;return p.g&&(T=p.g,p.g=p.g.next,p.g||(p.h=null),T.next=null),T}class he{constructor(){this.h=this.g=null}add(T,C){const z=xe.get();z.set(T,C),this.h?this.h.next=z:this.g=z,this.h=z}}var xe=new M(()=>new ne,p=>p.reset());class ne{constructor(){this.next=this.g=this.h=null}set(T,C){this.h=T,this.g=C,this.next=null}reset(){this.next=this.g=this.h=null}}let le,He=!1,ie=new he,J=()=>{const p=u.Promise.resolve(void 0);le=()=>{p.then(ge)}};var ge=()=>{for(var p;p=R();){try{p.h.call(p.g)}catch(C){N(C)}var T=xe;T.j(p),100>T.h&&(T.h++,p.next=T.g,T.g=p)}He=!1};function V(){this.s=this.s,this.C=this.C}V.prototype.s=!1,V.prototype.ma=function(){this.s||(this.s=!0,this.N())},V.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function X(p,T){this.type=p,this.g=this.target=T,this.defaultPrevented=!1}X.prototype.h=function(){this.defaultPrevented=!0};var Z=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var p=!1,T=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const C=()=>{};u.addEventListener("test",C,T),u.removeEventListener("test",C,T)}catch{}return p}();function te(p,T){if(X.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p){var C=this.type=p.type,z=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;if(this.target=p.target||p.srcElement,this.g=T,T=p.relatedTarget){if(W){e:{try{G(T.nodeName);var me=!0;break e}catch{}me=!1}me||(T=null)}}else C=="mouseover"?T=p.fromElement:C=="mouseout"&&(T=p.toElement);this.relatedTarget=T,z?(this.clientX=z.clientX!==void 0?z.clientX:z.pageX,this.clientY=z.clientY!==void 0?z.clientY:z.pageY,this.screenX=z.screenX||0,this.screenY=z.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=typeof p.pointerType=="string"?p.pointerType:fe[p.pointerType]||"",this.state=p.state,this.i=p,p.defaultPrevented&&te.aa.h.call(this)}}b(te,X);var fe={2:"touch",3:"pen",4:"mouse"};te.prototype.h=function(){te.aa.h.call(this);var p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var Se="closure_listenable_"+(1e6*Math.random()|0),ke=0;function Ne(p,T,C,z,me){this.listener=p,this.proxy=null,this.src=T,this.type=C,this.capture=!!z,this.ha=me,this.key=++ke,this.da=this.fa=!1}function Oe(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function ot(p){this.src=p,this.g={},this.h=0}ot.prototype.add=function(p,T,C,z,me){var be=p.toString();p=this.g[be],p||(p=this.g[be]=[],this.h++);var Ke=Pt(p,T,z,me);return-1<Ke?(T=p[Ke],C||(T.fa=!1)):(T=new Ne(T,this.src,be,!!z,me),T.fa=C,p.push(T)),T};function ee(p,T){var C=T.type;if(C in p.g){var z=p.g[C],me=Array.prototype.indexOf.call(z,T,void 0),be;(be=0<=me)&&Array.prototype.splice.call(z,me,1),be&&(Oe(T),p.g[C].length==0&&(delete p.g[C],p.h--))}}function Pt(p,T,C,z){for(var me=0;me<p.length;++me){var be=p[me];if(!be.da&&be.listener==T&&be.capture==!!C&&be.ha==z)return me}return-1}var _t="closure_lm_"+(1e6*Math.random()|0),Dt={};function nt(p,T,C,z,me){if(Array.isArray(T)){for(var be=0;be<T.length;be++)nt(p,T[be],C,z,me);return null}return C=en(C),p&&p[Se]?p.K(T,C,d(z)?!!z.capture:!1,me):Ge(p,T,C,!1,z,me)}function Ge(p,T,C,z,me,be){if(!T)throw Error("Invalid event type");var Ke=d(me)?!!me.capture:!!me,$t=Dr(p);if($t||(p[_t]=$t=new ot(p)),C=$t.add(T,C,z,Ke,be),C.proxy)return C;if(z=tr(),C.proxy=z,z.src=p,z.listener=C,p.addEventListener)Z||(me=Ke),me===void 0&&(me=!1),p.addEventListener(T.toString(),z,me);else if(p.attachEvent)p.attachEvent(wr(T.toString()),z);else if(p.addListener&&p.removeListener)p.addListener(z);else throw Error("addEventListener and attachEvent are unavailable.");return C}function tr(){function p(C){return T.call(p.src,p.listener,C)}const T=_n;return p}function Jt(p,T,C,z,me){if(Array.isArray(T))for(var be=0;be<T.length;be++)Jt(p,T[be],C,z,me);else z=d(z)?!!z.capture:!!z,C=en(C),p&&p[Se]?(p=p.i,T=String(T).toString(),T in p.g&&(be=p.g[T],C=Pt(be,C,z,me),-1<C&&(Oe(be[C]),Array.prototype.splice.call(be,C,1),be.length==0&&(delete p.g[T],p.h--)))):p&&(p=Dr(p))&&(T=p.g[T.toString()],p=-1,T&&(p=Pt(T,C,z,me)),(C=-1<p?T[p]:null)&&Ct(C))}function Ct(p){if(typeof p!="number"&&p&&!p.da){var T=p.src;if(T&&T[Se])ee(T.i,p);else{var C=p.type,z=p.proxy;T.removeEventListener?T.removeEventListener(C,z,p.capture):T.detachEvent?T.detachEvent(wr(C),z):T.addListener&&T.removeListener&&T.removeListener(z),(C=Dr(T))?(ee(C,p),C.h==0&&(C.src=null,T[_t]=null)):Oe(p)}}}function wr(p){return p in Dt?Dt[p]:Dt[p]="on"+p}function _n(p,T){if(p.da)p=!0;else{T=new te(T,this);var C=p.listener,z=p.ha||p.src;p.fa&&Ct(p),p=C.call(z,T)}return p}function Dr(p){return p=p[_t],p instanceof ot?p:null}var mr="__closure_events_fn_"+(1e9*Math.random()>>>0);function en(p){return typeof p=="function"?p:(p[mr]||(p[mr]=function(T){return p.handleEvent(T)}),p[mr])}function jt(){V.call(this),this.i=new ot(this),this.M=this,this.F=null}b(jt,V),jt.prototype[Se]=!0,jt.prototype.removeEventListener=function(p,T,C,z){Jt(this,p,T,C,z)};function oe(p,T){var C,z=p.F;if(z)for(C=[];z;z=z.F)C.push(z);if(p=p.M,z=T.type||T,typeof T=="string")T=new X(T,p);else if(T instanceof X)T.target=T.target||p;else{var me=T;T=new X(z,p),O(T,me)}if(me=!0,C)for(var be=C.length-1;0<=be;be--){var Ke=T.g=C[be];me=ze(Ke,z,!0,T)&&me}if(Ke=T.g=p,me=ze(Ke,z,!0,T)&&me,me=ze(Ke,z,!1,T)&&me,C)for(be=0;be<C.length;be++)Ke=T.g=C[be],me=ze(Ke,z,!1,T)&&me}jt.prototype.N=function(){if(jt.aa.N.call(this),this.i){var p=this.i,T;for(T in p.g){for(var C=p.g[T],z=0;z<C.length;z++)Oe(C[z]);delete p.g[T],p.h--}}this.F=null},jt.prototype.K=function(p,T,C,z){return this.i.add(String(p),T,!1,C,z)},jt.prototype.L=function(p,T,C,z){return this.i.add(String(p),T,!0,C,z)};function ze(p,T,C,z){if(T=p.i.g[String(T)],!T)return!0;T=T.concat();for(var me=!0,be=0;be<T.length;++be){var Ke=T[be];if(Ke&&!Ke.da&&Ke.capture==C){var $t=Ke.listener,hn=Ke.ha||Ke.src;Ke.fa&&ee(p.i,Ke),me=$t.call(hn,z)!==!1&&me}}return me&&!z.defaultPrevented}function Ve(p,T,C){if(typeof p=="function")C&&(p=_(p,C));else if(p&&typeof p.handleEvent=="function")p=_(p.handleEvent,p);else throw Error("Invalid listener argument");return 2147483647<Number(T)?-1:u.setTimeout(p,T||0)}function Je(p){p.g=Ve(()=>{p.g=null,p.i&&(p.i=!1,Je(p))},p.l);const T=p.h;p.h=null,p.m.apply(null,T)}class ft extends V{constructor(T,C){super(),this.m=T,this.l=C,this.h=null,this.i=!1,this.g=null}j(T){this.h=arguments,this.g?this.i=!0:Je(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ae(p){V.call(this),this.h=p,this.g={}}b(Ae,V);var Me=[];function Xe(p){B(p.g,function(T,C){this.g.hasOwnProperty(C)&&Ct(T)},p),p.g={}}Ae.prototype.N=function(){Ae.aa.N.call(this),Xe(this)},Ae.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ct=u.JSON.stringify,sr=u.JSON.parse,Or=class{stringify(p){return u.JSON.stringify(p,void 0)}parse(p){return u.JSON.parse(p,void 0)}};function fn(){}fn.prototype.h=null;function Rn(p){return p.h||(p.h=p.i())}function li(){}var se={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ue(){X.call(this,"d")}b(Ue,X);function Qe(){X.call(this,"c")}b(Qe,X);var lt={},st=null;function Fr(){return st=st||new jt}lt.La="serverreachability";function wn(p){X.call(this,lt.La,p)}b(wn,X);function Ur(p){const T=Fr();oe(T,new wn(T))}lt.STAT_EVENT="statevent";function Ot(p,T){X.call(this,lt.STAT_EVENT,p),this.stat=T}b(Ot,X);function et(p){const T=Fr();oe(T,new Ot(T,p))}lt.Ma="timingevent";function bt(p,T){X.call(this,lt.Ma,p),this.size=T}b(bt,X);function Ht(p,T){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){p()},T)}function Nt(){this.g=!0}Nt.prototype.xa=function(){this.g=!1};function Ta(p,T,C,z,me,be){p.info(function(){if(p.g)if(be)for(var Ke="",$t=be.split("&"),hn=0;hn<$t.length;hn++){var Kt=$t[hn].split("=");if(1<Kt.length){var Tn=Kt[0];Kt=Kt[1];var dn=Tn.split("_");Ke=2<=dn.length&&dn[1]=="type"?Ke+(Tn+"="+Kt+"&"):Ke+(Tn+"=redacted&")}}else Ke=null;else Ke=be;return"XMLHTTP REQ ("+z+") [attempt "+me+"]: "+T+`
`+C+`
`+Ke})}function pr(p,T,C,z,me,be,Ke){p.info(function(){return"XMLHTTP RESP ("+z+") [ attempt "+me+"]: "+T+`
`+C+`
`+be+" "+Ke})}function L(p,T,C,z){p.info(function(){return"XMLHTTP TEXT ("+T+"): "+H(p,C)+(z?" "+z:"")})}function K(p,T){p.info(function(){return"TIMEOUT: "+T})}Nt.prototype.info=function(){};function H(p,T){if(!p.g)return T;if(!T)return null;try{var C=JSON.parse(T);if(C){for(p=0;p<C.length;p++)if(Array.isArray(C[p])){var z=C[p];if(!(2>z.length)){var me=z[1];if(Array.isArray(me)&&!(1>me.length)){var be=me[0];if(be!="noop"&&be!="stop"&&be!="close")for(var Ke=1;Ke<me.length;Ke++)me[Ke]=""}}}}return ct(C)}catch{return T}}var q={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Q={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Y;function de(){}b(de,fn),de.prototype.g=function(){return new XMLHttpRequest},de.prototype.i=function(){return{}},Y=new de;function Te(p,T,C,z){this.j=p,this.i=T,this.l=C,this.R=z||1,this.U=new Ae(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new ce}function ce(){this.i=null,this.g="",this.h=!1}var ye={},_e={};function Be(p,T,C){p.L=1,p.v=Xo(Sa(T)),p.m=C,p.P=!0,We(p,null)}function We(p,T){p.F=Date.now(),Ze(p),p.A=Sa(p.v);var C=p.A,z=p.R;Array.isArray(z)||(z=[String(z)]),Du(C.i,"t",z),p.C=0,C=p.j.J,p.h=new ce,p.g=lh(p.j,C?T:null,!p.m),0<p.O&&(p.M=new ft(_(p.Y,p,p.g),p.O)),T=p.U,C=p.g,z=p.ca;var me="readystatechange";Array.isArray(me)||(me&&(Me[0]=me.toString()),me=Me);for(var be=0;be<me.length;be++){var Ke=nt(C,me[be],z||T.handleEvent,!1,T.h||T);if(!Ke)break;T.g[Ke.key]=Ke}T=p.H?D(p.H):{},p.m?(p.u||(p.u="POST"),T["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.A,p.u,p.m,T)):(p.u="GET",p.g.ea(p.A,p.u,null,T)),Ur(),Ta(p.i,p.u,p.A,p.l,p.R,p.m)}Te.prototype.ca=function(p){p=p.target;const T=this.M;T&&qa(p)==3?T.j():this.Y(p)},Te.prototype.Y=function(p){try{if(p==this.g)e:{const dn=qa(this.g);var T=this.g.Ba();const is=this.g.Z();if(!(3>dn)&&(dn!=3||this.g&&(this.h.h||this.g.oa()||eh(this.g)))){this.J||dn!=4||T==7||(T==8||0>=is?Ur(3):Ur(2)),rr(this);var C=this.g.Z();this.X=C;t:if(tt(this)){var z=eh(this.g);p="";var me=z.length,be=qa(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Xt(this),Wt(this);var Ke="";break t}this.h.i=new u.TextDecoder}for(T=0;T<me;T++)this.h.h=!0,p+=this.h.i.decode(z[T],{stream:!(be&&T==me-1)});z.length=0,this.h.g+=p,this.C=0,Ke=this.h.g}else Ke=this.g.oa();if(this.o=C==200,pr(this.i,this.u,this.A,this.l,this.R,dn,C),this.o){if(this.T&&!this.K){t:{if(this.g){var $t,hn=this.g;if(($t=hn.g?hn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!j($t)){var Kt=$t;break t}}Kt=null}if(C=Kt)L(this.i,this.l,C,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ba(this,C);else{this.o=!1,this.s=3,et(12),Xt(this),Wt(this);break e}}if(this.P){C=!0;let Dn;for(;!this.J&&this.C<Ke.length;)if(Dn=qe(this,Ke),Dn==_e){dn==4&&(this.s=4,et(14),C=!1),L(this.i,this.l,null,"[Incomplete Response]");break}else if(Dn==ye){this.s=4,et(15),L(this.i,this.l,Ke,"[Invalid Chunk]"),C=!1;break}else L(this.i,this.l,Dn,null),ba(this,Dn);if(tt(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),dn!=4||Ke.length!=0||this.h.h||(this.s=1,et(16),C=!1),this.o=this.o&&C,!C)L(this.i,this.l,Ke,"[Invalid Chunked Response]"),Xt(this),Wt(this);else if(0<Ke.length&&!this.W){this.W=!0;var Tn=this.j;Tn.g==this&&Tn.ba&&!Tn.M&&(Tn.j.info("Great, no buffering proxy detected. Bytes received: "+Ke.length),tl(Tn),Tn.M=!0,et(11))}}else L(this.i,this.l,Ke,null),ba(this,Ke);dn==4&&Xt(this),this.o&&!this.J&&(dn==4?ih(this.j,this):(this.o=!1,Ze(this)))}else ap(this.g),C==400&&0<Ke.indexOf("Unknown SID")?(this.s=3,et(12)):(this.s=0,et(13)),Xt(this),Wt(this)}}}catch{}finally{}};function tt(p){return p.g?p.u=="GET"&&p.L!=2&&p.j.Ca:!1}function qe(p,T){var C=p.C,z=T.indexOf(`
`,C);return z==-1?_e:(C=Number(T.substring(C,z)),isNaN(C)?ye:(z+=1,z+C>T.length?_e:(T=T.slice(z,z+C),p.C=z+C,T)))}Te.prototype.cancel=function(){this.J=!0,Xt(this)};function Ze(p){p.S=Date.now()+p.I,wt(p,p.I)}function wt(p,T){if(p.B!=null)throw Error("WatchDog timer not null");p.B=Ht(_(p.ba,p),T)}function rr(p){p.B&&(u.clearTimeout(p.B),p.B=null)}Te.prototype.ba=function(){this.B=null;const p=Date.now();0<=p-this.S?(K(this.i,this.A),this.L!=2&&(Ur(),et(17)),Xt(this),this.s=2,Wt(this)):wt(this,this.S-p)};function Wt(p){p.j.G==0||p.J||ih(p.j,p)}function Xt(p){rr(p);var T=p.M;T&&typeof T.ma=="function"&&T.ma(),p.M=null,Xe(p.U),p.g&&(T=p.g,p.g=null,T.abort(),T.ma())}function ba(p,T){try{var C=p.j;if(C.G!=0&&(C.g==p||na(C.h,p))){if(!p.K&&na(C.h,p)&&C.G==3){try{var z=C.Da.g.parse(T)}catch{z=null}if(Array.isArray(z)&&z.length==3){var me=z;if(me[0]==0){e:if(!C.u){if(C.g)if(C.g.F+3e3<p.F)oc(C),ic(C);else break e;Pu(C),et(18)}}else C.za=me[1],0<C.za-C.T&&37500>me[2]&&C.F&&C.v==0&&!C.C&&(C.C=Ht(_(C.Za,C),6e3));if(1>=Ei(C.h)&&C.ca){try{C.ca()}catch{}C.ca=void 0}}else as(C,11)}else if((p.K||C.g==p)&&oc(C),!j(T))for(me=C.Da.g.parse(T),T=0;T<me.length;T++){let Kt=me[T];if(C.T=Kt[0],Kt=Kt[1],C.G==2)if(Kt[0]=="c"){C.K=Kt[1],C.ia=Kt[2];const Tn=Kt[3];Tn!=null&&(C.la=Tn,C.j.info("VER="+C.la));const dn=Kt[4];dn!=null&&(C.Aa=dn,C.j.info("SVER="+C.Aa));const is=Kt[5];is!=null&&typeof is=="number"&&0<is&&(z=1.5*is,C.L=z,C.j.info("backChannelRequestTimeoutMs_="+z)),z=C;const Dn=p.g;if(Dn){const Ni=Dn.g?Dn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ni){var be=z.h;be.g||Ni.indexOf("spdy")==-1&&Ni.indexOf("quic")==-1&&Ni.indexOf("h2")==-1||(be.j=be.l,be.g=new Set,be.h&&(Jl(be,be.h),be.h=null))}if(z.D){const Uu=Dn.g?Dn.g.getResponseHeader("X-HTTP-Session-Id"):null;Uu&&(z.ya=Uu,gr(z.I,z.D,Uu))}}C.G=3,C.l&&C.l.ua(),C.ba&&(C.R=Date.now()-p.F,C.j.info("Handshake RTT: "+C.R+"ms")),z=C;var Ke=p;if(z.qa=oh(z,z.J?z.ia:null,z.W),Ke.K){aa(z.h,Ke);var $t=Ke,hn=z.L;hn&&($t.I=hn),$t.B&&(rr($t),Ze($t)),z.g=Ke}else nh(z);0<C.i.length&&sc(C)}else Kt[0]!="stop"&&Kt[0]!="close"||as(C,7);else C.G==3&&(Kt[0]=="stop"||Kt[0]=="close"?Kt[0]=="stop"?as(C,7):Lu(C):Kt[0]!="noop"&&C.l&&C.l.ta(Kt),C.v=0)}}Ur(4)}catch{}}var wi=class{constructor(p,T){this.g=p,this.map=T}};function ra(p){this.l=p||10,u.PerformanceNavigationTiming?(p=u.performance.getEntriesByType("navigation"),p=0<p.length&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function da(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function Ei(p){return p.h?1:p.g?p.g.size:0}function na(p,T){return p.h?p.h==T:p.g?p.g.has(T):!1}function Jl(p,T){p.g?p.g.add(T):p.h=T}function aa(p,T){p.h&&p.h==T?p.h=null:p.g&&p.g.has(T)&&p.g.delete(T)}ra.prototype.cancel=function(){if(this.i=Cu(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function Cu(p){if(p.h!=null)return p.i.concat(p.h.D);if(p.g!=null&&p.g.size!==0){let T=p.i;for(const C of p.g.values())T=T.concat(C.D);return T}return w(p.i)}function ep(p){if(p.V&&typeof p.V=="function")return p.V();if(typeof Map<"u"&&p instanceof Map||typeof Set<"u"&&p instanceof Set)return Array.from(p.values());if(typeof p=="string")return p.split("");if(f(p)){for(var T=[],C=p.length,z=0;z<C;z++)T.push(p[z]);return T}T=[],C=0;for(z in p)T[C++]=p[z];return T}function Zl(p){if(p.na&&typeof p.na=="function")return p.na();if(!p.V||typeof p.V!="function"){if(typeof Map<"u"&&p instanceof Map)return Array.from(p.keys());if(!(typeof Set<"u"&&p instanceof Set)){if(f(p)||typeof p=="string"){var T=[];p=p.length;for(var C=0;C<p;C++)T.push(C);return T}T=[],C=0;for(const z in p)T[C++]=z;return T}}}function Nu(p,T){if(p.forEach&&typeof p.forEach=="function")p.forEach(T,void 0);else if(f(p)||typeof p=="string")Array.prototype.forEach.call(p,T,void 0);else for(var C=Zl(p),z=ep(p),me=z.length,be=0;be<me;be++)T.call(void 0,z[be],C&&C[be],p)}var qo=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function tp(p,T){if(p){p=p.split("&");for(var C=0;C<p.length;C++){var z=p[C].indexOf("="),me=null;if(0<=z){var be=p[C].substring(0,z);me=p[C].substring(z+1)}else be=p[C];T(be,me?decodeURIComponent(me.replace(/\+/g," ")):"")}}}function tn(p){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,p instanceof tn){this.h=p.h,Wo(this,p.j),this.o=p.o,this.g=p.g,Ls(this,p.s),this.l=p.l;var T=p.i,C=new es;C.i=T.i,T.g&&(C.g=new Map(T.g),C.h=T.h),Zi(this,C),this.m=p.m}else p&&(T=String(p).match(qo))?(this.h=!1,Wo(this,T[1]||"",!0),this.o=za(T[2]||""),this.g=za(T[3]||"",!0),Ls(this,T[4]),this.l=za(T[5]||"",!0),Zi(this,T[6]||"",!0),this.m=za(T[7]||"")):(this.h=!1,this.i=new es(null,this.h))}tn.prototype.toString=function(){var p=[],T=this.j;T&&p.push($o(T,Iu,!0),":");var C=this.g;return(C||T=="file")&&(p.push("//"),(T=this.o)&&p.push($o(T,Iu,!0),"@"),p.push(encodeURIComponent(String(C)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),C=this.s,C!=null&&p.push(":",String(C))),(C=this.l)&&(this.g&&C.charAt(0)!="/"&&p.push("/"),p.push($o(C,C.charAt(0)=="/"?rp:Ru,!0))),(C=this.i.toString())&&p.push("?",C),(C=this.m)&&p.push("#",$o(C,ec)),p.join("")};function Sa(p){return new tn(p)}function Wo(p,T,C){p.j=C?za(T,!0):T,p.j&&(p.j=p.j.replace(/:$/,""))}function Ls(p,T){if(T){if(T=Number(T),isNaN(T)||0>T)throw Error("Bad port number "+T);p.s=T}else p.s=null}function Zi(p,T,C){T instanceof es?(p.i=T,J0(p.i,p.h)):(C||(T=$o(T,np)),p.i=new es(T,p.h))}function gr(p,T,C){p.i.set(T,C)}function Xo(p){return gr(p,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),p}function za(p,T){return p?T?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function $o(p,T,C){return typeof p=="string"?(p=encodeURI(p).replace(T,Q0),C&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function Q0(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var Iu=/[#\/\?@]/g,Ru=/[#\?:]/g,rp=/[#\?]/g,np=/[#\?@]/g,ec=/#/g;function es(p,T){this.h=this.g=null,this.i=p||null,this.j=!!T}function Ha(p){p.g||(p.g=new Map,p.h=0,p.i&&tp(p.i,function(T,C){p.add(decodeURIComponent(T.replace(/\+/g," ")),C)}))}t=es.prototype,t.add=function(p,T){Ha(this),this.i=null,p=Ti(this,p);var C=this.g.get(p);return C||this.g.set(p,C=[]),C.push(T),this.h+=1,this};function ts(p,T){Ha(p),T=Ti(p,T),p.g.has(T)&&(p.i=null,p.h-=p.g.get(T).length,p.g.delete(T))}function rs(p,T){return Ha(p),T=Ti(p,T),p.g.has(T)}t.forEach=function(p,T){Ha(this),this.g.forEach(function(C,z){C.forEach(function(me){p.call(T,me,z,this)},this)},this)},t.na=function(){Ha(this);const p=Array.from(this.g.values()),T=Array.from(this.g.keys()),C=[];for(let z=0;z<T.length;z++){const me=p[z];for(let be=0;be<me.length;be++)C.push(T[z])}return C},t.V=function(p){Ha(this);let T=[];if(typeof p=="string")rs(this,p)&&(T=T.concat(this.g.get(Ti(this,p))));else{p=Array.from(this.g.values());for(let C=0;C<p.length;C++)T=T.concat(p[C])}return T},t.set=function(p,T){return Ha(this),this.i=null,p=Ti(this,p),rs(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[T]),this.h+=1,this},t.get=function(p,T){return p?(p=this.V(p),0<p.length?String(p[0]):T):T};function Du(p,T,C){ts(p,T),0<C.length&&(p.i=null,p.g.set(Ti(p,T),w(C)),p.h+=C.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],T=Array.from(this.g.keys());for(var C=0;C<T.length;C++){var z=T[C];const be=encodeURIComponent(String(z)),Ke=this.V(z);for(z=0;z<Ke.length;z++){var me=be;Ke[z]!==""&&(me+="="+encodeURIComponent(String(Ke[z]))),p.push(me)}}return this.i=p.join("&")};function Ti(p,T){return T=String(T),p.j&&(T=T.toLowerCase()),T}function J0(p,T){T&&!p.j&&(Ha(p),p.i=null,p.g.forEach(function(C,z){var me=z.toLowerCase();z!=me&&(ts(this,z),Du(this,me,C))},p)),p.j=T}function Ko(p,T){const C=new Nt;if(u.Image){const z=new Image;z.onload=E(Ga,C,"TestLoadImage: loaded",!0,T,z),z.onerror=E(Ga,C,"TestLoadImage: error",!1,T,z),z.onabort=E(Ga,C,"TestLoadImage: abort",!1,T,z),z.ontimeout=E(Ga,C,"TestLoadImage: timeout",!1,T,z),u.setTimeout(function(){z.ontimeout&&z.ontimeout()},1e4),z.src=p}else T(!1)}function ci(p,T){const C=new Nt,z=new AbortController,me=setTimeout(()=>{z.abort(),Ga(C,"TestPingServer: timeout",!1,T)},1e4);fetch(p,{signal:z.signal}).then(be=>{clearTimeout(me),be.ok?Ga(C,"TestPingServer: ok",!0,T):Ga(C,"TestPingServer: server error",!1,T)}).catch(()=>{clearTimeout(me),Ga(C,"TestPingServer: error",!1,T)})}function Ga(p,T,C,z,me){try{me&&(me.onload=null,me.onerror=null,me.onabort=null,me.ontimeout=null),z(C)}catch{}}function Yo(){this.g=new Or}function bi(p,T,C){const z=C||"";try{Nu(p,function(me,be){let Ke=me;d(me)&&(Ke=ct(me)),T.push(z+be+"="+encodeURIComponent(Ke))})}catch(me){throw T.push(z+"type="+encodeURIComponent("_badmap")),me}}function Ms(p){this.l=p.Ub||null,this.j=p.eb||!1}b(Ms,fn),Ms.prototype.g=function(){return new ns(this.l,this.j)},Ms.prototype.i=function(p){return function(){return p}}({});function ns(p,T){jt.call(this),this.D=p,this.o=T,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}b(ns,jt),t=ns.prototype,t.open=function(p,T){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=p,this.A=T,this.readyState=1,ki(this)},t.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const T={headers:this.u,method:this.B,credentials:this.m,cache:void 0};p&&(T.body=p),(this.D||u).fetch(new Request(this.A,T)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Si(this)),this.readyState=0},t.Sa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,ki(this)),this.g&&(this.readyState=3,ki(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Ou(this)}else p.text().then(this.Ra.bind(this),this.ga.bind(this))};function Ou(p){p.j.read().then(p.Pa.bind(p)).catch(p.ga.bind(p))}t.Pa=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var T=p.value?p.value:new Uint8Array(0);(T=this.v.decode(T,{stream:!p.done}))&&(this.response=this.responseText+=T)}p.done?Si(this):ki(this),this.readyState==3&&Ou(this)}},t.Ra=function(p){this.g&&(this.response=this.responseText=p,Si(this))},t.Qa=function(p){this.g&&(this.response=p,Si(this))},t.ga=function(){this.g&&Si(this)};function Si(p){p.readyState=4,p.l=null,p.j=null,p.v=null,ki(p)}t.setRequestHeader=function(p,T){this.u.append(p,T)},t.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],T=this.h.entries();for(var C=T.next();!C.done;)C=C.value,p.push(C[0]+": "+C[1]),C=T.next();return p.join(`\r
`)};function ki(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty(ns.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function Fu(p){let T="";return B(p,function(C,z){T+=z,T+=":",T+=C,T+=`\r
`}),T}function En(p,T,C){e:{for(z in C){var z=!1;break e}z=!0}z||(C=Fu(C),typeof p=="string"?C!=null&&encodeURIComponent(String(C)):gr(p,T,C))}function or(p){jt.call(this),this.headers=new Map,this.o=p||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}b(or,jt);var tc=/^https?$/i,Qo=["POST","PUT"];t=or.prototype,t.Ha=function(p){this.J=p},t.ea=function(p,T,C,z){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);T=T?T.toUpperCase():"GET",this.D=p,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Y.g(),this.v=this.o?Rn(this.o):Rn(Y),this.g.onreadystatechange=_(this.Ea,this);try{this.B=!0,this.g.open(T,String(p),!0),this.B=!1}catch(be){Z0(this,be);return}if(p=C||"",C=new Map(this.headers),z)if(Object.getPrototypeOf(z)===Object.prototype)for(var me in z)C.set(me,z[me]);else if(typeof z.keys=="function"&&typeof z.get=="function")for(const be of z.keys())C.set(be,z.get(be));else throw Error("Unknown input type for opt_headers: "+String(z));z=Array.from(C.keys()).find(be=>be.toLowerCase()=="content-type"),me=u.FormData&&p instanceof u.FormData,!(0<=Array.prototype.indexOf.call(Qo,T,void 0))||z||me||C.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[be,Ke]of C)this.g.setRequestHeader(be,Ke);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Jo(this),this.u=!0,this.g.send(p),this.u=!1}catch(be){Z0(this,be)}};function Z0(p,T){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=T,p.m=5,rc(p),Ai(p)}function rc(p){p.A||(p.A=!0,oe(p,"complete"),oe(p,"error"))}t.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=p||7,oe(this,"complete"),oe(this,"abort"),Ai(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ai(this,!0)),or.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?nc(this):this.bb())},t.bb=function(){nc(this)};function nc(p){if(p.h&&typeof l<"u"&&(!p.v[1]||qa(p)!=4||p.Z()!=2)){if(p.u&&qa(p)==4)Ve(p.Ea,0,p);else if(oe(p,"readystatechange"),qa(p)==4){p.h=!1;try{const Ke=p.Z();e:switch(Ke){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var T=!0;break e;default:T=!1}var C;if(!(C=T)){var z;if(z=Ke===0){var me=String(p.D).match(qo)[1]||null;!me&&u.self&&u.self.location&&(me=u.self.location.protocol.slice(0,-1)),z=!tc.test(me?me.toLowerCase():"")}C=z}if(C)oe(p,"complete"),oe(p,"success");else{p.m=6;try{var be=2<qa(p)?p.g.statusText:""}catch{be=""}p.l=be+" ["+p.Z()+"]",rc(p)}}finally{Ai(p)}}}}function Ai(p,T){if(p.g){Jo(p);const C=p.g,z=p.v[0]?()=>{}:null;p.g=null,p.v=null,T||oe(p,"ready");try{C.onreadystatechange=z}catch{}}}function Jo(p){p.I&&(u.clearTimeout(p.I),p.I=null)}t.isActive=function(){return!!this.g};function qa(p){return p.g?p.g.readyState:0}t.Z=function(){try{return 2<qa(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(p){if(this.g){var T=this.g.responseText;return p&&T.indexOf(p)==0&&(T=T.substring(p.length)),sr(T)}};function eh(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.H){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function ap(p){const T={};p=(p.g&&2<=qa(p)&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let z=0;z<p.length;z++){if(j(p[z]))continue;var C=P(p[z]);const me=C[0];if(C=C[1],typeof C!="string")continue;C=C.trim();const be=T[me]||[];T[me]=be,be.push(C)}A(T,function(z){return z.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Zo(p,T,C){return C&&C.internalChannelParams&&C.internalChannelParams[p]||T}function ac(p){this.Aa=0,this.i=[],this.j=new Nt,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Zo("failFast",!1,p),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Zo("baseRetryDelayMs",5e3,p),this.cb=Zo("retryDelaySeedMs",1e4,p),this.Wa=Zo("forwardChannelMaxRetries",2,p),this.wa=Zo("forwardChannelRequestTimeoutMs",2e4,p),this.pa=p&&p.xmlHttpFactory||void 0,this.Xa=p&&p.Tb||void 0,this.Ca=p&&p.useFetchStreams||!1,this.L=void 0,this.J=p&&p.supportsCrossDomainXhr||!1,this.K="",this.h=new ra(p&&p.concurrentRequestLimit),this.Da=new Yo,this.P=p&&p.fastHandshake||!1,this.O=p&&p.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=p&&p.Rb||!1,p&&p.xa&&this.j.xa(),p&&p.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&p&&p.detectBufferingProxy||!1,this.ja=void 0,p&&p.longPollingTimeout&&0<p.longPollingTimeout&&(this.ja=p.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=ac.prototype,t.la=8,t.G=1,t.connect=function(p,T,C,z){et(0),this.W=p,this.H=T||{},C&&z!==void 0&&(this.H.OSID=C,this.H.OAID=z),this.F=this.X,this.I=oh(this,null,this.W),sc(this)};function Lu(p){if(th(p),p.G==3){var T=p.U++,C=Sa(p.I);if(gr(C,"SID",p.K),gr(C,"RID",T),gr(C,"TYPE","terminate"),el(p,C),T=new Te(p,p.j,T),T.L=2,T.v=Xo(Sa(C)),C=!1,u.navigator&&u.navigator.sendBeacon)try{C=u.navigator.sendBeacon(T.v.toString(),"")}catch{}!C&&u.Image&&(new Image().src=T.v,C=!0),C||(T.g=lh(T.j,null),T.g.ea(T.v)),T.F=Date.now(),Ze(T)}sh(p)}function ic(p){p.g&&(tl(p),p.g.cancel(),p.g=null)}function th(p){ic(p),p.u&&(u.clearTimeout(p.u),p.u=null),oc(p),p.h.cancel(),p.s&&(typeof p.s=="number"&&u.clearTimeout(p.s),p.s=null)}function sc(p){if(!da(p.h)&&!p.s){p.s=!0;var T=p.Ga;le||J(),He||(le(),He=!0),ie.add(T,p),p.B=0}}function ip(p,T){return Ei(p.h)>=p.h.j-(p.s?1:0)?!1:p.s?(p.i=T.D.concat(p.i),!0):p.G==1||p.G==2||p.B>=(p.Va?0:p.Wa)?!1:(p.s=Ht(_(p.Ga,p,T),ju(p,p.B)),p.B++,!0)}t.Ga=function(p){if(this.s)if(this.s=null,this.G==1){if(!p){this.U=Math.floor(1e5*Math.random()),p=this.U++;const me=new Te(this,this.j,p);let be=this.o;if(this.S&&(be?(be=D(be),O(be,this.S)):be=this.S),this.m!==null||this.O||(me.H=be,be=null),this.P)e:{for(var T=0,C=0;C<this.i.length;C++){t:{var z=this.i[C];if("__data__"in z.map&&(z=z.map.__data__,typeof z=="string")){z=z.length;break t}z=void 0}if(z===void 0)break;if(T+=z,4096<T){T=C;break e}if(T===4096||C===this.i.length-1){T=C+1;break e}}T=1e3}else T=1e3;T=rh(this,me,T),C=Sa(this.I),gr(C,"RID",p),gr(C,"CVER",22),this.D&&gr(C,"X-HTTP-Session-Id",this.D),el(this,C),be&&(this.O?T="headers="+encodeURIComponent(String(Fu(be)))+"&"+T:this.m&&En(C,this.m,be)),Jl(this.h,me),this.Ua&&gr(C,"TYPE","init"),this.P?(gr(C,"$req",T),gr(C,"SID","null"),me.T=!0,Be(me,C,null)):Be(me,C,T),this.G=2}}else this.G==3&&(p?Mu(this,p):this.i.length==0||da(this.h)||Mu(this))};function Mu(p,T){var C;T?C=T.l:C=p.U++;const z=Sa(p.I);gr(z,"SID",p.K),gr(z,"RID",C),gr(z,"AID",p.T),el(p,z),p.m&&p.o&&En(z,p.m,p.o),C=new Te(p,p.j,C,p.B+1),p.m===null&&(C.H=p.o),T&&(p.i=T.D.concat(p.i)),T=rh(p,C,1e3),C.I=Math.round(.5*p.wa)+Math.round(.5*p.wa*Math.random()),Jl(p.h,C),Be(C,z,T)}function el(p,T){p.H&&B(p.H,function(C,z){gr(T,z,C)}),p.l&&Nu({},function(C,z){gr(T,z,C)})}function rh(p,T,C){C=Math.min(p.i.length,C);var z=p.l?_(p.l.Na,p.l,p):null;e:{var me=p.i;let be=-1;for(;;){const Ke=["count="+C];be==-1?0<C?(be=me[0].g,Ke.push("ofs="+be)):be=0:Ke.push("ofs="+be);let $t=!0;for(let hn=0;hn<C;hn++){let Kt=me[hn].g;const Tn=me[hn].map;if(Kt-=be,0>Kt)be=Math.max(0,me[hn].g-100),$t=!1;else try{bi(Tn,Ke,"req"+Kt+"_")}catch{z&&z(Tn)}}if($t){z=Ke.join("&");break e}}}return p=p.i.splice(0,C),T.D=p,z}function nh(p){if(!p.g&&!p.u){p.Y=1;var T=p.Fa;le||J(),He||(le(),He=!0),ie.add(T,p),p.v=0}}function Pu(p){return p.g||p.u||3<=p.v?!1:(p.Y++,p.u=Ht(_(p.Fa,p),ju(p,p.v)),p.v++,!0)}t.Fa=function(){if(this.u=null,ah(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var p=2*this.R;this.j.info("BP detection timer enabled: "+p),this.A=Ht(_(this.ab,this),p)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,et(10),ic(this),ah(this))};function tl(p){p.A!=null&&(u.clearTimeout(p.A),p.A=null)}function ah(p){p.g=new Te(p,p.j,"rpc",p.Y),p.m===null&&(p.g.H=p.o),p.g.O=0;var T=Sa(p.qa);gr(T,"RID","rpc"),gr(T,"SID",p.K),gr(T,"AID",p.T),gr(T,"CI",p.F?"0":"1"),!p.F&&p.ja&&gr(T,"TO",p.ja),gr(T,"TYPE","xmlhttp"),el(p,T),p.m&&p.o&&En(T,p.m,p.o),p.L&&(p.g.I=p.L);var C=p.g;p=p.ia,C.L=1,C.v=Xo(Sa(T)),C.m=null,C.P=!0,We(C,p)}t.Za=function(){this.C!=null&&(this.C=null,ic(this),Pu(this),et(19))};function oc(p){p.C!=null&&(u.clearTimeout(p.C),p.C=null)}function ih(p,T){var C=null;if(p.g==T){oc(p),tl(p),p.g=null;var z=2}else if(na(p.h,T))C=T.D,aa(p.h,T),z=1;else return;if(p.G!=0){if(T.o)if(z==1){C=T.m?T.m.length:0,T=Date.now()-T.F;var me=p.B;z=Fr(),oe(z,new bt(z,C)),sc(p)}else nh(p);else if(me=T.s,me==3||me==0&&0<T.X||!(z==1&&ip(p,T)||z==2&&Pu(p)))switch(C&&0<C.length&&(T=p.h,T.i=T.i.concat(C)),me){case 1:as(p,5);break;case 4:as(p,10);break;case 3:as(p,6);break;default:as(p,2)}}}function ju(p,T){let C=p.Ta+Math.floor(Math.random()*p.cb);return p.isActive()||(C*=2),C*T}function as(p,T){if(p.j.info("Error code "+T),T==2){var C=_(p.fb,p),z=p.Xa;const me=!z;z=new tn(z||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||Wo(z,"https"),Xo(z),me?Ko(z.toString(),C):ci(z.toString(),C)}else et(2);p.G=0,p.l&&p.l.sa(T),sh(p),th(p)}t.fb=function(p){p?(this.j.info("Successfully pinged google.com"),et(2)):(this.j.info("Failed to ping google.com"),et(1))};function sh(p){if(p.G=0,p.ka=[],p.l){const T=Cu(p.h);(T.length!=0||p.i.length!=0)&&(S(p.ka,T),S(p.ka,p.i),p.h.i.length=0,w(p.i),p.i.length=0),p.l.ra()}}function oh(p,T,C){var z=C instanceof tn?Sa(C):new tn(C);if(z.g!="")T&&(z.g=T+"."+z.g),Ls(z,z.s);else{var me=u.location;z=me.protocol,T=T?T+"."+me.hostname:me.hostname,me=+me.port;var be=new tn(null);z&&Wo(be,z),T&&(be.g=T),me&&Ls(be,me),C&&(be.l=C),z=be}return C=p.D,T=p.ya,C&&T&&gr(z,C,T),gr(z,"VER",p.la),el(p,z),z}function lh(p,T,C){if(T&&!p.J)throw Error("Can't create secondary domain capable XhrIo object.");return T=p.Ca&&!p.pa?new or(new Ms({eb:C})):new or(p.pa),T.Ha(p.J),T}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function ch(){}t=ch.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function lc(){}lc.prototype.g=function(p,T){return new ia(p,T)};function ia(p,T){jt.call(this),this.g=new ac(T),this.l=p,this.h=T&&T.messageUrlParams||null,p=T&&T.messageHeaders||null,T&&T.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=T&&T.initMessageHeaders||null,T&&T.messageContentType&&(p?p["X-WebChannel-Content-Type"]=T.messageContentType:p={"X-WebChannel-Content-Type":T.messageContentType}),T&&T.va&&(p?p["X-WebChannel-Client-Profile"]=T.va:p={"X-WebChannel-Client-Profile":T.va}),this.g.S=p,(p=T&&T.Sb)&&!j(p)&&(this.g.m=p),this.v=T&&T.supportsCrossDomainXhr||!1,this.u=T&&T.sendRawJson||!1,(T=T&&T.httpSessionIdParam)&&!j(T)&&(this.g.D=T,p=this.h,p!==null&&T in p&&(p=this.h,T in p&&delete p[T])),this.j=new Ci(this)}b(ia,jt),ia.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},ia.prototype.close=function(){Lu(this.g)},ia.prototype.o=function(p){var T=this.g;if(typeof p=="string"){var C={};C.__data__=p,p=C}else this.u&&(C={},C.__data__=ct(p),p=C);T.i.push(new wi(T.Ya++,p)),T.G==3&&sc(T)},ia.prototype.N=function(){this.g.l=null,delete this.j,Lu(this.g),delete this.g,ia.aa.N.call(this)};function uh(p){Ue.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var T=p.__sm__;if(T){e:{for(const C in T){p=C;break e}p=void 0}(this.i=p)&&(p=this.i,T=T!==null&&p in T?T[p]:void 0),this.data=T}else this.data=p}b(uh,Ue);function fh(){Qe.call(this),this.status=1}b(fh,Qe);function Ci(p){this.g=p}b(Ci,ch),Ci.prototype.ua=function(){oe(this.g,"a")},Ci.prototype.ta=function(p){oe(this.g,new uh(p))},Ci.prototype.sa=function(p){oe(this.g,new fh)},Ci.prototype.ra=function(){oe(this.g,"b")},lc.prototype.createWebChannel=lc.prototype.g,ia.prototype.send=ia.prototype.o,ia.prototype.open=ia.prototype.m,ia.prototype.close=ia.prototype.close,sS=function(){return new lc},iS=function(){return Fr()},aS=lt,Gx={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},q.NO_ERROR=0,q.TIMEOUT=8,q.HTTP_ERROR=6,Dd=q,Q.COMPLETE="complete",nS=Q,li.EventType=se,se.OPEN="a",se.CLOSE="b",se.ERROR="c",se.MESSAGE="d",jt.prototype.listen=jt.prototype.K,Of=li,or.prototype.listenOnce=or.prototype.L,or.prototype.getLastError=or.prototype.Ka,or.prototype.getLastErrorCode=or.prototype.Ba,or.prototype.getStatus=or.prototype.Z,or.prototype.getResponseJson=or.prototype.Oa,or.prototype.getResponseText=or.prototype.oa,or.prototype.send=or.prototype.ea,or.prototype.setWithCredentials=or.prototype.Ha,rS=or}).apply(typeof hd<"u"?hd:typeof self<"u"?self:typeof window<"u"?window:{});const Qw="@firebase/firestore",Jw="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Wn.UNAUTHENTICATED=new Wn(null),Wn.GOOGLE_CREDENTIALS=new Wn("google-credentials-uid"),Wn.FIRST_PARTY=new Wn("first-party-uid"),Wn.MOCK_USER=new Wn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vu="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Il=new D1("@firebase/firestore");function Hc(){return Il.logLevel}function at(t,...e){if(Il.logLevel<=Gt.DEBUG){const r=e.map(M1);Il.debug(`Firestore (${vu}): ${t}`,...r)}}function As(t,...e){if(Il.logLevel<=Gt.ERROR){const r=e.map(M1);Il.error(`Firestore (${vu}): ${t}`,...r)}}function So(t,...e){if(Il.logLevel<=Gt.WARN){const r=e.map(M1);Il.warn(`Firestore (${vu}): ${t}`,...r)}}function M1(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yt(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,oS(t,n,r)}function oS(t,e,r){let n=`FIRESTORE (${vu}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw As(n),new Error(n)}function lr(t,e,r,n){let a="Unexpected state";typeof r=="string"?a=r:n=r,t||oS(e,a,n)}function kt(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const De={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class rt extends Yi{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wo{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lS{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class dR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Wn.UNAUTHENTICATED))}shutdown(){}}class mR{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class pR{constructor(e){this.t=e,this.currentUser=Wn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){lr(this.o===void 0,42304);let n=this.i;const a=f=>this.i!==n?(n=this.i,r(f)):Promise.resolve();let s=new wo;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new wo,e.enqueueRetryable(()=>a(this.currentUser))};const l=()=>{const f=s;e.enqueueRetryable(async()=>{await f.promise,await a(this.currentUser)})},u=f=>{at("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit(f=>u(f)),setTimeout(()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?u(f):(at("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new wo)}},0),l()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(at("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(lr(typeof n.accessToken=="string",31837,{l:n}),new lS(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return lr(e===null||typeof e=="string",2055,{h:e}),new Wn(e)}}class gR{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=Wn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class xR{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new gR(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(Wn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Zw{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class vR{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,La(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){lr(this.o===void 0,3512);const n=s=>{s.error!=null&&at("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const l=s.token!==this.m;return this.m=s.token,at("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?r(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const a=s=>{at("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>a(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?a(s):at("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Zw(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(lr(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new Zw(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yR(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cS(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P1{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const a=yR(40);for(let s=0;s<a.length;++s)n.length<20&&a[s]<r&&(n+=e.charAt(a[s]%62))}return n}}function Lt(t,e){return t<e?-1:t>e?1:0}function qx(t,e){let r=0;for(;r<t.length&&r<e.length;){const n=t.codePointAt(r),a=e.codePointAt(r);if(n!==a){if(n<128&&a<128)return Lt(n,a);{const s=cS(),l=_R(s.encode(eE(t,r)),s.encode(eE(e,r)));return l!==0?l:Lt(n,a)}}r+=n>65535?2:1}return Lt(t.length,e.length)}function eE(t,e){return t.codePointAt(e)>65535?t.substring(e,e+2):t.substring(e,e+1)}function _R(t,e){for(let r=0;r<t.length&&r<e.length;++r)if(t[r]!==e[r])return Lt(t[r],e[r]);return Lt(t.length,e.length)}function uu(t,e,r){return t.length===e.length&&t.every((n,a)=>r(n,e[a]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tE="__name__";class ji{constructor(e,r,n){r===void 0?r=0:r>e.length&&yt(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&yt(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return ji.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof ji?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let a=0;a<n;a++){const s=ji.compareSegments(e.get(a),r.get(a));if(s!==0)return s}return Lt(e.length,r.length)}static compareSegments(e,r){const n=ji.isNumericId(e),a=ji.isNumericId(r);return n&&!a?-1:!n&&a?1:n&&a?ji.extractNumericId(e).compare(ji.extractNumericId(r)):qx(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return _o.fromString(e.substring(4,e.length-2))}}class br extends ji{construct(e,r,n){return new br(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new rt(De.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(a=>a.length>0))}return new br(r)}static emptyPath(){return new br([])}}const wR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Un extends ji{construct(e,r,n){return new Un(e,r,n)}static isValidIdentifier(e){return wR.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Un.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===tE}static keyField(){return new Un([tE])}static fromServerFormat(e){const r=[];let n="",a=0;const s=()=>{if(n.length===0)throw new rt(De.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let l=!1;for(;a<e.length;){const u=e[a];if(u==="\\"){if(a+1===e.length)throw new rt(De.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[a+1];if(f!=="\\"&&f!=="."&&f!=="`")throw new rt(De.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=f,a+=2}else u==="`"?(l=!l,a++):u!=="."||l?(n+=u,a++):(s(),a++)}if(s(),l)throw new rt(De.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Un(r)}static emptyPath(){return new Un([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dt{constructor(e){this.path=e}static fromPath(e){return new dt(br.fromString(e))}static fromName(e){return new dt(br.fromString(e).popFirst(5))}static empty(){return new dt(br.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&br.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return br.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new dt(new br(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uS(t,e,r){if(!r)throw new rt(De.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function ER(t,e,r,n){if(e===!0&&n===!0)throw new rt(De.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function rE(t){if(!dt.isDocumentKey(t))throw new rt(De.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function nE(t){if(dt.isDocumentKey(t))throw new rt(De.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function fS(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function bm(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":yt(12329,{type:typeof t})}function ko(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new rt(De.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=bm(t);throw new rt(De.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function un(t,e){const r={typeString:t};return e&&(r.value=e),r}function C0(t,e){if(!fS(t))throw new rt(De.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const a=e[n].typeString,s="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const l=t[n];if(a&&typeof l!==a){r=`JSON field '${n}' must be a ${a}.`;break}if(s!==void 0&&l!==s.value){r=`Expected '${n}' field to equal '${s.value}'`;break}}if(r)throw new rt(De.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aE=-62135596800,iE=1e6;class Cr{static now(){return Cr.fromMillis(Date.now())}static fromDate(e){return Cr.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*iE);return new Cr(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new rt(De.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new rt(De.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<aE)throw new rt(De.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new rt(De.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/iE}_compareTo(e){return this.seconds===e.seconds?Lt(this.nanoseconds,e.nanoseconds):Lt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Cr._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(C0(e,Cr._jsonSchema))return new Cr(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-aE;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Cr._jsonSchemaVersion="firestore/timestamp/1.0",Cr._jsonSchema={type:un("string",Cr._jsonSchemaVersion),seconds:un("number"),nanoseconds:un("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class St{static fromTimestamp(e){return new St(e)}static min(){return new St(new Cr(0,0))}static max(){return new St(new Cr(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n0=-1;function TR(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,a=St.fromTimestamp(n===1e9?new Cr(r+1,0):new Cr(r,n));return new Ao(a,dt.empty(),e)}function bR(t){return new Ao(t.readTime,t.key,n0)}class Ao{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Ao(St.min(),dt.empty(),n0)}static max(){return new Ao(St.max(),dt.empty(),n0)}}function SR(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=dt.comparator(t.documentKey,e.documentKey),r!==0?r:Lt(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class AR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yu(t){if(t.code!==De.FAILED_PRECONDITION||t.message!==kR)throw t;at("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Le{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&yt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Le((n,a)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,a)},this.catchCallback=s=>{this.wrapFailure(r,s).next(n,a)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof Le?r:Le.resolve(r)}catch(r){return Le.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):Le.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):Le.reject(r)}static resolve(e){return new Le((r,n)=>{r(e)})}static reject(e){return new Le((r,n)=>{n(e)})}static waitFor(e){return new Le((r,n)=>{let a=0,s=0,l=!1;e.forEach(u=>{++a,u.next(()=>{++s,l&&s===a&&r()},f=>n(f))}),l=!0,s===a&&r()})}static or(e){let r=Le.resolve(!1);for(const n of e)r=r.next(a=>a?Le.resolve(a):n());return r}static forEach(e,r){const n=[];return e.forEach((a,s)=>{n.push(r.call(this,a,s))}),this.waitFor(n)}static mapArray(e,r){return new Le((n,a)=>{const s=e.length,l=new Array(s);let u=0;for(let f=0;f<s;f++){const d=f;r(e[d]).next(m=>{l[d]=m,++u,u===s&&n(l)},m=>a(m))}})}static doWhile(e,r){return new Le((n,a)=>{const s=()=>{e()===!0?r().next(()=>{s()},a):n()};s()})}}function CR(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function _u(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sm{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this._e(n),this.ae=n=>r.writeSequenceNumber(n))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}Sm.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j1=-1;function km(t){return t==null}function Gd(t){return t===0&&1/t==-1/0}function NR(t){return typeof t=="number"&&Number.isInteger(t)&&!Gd(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hS="";function IR(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=sE(e)),e=RR(t.get(r),e);return sE(e)}function RR(t,e){let r=e;const n=t.length;for(let a=0;a<n;a++){const s=t.charAt(a);switch(s){case"\0":r+="";break;case hS:r+="";break;default:r+=s}}return r}function sE(t){return t+hS+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oE(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function jo(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function dS(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jr{constructor(e,r){this.comparator=e,this.root=r||Pn.EMPTY}insert(e,r){return new jr(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,Pn.BLACK,null,null))}remove(e){return new jr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Pn.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const a=this.comparator(e,n.key);if(a===0)return r+n.left.size;a<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new dd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new dd(this.root,e,this.comparator,!1)}getReverseIterator(){return new dd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new dd(this.root,e,this.comparator,!0)}}class dd{constructor(e,r,n,a){this.isReverse=a,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=r?n(e.key,r):1,r&&a&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Pn{constructor(e,r,n,a,s){this.key=e,this.value=r,this.color=n??Pn.RED,this.left=a??Pn.EMPTY,this.right=s??Pn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,a,s){return new Pn(e??this.key,r??this.value,n??this.color,a??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let a=this;const s=n(e,a.key);return a=s<0?a.copy(null,null,null,a.left.insert(e,r,n),null):s===0?a.copy(null,r,null,null,null):a.copy(null,null,null,null,a.right.insert(e,r,n)),a.fixUp()}removeMin(){if(this.left.isEmpty())return Pn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,a=this;if(r(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,r),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),r(e,a.key)===0){if(a.right.isEmpty())return Pn.EMPTY;n=a.right.min(),a=a.copy(n.key,n.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,r))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Pn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Pn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw yt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw yt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw yt(27949);return e+(this.isRed()?0:1)}}Pn.EMPTY=null,Pn.RED=!0,Pn.BLACK=!1;Pn.EMPTY=new class{constructor(){this.size=0}get key(){throw yt(57766)}get value(){throw yt(16141)}get color(){throw yt(16727)}get left(){throw yt(29726)}get right(){throw yt(36894)}copy(e,r,n,a,s){return this}insert(e,r,n){return new Pn(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vn{constructor(e){this.comparator=e,this.data=new jr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const a=n.getNext();if(this.comparator(a.key,e[1])>=0)return;r(a.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new lE(this.data.getIterator())}getIteratorFrom(e){return new lE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof vn)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const a=r.getNext().key,s=n.getNext().key;if(this.comparator(a,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new vn(this.comparator);return r.data=e,r}}class lE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ja{constructor(e){this.fields=e,e.sort(Un.comparator)}static empty(){return new ja([])}unionWith(e){let r=new vn(Un.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new ja(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return uu(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mS extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vn{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(a){try{return atob(a)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new mS("Invalid base64 string: "+s):s}}(e);return new Vn(r)}static fromUint8Array(e){const r=function(a){let s="";for(let l=0;l<a.length;++l)s+=String.fromCharCode(a[l]);return s}(e);return new Vn(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let a=0;a<r.length;a++)n[a]=r.charCodeAt(a);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Lt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Vn.EMPTY_BYTE_STRING=new Vn("");const DR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Co(t){if(lr(!!t,39018),typeof t=="string"){let e=0;const r=DR.exec(t);if(lr(!!r,46558,{timestamp:t}),r[1]){let a=r[1];a=(a+"000000000").substr(0,9),e=Number(a)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Qr(t.seconds),nanos:Qr(t.nanos)}}function Qr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function No(t){return typeof t=="string"?Vn.fromBase64String(t):Vn.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pS="server_timestamp",gS="__type__",xS="__previous_value__",vS="__local_write_time__";function U1(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[gS])===null||r===void 0?void 0:r.stringValue)===pS}function Am(t){const e=t.mapValue.fields[xS];return U1(e)?Am(e):e}function a0(t){const e=Co(t.mapValue.fields[vS].timestampValue);return new Cr(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OR{constructor(e,r,n,a,s,l,u,f,d,m){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=a,this.ssl=s,this.forceLongPolling=l,this.autoDetectLongPolling=u,this.longPollingOptions=f,this.useFetchStreams=d,this.isUsingEmulator=m}}const qd="(default)";class i0{constructor(e,r){this.projectId=e,this.database=r||qd}static empty(){return new i0("","")}get isDefaultDatabase(){return this.database===qd}isEqual(e){return e instanceof i0&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yS="__type__",FR="__max__",md={mapValue:{}},_S="__vector__",Wd="value";function Io(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?U1(t)?4:MR(t)?9007199254740991:LR(t)?10:11:yt(28295,{value:t})}function Ki(t,e){if(t===e)return!0;const r=Io(t);if(r!==Io(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return a0(t).isEqual(a0(e));case 3:return function(a,s){if(typeof a.timestampValue=="string"&&typeof s.timestampValue=="string"&&a.timestampValue.length===s.timestampValue.length)return a.timestampValue===s.timestampValue;const l=Co(a.timestampValue),u=Co(s.timestampValue);return l.seconds===u.seconds&&l.nanos===u.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(a,s){return No(a.bytesValue).isEqual(No(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(a,s){return Qr(a.geoPointValue.latitude)===Qr(s.geoPointValue.latitude)&&Qr(a.geoPointValue.longitude)===Qr(s.geoPointValue.longitude)}(t,e);case 2:return function(a,s){if("integerValue"in a&&"integerValue"in s)return Qr(a.integerValue)===Qr(s.integerValue);if("doubleValue"in a&&"doubleValue"in s){const l=Qr(a.doubleValue),u=Qr(s.doubleValue);return l===u?Gd(l)===Gd(u):isNaN(l)&&isNaN(u)}return!1}(t,e);case 9:return uu(t.arrayValue.values||[],e.arrayValue.values||[],Ki);case 10:case 11:return function(a,s){const l=a.mapValue.fields||{},u=s.mapValue.fields||{};if(oE(l)!==oE(u))return!1;for(const f in l)if(l.hasOwnProperty(f)&&(u[f]===void 0||!Ki(l[f],u[f])))return!1;return!0}(t,e);default:return yt(52216,{left:t})}}function s0(t,e){return(t.values||[]).find(r=>Ki(r,e))!==void 0}function fu(t,e){if(t===e)return 0;const r=Io(t),n=Io(e);if(r!==n)return Lt(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return Lt(t.booleanValue,e.booleanValue);case 2:return function(s,l){const u=Qr(s.integerValue||s.doubleValue),f=Qr(l.integerValue||l.doubleValue);return u<f?-1:u>f?1:u===f?0:isNaN(u)?isNaN(f)?0:-1:1}(t,e);case 3:return cE(t.timestampValue,e.timestampValue);case 4:return cE(a0(t),a0(e));case 5:return qx(t.stringValue,e.stringValue);case 6:return function(s,l){const u=No(s),f=No(l);return u.compareTo(f)}(t.bytesValue,e.bytesValue);case 7:return function(s,l){const u=s.split("/"),f=l.split("/");for(let d=0;d<u.length&&d<f.length;d++){const m=Lt(u[d],f[d]);if(m!==0)return m}return Lt(u.length,f.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,l){const u=Lt(Qr(s.latitude),Qr(l.latitude));return u!==0?u:Lt(Qr(s.longitude),Qr(l.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return uE(t.arrayValue,e.arrayValue);case 10:return function(s,l){var u,f,d,m;const y=s.fields||{},_=l.fields||{},E=(u=y[Wd])===null||u===void 0?void 0:u.arrayValue,b=(f=_[Wd])===null||f===void 0?void 0:f.arrayValue,w=Lt(((d=E==null?void 0:E.values)===null||d===void 0?void 0:d.length)||0,((m=b==null?void 0:b.values)===null||m===void 0?void 0:m.length)||0);return w!==0?w:uE(E,b)}(t.mapValue,e.mapValue);case 11:return function(s,l){if(s===md.mapValue&&l===md.mapValue)return 0;if(s===md.mapValue)return 1;if(l===md.mapValue)return-1;const u=s.fields||{},f=Object.keys(u),d=l.fields||{},m=Object.keys(d);f.sort(),m.sort();for(let y=0;y<f.length&&y<m.length;++y){const _=qx(f[y],m[y]);if(_!==0)return _;const E=fu(u[f[y]],d[m[y]]);if(E!==0)return E}return Lt(f.length,m.length)}(t.mapValue,e.mapValue);default:throw yt(23264,{le:r})}}function cE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Lt(t,e);const r=Co(t),n=Co(e),a=Lt(r.seconds,n.seconds);return a!==0?a:Lt(r.nanos,n.nanos)}function uE(t,e){const r=t.values||[],n=e.values||[];for(let a=0;a<r.length&&a<n.length;++a){const s=fu(r[a],n[a]);if(s)return s}return Lt(r.length,n.length)}function hu(t){return Wx(t)}function Wx(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=Co(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return No(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return dt.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",a=!0;for(const s of r.values||[])a?a=!1:n+=",",n+=Wx(s);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let a="{",s=!0;for(const l of n)s?s=!1:a+=",",a+=`${l}:${Wx(r.fields[l])}`;return a+"}"}(t.mapValue):yt(61005,{value:t})}function Od(t){switch(Io(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Am(t);return e?16+Od(e):16;case 5:return 2*t.stringValue.length;case 6:return No(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((a,s)=>a+Od(s),0)}(t.arrayValue);case 10:case 11:return function(n){let a=0;return jo(n.fields,(s,l)=>{a+=s.length+Od(l)}),a}(t.mapValue);default:throw yt(13486,{value:t})}}function fE(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Xx(t){return!!t&&"integerValue"in t}function B1(t){return!!t&&"arrayValue"in t}function hE(t){return!!t&&"nullValue"in t}function dE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Fd(t){return!!t&&"mapValue"in t}function LR(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[yS])===null||r===void 0?void 0:r.stringValue)===_S}function Vf(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return jo(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Vf(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Vf(t.arrayValue.values[r]);return e}return Object.assign({},t)}function MR(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===FR}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ya{constructor(e){this.value=e}static empty(){return new ya({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!Fd(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Vf(r)}setAll(e){let r=Un.emptyPath(),n={},a=[];e.forEach((l,u)=>{if(!r.isImmediateParentOf(u)){const f=this.getFieldsMap(r);this.applyChanges(f,n,a),n={},a=[],r=u.popLast()}l?n[u.lastSegment()]=Vf(l):a.push(u.lastSegment())});const s=this.getFieldsMap(r);this.applyChanges(s,n,a)}delete(e){const r=this.field(e.popLast());Fd(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return Ki(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let a=r.mapValue.fields[e.get(n)];Fd(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=a),r=a}return r.mapValue.fields}applyChanges(e,r,n){jo(r,(a,s)=>e[a]=s);for(const a of n)delete e[a]}clone(){return new ya(Vf(this.value))}}function wS(t){const e=[];return jo(t.fields,(r,n)=>{const a=new Un([r]);if(Fd(n)){const s=wS(n.mapValue).fields;if(s.length===0)e.push(a);else for(const l of s)e.push(a.child(l))}else e.push(a)}),new ja(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kn{constructor(e,r,n,a,s,l,u){this.key=e,this.documentType=r,this.version=n,this.readTime=a,this.createTime=s,this.data=l,this.documentState=u}static newInvalidDocument(e){return new Kn(e,0,St.min(),St.min(),St.min(),ya.empty(),0)}static newFoundDocument(e,r,n,a){return new Kn(e,1,r,St.min(),n,a,0)}static newNoDocument(e,r){return new Kn(e,2,r,St.min(),St.min(),ya.empty(),0)}static newUnknownDocument(e,r){return new Kn(e,3,r,St.min(),St.min(),ya.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(St.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ya.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ya.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=St.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Kn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Kn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xd{constructor(e,r){this.position=e,this.inclusive=r}}function mE(t,e,r){let n=0;for(let a=0;a<t.position.length;a++){const s=e[a],l=t.position[a];if(s.field.isKeyField()?n=dt.comparator(dt.fromName(l.referenceValue),r.key):n=fu(l,r.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function pE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Ki(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $d{constructor(e,r="asc"){this.field=e,this.dir=r}}function PR(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ES{}class cn extends ES{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new UR(e,r,n):r==="array-contains"?new zR(e,n):r==="in"?new HR(e,n):r==="not-in"?new GR(e,n):r==="array-contains-any"?new qR(e,n):new cn(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new BR(e,n):new VR(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(fu(r,this.value)):r!==null&&Io(this.value)===Io(r)&&this.matchesComparison(fu(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return yt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class yi extends ES{constructor(e,r){super(),this.filters=e,this.op=r,this.he=null}static create(e,r){return new yi(e,r)}matches(e){return TS(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function TS(t){return t.op==="and"}function bS(t){return jR(t)&&TS(t)}function jR(t){for(const e of t.filters)if(e instanceof yi)return!1;return!0}function $x(t){if(t instanceof cn)return t.field.canonicalString()+t.op.toString()+hu(t.value);if(bS(t))return t.filters.map(e=>$x(e)).join(",");{const e=t.filters.map(r=>$x(r)).join(",");return`${t.op}(${e})`}}function SS(t,e){return t instanceof cn?function(n,a){return a instanceof cn&&n.op===a.op&&n.field.isEqual(a.field)&&Ki(n.value,a.value)}(t,e):t instanceof yi?function(n,a){return a instanceof yi&&n.op===a.op&&n.filters.length===a.filters.length?n.filters.reduce((s,l,u)=>s&&SS(l,a.filters[u]),!0):!1}(t,e):void yt(19439)}function kS(t){return t instanceof cn?function(r){return`${r.field.canonicalString()} ${r.op} ${hu(r.value)}`}(t):t instanceof yi?function(r){return r.op.toString()+" {"+r.getFilters().map(kS).join(" ,")+"}"}(t):"Filter"}class UR extends cn{constructor(e,r,n){super(e,r,n),this.key=dt.fromName(n.referenceValue)}matches(e){const r=dt.comparator(e.key,this.key);return this.matchesComparison(r)}}class BR extends cn{constructor(e,r){super(e,"in",r),this.keys=AS("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class VR extends cn{constructor(e,r){super(e,"not-in",r),this.keys=AS("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function AS(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>dt.fromName(n.referenceValue))}class zR extends cn{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return B1(r)&&s0(r.arrayValue,this.value)}}class HR extends cn{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&s0(this.value.arrayValue,r)}}class GR extends cn{constructor(e,r){super(e,"not-in",r)}matches(e){if(s0(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!s0(this.value.arrayValue,r)}}class qR extends cn{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!B1(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>s0(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WR{constructor(e,r=null,n=[],a=[],s=null,l=null,u=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=a,this.limit=s,this.startAt=l,this.endAt=u,this.Pe=null}}function gE(t,e=null,r=[],n=[],a=null,s=null,l=null){return new WR(t,e,r,n,a,s,l)}function V1(t){const e=kt(t);if(e.Pe===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>$x(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),km(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>hu(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>hu(n)).join(",")),e.Pe=r}return e.Pe}function z1(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!PR(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!SS(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!pE(t.startAt,e.startAt)&&pE(t.endAt,e.endAt)}function Kx(t){return dt.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N0{constructor(e,r=null,n=[],a=[],s=null,l="F",u=null,f=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=a,this.limit=s,this.limitType=l,this.startAt=u,this.endAt=f,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function XR(t,e,r,n,a,s,l,u){return new N0(t,e,r,n,a,s,l,u)}function CS(t){return new N0(t)}function xE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function NS(t){return t.collectionGroup!==null}function zf(t){const e=kt(t);if(e.Te===null){e.Te=[];const r=new Set;for(const s of e.explicitOrderBy)e.Te.push(s),r.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(l){let u=new vn(Un.comparator);return l.filters.forEach(f=>{f.getFlattenedFilters().forEach(d=>{d.isInequality()&&(u=u.add(d.field))})}),u})(e).forEach(s=>{r.has(s.canonicalString())||s.isKeyField()||e.Te.push(new $d(s,n))}),r.has(Un.keyField().canonicalString())||e.Te.push(new $d(Un.keyField(),n))}return e.Te}function zi(t){const e=kt(t);return e.Ie||(e.Ie=$R(e,zf(t))),e.Ie}function $R(t,e){if(t.limitType==="F")return gE(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(a=>{const s=a.dir==="desc"?"asc":"desc";return new $d(a.field,s)});const r=t.endAt?new Xd(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Xd(t.startAt.position,t.startAt.inclusive):null;return gE(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function Yx(t,e){const r=t.filters.concat([e]);return new N0(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function Qx(t,e,r){return new N0(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function Cm(t,e){return z1(zi(t),zi(e))&&t.limitType===e.limitType}function IS(t){return`${V1(zi(t))}|lt:${t.limitType}`}function Gc(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(a=>kS(a)).join(", ")}]`),km(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(a=>function(l){return`${l.field.canonicalString()} (${l.dir})`}(a)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(a=>hu(a)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(a=>hu(a)).join(",")),`Target(${n})`}(zi(t))}; limitType=${t.limitType})`}function Nm(t,e){return e.isFoundDocument()&&function(n,a){const s=a.key.path;return n.collectionGroup!==null?a.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):dt.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(t,e)&&function(n,a){for(const s of zf(n))if(!s.field.isKeyField()&&a.data.field(s.field)===null)return!1;return!0}(t,e)&&function(n,a){for(const s of n.filters)if(!s.matches(a))return!1;return!0}(t,e)&&function(n,a){return!(n.startAt&&!function(l,u,f){const d=mE(l,u,f);return l.inclusive?d<=0:d<0}(n.startAt,zf(n),a)||n.endAt&&!function(l,u,f){const d=mE(l,u,f);return l.inclusive?d>=0:d>0}(n.endAt,zf(n),a))}(t,e)}function KR(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function RS(t){return(e,r)=>{let n=!1;for(const a of zf(t)){const s=YR(a,e,r);if(s!==0)return s;n=n||a.field.isKeyField()}return 0}}function YR(t,e,r){const n=t.field.isKeyField()?dt.comparator(e.key,r.key):function(s,l,u){const f=l.data.field(s),d=u.data.field(s);return f!==null&&d!==null?fu(f,d):yt(42886)}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return yt(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zl{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[a,s]of n)if(this.equalsFn(a,e))return s}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),a=this.inner[n];if(a===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let s=0;s<a.length;s++)if(this.equalsFn(a[s][0],e))return void(a[s]=[e,r]);a.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let a=0;a<n.length;a++)if(this.equalsFn(n[a][0],e))return n.length===1?delete this.inner[r]:n.splice(a,1),this.innerSize--,!0;return!1}forEach(e){jo(this.inner,(r,n)=>{for(const[a,s]of n)e(a,s)})}isEmpty(){return dS(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QR=new jr(dt.comparator);function Cs(){return QR}const DS=new jr(dt.comparator);function Ff(...t){let e=DS;for(const r of t)e=e.insert(r.key,r);return e}function OS(t){let e=DS;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function _l(){return Hf()}function FS(){return Hf()}function Hf(){return new zl(t=>t.toString(),(t,e)=>t.isEqual(e))}const JR=new jr(dt.comparator),ZR=new vn(dt.comparator);function qt(...t){let e=ZR;for(const r of t)e=e.add(r);return e}const eD=new vn(Lt);function tD(){return eD}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H1(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Gd(e)?"-0":e}}function LS(t){return{integerValue:""+t}}function rD(t,e){return NR(e)?LS(e):H1(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Im{constructor(){this._=void 0}}function nD(t,e,r){return t instanceof Kd?function(a,s){const l={fields:{[gS]:{stringValue:pS},[vS]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return s&&U1(s)&&(s=Am(s)),s&&(l.fields[xS]=s),{mapValue:l}}(r,e):t instanceof o0?PS(t,e):t instanceof l0?jS(t,e):function(a,s){const l=MS(a,s),u=vE(l)+vE(a.Ee);return Xx(l)&&Xx(a.Ee)?LS(u):H1(a.serializer,u)}(t,e)}function aD(t,e,r){return t instanceof o0?PS(t,e):t instanceof l0?jS(t,e):r}function MS(t,e){return t instanceof Yd?function(n){return Xx(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}class Kd extends Im{}class o0 extends Im{constructor(e){super(),this.elements=e}}function PS(t,e){const r=US(e);for(const n of t.elements)r.some(a=>Ki(a,n))||r.push(n);return{arrayValue:{values:r}}}class l0 extends Im{constructor(e){super(),this.elements=e}}function jS(t,e){let r=US(e);for(const n of t.elements)r=r.filter(a=>!Ki(a,n));return{arrayValue:{values:r}}}class Yd extends Im{constructor(e,r){super(),this.serializer=e,this.Ee=r}}function vE(t){return Qr(t.integerValue||t.doubleValue)}function US(t){return B1(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function iD(t,e){return t.field.isEqual(e.field)&&function(n,a){return n instanceof o0&&a instanceof o0||n instanceof l0&&a instanceof l0?uu(n.elements,a.elements,Ki):n instanceof Yd&&a instanceof Yd?Ki(n.Ee,a.Ee):n instanceof Kd&&a instanceof Kd}(t.transform,e.transform)}class sD{constructor(e,r){this.version=e,this.transformResults=r}}class _a{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new _a}static exists(e){return new _a(void 0,e)}static updateTime(e){return new _a(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ld(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Rm{}function BS(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Dm(t.key,_a.none()):new I0(t.key,t.data,_a.none());{const r=t.data,n=ya.empty();let a=new vn(Un.comparator);for(let s of e.fields)if(!a.has(s)){let l=r.field(s);l===null&&s.length>1&&(s=s.popLast(),l=r.field(s)),l===null?n.delete(s):n.set(s,l),a=a.add(s)}return new Uo(t.key,n,new ja(a.toArray()),_a.none())}}function oD(t,e,r){t instanceof I0?function(a,s,l){const u=a.value.clone(),f=_E(a.fieldTransforms,s,l.transformResults);u.setAll(f),s.convertToFoundDocument(l.version,u).setHasCommittedMutations()}(t,e,r):t instanceof Uo?function(a,s,l){if(!Ld(a.precondition,s))return void s.convertToUnknownDocument(l.version);const u=_E(a.fieldTransforms,s,l.transformResults),f=s.data;f.setAll(VS(a)),f.setAll(u),s.convertToFoundDocument(l.version,f).setHasCommittedMutations()}(t,e,r):function(a,s,l){s.convertToNoDocument(l.version).setHasCommittedMutations()}(0,e,r)}function Gf(t,e,r,n){return t instanceof I0?function(s,l,u,f){if(!Ld(s.precondition,l))return u;const d=s.value.clone(),m=wE(s.fieldTransforms,f,l);return d.setAll(m),l.convertToFoundDocument(l.version,d).setHasLocalMutations(),null}(t,e,r,n):t instanceof Uo?function(s,l,u,f){if(!Ld(s.precondition,l))return u;const d=wE(s.fieldTransforms,f,l),m=l.data;return m.setAll(VS(s)),m.setAll(d),l.convertToFoundDocument(l.version,m).setHasLocalMutations(),u===null?null:u.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(y=>y.field))}(t,e,r,n):function(s,l,u){return Ld(s.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):u}(t,e,r)}function lD(t,e){let r=null;for(const n of t.fieldTransforms){const a=e.data.field(n.field),s=MS(n.transform,a||null);s!=null&&(r===null&&(r=ya.empty()),r.set(n.field,s))}return r||null}function yE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,a){return n===void 0&&a===void 0||!(!n||!a)&&uu(n,a,(s,l)=>iD(s,l))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class I0 extends Rm{constructor(e,r,n,a=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class Uo extends Rm{constructor(e,r,n,a,s=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=a,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function VS(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function _E(t,e,r){const n=new Map;lr(t.length===r.length,32656,{Ae:r.length,Re:t.length});for(let a=0;a<r.length;a++){const s=t[a],l=s.transform,u=e.data.field(s.field);n.set(s.field,aD(l,u,r[a]))}return n}function wE(t,e,r){const n=new Map;for(const a of t){const s=a.transform,l=r.data.field(a.field);n.set(a.field,nD(s,l,e))}return n}class Dm extends Rm{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class cD extends Rm{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uD{constructor(e,r,n,a){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=a}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let a=0;a<this.mutations.length;a++){const s=this.mutations[a];s.key.isEqual(e.key)&&oD(s,e,n[a])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Gf(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Gf(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=FS();return this.mutations.forEach(a=>{const s=e.get(a.key),l=s.overlayedDocument;let u=this.applyToLocalView(l,s.mutatedFields);u=r.has(a.key)?null:u;const f=BS(l,u);f!==null&&n.set(a.key,f),l.isValidDocument()||l.convertToNoDocument(St.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),qt())}isEqual(e){return this.batchId===e.batchId&&uu(this.mutations,e.mutations,(r,n)=>yE(r,n))&&uu(this.baseMutations,e.baseMutations,(r,n)=>yE(r,n))}}class G1{constructor(e,r,n,a){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=a}static from(e,r,n){lr(e.mutations.length===n.length,58842,{Ve:e.mutations.length,me:n.length});let a=function(){return JR}();const s=e.mutations;for(let l=0;l<s.length;l++)a=a.insert(s[l].key,n[l].version);return new G1(e,r,n,a)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fD{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hD{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var sn,Qt;function dD(t){switch(t){case De.OK:return yt(64938);case De.CANCELLED:case De.UNKNOWN:case De.DEADLINE_EXCEEDED:case De.RESOURCE_EXHAUSTED:case De.INTERNAL:case De.UNAVAILABLE:case De.UNAUTHENTICATED:return!1;case De.INVALID_ARGUMENT:case De.NOT_FOUND:case De.ALREADY_EXISTS:case De.PERMISSION_DENIED:case De.FAILED_PRECONDITION:case De.ABORTED:case De.OUT_OF_RANGE:case De.UNIMPLEMENTED:case De.DATA_LOSS:return!0;default:return yt(15467,{code:t})}}function zS(t){if(t===void 0)return As("GRPC error has no .code"),De.UNKNOWN;switch(t){case sn.OK:return De.OK;case sn.CANCELLED:return De.CANCELLED;case sn.UNKNOWN:return De.UNKNOWN;case sn.DEADLINE_EXCEEDED:return De.DEADLINE_EXCEEDED;case sn.RESOURCE_EXHAUSTED:return De.RESOURCE_EXHAUSTED;case sn.INTERNAL:return De.INTERNAL;case sn.UNAVAILABLE:return De.UNAVAILABLE;case sn.UNAUTHENTICATED:return De.UNAUTHENTICATED;case sn.INVALID_ARGUMENT:return De.INVALID_ARGUMENT;case sn.NOT_FOUND:return De.NOT_FOUND;case sn.ALREADY_EXISTS:return De.ALREADY_EXISTS;case sn.PERMISSION_DENIED:return De.PERMISSION_DENIED;case sn.FAILED_PRECONDITION:return De.FAILED_PRECONDITION;case sn.ABORTED:return De.ABORTED;case sn.OUT_OF_RANGE:return De.OUT_OF_RANGE;case sn.UNIMPLEMENTED:return De.UNIMPLEMENTED;case sn.DATA_LOSS:return De.DATA_LOSS;default:return yt(39323,{code:t})}}(Qt=sn||(sn={}))[Qt.OK=0]="OK",Qt[Qt.CANCELLED=1]="CANCELLED",Qt[Qt.UNKNOWN=2]="UNKNOWN",Qt[Qt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Qt[Qt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Qt[Qt.NOT_FOUND=5]="NOT_FOUND",Qt[Qt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Qt[Qt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Qt[Qt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Qt[Qt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Qt[Qt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Qt[Qt.ABORTED=10]="ABORTED",Qt[Qt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Qt[Qt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Qt[Qt.INTERNAL=13]="INTERNAL",Qt[Qt.UNAVAILABLE=14]="UNAVAILABLE",Qt[Qt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mD=new _o([4294967295,4294967295],0);function EE(t){const e=cS().encode(t),r=new tS;return r.update(e),new Uint8Array(r.digest())}function TE(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),a=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new _o([r,n],0),new _o([a,s],0)]}class q1{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Lf(`Invalid padding: ${r}`);if(n<0)throw new Lf(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Lf(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Lf(`Invalid padding when bitmap length is 0: ${r}`);this.fe=8*e.length-r,this.ge=_o.fromNumber(this.fe)}pe(e,r,n){let a=e.add(r.multiply(_o.fromNumber(n)));return a.compare(mD)===1&&(a=new _o([a.getBits(0),a.getBits(1)],0)),a.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;const r=EE(e),[n,a]=TE(r);for(let s=0;s<this.hashCount;s++){const l=this.pe(n,a,s);if(!this.ye(l))return!1}return!0}static create(e,r,n){const a=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),l=new q1(s,a,r);return n.forEach(u=>l.insert(u)),l}insert(e){if(this.fe===0)return;const r=EE(e),[n,a]=TE(r);for(let s=0;s<this.hashCount;s++){const l=this.pe(n,a,s);this.we(l)}}we(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Lf extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Om{constructor(e,r,n,a,s){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=a,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const a=new Map;return a.set(e,R0.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new Om(St.min(),a,new jr(Lt),Cs(),qt())}}class R0{constructor(e,r,n,a,s){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=a,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new R0(n,r,qt(),qt(),qt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Md{constructor(e,r,n,a){this.Se=e,this.removedTargetIds=r,this.key=n,this.be=a}}class HS{constructor(e,r){this.targetId=e,this.De=r}}class GS{constructor(e,r,n=Vn.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=a}}class bE{constructor(){this.ve=0,this.Ce=SE(),this.Fe=Vn.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=qt(),r=qt(),n=qt();return this.Ce.forEach((a,s)=>{switch(s){case 0:e=e.add(a);break;case 2:r=r.add(a);break;case 1:n=n.add(a);break;default:yt(38017,{changeType:s})}}),new R0(this.Fe,this.Me,e,r,n)}ke(){this.xe=!1,this.Ce=SE()}qe(e,r){this.xe=!0,this.Ce=this.Ce.insert(e,r)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,lr(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class pD{constructor(e){this.We=e,this.Ge=new Map,this.ze=Cs(),this.je=pd(),this.Je=pd(),this.He=new jr(Lt)}Ye(e){for(const r of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(r,e.be):this.Xe(r,e.key,e.be);for(const r of e.removedTargetIds)this.Xe(r,e.key,e.be)}et(e){this.forEachTarget(e,r=>{const n=this.tt(r);switch(e.state){case 0:this.nt(r)&&n.Be(e.resumeToken);break;case 1:n.Ue(),n.Oe||n.ke(),n.Be(e.resumeToken);break;case 2:n.Ue(),n.Oe||this.removeTarget(r);break;case 3:this.nt(r)&&(n.Ke(),n.Be(e.resumeToken));break;case 4:this.nt(r)&&(this.rt(r),n.Be(e.resumeToken));break;default:yt(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Ge.forEach((n,a)=>{this.nt(a)&&r(a)})}it(e){const r=e.targetId,n=e.De.count,a=this.st(r);if(a){const s=a.target;if(Kx(s))if(n===0){const l=new dt(s.path);this.Xe(r,l,Kn.newNoDocument(l,St.min()))}else lr(n===1,20013,{expectedCount:n});else{const l=this.ot(r);if(l!==n){const u=this._t(e),f=u?this.ut(u,e,l):1;if(f!==0){this.rt(r);const d=f===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(r,d)}}}}}_t(e){const r=e.De.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:a=0},hashCount:s=0}=r;let l,u;try{l=No(n).toUint8Array()}catch(f){if(f instanceof mS)return So("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw f}try{u=new q1(l,a,s)}catch(f){return So(f instanceof Lf?"BloomFilter error: ":"Applying bloom filter failed: ",f),null}return u.fe===0?null:u}ut(e,r,n){return r.De.count===n-this.ht(e,r.targetId)?0:2}ht(e,r){const n=this.We.getRemoteKeysForTarget(r);let a=0;return n.forEach(s=>{const l=this.We.lt(),u=`projects/${l.projectId}/databases/${l.database}/documents/${s.path.canonicalString()}`;e.mightContain(u)||(this.Xe(r,s,null),a++)}),a}Pt(e){const r=new Map;this.Ge.forEach((s,l)=>{const u=this.st(l);if(u){if(s.current&&Kx(u.target)){const f=new dt(u.target.path);this.Tt(f).has(l)||this.It(l,f)||this.Xe(l,f,Kn.newNoDocument(f,e))}s.Ne&&(r.set(l,s.Le()),s.ke())}});let n=qt();this.Je.forEach((s,l)=>{let u=!0;l.forEachWhile(f=>{const d=this.st(f);return!d||d.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(n=n.add(s))}),this.ze.forEach((s,l)=>l.setReadTime(e));const a=new Om(e,r,this.He,this.ze,n);return this.ze=Cs(),this.je=pd(),this.Je=pd(),this.He=new jr(Lt),a}Ze(e,r){if(!this.nt(e))return;const n=this.It(e,r.key)?2:0;this.tt(e).qe(r.key,n),this.ze=this.ze.insert(r.key,r),this.je=this.je.insert(r.key,this.Tt(r.key).add(e)),this.Je=this.Je.insert(r.key,this.dt(r.key).add(e))}Xe(e,r,n){if(!this.nt(e))return;const a=this.tt(e);this.It(e,r)?a.qe(r,1):a.Qe(r),this.Je=this.Je.insert(r,this.dt(r).delete(e)),this.Je=this.Je.insert(r,this.dt(r).add(e)),n&&(this.ze=this.ze.insert(r,n))}removeTarget(e){this.Ge.delete(e)}ot(e){const r=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let r=this.Ge.get(e);return r||(r=new bE,this.Ge.set(e,r)),r}dt(e){let r=this.Je.get(e);return r||(r=new vn(Lt),this.Je=this.Je.insert(e,r)),r}Tt(e){let r=this.je.get(e);return r||(r=new vn(Lt),this.je=this.je.insert(e,r)),r}nt(e){const r=this.st(e)!==null;return r||at("WatchChangeAggregator","Detected inactive target",e),r}st(e){const r=this.Ge.get(e);return r&&r.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new bE),this.We.getRemoteKeysForTarget(e).forEach(r=>{this.Xe(e,r,null)})}It(e,r){return this.We.getRemoteKeysForTarget(e).has(r)}}function pd(){return new jr(dt.comparator)}function SE(){return new jr(dt.comparator)}const gD={asc:"ASCENDING",desc:"DESCENDING"},xD={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},vD={and:"AND",or:"OR"};class yD{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function Jx(t,e){return t.useProto3Json||km(e)?e:{value:e}}function Qd(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function qS(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function _D(t,e){return Qd(t,e.toTimestamp())}function Hi(t){return lr(!!t,49232),St.fromTimestamp(function(r){const n=Co(r);return new Cr(n.seconds,n.nanos)}(t))}function W1(t,e){return Zx(t,e).canonicalString()}function Zx(t,e){const r=function(a){return new br(["projects",a.projectId,"databases",a.database])}(t).child("documents");return e===void 0?r:r.child(e)}function WS(t){const e=br.fromString(t);return lr(QS(e),10190,{key:e.toString()}),e}function e1(t,e){return W1(t.databaseId,e.path)}function ox(t,e){const r=WS(e);if(r.get(1)!==t.databaseId.projectId)throw new rt(De.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new rt(De.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new dt($S(r))}function XS(t,e){return W1(t.databaseId,e)}function wD(t){const e=WS(t);return e.length===4?br.emptyPath():$S(e)}function t1(t){return new br(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function $S(t){return lr(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function kE(t,e,r){return{name:e1(t,e),fields:r.value.mapValue.fields}}function ED(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:yt(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],s=function(d,m){return d.useProto3Json?(lr(m===void 0||typeof m=="string",58123),Vn.fromBase64String(m||"")):(lr(m===void 0||m instanceof Buffer||m instanceof Uint8Array,16193),Vn.fromUint8Array(m||new Uint8Array))}(t,e.targetChange.resumeToken),l=e.targetChange.cause,u=l&&function(d){const m=d.code===void 0?De.UNKNOWN:zS(d.code);return new rt(m,d.message||"")}(l);r=new GS(n,a,s,u||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const a=ox(t,n.document.name),s=Hi(n.document.updateTime),l=n.document.createTime?Hi(n.document.createTime):St.min(),u=new ya({mapValue:{fields:n.document.fields}}),f=Kn.newFoundDocument(a,s,l,u),d=n.targetIds||[],m=n.removedTargetIds||[];r=new Md(d,m,f.key,f)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const a=ox(t,n.document),s=n.readTime?Hi(n.readTime):St.min(),l=Kn.newNoDocument(a,s),u=n.removedTargetIds||[];r=new Md([],u,l.key,l)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const a=ox(t,n.document),s=n.removedTargetIds||[];r=new Md([],s,a,null)}else{if(!("filter"in e))return yt(11601,{At:e});{e.filter;const n=e.filter;n.targetId;const{count:a=0,unchangedNames:s}=n,l=new hD(a,s),u=n.targetId;r=new HS(u,l)}}return r}function TD(t,e){let r;if(e instanceof I0)r={update:kE(t,e.key,e.value)};else if(e instanceof Dm)r={delete:e1(t,e.key)};else if(e instanceof Uo)r={update:kE(t,e.key,e.data),updateMask:DD(e.fieldMask)};else{if(!(e instanceof cD))return yt(16599,{Rt:e.type});r={verify:e1(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(s,l){const u=l.transform;if(u instanceof Kd)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof o0)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof l0)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof Yd)return{fieldPath:l.field.canonicalString(),increment:u.Ee};throw yt(20930,{transform:l.transform})}(0,n))),e.precondition.isNone||(r.currentDocument=function(a,s){return s.updateTime!==void 0?{updateTime:_D(a,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:yt(27497)}(t,e.precondition)),r}function bD(t,e){return t&&t.length>0?(lr(e!==void 0,14353),t.map(r=>function(a,s){let l=a.updateTime?Hi(a.updateTime):Hi(s);return l.isEqual(St.min())&&(l=Hi(s)),new sD(l,a.transformResults||[])}(r,e))):[]}function SD(t,e){return{documents:[XS(t,e.path)]}}function kD(t,e){const r={structuredQuery:{}},n=e.path;let a;e.collectionGroup!==null?(a=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=XS(t,a);const s=function(d){if(d.length!==0)return YS(yi.create(d,"and"))}(e.filters);s&&(r.structuredQuery.where=s);const l=function(d){if(d.length!==0)return d.map(m=>function(_){return{field:qc(_.field),direction:ND(_.dir)}}(m))}(e.orderBy);l&&(r.structuredQuery.orderBy=l);const u=Jx(t,e.limit);return u!==null&&(r.structuredQuery.limit=u),e.startAt&&(r.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{Vt:r,parent:a}}function AD(t){let e=wD(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let a=null;if(n>0){lr(n===1,65062);const m=r.from[0];m.allDescendants?a=m.collectionId:e=e.child(m.collectionId)}let s=[];r.where&&(s=function(y){const _=KS(y);return _ instanceof yi&&bS(_)?_.getFilters():[_]}(r.where));let l=[];r.orderBy&&(l=function(y){return y.map(_=>function(b){return new $d(Wc(b.field),function(S){switch(S){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(b.direction))}(_))}(r.orderBy));let u=null;r.limit&&(u=function(y){let _;return _=typeof y=="object"?y.value:y,km(_)?null:_}(r.limit));let f=null;r.startAt&&(f=function(y){const _=!!y.before,E=y.values||[];return new Xd(E,_)}(r.startAt));let d=null;return r.endAt&&(d=function(y){const _=!y.before,E=y.values||[];return new Xd(E,_)}(r.endAt)),XR(e,a,l,s,u,"F",f,d)}function CD(t,e){const r=function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return yt(28987,{purpose:a})}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function KS(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Wc(r.unaryFilter.field);return cn.create(n,"==",{doubleValue:NaN});case"IS_NULL":const a=Wc(r.unaryFilter.field);return cn.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Wc(r.unaryFilter.field);return cn.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=Wc(r.unaryFilter.field);return cn.create(l,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return yt(61313);default:return yt(60726)}}(t):t.fieldFilter!==void 0?function(r){return cn.create(Wc(r.fieldFilter.field),function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return yt(58110);default:return yt(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return yi.create(r.compositeFilter.filters.map(n=>KS(n)),function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return yt(1026)}}(r.compositeFilter.op))}(t):yt(30097,{filter:t})}function ND(t){return gD[t]}function ID(t){return xD[t]}function RD(t){return vD[t]}function qc(t){return{fieldPath:t.canonicalString()}}function Wc(t){return Un.fromServerFormat(t.fieldPath)}function YS(t){return t instanceof cn?function(r){if(r.op==="=="){if(dE(r.value))return{unaryFilter:{field:qc(r.field),op:"IS_NAN"}};if(hE(r.value))return{unaryFilter:{field:qc(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(dE(r.value))return{unaryFilter:{field:qc(r.field),op:"IS_NOT_NAN"}};if(hE(r.value))return{unaryFilter:{field:qc(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:qc(r.field),op:ID(r.op),value:r.value}}}(t):t instanceof yi?function(r){const n=r.getFilters().map(a=>YS(a));return n.length===1?n[0]:{compositeFilter:{op:RD(r.op),filters:n}}}(t):yt(54877,{filter:t})}function DD(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function QS(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mo{constructor(e,r,n,a,s=St.min(),l=St.min(),u=Vn.EMPTY_BYTE_STRING,f=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=a,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=u,this.expectedCount=f}withSequenceNumber(e){return new mo(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new mo(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new mo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new mo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OD{constructor(e){this.gt=e}}function FD(t){const e=AD({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Qx(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LD{constructor(){this.Dn=new MD}addToCollectionParentIndex(e,r){return this.Dn.add(r),Le.resolve()}getCollectionParents(e,r){return Le.resolve(this.Dn.getEntries(r))}addFieldIndex(e,r){return Le.resolve()}deleteFieldIndex(e,r){return Le.resolve()}deleteAllFieldIndexes(e){return Le.resolve()}createTargetIndexes(e,r){return Le.resolve()}getDocumentsMatchingTarget(e,r){return Le.resolve(null)}getIndexType(e,r){return Le.resolve(0)}getFieldIndexes(e,r){return Le.resolve([])}getNextCollectionGroupToUpdate(e){return Le.resolve(null)}getMinOffset(e,r){return Le.resolve(Ao.min())}getMinOffsetFromCollectionGroup(e,r){return Le.resolve(Ao.min())}updateCollectionGroup(e,r,n){return Le.resolve()}updateIndexEntries(e,r){return Le.resolve()}}class MD{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),a=this.index[r]||new vn(br.comparator),s=!a.has(n);return this.index[r]=a.add(n),s}has(e){const r=e.lastSegment(),n=e.popLast(),a=this.index[r];return a&&a.has(n)}getEntries(e){return(this.index[e]||new vn(br.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},JS=41943040;class va{static withCacheSize(e){return new va(e,va.DEFAULT_COLLECTION_PERCENTILE,va.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */va.DEFAULT_COLLECTION_PERCENTILE=10,va.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,va.DEFAULT=new va(JS,va.DEFAULT_COLLECTION_PERCENTILE,va.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),va.DISABLED=new va(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class du{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new du(0)}static ur(){return new du(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CE="LruGarbageCollector",PD=1048576;function NE([t,e],[r,n]){const a=Lt(t,r);return a===0?Lt(e,n):a}class jD{constructor(e){this.Tr=e,this.buffer=new vn(NE),this.Ir=0}dr(){return++this.Ir}Er(e){const r=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();NE(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class UD{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){at(CE,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){_u(r)?at(CE,"Ignoring IndexedDB error during garbage collection: ",r):await yu(r)}await this.Rr(3e5)})}}class BD{constructor(e,r){this.Vr=e,this.params=r}calculateTargetCount(e,r){return this.Vr.mr(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return Le.resolve(Sm.ue);const n=new jD(r);return this.Vr.forEachTarget(e,a=>n.Er(a.sequenceNumber)).next(()=>this.Vr.gr(e,a=>n.Er(a))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.Vr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.Vr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(at("LruGarbageCollector","Garbage collection skipped; disabled"),Le.resolve(AE)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(at("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),AE):this.pr(e,r))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,r){let n,a,s,l,u,f,d;const m=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(y=>(y>this.params.maximumSequenceNumbersToCollect?(at("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${y}`),a=this.params.maximumSequenceNumbersToCollect):a=y,l=Date.now(),this.nthSequenceNumber(e,a))).next(y=>(n=y,u=Date.now(),this.removeTargets(e,n,r))).next(y=>(s=y,f=Date.now(),this.removeOrphanedDocuments(e,n))).next(y=>(d=Date.now(),Hc()<=Gt.DEBUG&&at("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${l-m}ms
	Determined least recently used ${a} in `+(u-l)+`ms
	Removed ${s} targets in `+(f-u)+`ms
	Removed ${y} documents in `+(d-f)+`ms
Total Duration: ${d-m}ms`),Le.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:s,documentsRemoved:y})))}}function VD(t,e){return new BD(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zD{constructor(){this.changes=new zl(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Kn.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Le.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HD{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GD{constructor(e,r,n,a){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=a}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(a=>(n=a,this.remoteDocumentCache.getEntry(e,r))).next(a=>(n!==null&&Gf(n.mutation,a,ja.empty(),Cr.now()),a))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,qt()).next(()=>n))}getLocalViewOfDocuments(e,r,n=qt()){const a=_l();return this.populateOverlays(e,a,r).next(()=>this.computeViews(e,r,a,n).next(s=>{let l=Ff();return s.forEach((u,f)=>{l=l.insert(u,f.overlayedDocument)}),l}))}getOverlayedDocuments(e,r){const n=_l();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,qt()))}populateOverlays(e,r,n){const a=[];return n.forEach(s=>{r.has(s)||a.push(s)}),this.documentOverlayCache.getOverlays(e,a).next(s=>{s.forEach((l,u)=>{r.set(l,u)})})}computeViews(e,r,n,a){let s=Cs();const l=Hf(),u=function(){return Hf()}();return r.forEach((f,d)=>{const m=n.get(d.key);a.has(d.key)&&(m===void 0||m.mutation instanceof Uo)?s=s.insert(d.key,d):m!==void 0?(l.set(d.key,m.mutation.getFieldMask()),Gf(m.mutation,d,m.mutation.getFieldMask(),Cr.now())):l.set(d.key,ja.empty())}),this.recalculateAndSaveOverlays(e,s).next(f=>(f.forEach((d,m)=>l.set(d,m)),r.forEach((d,m)=>{var y;return u.set(d,new HD(m,(y=l.get(d))!==null&&y!==void 0?y:null))}),u))}recalculateAndSaveOverlays(e,r){const n=Hf();let a=new jr((l,u)=>l-u),s=qt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(l=>{for(const u of l)u.keys().forEach(f=>{const d=r.get(f);if(d===null)return;let m=n.get(f)||ja.empty();m=u.applyToLocalView(d,m),n.set(f,m);const y=(a.get(u.batchId)||qt()).add(f);a=a.insert(u.batchId,y)})}).next(()=>{const l=[],u=a.getReverseIterator();for(;u.hasNext();){const f=u.getNext(),d=f.key,m=f.value,y=FS();m.forEach(_=>{if(!s.has(_)){const E=BS(r.get(_),n.get(_));E!==null&&y.set(_,E),s=s.add(_)}}),l.push(this.documentOverlayCache.saveOverlays(e,d,y))}return Le.waitFor(l)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,a){return function(l){return dt.isDocumentKey(l.path)&&l.collectionGroup===null&&l.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):NS(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,a):this.getDocumentsMatchingCollectionQuery(e,r,n,a)}getNextDocuments(e,r,n,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,a).next(s=>{const l=a-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,a-s.size):Le.resolve(_l());let u=n0,f=s;return l.next(d=>Le.forEach(d,(m,y)=>(u<y.largestBatchId&&(u=y.largestBatchId),s.get(m)?Le.resolve():this.remoteDocumentCache.getEntry(e,m).next(_=>{f=f.insert(m,_)}))).next(()=>this.populateOverlays(e,d,s)).next(()=>this.computeViews(e,f,d,qt())).next(m=>({batchId:u,changes:OS(m)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new dt(r)).next(n=>{let a=Ff();return n.isFoundDocument()&&(a=a.insert(n.key,n)),a})}getDocumentsMatchingCollectionGroupQuery(e,r,n,a){const s=r.collectionGroup;let l=Ff();return this.indexManager.getCollectionParents(e,s).next(u=>Le.forEach(u,f=>{const d=function(y,_){return new N0(_,null,y.explicitOrderBy.slice(),y.filters.slice(),y.limit,y.limitType,y.startAt,y.endAt)}(r,f.child(s));return this.getDocumentsMatchingCollectionQuery(e,d,n,a).next(m=>{m.forEach((y,_)=>{l=l.insert(y,_)})})}).next(()=>l))}getDocumentsMatchingCollectionQuery(e,r,n,a){let s;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(l=>(s=l,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,s,a))).next(l=>{s.forEach((f,d)=>{const m=d.getKey();l.get(m)===null&&(l=l.insert(m,Kn.newInvalidDocument(m)))});let u=Ff();return l.forEach((f,d)=>{const m=s.get(f);m!==void 0&&Gf(m.mutation,d,ja.empty(),Cr.now()),Nm(r,d)&&(u=u.insert(f,d))}),u})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qD{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,r){return Le.resolve(this.Br.get(r))}saveBundleMetadata(e,r){return this.Br.set(r.id,function(a){return{id:a.id,version:a.version,createTime:Hi(a.createTime)}}(r)),Le.resolve()}getNamedQuery(e,r){return Le.resolve(this.Lr.get(r))}saveNamedQuery(e,r){return this.Lr.set(r.name,function(a){return{name:a.name,query:FD(a.bundledQuery),readTime:Hi(a.readTime)}}(r)),Le.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WD{constructor(){this.overlays=new jr(dt.comparator),this.kr=new Map}getOverlay(e,r){return Le.resolve(this.overlays.get(r))}getOverlays(e,r){const n=_l();return Le.forEach(r,a=>this.getOverlay(e,a).next(s=>{s!==null&&n.set(a,s)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((a,s)=>{this.wt(e,r,s)}),Le.resolve()}removeOverlaysForBatchId(e,r,n){const a=this.kr.get(n);return a!==void 0&&(a.forEach(s=>this.overlays=this.overlays.remove(s)),this.kr.delete(n)),Le.resolve()}getOverlaysForCollection(e,r,n){const a=_l(),s=r.length+1,l=new dt(r.child("")),u=this.overlays.getIteratorFrom(l);for(;u.hasNext();){const f=u.getNext().value,d=f.getKey();if(!r.isPrefixOf(d.path))break;d.path.length===s&&f.largestBatchId>n&&a.set(f.getKey(),f)}return Le.resolve(a)}getOverlaysForCollectionGroup(e,r,n,a){let s=new jr((d,m)=>d-m);const l=this.overlays.getIterator();for(;l.hasNext();){const d=l.getNext().value;if(d.getKey().getCollectionGroup()===r&&d.largestBatchId>n){let m=s.get(d.largestBatchId);m===null&&(m=_l(),s=s.insert(d.largestBatchId,m)),m.set(d.getKey(),d)}}const u=_l(),f=s.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach((d,m)=>u.set(d,m)),!(u.size()>=a)););return Le.resolve(u)}wt(e,r,n){const a=this.overlays.get(n.key);if(a!==null){const l=this.kr.get(a.largestBatchId).delete(n.key);this.kr.set(a.largestBatchId,l)}this.overlays=this.overlays.insert(n.key,new fD(r,n));let s=this.kr.get(r);s===void 0&&(s=qt(),this.kr.set(r,s)),this.kr.set(r,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XD{constructor(){this.sessionToken=Vn.EMPTY_BYTE_STRING}getSessionToken(e){return Le.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Le.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X1{constructor(){this.qr=new vn(An.Qr),this.$r=new vn(An.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,r){const n=new An(e,r);this.qr=this.qr.add(n),this.$r=this.$r.add(n)}Kr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Wr(new An(e,r))}Gr(e,r){e.forEach(n=>this.removeReference(n,r))}zr(e){const r=new dt(new br([])),n=new An(r,e),a=new An(r,e+1),s=[];return this.$r.forEachInRange([n,a],l=>{this.Wr(l),s.push(l.key)}),s}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const r=new dt(new br([])),n=new An(r,e),a=new An(r,e+1);let s=qt();return this.$r.forEachInRange([n,a],l=>{s=s.add(l.key)}),s}containsKey(e){const r=new An(e,0),n=this.qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class An{constructor(e,r){this.key=e,this.Hr=r}static Qr(e,r){return dt.comparator(e.key,r.key)||Lt(e.Hr,r.Hr)}static Ur(e,r){return Lt(e.Hr,r.Hr)||dt.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $D{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.er=1,this.Yr=new vn(An.Qr)}checkEmpty(e){return Le.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,a){const s=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new uD(s,r,n,a);this.mutationQueue.push(l);for(const u of a)this.Yr=this.Yr.add(new An(u.key,s)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return Le.resolve(l)}lookupMutationBatch(e,r){return Le.resolve(this.Zr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,a=this.Xr(n),s=a<0?0:a;return Le.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Le.resolve(this.mutationQueue.length===0?j1:this.er-1)}getAllMutationBatches(e){return Le.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new An(r,0),a=new An(r,Number.POSITIVE_INFINITY),s=[];return this.Yr.forEachInRange([n,a],l=>{const u=this.Zr(l.Hr);s.push(u)}),Le.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new vn(Lt);return r.forEach(a=>{const s=new An(a,0),l=new An(a,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([s,l],u=>{n=n.add(u.Hr)})}),Le.resolve(this.ei(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,a=n.length+1;let s=n;dt.isDocumentKey(s)||(s=s.child(""));const l=new An(new dt(s),0);let u=new vn(Lt);return this.Yr.forEachWhile(f=>{const d=f.key.path;return!!n.isPrefixOf(d)&&(d.length===a&&(u=u.add(f.Hr)),!0)},l),Le.resolve(this.ei(u))}ei(e){const r=[];return e.forEach(n=>{const a=this.Zr(n);a!==null&&r.push(a)}),r}removeMutationBatch(e,r){lr(this.ti(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Yr;return Le.forEach(r.mutations,a=>{const s=new An(a.key,r.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)}).next(()=>{this.Yr=n})}rr(e){}containsKey(e,r){const n=new An(r,0),a=this.Yr.firstAfterOrEqual(n);return Le.resolve(r.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,Le.resolve()}ti(e,r){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const r=this.Xr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KD{constructor(e){this.ni=e,this.docs=function(){return new jr(dt.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,a=this.docs.get(n),s=a?a.size:0,l=this.ni(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:l}),this.size+=l-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Le.resolve(n?n.document.mutableCopy():Kn.newInvalidDocument(r))}getEntries(e,r){let n=Cs();return r.forEach(a=>{const s=this.docs.get(a);n=n.insert(a,s?s.document.mutableCopy():Kn.newInvalidDocument(a))}),Le.resolve(n)}getDocumentsMatchingQuery(e,r,n,a){let s=Cs();const l=r.path,u=new dt(l.child("__id-9223372036854775808__")),f=this.docs.getIteratorFrom(u);for(;f.hasNext();){const{key:d,value:{document:m}}=f.getNext();if(!l.isPrefixOf(d.path))break;d.path.length>l.length+1||SR(bR(m),n)<=0||(a.has(m.key)||Nm(r,m))&&(s=s.insert(m.key,m.mutableCopy()))}return Le.resolve(s)}getAllFromCollectionGroup(e,r,n,a){yt(9500)}ri(e,r){return Le.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new YD(this)}getSize(e){return Le.resolve(this.size)}}class YD extends zD{constructor(e){super(),this.Or=e}applyChanges(e){const r=[];return this.changes.forEach((n,a)=>{a.isValidDocument()?r.push(this.Or.addEntry(e,a)):this.Or.removeEntry(n)}),Le.waitFor(r)}getFromCache(e,r){return this.Or.getEntry(e,r)}getAllFromCache(e,r){return this.Or.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QD{constructor(e){this.persistence=e,this.ii=new zl(r=>V1(r),z1),this.lastRemoteSnapshotVersion=St.min(),this.highestTargetId=0,this.si=0,this.oi=new X1,this.targetCount=0,this._i=du.ar()}forEachTarget(e,r){return this.ii.forEach((n,a)=>r(a)),Le.resolve()}getLastRemoteSnapshotVersion(e){return Le.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Le.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),Le.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.si&&(this.si=r),Le.resolve()}hr(e){this.ii.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this._i=new du(r),this.highestTargetId=r),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,r){return this.hr(r),this.targetCount+=1,Le.resolve()}updateTargetData(e,r){return this.hr(r),Le.resolve()}removeTargetData(e,r){return this.ii.delete(r.target),this.oi.zr(r.targetId),this.targetCount-=1,Le.resolve()}removeTargets(e,r,n){let a=0;const s=[];return this.ii.forEach((l,u)=>{u.sequenceNumber<=r&&n.get(u.targetId)===null&&(this.ii.delete(l),s.push(this.removeMatchingKeysForTargetId(e,u.targetId)),a++)}),Le.waitFor(s).next(()=>a)}getTargetCount(e){return Le.resolve(this.targetCount)}getTargetData(e,r){const n=this.ii.get(r)||null;return Le.resolve(n)}addMatchingKeys(e,r,n){return this.oi.Kr(r,n),Le.resolve()}removeMatchingKeys(e,r,n){this.oi.Gr(r,n);const a=this.persistence.referenceDelegate,s=[];return a&&r.forEach(l=>{s.push(a.markPotentiallyOrphaned(e,l))}),Le.waitFor(s)}removeMatchingKeysForTargetId(e,r){return this.oi.zr(r),Le.resolve()}getMatchingKeysForTargetId(e,r){const n=this.oi.Jr(r);return Le.resolve(n)}containsKey(e,r){return Le.resolve(this.oi.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZS{constructor(e,r){this.ai={},this.overlays={},this.ui=new Sm(0),this.ci=!1,this.ci=!0,this.li=new XD,this.referenceDelegate=e(this),this.hi=new QD(this),this.indexManager=new LD,this.remoteDocumentCache=function(a){return new KD(a)}(n=>this.referenceDelegate.Pi(n)),this.serializer=new OD(r),this.Ti=new qD(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new WD,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ai[e.toKey()];return n||(n=new $D(r,this.referenceDelegate),this.ai[e.toKey()]=n),n}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,r,n){at("MemoryPersistence","Starting transaction:",e);const a=new JD(this.ui.next());return this.referenceDelegate.Ii(),n(a).next(s=>this.referenceDelegate.di(a).next(()=>s)).toPromise().then(s=>(a.raiseOnCommittedEvent(),s))}Ei(e,r){return Le.or(Object.values(this.ai).map(n=>()=>n.containsKey(e,r)))}}class JD extends AR{constructor(e){super(),this.currentSequenceNumber=e}}class $1{constructor(e){this.persistence=e,this.Ai=new X1,this.Ri=null}static Vi(e){return new $1(e)}get mi(){if(this.Ri)return this.Ri;throw yt(60996)}addReference(e,r,n){return this.Ai.addReference(n,r),this.mi.delete(n.toString()),Le.resolve()}removeReference(e,r,n){return this.Ai.removeReference(n,r),this.mi.add(n.toString()),Le.resolve()}markPotentiallyOrphaned(e,r){return this.mi.add(r.toString()),Le.resolve()}removeTarget(e,r){this.Ai.zr(r.targetId).forEach(a=>this.mi.add(a.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(a=>{a.forEach(s=>this.mi.add(s.toString()))}).next(()=>n.removeTargetData(e,r))}Ii(){this.Ri=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Le.forEach(this.mi,n=>{const a=dt.fromPath(n);return this.fi(e,a).next(s=>{s||r.removeEntry(a,St.min())})}).next(()=>(this.Ri=null,r.apply(e)))}updateLimboDocument(e,r){return this.fi(e,r).next(n=>{n?this.mi.delete(r.toString()):this.mi.add(r.toString())})}Pi(e){return 0}fi(e,r){return Le.or([()=>Le.resolve(this.Ai.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ei(e,r)])}}class Jd{constructor(e,r){this.persistence=e,this.gi=new zl(n=>IR(n.path),(n,a)=>n.isEqual(a)),this.garbageCollector=VD(this,r)}static Vi(e,r){return new Jd(e,r)}Ii(){}di(e){return Le.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}mr(e){const r=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(a=>n+a))}yr(e){let r=0;return this.gr(e,n=>{r++}).next(()=>r)}gr(e,r){return Le.forEach(this.gi,(n,a)=>this.Sr(e,n,a).next(s=>s?Le.resolve():r(a)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const a=this.persistence.getRemoteDocumentCache(),s=a.newChangeBuffer();return a.ri(e,l=>this.Sr(e,l,r).next(u=>{u||(n++,s.removeEntry(l,St.min()))})).next(()=>s.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.gi.set(r,e.currentSequenceNumber),Le.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.gi.set(n,e.currentSequenceNumber),Le.resolve()}removeReference(e,r,n){return this.gi.set(n,e.currentSequenceNumber),Le.resolve()}updateLimboDocument(e,r){return this.gi.set(r,e.currentSequenceNumber),Le.resolve()}Pi(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=Od(e.data.value)),r}Sr(e,r,n){return Le.or([()=>this.persistence.Ei(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const a=this.gi.get(r);return Le.resolve(a!==void 0&&a>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K1{constructor(e,r,n,a){this.targetId=e,this.fromCache=r,this.Is=n,this.ds=a}static Es(e,r){let n=qt(),a=qt();for(const s of r.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:a=a.add(s.doc.key)}return new K1(e,r.fromCache,n,a)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZD{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e6{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=function(){return X3()?8:CR(Zn())>0?6:4}()}initialize(e,r){this.gs=e,this.indexManager=r,this.As=!0}getDocumentsMatchingQuery(e,r,n,a){const s={result:null};return this.ps(e,r).next(l=>{s.result=l}).next(()=>{if(!s.result)return this.ys(e,r,a,n).next(l=>{s.result=l})}).next(()=>{if(s.result)return;const l=new ZD;return this.ws(e,r,l).next(u=>{if(s.result=u,this.Rs)return this.Ss(e,r,l,u.size)})}).next(()=>s.result)}Ss(e,r,n,a){return n.documentReadCount<this.Vs?(Hc()<=Gt.DEBUG&&at("QueryEngine","SDK will not create cache indexes for query:",Gc(r),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),Le.resolve()):(Hc()<=Gt.DEBUG&&at("QueryEngine","Query:",Gc(r),"scans",n.documentReadCount,"local documents and returns",a,"documents as results."),n.documentReadCount>this.fs*a?(Hc()<=Gt.DEBUG&&at("QueryEngine","The SDK decides to create cache indexes for query:",Gc(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,zi(r))):Le.resolve())}ps(e,r){if(xE(r))return Le.resolve(null);let n=zi(r);return this.indexManager.getIndexType(e,n).next(a=>a===0?null:(r.limit!==null&&a===1&&(r=Qx(r,null,"F"),n=zi(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const l=qt(...s);return this.gs.getDocuments(e,l).next(u=>this.indexManager.getMinOffset(e,n).next(f=>{const d=this.bs(r,u);return this.Ds(r,d,l,f.readTime)?this.ps(e,Qx(r,null,"F")):this.vs(e,d,r,f)}))})))}ys(e,r,n,a){return xE(r)||a.isEqual(St.min())?Le.resolve(null):this.gs.getDocuments(e,n).next(s=>{const l=this.bs(r,s);return this.Ds(r,l,n,a)?Le.resolve(null):(Hc()<=Gt.DEBUG&&at("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),Gc(r)),this.vs(e,l,r,TR(a,n0)).next(u=>u))})}bs(e,r){let n=new vn(RS(e));return r.forEach((a,s)=>{Nm(e,s)&&(n=n.add(s))}),n}Ds(e,r,n,a){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const s=e.limitType==="F"?r.last():r.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(a)>0)}ws(e,r,n){return Hc()<=Gt.DEBUG&&at("QueryEngine","Using full collection scan to execute query:",Gc(r)),this.gs.getDocumentsMatchingQuery(e,r,Ao.min(),n)}vs(e,r,n,a){return this.gs.getDocumentsMatchingQuery(e,n,a).next(s=>(r.forEach(l=>{s=s.insert(l.key,l)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y1="LocalStore",t6=3e8;class r6{constructor(e,r,n,a){this.persistence=e,this.Cs=r,this.serializer=a,this.Fs=new jr(Lt),this.Ms=new zl(s=>V1(s),z1),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(n)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new GD(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.Fs))}}function n6(t,e,r,n){return new r6(t,e,r,n)}async function ek(t,e){const r=kt(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let a;return r.mutationQueue.getAllMutationBatches(n).next(s=>(a=s,r.Ns(e),r.mutationQueue.getAllMutationBatches(n))).next(s=>{const l=[],u=[];let f=qt();for(const d of a){l.push(d.batchId);for(const m of d.mutations)f=f.add(m.key)}for(const d of s){u.push(d.batchId);for(const m of d.mutations)f=f.add(m.key)}return r.localDocuments.getDocuments(n,f).next(d=>({Bs:d,removedBatchIds:l,addedBatchIds:u}))})})}function a6(t,e){const r=kt(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const a=e.batch.keys(),s=r.Os.newChangeBuffer({trackRemovals:!0});return function(u,f,d,m){const y=d.batch,_=y.keys();let E=Le.resolve();return _.forEach(b=>{E=E.next(()=>m.getEntry(f,b)).next(w=>{const S=d.docVersions.get(b);lr(S!==null,48541),w.version.compareTo(S)<0&&(y.applyToRemoteDocument(w,d),w.isValidDocument()&&(w.setReadTime(d.commitVersion),m.addEntry(w)))})}),E.next(()=>u.mutationQueue.removeMutationBatch(f,y))}(r,n,e,s).next(()=>s.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,a,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(u){let f=qt();for(let d=0;d<u.mutationResults.length;++d)u.mutationResults[d].transformResults.length>0&&(f=f.add(u.batch.mutations[d].key));return f}(e))).next(()=>r.localDocuments.getDocuments(n,a))})}function tk(t){const e=kt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.hi.getLastRemoteSnapshotVersion(r))}function i6(t,e){const r=kt(t),n=e.snapshotVersion;let a=r.Fs;return r.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const l=r.Os.newChangeBuffer({trackRemovals:!0});a=r.Fs;const u=[];e.targetChanges.forEach((m,y)=>{const _=a.get(y);if(!_)return;u.push(r.hi.removeMatchingKeys(s,m.removedDocuments,y).next(()=>r.hi.addMatchingKeys(s,m.addedDocuments,y)));let E=_.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(y)!==null?E=E.withResumeToken(Vn.EMPTY_BYTE_STRING,St.min()).withLastLimboFreeSnapshotVersion(St.min()):m.resumeToken.approximateByteSize()>0&&(E=E.withResumeToken(m.resumeToken,n)),a=a.insert(y,E),function(w,S,M){return w.resumeToken.approximateByteSize()===0||S.snapshotVersion.toMicroseconds()-w.snapshotVersion.toMicroseconds()>=t6?!0:M.addedDocuments.size+M.modifiedDocuments.size+M.removedDocuments.size>0}(_,E,m)&&u.push(r.hi.updateTargetData(s,E))});let f=Cs(),d=qt();if(e.documentUpdates.forEach(m=>{e.resolvedLimboDocuments.has(m)&&u.push(r.persistence.referenceDelegate.updateLimboDocument(s,m))}),u.push(s6(s,l,e.documentUpdates).next(m=>{f=m.Ls,d=m.ks})),!n.isEqual(St.min())){const m=r.hi.getLastRemoteSnapshotVersion(s).next(y=>r.hi.setTargetsMetadata(s,s.currentSequenceNumber,n));u.push(m)}return Le.waitFor(u).next(()=>l.apply(s)).next(()=>r.localDocuments.getLocalViewOfDocuments(s,f,d)).next(()=>f)}).then(s=>(r.Fs=a,s))}function s6(t,e,r){let n=qt(),a=qt();return r.forEach(s=>n=n.add(s)),e.getEntries(t,n).next(s=>{let l=Cs();return r.forEach((u,f)=>{const d=s.get(u);f.isFoundDocument()!==d.isFoundDocument()&&(a=a.add(u)),f.isNoDocument()&&f.version.isEqual(St.min())?(e.removeEntry(u,f.readTime),l=l.insert(u,f)):!d.isValidDocument()||f.version.compareTo(d.version)>0||f.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(f),l=l.insert(u,f)):at(Y1,"Ignoring outdated watch update for ",u,". Current version:",d.version," Watch version:",f.version)}),{Ls:l,ks:a}})}function o6(t,e){const r=kt(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=j1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function l6(t,e){const r=kt(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let a;return r.hi.getTargetData(n,e).next(s=>s?(a=s,Le.resolve(a)):r.hi.allocateTargetId(n).next(l=>(a=new mo(e,l,"TargetPurposeListen",n.currentSequenceNumber),r.hi.addTargetData(n,a).next(()=>a))))}).then(n=>{const a=r.Fs.get(n.targetId);return(a===null||n.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(r.Fs=r.Fs.insert(n.targetId,n),r.Ms.set(e,n.targetId)),n})}async function r1(t,e,r){const n=kt(t),a=n.Fs.get(e),s=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",s,l=>n.persistence.referenceDelegate.removeTarget(l,a))}catch(l){if(!_u(l))throw l;at(Y1,`Failed to update sequence numbers for target ${e}: ${l}`)}n.Fs=n.Fs.remove(e),n.Ms.delete(a.target)}function IE(t,e,r){const n=kt(t);let a=St.min(),s=qt();return n.persistence.runTransaction("Execute query","readwrite",l=>function(f,d,m){const y=kt(f),_=y.Ms.get(m);return _!==void 0?Le.resolve(y.Fs.get(_)):y.hi.getTargetData(d,m)}(n,l,zi(e)).next(u=>{if(u)return a=u.lastLimboFreeSnapshotVersion,n.hi.getMatchingKeysForTargetId(l,u.targetId).next(f=>{s=f})}).next(()=>n.Cs.getDocumentsMatchingQuery(l,e,r?a:St.min(),r?s:qt())).next(u=>(c6(n,KR(e),u),{documents:u,qs:s})))}function c6(t,e,r){let n=t.xs.get(e)||St.min();r.forEach((a,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),t.xs.set(e,n)}class RE{constructor(){this.activeTargetIds=tD()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class u6{constructor(){this.Fo=new RE,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,r,n){this.Mo[e]=r}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new RE,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f6{xo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DE="ConnectivityMonitor";class OE{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){at(DE,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){at(DE,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gd=null;function n1(){return gd===null?gd=function(){return 268435456+Math.round(2147483648*Math.random())}():gd++,"0x"+gd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lx="RestConnection",h6={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class d6{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.$o=r+"://"+e.host,this.Uo=`projects/${n}/databases/${a}`,this.Ko=this.databaseId.database===qd?`project_id=${n}`:`project_id=${n}&database_id=${a}`}Wo(e,r,n,a,s){const l=n1(),u=this.Go(e,r.toUriEncodedString());at(lx,`Sending RPC '${e}' ${l}:`,u,n);const f={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(f,a,s);const{host:d}=new URL(u),m=Po(d);return this.jo(e,u,f,n,m).then(y=>(at(lx,`Received RPC '${e}' ${l}: `,y),y),y=>{throw So(lx,`RPC '${e}' ${l} failed with error: `,y,"url: ",u,"request:",n),y})}Jo(e,r,n,a,s,l){return this.Wo(e,r,n,a,s)}zo(e,r,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+vu}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((a,s)=>e[s]=a),n&&n.headers.forEach((a,s)=>e[s]=a)}Go(e,r){const n=h6[e];return`${this.$o}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m6{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gn="WebChannelConnection";class p6 extends d6{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,r,n,a,s){const l=n1();return new Promise((u,f)=>{const d=new rS;d.setWithCredentials(!0),d.listenOnce(nS.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case Dd.NO_ERROR:const y=d.getResponseJson();at(Gn,`XHR for RPC '${e}' ${l} received:`,JSON.stringify(y)),u(y);break;case Dd.TIMEOUT:at(Gn,`RPC '${e}' ${l} timed out`),f(new rt(De.DEADLINE_EXCEEDED,"Request time out"));break;case Dd.HTTP_ERROR:const _=d.getStatus();if(at(Gn,`RPC '${e}' ${l} failed with status:`,_,"response text:",d.getResponseText()),_>0){let E=d.getResponseJson();Array.isArray(E)&&(E=E[0]);const b=E==null?void 0:E.error;if(b&&b.status&&b.message){const w=function(M){const j=M.toLowerCase().replace(/_/g,"-");return Object.values(De).indexOf(j)>=0?j:De.UNKNOWN}(b.status);f(new rt(w,b.message))}else f(new rt(De.UNKNOWN,"Server responded with status "+d.getStatus()))}else f(new rt(De.UNAVAILABLE,"Connection failed."));break;default:yt(9055,{c_:e,streamId:l,l_:d.getLastErrorCode(),h_:d.getLastError()})}}finally{at(Gn,`RPC '${e}' ${l} completed.`)}});const m=JSON.stringify(a);at(Gn,`RPC '${e}' ${l} sending request:`,a),d.send(r,"POST",m,n,15)})}P_(e,r,n){const a=n1(),s=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],l=sS(),u=iS(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(f.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(f.useFetchStreams=!0),this.zo(f.initMessageHeaders,r,n),f.encodeInitMessageHeaders=!0;const m=s.join("");at(Gn,`Creating RPC '${e}' stream ${a}: ${m}`,f);const y=l.createWebChannel(m,f);this.T_(y);let _=!1,E=!1;const b=new m6({Ho:S=>{E?at(Gn,`Not sending because RPC '${e}' stream ${a} is closed:`,S):(_||(at(Gn,`Opening RPC '${e}' stream ${a} transport.`),y.open(),_=!0),at(Gn,`RPC '${e}' stream ${a} sending:`,S),y.send(S))},Yo:()=>y.close()}),w=(S,M,j)=>{S.listen(M,F=>{try{j(F)}catch(G){setTimeout(()=>{throw G},0)}})};return w(y,Of.EventType.OPEN,()=>{E||(at(Gn,`RPC '${e}' stream ${a} transport opened.`),b.s_())}),w(y,Of.EventType.CLOSE,()=>{E||(E=!0,at(Gn,`RPC '${e}' stream ${a} transport closed`),b.__(),this.I_(y))}),w(y,Of.EventType.ERROR,S=>{E||(E=!0,So(Gn,`RPC '${e}' stream ${a} transport errored. Name:`,S.name,"Message:",S.message),b.__(new rt(De.UNAVAILABLE,"The operation could not be completed")))}),w(y,Of.EventType.MESSAGE,S=>{var M;if(!E){const j=S.data[0];lr(!!j,16349);const F=j,G=(F==null?void 0:F.error)||((M=F[0])===null||M===void 0?void 0:M.error);if(G){at(Gn,`RPC '${e}' stream ${a} received error:`,G);const W=G.status;let B=function(k){const O=sn[k];if(O!==void 0)return zS(O)}(W),A=G.message;B===void 0&&(B=De.INTERNAL,A="Unknown error status: "+W+" with message "+G.message),E=!0,b.__(new rt(B,A)),y.close()}else at(Gn,`RPC '${e}' stream ${a} received:`,j),b.a_(j)}}),w(u,aS.STAT_EVENT,S=>{S.stat===Gx.PROXY?at(Gn,`RPC '${e}' stream ${a} detected buffering proxy`):S.stat===Gx.NOPROXY&&at(Gn,`RPC '${e}' stream ${a} detected no buffering proxy`)}),setTimeout(()=>{b.o_()},0),b}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(r=>r===e)}}function cx(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fm(t){return new yD(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rk{constructor(e,r,n=1e3,a=1.5,s=6e4){this.Fi=e,this.timerId=r,this.d_=n,this.E_=a,this.A_=s,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const r=Math.floor(this.R_+this.p_()),n=Math.max(0,Date.now()-this.m_),a=Math.max(0,r-n);a>0&&at("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.R_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,a,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FE="PersistentStream";class nk{constructor(e,r,n,a,s,l,u,f){this.Fi=e,this.w_=n,this.S_=a,this.connection=s,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=u,this.listener=f,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new rk(e,r)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():r&&r.code===De.RESOURCE_EXHAUSTED?(As(r.toString()),As("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):r&&r.code===De.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(r)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),r=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,a])=>{this.b_===r&&this.W_(n,a)},n=>{e(()=>{const a=new rt(De.UNKNOWN,"Fetching auth token failed: "+n.message);return this.G_(a)})})}W_(e,r){const n=this.K_(this.b_);this.stream=this.z_(e,r),this.stream.Zo(()=>{n(()=>this.listener.Zo())}),this.stream.e_(()=>{n(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(a=>{n(()=>this.G_(a))}),this.stream.onMessage(a=>{n(()=>++this.C_==1?this.j_(a):this.onNext(a))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(e){return at(FE,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return r=>{this.Fi.enqueueAndForget(()=>this.b_===e?r():(at(FE,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class g6 extends nk{constructor(e,r,n,a,s,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,a,l),this.serializer=s}z_(e,r){return this.connection.P_("Listen",e,r)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const r=ED(this.serializer,e),n=function(s){if(!("targetChange"in s))return St.min();const l=s.targetChange;return l.targetIds&&l.targetIds.length?St.min():l.readTime?Hi(l.readTime):St.min()}(e);return this.listener.J_(r,n)}H_(e){const r={};r.database=t1(this.serializer),r.addTarget=function(s,l){let u;const f=l.target;if(u=Kx(f)?{documents:SD(s,f)}:{query:kD(s,f).Vt},u.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){u.resumeToken=qS(s,l.resumeToken);const d=Jx(s,l.expectedCount);d!==null&&(u.expectedCount=d)}else if(l.snapshotVersion.compareTo(St.min())>0){u.readTime=Qd(s,l.snapshotVersion.toTimestamp());const d=Jx(s,l.expectedCount);d!==null&&(u.expectedCount=d)}return u}(this.serializer,e);const n=CD(this.serializer,e);n&&(r.labels=n),this.k_(r)}Y_(e){const r={};r.database=t1(this.serializer),r.removeTarget=e,this.k_(r)}}class x6 extends nk{constructor(e,r,n,a,s,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,a,l),this.serializer=s}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,r){return this.connection.P_("Write",e,r)}j_(e){return lr(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,lr(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){lr(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const r=bD(e.writeResults,e.commitTime),n=Hi(e.commitTime);return this.listener.ta(n,r)}na(){const e={};e.database=t1(this.serializer),this.k_(e)}X_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>TD(this.serializer,n))};this.k_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v6{}class y6 extends v6{constructor(e,r,n,a){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=a,this.ra=!1}ia(){if(this.ra)throw new rt(De.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,r,n,a){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,l])=>this.connection.Wo(e,Zx(r,n),a,s,l)).catch(s=>{throw s.name==="FirebaseError"?(s.code===De.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new rt(De.UNKNOWN,s.toString())})}Jo(e,r,n,a,s){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([l,u])=>this.connection.Jo(e,Zx(r,n),a,l,u,s)).catch(l=>{throw l.name==="FirebaseError"?(l.code===De.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new rt(De.UNKNOWN,l.toString())})}terminate(){this.ra=!0,this.connection.terminate()}}class _6{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(As(r),this._a=!1):at("OnlineStateTracker",r)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rl="RemoteStore";class w6{constructor(e,r,n,a,s){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=s,this.Ea.xo(l=>{n.enqueueAndForget(async()=>{Hl(this)&&(at(Rl,"Restarting streams for network reachability change."),await async function(f){const d=kt(f);d.Ia.add(4),await D0(d),d.Aa.set("Unknown"),d.Ia.delete(4),await Lm(d)}(this))})}),this.Aa=new _6(n,a)}}async function Lm(t){if(Hl(t))for(const e of t.da)await e(!0)}async function D0(t){for(const e of t.da)await e(!1)}function ak(t,e){const r=kt(t);r.Ta.has(e.targetId)||(r.Ta.set(e.targetId,e),ev(r)?Z1(r):wu(r).x_()&&J1(r,e))}function Q1(t,e){const r=kt(t),n=wu(r);r.Ta.delete(e),n.x_()&&ik(r,e),r.Ta.size===0&&(n.x_()?n.B_():Hl(r)&&r.Aa.set("Unknown"))}function J1(t,e){if(t.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(St.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}wu(t).H_(e)}function ik(t,e){t.Ra.$e(e),wu(t).Y_(e)}function Z1(t){t.Ra=new pD({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>t.Ta.get(e)||null,lt:()=>t.datastore.serializer.databaseId}),wu(t).start(),t.Aa.aa()}function ev(t){return Hl(t)&&!wu(t).M_()&&t.Ta.size>0}function Hl(t){return kt(t).Ia.size===0}function sk(t){t.Ra=void 0}async function E6(t){t.Aa.set("Online")}async function T6(t){t.Ta.forEach((e,r)=>{J1(t,e)})}async function b6(t,e){sk(t),ev(t)?(t.Aa.la(e),Z1(t)):t.Aa.set("Unknown")}async function S6(t,e,r){if(t.Aa.set("Online"),e instanceof GS&&e.state===2&&e.cause)try{await async function(a,s){const l=s.cause;for(const u of s.targetIds)a.Ta.has(u)&&(await a.remoteSyncer.rejectListen(u,l),a.Ta.delete(u),a.Ra.removeTarget(u))}(t,e)}catch(n){at(Rl,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Zd(t,n)}else if(e instanceof Md?t.Ra.Ye(e):e instanceof HS?t.Ra.it(e):t.Ra.et(e),!r.isEqual(St.min()))try{const n=await tk(t.localStore);r.compareTo(n)>=0&&await function(s,l){const u=s.Ra.Pt(l);return u.targetChanges.forEach((f,d)=>{if(f.resumeToken.approximateByteSize()>0){const m=s.Ta.get(d);m&&s.Ta.set(d,m.withResumeToken(f.resumeToken,l))}}),u.targetMismatches.forEach((f,d)=>{const m=s.Ta.get(f);if(!m)return;s.Ta.set(f,m.withResumeToken(Vn.EMPTY_BYTE_STRING,m.snapshotVersion)),ik(s,f);const y=new mo(m.target,f,d,m.sequenceNumber);J1(s,y)}),s.remoteSyncer.applyRemoteEvent(u)}(t,r)}catch(n){at(Rl,"Failed to raise snapshot:",n),await Zd(t,n)}}async function Zd(t,e,r){if(!_u(e))throw e;t.Ia.add(1),await D0(t),t.Aa.set("Offline"),r||(r=()=>tk(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{at(Rl,"Retrying IndexedDB access"),await r(),t.Ia.delete(1),await Lm(t)})}function ok(t,e){return e().catch(r=>Zd(t,r,e))}async function Mm(t){const e=kt(t),r=Ro(e);let n=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:j1;for(;k6(e);)try{const a=await o6(e.localStore,n);if(a===null){e.Pa.length===0&&r.B_();break}n=a.batchId,A6(e,a)}catch(a){await Zd(e,a)}lk(e)&&ck(e)}function k6(t){return Hl(t)&&t.Pa.length<10}function A6(t,e){t.Pa.push(e);const r=Ro(t);r.x_()&&r.Z_&&r.X_(e.mutations)}function lk(t){return Hl(t)&&!Ro(t).M_()&&t.Pa.length>0}function ck(t){Ro(t).start()}async function C6(t){Ro(t).na()}async function N6(t){const e=Ro(t);for(const r of t.Pa)e.X_(r.mutations)}async function I6(t,e,r){const n=t.Pa.shift(),a=G1.from(n,e,r);await ok(t,()=>t.remoteSyncer.applySuccessfulWrite(a)),await Mm(t)}async function R6(t,e){e&&Ro(t).Z_&&await async function(n,a){if(function(l){return dD(l)&&l!==De.ABORTED}(a.code)){const s=n.Pa.shift();Ro(n).N_(),await ok(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,a)),await Mm(n)}}(t,e),lk(t)&&ck(t)}async function LE(t,e){const r=kt(t);r.asyncQueue.verifyOperationInProgress(),at(Rl,"RemoteStore received new credentials");const n=Hl(r);r.Ia.add(3),await D0(r),n&&r.Aa.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ia.delete(3),await Lm(r)}async function D6(t,e){const r=kt(t);e?(r.Ia.delete(2),await Lm(r)):e||(r.Ia.add(2),await D0(r),r.Aa.set("Unknown"))}function wu(t){return t.Va||(t.Va=function(r,n,a){const s=kt(r);return s.ia(),new g6(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,a)}(t.datastore,t.asyncQueue,{Zo:E6.bind(null,t),e_:T6.bind(null,t),n_:b6.bind(null,t),J_:S6.bind(null,t)}),t.da.push(async e=>{e?(t.Va.N_(),ev(t)?Z1(t):t.Aa.set("Unknown")):(await t.Va.stop(),sk(t))})),t.Va}function Ro(t){return t.ma||(t.ma=function(r,n,a){const s=kt(r);return s.ia(),new x6(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,a)}(t.datastore,t.asyncQueue,{Zo:()=>Promise.resolve(),e_:C6.bind(null,t),n_:R6.bind(null,t),ea:N6.bind(null,t),ta:I6.bind(null,t)}),t.da.push(async e=>{e?(t.ma.N_(),await Mm(t)):(await t.ma.stop(),t.Pa.length>0&&(at(Rl,`Stopping write stream with ${t.Pa.length} pending writes`),t.Pa=[]))})),t.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tv{constructor(e,r,n,a,s){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=a,this.removalCallback=s,this.deferred=new wo,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(l=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,a,s){const l=Date.now()+n,u=new tv(e,r,l,a,s);return u.start(n),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new rt(De.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function rv(t,e){if(As("AsyncQueue",`${e}: ${t}`),_u(t))return new rt(De.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qc{static emptySet(e){return new Qc(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||dt.comparator(r.key,n.key):(r,n)=>dt.comparator(r.key,n.key),this.keyedMap=Ff(),this.sortedSet=new jr(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof Qc)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const a=r.getNext().key,s=n.getNext().key;if(!a.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new Qc;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ME{constructor(){this.fa=new jr(dt.comparator)}track(e){const r=e.doc.key,n=this.fa.get(r);n?e.type!==0&&n.type===3?this.fa=this.fa.insert(r,e):e.type===3&&n.type!==1?this.fa=this.fa.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.fa=this.fa.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.fa=this.fa.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.fa=this.fa.remove(r):e.type===1&&n.type===2?this.fa=this.fa.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.fa=this.fa.insert(r,{type:2,doc:e.doc}):yt(63341,{At:e,ga:n}):this.fa=this.fa.insert(r,e)}pa(){const e=[];return this.fa.inorderTraversal((r,n)=>{e.push(n)}),e}}class mu{constructor(e,r,n,a,s,l,u,f,d){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=a,this.mutatedKeys=s,this.fromCache=l,this.syncStateChanged=u,this.excludesMetadataChanges=f,this.hasCachedResults=d}static fromInitialDocuments(e,r,n,a,s){const l=[];return r.forEach(u=>{l.push({type:0,doc:u})}),new mu(e,r,Qc.emptySet(r),l,n,a,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Cm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let a=0;a<r.length;a++)if(r[a].type!==n[a].type||!r[a].doc.isEqual(n[a].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O6{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(e=>e.ba())}}class F6{constructor(){this.queries=PE(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(r,n){const a=kt(r),s=a.queries;a.queries=PE(),s.forEach((l,u)=>{for(const f of u.wa)f.onError(n)})})(this,new rt(De.ABORTED,"Firestore shutting down"))}}function PE(){return new zl(t=>IS(t),Cm)}async function L6(t,e){const r=kt(t);let n=3;const a=e.query;let s=r.queries.get(a);s?!s.Sa()&&e.ba()&&(n=2):(s=new O6,n=e.ba()?0:1);try{switch(n){case 0:s.ya=await r.onListen(a,!0);break;case 1:s.ya=await r.onListen(a,!1);break;case 2:await r.onFirstRemoteStoreListen(a)}}catch(l){const u=rv(l,`Initialization of query '${Gc(e.query)}' failed`);return void e.onError(u)}r.queries.set(a,s),s.wa.push(e),e.va(r.onlineState),s.ya&&e.Ca(s.ya)&&nv(r)}async function M6(t,e){const r=kt(t),n=e.query;let a=3;const s=r.queries.get(n);if(s){const l=s.wa.indexOf(e);l>=0&&(s.wa.splice(l,1),s.wa.length===0?a=e.ba()?0:1:!s.Sa()&&e.ba()&&(a=2))}switch(a){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function P6(t,e){const r=kt(t);let n=!1;for(const a of e){const s=a.query,l=r.queries.get(s);if(l){for(const u of l.wa)u.Ca(a)&&(n=!0);l.ya=a}}n&&nv(r)}function j6(t,e,r){const n=kt(t),a=n.queries.get(e);if(a)for(const s of a.wa)s.onError(r);n.queries.delete(e)}function nv(t){t.Da.forEach(e=>{e.next()})}var a1,jE;(jE=a1||(a1={})).Fa="default",jE.Cache="cache";class U6{constructor(e,r,n){this.query=e,this.Ma=r,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=n||{}}Ca(e){if(!this.options.includeMetadataChanges){const n=[];for(const a of e.docChanges)a.type!==3&&n.push(a);e=new mu(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),r=!0):this.Ba(e,this.onlineState)&&(this.La(e),r=!0),this.Oa=e,r}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let r=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),r=!0),r}Ba(e,r){if(!e.fromCache||!this.ba())return!0;const n=r!=="Offline";return(!this.options.ka||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Na(e){if(e.docChanges.length>0)return!0;const r=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}La(e){e=mu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==a1.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uk{constructor(e){this.key=e}}class fk{constructor(e){this.key=e}}class B6{constructor(e,r){this.query=e,this.Ha=r,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=qt(),this.mutatedKeys=qt(),this.Xa=RS(e),this.eu=new Qc(this.Xa)}get tu(){return this.Ha}nu(e,r){const n=r?r.ru:new ME,a=r?r.eu:this.eu;let s=r?r.mutatedKeys:this.mutatedKeys,l=a,u=!1;const f=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,d=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal((m,y)=>{const _=a.get(m),E=Nm(this.query,y)?y:null,b=!!_&&this.mutatedKeys.has(_.key),w=!!E&&(E.hasLocalMutations||this.mutatedKeys.has(E.key)&&E.hasCommittedMutations);let S=!1;_&&E?_.data.isEqual(E.data)?b!==w&&(n.track({type:3,doc:E}),S=!0):this.iu(_,E)||(n.track({type:2,doc:E}),S=!0,(f&&this.Xa(E,f)>0||d&&this.Xa(E,d)<0)&&(u=!0)):!_&&E?(n.track({type:0,doc:E}),S=!0):_&&!E&&(n.track({type:1,doc:_}),S=!0,(f||d)&&(u=!0)),S&&(E?(l=l.add(E),s=w?s.add(m):s.delete(m)):(l=l.delete(m),s=s.delete(m)))}),this.query.limit!==null)for(;l.size>this.query.limit;){const m=this.query.limitType==="F"?l.last():l.first();l=l.delete(m.key),s=s.delete(m.key),n.track({type:1,doc:m})}return{eu:l,ru:n,Ds:u,mutatedKeys:s}}iu(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,a){const s=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const l=e.ru.pa();l.sort((m,y)=>function(E,b){const w=S=>{switch(S){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return yt(20277,{At:S})}};return w(E)-w(b)}(m.type,y.type)||this.Xa(m.doc,y.doc)),this.su(n),a=a!=null&&a;const u=r&&!a?this.ou():[],f=this.Za.size===0&&this.current&&!a?1:0,d=f!==this.Ya;return this.Ya=f,l.length!==0||d?{snapshot:new mu(this.query,e.eu,s,l,e.mutatedKeys,f===0,d,!1,!!n&&n.resumeToken.approximateByteSize()>0),_u:u}:{_u:u}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new ME,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach(r=>this.Ha=this.Ha.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ha=this.Ha.delete(r)),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=qt(),this.eu.forEach(n=>{this.au(n.key)&&(this.Za=this.Za.add(n.key))});const r=[];return e.forEach(n=>{this.Za.has(n)||r.push(new fk(n))}),this.Za.forEach(n=>{e.has(n)||r.push(new uk(n))}),r}uu(e){this.Ha=e.qs,this.Za=qt();const r=this.nu(e.documents);return this.applyChanges(r,!0)}cu(){return mu.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const av="SyncEngine";class V6{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class z6{constructor(e){this.key=e,this.lu=!1}}class H6{constructor(e,r,n,a,s,l){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=a,this.currentUser=s,this.maxConcurrentLimboResolutions=l,this.hu={},this.Pu=new zl(u=>IS(u),Cm),this.Tu=new Map,this.Iu=new Set,this.du=new jr(dt.comparator),this.Eu=new Map,this.Au=new X1,this.Ru={},this.Vu=new Map,this.mu=du.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function G6(t,e,r=!0){const n=xk(t);let a;const s=n.Pu.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),a=s.view.cu()):a=await hk(n,e,r,!0),a}async function q6(t,e){const r=xk(t);await hk(r,e,!0,!1)}async function hk(t,e,r,n){const a=await l6(t.localStore,zi(e)),s=a.targetId,l=t.sharedClientState.addLocalQueryTarget(s,r);let u;return n&&(u=await W6(t,e,s,l==="current",a.resumeToken)),t.isPrimaryClient&&r&&ak(t.remoteStore,a),u}async function W6(t,e,r,n,a){t.gu=(y,_,E)=>async function(w,S,M,j){let F=S.view.nu(M);F.Ds&&(F=await IE(w.localStore,S.query,!1).then(({documents:A})=>S.view.nu(A,F)));const G=j&&j.targetChanges.get(S.targetId),W=j&&j.targetMismatches.get(S.targetId)!=null,B=S.view.applyChanges(F,w.isPrimaryClient,G,W);return BE(w,S.targetId,B._u),B.snapshot}(t,y,_,E);const s=await IE(t.localStore,e,!0),l=new B6(e,s.qs),u=l.nu(s.documents),f=R0.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",a),d=l.applyChanges(u,t.isPrimaryClient,f);BE(t,r,d._u);const m=new V6(e,r,l);return t.Pu.set(e,m),t.Tu.has(r)?t.Tu.get(r).push(e):t.Tu.set(r,[e]),d.snapshot}async function X6(t,e,r){const n=kt(t),a=n.Pu.get(e),s=n.Tu.get(a.targetId);if(s.length>1)return n.Tu.set(a.targetId,s.filter(l=>!Cm(l,e))),void n.Pu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(a.targetId),n.sharedClientState.isActiveQueryTarget(a.targetId)||await r1(n.localStore,a.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(a.targetId),r&&Q1(n.remoteStore,a.targetId),i1(n,a.targetId)}).catch(yu)):(i1(n,a.targetId),await r1(n.localStore,a.targetId,!0))}async function $6(t,e){const r=kt(t),n=r.Pu.get(e),a=r.Tu.get(n.targetId);r.isPrimaryClient&&a.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Q1(r.remoteStore,n.targetId))}async function K6(t,e,r){const n=rO(t);try{const a=await function(l,u){const f=kt(l),d=Cr.now(),m=u.reduce((E,b)=>E.add(b.key),qt());let y,_;return f.persistence.runTransaction("Locally write mutations","readwrite",E=>{let b=Cs(),w=qt();return f.Os.getEntries(E,m).next(S=>{b=S,b.forEach((M,j)=>{j.isValidDocument()||(w=w.add(M))})}).next(()=>f.localDocuments.getOverlayedDocuments(E,b)).next(S=>{y=S;const M=[];for(const j of u){const F=lD(j,y.get(j.key).overlayedDocument);F!=null&&M.push(new Uo(j.key,F,wS(F.value.mapValue),_a.exists(!0)))}return f.mutationQueue.addMutationBatch(E,d,M,u)}).next(S=>{_=S;const M=S.applyToLocalDocumentSet(y,w);return f.documentOverlayCache.saveOverlays(E,S.batchId,M)})}).then(()=>({batchId:_.batchId,changes:OS(y)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(a.batchId),function(l,u,f){let d=l.Ru[l.currentUser.toKey()];d||(d=new jr(Lt)),d=d.insert(u,f),l.Ru[l.currentUser.toKey()]=d}(n,a.batchId,r),await O0(n,a.changes),await Mm(n.remoteStore)}catch(a){const s=rv(a,"Failed to persist write");r.reject(s)}}async function dk(t,e){const r=kt(t);try{const n=await i6(r.localStore,e);e.targetChanges.forEach((a,s)=>{const l=r.Eu.get(s);l&&(lr(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?l.lu=!0:a.modifiedDocuments.size>0?lr(l.lu,14607):a.removedDocuments.size>0&&(lr(l.lu,42227),l.lu=!1))}),await O0(r,n,e)}catch(n){await yu(n)}}function UE(t,e,r){const n=kt(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const a=[];n.Pu.forEach((s,l)=>{const u=l.view.va(e);u.snapshot&&a.push(u.snapshot)}),function(l,u){const f=kt(l);f.onlineState=u;let d=!1;f.queries.forEach((m,y)=>{for(const _ of y.wa)_.va(u)&&(d=!0)}),d&&nv(f)}(n.eventManager,e),a.length&&n.hu.J_(a),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function Y6(t,e,r){const n=kt(t);n.sharedClientState.updateQueryState(e,"rejected",r);const a=n.Eu.get(e),s=a&&a.key;if(s){let l=new jr(dt.comparator);l=l.insert(s,Kn.newNoDocument(s,St.min()));const u=qt().add(s),f=new Om(St.min(),new Map,new jr(Lt),l,u);await dk(n,f),n.du=n.du.remove(s),n.Eu.delete(e),iv(n)}else await r1(n.localStore,e,!1).then(()=>i1(n,e,r)).catch(yu)}async function Q6(t,e){const r=kt(t),n=e.batch.batchId;try{const a=await a6(r.localStore,e);pk(r,n,null),mk(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await O0(r,a)}catch(a){await yu(a)}}async function J6(t,e,r){const n=kt(t);try{const a=await function(l,u){const f=kt(l);return f.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let m;return f.mutationQueue.lookupMutationBatch(d,u).next(y=>(lr(y!==null,37113),m=y.keys(),f.mutationQueue.removeMutationBatch(d,y))).next(()=>f.mutationQueue.performConsistencyCheck(d)).next(()=>f.documentOverlayCache.removeOverlaysForBatchId(d,m,u)).next(()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,m)).next(()=>f.localDocuments.getDocuments(d,m))})}(n.localStore,e);pk(n,e,r),mk(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await O0(n,a)}catch(a){await yu(a)}}function mk(t,e){(t.Vu.get(e)||[]).forEach(r=>{r.resolve()}),t.Vu.delete(e)}function pk(t,e,r){const n=kt(t);let a=n.Ru[n.currentUser.toKey()];if(a){const s=a.get(e);s&&(r?s.reject(r):s.resolve(),a=a.remove(e)),n.Ru[n.currentUser.toKey()]=a}}function i1(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Tu.get(e))t.Pu.delete(n),r&&t.hu.pu(n,r);t.Tu.delete(e),t.isPrimaryClient&&t.Au.zr(e).forEach(n=>{t.Au.containsKey(n)||gk(t,n)})}function gk(t,e){t.Iu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(Q1(t.remoteStore,r),t.du=t.du.remove(e),t.Eu.delete(r),iv(t))}function BE(t,e,r){for(const n of r)n instanceof uk?(t.Au.addReference(n.key,e),Z6(t,n)):n instanceof fk?(at(av,"Document no longer in limbo: "+n.key),t.Au.removeReference(n.key,e),t.Au.containsKey(n.key)||gk(t,n.key)):yt(19791,{yu:n})}function Z6(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Iu.has(n)||(at(av,"New document in limbo: "+r),t.Iu.add(n),iv(t))}function iv(t){for(;t.Iu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Iu.values().next().value;t.Iu.delete(e);const r=new dt(br.fromString(e)),n=t.mu.next();t.Eu.set(n,new z6(r)),t.du=t.du.insert(r,n),ak(t.remoteStore,new mo(zi(CS(r.path)),n,"TargetPurposeLimboResolution",Sm.ue))}}async function O0(t,e,r){const n=kt(t),a=[],s=[],l=[];n.Pu.isEmpty()||(n.Pu.forEach((u,f)=>{l.push(n.gu(f,e,r).then(d=>{var m;if((d||r)&&n.isPrimaryClient){const y=d?!d.fromCache:(m=r==null?void 0:r.targetChanges.get(f.targetId))===null||m===void 0?void 0:m.current;n.sharedClientState.updateQueryState(f.targetId,y?"current":"not-current")}if(d){a.push(d);const y=K1.Es(f.targetId,d);s.push(y)}}))}),await Promise.all(l),n.hu.J_(a),await async function(f,d){const m=kt(f);try{await m.persistence.runTransaction("notifyLocalViewChanges","readwrite",y=>Le.forEach(d,_=>Le.forEach(_.Is,E=>m.persistence.referenceDelegate.addReference(y,_.targetId,E)).next(()=>Le.forEach(_.ds,E=>m.persistence.referenceDelegate.removeReference(y,_.targetId,E)))))}catch(y){if(!_u(y))throw y;at(Y1,"Failed to update sequence numbers: "+y)}for(const y of d){const _=y.targetId;if(!y.fromCache){const E=m.Fs.get(_),b=E.snapshotVersion,w=E.withLastLimboFreeSnapshotVersion(b);m.Fs=m.Fs.insert(_,w)}}}(n.localStore,s))}async function eO(t,e){const r=kt(t);if(!r.currentUser.isEqual(e)){at(av,"User change. New user:",e.toKey());const n=await ek(r.localStore,e);r.currentUser=e,function(s,l){s.Vu.forEach(u=>{u.forEach(f=>{f.reject(new rt(De.CANCELLED,l))})}),s.Vu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await O0(r,n.Bs)}}function tO(t,e){const r=kt(t),n=r.Eu.get(e);if(n&&n.lu)return qt().add(n.key);{let a=qt();const s=r.Tu.get(e);if(!s)return a;for(const l of s){const u=r.Pu.get(l);a=a.unionWith(u.view.tu)}return a}}function xk(t){const e=kt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=dk.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=tO.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Y6.bind(null,e),e.hu.J_=P6.bind(null,e.eventManager),e.hu.pu=j6.bind(null,e.eventManager),e}function rO(t){const e=kt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Q6.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=J6.bind(null,e),e}class em{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Fm(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,r){return null}Fu(e,r){return null}vu(e){return n6(this.persistence,new e6,e.initialUser,this.serializer)}Du(e){return new ZS($1.Vi,this.serializer)}bu(e){return new u6}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}em.provider={build:()=>new em};class nO extends em{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,r){lr(this.persistence.referenceDelegate instanceof Jd,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new UD(n,e.asyncQueue,r)}Du(e){const r=this.cacheSizeBytes!==void 0?va.withCacheSize(this.cacheSizeBytes):va.DEFAULT;return new ZS(n=>Jd.Vi(n,r),this.serializer)}}class s1{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>UE(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=eO.bind(null,this.syncEngine),await D6(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new F6}()}createDatastore(e){const r=Fm(e.databaseInfo.databaseId),n=function(s){return new p6(s)}(e.databaseInfo);return function(s,l,u,f){return new y6(s,l,u,f)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,a,s,l,u){return new w6(n,a,s,l,u)}(this.localStore,this.datastore,e.asyncQueue,r=>UE(this.syncEngine,r,0),function(){return OE.C()?new OE:new f6}())}createSyncEngine(e,r){return function(a,s,l,u,f,d,m){const y=new H6(a,s,l,u,f,d);return m&&(y.fu=!0),y}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(a){const s=kt(a);at(Rl,"RemoteStore shutting down."),s.Ia.add(5),await D0(s),s.Ea.shutdown(),s.Aa.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}s1.provider={build:()=>new s1};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aO{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):As("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Do="FirestoreClient";class iO{constructor(e,r,n,a,s){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=a,this.user=Wn.UNAUTHENTICATED,this.clientId=P1.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async l=>{at(Do,"Received user=",l.uid),await this.authCredentialListener(l),this.user=l}),this.appCheckCredentials.start(n,l=>(at(Do,"Received new app check token=",l),this.appCheckCredentialListener(l,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new wo;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=rv(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function ux(t,e){t.asyncQueue.verifyOperationInProgress(),at(Do,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async a=>{n.isEqual(a)||(await ek(e.localStore,a),n=a)}),e.persistence.setDatabaseDeletedListener(()=>{So("Terminating Firestore due to IndexedDb database deletion"),t.terminate().then(()=>{at("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(a=>{So("Terminating Firestore due to IndexedDb database deletion failed",a)})}),t._offlineComponents=e}async function VE(t,e){t.asyncQueue.verifyOperationInProgress();const r=await sO(t);at(Do,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>LE(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,a)=>LE(e.remoteStore,a)),t._onlineComponents=e}async function sO(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){at(Do,"Using user provided OfflineComponentProvider");try{await ux(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(a){return a.name==="FirebaseError"?a.code===De.FAILED_PRECONDITION||a.code===De.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11}(r))throw r;So("Error using user provided cache. Falling back to memory cache: "+r),await ux(t,new em)}}else at(Do,"Using default OfflineComponentProvider"),await ux(t,new nO(void 0));return t._offlineComponents}async function vk(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(at(Do,"Using user provided OnlineComponentProvider"),await VE(t,t._uninitializedComponentsProvider._online)):(at(Do,"Using default OnlineComponentProvider"),await VE(t,new s1))),t._onlineComponents}function oO(t){return vk(t).then(e=>e.syncEngine)}async function lO(t){const e=await vk(t),r=e.eventManager;return r.onListen=G6.bind(null,e.syncEngine),r.onUnlisten=X6.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=q6.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=$6.bind(null,e.syncEngine),r}function cO(t,e,r={}){const n=new wo;return t.asyncQueue.enqueueAndForget(async()=>function(s,l,u,f,d){const m=new aO({next:_=>{m.Ou(),l.enqueueAndForget(()=>M6(s,y)),_.fromCache&&f.source==="server"?d.reject(new rt(De.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(_)},error:_=>d.reject(_)}),y=new U6(u,m,{includeMetadataChanges:!0,ka:!0});return L6(s,y)}(await lO(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yk(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zE=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _k="firestore.googleapis.com",HE=!0;class GE{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new rt(De.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=_k,this.ssl=HE}else this.host=e.host,this.ssl=(r=e.ssl)!==null&&r!==void 0?r:HE;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=JS;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<PD)throw new rt(De.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}ER("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=yk((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new rt(De.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new rt(De.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new rt(De.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,a){return n.timeoutSeconds===a.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Pm{constructor(e,r,n,a){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new GE({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new rt(De.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new rt(De.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new GE(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new dR;switch(n.type){case"firstParty":return new xR(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new rt(De.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=zE.get(r);n&&(at("ComponentProvider","Removing Datastore"),zE.delete(r),n.terminate())}(this),Promise.resolve()}}function uO(t,e,r,n={}){var a;t=ko(t,Pm);const s=Po(e),l=t._getSettings(),u=Object.assign(Object.assign({},l),{emulatorOptions:t._getEmulatorOptions()}),f=`${e}:${r}`;s&&(I1(`https://${f}`),R1("Firestore",!0)),l.host!==_k&&l.host!==f&&So("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const d=Object.assign(Object.assign({},l),{host:f,ssl:s,emulatorOptions:n});if(!Cl(d,u)&&(t._setSettings(d),n.mockUserToken)){let m,y;if(typeof n.mockUserToken=="string")m=n.mockUserToken,y=Wn.MOCK_USER;else{m=Yb(n.mockUserToken,(a=t._app)===null||a===void 0?void 0:a.options.projectId);const _=n.mockUserToken.sub||n.mockUserToken.user_id;if(!_)throw new rt(De.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");y=new Wn(_)}t._authCredentials=new mR(new lS(m,y))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eu{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Eu(this.firestore,e,this._query)}}class xn{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Eo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new xn(this.firestore,e,this._key)}toJSON(){return{type:xn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(C0(r,xn._jsonSchema))return new xn(e,n||null,new dt(br.fromString(r.referencePath)))}}xn._jsonSchemaVersion="firestore/documentReference/1.0",xn._jsonSchema={type:un("string",xn._jsonSchemaVersion),referencePath:un("string")};class Eo extends Eu{constructor(e,r,n){super(e,r,CS(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new xn(this.firestore,null,new dt(e))}withConverter(e){return new Eo(this.firestore,e,this._path)}}function Rs(t,e,...r){if(t=Sr(t),uS("collection","path",e),t instanceof Pm){const n=br.fromString(e,...r);return nE(n),new Eo(t,null,n)}{if(!(t instanceof xn||t instanceof Eo))throw new rt(De.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(br.fromString(e,...r));return nE(n),new Eo(t.firestore,null,n)}}function ca(t,e,...r){if(t=Sr(t),arguments.length===1&&(e=P1.newId()),uS("doc","path",e),t instanceof Pm){const n=br.fromString(e,...r);return rE(n),new xn(t,null,new dt(n))}{if(!(t instanceof xn||t instanceof Eo))throw new rt(De.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(br.fromString(e,...r));return rE(n),new xn(t.firestore,t instanceof Eo?t.converter:null,new dt(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qE="AsyncQueue";class WE{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new rk(this,"async_queue_retry"),this.oc=()=>{const n=cx();n&&at(qE,"Visibility state changed to "+n.visibilityState),this.F_.y_()},this._c=e;const r=cx();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const r=cx();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});const r=new wo;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!_u(e))throw e;at(qE,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(e){const r=this._c.then(()=>(this.nc=!0,e().catch(n=>{throw this.tc=n,this.nc=!1,As("INTERNAL UNHANDLED ERROR: ",XE(n)),n}).then(n=>(this.nc=!1,n))));return this._c=r,r}enqueueAfterDelay(e,r,n){this.ac(),this.sc.indexOf(e)>-1&&(r=0);const a=tv.createAndSchedule(this,e,r,n,s=>this.lc(s));return this.ec.push(a),a}ac(){this.tc&&yt(47125,{hc:XE(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(const r of this.ec)if(r.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{this.ec.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.ec)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){const r=this.ec.indexOf(e);this.ec.splice(r,1)}}function XE(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class Tu extends Pm{constructor(e,r,n,a){super(e,r,n,a),this.type="firestore",this._queue=new WE,this._persistenceKey=(a==null?void 0:a.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new WE(e),this._firestoreClient=void 0,await e}}}function fO(t,e){const r=typeof t=="object"?t:L1(),n=typeof t=="string"?t:qd,a=Tm(r,"firestore").getImmediate({identifier:n});if(!a._initialized){const s=Xb("firestore");s&&uO(a,...s)}return a}function sv(t){if(t._terminated)throw new rt(De.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||hO(t),t._firestoreClient}function hO(t){var e,r,n;const a=t._freezeSettings(),s=function(u,f,d,m){return new OR(u,f,d,m.host,m.ssl,m.experimentalForceLongPolling,m.experimentalAutoDetectLongPolling,yk(m.experimentalLongPollingOptions),m.useFetchStreams,m.isUsingEmulator)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,a);t._componentsProvider||!((r=a.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=a.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:a.localCache._offlineComponentProvider,_online:a.localCache._onlineComponentProvider}),t._firestoreClient=new iO(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(u){const f=u==null?void 0:u._online.build();return{_offline:u==null?void 0:u._offline.build(f),_online:f}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ii{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ii(Vn.fromBase64String(e))}catch(r){throw new rt(De.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new ii(Vn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ii._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(C0(e,ii._jsonSchema))return ii.fromBase64String(e.bytes)}}ii._jsonSchemaVersion="firestore/bytes/1.0",ii._jsonSchema={type:un("string",ii._jsonSchemaVersion),bytes:un("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F0{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new rt(De.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Un(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ov{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gi{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new rt(De.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new rt(De.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Lt(this._lat,e._lat)||Lt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Gi._jsonSchemaVersion}}static fromJSON(e){if(C0(e,Gi._jsonSchema))return new Gi(e.latitude,e.longitude)}}Gi._jsonSchemaVersion="firestore/geoPoint/1.0",Gi._jsonSchema={type:un("string",Gi._jsonSchemaVersion),latitude:un("number"),longitude:un("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qi{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,a){if(n.length!==a.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==a[s])return!1;return!0}(this._values,e._values)}toJSON(){return{type:qi._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(C0(e,qi._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(r=>typeof r=="number"))return new qi(e.vectorValues);throw new rt(De.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}qi._jsonSchemaVersion="firestore/vectorValue/1.0",qi._jsonSchema={type:un("string",qi._jsonSchemaVersion),vectorValues:un("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dO=/^__.*__$/;class mO{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new Uo(e,this.data,this.fieldMask,r,this.fieldTransforms):new I0(e,this.data,r,this.fieldTransforms)}}class wk{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new Uo(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function Ek(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw yt(40011,{Ec:t})}}class lv{constructor(e,r,n,a,s,l){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=a,s===void 0&&this.Ac(),this.fieldTransforms=s||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new lv(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),a=this.Rc({path:n,mc:!1});return a.fc(e),a}gc(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),a=this.Rc({path:n,mc:!1});return a.Ac(),a}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return tm(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(Ek(this.Ec)&&dO.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class pO{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||Fm(e)}Dc(e,r,n,a=!1){return new lv({Ec:e,methodName:r,bc:n,path:Un.emptyPath(),mc:!1,Sc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function jm(t){const e=t._freezeSettings(),r=Fm(t._databaseId);return new pO(t._databaseId,!!e.ignoreUndefinedProperties,r)}function Tk(t,e,r,n,a,s={}){const l=t.Dc(s.merge||s.mergeFields?2:0,e,r,a);cv("Data must be an object, but it was:",l,n);const u=kk(n,l);let f,d;if(s.merge)f=new ja(l.fieldMask),d=l.fieldTransforms;else if(s.mergeFields){const m=[];for(const y of s.mergeFields){const _=o1(e,y,r);if(!l.contains(_))throw new rt(De.INVALID_ARGUMENT,`Field '${_}' is specified in your field mask but missing from your input data.`);Ck(m,_)||m.push(_)}f=new ja(m),d=l.fieldTransforms.filter(y=>f.covers(y.field))}else f=null,d=l.fieldTransforms;return new mO(new ya(u),f,d)}class L0 extends ov{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof L0}}function bk(t,e,r,n){const a=t.Dc(1,e,r);cv("Data must be an object, but it was:",a,n);const s=[],l=ya.empty();jo(n,(f,d)=>{const m=uv(e,f,r);d=Sr(d);const y=a.gc(m);if(d instanceof L0)s.push(m);else{const _=M0(d,y);_!=null&&(s.push(m),l.set(m,_))}});const u=new ja(s);return new wk(l,u,a.fieldTransforms)}function Sk(t,e,r,n,a,s){const l=t.Dc(1,e,r),u=[o1(e,n,r)],f=[a];if(s.length%2!=0)throw new rt(De.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let _=0;_<s.length;_+=2)u.push(o1(e,s[_])),f.push(s[_+1]);const d=[],m=ya.empty();for(let _=u.length-1;_>=0;--_)if(!Ck(d,u[_])){const E=u[_];let b=f[_];b=Sr(b);const w=l.gc(E);if(b instanceof L0)d.push(E);else{const S=M0(b,w);S!=null&&(d.push(E),m.set(E,S))}}const y=new ja(d);return new wk(m,y,l.fieldTransforms)}function gO(t,e,r,n=!1){return M0(r,t.Dc(n?4:3,e))}function M0(t,e){if(Ak(t=Sr(t)))return cv("Unsupported field value:",e,t),kk(t,e);if(t instanceof ov)return function(n,a){if(!Ek(a.Ec))throw a.wc(`${n._methodName}() can only be used with update() and set()`);if(!a.path)throw a.wc(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(a);s&&a.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return function(n,a){const s=[];let l=0;for(const u of n){let f=M0(u,a.yc(l));f==null&&(f={nullValue:"NULL_VALUE"}),s.push(f),l++}return{arrayValue:{values:s}}}(t,e)}return function(n,a){if((n=Sr(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return rD(a.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=Cr.fromDate(n);return{timestampValue:Qd(a.serializer,s)}}if(n instanceof Cr){const s=new Cr(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Qd(a.serializer,s)}}if(n instanceof Gi)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof ii)return{bytesValue:qS(a.serializer,n._byteString)};if(n instanceof xn){const s=a.databaseId,l=n.firestore._databaseId;if(!l.isEqual(s))throw a.wc(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:W1(n.firestore._databaseId||a.databaseId,n._key.path)}}if(n instanceof qi)return function(l,u){return{mapValue:{fields:{[yS]:{stringValue:_S},[Wd]:{arrayValue:{values:l.toArray().map(d=>{if(typeof d!="number")throw u.wc("VectorValues must only contain numeric values.");return H1(u.serializer,d)})}}}}}}(n,a);throw a.wc(`Unsupported field value: ${bm(n)}`)}(t,e)}function kk(t,e){const r={};return dS(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):jo(t,(n,a)=>{const s=M0(a,e.Vc(n));s!=null&&(r[n]=s)}),{mapValue:{fields:r}}}function Ak(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Cr||t instanceof Gi||t instanceof ii||t instanceof xn||t instanceof ov||t instanceof qi)}function cv(t,e,r){if(!Ak(r)||!fS(r)){const n=bm(r);throw n==="an object"?e.wc(t+" a custom object"):e.wc(t+" "+n)}}function o1(t,e,r){if((e=Sr(e))instanceof F0)return e._internalPath;if(typeof e=="string")return uv(t,e);throw tm("Field path arguments must be of type string or ",t,!1,void 0,r)}const xO=new RegExp("[~\\*/\\[\\]]");function uv(t,e,r){if(e.search(xO)>=0)throw tm(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new F0(...e.split("."))._internalPath}catch{throw tm(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function tm(t,e,r,n,a){const s=n&&!n.isEmpty(),l=a!==void 0;let u=`Function ${e}() called with invalid data`;r&&(u+=" (via `toFirestore()`)"),u+=". ";let f="";return(s||l)&&(f+=" (found",s&&(f+=` in field ${n}`),l&&(f+=` in document ${a}`),f+=")"),new rt(De.INVALID_ARGUMENT,u+t+f)}function Ck(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nk{constructor(e,r,n,a,s){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=a,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new xn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new vO(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(fv("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class vO extends Nk{data(){return super.data()}}function fv(t,e){return typeof e=="string"?uv(t,e):e instanceof F0?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yO(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new rt(De.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class hv{}class _O extends hv{}function Pc(t,e,...r){let n=[];e instanceof hv&&n.push(e),n=n.concat(r),function(s){const l=s.filter(f=>f instanceof dv).length,u=s.filter(f=>f instanceof Um).length;if(l>1||l>0&&u>0)throw new rt(De.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const a of n)t=a._apply(t);return t}class Um extends _O{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new Um(e,r,n)}_apply(e){const r=this._parse(e);return Ik(e._query,r),new Eu(e.firestore,e.converter,Yx(e._query,r))}_parse(e){const r=jm(e.firestore);return function(s,l,u,f,d,m,y){let _;if(d.isKeyField()){if(m==="array-contains"||m==="array-contains-any")throw new rt(De.INVALID_ARGUMENT,`Invalid Query. You can't perform '${m}' queries on documentId().`);if(m==="in"||m==="not-in"){KE(y,m);const b=[];for(const w of y)b.push($E(f,s,w));_={arrayValue:{values:b}}}else _=$E(f,s,y)}else m!=="in"&&m!=="not-in"&&m!=="array-contains-any"||KE(y,m),_=gO(u,l,y,m==="in"||m==="not-in");return cn.create(d,m,_)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function jc(t,e,r){const n=e,a=fv("where",t);return Um._create(a,n,r)}class dv extends hv{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new dv(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:yi.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(a,s){let l=a;const u=s.getFlattenedFilters();for(const f of u)Ik(l,f),l=Yx(l,f)}(e._query,r),new Eu(e.firestore,e.converter,Yx(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function $E(t,e,r){if(typeof(r=Sr(r))=="string"){if(r==="")throw new rt(De.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!NS(e)&&r.indexOf("/")!==-1)throw new rt(De.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(br.fromString(r));if(!dt.isDocumentKey(n))throw new rt(De.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return fE(t,new dt(n))}if(r instanceof xn)return fE(t,r._key);throw new rt(De.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${bm(r)}.`)}function KE(t,e){if(!Array.isArray(t)||t.length===0)throw new rt(De.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Ik(t,e){const r=function(a,s){for(const l of a)for(const u of l.getFlattenedFilters())if(s.indexOf(u.op)>=0)return u.op;return null}(t.filters,function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new rt(De.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new rt(De.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class wO{convertValue(e,r="none"){switch(Io(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Qr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(No(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw yt(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return jo(e,(a,s)=>{n[a]=this.convertValue(s,r)}),n}convertVectorValue(e){var r,n,a;const s=(a=(n=(r=e.fields)===null||r===void 0?void 0:r[Wd].arrayValue)===null||n===void 0?void 0:n.values)===null||a===void 0?void 0:a.map(l=>Qr(l.doubleValue));return new qi(s)}convertGeoPoint(e){return new Gi(Qr(e.latitude),Qr(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=Am(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(a0(e));default:return null}}convertTimestamp(e){const r=Co(e);return new Cr(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=br.fromString(e);lr(QS(n),9688,{name:e});const a=new i0(n.get(1),n.get(3)),s=new dt(n.popFirst(5));return a.isEqual(r)||As(`Document ${s} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rk(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}class xd{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Jc extends Nk{constructor(e,r,n,a,s,l){super(e,r,n,a,l),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new Pd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(fv("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new rt(De.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=Jc._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}Jc._jsonSchemaVersion="firestore/documentSnapshot/1.0",Jc._jsonSchema={type:un("string",Jc._jsonSchemaVersion),bundleSource:un("string","DocumentSnapshot"),bundleName:un("string"),bundle:un("string")};class Pd extends Jc{data(e={}){return super.data(e)}}class Zc{constructor(e,r,n,a){this._firestore=e,this._userDataWriter=r,this._snapshot=a,this.metadata=new xd(a.hasPendingWrites,a.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new Pd(this._firestore,this._userDataWriter,n.key,n,new xd(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new rt(De.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(a,s){if(a._snapshot.oldDocs.isEmpty()){let l=0;return a._snapshot.docChanges.map(u=>{const f=new Pd(a._firestore,a._userDataWriter,u.doc.key,u.doc,new xd(a._snapshot.mutatedKeys.has(u.doc.key),a._snapshot.fromCache),a.query.converter);return u.doc,{type:"added",doc:f,oldIndex:-1,newIndex:l++}})}{let l=a._snapshot.oldDocs;return a._snapshot.docChanges.filter(u=>s||u.type!==3).map(u=>{const f=new Pd(a._firestore,a._userDataWriter,u.doc.key,u.doc,new xd(a._snapshot.mutatedKeys.has(u.doc.key),a._snapshot.fromCache),a.query.converter);let d=-1,m=-1;return u.type!==0&&(d=l.indexOf(u.doc.key),l=l.delete(u.doc.key)),u.type!==1&&(l=l.add(u.doc),m=l.indexOf(u.doc.key)),{type:EO(u.type),doc:f,oldIndex:d,newIndex:m}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new rt(De.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Zc._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=P1.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],a=[];return this.docs.forEach(s=>{s._document!==null&&(r.push(s._document),n.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),a.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function EO(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return yt(61501,{type:t})}}Zc._jsonSchemaVersion="firestore/querySnapshot/1.0",Zc._jsonSchema={type:un("string",Zc._jsonSchemaVersion),bundleSource:un("string","QuerySnapshot"),bundleName:un("string"),bundle:un("string")};class TO extends wO{constructor(e){super(),this.firestore=e}convertBytes(e){return new ii(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new xn(this.firestore,null,r)}}function la(t){t=ko(t,Eu);const e=ko(t.firestore,Tu),r=sv(e),n=new TO(e);return yO(t._query),cO(r,t._query).then(a=>new Zc(e,n,t,a))}function oo(t,e,r,...n){t=ko(t,xn);const a=ko(t.firestore,Tu),s=jm(a);let l;return l=typeof(e=Sr(e))=="string"||e instanceof F0?Sk(s,"updateDoc",t._key,e,r,n):bk(s,"updateDoc",t._key,e),Bm(a,[l.toMutation(t._key,_a.exists(!0))])}function jd(t){return Bm(ko(t.firestore,Tu),[new Dm(t._key,_a.none())])}function so(t,e){const r=ko(t.firestore,Tu),n=ca(t),a=Rk(t.converter,e);return Bm(r,[Tk(jm(t.firestore),"addDoc",n._key,a,t.converter!==null,{}).toMutation(n._key,_a.exists(!1))]).then(()=>n)}function Bm(t,e){return function(n,a){const s=new wo;return n.asyncQueue.enqueueAndForget(async()=>K6(await oO(n),a,s)),s.promise}(sv(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bO{constructor(e,r){this._firestore=e,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=jm(e)}set(e,r,n){this._verifyNotCommitted();const a=fx(e,this._firestore),s=Rk(a.converter,r,n),l=Tk(this._dataReader,"WriteBatch.set",a._key,s,a.converter!==null,n);return this._mutations.push(l.toMutation(a._key,_a.none())),this}update(e,r,n,...a){this._verifyNotCommitted();const s=fx(e,this._firestore);let l;return l=typeof(r=Sr(r))=="string"||r instanceof F0?Sk(this._dataReader,"WriteBatch.update",s._key,r,n,a):bk(this._dataReader,"WriteBatch.update",s._key,r),this._mutations.push(l.toMutation(s._key,_a.exists(!0))),this}delete(e){this._verifyNotCommitted();const r=fx(e,this._firestore);return this._mutations=this._mutations.concat(new Dm(r._key,_a.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new rt(De.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function fx(t,e){if((t=Sr(t)).firestore!==e)throw new rt(De.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SO(){return new L0("deleteField")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YE(t){return sv(t=ko(t,Tu)),new bO(t,e=>Bm(t,e))}(function(e,r=!0){(function(a){vu=a})(Vl),Nl(new bo("firestore",(n,{instanceIdentifier:a,options:s})=>{const l=n.getProvider("app").getImmediate(),u=new Tu(new pR(n.getProvider("auth-internal")),new vR(l,n.getProvider("app-check-internal")),function(d,m){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new rt(De.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new i0(d.options.projectId,m)}(l,a),l);return s=Object.assign({useFetchStreams:r},s),u._setSettings(s),u},"PUBLIC").setMultipleInstances(!0)),Vi(Qw,Jw,e),Vi(Qw,Jw,"esm2017")})();function mv(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(t);a<n.length;a++)e.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(t,n[a])&&(r[n[a]]=t[n[a]]);return r}function Dk(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const kO=Dk,Ok=new k0("auth","Firebase",Dk());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rm=new D1("@firebase/auth");function AO(t,...e){rm.logLevel<=Gt.WARN&&rm.warn(`Auth (${Vl}): ${t}`,...e)}function Ud(t,...e){rm.logLevel<=Gt.ERROR&&rm.error(`Auth (${Vl}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _i(t,...e){throw pv(t,...e)}function Wi(t,...e){return pv(t,...e)}function Fk(t,e,r){const n=Object.assign(Object.assign({},kO()),{[e]:r});return new k0("auth","Firebase",n).create(e,{appName:t.name})}function Ts(t){return Fk(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function pv(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return Ok.create(t,...e)}function vt(t,e,...r){if(!t)throw pv(e,...r)}function _s(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Ud(e),new Error(e)}function Ns(t,e){t||_s(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l1(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function CO(){return QE()==="http:"||QE()==="https:"}function QE(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NO(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(CO()||G3()||"connection"in navigator)?navigator.onLine:!0}function IO(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P0{constructor(e,r){this.shortDelay=e,this.longDelay=r,Ns(r>e,"Short delay should be less than long delay!"),this.isMobile=V3()||q3()}get(){return NO()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gv(t,e){Ns(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lk{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;_s("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;_s("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;_s("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RO={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DO=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],OO=new P0(3e4,6e4);function Bo(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Vo(t,e,r,n,a={}){return Mk(t,a,async()=>{let s={},l={};n&&(e==="GET"?l=n:s={body:JSON.stringify(n)});const u=A0(Object.assign({key:t.config.apiKey},l)).slice(1),f=await t._getAdditionalHeaders();f["Content-Type"]="application/json",t.languageCode&&(f["X-Firebase-Locale"]=t.languageCode);const d=Object.assign({method:e,headers:f},s);return H3()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&Po(t.emulatorConfig.host)&&(d.credentials="include"),Lk.fetch()(await Pk(t,t.config.apiHost,r,u),d)})}async function Mk(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},RO),e);try{const a=new LO(t),s=await Promise.race([r(),a.promise]);a.clearNetworkTimeout();const l=await s.json();if("needConfirmation"in l)throw vd(t,"account-exists-with-different-credential",l);if(s.ok&&!("errorMessage"in l))return l;{const u=s.ok?l.errorMessage:l.error.message,[f,d]=u.split(" : ");if(f==="FEDERATED_USER_ID_ALREADY_LINKED")throw vd(t,"credential-already-in-use",l);if(f==="EMAIL_EXISTS")throw vd(t,"email-already-in-use",l);if(f==="USER_DISABLED")throw vd(t,"user-disabled",l);const m=n[f]||f.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw Fk(t,m,d);_i(t,m)}}catch(a){if(a instanceof Yi)throw a;_i(t,"network-request-failed",{message:String(a)})}}async function j0(t,e,r,n,a={}){const s=await Vo(t,e,r,n,a);return"mfaPendingCredential"in s&&_i(t,"multi-factor-auth-required",{_serverResponse:s}),s}async function Pk(t,e,r,n){const a=`${e}${r}?${n}`,s=t,l=s.config.emulator?gv(t.config,a):`${t.config.apiScheme}://${a}`;return DO.includes(r)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(l).toString():l}function FO(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class LO{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Wi(this.auth,"network-request-failed")),OO.get())})}}function vd(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const a=Wi(t,e,n);return a.customData._tokenResponse=r,a}function JE(t){return t!==void 0&&t.enterprise!==void 0}class MO{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return FO(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function PO(t,e){return Vo(t,"GET","/v2/recaptchaConfig",Bo(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jO(t,e){return Vo(t,"POST","/v1/accounts:delete",e)}async function nm(t,e){return Vo(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qf(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function UO(t,e=!1){const r=Sr(t),n=await r.getIdToken(e),a=xv(n);vt(a&&a.exp&&a.auth_time&&a.iat,r.auth,"internal-error");const s=typeof a.firebase=="object"?a.firebase:void 0,l=s==null?void 0:s.sign_in_provider;return{claims:a,token:n,authTime:qf(hx(a.auth_time)),issuedAtTime:qf(hx(a.iat)),expirationTime:qf(hx(a.exp)),signInProvider:l||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function hx(t){return Number(t)*1e3}function xv(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return Ud("JWT malformed, contained fewer than 3 sections"),null;try{const a=qb(r);return a?JSON.parse(a):(Ud("Failed to decode base64 JWT payload"),null)}catch(a){return Ud("Caught error parsing JWT payload as JSON",a==null?void 0:a.toString()),null}}function ZE(t){const e=xv(t);return vt(e,"internal-error"),vt(typeof e.exp<"u","internal-error"),vt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function c0(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof Yi&&BO(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function BO({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VO{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const a=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,a)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c1{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=qf(this.lastLoginAt),this.creationTime=qf(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function am(t){var e;const r=t.auth,n=await t.getIdToken(),a=await c0(t,nm(r,{idToken:n}));vt(a==null?void 0:a.users.length,r,"internal-error");const s=a.users[0];t._notifyReloadListener(s);const l=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?jk(s.providerUserInfo):[],u=HO(t.providerData,l),f=t.isAnonymous,d=!(t.email&&s.passwordHash)&&!(u!=null&&u.length),m=f?d:!1,y={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:u,metadata:new c1(s.createdAt,s.lastLoginAt),isAnonymous:m};Object.assign(t,y)}async function zO(t){const e=Sr(t);await am(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function HO(t,e){return[...t.filter(n=>!e.some(a=>a.providerId===n.providerId)),...e]}function jk(t){return t.map(e=>{var{providerId:r}=e,n=mv(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GO(t,e){const r=await Mk(t,{},async()=>{const n=A0({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:s}=t.config,l=await Pk(t,a,"/v1/token",`key=${s}`),u=await t._getAdditionalHeaders();u["Content-Type"]="application/x-www-form-urlencoded";const f={method:"POST",headers:u,body:n};return t.emulatorConfig&&Po(t.emulatorConfig.host)&&(f.credentials="include"),Lk.fetch()(l,f)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function qO(t,e){return Vo(t,"POST","/v2/accounts:revokeToken",Bo(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eu{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){vt(e.idToken,"internal-error"),vt(typeof e.idToken<"u","internal-error"),vt(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):ZE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){vt(e.length!==0,"internal-error");const r=ZE(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(vt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:a,expiresIn:s}=await GO(e,r);this.updateTokensAndExpiration(n,a,Number(s))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:a,expirationTime:s}=r,l=new eu;return n&&(vt(typeof n=="string","internal-error",{appName:e}),l.refreshToken=n),a&&(vt(typeof a=="string","internal-error",{appName:e}),l.accessToken=a),s&&(vt(typeof s=="number","internal-error",{appName:e}),l.expirationTime=s),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new eu,this.toJSON())}_performRefresh(){return _s("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ao(t,e){vt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class mi{constructor(e){var{uid:r,auth:n,stsTokenManager:a}=e,s=mv(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new VO(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new c1(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const r=await c0(this,this.stsTokenManager.getToken(this.auth,e));return vt(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return UO(this,e)}reload(){return zO(this)}_assign(e){this!==e&&(vt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new mi(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){vt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await am(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(La(this.auth.app))return Promise.reject(Ts(this.auth));const e=await this.getIdToken();return await c0(this,jO(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,a,s,l,u,f,d,m;const y=(n=r.displayName)!==null&&n!==void 0?n:void 0,_=(a=r.email)!==null&&a!==void 0?a:void 0,E=(s=r.phoneNumber)!==null&&s!==void 0?s:void 0,b=(l=r.photoURL)!==null&&l!==void 0?l:void 0,w=(u=r.tenantId)!==null&&u!==void 0?u:void 0,S=(f=r._redirectEventId)!==null&&f!==void 0?f:void 0,M=(d=r.createdAt)!==null&&d!==void 0?d:void 0,j=(m=r.lastLoginAt)!==null&&m!==void 0?m:void 0,{uid:F,emailVerified:G,isAnonymous:W,providerData:B,stsTokenManager:A}=r;vt(F&&A,e,"internal-error");const D=eu.fromJSON(this.name,A);vt(typeof F=="string",e,"internal-error"),ao(y,e.name),ao(_,e.name),vt(typeof G=="boolean",e,"internal-error"),vt(typeof W=="boolean",e,"internal-error"),ao(E,e.name),ao(b,e.name),ao(w,e.name),ao(S,e.name),ao(M,e.name),ao(j,e.name);const k=new mi({uid:F,auth:e,email:_,emailVerified:G,displayName:y,isAnonymous:W,photoURL:b,phoneNumber:E,tenantId:w,stsTokenManager:D,createdAt:M,lastLoginAt:j});return B&&Array.isArray(B)&&(k.providerData=B.map(O=>Object.assign({},O))),S&&(k._redirectEventId=S),k}static async _fromIdTokenResponse(e,r,n=!1){const a=new eu;a.updateFromServerResponse(r);const s=new mi({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:n});return await am(s),s}static async _fromGetAccountInfoResponse(e,r,n){const a=r.users[0];vt(a.localId!==void 0,"internal-error");const s=a.providerUserInfo!==void 0?jk(a.providerUserInfo):[],l=!(a.email&&a.passwordHash)&&!(s!=null&&s.length),u=new eu;u.updateFromIdToken(n);const f=new mi({uid:a.localId,auth:e,stsTokenManager:u,isAnonymous:l}),d={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:s,metadata:new c1(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!(s!=null&&s.length)};return Object.assign(f,d),f}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eT=new Map;function ws(t){Ns(t instanceof Function,"Expected a class definition");let e=eT.get(t);return e?(Ns(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,eT.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uk{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}Uk.type="NONE";const tT=Uk;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bd(t,e,r){return`firebase:${t}:${e}:${r}`}class tu{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:a,name:s}=this.auth;this.fullUserKey=Bd(this.userKey,a.apiKey,s),this.fullPersistenceKey=Bd("persistence",a.apiKey,s),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await nm(this.auth,{idToken:e}).catch(()=>{});return r?mi._fromGetAccountInfoResponse(this.auth,r,e):null}return mi._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new tu(ws(tT),e,n);const a=(await Promise.all(r.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let s=a[0]||ws(tT);const l=Bd(n,e.config.apiKey,e.name);let u=null;for(const d of r)try{const m=await d._get(l);if(m){let y;if(typeof m=="string"){const _=await nm(e,{idToken:m}).catch(()=>{});if(!_)break;y=await mi._fromGetAccountInfoResponse(e,_,m)}else y=mi._fromJSON(e,m);d!==s&&(u=y),s=d;break}}catch{}const f=a.filter(d=>d._shouldAllowMigration);return!s._shouldAllowMigration||!f.length?new tu(s,e,n):(s=f[0],u&&await s._set(l,u.toJSON()),await Promise.all(r.map(async d=>{if(d!==s)try{await d._remove(l)}catch{}})),new tu(s,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rT(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Hk(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Bk(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(qk(e))return"Blackberry";if(Wk(e))return"Webos";if(Vk(e))return"Safari";if((e.includes("chrome/")||zk(e))&&!e.includes("edge/"))return"Chrome";if(Gk(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function Bk(t=Zn()){return/firefox\//i.test(t)}function Vk(t=Zn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function zk(t=Zn()){return/crios\//i.test(t)}function Hk(t=Zn()){return/iemobile/i.test(t)}function Gk(t=Zn()){return/android/i.test(t)}function qk(t=Zn()){return/blackberry/i.test(t)}function Wk(t=Zn()){return/webos/i.test(t)}function vv(t=Zn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function WO(t=Zn()){var e;return vv(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function XO(){return W3()&&document.documentMode===10}function Xk(t=Zn()){return vv(t)||Gk(t)||Wk(t)||qk(t)||/windows phone/i.test(t)||Hk(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $k(t,e=[]){let r;switch(t){case"Browser":r=rT(Zn());break;case"Worker":r=`${rT(Zn())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Vl}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $O{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=s=>new Promise((l,u)=>{try{const f=e(s);l(f)}catch(f){u(f)}});n.onAbort=r,this.queue.push(n);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const a of r)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KO(t,e={}){return Vo(t,"GET","/v2/passwordPolicy",Bo(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YO=6;class QO{constructor(e){var r,n,a,s;const l=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=l.minPasswordLength)!==null&&r!==void 0?r:YO,l.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=l.maxPasswordLength),l.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=l.containsLowercaseCharacter),l.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=l.containsUppercaseCharacter),l.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=l.containsNumericCharacter),l.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=l.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(a=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&a!==void 0?a:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,a,s,l,u;const f={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,f),this.validatePasswordCharacterOptions(e,f),f.isValid&&(f.isValid=(r=f.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),f.isValid&&(f.isValid=(n=f.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),f.isValid&&(f.isValid=(a=f.containsLowercaseLetter)!==null&&a!==void 0?a:!0),f.isValid&&(f.isValid=(s=f.containsUppercaseLetter)!==null&&s!==void 0?s:!0),f.isValid&&(f.isValid=(l=f.containsNumericCharacter)!==null&&l!==void 0?l:!0),f.isValid&&(f.isValid=(u=f.containsNonAlphanumericCharacter)!==null&&u!==void 0?u:!0),f}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),a&&(r.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let a=0;a<e.length;a++)n=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,a,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JO{constructor(e,r,n,a){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new nT(this),this.idTokenSubscription=new nT(this),this.beforeStateQueue=new $O(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Ok,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=ws(r)),this._initializationPromise=this.queue(async()=>{var n,a,s;if(!this._deleted&&(this.persistenceManager=await tu.create(this,e),(n=this._resolvePersistenceManagerAvailable)===null||n===void 0||n.call(this),!this._deleted)){if(!((a=this._popupRedirectResolver)===null||a===void 0)&&a._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await nm(this,{idToken:e}),n=await mi._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(La(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(u,u))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let a=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,u=a==null?void 0:a._redirectEventId,f=await this.tryRedirectSignIn(e);(!l||l===u)&&(f!=null&&f.user)&&(a=f.user,s=!0)}if(!a)return this.directlySetCurrentUser(null);if(!a._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(a)}catch(l){a=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return a?this.reloadAndSetCurrentUserOrClear(a):this.directlySetCurrentUser(null)}return vt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===a._redirectEventId?this.directlySetCurrentUser(a):this.reloadAndSetCurrentUserOrClear(a)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await am(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=IO()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(La(this.app))return Promise.reject(Ts(this));const r=e?Sr(e):null;return r&&vt(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&vt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return La(this.app)?Promise.reject(Ts(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return La(this.app)?Promise.reject(Ts(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ws(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await KO(this),r=new QO(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new k0("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await qO(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&ws(e)||this._popupRedirectResolver;vt(r,this,"argument-error"),this.redirectPersistenceManager=await tu.create(this,[ws(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,a){if(this._deleted)return()=>{};const s=typeof r=="function"?r:r.next.bind(r);let l=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(vt(u,this,"internal-error"),u.then(()=>{l||s(this.currentUser)}),typeof r=="function"){const f=e.addObserver(r,n,a);return()=>{l=!0,f()}}else{const f=e.addObserver(r);return()=>{l=!0,f()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return vt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=$k(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const a=await this._getAppCheckToken();return a&&(r["X-Firebase-AppCheck"]=a),r}async _getAppCheckToken(){var e;if(La(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&AO(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function Gl(t){return Sr(t)}class nT{constructor(e){this.auth=e,this.observer=null,this.addObserver=eI(r=>this.observer=r)}get next(){return vt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Vm={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function ZO(t){Vm=t}function Kk(t){return Vm.loadJS(t)}function eF(){return Vm.recaptchaEnterpriseScript}function tF(){return Vm.gapiScript}function rF(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class nF{constructor(){this.enterprise=new aF}ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}class aF{ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}const iF="recaptcha-enterprise",Yk="NO_RECAPTCHA";class sF{constructor(e){this.type=iF,this.auth=Gl(e)}async verify(e="verify",r=!1){async function n(s){if(!r){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(l,u)=>{PO(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(f=>{if(f.recaptchaKey===void 0)u(new Error("recaptcha Enterprise site key undefined"));else{const d=new MO(f);return s.tenantId==null?s._agentRecaptchaConfig=d:s._tenantRecaptchaConfigs[s.tenantId]=d,l(d.siteKey)}}).catch(f=>{u(f)})})}function a(s,l,u){const f=window.grecaptcha;JE(f)?f.enterprise.ready(()=>{f.enterprise.execute(s,{action:e}).then(d=>{l(d)}).catch(()=>{l(Yk)})}):u(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new nF().execute("siteKey",{action:"verify"}):new Promise((s,l)=>{n(this.auth).then(u=>{if(!r&&JE(window.grecaptcha))a(u,s,l);else{if(typeof window>"u"){l(new Error("RecaptchaVerifier is only supported in browser"));return}let f=eF();f.length!==0&&(f+=u),Kk(f).then(()=>{a(u,s,l)}).catch(d=>{l(d)})}}).catch(u=>{l(u)})})}}async function aT(t,e,r,n=!1,a=!1){const s=new sF(t);let l;if(a)l=Yk;else try{l=await s.verify(r)}catch{l=await s.verify(r,!0)}const u=Object.assign({},e);if(r==="mfaSmsEnrollment"||r==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in u){const f=u.phoneEnrollmentInfo.phoneNumber,d=u.phoneEnrollmentInfo.recaptchaToken;Object.assign(u,{phoneEnrollmentInfo:{phoneNumber:f,recaptchaToken:d,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in u){const f=u.phoneSignInInfo.recaptchaToken;Object.assign(u,{phoneSignInInfo:{recaptchaToken:f,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return u}return n?Object.assign(u,{captchaResp:l}):Object.assign(u,{captchaResponse:l}),Object.assign(u,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(u,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),u}async function u1(t,e,r,n,a){var s;if(!((s=t._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const l=await aT(t,e,r,r==="getOobCode");return n(t,l)}else return n(t,e).catch(async l=>{if(l.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const u=await aT(t,e,r,r==="getOobCode");return n(t,u)}else return Promise.reject(l)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oF(t,e){const r=Tm(t,"auth");if(r.isInitialized()){const a=r.getImmediate(),s=r.getOptions();if(Cl(s,e??{}))return a;_i(a,"already-initialized")}return r.initialize({options:e})}function lF(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(ws);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function cF(t,e,r){const n=Gl(t);vt(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const a=!1,s=Qk(e),{host:l,port:u}=uF(e),f=u===null?"":`:${u}`,d={url:`${s}//${l}${f}/`},m=Object.freeze({host:l,port:u,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!n._canInitEmulator){vt(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),vt(Cl(d,n.config.emulator)&&Cl(m,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=d,n.emulatorConfig=m,n.settings.appVerificationDisabledForTesting=!0,Po(l)?(I1(`${s}//${l}${f}`),R1("Auth",!0)):fF()}function Qk(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function uF(t){const e=Qk(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(n);if(a){const s=a[1];return{host:s,port:iT(n.substr(s.length+1))}}else{const[s,l]=n.split(":");return{host:s,port:iT(l)}}}function iT(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function fF(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yv{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return _s("not implemented")}_getIdTokenResponse(e){return _s("not implemented")}_linkToIdToken(e,r){return _s("not implemented")}_getReauthenticationResolver(e){return _s("not implemented")}}async function hF(t,e){return Vo(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dF(t,e){return j0(t,"POST","/v1/accounts:signInWithPassword",Bo(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mF(t,e){return j0(t,"POST","/v1/accounts:signInWithEmailLink",Bo(t,e))}async function pF(t,e){return j0(t,"POST","/v1/accounts:signInWithEmailLink",Bo(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u0 extends yv{constructor(e,r,n,a=null){super("password",n),this._email=e,this._password=r,this._tenantId=a}static _fromEmailAndPassword(e,r){return new u0(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new u0(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r!=null&&r.email&&(r!=null&&r.password)){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return u1(e,r,"signInWithPassword",dF);case"emailLink":return mF(e,{email:this._email,oobCode:this._password});default:_i(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return u1(e,n,"signUpPassword",hF);case"emailLink":return pF(e,{idToken:r,email:this._email,oobCode:this._password});default:_i(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ru(t,e){return j0(t,"POST","/v1/accounts:signInWithIdp",Bo(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gF="http://localhost";class Dl extends yv{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Dl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):_i("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:a}=r,s=mv(r,["providerId","signInMethod"]);if(!n||!a)return null;const l=new Dl(n,a);return l.idToken=s.idToken||void 0,l.accessToken=s.accessToken||void 0,l.secret=s.secret,l.nonce=s.nonce,l.pendingToken=s.pendingToken||null,l}_getIdTokenResponse(e){const r=this.buildRequest();return ru(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,ru(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,ru(e,r)}buildRequest(){const e={requestUri:gF,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=A0(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xF(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function vF(t){const e=Rf(Df(t)).link,r=e?Rf(Df(e)).deep_link_id:null,n=Rf(Df(t)).deep_link_id;return(n?Rf(Df(n)).link:null)||n||r||e||t}class _v{constructor(e){var r,n,a,s,l,u;const f=Rf(Df(e)),d=(r=f.apiKey)!==null&&r!==void 0?r:null,m=(n=f.oobCode)!==null&&n!==void 0?n:null,y=xF((a=f.mode)!==null&&a!==void 0?a:null);vt(d&&m&&y,"argument-error"),this.apiKey=d,this.operation=y,this.code=m,this.continueUrl=(s=f.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(l=f.lang)!==null&&l!==void 0?l:null,this.tenantId=(u=f.tenantId)!==null&&u!==void 0?u:null}static parseLink(e){const r=vF(e);try{return new _v(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bu{constructor(){this.providerId=bu.PROVIDER_ID}static credential(e,r){return u0._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=_v.parseLink(r);return vt(n,"argument-error"),u0._fromEmailAndCode(e,n.code,n.tenantId)}}bu.PROVIDER_ID="password";bu.EMAIL_PASSWORD_SIGN_IN_METHOD="password";bu.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jk{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U0 extends Jk{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lo extends U0{constructor(){super("facebook.com")}static credential(e){return Dl._fromParams({providerId:lo.PROVIDER_ID,signInMethod:lo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return lo.credentialFromTaggedObject(e)}static credentialFromError(e){return lo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return lo.credential(e.oauthAccessToken)}catch{return null}}}lo.FACEBOOK_SIGN_IN_METHOD="facebook.com";lo.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class co extends U0{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Dl._fromParams({providerId:co.PROVIDER_ID,signInMethod:co.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return co.credentialFromTaggedObject(e)}static credentialFromError(e){return co.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return co.credential(r,n)}catch{return null}}}co.GOOGLE_SIGN_IN_METHOD="google.com";co.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uo extends U0{constructor(){super("github.com")}static credential(e){return Dl._fromParams({providerId:uo.PROVIDER_ID,signInMethod:uo.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return uo.credentialFromTaggedObject(e)}static credentialFromError(e){return uo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return uo.credential(e.oauthAccessToken)}catch{return null}}}uo.GITHUB_SIGN_IN_METHOD="github.com";uo.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fo extends U0{constructor(){super("twitter.com")}static credential(e,r){return Dl._fromParams({providerId:fo.PROVIDER_ID,signInMethod:fo.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return fo.credentialFromTaggedObject(e)}static credentialFromError(e){return fo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return fo.credential(r,n)}catch{return null}}}fo.TWITTER_SIGN_IN_METHOD="twitter.com";fo.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yF(t,e){return j0(t,"POST","/v1/accounts:signUp",Bo(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ol{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,a=!1){const s=await mi._fromIdTokenResponse(e,n,a),l=sT(n);return new Ol({user:s,providerId:l,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const a=sT(n);return new Ol({user:e,providerId:a,_tokenResponse:n,operationType:r})}}function sT(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class im extends Yi{constructor(e,r,n,a){var s;super(r.code,r.message),this.operationType=n,this.user=a,Object.setPrototypeOf(this,im.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,a){return new im(e,r,n,a)}}function Zk(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?im._fromErrorAndOperation(t,s,e,n):s})}async function _F(t,e,r=!1){const n=await c0(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Ol._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wF(t,e,r=!1){const{auth:n}=t;if(La(n.app))return Promise.reject(Ts(n));const a="reauthenticate";try{const s=await c0(t,Zk(n,a,e,t),r);vt(s.idToken,n,"internal-error");const l=xv(s.idToken);vt(l,n,"internal-error");const{sub:u}=l;return vt(t.uid===u,n,"user-mismatch"),Ol._forOperation(t,a,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&_i(n,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eA(t,e,r=!1){if(La(t.app))return Promise.reject(Ts(t));const n="signIn",a=await Zk(t,n,e),s=await Ol._fromIdTokenResponse(t,n,a);return r||await t._updateCurrentUser(s.user),s}async function EF(t,e){return eA(Gl(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tA(t){const e=Gl(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function TF(t,e,r){if(La(t.app))return Promise.reject(Ts(t));const n=Gl(t),l=await u1(n,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",yF).catch(f=>{throw f.code==="auth/password-does-not-meet-requirements"&&tA(t),f}),u=await Ol._fromIdTokenResponse(n,"signIn",l);return await n._updateCurrentUser(u.user),u}function bF(t,e,r){return La(t.app)?Promise.reject(Ts(t)):EF(Sr(t),bu.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&tA(t),n})}function SF(t,e,r,n){return Sr(t).onIdTokenChanged(e,r,n)}function kF(t,e,r){return Sr(t).beforeAuthStateChanged(e,r)}function AF(t,e,r,n){return Sr(t).onAuthStateChanged(e,r,n)}function f1(t){return Sr(t).signOut()}const sm="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rA{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(sm,"1"),this.storage.removeItem(sm),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CF=1e3,NF=10;class nA extends rA{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Xk(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),a=this.localCache[r];n!==a&&e(r,a,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((l,u,f)=>{this.notifyListeners(l,f)});return}const n=e.key;r?this.detachListener():this.stopPolling();const a=()=>{const l=this.storage.getItem(n);!r&&this.localCache[n]===l||this.notifyListeners(n,l)},s=this.storage.getItem(n);XO()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,NF):a()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},CF)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}nA.type="LOCAL";const IF=nA;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aA extends rA{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}aA.type="SESSION";const iA=aA;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RF(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zm{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(a=>a.isListeningto(e));if(r)return r;const n=new zm(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:a,data:s}=r.data,l=this.handlersMap[a];if(!(l!=null&&l.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:a});const u=Array.from(l).map(async d=>d(r.origin,s)),f=await RF(u);r.ports[0].postMessage({status:"done",eventId:n,eventType:a,response:f})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}zm.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wv(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DF{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let s,l;return new Promise((u,f)=>{const d=wv("",20);a.port1.start();const m=setTimeout(()=>{f(new Error("unsupported_event"))},n);l={messageChannel:a,onMessage(y){const _=y;if(_.data.eventId===d)switch(_.data.status){case"ack":clearTimeout(m),s=setTimeout(()=>{f(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),u(_.data.response);break;default:clearTimeout(m),clearTimeout(s),f(new Error("invalid_response"));break}}},this.handlers.add(l),a.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:e,eventId:d,data:r},[a.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xi(){return window}function OF(t){Xi().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sA(){return typeof Xi().WorkerGlobalScope<"u"&&typeof Xi().importScripts=="function"}async function FF(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function LF(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function MF(){return sA()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oA="firebaseLocalStorageDb",PF=1,om="firebaseLocalStorage",lA="fbase_key";class B0{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function Hm(t,e){return t.transaction([om],e?"readwrite":"readonly").objectStore(om)}function jF(){const t=indexedDB.deleteDatabase(oA);return new B0(t).toPromise()}function h1(){const t=indexedDB.open(oA,PF);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(om,{keyPath:lA})}catch(a){r(a)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(om)?e(n):(n.close(),await jF(),e(await h1()))})})}async function oT(t,e,r){const n=Hm(t,!0).put({[lA]:e,value:r});return new B0(n).toPromise()}async function UF(t,e){const r=Hm(t,!1).get(e),n=await new B0(r).toPromise();return n===void 0?null:n.value}function lT(t,e){const r=Hm(t,!0).delete(e);return new B0(r).toPromise()}const BF=800,VF=3;class cA{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await h1(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>VF)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return sA()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=zm._getInstance(MF()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await FF(),!this.activeServiceWorker)return;this.sender=new DF(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||LF()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await h1();return await oT(e,sm,"1"),await lT(e,sm),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>oT(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>UF(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>lT(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const s=Hm(a,!1).getAll();return new B0(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:a,value:s}of e)n.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(s)&&(this.notifyListeners(a,s),r.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!n.has(a)&&(this.notifyListeners(a,null),r.push(a));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),BF)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}cA.type="LOCAL";const zF=cA;new P0(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HF(t,e){return e?ws(e):(vt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ev extends yv{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ru(e,this._buildIdpRequest())}_linkToIdToken(e,r){return ru(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return ru(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function GF(t){return eA(t.auth,new Ev(t),t.bypassAuthState)}function qF(t){const{auth:e,user:r}=t;return vt(r,e,"internal-error"),wF(r,new Ev(t),t.bypassAuthState)}async function WF(t){const{auth:e,user:r}=t;return vt(r,e,"internal-error"),_F(r,new Ev(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uA{constructor(e,r,n,a,s=!1){this.auth=e,this.resolver=n,this.user=a,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:a,tenantId:s,error:l,type:u}=e;if(l){this.reject(l);return}const f={auth:this.auth,requestUri:r,sessionId:n,tenantId:s||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(f))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return GF;case"linkViaPopup":case"linkViaRedirect":return WF;case"reauthViaPopup":case"reauthViaRedirect":return qF;default:_i(this.auth,"internal-error")}}resolve(e){Ns(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ns(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XF=new P0(2e3,1e4);class $c extends uA{constructor(e,r,n,a,s){super(e,r,a,s),this.provider=n,this.authWindow=null,this.pollId=null,$c.currentPopupAction&&$c.currentPopupAction.cancel(),$c.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return vt(e,this.auth,"internal-error"),e}async onExecution(){Ns(this.filter.length===1,"Popup operations only handle one event");const e=wv();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Wi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Wi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,$c.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Wi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,XF.get())};e()}}$c.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $F="pendingRedirect",Vd=new Map;class KF extends uA{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=Vd.get(this.auth._key());if(!e){try{const n=await YF(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}Vd.set(this.auth._key(),e)}return this.bypassAuthState||Vd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function YF(t,e){const r=ZF(e),n=JF(t);if(!await n._isAvailable())return!1;const a=await n._get(r)==="true";return await n._remove(r),a}function QF(t,e){Vd.set(t._key(),e)}function JF(t){return ws(t._redirectPersistence)}function ZF(t){return Bd($F,t.config.apiKey,t.name)}async function e8(t,e,r=!1){if(La(t.app))return Promise.reject(Ts(t));const n=Gl(t),a=HF(n,e),l=await new KF(n,a,r).execute();return l&&!r&&(delete l.user._redirectEventId,await n._persistUserIfCurrent(l.user),await n._setRedirectUser(null,e)),l}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t8=10*60*1e3;class r8{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!n8(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!fA(e)){const a=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(Wi(this.auth,a))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=t8&&this.cachedEventUids.clear(),this.cachedEventUids.has(cT(e))}saveEventToCache(e){this.cachedEventUids.add(cT(e)),this.lastProcessedEventTime=Date.now()}}function cT(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function fA({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function n8(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return fA(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function a8(t,e={}){return Vo(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i8=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,s8=/^https?/;async function o8(t){if(t.config.emulator)return;const{authorizedDomains:e}=await a8(t);for(const r of e)try{if(l8(r))return}catch{}_i(t,"unauthorized-domain")}function l8(t){const e=l1(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const l=new URL(t);return l.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&l.hostname===n}if(!s8.test(r))return!1;if(i8.test(t))return n===t;const a=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c8=new P0(3e4,6e4);function uT(){const t=Xi().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function u8(t){return new Promise((e,r)=>{var n,a,s;function l(){uT(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{uT(),r(Wi(t,"network-request-failed"))},timeout:c8.get()})}if(!((a=(n=Xi().gapi)===null||n===void 0?void 0:n.iframes)===null||a===void 0)&&a.Iframe)e(gapi.iframes.getContext());else if(!((s=Xi().gapi)===null||s===void 0)&&s.load)l();else{const u=rF("iframefcb");return Xi()[u]=()=>{gapi.load?l():r(Wi(t,"network-request-failed"))},Kk(`${tF()}?onload=${u}`).catch(f=>r(f))}}).catch(e=>{throw zd=null,e})}let zd=null;function f8(t){return zd=zd||u8(t),zd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h8=new P0(5e3,15e3),d8="__/auth/iframe",m8="emulator/auth/iframe",p8={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},g8=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function x8(t){const e=t.config;vt(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?gv(e,m8):`https://${t.config.authDomain}/${d8}`,n={apiKey:e.apiKey,appName:t.name,v:Vl},a=g8.get(t.config.apiHost);a&&(n.eid=a);const s=t._getFrameworks();return s.length&&(n.fw=s.join(",")),`${r}?${A0(n).slice(1)}`}async function v8(t){const e=await f8(t),r=Xi().gapi;return vt(r,t,"internal-error"),e.open({where:document.body,url:x8(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:p8,dontclear:!0},n=>new Promise(async(a,s)=>{await n.restyle({setHideOnLeave:!1});const l=Wi(t,"network-request-failed"),u=Xi().setTimeout(()=>{s(l)},h8.get());function f(){Xi().clearTimeout(u),a(n)}n.ping(f).then(f,()=>{s(l)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y8={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},_8=500,w8=600,E8="_blank",T8="http://localhost";class fT{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function b8(t,e,r,n=_8,a=w8){const s=Math.max((window.screen.availHeight-a)/2,0).toString(),l=Math.max((window.screen.availWidth-n)/2,0).toString();let u="";const f=Object.assign(Object.assign({},y8),{width:n.toString(),height:a.toString(),top:s,left:l}),d=Zn().toLowerCase();r&&(u=zk(d)?E8:r),Bk(d)&&(e=e||T8,f.scrollbars="yes");const m=Object.entries(f).reduce((_,[E,b])=>`${_}${E}=${b},`,"");if(WO(d)&&u!=="_self")return S8(e||"",u),new fT(null);const y=window.open(e||"",u,m);vt(y,t,"popup-blocked");try{y.focus()}catch{}return new fT(y)}function S8(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k8="__/auth/handler",A8="emulator/auth/handler",C8=encodeURIComponent("fac");async function hT(t,e,r,n,a,s){vt(t.config.authDomain,t,"auth-domain-config-required"),vt(t.config.apiKey,t,"invalid-api-key");const l={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Vl,eventId:a};if(e instanceof Jk){e.setDefaultLanguage(t.languageCode),l.providerId=e.providerId||"",Z3(e.getCustomParameters())||(l.customParameters=JSON.stringify(e.getCustomParameters()));for(const[m,y]of Object.entries({}))l[m]=y}if(e instanceof U0){const m=e.getScopes().filter(y=>y!=="");m.length>0&&(l.scopes=m.join(","))}t.tenantId&&(l.tid=t.tenantId);const u=l;for(const m of Object.keys(u))u[m]===void 0&&delete u[m];const f=await t._getAppCheckToken(),d=f?`#${C8}=${encodeURIComponent(f)}`:"";return`${N8(t)}?${A0(u).slice(1)}${d}`}function N8({config:t}){return t.emulator?gv(t,A8):`https://${t.authDomain}/${k8}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dx="webStorageSupport";class I8{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=iA,this._completeRedirectFn=e8,this._overrideRedirectResult=QF}async _openPopup(e,r,n,a){var s;Ns((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const l=await hT(e,r,n,l1(),a);return b8(e,l,wv())}async _openRedirect(e,r,n,a){await this._originValidation(e);const s=await hT(e,r,n,l1(),a);return OF(s),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:a,promise:s}=this.eventManagers[r];return a?Promise.resolve(a):(Ns(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await v8(e),n=new r8(e);return r.register("authEvent",a=>(vt(a==null?void 0:a.authEvent,e,"invalid-auth-event"),{status:n.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(dx,{type:dx},a=>{var s;const l=(s=a==null?void 0:a[0])===null||s===void 0?void 0:s[dx];l!==void 0&&r(!!l),_i(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=o8(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return Xk()||Vk()||vv()}}const R8=I8;var dT="@firebase/auth",mT="1.10.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D8{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){vt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O8(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function F8(t){Nl(new bo("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:l,authDomain:u}=n.options;vt(l&&!l.includes(":"),"invalid-api-key",{appName:n.name});const f={apiKey:l,authDomain:u,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:$k(t)},d=new JO(n,a,s,f);return lF(d,r),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),Nl(new bo("auth-internal",e=>{const r=Gl(e.getProvider("auth").getImmediate());return(n=>new D8(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Vi(dT,mT,O8(t)),Vi(dT,mT,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L8=5*60,M8=Kb("authIdTokenMaxAge")||L8;let pT=null;const P8=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>M8)return;const a=r==null?void 0:r.token;pT!==a&&(pT=a,await fetch(t,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function hA(t=L1()){const e=Tm(t,"auth");if(e.isInitialized())return e.getImmediate();const r=oF(t,{popupRedirectResolver:R8,persistence:[zF,IF,iA]}),n=Kb("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(n,location.origin);if(location.origin===s.origin){const l=P8(s.toString());kF(r,l,()=>l(r.currentUser)),SF(r,u=>l(u))}}const a=Wb("auth");return a&&cF(r,`http://${a}`),r}function j8(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}ZO({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=a=>{const s=Wi("internal-error");s.customData=a,r(s)},n.type="text/javascript",n.charset="UTF-8",j8().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});F8("Browser");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dA="firebasestorage.googleapis.com",mA="storageBucket",U8=2*60*1e3,B8=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xr extends Yi{constructor(e,r,n=0){super(mx(e),`Firebase Storage: ${r} (${mx(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Xr.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return mx(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var qr;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(qr||(qr={}));function mx(t){return"storage/"+t}function Tv(){const t="An unknown error occurred, please check the error payload for server response.";return new Xr(qr.UNKNOWN,t)}function V8(t){return new Xr(qr.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function z8(t){return new Xr(qr.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function H8(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Xr(qr.UNAUTHENTICATED,t)}function G8(){return new Xr(qr.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function q8(t){return new Xr(qr.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function W8(){return new Xr(qr.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function X8(){return new Xr(qr.CANCELED,"User canceled the upload/download.")}function $8(t){return new Xr(qr.INVALID_URL,"Invalid URL '"+t+"'.")}function K8(t){return new Xr(qr.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function Y8(){return new Xr(qr.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+mA+"' property when initializing the app?")}function Q8(){return new Xr(qr.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function J8(){return new Xr(qr.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function Z8(t){return new Xr(qr.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function d1(t){return new Xr(qr.INVALID_ARGUMENT,t)}function pA(){return new Xr(qr.APP_DELETED,"The Firebase app was deleted.")}function e5(t){return new Xr(qr.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Wf(t,e){return new Xr(qr.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function Cf(t){throw new Xr(qr.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ua{constructor(e,r){this.bucket=e,this.path_=r}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,r){let n;try{n=Ua.makeFromUrl(e,r)}catch{return new Ua(e,"")}if(n.path==="")return n;throw K8(e)}static makeFromUrl(e,r){let n=null;const a="([A-Za-z0-9.\\-_]+)";function s(G){G.path.charAt(G.path.length-1)==="/"&&(G.path_=G.path_.slice(0,-1))}const l="(/(.*))?$",u=new RegExp("^gs://"+a+l,"i"),f={bucket:1,path:3};function d(G){G.path_=decodeURIComponent(G.path)}const m="v[A-Za-z0-9_]+",y=r.replace(/[.]/g,"\\."),_="(/([^?#]*).*)?$",E=new RegExp(`^https?://${y}/${m}/b/${a}/o${_}`,"i"),b={bucket:1,path:3},w=r===dA?"(?:storage.googleapis.com|storage.cloud.google.com)":r,S="([^?#]*)",M=new RegExp(`^https?://${w}/${a}/${S}`,"i"),F=[{regex:u,indices:f,postModify:s},{regex:E,indices:b,postModify:d},{regex:M,indices:{bucket:1,path:2},postModify:d}];for(let G=0;G<F.length;G++){const W=F[G],B=W.regex.exec(e);if(B){const A=B[W.indices.bucket];let D=B[W.indices.path];D||(D=""),n=new Ua(A,D),W.postModify(n);break}}if(n==null)throw $8(e);return n}}class t5{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r5(t,e,r){let n=1,a=null,s=null,l=!1,u=0;function f(){return u===2}let d=!1;function m(...S){d||(d=!0,e.apply(null,S))}function y(S){a=setTimeout(()=>{a=null,t(E,f())},S)}function _(){s&&clearTimeout(s)}function E(S,...M){if(d){_();return}if(S){_(),m.call(null,S,...M);return}if(f()||l){_(),m.call(null,S,...M);return}n<64&&(n*=2);let F;u===1?(u=2,F=0):F=(n+Math.random())*1e3,y(F)}let b=!1;function w(S){b||(b=!0,_(),!d&&(a!==null?(S||(u=2),clearTimeout(a),y(0)):S||(u=1)))}return y(0),s=setTimeout(()=>{l=!0,w(!0)},r),w}function n5(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a5(t){return t!==void 0}function i5(t){return typeof t=="object"&&!Array.isArray(t)}function bv(t){return typeof t=="string"||t instanceof String}function gT(t){return Sv()&&t instanceof Blob}function Sv(){return typeof Blob<"u"}function xT(t,e,r,n){if(n<e)throw d1(`Invalid value for '${t}'. Expected ${e} or greater.`);if(n>r)throw d1(`Invalid value for '${t}'. Expected ${r} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V0(t,e,r){let n=e;return r==null&&(n=`https://${e}`),`${r}://${n}/v0${t}`}function gA(t){const e=encodeURIComponent;let r="?";for(const n in t)if(t.hasOwnProperty(n)){const a=e(n)+"="+e(t[n]);r=r+a+"&"}return r=r.slice(0,-1),r}var wl;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(wl||(wl={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s5(t,e){const r=t>=500&&t<600,a=[408,429].indexOf(t)!==-1,s=e.indexOf(t)!==-1;return r||a||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o5{constructor(e,r,n,a,s,l,u,f,d,m,y,_=!0,E=!1){this.url_=e,this.method_=r,this.headers_=n,this.body_=a,this.successCodes_=s,this.additionalRetryCodes_=l,this.callback_=u,this.errorCallback_=f,this.timeout_=d,this.progressCallback_=m,this.connectionFactory_=y,this.retry=_,this.isUsingEmulator=E,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((b,w)=>{this.resolve_=b,this.reject_=w,this.start_()})}start_(){const e=(n,a)=>{if(a){n(!1,new yd(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const l=u=>{const f=u.loaded,d=u.lengthComputable?u.total:-1;this.progressCallback_!==null&&this.progressCallback_(f,d)};this.progressCallback_!==null&&s.addUploadProgressListener(l),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(l),this.pendingConnection_=null;const u=s.getErrorCode()===wl.NO_ERROR,f=s.getStatus();if(!u||s5(f,this.additionalRetryCodes_)&&this.retry){const m=s.getErrorCode()===wl.ABORT;n(!1,new yd(!1,null,m));return}const d=this.successCodes_.indexOf(f)!==-1;n(!0,new yd(d,s))})},r=(n,a)=>{const s=this.resolve_,l=this.reject_,u=a.connection;if(a.wasSuccessCode)try{const f=this.callback_(u,u.getResponse());a5(f)?s(f):s()}catch(f){l(f)}else if(u!==null){const f=Tv();f.serverResponse=u.getErrorText(),this.errorCallback_?l(this.errorCallback_(u,f)):l(f)}else if(a.canceled){const f=this.appDelete_?pA():X8();l(f)}else{const f=W8();l(f)}};this.canceled_?r(!1,new yd(!1,null,!0)):this.backoffId_=r5(e,r,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&n5(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class yd{constructor(e,r,n){this.wasSuccessCode=e,this.connection=r,this.canceled=!!n}}function l5(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function c5(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function u5(t,e){e&&(t["X-Firebase-GMPID"]=e)}function f5(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function h5(t,e,r,n,a,s,l=!0,u=!1){const f=gA(t.urlParams),d=t.url+f,m=Object.assign({},t.headers);return u5(m,e),l5(m,r),c5(m,s),f5(m,n),new o5(d,t.method,m,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,a,l,u)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d5(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function m5(...t){const e=d5();if(e!==void 0){const r=new e;for(let n=0;n<t.length;n++)r.append(t[n]);return r.getBlob()}else{if(Sv())return new Blob(t);throw new Xr(qr.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function p5(t,e,r){return t.webkitSlice?t.webkitSlice(e,r):t.mozSlice?t.mozSlice(e,r):t.slice?t.slice(e,r):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g5(t){if(typeof atob>"u")throw Z8("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ui={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class px{constructor(e,r){this.data=e,this.contentType=r||null}}function x5(t,e){switch(t){case Ui.RAW:return new px(xA(e));case Ui.BASE64:case Ui.BASE64URL:return new px(vA(t,e));case Ui.DATA_URL:return new px(y5(e),_5(e))}throw Tv()}function xA(t){const e=[];for(let r=0;r<t.length;r++){let n=t.charCodeAt(r);if(n<=127)e.push(n);else if(n<=2047)e.push(192|n>>6,128|n&63);else if((n&64512)===55296)if(!(r<t.length-1&&(t.charCodeAt(r+1)&64512)===56320))e.push(239,191,189);else{const s=n,l=t.charCodeAt(++r);n=65536|(s&1023)<<10|l&1023,e.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|n&63)}else(n&64512)===56320?e.push(239,191,189):e.push(224|n>>12,128|n>>6&63,128|n&63)}return new Uint8Array(e)}function v5(t){let e;try{e=decodeURIComponent(t)}catch{throw Wf(Ui.DATA_URL,"Malformed data URL.")}return xA(e)}function vA(t,e){switch(t){case Ui.BASE64:{const a=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(a||s)throw Wf(t,"Invalid character '"+(a?"-":"_")+"' found: is it base64url encoded?");break}case Ui.BASE64URL:{const a=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(a||s)throw Wf(t,"Invalid character '"+(a?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let r;try{r=g5(e)}catch(a){throw a.message.includes("polyfill")?a:Wf(t,"Invalid character found")}const n=new Uint8Array(r.length);for(let a=0;a<r.length;a++)n[a]=r.charCodeAt(a);return n}class yA{constructor(e){this.base64=!1,this.contentType=null;const r=e.match(/^data:([^,]+)?,/);if(r===null)throw Wf(Ui.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=r[1]||null;n!=null&&(this.base64=w5(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=e.substring(e.indexOf(",")+1)}}function y5(t){const e=new yA(t);return e.base64?vA(Ui.BASE64,e.rest):v5(e.rest)}function _5(t){return new yA(t).contentType}function w5(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ho{constructor(e,r){let n=0,a="";gT(e)?(this.data_=e,n=e.size,a=e.type):e instanceof ArrayBuffer?(r?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(r?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=a}size(){return this.size_}type(){return this.type_}slice(e,r){if(gT(this.data_)){const n=this.data_,a=p5(n,e,r);return a===null?null:new ho(a)}else{const n=new Uint8Array(this.data_.buffer,e,r-e);return new ho(n,!0)}}static getBlob(...e){if(Sv()){const r=e.map(n=>n instanceof ho?n.data_:n);return new ho(m5.apply(null,r))}else{const r=e.map(l=>bv(l)?x5(Ui.RAW,l).data:l.data_);let n=0;r.forEach(l=>{n+=l.byteLength});const a=new Uint8Array(n);let s=0;return r.forEach(l=>{for(let u=0;u<l.length;u++)a[s++]=l[u]}),new ho(a,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _A(t){let e;try{e=JSON.parse(t)}catch{return null}return i5(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E5(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function T5(t,e){const r=e.split("/").filter(n=>n.length>0).join("/");return t.length===0?r:t+"/"+r}function wA(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b5(t,e){return e}class oa{constructor(e,r,n,a){this.server=e,this.local=r||e,this.writable=!!n,this.xform=a||b5}}let _d=null;function S5(t){return!bv(t)||t.length<2?t:wA(t)}function kv(){if(_d)return _d;const t=[];t.push(new oa("bucket")),t.push(new oa("generation")),t.push(new oa("metageneration")),t.push(new oa("name","fullPath",!0));function e(s,l){return S5(l)}const r=new oa("name");r.xform=e,t.push(r);function n(s,l){return l!==void 0?Number(l):l}const a=new oa("size");return a.xform=n,t.push(a),t.push(new oa("timeCreated")),t.push(new oa("updated")),t.push(new oa("md5Hash",null,!0)),t.push(new oa("cacheControl",null,!0)),t.push(new oa("contentDisposition",null,!0)),t.push(new oa("contentEncoding",null,!0)),t.push(new oa("contentLanguage",null,!0)),t.push(new oa("contentType",null,!0)),t.push(new oa("metadata","customMetadata",!0)),_d=t,_d}function k5(t,e){function r(){const n=t.bucket,a=t.fullPath,s=new Ua(n,a);return e._makeStorageReference(s)}Object.defineProperty(t,"ref",{get:r})}function A5(t,e,r){const n={};n.type="file";const a=r.length;for(let s=0;s<a;s++){const l=r[s];n[l.local]=l.xform(n,e[l.server])}return k5(n,t),n}function EA(t,e,r){const n=_A(e);return n===null?null:A5(t,n,r)}function C5(t,e,r,n){const a=_A(e);if(a===null||!bv(a.downloadTokens))return null;const s=a.downloadTokens;if(s.length===0)return null;const l=encodeURIComponent;return s.split(",").map(d=>{const m=t.bucket,y=t.fullPath,_="/b/"+l(m)+"/o/"+l(y),E=V0(_,r,n),b=gA({alt:"media",token:d});return E+b})[0]}function N5(t,e){const r={},n=e.length;for(let a=0;a<n;a++){const s=e[a];s.writable&&(r[s.server]=t[s.local])}return JSON.stringify(r)}class Gm{constructor(e,r,n,a){this.url=e,this.method=r,this.handler=n,this.timeout=a,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TA(t){if(!t)throw Tv()}function bA(t,e){function r(n,a){const s=EA(t,a,e);return TA(s!==null),s}return r}function I5(t,e){function r(n,a){const s=EA(t,a,e);return TA(s!==null),C5(s,a,t.host,t._protocol)}return r}function SA(t){function e(r,n){let a;return r.getStatus()===401?r.getErrorText().includes("Firebase App Check token is invalid")?a=G8():a=H8():r.getStatus()===402?a=z8(t.bucket):r.getStatus()===403?a=q8(t.path):a=n,a.status=r.getStatus(),a.serverResponse=n.serverResponse,a}return e}function Av(t){const e=SA(t);function r(n,a){let s=e(n,a);return n.getStatus()===404&&(s=V8(t.path)),s.serverResponse=a.serverResponse,s}return r}function R5(t,e,r){const n=e.fullServerUrl(),a=V0(n,t.host,t._protocol),s="GET",l=t.maxOperationRetryTime,u=new Gm(a,s,bA(t,r),l);return u.errorHandler=Av(e),u}function D5(t,e,r){const n=e.fullServerUrl(),a=V0(n,t.host,t._protocol),s="GET",l=t.maxOperationRetryTime,u=new Gm(a,s,I5(t,r),l);return u.errorHandler=Av(e),u}function O5(t,e){const r=e.fullServerUrl(),n=V0(r,t.host,t._protocol),a="DELETE",s=t.maxOperationRetryTime;function l(f,d){}const u=new Gm(n,a,l,s);return u.successCodes=[200,204],u.errorHandler=Av(e),u}function F5(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function L5(t,e,r){const n=Object.assign({},r);return n.fullPath=t.path,n.size=e.size(),n.contentType||(n.contentType=F5(null,e)),n}function M5(t,e,r,n,a){const s=e.bucketOnlyServerUrl(),l={"X-Goog-Upload-Protocol":"multipart"};function u(){let F="";for(let G=0;G<2;G++)F=F+Math.random().toString().slice(2);return F}const f=u();l["Content-Type"]="multipart/related; boundary="+f;const d=L5(e,n,a),m=N5(d,r),y="--"+f+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+m+`\r
--`+f+`\r
Content-Type: `+d.contentType+`\r
\r
`,_=`\r
--`+f+"--",E=ho.getBlob(y,n,_);if(E===null)throw Q8();const b={name:d.fullPath},w=V0(s,t.host,t._protocol),S="POST",M=t.maxUploadRetryTime,j=new Gm(w,S,bA(t,r),M);return j.urlParams=b,j.headers=l,j.body=E.uploadData(),j.errorHandler=SA(e),j}class P5{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=wl.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=wl.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=wl.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,r,n,a,s){if(this.sent_)throw Cf("cannot .send() more than once");if(Po(e)&&n&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(r,e,!0),s!==void 0)for(const l in s)s.hasOwnProperty(l)&&this.xhr_.setRequestHeader(l,s[l].toString());return a!==void 0?this.xhr_.send(a):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Cf("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Cf("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Cf("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Cf("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class j5 extends P5{initXhr(){this.xhr_.responseType="text"}}function qm(){return new j5}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fl{constructor(e,r){this._service=e,r instanceof Ua?this._location=r:this._location=Ua.makeFromUrl(r,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,r){return new Fl(e,r)}get root(){const e=new Ua(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return wA(this._location.path)}get storage(){return this._service}get parent(){const e=E5(this._location.path);if(e===null)return null;const r=new Ua(this._location.bucket,e);return new Fl(this._service,r)}_throwIfRoot(e){if(this._location.path==="")throw e5(e)}}function U5(t,e,r){t._throwIfRoot("uploadBytes");const n=M5(t.storage,t._location,kv(),new ho(e,!0),r);return t.storage.makeRequestWithTokens(n,qm).then(a=>({metadata:a,ref:t}))}function B5(t){t._throwIfRoot("getMetadata");const e=R5(t.storage,t._location,kv());return t.storage.makeRequestWithTokens(e,qm)}function V5(t){t._throwIfRoot("getDownloadURL");const e=D5(t.storage,t._location,kv());return t.storage.makeRequestWithTokens(e,qm).then(r=>{if(r===null)throw J8();return r})}function z5(t){t._throwIfRoot("deleteObject");const e=O5(t.storage,t._location);return t.storage.makeRequestWithTokens(e,qm)}function H5(t,e){const r=T5(t._location.path,e),n=new Ua(t._location.bucket,r);return new Fl(t.storage,n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G5(t){return/^[A-Za-z]+:\/\//.test(t)}function q5(t,e){return new Fl(t,e)}function kA(t,e){if(t instanceof Cv){const r=t;if(r._bucket==null)throw Y8();const n=new Fl(r,r._bucket);return e!=null?kA(n,e):n}else return e!==void 0?H5(t,e):t}function W5(t,e){if(e&&G5(e)){if(t instanceof Cv)return q5(t,e);throw d1("To use ref(service, url), the first argument must be a Storage instance.")}else return kA(t,e)}function vT(t,e){const r=e==null?void 0:e[mA];return r==null?null:Ua.makeFromBucketSpec(r,t)}function X5(t,e,r,n={}){t.host=`${e}:${r}`;const a=Po(e);a&&(I1(`https://${t.host}/b`),R1("Storage",!0)),t._isUsingEmulator=!0,t._protocol=a?"https":"http";const{mockUserToken:s}=n;s&&(t._overrideAuthToken=typeof s=="string"?s:Yb(s,t.app.options.projectId))}class Cv{constructor(e,r,n,a,s,l=!1){this.app=e,this._authProvider=r,this._appCheckProvider=n,this._url=a,this._firebaseVersion=s,this._isUsingEmulator=l,this._bucket=null,this._host=dA,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=U8,this._maxUploadRetryTime=B8,this._requests=new Set,a!=null?this._bucket=Ua.makeFromBucketSpec(a,this._host):this._bucket=vT(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Ua.makeFromBucketSpec(this._url,e):this._bucket=vT(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){xT("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){xT("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const r=await e.getToken();if(r!==null)return r.accessToken}return null}async _getAppCheckToken(){if(La(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Fl(this,e)}_makeRequest(e,r,n,a,s=!0){if(this._deleted)return new t5(pA());{const l=h5(e,this._appId,n,a,r,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(l),l.getPromise().then(()=>this._requests.delete(l),()=>this._requests.delete(l)),l}}async makeRequestWithTokens(e,r){const[n,a]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,r,n,a).getPromise()}}const yT="@firebase/storage",_T="0.13.14";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AA="storage";function Nv(t,e,r){return t=Sr(t),U5(t,e,r)}function $5(t){return t=Sr(t),B5(t)}function Iv(t){return t=Sr(t),V5(t)}function CA(t){return t=Sr(t),z5(t)}function nu(t,e){return t=Sr(t),W5(t,e)}function K5(t=L1(),e){t=Sr(t);const n=Tm(t,AA).getImmediate({identifier:e}),a=Xb("storage");return a&&Y5(n,...a),n}function Y5(t,e,r,n={}){X5(t,e,r,n)}function Q5(t,{instanceIdentifier:e}){const r=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),a=t.getProvider("app-check-internal");return new Cv(r,n,a,e,Vl)}function J5(){Nl(new bo(AA,Q5,"PUBLIC").setMultipleInstances(!0)),Vi(yT,_T,""),Vi(yT,_T,"esm2017")}J5();const NA={apiKey:"AIzaSyA1pcLUIXvnOO3Zgn9FQ5J02nOkjVpxYXU",authDomain:"licencas-a47f9.firebaseapp.com",projectId:"licencas-a47f9",storageBucket:"licencas-a47f9.firebasestorage.app",messagingSenderId:"738531068737",appId:"1:738531068737:web:0cc6a20e42a7e118e72fc0",measurementId:"G-JGXM1WF3P4"},Rv=F1(NA),kr=fO(Rv),Mf=hA(Rv),au=K5(Rv),El=({className:t="h-6 w-6"})=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})}),Tl=({className:t="h-5 w-5"})=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),To=({className:t="h-5 w-5"})=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),IA=({className:t="h-6 w-6"})=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2a1 1 0 01-.293.707l-6.414 6.414A1 1 0 0013 13.414V19a1 1 0 01-1.447.894l-4-2A1 1 0 017 17v-3.586a1 1 0 00-.293-.707L3.293 6.707A1 1 0 013 6V4z"})}),RA=({className:t="h-6 w-6"})=>x.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 17v2a2 2 0 002 2h12a2 2 0 002-2v-2"}),x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 12l4-4m0 0l4 4m-4-4v9"})]}),Z5=({className:t="h-6 w-6"})=>x.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[x.jsx("rect",{x:"3",y:"4",width:"4",height:"16",rx:"1"}),x.jsx("rect",{x:"9",y:"4",width:"4",height:"16",rx:"1"}),x.jsx("rect",{x:"15",y:"4",width:"4",height:"16",rx:"1"})]});/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var lm={};lm.version="0.18.5";var DA=1252,eL=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Dv={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Ov=function(t){eL.indexOf(t)!=-1&&(DA=Dv[0]=t)};function tL(){Ov(1252)}var pi=function(t){Ov(t)};function Fv(){pi(1200),tL()}function wT(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function rL(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function OA(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var Pf=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?rL(t.slice(2)):e==254&&r==255?OA(t.slice(2)):e==65279?t.slice(1):t},wd=function(e){return String.fromCharCode(e)},ET=function(e){return String.fromCharCode(e)},f0,po="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function h0(t){for(var e="",r=0,n=0,a=0,s=0,l=0,u=0,f=0,d=0;d<t.length;)r=t.charCodeAt(d++),s=r>>2,n=t.charCodeAt(d++),l=(r&3)<<4|n>>4,a=t.charCodeAt(d++),u=(n&15)<<2|a>>6,f=a&63,isNaN(n)?u=f=64:isNaN(a)&&(f=64),e+=po.charAt(s)+po.charAt(l)+po.charAt(u)+po.charAt(f);return e}function Ba(t){var e="",r=0,n=0,a=0,s=0,l=0,u=0,f=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<t.length;)s=po.indexOf(t.charAt(d++)),l=po.indexOf(t.charAt(d++)),r=s<<2|l>>4,e+=String.fromCharCode(r),u=po.indexOf(t.charAt(d++)),n=(l&15)<<4|u>>2,u!==64&&(e+=String.fromCharCode(n)),f=po.indexOf(t.charAt(d++)),a=(u&3)<<6|f,f!==64&&(e+=String.fromCharCode(a));return e}var Mt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ds=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Oo(t){return Mt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function TT(t){return Mt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Ma=function(e){return Mt?Ds(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Wm(t){if(typeof ArrayBuffer>"u")return Ma(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function zo(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function nL(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function Lv(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return Lv(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var Nn=Mt?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Ds(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),a=0;for(e=0,r=0;e<t.length;r+=a,++e)if(a=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function aL(t){for(var e=[],r=0,n=t.length+250,a=Oo(t.length+255),s=0;s<t.length;++s){var l=t.charCodeAt(s);if(l<128)a[r++]=l;else if(l<2048)a[r++]=192|l>>6&31,a[r++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var u=t.charCodeAt(++s)&1023;a[r++]=240|l>>8&7,a[r++]=128|l>>2&63,a[r++]=128|u>>6&15|(l&3)<<4,a[r++]=128|u&63}else a[r++]=224|l>>12&15,a[r++]=128|l>>6&63,a[r++]=128|l&63;r>n&&(e.push(a.slice(0,r)),r=0,a=Oo(65535),n=65530)}return e.push(a.slice(0,r)),Nn(e)}var ha=/\u0000/g,jf=/[\u0001-\u0006]/g;function iu(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function gi(t,e){var r=""+t;return r.length>=e?r:zr("0",e-r.length)+r}function Mv(t,e){var r=""+t;return r.length>=e?r:zr(" ",e-r.length)+r}function cm(t,e){var r=""+t;return r.length>=e?r:r+zr(" ",e-r.length)}function iL(t,e){var r=""+Math.round(t);return r.length>=e?r:zr("0",e-r.length)+r}function sL(t,e){var r=""+t;return r.length>=e?r:zr("0",e-r.length)+r}var bT=Math.pow(2,32);function Uc(t,e){if(t>bT||t<-bT)return iL(t,e);var r=Math.round(t);return sL(r,e)}function um(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var ST=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],gx=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function oL(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var mt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},kT={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},lL={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function fm(t,e,r){for(var n=t<0?-1:1,a=t*n,s=0,l=1,u=0,f=1,d=0,m=0,y=Math.floor(a);d<e&&(y=Math.floor(a),u=y*l+s,m=y*d+f,!(a-y<5e-8));)a=1/(a-y),s=l,l=u,f=d,d=m;if(m>e&&(d>e?(m=f,u=s):(m=d,u=l)),!r)return[0,n*u,m];var _=Math.floor(n*u/m);return[_,n*u-_*m,m]}function go(t,e,r){if(t>2958465||t<0)return null;var n=t|0,a=Math.floor(86400*(t-n)),s=0,l=[],u={D:n,T:a,u:86400*(t-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),e&&e.date1904&&(n+=1462),u.u>.9999&&(u.u=0,++a==86400&&(u.T=a=0,++n,++u.D)),n===60)l=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)l=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var f=new Date(1900,0,1);f.setDate(f.getDate()+n-1),l=[f.getFullYear(),f.getMonth()+1,f.getDate()],s=f.getDay(),n<60&&(s=(s+6)%7),r&&(s=mL(f,l))}return u.y=l[0],u.m=l[1],u.d=l[2],u.S=a%60,a=Math.floor(a/60),u.M=a%60,a=Math.floor(a/60),u.H=a,u.q=s,u}var FA=new Date(1899,11,31,0,0,0),cL=FA.getTime(),uL=new Date(1900,2,1,0,0,0);function LA(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=uL&&(r+=24*60*60*1e3),(r-(cL+(t.getTimezoneOffset()-FA.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Pv(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function fL(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function hL(t){var e=t<0?12:11,r=Pv(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function dL(t){var e=Pv(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function d0(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=hL(t):e===10?r=t.toFixed(10).substr(0,12):r=dL(t),Pv(fL(r.toUpperCase()))}function Ll(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):d0(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Va(14,LA(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function mL(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function pL(t,e,r,n){var a="",s=0,l=0,u=r.y,f,d=0;switch(t){case 98:u=r.y+543;case 121:switch(e.length){case 1:case 2:f=u%100,d=2;break;default:f=u%1e4,d=4;break}break;case 109:switch(e.length){case 1:case 2:f=r.m,d=e.length;break;case 3:return gx[r.m-1][1];case 5:return gx[r.m-1][0];default:return gx[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:f=r.d,d=e.length;break;case 3:return ST[r.q][0];default:return ST[r.q][1]}break;case 104:switch(e.length){case 1:case 2:f=1+(r.H+11)%12,d=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:f=r.H,d=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:f=r.M,d=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?gi(r.S,e.length):(n>=2?l=n===3?1e3:100:l=n===1?10:1,s=Math.round(l*(r.S+r.u)),s>=60*l&&(s=0),e==="s"?s===0?"0":""+s/l:(a=gi(s,2+n),e==="ss"?a.substr(0,2):"."+a.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":f=r.D*24+r.H;break;case"[m]":case"[mm]":f=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":f=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}d=e.length===3?1:2;break;case 101:f=u,d=1;break}var m=d>0?gi(f,d):"";return m}function xo(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var MA=/%/g;function gL(t,e,r){var n=e.replace(MA,""),a=e.length-n.length;return bs(t,n,r*Math.pow(10,2*a))+zr("%",a)}function xL(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return bs(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function PA(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+PA(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(e/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),r.indexOf("e")===-1){var l=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+s):r+="E+"+(l-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,f,d,m){return f+d+m.substr(0,(a+s)%a)+"."+m.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var jA=/# (\?+)( ?)\/( ?)(\d+)/;function vL(t,e,r){var n=parseInt(t[4],10),a=Math.round(e*n),s=Math.floor(a/n),l=a-s*n,u=n;return r+(s===0?"":""+s)+" "+(l===0?zr(" ",t[1].length+1+t[4].length):Mv(l,t[1].length)+t[2]+"/"+t[3]+gi(u,t[4].length))}function yL(t,e,r){return r+(e===0?"":""+e)+zr(" ",t[1].length+2+t[4].length)}var UA=/^#*0*\.([0#]+)/,BA=/\).*[0#]/,VA=/\(###\) ###\\?-####/;function ua(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function AT(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function CT(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function _L(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function wL(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function ei(t,e,r){if(t.charCodeAt(0)===40&&!e.match(BA)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ei("n",n,r):"("+ei("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return xL(t,e,r);if(e.indexOf("%")!==-1)return gL(t,e,r);if(e.indexOf("E")!==-1)return PA(e,r);if(e.charCodeAt(0)===36)return"$"+ei(t,e.substr(e.charAt(1)==" "?2:1),r);var a,s,l,u,f=Math.abs(r),d=r<0?"-":"";if(e.match(/^00+$/))return d+Uc(f,e.length);if(e.match(/^[#?]+$/))return a=Uc(r,0),a==="0"&&(a=""),a.length>e.length?a:ua(e.substr(0,e.length-a.length))+a;if(s=e.match(jA))return vL(s,f,d);if(e.match(/^#+0+$/))return d+Uc(f,e.length-e.indexOf("0"));if(s=e.match(UA))return a=AT(r,s[1].length).replace(/^([^\.]+)$/,"$1."+ua(s[1])).replace(/\.$/,"."+ua(s[1])).replace(/\.(\d*)$/,function(b,w){return"."+w+zr("0",ua(s[1]).length-w.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return d+AT(f,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return d+xo(Uc(f,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ei(t,e,-r):xo(""+(Math.floor(r)+_L(r,s[1].length)))+"."+gi(CT(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return ei(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=iu(ei(t,e.replace(/[\\-]/g,""),r)),l=0,iu(iu(e.replace(/\\/g,"")).replace(/[0#]/g,function(b){return l<a.length?a.charAt(l++):b==="0"?"0":""}));if(e.match(VA))return a=ei(t,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var m="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(s[4].length,7),u=fm(f,Math.pow(10,l)-1,!1),a=""+d,m=bs("n",s[1],u[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),a+=m+s[2]+"/"+s[3],m=cm(u[2],l),m.length<s[4].length&&(m=ua(s[4].substr(s[4].length-m.length))+m),a+=m,a;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(s[1].length,s[4].length),7),u=fm(f,Math.pow(10,l)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Mv(u[1],l)+s[2]+"/"+s[3]+cm(u[2],l):zr(" ",2*l+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return a=Uc(r,0),e.length<=a.length?a:ua(e.substr(0,e.length-a.length))+a;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var y=e.indexOf(".")-l,_=e.length-a.length-y;return ua(e.substr(0,y)+a+e.substr(e.length-_))}if(s=e.match(/^00,000\.([#0]*0)$/))return l=CT(r,s[1].length),r<0?"-"+ei(t,e,-r):xo(wL(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?gi(0,3-b.length):"")+b})+"."+gi(l,s[1].length);switch(e){case"###,##0.00":return ei(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var E=xo(Uc(f,0));return E!=="0"?d+E:"";case"###,###.00":return ei(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ei(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function EL(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return bs(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function TL(t,e,r){var n=e.replace(MA,""),a=e.length-n.length;return bs(t,n,r*Math.pow(10,2*a))+zr("%",a)}function zA(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+zA(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(e/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!r.match(/[Ee]/)){var l=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+s):r+="E+"+(l-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,f,d,m){return f+d+m.substr(0,(a+s)%a)+"."+m.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Mi(t,e,r){if(t.charCodeAt(0)===40&&!e.match(BA)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Mi("n",n,r):"("+Mi("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return EL(t,e,r);if(e.indexOf("%")!==-1)return TL(t,e,r);if(e.indexOf("E")!==-1)return zA(e,r);if(e.charCodeAt(0)===36)return"$"+Mi(t,e.substr(e.charAt(1)==" "?2:1),r);var a,s,l,u,f=Math.abs(r),d=r<0?"-":"";if(e.match(/^00+$/))return d+gi(f,e.length);if(e.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>e.length?a:ua(e.substr(0,e.length-a.length))+a;if(s=e.match(jA))return yL(s,f,d);if(e.match(/^#+0+$/))return d+gi(f,e.length-e.indexOf("0"));if(s=e.match(UA))return a=(""+r).replace(/^([^\.]+)$/,"$1."+ua(s[1])).replace(/\.$/,"."+ua(s[1])),a=a.replace(/\.(\d*)$/,function(b,w){return"."+w+zr("0",ua(s[1]).length-w.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return d+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return d+xo(""+f);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Mi(t,e,-r):xo(""+r)+"."+zr("0",s[1].length);if(s=e.match(/^#,#*,#0/))return Mi(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=iu(Mi(t,e.replace(/[\\-]/g,""),r)),l=0,iu(iu(e.replace(/\\/g,"")).replace(/[0#]/g,function(b){return l<a.length?a.charAt(l++):b==="0"?"0":""}));if(e.match(VA))return a=Mi(t,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var m="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(s[4].length,7),u=fm(f,Math.pow(10,l)-1,!1),a=""+d,m=bs("n",s[1],u[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),a+=m+s[2]+"/"+s[3],m=cm(u[2],l),m.length<s[4].length&&(m=ua(s[4].substr(s[4].length-m.length))+m),a+=m,a;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(s[1].length,s[4].length),7),u=fm(f,Math.pow(10,l)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Mv(u[1],l)+s[2]+"/"+s[3]+cm(u[2],l):zr(" ",2*l+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return a=""+r,e.length<=a.length?a:ua(e.substr(0,e.length-a.length))+a;if(s=e.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var y=e.indexOf(".")-l,_=e.length-a.length-y;return ua(e.substr(0,y)+a+e.substr(e.length-_))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Mi(t,e,-r):xo(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?gi(0,3-b.length):"")+b})+"."+gi(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var E=xo(""+f);return E!=="0"?d+E:"";default:if(e.match(/\.[0#?]*$/))return Mi(t,e.slice(0,e.lastIndexOf(".")),r)+ua(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function bs(t,e,r){return(r|0)===r?Mi(t,e,r):ei(t,e,r)}function bL(t){for(var e=[],r=!1,n=0,a=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(a,n-a),a=n+1}if(e[e.length]=t.substr(a),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var HA=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ql(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":um(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(HA))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function SL(t,e,r,n){for(var a=[],s="",l=0,u="",f="t",d,m,y,_="H";l<t.length;)switch(u=t.charAt(l)){case"G":if(!um(t,l))throw new Error("unrecognized character "+u+" in "+t);a[a.length]={t:"G",v:"General"},l+=7;break;case'"':for(s="";(y=t.charCodeAt(++l))!==34&&l<t.length;)s+=String.fromCharCode(y);a[a.length]={t:"t",v:s},++l;break;case"\\":var E=t.charAt(++l),b=E==="("||E===")"?E:"t";a[a.length]={t:b,v:E},++l;break;case"_":a[a.length]={t:"t",v:" "},l+=2;break;case"@":a[a.length]={t:"T",v:e},++l;break;case"B":case"b":if(t.charAt(l+1)==="1"||t.charAt(l+1)==="2"){if(d==null&&(d=go(e,r,t.charAt(l+1)==="2"),d==null))return"";a[a.length]={t:"X",v:t.substr(l,2)},f=u,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||d==null&&(d=go(e,r),d==null))return"";for(s=u;++l<t.length&&t.charAt(l).toLowerCase()===u;)s+=u;u==="m"&&f.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=_),a[a.length]={t:u,v:s},f=u;break;case"A":case"a":case"":var w={t:u,v:u};if(d==null&&(d=go(e,r)),t.substr(l,3).toUpperCase()==="A/P"?(d!=null&&(w.v=d.H>=12?"P":"A"),w.t="T",_="h",l+=3):t.substr(l,5).toUpperCase()==="AM/PM"?(d!=null&&(w.v=d.H>=12?"PM":"AM"),w.t="T",l+=5,_="h"):t.substr(l,5).toUpperCase()==="/"?(d!=null&&(w.v=d.H>=12?"":""),w.t="T",l+=5,_="h"):(w.t="t",++l),d==null&&w.t==="T")return"";a[a.length]=w,f=u;break;case"[":for(s=u;t.charAt(l++)!=="]"&&l<t.length;)s+=t.charAt(l);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(HA)){if(d==null&&(d=go(e,r),d==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},f=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",ql(t)||(a[a.length]={t:"t",v:s}));break;case".":if(d!=null){for(s=u;++l<t.length&&(u=t.charAt(l))==="0";)s+=u;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=u;++l<t.length&&"0#?.,E+-%".indexOf(u=t.charAt(l))>-1;)s+=u;a[a.length]={t:"n",v:s};break;case"?":for(s=u;t.charAt(++l)===u;)s+=u;a[a.length]={t:u,v:s},f=u;break;case"*":++l,(t.charAt(l)==" "||t.charAt(l)=="*")&&++l;break;case"(":case")":a[a.length]={t:n===1?"t":u,v:u},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=u;l<t.length&&"0123456789".indexOf(t.charAt(++l))>-1;)s+=t.charAt(l);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:u,v:u},++l;break;case"$":a[a.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+t);a[a.length]={t:"t",v:u},++l;break}var S=0,M=0,j;for(l=a.length-1,f="t";l>=0;--l)switch(a[l].t){case"h":case"H":a[l].t=_,f="h",S<1&&(S=1);break;case"s":(j=a[l].v.match(/\.0+$/))&&(M=Math.max(M,j[0].length-1)),S<3&&(S=3);case"d":case"y":case"M":case"e":f=a[l].t;break;case"m":f==="s"&&(a[l].t="M",S<2&&(S=2));break;case"X":break;case"Z":S<1&&a[l].v.match(/[Hh]/)&&(S=1),S<2&&a[l].v.match(/[Mm]/)&&(S=2),S<3&&a[l].v.match(/[Ss]/)&&(S=3)}switch(S){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var F="",G;for(l=0;l<a.length;++l)switch(a[l].t){case"t":case"T":case" ":case"D":break;case"X":a[l].v="",a[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[l].v=pL(a[l].t.charCodeAt(0),a[l].v,d,M),a[l].t="t";break;case"n":case"?":for(G=l+1;a[G]!=null&&((u=a[G].t)==="?"||u==="D"||(u===" "||u==="t")&&a[G+1]!=null&&(a[G+1].t==="?"||a[G+1].t==="t"&&a[G+1].v==="/")||a[l].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(a[G].v==="/"||a[G].v===" "&&a[G+1]!=null&&a[G+1].t=="?"));)a[l].v+=a[G].v,a[G]={v:"",t:";"},++G;F+=a[l].v,l=G-1;break;case"G":a[l].t="t",a[l].v=Ll(e,r);break}var W="",B,A;if(F.length>0){F.charCodeAt(0)==40?(B=e<0&&F.charCodeAt(0)===45?-e:e,A=bs("n",F,B)):(B=e<0&&n>1?-e:e,A=bs("n",F,B),B<0&&a[0]&&a[0].t=="t"&&(A=A.substr(1),a[0].v="-"+a[0].v)),G=A.length-1;var D=a.length;for(l=0;l<a.length;++l)if(a[l]!=null&&a[l].t!="t"&&a[l].v.indexOf(".")>-1){D=l;break}var k=a.length;if(D===a.length&&A.indexOf("E")===-1){for(l=a.length-1;l>=0;--l)a[l]==null||"n?".indexOf(a[l].t)===-1||(G>=a[l].v.length-1?(G-=a[l].v.length,a[l].v=A.substr(G+1,a[l].v.length)):G<0?a[l].v="":(a[l].v=A.substr(0,G+1),G=-1),a[l].t="t",k=l);G>=0&&k<a.length&&(a[k].v=A.substr(0,G+1)+a[k].v)}else if(D!==a.length&&A.indexOf("E")===-1){for(G=A.indexOf(".")-1,l=D;l>=0;--l)if(!(a[l]==null||"n?".indexOf(a[l].t)===-1)){for(m=a[l].v.indexOf(".")>-1&&l===D?a[l].v.indexOf(".")-1:a[l].v.length-1,W=a[l].v.substr(m+1);m>=0;--m)G>=0&&(a[l].v.charAt(m)==="0"||a[l].v.charAt(m)==="#")&&(W=A.charAt(G--)+W);a[l].v=W,a[l].t="t",k=l}for(G>=0&&k<a.length&&(a[k].v=A.substr(0,G+1)+a[k].v),G=A.indexOf(".")+1,l=D;l<a.length;++l)if(!(a[l]==null||"n?(".indexOf(a[l].t)===-1&&l!==D)){for(m=a[l].v.indexOf(".")>-1&&l===D?a[l].v.indexOf(".")+1:0,W=a[l].v.substr(0,m);m<a[l].v.length;++m)G<A.length&&(W+=A.charAt(G++));a[l].v=W,a[l].t="t",k=l}}}for(l=0;l<a.length;++l)a[l]!=null&&"n?".indexOf(a[l].t)>-1&&(B=n>1&&e<0&&l>0&&a[l-1].v==="-"?-e:e,a[l].v=bs(a[l].t,a[l].v,B),a[l].t="t");var O="";for(l=0;l!==a.length;++l)a[l]!=null&&(O+=a[l].v);return O}var NT=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function IT(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function kL(t,e){var r=bL(t),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var l=r[0].match(NT),u=r[1].match(NT);return IT(e,l)?[n,r[0]]:IT(e,u)?[n,r[1]]:[n,r[l!=null&&u!=null?2:1]]}return[n,s]}function Va(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:mt)[t],n==null&&(n=r.table&&r.table[kT[t]]||mt[kT[t]]),n==null&&(n=lL[t]||"General");break}if(um(n,0))return Ll(e,r);e instanceof Date&&(e=LA(e,r.date1904));var a=kL(n,e);if(um(a[1]))return Ll(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return SL(a[1],e,r,a[0])}function $i(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(mt[r]==null){e<0&&(e=r);continue}if(mt[r]==t){e=r;break}}e<0&&(e=391)}return mt[e]=t,e}function z0(t){for(var e=0;e!=392;++e)t[e]!==void 0&&$i(t[e],e)}function Su(){mt=oL()}var GA={format:Va,load:$i,_table:mt,load_table:z0,parse_date_code:go,is_date:ql,get_table:function(){return GA._table=mt}},AL={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},qA=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function CL(t){var e=typeof t=="number"?mt[t]:t;return e=e.replace(qA,"(\\d+)"),new RegExp("^"+e+"$")}function NL(t,e,r){var n=-1,a=-1,s=-1,l=-1,u=-1,f=-1;(e.match(qA)||[]).forEach(function(y,_){var E=parseInt(r[_+1],10);switch(y.toLowerCase().charAt(0)){case"y":n=E;break;case"d":s=E;break;case"h":l=E;break;case"s":f=E;break;case"m":l>=0?u=E:a=E;break}}),f>=0&&u==-1&&a>=0&&(u=a,a=-1);var d=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var m=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return l==-1&&u==-1&&f==-1?d:n==-1&&a==-1&&s==-1?m:d+"T"+m}var IL=function(){var t={};t.version="1.2.0";function e(){for(var A=0,D=new Array(256),k=0;k!=256;++k)A=k,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,D[k]=A;return typeof Int32Array<"u"?new Int32Array(D):D}var r=e();function n(A){var D=0,k=0,O=0,P=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(O=0;O!=256;++O)P[O]=A[O];for(O=0;O!=256;++O)for(k=A[O],D=256+O;D<4096;D+=256)k=P[D]=k>>>8^A[k&255];var N=[];for(O=1;O!=16;++O)N[O-1]=typeof Int32Array<"u"?P.subarray(O*256,O*256+256):P.slice(O*256,O*256+256);return N}var a=n(r),s=a[0],l=a[1],u=a[2],f=a[3],d=a[4],m=a[5],y=a[6],_=a[7],E=a[8],b=a[9],w=a[10],S=a[11],M=a[12],j=a[13],F=a[14];function G(A,D){for(var k=D^-1,O=0,P=A.length;O<P;)k=k>>>8^r[(k^A.charCodeAt(O++))&255];return~k}function W(A,D){for(var k=D^-1,O=A.length-15,P=0;P<O;)k=F[A[P++]^k&255]^j[A[P++]^k>>8&255]^M[A[P++]^k>>16&255]^S[A[P++]^k>>>24]^w[A[P++]]^b[A[P++]]^E[A[P++]]^_[A[P++]]^y[A[P++]]^m[A[P++]]^d[A[P++]]^f[A[P++]]^u[A[P++]]^l[A[P++]]^s[A[P++]]^r[A[P++]];for(O+=15;P<O;)k=k>>>8^r[(k^A[P++])&255];return~k}function B(A,D){for(var k=D^-1,O=0,P=A.length,N=0,R=0;O<P;)N=A.charCodeAt(O++),N<128?k=k>>>8^r[(k^N)&255]:N<2048?(k=k>>>8^r[(k^(192|N>>6&31))&255],k=k>>>8^r[(k^(128|N&63))&255]):N>=55296&&N<57344?(N=(N&1023)+64,R=A.charCodeAt(O++)&1023,k=k>>>8^r[(k^(240|N>>8&7))&255],k=k>>>8^r[(k^(128|N>>2&63))&255],k=k>>>8^r[(k^(128|R>>6&15|(N&3)<<4))&255],k=k>>>8^r[(k^(128|R&63))&255]):(k=k>>>8^r[(k^(224|N>>12&15))&255],k=k>>>8^r[(k^(128|N>>6&63))&255],k=k>>>8^r[(k^(128|N&63))&255]);return~k}return t.table=r,t.bstr=G,t.buf=W,t.str=B,t}(),ht=function(){var e={};e.version="1.2.1";function r(L,K){for(var H=L.split("/"),q=K.split("/"),Q=0,Y=0,de=Math.min(H.length,q.length);Q<de;++Q){if(Y=H[Q].length-q[Q].length)return Y;if(H[Q]!=q[Q])return H[Q]<q[Q]?-1:1}return H.length-q.length}function n(L){if(L.charAt(L.length-1)=="/")return L.slice(0,-1).indexOf("/")===-1?L:n(L.slice(0,-1));var K=L.lastIndexOf("/");return K===-1?L:L.slice(0,K+1)}function a(L){if(L.charAt(L.length-1)=="/")return a(L.slice(0,-1));var K=L.lastIndexOf("/");return K===-1?L:L.slice(K+1)}function s(L,K){typeof K=="string"&&(K=new Date(K));var H=K.getHours();H=H<<6|K.getMinutes(),H=H<<5|K.getSeconds()>>>1,L.write_shift(2,H);var q=K.getFullYear()-1980;q=q<<4|K.getMonth()+1,q=q<<5|K.getDate(),L.write_shift(2,q)}function l(L){var K=L.read_shift(2)&65535,H=L.read_shift(2)&65535,q=new Date,Q=H&31;H>>>=5;var Y=H&15;H>>>=4,q.setMilliseconds(0),q.setFullYear(H+1980),q.setMonth(Y-1),q.setDate(Q);var de=K&31;K>>>=5;var Te=K&63;return K>>>=6,q.setHours(K),q.setMinutes(Te),q.setSeconds(de<<1),q}function u(L){jn(L,0);for(var K={},H=0;L.l<=L.length-4;){var q=L.read_shift(2),Q=L.read_shift(2),Y=L.l+Q,de={};switch(q){case 21589:H=L.read_shift(1),H&1&&(de.mtime=L.read_shift(4)),Q>5&&(H&2&&(de.atime=L.read_shift(4)),H&4&&(de.ctime=L.read_shift(4))),de.mtime&&(de.mt=new Date(de.mtime*1e3));break}L.l=Y,K[q]=de}return K}var f;function d(){return f||(f={})}function m(L,K){if(L[0]==80&&L[1]==75)return li(L,K);if((L[0]|32)==109&&(L[1]|32)==105)return Ot(L,K);if(L.length<512)throw new Error("CFB file size "+L.length+" < 512");var H=3,q=512,Q=0,Y=0,de=0,Te=0,ce=0,ye=[],_e=L.slice(0,512);jn(_e,0);var Be=y(_e);switch(H=Be[0],H){case 3:q=512;break;case 4:q=4096;break;case 0:if(Be[1]==0)return li(L,K);default:throw new Error("Major Version: Expected 3 or 4 saw "+H)}q!==512&&(_e=L.slice(0,q),jn(_e,28));var We=L.slice(0,q);_(_e,H);var tt=_e.read_shift(4,"i");if(H===3&&tt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+tt);_e.l+=4,de=_e.read_shift(4,"i"),_e.l+=4,_e.chk("00100000","Mini Stream Cutoff Size: "),Te=_e.read_shift(4,"i"),Q=_e.read_shift(4,"i"),ce=_e.read_shift(4,"i"),Y=_e.read_shift(4,"i");for(var qe=-1,Ze=0;Ze<109&&(qe=_e.read_shift(4,"i"),!(qe<0));++Ze)ye[Ze]=qe;var wt=E(L,q);S(ce,Y,wt,q,ye);var rr=j(wt,de,ye,q);rr[de].name="!Directory",Q>0&&Te!==R&&(rr[Te].name="!MiniFAT"),rr[ye[0]].name="!FAT",rr.fat_addrs=ye,rr.ssz=q;var Wt={},Xt=[],ba=[],wi=[];F(de,rr,wt,Xt,Q,Wt,ba,Te),b(ba,wi,Xt),Xt.shift();var ra={FileIndex:ba,FullPaths:wi};return K&&K.raw&&(ra.raw={header:We,sectors:wt}),ra}function y(L){if(L[L.l]==80&&L[L.l+1]==75)return[0,0];L.chk(he,"Header Signature: "),L.l+=16;var K=L.read_shift(2,"u");return[L.read_shift(2,"u"),K]}function _(L,K){var H=9;switch(L.l+=2,H=L.read_shift(2)){case 9:if(K!=3)throw new Error("Sector Shift: Expected 9 saw "+H);break;case 12:if(K!=4)throw new Error("Sector Shift: Expected 12 saw "+H);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+H)}L.chk("0600","Mini Sector Shift: "),L.chk("000000000000","Reserved: ")}function E(L,K){for(var H=Math.ceil(L.length/K)-1,q=[],Q=1;Q<H;++Q)q[Q-1]=L.slice(Q*K,(Q+1)*K);return q[H-1]=L.slice(H*K),q}function b(L,K,H){for(var q=0,Q=0,Y=0,de=0,Te=0,ce=H.length,ye=[],_e=[];q<ce;++q)ye[q]=_e[q]=q,K[q]=H[q];for(;Te<_e.length;++Te)q=_e[Te],Q=L[q].L,Y=L[q].R,de=L[q].C,ye[q]===q&&(Q!==-1&&ye[Q]!==Q&&(ye[q]=ye[Q]),Y!==-1&&ye[Y]!==Y&&(ye[q]=ye[Y])),de!==-1&&(ye[de]=q),Q!==-1&&q!=ye[q]&&(ye[Q]=ye[q],_e.lastIndexOf(Q)<Te&&_e.push(Q)),Y!==-1&&q!=ye[q]&&(ye[Y]=ye[q],_e.lastIndexOf(Y)<Te&&_e.push(Y));for(q=1;q<ce;++q)ye[q]===q&&(Y!==-1&&ye[Y]!==Y?ye[q]=ye[Y]:Q!==-1&&ye[Q]!==Q&&(ye[q]=ye[Q]));for(q=1;q<ce;++q)if(L[q].type!==0){if(Te=q,Te!=ye[Te])do Te=ye[Te],K[q]=K[Te]+"/"+K[q];while(Te!==0&&ye[Te]!==-1&&Te!=ye[Te]);ye[q]=-1}for(K[0]+="/",q=1;q<ce;++q)L[q].type!==2&&(K[q]+="/")}function w(L,K,H){for(var q=L.start,Q=L.size,Y=[],de=q;H&&Q>0&&de>=0;)Y.push(K.slice(de*N,de*N+N)),Q-=N,de=vl(H,de*4);return Y.length===0?Ce(0):Nn(Y).slice(0,L.size)}function S(L,K,H,q,Q){var Y=R;if(L===R){if(K!==0)throw new Error("DIFAT chain shorter than expected")}else if(L!==-1){var de=H[L],Te=(q>>>2)-1;if(!de)return;for(var ce=0;ce<Te&&(Y=vl(de,ce*4))!==R;++ce)Q.push(Y);S(vl(de,q-4),K-1,H,q,Q)}}function M(L,K,H,q,Q){var Y=[],de=[];Q||(Q=[]);var Te=q-1,ce=0,ye=0;for(ce=K;ce>=0;){Q[ce]=!0,Y[Y.length]=ce,de.push(L[ce]);var _e=H[Math.floor(ce*4/q)];if(ye=ce*4&Te,q<4+ye)throw new Error("FAT boundary crossed: "+ce+" 4 "+q);if(!L[_e])break;ce=vl(L[_e],ye)}return{nodes:Y,data:zT([de])}}function j(L,K,H,q){var Q=L.length,Y=[],de=[],Te=[],ce=[],ye=q-1,_e=0,Be=0,We=0,tt=0;for(_e=0;_e<Q;++_e)if(Te=[],We=_e+K,We>=Q&&(We-=Q),!de[We]){ce=[];var qe=[];for(Be=We;Be>=0;){qe[Be]=!0,de[Be]=!0,Te[Te.length]=Be,ce.push(L[Be]);var Ze=H[Math.floor(Be*4/q)];if(tt=Be*4&ye,q<4+tt)throw new Error("FAT boundary crossed: "+Be+" 4 "+q);if(!L[Ze]||(Be=vl(L[Ze],tt),qe[Be]))break}Y[We]={nodes:Te,data:zT([ce])}}return Y}function F(L,K,H,q,Q,Y,de,Te){for(var ce=0,ye=q.length?2:0,_e=K[L].data,Be=0,We=0,tt;Be<_e.length;Be+=128){var qe=_e.slice(Be,Be+128);jn(qe,64),We=qe.read_shift(2),tt=Gv(qe,0,We-ye),q.push(tt);var Ze={name:tt,type:qe.read_shift(1),color:qe.read_shift(1),L:qe.read_shift(4,"i"),R:qe.read_shift(4,"i"),C:qe.read_shift(4,"i"),clsid:qe.read_shift(16),state:qe.read_shift(4,"i"),start:0,size:0},wt=qe.read_shift(2)+qe.read_shift(2)+qe.read_shift(2)+qe.read_shift(2);wt!==0&&(Ze.ct=G(qe,qe.l-8));var rr=qe.read_shift(2)+qe.read_shift(2)+qe.read_shift(2)+qe.read_shift(2);rr!==0&&(Ze.mt=G(qe,qe.l-8)),Ze.start=qe.read_shift(4,"i"),Ze.size=qe.read_shift(4,"i"),Ze.size<0&&Ze.start<0&&(Ze.size=Ze.type=0,Ze.start=R,Ze.name=""),Ze.type===5?(ce=Ze.start,Q>0&&ce!==R&&(K[ce].name="!StreamData")):Ze.size>=4096?(Ze.storage="fat",K[Ze.start]===void 0&&(K[Ze.start]=M(H,Ze.start,K.fat_addrs,K.ssz)),K[Ze.start].name=Ze.name,Ze.content=K[Ze.start].data.slice(0,Ze.size)):(Ze.storage="minifat",Ze.size<0?Ze.size=0:ce!==R&&Ze.start!==R&&K[ce]&&(Ze.content=w(Ze,K[ce].data,(K[Te]||{}).data))),Ze.content&&jn(Ze.content,0),Y[tt]=Ze,de.push(Ze)}}function G(L,K){return new Date((Fa(L,K+4)/1e7*Math.pow(2,32)+Fa(L,K)/1e7-11644473600)*1e3)}function W(L,K){return d(),m(f.readFileSync(L),K)}function B(L,K){var H=K&&K.type;switch(H||Mt&&Buffer.isBuffer(L)&&(H="buffer"),H||"base64"){case"file":return W(L,K);case"base64":return m(Ma(Ba(L)),K);case"binary":return m(Ma(L),K)}return m(L,K)}function A(L,K){var H=K||{},q=H.root||"Root Entry";if(L.FullPaths||(L.FullPaths=[]),L.FileIndex||(L.FileIndex=[]),L.FullPaths.length!==L.FileIndex.length)throw new Error("inconsistent CFB structure");L.FullPaths.length===0&&(L.FullPaths[0]=q+"/",L.FileIndex[0]={name:q,type:5}),H.CLSID&&(L.FileIndex[0].clsid=H.CLSID),D(L)}function D(L){var K="Sh33tJ5";if(!ht.find(L,"/"+K)){var H=Ce(4);H[0]=55,H[1]=H[3]=50,H[2]=54,L.FileIndex.push({name:K,type:2,content:H,size:4,L:69,R:69,C:69}),L.FullPaths.push(L.FullPaths[0]+K),k(L)}}function k(L,K){A(L);for(var H=!1,q=!1,Q=L.FullPaths.length-1;Q>=0;--Q){var Y=L.FileIndex[Q];switch(Y.type){case 0:q?H=!0:(L.FileIndex.pop(),L.FullPaths.pop());break;case 1:case 2:case 5:q=!0,isNaN(Y.R*Y.L*Y.C)&&(H=!0),Y.R>-1&&Y.L>-1&&Y.R==Y.L&&(H=!0);break;default:H=!0;break}}if(!(!H&&!K)){var de=new Date(1987,1,19),Te=0,ce=Object.create?Object.create(null):{},ye=[];for(Q=0;Q<L.FullPaths.length;++Q)ce[L.FullPaths[Q]]=!0,L.FileIndex[Q].type!==0&&ye.push([L.FullPaths[Q],L.FileIndex[Q]]);for(Q=0;Q<ye.length;++Q){var _e=n(ye[Q][0]);q=ce[_e],q||(ye.push([_e,{name:a(_e).replace("/",""),type:1,clsid:ne,ct:de,mt:de,content:null}]),ce[_e]=!0)}for(ye.sort(function(tt,qe){return r(tt[0],qe[0])}),L.FullPaths=[],L.FileIndex=[],Q=0;Q<ye.length;++Q)L.FullPaths[Q]=ye[Q][0],L.FileIndex[Q]=ye[Q][1];for(Q=0;Q<ye.length;++Q){var Be=L.FileIndex[Q],We=L.FullPaths[Q];if(Be.name=a(We).replace("/",""),Be.L=Be.R=Be.C=-(Be.color=1),Be.size=Be.content?Be.content.length:0,Be.start=0,Be.clsid=Be.clsid||ne,Q===0)Be.C=ye.length>1?1:-1,Be.size=0,Be.type=5;else if(We.slice(-1)=="/"){for(Te=Q+1;Te<ye.length&&n(L.FullPaths[Te])!=We;++Te);for(Be.C=Te>=ye.length?-1:Te,Te=Q+1;Te<ye.length&&n(L.FullPaths[Te])!=n(We);++Te);Be.R=Te>=ye.length?-1:Te,Be.type=1}else n(L.FullPaths[Q+1]||"")==n(We)&&(Be.R=Q+1),Be.type=2}}}function O(L,K){var H=K||{};if(H.fileType=="mad")return et(L,H);switch(k(L),H.fileType){case"zip":return Ue(L,H)}var q=function(tt){for(var qe=0,Ze=0,wt=0;wt<tt.FileIndex.length;++wt){var rr=tt.FileIndex[wt];if(rr.content){var Wt=rr.content.length;Wt>0&&(Wt<4096?qe+=Wt+63>>6:Ze+=Wt+511>>9)}}for(var Xt=tt.FullPaths.length+3>>2,ba=qe+7>>3,wi=qe+127>>7,ra=ba+Ze+Xt+wi,da=ra+127>>7,Ei=da<=109?0:Math.ceil((da-109)/127);ra+da+Ei+127>>7>da;)Ei=++da<=109?0:Math.ceil((da-109)/127);var na=[1,Ei,da,wi,Xt,Ze,qe,0];return tt.FileIndex[0].size=qe<<6,na[7]=(tt.FileIndex[0].start=na[0]+na[1]+na[2]+na[3]+na[4]+na[5])+(na[6]+7>>3),na}(L),Q=Ce(q[7]<<9),Y=0,de=0;{for(Y=0;Y<8;++Y)Q.write_shift(1,xe[Y]);for(Y=0;Y<8;++Y)Q.write_shift(2,0);for(Q.write_shift(2,62),Q.write_shift(2,3),Q.write_shift(2,65534),Q.write_shift(2,9),Q.write_shift(2,6),Y=0;Y<3;++Y)Q.write_shift(2,0);for(Q.write_shift(4,0),Q.write_shift(4,q[2]),Q.write_shift(4,q[0]+q[1]+q[2]+q[3]-1),Q.write_shift(4,0),Q.write_shift(4,4096),Q.write_shift(4,q[3]?q[0]+q[1]+q[2]-1:R),Q.write_shift(4,q[3]),Q.write_shift(-4,q[1]?q[0]-1:R),Q.write_shift(4,q[1]),Y=0;Y<109;++Y)Q.write_shift(-4,Y<q[2]?q[1]+Y:-1)}if(q[1])for(de=0;de<q[1];++de){for(;Y<236+de*127;++Y)Q.write_shift(-4,Y<q[2]?q[1]+Y:-1);Q.write_shift(-4,de===q[1]-1?R:de+1)}var Te=function(tt){for(de+=tt;Y<de-1;++Y)Q.write_shift(-4,Y+1);tt&&(++Y,Q.write_shift(-4,R))};for(de=Y=0,de+=q[1];Y<de;++Y)Q.write_shift(-4,le.DIFSECT);for(de+=q[2];Y<de;++Y)Q.write_shift(-4,le.FATSECT);Te(q[3]),Te(q[4]);for(var ce=0,ye=0,_e=L.FileIndex[0];ce<L.FileIndex.length;++ce)_e=L.FileIndex[ce],_e.content&&(ye=_e.content.length,!(ye<4096)&&(_e.start=de,Te(ye+511>>9)));for(Te(q[6]+7>>3);Q.l&511;)Q.write_shift(-4,le.ENDOFCHAIN);for(de=Y=0,ce=0;ce<L.FileIndex.length;++ce)_e=L.FileIndex[ce],_e.content&&(ye=_e.content.length,!(!ye||ye>=4096)&&(_e.start=de,Te(ye+63>>6)));for(;Q.l&511;)Q.write_shift(-4,le.ENDOFCHAIN);for(Y=0;Y<q[4]<<2;++Y){var Be=L.FullPaths[Y];if(!Be||Be.length===0){for(ce=0;ce<17;++ce)Q.write_shift(4,0);for(ce=0;ce<3;++ce)Q.write_shift(4,-1);for(ce=0;ce<12;++ce)Q.write_shift(4,0);continue}_e=L.FileIndex[Y],Y===0&&(_e.start=_e.size?_e.start-1:R);var We=Y===0&&H.root||_e.name;if(ye=2*(We.length+1),Q.write_shift(64,We,"utf16le"),Q.write_shift(2,ye),Q.write_shift(1,_e.type),Q.write_shift(1,_e.color),Q.write_shift(-4,_e.L),Q.write_shift(-4,_e.R),Q.write_shift(-4,_e.C),_e.clsid)Q.write_shift(16,_e.clsid,"hex");else for(ce=0;ce<4;++ce)Q.write_shift(4,0);Q.write_shift(4,_e.state||0),Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(4,_e.start),Q.write_shift(4,_e.size),Q.write_shift(4,0)}for(Y=1;Y<L.FileIndex.length;++Y)if(_e=L.FileIndex[Y],_e.size>=4096)if(Q.l=_e.start+1<<9,Mt&&Buffer.isBuffer(_e.content))_e.content.copy(Q,Q.l,0,_e.size),Q.l+=_e.size+511&-512;else{for(ce=0;ce<_e.size;++ce)Q.write_shift(1,_e.content[ce]);for(;ce&511;++ce)Q.write_shift(1,0)}for(Y=1;Y<L.FileIndex.length;++Y)if(_e=L.FileIndex[Y],_e.size>0&&_e.size<4096)if(Mt&&Buffer.isBuffer(_e.content))_e.content.copy(Q,Q.l,0,_e.size),Q.l+=_e.size+63&-64;else{for(ce=0;ce<_e.size;++ce)Q.write_shift(1,_e.content[ce]);for(;ce&63;++ce)Q.write_shift(1,0)}if(Mt)Q.l=Q.length;else for(;Q.l<Q.length;)Q.write_shift(1,0);return Q}function P(L,K){var H=L.FullPaths.map(function(ce){return ce.toUpperCase()}),q=H.map(function(ce){var ye=ce.split("/");return ye[ye.length-(ce.slice(-1)=="/"?2:1)]}),Q=!1;K.charCodeAt(0)===47?(Q=!0,K=H[0].slice(0,-1)+K):Q=K.indexOf("/")!==-1;var Y=K.toUpperCase(),de=Q===!0?H.indexOf(Y):q.indexOf(Y);if(de!==-1)return L.FileIndex[de];var Te=!Y.match(jf);for(Y=Y.replace(ha,""),Te&&(Y=Y.replace(jf,"!")),de=0;de<H.length;++de)if((Te?H[de].replace(jf,"!"):H[de]).replace(ha,"")==Y||(Te?q[de].replace(jf,"!"):q[de]).replace(ha,"")==Y)return L.FileIndex[de];return null}var N=64,R=-2,he="d0cf11e0a1b11ae1",xe=[208,207,17,224,161,177,26,225],ne="00000000000000000000000000000000",le={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:R,FREESECT:-1,HEADER_SIGNATURE:he,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ne,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function He(L,K,H){d();var q=O(L,H);f.writeFileSync(K,q)}function ie(L){for(var K=new Array(L.length),H=0;H<L.length;++H)K[H]=String.fromCharCode(L[H]);return K.join("")}function J(L,K){var H=O(L,K);switch(K&&K.type||"buffer"){case"file":return d(),f.writeFileSync(K.filename,H),H;case"binary":return typeof H=="string"?H:ie(H);case"base64":return h0(typeof H=="string"?H:ie(H));case"buffer":if(Mt)return Buffer.isBuffer(H)?H:Ds(H);case"array":return typeof H=="string"?Ma(H):H}return H}var ge;function V(L){try{var K=L.InflateRaw,H=new K;if(H._processChunk(new Uint8Array([3,0]),H._finishFlushFlag),H.bytesRead)ge=L;else throw new Error("zlib does not expose bytesRead")}catch(q){console.error("cannot use native zlib: "+(q.message||q))}}function X(L,K){if(!ge)return fn(L,K);var H=ge.InflateRaw,q=new H,Q=q._processChunk(L.slice(L.l),q._finishFlushFlag);return L.l+=q.bytesRead,Q}function Z(L){return ge?ge.deflateRawSync(L):Je(L)}var te=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],fe=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Se=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ke(L){var K=(L<<1|L<<11)&139536|(L<<5|L<<15)&558144;return(K>>16|K>>8|K)&255}for(var Ne=typeof Uint8Array<"u",Oe=Ne?new Uint8Array(256):[],ot=0;ot<256;++ot)Oe[ot]=ke(ot);function ee(L,K){var H=Oe[L&255];return K<=8?H>>>8-K:(H=H<<8|Oe[L>>8&255],K<=16?H>>>16-K:(H=H<<8|Oe[L>>16&255],H>>>24-K))}function Pt(L,K){var H=K&7,q=K>>>3;return(L[q]|(H<=6?0:L[q+1]<<8))>>>H&3}function _t(L,K){var H=K&7,q=K>>>3;return(L[q]|(H<=5?0:L[q+1]<<8))>>>H&7}function Dt(L,K){var H=K&7,q=K>>>3;return(L[q]|(H<=4?0:L[q+1]<<8))>>>H&15}function nt(L,K){var H=K&7,q=K>>>3;return(L[q]|(H<=3?0:L[q+1]<<8))>>>H&31}function Ge(L,K){var H=K&7,q=K>>>3;return(L[q]|(H<=1?0:L[q+1]<<8))>>>H&127}function tr(L,K,H){var q=K&7,Q=K>>>3,Y=(1<<H)-1,de=L[Q]>>>q;return H<8-q||(de|=L[Q+1]<<8-q,H<16-q)||(de|=L[Q+2]<<16-q,H<24-q)||(de|=L[Q+3]<<24-q),de&Y}function Jt(L,K,H){var q=K&7,Q=K>>>3;return q<=5?L[Q]|=(H&7)<<q:(L[Q]|=H<<q&255,L[Q+1]=(H&7)>>8-q),K+3}function Ct(L,K,H){var q=K&7,Q=K>>>3;return H=(H&1)<<q,L[Q]|=H,K+1}function wr(L,K,H){var q=K&7,Q=K>>>3;return H<<=q,L[Q]|=H&255,H>>>=8,L[Q+1]=H,K+8}function _n(L,K,H){var q=K&7,Q=K>>>3;return H<<=q,L[Q]|=H&255,H>>>=8,L[Q+1]=H&255,L[Q+2]=H>>>8,K+16}function Dr(L,K){var H=L.length,q=2*H>K?2*H:K+5,Q=0;if(H>=K)return L;if(Mt){var Y=TT(q);if(L.copy)L.copy(Y);else for(;Q<L.length;++Q)Y[Q]=L[Q];return Y}else if(Ne){var de=new Uint8Array(q);if(de.set)de.set(L);else for(;Q<H;++Q)de[Q]=L[Q];return de}return L.length=q,L}function mr(L){for(var K=new Array(L),H=0;H<L;++H)K[H]=0;return K}function en(L,K,H){var q=1,Q=0,Y=0,de=0,Te=0,ce=L.length,ye=Ne?new Uint16Array(32):mr(32);for(Y=0;Y<32;++Y)ye[Y]=0;for(Y=ce;Y<H;++Y)L[Y]=0;ce=L.length;var _e=Ne?new Uint16Array(ce):mr(ce);for(Y=0;Y<ce;++Y)ye[Q=L[Y]]++,q<Q&&(q=Q),_e[Y]=0;for(ye[0]=0,Y=1;Y<=q;++Y)ye[Y+16]=Te=Te+ye[Y-1]<<1;for(Y=0;Y<ce;++Y)Te=L[Y],Te!=0&&(_e[Y]=ye[Te+16]++);var Be=0;for(Y=0;Y<ce;++Y)if(Be=L[Y],Be!=0)for(Te=ee(_e[Y],q)>>q-Be,de=(1<<q+4-Be)-1;de>=0;--de)K[Te|de<<Be]=Be&15|Y<<4;return q}var jt=Ne?new Uint16Array(512):mr(512),oe=Ne?new Uint16Array(32):mr(32);if(!Ne){for(var ze=0;ze<512;++ze)jt[ze]=0;for(ze=0;ze<32;++ze)oe[ze]=0}(function(){for(var L=[],K=0;K<32;K++)L.push(5);en(L,oe,32);var H=[];for(K=0;K<=143;K++)H.push(8);for(;K<=255;K++)H.push(9);for(;K<=279;K++)H.push(7);for(;K<=287;K++)H.push(8);en(H,jt,288)})();var Ve=function(){for(var K=Ne?new Uint8Array(32768):[],H=0,q=0;H<Se.length-1;++H)for(;q<Se[H+1];++q)K[q]=H;for(;q<32768;++q)K[q]=29;var Q=Ne?new Uint8Array(259):[];for(H=0,q=0;H<fe.length-1;++H)for(;q<fe[H+1];++q)Q[q]=H;function Y(Te,ce){for(var ye=0;ye<Te.length;){var _e=Math.min(65535,Te.length-ye),Be=ye+_e==Te.length;for(ce.write_shift(1,+Be),ce.write_shift(2,_e),ce.write_shift(2,~_e&65535);_e-- >0;)ce[ce.l++]=Te[ye++]}return ce.l}function de(Te,ce){for(var ye=0,_e=0,Be=Ne?new Uint16Array(32768):[];_e<Te.length;){var We=Math.min(65535,Te.length-_e);if(We<10){for(ye=Jt(ce,ye,+(_e+We==Te.length)),ye&7&&(ye+=8-(ye&7)),ce.l=ye/8|0,ce.write_shift(2,We),ce.write_shift(2,~We&65535);We-- >0;)ce[ce.l++]=Te[_e++];ye=ce.l*8;continue}ye=Jt(ce,ye,+(_e+We==Te.length)+2);for(var tt=0;We-- >0;){var qe=Te[_e];tt=(tt<<5^qe)&32767;var Ze=-1,wt=0;if((Ze=Be[tt])&&(Ze|=_e&-32768,Ze>_e&&(Ze-=32768),Ze<_e))for(;Te[Ze+wt]==Te[_e+wt]&&wt<250;)++wt;if(wt>2){qe=Q[wt],qe<=22?ye=wr(ce,ye,Oe[qe+1]>>1)-1:(wr(ce,ye,3),ye+=5,wr(ce,ye,Oe[qe-23]>>5),ye+=3);var rr=qe<8?0:qe-4>>2;rr>0&&(_n(ce,ye,wt-fe[qe]),ye+=rr),qe=K[_e-Ze],ye=wr(ce,ye,Oe[qe]>>3),ye-=3;var Wt=qe<4?0:qe-2>>1;Wt>0&&(_n(ce,ye,_e-Ze-Se[qe]),ye+=Wt);for(var Xt=0;Xt<wt;++Xt)Be[tt]=_e&32767,tt=(tt<<5^Te[_e])&32767,++_e;We-=wt-1}else qe<=143?qe=qe+48:ye=Ct(ce,ye,1),ye=wr(ce,ye,Oe[qe]),Be[tt]=_e&32767,++_e}ye=wr(ce,ye,0)-1}return ce.l=(ye+7)/8|0,ce.l}return function(ce,ye){return ce.length<8?Y(ce,ye):de(ce,ye)}}();function Je(L){var K=Ce(50+Math.floor(L.length*1.1)),H=Ve(L,K);return K.slice(0,H)}var ft=Ne?new Uint16Array(32768):mr(32768),Ae=Ne?new Uint16Array(32768):mr(32768),Me=Ne?new Uint16Array(128):mr(128),Xe=1,ct=1;function sr(L,K){var H=nt(L,K)+257;K+=5;var q=nt(L,K)+1;K+=5;var Q=Dt(L,K)+4;K+=4;for(var Y=0,de=Ne?new Uint8Array(19):mr(19),Te=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ce=1,ye=Ne?new Uint8Array(8):mr(8),_e=Ne?new Uint8Array(8):mr(8),Be=de.length,We=0;We<Q;++We)de[te[We]]=Y=_t(L,K),ce<Y&&(ce=Y),ye[Y]++,K+=3;var tt=0;for(ye[0]=0,We=1;We<=ce;++We)_e[We]=tt=tt+ye[We-1]<<1;for(We=0;We<Be;++We)(tt=de[We])!=0&&(Te[We]=_e[tt]++);var qe=0;for(We=0;We<Be;++We)if(qe=de[We],qe!=0){tt=Oe[Te[We]]>>8-qe;for(var Ze=(1<<7-qe)-1;Ze>=0;--Ze)Me[tt|Ze<<qe]=qe&7|We<<3}var wt=[];for(ce=1;wt.length<H+q;)switch(tt=Me[Ge(L,K)],K+=tt&7,tt>>>=3){case 16:for(Y=3+Pt(L,K),K+=2,tt=wt[wt.length-1];Y-- >0;)wt.push(tt);break;case 17:for(Y=3+_t(L,K),K+=3;Y-- >0;)wt.push(0);break;case 18:for(Y=11+Ge(L,K),K+=7;Y-- >0;)wt.push(0);break;default:wt.push(tt),ce<tt&&(ce=tt);break}var rr=wt.slice(0,H),Wt=wt.slice(H);for(We=H;We<286;++We)rr[We]=0;for(We=q;We<30;++We)Wt[We]=0;return Xe=en(rr,ft,286),ct=en(Wt,Ae,30),K}function Or(L,K){if(L[0]==3&&!(L[1]&3))return[Oo(K),2];for(var H=0,q=0,Q=TT(K||1<<18),Y=0,de=Q.length>>>0,Te=0,ce=0;(q&1)==0;){if(q=_t(L,H),H+=3,q>>>1)q>>1==1?(Te=9,ce=5):(H=sr(L,H),Te=Xe,ce=ct);else{H&7&&(H+=8-(H&7));var ye=L[H>>>3]|L[(H>>>3)+1]<<8;if(H+=32,ye>0)for(!K&&de<Y+ye&&(Q=Dr(Q,Y+ye),de=Q.length);ye-- >0;)Q[Y++]=L[H>>>3],H+=8;continue}for(;;){!K&&de<Y+32767&&(Q=Dr(Q,Y+32767),de=Q.length);var _e=tr(L,H,Te),Be=q>>>1==1?jt[_e]:ft[_e];if(H+=Be&15,Be>>>=4,(Be>>>8&255)===0)Q[Y++]=Be;else{if(Be==256)break;Be-=257;var We=Be<8?0:Be-4>>2;We>5&&(We=0);var tt=Y+fe[Be];We>0&&(tt+=tr(L,H,We),H+=We),_e=tr(L,H,ce),Be=q>>>1==1?oe[_e]:Ae[_e],H+=Be&15,Be>>>=4;var qe=Be<4?0:Be-2>>1,Ze=Se[Be];for(qe>0&&(Ze+=tr(L,H,qe),H+=qe),!K&&de<tt&&(Q=Dr(Q,tt+100),de=Q.length);Y<tt;)Q[Y]=Q[Y-Ze],++Y}}}return K?[Q,H+7>>>3]:[Q.slice(0,Y),H+7>>>3]}function fn(L,K){var H=L.slice(L.l||0),q=Or(H,K);return L.l+=q[1],q[0]}function Rn(L,K){if(L)typeof console<"u"&&console.error(K);else throw new Error(K)}function li(L,K){var H=L;jn(H,0);var q=[],Q=[],Y={FileIndex:q,FullPaths:Q};A(Y,{root:K.root});for(var de=H.length-4;(H[de]!=80||H[de+1]!=75||H[de+2]!=5||H[de+3]!=6)&&de>=0;)--de;H.l=de+4,H.l+=4;var Te=H.read_shift(2);H.l+=6;var ce=H.read_shift(4);for(H.l=ce,de=0;de<Te;++de){H.l+=20;var ye=H.read_shift(4),_e=H.read_shift(4),Be=H.read_shift(2),We=H.read_shift(2),tt=H.read_shift(2);H.l+=8;var qe=H.read_shift(4),Ze=u(H.slice(H.l+Be,H.l+Be+We));H.l+=Be+We+tt;var wt=H.l;H.l=qe+4,se(H,ye,_e,Y,Ze),H.l=wt}return Y}function se(L,K,H,q,Q){L.l+=2;var Y=L.read_shift(2),de=L.read_shift(2),Te=l(L);if(Y&8257)throw new Error("Unsupported ZIP encryption");for(var ce=L.read_shift(4),ye=L.read_shift(4),_e=L.read_shift(4),Be=L.read_shift(2),We=L.read_shift(2),tt="",qe=0;qe<Be;++qe)tt+=String.fromCharCode(L[L.l++]);if(We){var Ze=u(L.slice(L.l,L.l+We));(Ze[21589]||{}).mt&&(Te=Ze[21589].mt),((Q||{})[21589]||{}).mt&&(Te=Q[21589].mt)}L.l+=We;var wt=L.slice(L.l,L.l+ye);switch(de){case 8:wt=X(L,_e);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+de)}var rr=!1;Y&8&&(ce=L.read_shift(4),ce==134695760&&(ce=L.read_shift(4),rr=!0),ye=L.read_shift(4),_e=L.read_shift(4)),ye!=K&&Rn(rr,"Bad compressed size: "+K+" != "+ye),_e!=H&&Rn(rr,"Bad uncompressed size: "+H+" != "+_e),Ht(q,tt,wt,{unsafe:!0,mt:Te})}function Ue(L,K){var H=K||{},q=[],Q=[],Y=Ce(1),de=H.compression?8:0,Te=0,ce=0,ye=0,_e=0,Be=0,We=L.FullPaths[0],tt=We,qe=L.FileIndex[0],Ze=[],wt=0;for(ce=1;ce<L.FullPaths.length;++ce)if(tt=L.FullPaths[ce].slice(We.length),qe=L.FileIndex[ce],!(!qe.size||!qe.content||tt=="Sh33tJ5")){var rr=_e,Wt=Ce(tt.length);for(ye=0;ye<tt.length;++ye)Wt.write_shift(1,tt.charCodeAt(ye)&127);Wt=Wt.slice(0,Wt.l),Ze[Be]=IL.buf(qe.content,0);var Xt=qe.content;de==8&&(Xt=Z(Xt)),Y=Ce(30),Y.write_shift(4,67324752),Y.write_shift(2,20),Y.write_shift(2,Te),Y.write_shift(2,de),qe.mt?s(Y,qe.mt):Y.write_shift(4,0),Y.write_shift(-4,Ze[Be]),Y.write_shift(4,Xt.length),Y.write_shift(4,qe.content.length),Y.write_shift(2,Wt.length),Y.write_shift(2,0),_e+=Y.length,q.push(Y),_e+=Wt.length,q.push(Wt),_e+=Xt.length,q.push(Xt),Y=Ce(46),Y.write_shift(4,33639248),Y.write_shift(2,0),Y.write_shift(2,20),Y.write_shift(2,Te),Y.write_shift(2,de),Y.write_shift(4,0),Y.write_shift(-4,Ze[Be]),Y.write_shift(4,Xt.length),Y.write_shift(4,qe.content.length),Y.write_shift(2,Wt.length),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(4,0),Y.write_shift(4,rr),wt+=Y.l,Q.push(Y),wt+=Wt.length,Q.push(Wt),++Be}return Y=Ce(22),Y.write_shift(4,101010256),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(2,Be),Y.write_shift(2,Be),Y.write_shift(4,wt),Y.write_shift(4,_e),Y.write_shift(2,0),Nn([Nn(q),Nn(Q),Y])}var Qe={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function lt(L,K){if(L.ctype)return L.ctype;var H=L.name||"",q=H.match(/\.([^\.]+)$/);return q&&Qe[q[1]]||K&&(q=(H=K).match(/[\.\\]([^\.\\])+$/),q&&Qe[q[1]])?Qe[q[1]]:"application/octet-stream"}function st(L){for(var K=h0(L),H=[],q=0;q<K.length;q+=76)H.push(K.slice(q,q+76));return H.join(`\r
`)+`\r
`}function Fr(L){var K=L.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ye){var _e=ye.charCodeAt(0).toString(16).toUpperCase();return"="+(_e.length==1?"0"+_e:_e)});K=K.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),K.charAt(0)==`
`&&(K="=0D"+K.slice(1)),K=K.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var H=[],q=K.split(`\r
`),Q=0;Q<q.length;++Q){var Y=q[Q];if(Y.length==0){H.push("");continue}for(var de=0;de<Y.length;){var Te=76,ce=Y.slice(de,de+Te);ce.charAt(Te-1)=="="?Te--:ce.charAt(Te-2)=="="?Te-=2:ce.charAt(Te-3)=="="&&(Te-=3),ce=Y.slice(de,de+Te),de+=Te,de<Y.length&&(ce+="="),H.push(ce)}}return H.join(`\r
`)}function wn(L){for(var K=[],H=0;H<L.length;++H){for(var q=L[H];H<=L.length&&q.charAt(q.length-1)=="=";)q=q.slice(0,q.length-1)+L[++H];K.push(q)}for(var Q=0;Q<K.length;++Q)K[Q]=K[Q].replace(/[=][0-9A-Fa-f]{2}/g,function(Y){return String.fromCharCode(parseInt(Y.slice(1),16))});return Ma(K.join(`\r
`))}function Ur(L,K,H){for(var q="",Q="",Y="",de,Te=0;Te<10;++Te){var ce=K[Te];if(!ce||ce.match(/^\s*$/))break;var ye=ce.match(/^(.*?):\s*([^\s].*)$/);if(ye)switch(ye[1].toLowerCase()){case"content-location":q=ye[2].trim();break;case"content-type":Y=ye[2].trim();break;case"content-transfer-encoding":Q=ye[2].trim();break}}switch(++Te,Q.toLowerCase()){case"base64":de=Ma(Ba(K.slice(Te).join("")));break;case"quoted-printable":de=wn(K.slice(Te));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Q)}var _e=Ht(L,q.slice(H.length),de,{unsafe:!0});Y&&(_e.ctype=Y)}function Ot(L,K){if(ie(L.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var H=K&&K.root||"",q=(Mt&&Buffer.isBuffer(L)?L.toString("binary"):ie(L)).split(`\r
`),Q=0,Y="";for(Q=0;Q<q.length;++Q)if(Y=q[Q],!!/^Content-Location:/i.test(Y)&&(Y=Y.slice(Y.indexOf("file")),H||(H=Y.slice(0,Y.lastIndexOf("/")+1)),Y.slice(0,H.length)!=H))for(;H.length>0&&(H=H.slice(0,H.length-1),H=H.slice(0,H.lastIndexOf("/")+1),Y.slice(0,H.length)!=H););var de=(q[1]||"").match(/boundary="(.*?)"/);if(!de)throw new Error("MAD cannot find boundary");var Te="--"+(de[1]||""),ce=[],ye=[],_e={FileIndex:ce,FullPaths:ye};A(_e);var Be,We=0;for(Q=0;Q<q.length;++Q){var tt=q[Q];tt!==Te&&tt!==Te+"--"||(We++&&Ur(_e,q.slice(Be,Q),H),Be=Q)}return _e}function et(L,K){var H=K||{},q=H.boundary||"SheetJS";q="------="+q;for(var Q=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+q.slice(2)+'"',"","",""],Y=L.FullPaths[0],de=Y,Te=L.FileIndex[0],ce=1;ce<L.FullPaths.length;++ce)if(de=L.FullPaths[ce].slice(Y.length),Te=L.FileIndex[ce],!(!Te.size||!Te.content||de=="Sh33tJ5")){de=de.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(wt){return"_x"+wt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(wt){return"_u"+wt.charCodeAt(0).toString(16)+"_"});for(var ye=Te.content,_e=Mt&&Buffer.isBuffer(ye)?ye.toString("binary"):ie(ye),Be=0,We=Math.min(1024,_e.length),tt=0,qe=0;qe<=We;++qe)(tt=_e.charCodeAt(qe))>=32&&tt<128&&++Be;var Ze=Be>=We*4/5;Q.push(q),Q.push("Content-Location: "+(H.root||"file:///C:/SheetJS/")+de),Q.push("Content-Transfer-Encoding: "+(Ze?"quoted-printable":"base64")),Q.push("Content-Type: "+lt(Te,de)),Q.push(""),Q.push(Ze?Fr(_e):st(_e))}return Q.push(q+`--\r
`),Q.join(`\r
`)}function bt(L){var K={};return A(K,L),K}function Ht(L,K,H,q){var Q=q&&q.unsafe;Q||A(L);var Y=!Q&&ht.find(L,K);if(!Y){var de=L.FullPaths[0];K.slice(0,de.length)==de?de=K:(de.slice(-1)!="/"&&(de+="/"),de=(de+K).replace("//","/")),Y={name:a(K),type:2},L.FileIndex.push(Y),L.FullPaths.push(de),Q||ht.utils.cfb_gc(L)}return Y.content=H,Y.size=H?H.length:0,q&&(q.CLSID&&(Y.clsid=q.CLSID),q.mt&&(Y.mt=q.mt),q.ct&&(Y.ct=q.ct)),Y}function Nt(L,K){A(L);var H=ht.find(L,K);if(H){for(var q=0;q<L.FileIndex.length;++q)if(L.FileIndex[q]==H)return L.FileIndex.splice(q,1),L.FullPaths.splice(q,1),!0}return!1}function Ta(L,K,H){A(L);var q=ht.find(L,K);if(q){for(var Q=0;Q<L.FileIndex.length;++Q)if(L.FileIndex[Q]==q)return L.FileIndex[Q].name=a(H),L.FullPaths[Q]=H,!0}return!1}function pr(L){k(L,!0)}return e.find=P,e.read=B,e.parse=m,e.write=J,e.writeFile=He,e.utils={cfb_new:bt,cfb_add:Ht,cfb_del:Nt,cfb_mov:Ta,cfb_gc:pr,ReadShift:Xf,CheckField:d4,prep_blob:jn,bconcat:Nn,use_zlib:V,_deflateRaw:Je,_inflateRaw:fn,consts:le},e}();function RL(t){return typeof t=="string"?Wm(t):Array.isArray(t)?nL(t):t}function H0(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=Wm(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?Bi(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var a=new Blob([RL(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,t);if(typeof saveAs<"u")return saveAs(a,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=t,l.href=s,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(t);return u.open("w"),u.encoding="binary",Array.isArray(e)&&(e=zo(e)),u.write(e),u.close(),e}catch(f){if(!f.message||!f.message.match(/onstruct/))throw f}throw new Error("cannot save file "+t)}function DL(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Wr(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function RT(t,e){for(var r=[],n=Wr(t),a=0;a!==n.length;++a)r[t[n[a]][e]]==null&&(r[t[n[a]][e]]=n[a]);return r}function Xm(t){for(var e=[],r=Wr(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function $m(t){for(var e=[],r=Wr(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function OL(t){for(var e=[],r=Wr(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var hm=new Date(1899,11,30,0,0,0);function yn(t,e){var r=t.getTime(),n=hm.getTime()+(t.getTimezoneOffset()-hm.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var WA=new Date,FL=hm.getTime()+(WA.getTimezoneOffset()-hm.getTimezoneOffset())*6e4,DT=WA.getTimezoneOffset();function Km(t){var e=new Date;return e.setTime(t*24*60*60*1e3+FL),e.getTimezoneOffset()!==DT&&e.setTime(e.getTime()+(e.getTimezoneOffset()-DT)*6e4),e}function LL(t){var e=0,r=0,n=!1,a=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(r=1,s>3&&(n=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(a[s],10)}return e}var OT=new Date("2017-02-19T19:06:09.000Z"),XA=isNaN(OT.getFullYear())?new Date("2/19/17"):OT,ML=XA.getFullYear()==2017;function Nr(t,e){var r=new Date(t);if(ML)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(XA.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Ml(t,e){if(Mt&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return Bi(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return Bi(OA(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return Bi(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return Bi(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],a=0;a!=t.length;++a)n.push(String.fromCharCode(t[a]));return n.join("")}function Ir(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=Ir(t[r]));return e}function zr(t,e){for(var r="";r.length<e;)r+=t;return r}function xi(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,s){return r=-r,s}),!isNaN(e=Number(n)))?e/r:e}var PL=["january","february","march","april","may","june","july","august","september","october","november","december"];function pu(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),a=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var l=t.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&PL.indexOf(l)==-1)return r}else if(l.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||s>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var jL=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(t||typeof n=="string")return r.split(n);for(var s=r.split(n),l=[s[0]],u=1;u<s.length;++u)l.push(a),l.push(s[u]);return l}}();function $A(t){return t?t.content&&t.type?Ml(t.content,!0):t.data?Pf(t.data):t.asNodeBuffer&&Mt?Pf(t.asNodeBuffer().toString("binary")):t.asBinary?Pf(t.asBinary()):t._data&&t._data.getContent?Pf(Ml(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function KA(t){if(!t)return null;if(t.data)return wT(t.data);if(t.asNodeBuffer&&Mt)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?wT(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function UL(t){return t&&t.name.slice(-4)===".bin"?KA(t):$A(t)}function ni(t,e){for(var r=t.FullPaths||Wr(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var l=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==l||a==l)return t.files?t.files[r[s]]:t.FileIndex[s]}return null}function jv(t,e){var r=ni(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function on(t,e,r){if(!r)return UL(jv(t,e));if(!e)return null;try{return on(t,e)}catch{return null}}function Pa(t,e,r){if(!r)return $A(jv(t,e));if(!e)return null;try{return Pa(t,e)}catch{return null}}function BL(t,e,r){return KA(jv(t,e))}function FT(t){for(var e=t.FullPaths||Wr(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Rt(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Mt?n=Ds(r):n=aL(r),ht.utils.cfb_add(t,e,n)}ht.utils.cfb_add(t,e,r)}else t.file(e,r)}function Uv(){return ht.utils.cfb_new()}function YA(t,e){switch(e.type){case"base64":return ht.read(t,{type:"base64"});case"binary":return ht.read(t,{type:"binary"});case"buffer":case"array":return ht.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Uf(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var Zr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,VL=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,LT=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,zL=/<[^>]*>/g,ta=Zr.match(LT)?LT:zL,HL=/<\w*:/,GL=/<(\/?)\w+:/;function Tt(t,e,r){for(var n={},a=0,s=0;a!==t.length&&!((s=t.charCodeAt(a))===32||s===10||s===13);++a);if(e||(n[0]=t.slice(0,a)),a===t.length)return n;var l=t.match(VL),u=0,f="",d=0,m="",y="",_=1;if(l)for(d=0;d!=l.length;++d){for(y=l[d],s=0;s!=y.length&&y.charCodeAt(s)!==61;++s);for(m=y.slice(0,s).trim();y.charCodeAt(s+1)==32;)++s;for(_=(a=y.charCodeAt(s+1))==34||a==39?1:0,f=y.slice(s+1+_,y.length-_),u=0;u!=m.length&&m.charCodeAt(u)!==58;++u);if(u===m.length)m.indexOf("_")>0&&(m=m.slice(0,m.indexOf("_"))),n[m]=f,n[m.toLowerCase()]=f;else{var E=(u===5&&m.slice(0,5)==="xmlns"?"xmlns":"")+m.slice(u+1);if(n[E]&&m.slice(u-3,u)=="ext")continue;n[E]=f,n[E.toLowerCase()]=f}}return n}function Qi(t){return t.replace(GL,"<$1")}var QA={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Bv=Xm(QA),Zt=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",s=a.indexOf("<![CDATA[");if(s==-1)return a.replace(t,function(u,f){return QA[u]||String.fromCharCode(parseInt(f,u.indexOf("x")>-1?16:10))||u}).replace(e,function(u,f){return String.fromCharCode(parseInt(f,16))});var l=a.indexOf("]]>");return r(a.slice(0,s))+a.slice(s+9,l)+r(a.slice(l+3))}}(),Vv=/[&<>'"]/g,qL=/[\u0000-\u0008\u000b-\u001f]/g;function dr(t){var e=t+"";return e.replace(Vv,function(r){return Bv[r]}).replace(qL,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function MT(t){return dr(t).replace(/ /g,"_x0020_")}var JA=/[\u0000-\u001f]/g;function zv(t){var e=t+"";return e.replace(Vv,function(r){return Bv[r]}).replace(/\n/g,"<br/>").replace(JA,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function WL(t){var e=t+"";return e.replace(Vv,function(r){return Bv[r]}).replace(JA,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var PT=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function XL(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function Ar(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function xx(t){for(var e="",r=0,n=0,a=0,s=0,l=0,u=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(a=t.charCodeAt(r++),n>191&&n<224){l=(n&31)<<6,l|=a&63,e+=String.fromCharCode(l);continue}if(s=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(a&63)<<6|s&63);continue}l=t.charCodeAt(r++),u=((n&7)<<18|(a&63)<<12|(s&63)<<6|l&63)-65536,e+=String.fromCharCode(55296+(u>>>10&1023)),e+=String.fromCharCode(56320+(u&1023))}return e}function jT(t){var e=Oo(2*t.length),r,n,a=1,s=0,l=0,u;for(n=0;n<t.length;n+=a)a=1,(u=t.charCodeAt(n))<128?r=u:u<224?(r=(u&31)*64+(t.charCodeAt(n+1)&63),a=2):u<240?(r=(u&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),a=3):(a=4,r=(u&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,l=55296+(r>>>10&1023),r=56320+(r&1023)),l!==0&&(e[s++]=l&255,e[s++]=l>>>8,l=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function UT(t){return Ds(t,"binary").toString("utf8")}var Ed="foo bar baz",_r=Mt&&(UT(Ed)==xx(Ed)&&UT||jT(Ed)==xx(Ed)&&jT)||xx,Bi=Mt?function(t){return Ds(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,a=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(a>>18&7))),e.push(String.fromCharCode(144+(a>>12&63))),e.push(String.fromCharCode(128+(a>>6&63))),e.push(String.fromCharCode(128+(a&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},m0=function(){var t={};return function(r,n){var a=r+"|"+(n||"");return t[a]?t[a]:t[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),ZA=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<t.length;++a)n=n.replace(t[a][0],t[a][1]);return n}}(),$L=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),KL=/<\/?(?:vt:)?variant>/g,YL=/<(?:vt:)([^>]*)>([\s\S]*)</;function BT(t,e){var r=Tt(t),n=t.match($L(r.baseType))||[],a=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(s){var l=s.replace(KL,"").match(YL);l&&a.push({v:_r(l[2]),t:l[1]})}),a}var e4=/(^\s|\s$|\n)/;function Bn(t,e){return"<"+t+(e.match(e4)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function p0(t){return Wr(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function $e(t,e,r){return"<"+t+(r!=null?p0(r):"")+(e!=null?(e.match(e4)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function m1(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function QL(t,e){switch(typeof t){case"string":var r=$e("vt:lpwstr",dr(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return $e((t|0)==t?"vt:i4":"vt:r8",dr(String(t)));case"boolean":return $e("vt:bool",t?"true":"false")}if(t instanceof Date)return $e("vt:filetime",m1(t));throw new Error("Unable to serialize "+t)}function Hv(t){if(Mt&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return _r(zo(Lv(t)));throw new Error("Bad input format: expected Buffer or string")}var g0=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,gn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Wl=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Oa={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function JL(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),a=t[e+6]&15,s=5;s>=0;--s)a=a*256+t[e+s];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function ZL(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,a=0,s=0,l=n?-e:e;isFinite(l)?l==0?a=s=0:(a=Math.floor(Math.log(l)/Math.LN2),s=l*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(e)?26985:0);for(var u=0;u<=5;++u,s/=256)t[r+u]=s&255;t[r+6]=(a&15)<<4|s&15,t[r+7]=a>>4|n}var VT=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var a=0,s=t[0][n].length;a<s;a+=r)e.push.apply(e,t[0][n].slice(a,a+r));return e},zT=Mt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Ds(e)})):VT(t)}:VT,HT=function(t,e,r){for(var n=[],a=e;a<r;a+=2)n.push(String.fromCharCode(Es(t,a)));return n.join("").replace(ha,"")},Gv=Mt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(ha,""):HT(t,e,r)}:HT,GT=function(t,e,r){for(var n=[],a=e;a<e+r;++a)n.push(("0"+t[a].toString(16)).slice(-2));return n.join("")},t4=Mt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):GT(t,e,r)}:GT,qT=function(t,e,r){for(var n=[],a=e;a<r;a++)n.push(String.fromCharCode(Xc(t,a)));return n.join("")},G0=Mt?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):qT(e,r,n)}:qT,r4=function(t,e){var r=Fa(t,e);return r>0?G0(t,e+4,e+4+r-1):""},n4=r4,a4=function(t,e){var r=Fa(t,e);return r>0?G0(t,e+4,e+4+r-1):""},i4=a4,s4=function(t,e){var r=2*Fa(t,e);return r>0?G0(t,e+4,e+4+r-1):""},o4=s4,l4=function(e,r){var n=Fa(e,r);return n>0?Gv(e,r+4,r+4+n):""},c4=l4,u4=function(t,e){var r=Fa(t,e);return r>0?G0(t,e+4,e+4+r):""},f4=u4,h4=function(t,e){return JL(t,e)},dm=h4,qv=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Mt&&(n4=function(e,r){if(!Buffer.isBuffer(e))return r4(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},i4=function(e,r){if(!Buffer.isBuffer(e))return a4(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},o4=function(e,r){if(!Buffer.isBuffer(e))return s4(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},c4=function(e,r){if(!Buffer.isBuffer(e))return l4(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},f4=function(e,r){if(!Buffer.isBuffer(e))return u4(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},dm=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):h4(e,r)},qv=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Xc=function(t,e){return t[e]},Es=function(t,e){return t[e+1]*256+t[e]},eM=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Fa=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},vl=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},tM=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Xf(t,e){var r="",n,a,s=[],l,u,f,d;switch(e){case"dbcs":if(d=this.l,Mt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(f=0;f<t;++f)r+=String.fromCharCode(Es(this,d)),d+=2;t*=2;break;case"utf8":r=G0(this,this.l,this.l+t);break;case"utf16le":t*=2,r=Gv(this,this.l,this.l+t);break;case"wstr":return Xf.call(this,t,"dbcs");case"lpstr-ansi":r=n4(this,this.l),t=4+Fa(this,this.l);break;case"lpstr-cp":r=i4(this,this.l),t=4+Fa(this,this.l);break;case"lpwstr":r=o4(this,this.l),t=4+2*Fa(this,this.l);break;case"lpp4":t=4+Fa(this,this.l),r=c4(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Fa(this,this.l),r=f4(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(l=Xc(this,this.l+t++))!==0;)s.push(wd(l));r=s.join("");break;case"_wstr":for(t=0,r="";(l=Es(this,this.l+t))!==0;)s.push(wd(l)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",d=this.l,f=0;f<t;++f){if(this.lens&&this.lens.indexOf(d)!==-1)return l=Xc(this,d),this.l=d+1,u=Xf.call(this,t-f,l?"dbcs-cont":"sbcs-cont"),s.join("")+u;s.push(wd(Es(this,d))),d+=2}r=s.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,f=0;f!=t;++f){if(this.lens&&this.lens.indexOf(d)!==-1)return l=Xc(this,d),this.l=d+1,u=Xf.call(this,t-f,l?"dbcs-cont":"sbcs-cont"),s.join("")+u;s.push(wd(Xc(this,d))),d+=1}r=s.join("");break;default:switch(t){case 1:return n=Xc(this,this.l),this.l++,n;case 2:return n=(e==="i"?eM:Es)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(n=(t>0?vl:tM)(this,this.l),this.l+=4,n):(a=Fa(this,this.l),this.l+=4,a);case 8:case-8:if(e==="f")return t==8?a=dm(this,this.l):a=dm([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;t=8;case 16:r=t4(this,this.l,t);break}}return this.l+=t,r}var rM=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},nM=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},aM=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function iM(t,e,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=e.length;++a)aM(this,e.charCodeAt(a),this.l+2*a);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=e.length;++a)this[this.l+a]=e.charCodeAt(a)&255;n=e.length}else if(r==="hex"){for(;a<t;++a)this[this.l++]=parseInt(e.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+t,this.length);for(a=0;a<Math.min(e.length,t);++a){var l=e.charCodeAt(a);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,rM(this,e,this.l);break;case 8:if(n=8,r==="f"){ZL(this,e,this.l);break}case 16:break;case-4:n=4,nM(this,e,this.l);break}return this.l+=n,this}function d4(t,e){var r=t4(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function jn(t,e){t.l=e,t.read_shift=Xf,t.chk=d4,t.write_shift=iM}function ea(t,e){t.l+=e}function Ce(t){var e=Oo(t);return jn(e,0),e}function Os(t,e,r){if(t){var n,a,s;jn(t,t.l||0);for(var l=t.length,u=0,f=0;t.l<l;){u=t.read_shift(1),u&128&&(u=(u&127)+((t.read_shift(1)&127)<<7));var d=E0[u]||E0[65535];for(n=t.read_shift(1),s=n&127,a=1;a<4&&n&128;++a)s+=((n=t.read_shift(1))&127)<<7*a;f=t.l+s;var m=d.f&&d.f(t,s,r);if(t.l=f,e(m,d,u))return}}}function wa(){var t=[],e=Mt?256:2048,r=function(d){var m=Ce(d);return jn(m,0),m},n=r(e),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},s=function(d){return n&&d<n.length-n.l?n:(a(),n=r(Math.max(d+1,e)))},l=function(){return a(),Nn(t)},u=function(d){a(),n=d,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:u,end:l,_bufs:t}}function Pe(t,e,r,n){var a=+e,s;if(!isNaN(a)){n||(n=E0[a].p||(r||[]).length||0),s=1+(a>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var l=t.next(s);a<=127?l.write_shift(1,a):(l.write_shift(1,(a&127)+128),l.write_shift(1,a>>7));for(var u=0;u!=4;++u)if(n>=128)l.write_shift(1,(n&127)+128),n>>=7;else{l.write_shift(1,n);break}n>0&&qv(r)&&t.push(r)}}function $f(t,e,r){var n=Ir(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function WT(t,e,r){var n=Ir(t);return n.s=$f(n.s,e.s,r),n.e=$f(n.e,e.s,r),n}function Kf(t,e){if(t.cRel&&t.c<0)for(t=Ir(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Ir(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=xt(t);return!t.cRel&&t.cRel!=null&&(r=lM(r)),!t.rRel&&t.rRel!=null&&(r=sM(r)),r}function vx(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Mr(t.s.c)+":"+(t.e.cRel?"":"$")+Mr(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Jr(t.s.r)+":"+(t.e.rRel?"":"$")+Jr(t.e.r):Kf(t.s,e.biff)+":"+Kf(t.e,e.biff)}function Wv(t){return parseInt(oM(t),10)-1}function Jr(t){return""+(t+1)}function sM(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function oM(t){return t.replace(/\$(\d+)$/,"$1")}function Xv(t){for(var e=cM(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function Mr(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function lM(t){return t.replace(/^([A-Z])/,"$$$1")}function cM(t){return t.replace(/^\$([A-Z])/,"$1")}function uM(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Pr(t){for(var e=0,r=0,n=0;n<t.length;++n){var a=t.charCodeAt(n);a>=48&&a<=57?e=10*e+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:e-1}}function xt(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function Ea(t){var e=t.indexOf(":");return e==-1?{s:Pr(t),e:Pr(t)}:{s:Pr(t.slice(0,e)),e:Pr(t.slice(e+1))}}function At(t,e){return typeof e>"u"||typeof e=="number"?At(t.s,t.e):(typeof t!="string"&&(t=xt(t)),typeof e!="string"&&(e=xt(e)),t==e?t:t+":"+e)}function er(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,s=t.length;for(r=0;n<s&&!((a=t.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(e.s.c=--r,r=0;n<s&&!((a=t.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(e.s.r=--r,n===s||a!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=s&&!((a=t.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(e.e.c=--r,r=0;n!=s&&!((a=t.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return e.e.r=--r,e}function XT(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Va(t.z,r?yn(e):e)}catch{}try{return t.w=Va((t.XF||{}).numFmtId||(r?14:0),r?yn(e):e)}catch{return""+e}}function Is(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?Fs[t.v]||t.v:e==null?XT(t,t.v):XT(t,e))}function Ho(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function m4(t,e,r){var n=r||{},a=t?Array.isArray(t):n.dense,s=t||(a?[]:{}),l=0,u=0;if(s&&n.origin!=null){if(typeof n.origin=="number")l=n.origin;else{var f=typeof n.origin=="string"?Pr(n.origin):n.origin;l=f.r,u=f.c}s["!ref"]||(s["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var m=er(s["!ref"]);d.s.c=m.s.c,d.s.r=m.s.r,d.e.c=Math.max(d.e.c,m.e.c),d.e.r=Math.max(d.e.r,m.e.r),l==-1&&(d.e.r=l=m.e.r+1)}for(var y=0;y!=e.length;++y)if(e[y]){if(!Array.isArray(e[y]))throw new Error("aoa_to_sheet expects an array of arrays");for(var _=0;_!=e[y].length;++_)if(!(typeof e[y][_]>"u")){var E={v:e[y][_]},b=l+y,w=u+_;if(d.s.r>b&&(d.s.r=b),d.s.c>w&&(d.s.c=w),d.e.r<b&&(d.e.r=b),d.e.c<w&&(d.e.c=w),e[y][_]&&typeof e[y][_]=="object"&&!Array.isArray(e[y][_])&&!(e[y][_]instanceof Date))E=e[y][_];else if(Array.isArray(E.v)&&(E.f=e[y][_][1],E.v=E.v[0]),E.v===null)if(E.f)E.t="n";else if(n.nullError)E.t="e",E.v=0;else if(n.sheetStubs)E.t="z";else continue;else typeof E.v=="number"?E.t="n":typeof E.v=="boolean"?E.t="b":E.v instanceof Date?(E.z=n.dateNF||mt[14],n.cellDates?(E.t="d",E.w=Va(E.z,yn(E.v))):(E.t="n",E.v=yn(E.v),E.w=Va(E.z,E.v))):E.t="s";if(a)s[b]||(s[b]=[]),s[b][w]&&s[b][w].z&&(E.z=s[b][w].z),s[b][w]=E;else{var S=xt({c:w,r:b});s[S]&&s[S].z&&(E.z=s[S].z),s[S]=E}}}return d.s.c<1e7&&(s["!ref"]=At(d)),s}function ku(t,e){return m4(null,t,e)}function fM(t){return t.read_shift(4,"i")}function vi(t,e){return e||(e=Ce(4)),e.write_shift(4,t),e}function Jn(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function In(t,e){var r=!1;return e==null&&(r=!0,e=Ce(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function hM(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function dM(t,e){return e||(e=Ce(4)),e.write_shift(2,0),e.write_shift(2,0),e}function $v(t,e){var r=t.l,n=t.read_shift(1),a=Jn(t),s=[],l={t:a,h:a};if((n&1)!==0){for(var u=t.read_shift(4),f=0;f!=u;++f)s.push(hM(t));l.r=s}else l.r=[{ich:0,ifnt:0}];return t.l=r+e,l}function mM(t,e){var r=!1;return e==null&&(r=!0,e=Ce(15+4*t.t.length)),e.write_shift(1,0),In(t.t,e),r?e.slice(0,e.l):e}var pM=$v;function gM(t,e){var r=!1;return e==null&&(r=!0,e=Ce(23+4*t.t.length)),e.write_shift(1,1),In(t.t,e),e.write_shift(4,1),dM({},e),r?e.slice(0,e.l):e}function oi(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Xl(t,e){return e==null&&(e=Ce(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function $l(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function Kl(t,e){return e==null&&(e=Ce(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var xM=Jn,p4=In;function Kv(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function mm(t,e){var r=!1;return e==null&&(r=!0,e=Ce(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var vM=Jn,p1=Kv,Yv=mm;function Qv(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var a=n===0?dm([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):vl(e,0)>>2;return r?a/100:a}function g4(t,e){e==null&&(e=Ce(4));var r=0,n=0,a=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?a:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function x4(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function yM(t,e){return e||(e=Ce(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var Yl=x4,Au=yM;function Qn(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Pl(t,e){return(e||Ce(8)).write_shift(8,t,"f")}function _M(t){var e={},r=t.read_shift(1),n=r>>>1,a=t.read_shift(1),s=t.read_shift(2,"i"),l=t.read_shift(1),u=t.read_shift(1),f=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=a;var d=bl[a];d&&(e.rgb=v0(d));break;case 2:e.rgb=v0([l,u,f]);break;case 3:e.theme=a;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function pm(t,e){if(e||(e=Ce(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function wM(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function EM(t,e){e||(e=Ce(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function v4(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function TM(t){return v4(t,1)}function bM(t){return v4(t,2)}var Jv=2,xa=3,Td=11,$T=12,gm=19,bd=64,SM=65,kM=71,AM=4108,CM=4126,Cn=80,y4=81,NM=[Cn,y4],g1={1:{n:"CodePage",t:Jv},2:{n:"Category",t:Cn},3:{n:"PresentationFormat",t:Cn},4:{n:"ByteCount",t:xa},5:{n:"LineCount",t:xa},6:{n:"ParagraphCount",t:xa},7:{n:"SlideCount",t:xa},8:{n:"NoteCount",t:xa},9:{n:"HiddenCount",t:xa},10:{n:"MultimediaClipCount",t:xa},11:{n:"ScaleCrop",t:Td},12:{n:"HeadingPairs",t:AM},13:{n:"TitlesOfParts",t:CM},14:{n:"Manager",t:Cn},15:{n:"Company",t:Cn},16:{n:"LinksUpToDate",t:Td},17:{n:"CharacterCount",t:xa},19:{n:"SharedDoc",t:Td},22:{n:"HyperlinksChanged",t:Td},23:{n:"AppVersion",t:xa,p:"version"},24:{n:"DigSig",t:SM},26:{n:"ContentType",t:Cn},27:{n:"ContentStatus",t:Cn},28:{n:"Language",t:Cn},29:{n:"Version",t:Cn},255:{},2147483648:{n:"Locale",t:gm},2147483651:{n:"Behavior",t:gm},1919054434:{}},x1={1:{n:"CodePage",t:Jv},2:{n:"Title",t:Cn},3:{n:"Subject",t:Cn},4:{n:"Author",t:Cn},5:{n:"Keywords",t:Cn},6:{n:"Comments",t:Cn},7:{n:"Template",t:Cn},8:{n:"LastAuthor",t:Cn},9:{n:"RevNumber",t:Cn},10:{n:"EditTime",t:bd},11:{n:"LastPrinted",t:bd},12:{n:"CreatedDate",t:bd},13:{n:"ModifiedDate",t:bd},14:{n:"PageCount",t:xa},15:{n:"WordCount",t:xa},16:{n:"CharCount",t:xa},17:{n:"Thumbnail",t:kM},18:{n:"Application",t:Cn},19:{n:"DocSecurity",t:xa},255:{},2147483648:{n:"Locale",t:gm},2147483651:{n:"Behavior",t:gm},1919054434:{}},KT={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},IM=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function RM(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var DM=RM([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),bl=Ir(DM),Fs={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},_4={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},v1={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Sd={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Zv(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function OM(t){var e=Zv();if(!t||!t.match)return e;var r={};if((t.match(ta)||[]).forEach(function(n){var a=Tt(n);switch(a[0].replace(HL,"<")){case"<?xml":break;case"<Types":e.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":e[v1[a.ContentType]]!==void 0&&e[v1[a.ContentType]].push(a.PartName);break}}),e.xmlns!==gn.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function w4(t,e){var r=OL(v1),n=[],a;n[n.length]=Zr,n[n.length]=$e("Types",null,{xmlns:gn.CT,"xmlns:xsd":gn.xsd,"xmlns:xsi":gn.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(f){return $e("Default",null,{Extension:f[0],ContentType:f[1]})}));var s=function(f){t[f]&&t[f].length>0&&(a=t[f][0],n[n.length]=$e("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:Sd[f][e.bookType]||Sd[f].xlsx}))},l=function(f){(t[f]||[]).forEach(function(d){n[n.length]=$e("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:Sd[f][e.bookType]||Sd[f].xlsx})})},u=function(f){(t[f]||[]).forEach(function(d){n[n.length]=$e("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[f][0]})})};return s("workbooks"),l("sheets"),l("charts"),u("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),l("metadata"),u("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Bt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function x0(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Yf(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(ta)||[]).forEach(function(a){var s=Tt(a);if(s[0]==="<Relationship"){var l={};l.Type=s.Type,l.Target=s.Target,l.Id=s.Id,s.TargetMode&&(l.TargetMode=s.TargetMode);var u=s.TargetMode==="External"?s.Target:Uf(s.Target,e);r[u]=l,n[s.Id]=l}}),r["!id"]=n,r}function su(t){var e=[Zr,$e("Relationships",null,{xmlns:gn.RELS})];return Wr(t["!id"]).forEach(function(r){e[e.length]=$e("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function hr(t,e,r,n,a,s){if(a||(a={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,a.Id="rId"+e,a.Type=n,a.Target=r,[Bt.HLINK,Bt.XPATH,Bt.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),t["!id"][a.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][a.Id]=a,t[("/"+a.Target).replace("//","/")]=a,e}var FM="application/vnd.oasis.opendocument.spreadsheet";function LM(t,e){for(var r=Hv(t),n,a;n=g0.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=Tt(n[0],!1),a.path=="/"&&a.type!==FM)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function MM(t){var e=[Zr];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function YT(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function PM(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function jM(t){var e=[Zr];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(YT(t[r][0],t[r][1])),e.push(PM("",t[r][0]));return e.push(YT("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function E4(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+lm.version+"</meta:generator></office:meta></office:document-meta>"}var si=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],UM=function(){for(var t=new Array(si.length),e=0;e<si.length;++e){var r=si[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function T4(t){var e={};t=_r(t);for(var r=0;r<si.length;++r){var n=si[r],a=t.match(UM[r]);a!=null&&a.length>0&&(e[n[1]]=Zt(a[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=Nr(e[n[1]]))}return e}function yx(t,e,r,n,a){a[t]!=null||e==null||e===""||(a[t]=e,e=dr(e),n[n.length]=r?$e(t,e,r):Bn(t,e))}function b4(t,e){var r=e||{},n=[Zr,$e("cp:coreProperties",null,{"xmlns:cp":gn.CORE_PROPS,"xmlns:dc":gn.dc,"xmlns:dcterms":gn.dcterms,"xmlns:dcmitype":gn.dcmitype,"xmlns:xsi":gn.xsi})],a={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&yx("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:m1(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),t.ModifiedDate!=null&&yx("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:m1(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var s=0;s!=si.length;++s){var l=si[s],u=r.Props&&r.Props[l[1]]!=null?r.Props[l[1]]:t?t[l[1]]:null;u===!0?u="1":u===!1?u="0":typeof u=="number"&&(u=String(u)),u!=null&&yx(l[0],u,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Sl=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],S4=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function k4(t,e,r,n){var a=[];if(typeof t=="string")a=BT(t,n);else for(var s=0;s<t.length;++s)a=a.concat(t[s].map(function(m){return{v:m}}));var l=typeof e=="string"?BT(e,n).map(function(m){return m.v}):e,u=0,f=0;if(l.length>0)for(var d=0;d!==a.length;d+=2){switch(f=+a[d+1].v,a[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=f,r.SheetNames=l.slice(u,u+f);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=f,r.DefinedNames=l.slice(u,u+f);break;case"Charts":case"Diagramme":r.Chartsheets=f,r.ChartNames=l.slice(u,u+f);break}u+=f}}function BM(t,e,r){var n={};return e||(e={}),t=_r(t),Sl.forEach(function(a){var s=(t.match(m0(a[0]))||[])[1];switch(a[2]){case"string":s&&(e[a[1]]=Zt(s));break;case"bool":e[a[1]]=s==="true";break;case"raw":var l=t.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));l&&l.length>0&&(n[a[1]]=l[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&k4(n.HeadingPairs,n.TitlesOfParts,e,r),e}function A4(t){var e=[],r=$e;return t||(t={}),t.Application="SheetJS",e[e.length]=Zr,e[e.length]=$e("Properties",null,{xmlns:gn.EXT_PROPS,"xmlns:vt":gn.vt}),Sl.forEach(function(n){if(t[n[1]]!==void 0){var a;switch(n[2]){case"string":a=dr(String(t[n[1]]));break;case"bool":a=t[n[1]]?"true":"false";break}a!==void 0&&(e[e.length]=r(n[0],a))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+dr(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var VM=/<[^>]+>[^<]*/g;function zM(t,e){var r={},n="",a=t.match(VM);if(a)for(var s=0;s!=a.length;++s){var l=a[s],u=Tt(l);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Zt(u.name);break;case"</property>":n=null;break;default:if(l.indexOf("<vt:")===0){var f=l.split(">"),d=f[0].slice(4),m=f[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[n]=Zt(m);break;case"bool":r[n]=Ar(m);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(m,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(m);break;case"filetime":case"date":r[n]=Nr(m);break;case"cy":case"error":r[n]=Zt(m);break;default:if(d.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",l,d,f)}}else if(l.slice(0,2)!=="</"){if(e.WTF)throw new Error(l)}}}return r}function C4(t){var e=[Zr,$e("Properties",null,{xmlns:gn.CUST_PROPS,"xmlns:vt":gn.vt})];if(!t)return e.join("");var r=1;return Wr(t).forEach(function(a){++r,e[e.length]=$e("property",QL(t[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:dr(a)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var y1={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},_x;function HM(t,e,r){_x||(_x=Xm(y1)),e=_x[e]||e,t[e]=r}function GM(t,e){var r=[];return Wr(y1).map(function(n){for(var a=0;a<si.length;++a)if(si[a][1]==n)return si[a];for(a=0;a<Sl.length;++a)if(Sl[a][1]==n)return Sl[a];throw n}).forEach(function(n){if(t[n[1]]!=null){var a=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(Bn(y1[n[1]]||n[1],a))}}),$e("DocumentProperties",r.join(""),{xmlns:Oa.o})}function qM(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return t&&Wr(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)){for(var l=0;l<si.length;++l)if(s==si[l][1])return;for(l=0;l<Sl.length;++l)if(s==Sl[l][1])return;for(l=0;l<r.length;++l)if(s==r[l])return;var u=t[s],f="string";typeof u=="number"?(f="float",u=String(u)):u===!0||u===!1?(f="boolean",u=u?"1":"0"):u=String(u),a.push($e(MT(s),u,{"dt:dt":f}))}}),e&&Wr(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(t&&Object.prototype.hasOwnProperty.call(t,s))){var l=e[s],u="string";typeof l=="number"?(u="float",l=String(l)):l===!0||l===!1?(u="boolean",l=l?"1":"0"):l instanceof Date?(u="dateTime.tz",l=l.toISOString()):l=String(l),a.push($e(MT(s),l,{"dt:dt":u}))}}),"<"+n+' xmlns="'+Oa.o+'">'+a.join("")+"</"+n+">"}function ey(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function WM(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),a+=s);var l=Ce(8);return l.write_shift(4,n),l.write_shift(4,a),l}function N4(t,e,r){var n=t.l,a=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return a}function I4(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function R4(t,e,r){return e===31?I4(t):N4(t,e,r)}function _1(t,e,r){return R4(t,e,r===!1?0:4)}function XM(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return R4(t,e,0)}function $M(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var a=t.l;r[n]=t.read_shift(0,"lpwstr").replace(ha,""),t.l-a&2&&(t.l+=2)}return r}function KM(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(ha,"");return r}function YM(t){var e=t.l,r=xm(t,y4);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=xm(t,xa);return[r,n]}function QM(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(YM(t));return r}function QT(t,e){for(var r=t.read_shift(4),n={},a=0;a!=r;++a){var s=t.read_shift(4),l=t.read_shift(4);n[s]=t.read_shift(l,e===1200?"utf16le":"utf8").replace(ha,"").replace(jf,"!"),e===1200&&l%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function D4(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function JM(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function xm(t,e,r){var n=t.read_shift(2),a,s=r||{};if(t.l+=2,e!==$T&&n!==e&&NM.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===$T?n:e){case 2:return a=t.read_shift(2,"i"),s.raw||(t.l+=2),a;case 3:return a=t.read_shift(4,"i"),a;case 11:return t.read_shift(4)!==0;case 19:return a=t.read_shift(4),a;case 30:return N4(t,n,4).replace(ha,"");case 31:return I4(t);case 64:return ey(t);case 65:return D4(t);case 71:return JM(t);case 80:return _1(t,n,!s.raw).replace(ha,"");case 81:return XM(t,n).replace(ha,"");case 4108:return QM(t);case 4126:case 4127:return n==4127?$M(t):KM(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function JT(t,e){var r=Ce(4),n=Ce(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=Ce(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=WM(e);break;case 31:case 80:for(n=Ce(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return Nn([r,n])}function ZT(t,e){var r=t.l,n=t.read_shift(4),a=t.read_shift(4),s=[],l=0,u=0,f=-1,d={};for(l=0;l!=a;++l){var m=t.read_shift(4),y=t.read_shift(4);s[l]=[m,y+r]}s.sort(function(j,F){return j[1]-F[1]});var _={};for(l=0;l!=a;++l){if(t.l!==s[l][1]){var E=!0;if(l>0&&e)switch(e[s[l-1][0]].t){case 2:t.l+2===s[l][1]&&(t.l+=2,E=!1);break;case 80:t.l<=s[l][1]&&(t.l=s[l][1],E=!1);break;case 4108:t.l<=s[l][1]&&(t.l=s[l][1],E=!1);break}if((!e||l==0)&&t.l<=s[l][1]&&(E=!1,t.l=s[l][1]),E)throw new Error("Read Error: Expected address "+s[l][1]+" at "+t.l+" :"+l)}if(e){var b=e[s[l][0]];if(_[b.n]=xm(t,b.t,{raw:!0}),b.p==="version"&&(_[b.n]=String(_[b.n]>>16)+"."+("0000"+String(_[b.n]&65535)).slice(-4)),b.n=="CodePage")switch(_[b.n]){case 0:_[b.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:pi(u=_[b.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+_[b.n])}}else if(s[l][0]===1){if(u=_.CodePage=xm(t,Jv),pi(u),f!==-1){var w=t.l;t.l=s[f][1],d=QT(t,u),t.l=w}}else if(s[l][0]===0){if(u===0){f=l,t.l=s[l+1][1];continue}d=QT(t,u)}else{var S=d[s[l][0]],M;switch(t[t.l]){case 65:t.l+=4,M=D4(t);break;case 30:t.l+=4,M=_1(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,M=_1(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,M=t.read_shift(4,"i");break;case 19:t.l+=4,M=t.read_shift(4);break;case 5:t.l+=4,M=t.read_shift(8,"f");break;case 11:t.l+=4,M=Yr(t,4);break;case 64:t.l+=4,M=Nr(ey(t));break;default:throw new Error("unparsed value: "+t[t.l])}_[S]=M}}return t.l=r+n,_}var O4=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function ZM(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function eb(t,e,r){var n=Ce(8),a=[],s=[],l=8,u=0,f=Ce(8),d=Ce(8);if(f.write_shift(4,2),f.write_shift(4,1200),d.write_shift(4,1),s.push(f),a.push(d),l+=8+f.length,!e){d=Ce(8),d.write_shift(4,0),a.unshift(d);var m=[Ce(4)];for(m[0].write_shift(4,t.length),u=0;u<t.length;++u){var y=t[u][0];for(f=Ce(8+2*(y.length+1)+(y.length%2?0:2)),f.write_shift(4,u+2),f.write_shift(4,y.length+1),f.write_shift(0,y,"dbcs");f.l!=f.length;)f.write_shift(1,0);m.push(f)}f=Nn(m),s.unshift(f),l+=8+f.length}for(u=0;u<t.length;++u)if(!(e&&!e[t[u][0]])&&!(O4.indexOf(t[u][0])>-1||S4.indexOf(t[u][0])>-1)&&t[u][1]!=null){var _=t[u][1],E=0;if(e){E=+e[t[u][0]];var b=r[E];if(b.p=="version"&&typeof _=="string"){var w=_.split(".");_=(+w[0]<<16)+(+w[1]||0)}f=JT(b.t,_)}else{var S=ZM(_);S==-1&&(S=31,_=String(_)),f=JT(S,_)}s.push(f),d=Ce(8),d.write_shift(4,e?E:2+u),a.push(d),l+=8+f.length}var M=8*(s.length+1);for(u=0;u<s.length;++u)a[u].write_shift(4,M),M+=s[u].length;return n.write_shift(4,l),n.write_shift(4,s.length),Nn([n].concat(a).concat(s))}function tb(t,e,r){var n=t.content;if(!n)return{};jn(n,0);var a,s,l,u,f=0;n.chk("feff","Byte Order: "),n.read_shift(2);var d=n.read_shift(4),m=n.read_shift(16);if(m!==ht.utils.consts.HEADER_CLSID&&m!==r)throw new Error("Bad PropertySet CLSID "+m);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(s=n.read_shift(16),u=n.read_shift(4),a===1&&u!==n.l)throw new Error("Length mismatch: "+u+" !== "+n.l);a===2&&(l=n.read_shift(16),f=n.read_shift(4));var y=ZT(n,e),_={SystemIdentifier:d};for(var E in y)_[E]=y[E];if(_.FMTID=s,a===1)return _;if(f-n.l==2&&(n.l+=2),n.l!==f)throw new Error("Length mismatch 2: "+n.l+" !== "+f);var b;try{b=ZT(n,null)}catch{}for(E in b)_[E]=b[E];return _.FMTID=[s,l],_}function rb(t,e,r,n,a,s){var l=Ce(a?68:48),u=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,ht.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,a?2:1),l.write_shift(16,e,"hex"),l.write_shift(4,a?68:48);var f=eb(t,r,n);if(u.push(f),a){var d=eb(a,null,null);l.write_shift(16,s,"hex"),l.write_shift(4,68+f.length),u.push(d)}return Nn(u)}function io(t,e){return t.read_shift(e),null}function eP(t,e){e||(e=Ce(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function tP(t,e,r){for(var n=[],a=t.l+e;t.l<a;)n.push(r(t,a-t.l));if(a!==t.l)throw new Error("Slurp error");return n}function Yr(t,e){return t.read_shift(e)===1}function fa(t,e){return e||(e=Ce(2)),e.write_shift(2,+!!t),e}function ln(t){return t.read_shift(2,"u")}function ai(t,e){return e||(e=Ce(2)),e.write_shift(2,t),e}function F4(t,e){return tP(t,e,ln)}function rP(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function L4(t,e,r){return r||(r=Ce(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function q0(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=t.read_shift(1);s&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var l=n?t.read_shift(n,a):"";return l}function nP(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,a=r&8,s=1+(r&1),l=0,u,f={};a&&(l=t.read_shift(2)),n&&(u=t.read_shift(4));var d=s==2?"dbcs-cont":"sbcs-cont",m=e===0?"":t.read_shift(e,d);return a&&(t.l+=4*l),n&&(t.l+=u),f.t=m,a||(f.raw="<t>"+f.t+"</t>",f.r=f.t),f}function aP(t){var e=t.t||"",r=Ce(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=Ce(2*e.length);n.write_shift(2*e.length,e,"utf16le");var a=[r,n];return Nn(a)}function jl(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var a=t.read_shift(1);return a===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function W0(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):jl(t,n,r)}function Ql(t,e,r){if(r.biff>5)return W0(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function M4(t,e,r){return r||(r=Ce(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function iP(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function sP(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var a=t.read_shift((n?e-24:e)>>1,"utf16le").replace(ha,"");return n&&(t.l+=24),a}function oP(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=t.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var s=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=t.read_shift(s>>1,"utf16le").replace(ha,"");return r+l}function lP(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return sP(t);case"0303000000000000c000000000000046":return oP(t);default:throw new Error("Unsupported Moniker "+r)}}function kd(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(ha,""):"";return r}function nb(t,e){e||(e=Ce(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function cP(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=t.read_shift(2);t.l+=2;var s,l,u,f,d="",m,y;a&16&&(s=kd(t,r-t.l)),a&128&&(l=kd(t,r-t.l)),(a&257)===257&&(u=kd(t,r-t.l)),(a&257)===1&&(f=lP(t,r-t.l)),a&8&&(d=kd(t,r-t.l)),a&32&&(m=t.read_shift(16)),a&64&&(y=ey(t)),t.l=r;var _=l||u||f||"";_&&d&&(_+="#"+d),_||(_="#"+d),a&2&&_.charAt(0)=="/"&&_.charAt(1)!="/"&&(_="file://"+_);var E={Target:_};return m&&(E.guid=m),y&&(E.time=y),s&&(E.Tooltip=s),E}function uP(t){var e=Ce(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),s=a>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var l=[8,6815827,6619237,4849780,83];for(r=0;r<l.length;++r)e.write_shift(4,l[r]);if(s==28)n=n.slice(1),nb(n,e);else if(s&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<l.length;++r)e.write_shift(1,parseInt(l[r],16));var u=a>-1?n.slice(0,a):n;for(e.write_shift(4,2*(u.length+1)),r=0;r<u.length;++r)e.write_shift(2,u.charCodeAt(r));e.write_shift(2,0),s&8&&nb(a>-1?n.slice(a+1):"",e)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<l.length;++r)e.write_shift(1,parseInt(l[r],16));for(var f=0;n.slice(f*3,f*3+3)=="../"||n.slice(f*3,f*3+3)=="..\\";)++f;for(e.write_shift(2,f),e.write_shift(4,n.length-3*f+1),r=0;r<n.length-3*f;++r)e.write_shift(1,n.charCodeAt(r+3*f)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function P4(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),a=t.read_shift(1);return[e,r,n,a]}function j4(t,e){var r=P4(t);return r[3]=0,r}function Ji(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function Ul(t,e,r,n){return n||(n=Ce(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function fP(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function hP(t,e,r){return e===0?"":Ql(t,e,r)}function dP(t,e,r){var n=r.biff>8?4:2,a=t.read_shift(n),s=t.read_shift(n,"i"),l=t.read_shift(n,"i");return[a,s,l]}function U4(t){var e=t.read_shift(2),r=Qv(t);return[e,r]}function mP(t,e,r){t.l+=4,e-=4;var n=t.l+e,a=q0(t,e,r),s=t.read_shift(2);if(n-=t.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return t.l+=s,a}function Ym(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),a=t.read_shift(2);return{s:{c:n,r:e},e:{c:a,r}}}function B4(t,e){return e||(e=Ce(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function V4(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),a=t.read_shift(1);return{s:{c:n,r:e},e:{c:a,r}}}var pP=V4;function z4(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function gP(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function xP(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function qn(t){t.l+=2,t.l+=t.read_shift(2)}var vP={0:qn,4:qn,5:qn,6:qn,7:xP,8:qn,9:qn,10:qn,11:qn,12:qn,13:gP,14:qn,15:qn,16:qn,17:qn,18:qn,19:qn,20:qn,21:z4};function yP(t,e){for(var r=t.l+e,n=[];t.l<r;){var a=t.read_shift(2);t.l-=2;try{n.push(vP[a](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function Ad(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function ty(t,e,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=Ce(a);return s.write_shift(2,n),s.write_shift(2,e),a>4&&s.write_shift(2,29282),a>6&&s.write_shift(2,1997),a>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function _P(t,e){return e===0||t.read_shift(2),1200}function wP(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,a=Ql(t,0,r);return t.read_shift(e+n-t.l),a}function EP(t,e){var r=!e||e.biff==8,n=Ce(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function TP(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function bP(t,e,r){var n=t.read_shift(4),a=t.read_shift(1)&3,s=t.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var l=q0(t,0,r);return l.length===0&&(l="Sheet1"),{pos:n,hs:a,dt:s,name:l}}function SP(t,e){var r=!e||e.biff>=8?2:1,n=Ce(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function kP(t,e){for(var r=t.l+e,n=t.read_shift(4),a=t.read_shift(4),s=[],l=0;l!=a&&t.l<r;++l)s.push(nP(t));return s.Count=n,s.Unique=a,s}function AP(t,e){var r=Ce(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],a=0;a<t.length;++a)n[a]=aP(t[a]);var s=Nn([r].concat(n));return s.parts=[r.length].concat(n.map(function(l){return l.length})),s}function CP(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function NP(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function IP(t){var e=fP(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function RP(t){return t.read_shift(2),t.read_shift(4)}function ab(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var a=t.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,a]}function DP(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),a=t.read_shift(2),s=t.read_shift(2),l=t.read_shift(2),u=t.read_shift(2),f=t.read_shift(2),d=t.read_shift(2);return{Pos:[e,r],Dim:[n,a],Flags:s,CurTab:l,FirstTab:u,Selected:f,TabRatio:d}}function OP(){var t=Ce(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function FP(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function LP(t){var e=Ce(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function MP(){}function PP(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=q0(t,0,r),n}function jP(t,e){var r=t.name||"Arial",n=e&&e.biff==5,a=n?15+r.length:16+2*r.length,s=Ce(a);return s.write_shift(2,t.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function UP(t){var e=Ji(t);return e.isst=t.read_shift(4),e}function BP(t,e,r,n){var a=Ce(10);return Ul(t,e,n,a),a.write_shift(4,r),a}function VP(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,a=Ji(t);r.biff==2&&t.l++;var s=W0(t,n-t.l,r);return a.val=s,a}function zP(t,e,r,n,a){var s=!a||a.biff==8,l=Ce(8+ +s+(1+s)*r.length);return Ul(t,e,n,l),l.write_shift(2,r.length),s&&l.write_shift(1,1),l.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),l}function HP(t,e,r){var n=t.read_shift(2),a=Ql(t,0,r);return[n,a]}function GP(t,e,r,n){var a=r&&r.biff==5;n||(n=Ce(a?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(a?1:2,e.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*e.length,e,a?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var qP=Ql;function ib(t,e,r){var n=t.l+e,a=r.biff==8||!r.biff?4:2,s=t.read_shift(a),l=t.read_shift(a),u=t.read_shift(2),f=t.read_shift(2);return t.l=n,{s:{r:s,c:u},e:{r:l,c:f}}}function WP(t,e){var r=e.biff==8||!e.biff?4:2,n=Ce(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function XP(t){var e=t.read_shift(2),r=t.read_shift(2),n=U4(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function $P(t,e){for(var r=t.l+e-2,n=t.read_shift(2),a=t.read_shift(2),s=[];t.l<r;)s.push(U4(t));if(t.l!==r)throw new Error("MulRK read error");var l=t.read_shift(2);if(s.length!=l-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:l,rkrec:s}}function KP(t,e){for(var r=t.l+e-2,n=t.read_shift(2),a=t.read_shift(2),s=[];t.l<r;)s.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var l=t.read_shift(2);if(s.length!=l-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:l,ixfe:s}}function YP(t,e,r,n){var a={},s=t.read_shift(4),l=t.read_shift(4),u=t.read_shift(4),f=t.read_shift(2);return a.patternType=IM[u>>26],n.cellStyles&&(a.alc=s&7,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=l&15,a.dgRight=l>>4&15,a.dgTop=l>>8&15,a.dgBottom=l>>12&15,a.icvLeft=l>>16&127,a.icvRight=l>>23&127,a.grbitDiag=l>>30&3,a.icvTop=u&127,a.icvBottom=u>>7&127,a.icvDiag=u>>14&127,a.dgDiag=u>>21&15,a.icvFore=f&127,a.icvBack=f>>7&127,a.fsxButton=f>>14&1),a}function QP(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=YP(t,e,n.fStyle,r),n}function sb(t,e,r,n){var a=r&&r.biff==5;n||(n=Ce(a?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&a&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function JP(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function ZP(t){var e=Ce(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function ob(t,e,r){var n=Ji(t);(r.biff==2||e==9)&&++t.l;var a=rP(t);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function e9(t,e,r,n,a,s){var l=Ce(8);return Ul(t,e,n,l),L4(r,s,l),l}function t9(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Ji(t),a=Qn(t);return n.val=a,n}function r9(t,e,r,n){var a=Ce(14);return Ul(t,e,n,a),Pl(r,a),a}var lb=hP;function n9(t,e,r){var n=t.l+e,a=t.read_shift(2),s=t.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var l=jl(t,s),u=[];n>t.l;)u.push(W0(t));return[s,a,l,u]}function cb(t,e,r){var n=t.read_shift(2),a,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=mP(t,e-2,r)),s.body=a||t.read_shift(e-2),typeof a=="string"&&(s.Name=a),s}var a9=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function ub(t,e,r){var n=t.l+e,a=t.read_shift(2),s=t.read_shift(1),l=t.read_shift(1),u=t.read_shift(r&&r.biff==2?1:2),f=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),f=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var d=jl(t,l,r);a&32&&(d=a9[d.charCodeAt(0)]);var m=n-t.l;r&&r.biff==2&&--m;var y=n==t.l||u===0||!(m>0)?[]:yB(t,m,r,u);return{chKey:s,Name:d,itab:f,rgce:y}}function H4(t,e,r){if(r.biff<8)return i9(t,e,r);for(var n=[],a=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)n.push(dP(t,r.biff>8?12:6,r));if(t.l!=a)throw new Error("Bad ExternSheet: "+t.l+" != "+a);return n}function i9(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=q0(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function s9(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),a=t.read_shift(2),s=jl(t,n,r),l=jl(t,a,r);return[s,l]}function o9(t,e,r){var n=V4(t);t.l++;var a=t.read_shift(1);return e-=8,[_B(t,e,r),a,n]}function fb(t,e,r){var n=pP(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,xB(t,e,r)]}function l9(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function c9(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),a=t.read_shift(2),s=t.read_shift(2),l=t.read_shift(2),u=Ql(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:a},u,l,s]}}function u9(t,e,r){return c9(t,e,r)}function f9(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Ym(t));return r}function h9(t){var e=Ce(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)B4(t[r],e);return e}function d9(t,e,r){if(r&&r.biff<8)return p9(t,e,r);var n=z4(t),a=yP(t,e-22,n[1]);return{cmo:n,ft:a}}var m9={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var a=t.read_shift(1);return t.l+=a,t.l=r,{fmt:n}}};function p9(t,e,r){t.l+=4;var n=t.read_shift(2),a=t.read_shift(2),s=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var l=[];return l.push((m9[n]||ea)(t,e,r)),{cmo:[a,n,s],ft:l}}function g9(t,e,r){var n=t.l,a="";try{t.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(s)==-1?t.l+=6:l=iP(t,6,r);var u=t.read_shift(2);t.read_shift(2),ln(t,2);var f=t.read_shift(2);t.l+=f;for(var d=1;d<t.lens.length-1;++d){if(t.l-n!=t.lens[d])throw new Error("TxO: bad continue record");var m=t[t.l],y=jl(t,t.lens[d+1]-t.lens[d]-1);if(a+=y,a.length>=(m?u:2*u))break}if(a.length!==u&&a.length!==u*2)throw new Error("cchText: "+u+" != "+a.length);return t.l=n+e,{t:a}}catch{return t.l=n+e,{t:a}}}function x9(t,e){var r=Ym(t);t.l+=16;var n=cP(t,e-24);return[r,n]}function v9(t){var e=Ce(24),r=Pr(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)e.write_shift(1,parseInt(n[a],16));return Nn([e,uP(t[1])])}function y9(t,e){t.read_shift(2);var r=Ym(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(ha,""),[r,n]}function _9(t){var e=t[1].Tooltip,r=Ce(10+2*(e.length+1));r.write_shift(2,2048);var n=Pr(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<e.length;++a)r.write_shift(2,e.charCodeAt(a));return r.write_shift(2,0),r}function w9(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=KT[r]||r,r=t.read_shift(2),e[1]=KT[r]||r,e}function E9(t){return t||(t=Ce(4)),t.write_shift(2,1),t.write_shift(2,1),t}function T9(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(j4(t));return r}function b9(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(j4(t));return r}function S9(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function G4(t,e,r){if(!r.cellStyles)return ea(t,e);var n=r&&r.biff>=12?4:2,a=t.read_shift(n),s=t.read_shift(n),l=t.read_shift(n),u=t.read_shift(n),f=t.read_shift(2);n==2&&(t.l+=2);var d={s:a,e:s,w:l,ixfe:u,flags:f};return(r.biff>=5||!r.biff)&&(d.level=f>>8&7),d}function k9(t,e){var r=Ce(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function A9(t,e){var r={};return e<32||(t.l+=16,r.header=Qn(t),r.footer=Qn(t),t.l+=2),r}function C9(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var a=t.read_shift(1);return t.l+=3,a&16&&(n.area=!0),n}function N9(t){for(var e=Ce(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var I9=Ji,R9=F4,D9=W0;function O9(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),a={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,a}function F9(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Ji(t);++t.l;var a=Ql(t,e-7,r);return n.t="str",n.val=a,n}function L9(t){var e=Ji(t);++t.l;var r=Qn(t);return e.t="n",e.val=r,e}function M9(t,e,r){var n=Ce(15);return Y0(n,t,e),n.write_shift(8,r,"f"),n}function P9(t){var e=Ji(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function j9(t,e,r){var n=Ce(9);return Y0(n,t,e),n.write_shift(2,r),n}function U9(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function B9(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function V9(t,e,r){var n=t.l+e,a=Ji(t),s=t.read_shift(2),l=jl(t,s,r);return t.l=n,a.t="str",a.val=l,a}var z9=[2,3,48,49,131,139,140,245],w1=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Xm({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(u,f){var d=[],m=Oo(1);switch(f.type){case"base64":m=Ma(Ba(u));break;case"binary":m=Ma(u);break;case"buffer":case"array":m=u;break}jn(m,0);var y=m.read_shift(1),_=!!(y&136),E=!1,b=!1;switch(y){case 2:break;case 3:break;case 48:E=!0,_=!0;break;case 49:E=!0,_=!0;break;case 131:break;case 139:break;case 140:b=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+y.toString(16))}var w=0,S=521;y==2&&(w=m.read_shift(2)),m.l+=3,y!=2&&(w=m.read_shift(4)),w>1048576&&(w=1e6),y!=2&&(S=m.read_shift(2));var M=m.read_shift(2),j=f.codepage||1252;y!=2&&(m.l+=16,m.read_shift(1),m[m.l]!==0&&(j=t[m[m.l]]),m.l+=1,m.l+=2),b&&(m.l+=36);for(var F=[],G={},W=Math.min(m.length,y==2?521:S-10-(E?264:0)),B=b?32:11;m.l<W&&m[m.l]!=13;)switch(G={},G.name=f0.utils.decode(j,m.slice(m.l,m.l+B)).replace(/[\u0000\r\n].*$/g,""),m.l+=B,G.type=String.fromCharCode(m.read_shift(1)),y!=2&&!b&&(G.offset=m.read_shift(4)),G.len=m.read_shift(1),y==2&&(G.offset=m.read_shift(2)),G.dec=m.read_shift(1),G.name.length&&F.push(G),y!=2&&(m.l+=b?13:14),G.type){case"B":(!E||G.len!=8)&&f.WTF&&console.log("Skipping "+G.name+":"+G.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+G.name+":"+G.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+G.type)}if(m[m.l]!==13&&(m.l=S-1),m.read_shift(1)!==13)throw new Error("DBF Terminator not found "+m.l+" "+m[m.l]);m.l=S;var A=0,D=0;for(d[0]=[],D=0;D!=F.length;++D)d[0][D]=F[D].name;for(;w-- >0;){if(m[m.l]===42){m.l+=M;continue}for(++m.l,d[++A]=[],D=0,D=0;D!=F.length;++D){var k=m.slice(m.l,m.l+F[D].len);m.l+=F[D].len,jn(k,0);var O=f0.utils.decode(j,k);switch(F[D].type){case"C":O.trim().length&&(d[A][D]=O.replace(/\s+$/,""));break;case"D":O.length===8?d[A][D]=new Date(+O.slice(0,4),+O.slice(4,6)-1,+O.slice(6,8)):d[A][D]=O;break;case"F":d[A][D]=parseFloat(O.trim());break;case"+":case"I":d[A][D]=b?k.read_shift(-4,"i")^2147483648:k.read_shift(4,"i");break;case"L":switch(O.trim().toUpperCase()){case"Y":case"T":d[A][D]=!0;break;case"N":case"F":d[A][D]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+O+"|")}break;case"M":if(!_)throw new Error("DBF Unexpected MEMO for type "+y.toString(16));d[A][D]="##MEMO##"+(b?parseInt(O.trim(),10):k.read_shift(4));break;case"N":O=O.replace(/\u0000/g,"").trim(),O&&O!="."&&(d[A][D]=+O||0);break;case"@":d[A][D]=new Date(k.read_shift(-8,"f")-621356832e5);break;case"T":d[A][D]=new Date((k.read_shift(4)-2440588)*864e5+k.read_shift(4));break;case"Y":d[A][D]=k.read_shift(4,"i")/1e4+k.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[A][D]=-k.read_shift(-8,"f");break;case"B":if(E&&F[D].len==8){d[A][D]=k.read_shift(8,"f");break}case"G":case"P":k.l+=F[D].len;break;case"0":if(F[D].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+F[D].type)}}}if(y!=2&&m.l<m.length&&m[m.l++]!=26)throw new Error("DBF EOF Marker missing "+(m.l-1)+" of "+m.length+" "+m[m.l-1].toString(16));return f&&f.sheetRows&&(d=d.slice(0,f.sheetRows)),f.DBF=F,d}function n(u,f){var d=f||{};d.dateNF||(d.dateNF="yyyymmdd");var m=ku(r(u,d),d);return m["!cols"]=d.DBF.map(function(y){return{wch:y.len,DBF:y}}),delete d.DBF,m}function a(u,f){try{return Ho(n(u,f),f)}catch(d){if(f&&f.WTF)throw d}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function l(u,f){var d=f||{};if(+d.codepage>=0&&pi(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var m=wa(),y=wm(u,{header:1,raw:!0,cellDates:!0}),_=y[0],E=y.slice(1),b=u["!cols"]||[],w=0,S=0,M=0,j=1;for(w=0;w<_.length;++w){if(((b[w]||{}).DBF||{}).name){_[w]=b[w].DBF.name,++M;continue}if(_[w]!=null){if(++M,typeof _[w]=="number"&&(_[w]=_[w].toString(10)),typeof _[w]!="string")throw new Error("DBF Invalid column name "+_[w]+" |"+typeof _[w]+"|");if(_.indexOf(_[w])!==w){for(S=0;S<1024;++S)if(_.indexOf(_[w]+"_"+S)==-1){_[w]+="_"+S;break}}}}var F=er(u["!ref"]),G=[],W=[],B=[];for(w=0;w<=F.e.c-F.s.c;++w){var A="",D="",k=0,O=[];for(S=0;S<E.length;++S)E[S][w]!=null&&O.push(E[S][w]);if(O.length==0||_[w]==null){G[w]="?";continue}for(S=0;S<O.length;++S){switch(typeof O[S]){case"number":D="B";break;case"string":D="C";break;case"boolean":D="L";break;case"object":D=O[S]instanceof Date?"D":"C";break;default:D="C"}k=Math.max(k,String(O[S]).length),A=A&&A!=D?"C":D}k>250&&(k=250),D=((b[w]||{}).DBF||{}).type,D=="C"&&b[w].DBF.len>k&&(k=b[w].DBF.len),A=="B"&&D=="N"&&(A="N",B[w]=b[w].DBF.dec,k=b[w].DBF.len),W[w]=A=="C"||D=="N"?k:s[A]||0,j+=W[w],G[w]=A}var P=m.next(32);for(P.write_shift(4,318902576),P.write_shift(4,E.length),P.write_shift(2,296+32*M),P.write_shift(2,j),w=0;w<4;++w)P.write_shift(4,0);for(P.write_shift(4,0|(+e[DA]||3)<<8),w=0,S=0;w<_.length;++w)if(_[w]!=null){var N=m.next(32),R=(_[w].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);N.write_shift(1,R,"sbcs"),N.write_shift(1,G[w]=="?"?"C":G[w],"sbcs"),N.write_shift(4,S),N.write_shift(1,W[w]||s[G[w]]||0),N.write_shift(1,B[w]||0),N.write_shift(1,2),N.write_shift(4,0),N.write_shift(1,0),N.write_shift(4,0),N.write_shift(4,0),S+=W[w]||s[G[w]]||0}var he=m.next(264);for(he.write_shift(4,13),w=0;w<65;++w)he.write_shift(4,0);for(w=0;w<E.length;++w){var xe=m.next(j);for(xe.write_shift(1,0),S=0;S<_.length;++S)if(_[S]!=null)switch(G[S]){case"L":xe.write_shift(1,E[w][S]==null?63:E[w][S]?84:70);break;case"B":xe.write_shift(8,E[w][S]||0,"f");break;case"N":var ne="0";for(typeof E[w][S]=="number"&&(ne=E[w][S].toFixed(B[S]||0)),M=0;M<W[S]-ne.length;++M)xe.write_shift(1,32);xe.write_shift(1,ne,"sbcs");break;case"D":E[w][S]?(xe.write_shift(4,("0000"+E[w][S].getFullYear()).slice(-4),"sbcs"),xe.write_shift(2,("00"+(E[w][S].getMonth()+1)).slice(-2),"sbcs"),xe.write_shift(2,("00"+E[w][S].getDate()).slice(-2),"sbcs")):xe.write_shift(8,"00000000","sbcs");break;case"C":var le=String(E[w][S]!=null?E[w][S]:"").slice(0,W[S]);for(xe.write_shift(1,le,"sbcs"),M=0;M<W[S]-le.length;++M)xe.write_shift(1,32);break}}return m.next(1).write_shift(1,26),m.end()}return{to_workbook:a,to_sheet:n,from_sheet:l}}(),q4=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Wr(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(_,E){var b=t[E];return typeof b=="number"?ET(b):b},n=function(_,E,b){var w=E.charCodeAt(0)-32<<4|b.charCodeAt(0)-48;return w==59?_:ET(w)};t["|"]=254;function a(_,E){switch(E.type){case"base64":return s(Ba(_),E);case"binary":return s(_,E);case"buffer":return s(Mt&&Buffer.isBuffer(_)?_.toString("binary"):zo(_),E);case"array":return s(Ml(_),E)}throw new Error("Unrecognized type "+E.type)}function s(_,E){var b=_.split(/[\n\r]+/),w=-1,S=-1,M=0,j=0,F=[],G=[],W=null,B={},A=[],D=[],k=[],O=0,P;for(+E.codepage>=0&&pi(+E.codepage);M!==b.length;++M){O=0;var N=b[M].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),R=N.replace(/;;/g,"\0").split(";").map(function(te){return te.replace(/\u0000/g,";")}),he=R[0],xe;if(N.length>0)switch(he){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":R[1].charAt(0)=="P"&&G.push(N.slice(3).replace(/;;/g,";"));break;case"C":var ne=!1,le=!1,He=!1,ie=!1,J=-1,ge=-1;for(j=1;j<R.length;++j)switch(R[j].charAt(0)){case"A":break;case"X":S=parseInt(R[j].slice(1))-1,le=!0;break;case"Y":for(w=parseInt(R[j].slice(1))-1,le||(S=0),P=F.length;P<=w;++P)F[P]=[];break;case"K":xe=R[j].slice(1),xe.charAt(0)==='"'?xe=xe.slice(1,xe.length-1):xe==="TRUE"?xe=!0:xe==="FALSE"?xe=!1:isNaN(xi(xe))?isNaN(pu(xe).getDate())||(xe=Nr(xe)):(xe=xi(xe),W!==null&&ql(W)&&(xe=Km(xe))),ne=!0;break;case"E":ie=!0;var V=ou(R[j].slice(1),{r:w,c:S});F[w][S]=[F[w][S],V];break;case"S":He=!0,F[w][S]=[F[w][S],"S5S"];break;case"G":break;case"R":J=parseInt(R[j].slice(1))-1;break;case"C":ge=parseInt(R[j].slice(1))-1;break;default:if(E&&E.WTF)throw new Error("SYLK bad record "+N)}if(ne&&(F[w][S]&&F[w][S].length==2?F[w][S][0]=xe:F[w][S]=xe,W=null),He){if(ie)throw new Error("SYLK shared formula cannot have own formula");var X=J>-1&&F[J][ge];if(!X||!X[1])throw new Error("SYLK shared formula cannot find base");F[w][S][1]=cC(X[1],{r:w-J,c:S-ge})}break;case"F":var Z=0;for(j=1;j<R.length;++j)switch(R[j].charAt(0)){case"X":S=parseInt(R[j].slice(1))-1,++Z;break;case"Y":for(w=parseInt(R[j].slice(1))-1,P=F.length;P<=w;++P)F[P]=[];break;case"M":O=parseInt(R[j].slice(1))/20;break;case"F":break;case"G":break;case"P":W=G[parseInt(R[j].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(k=R[j].slice(1).split(" "),P=parseInt(k[0],10);P<=parseInt(k[1],10);++P)O=parseInt(k[2],10),D[P-1]=O===0?{hidden:!0}:{wch:O},Fo(D[P-1]);break;case"C":S=parseInt(R[j].slice(1))-1,D[S]||(D[S]={});break;case"R":w=parseInt(R[j].slice(1))-1,A[w]||(A[w]={}),O>0?(A[w].hpt=O,A[w].hpx=xu(O)):O===0&&(A[w].hidden=!0);break;default:if(E&&E.WTF)throw new Error("SYLK bad record "+N)}Z<1&&(W=null);break;default:if(E&&E.WTF)throw new Error("SYLK bad record "+N)}}return A.length>0&&(B["!rows"]=A),D.length>0&&(B["!cols"]=D),E&&E.sheetRows&&(F=F.slice(0,E.sheetRows)),[F,B]}function l(_,E){var b=a(_,E),w=b[0],S=b[1],M=ku(w,E);return Wr(S).forEach(function(j){M[j]=S[j]}),M}function u(_,E){return Ho(l(_,E),E)}function f(_,E,b,w){var S="C;Y"+(b+1)+";X"+(w+1)+";K";switch(_.t){case"n":S+=_.v||0,_.f&&!_.F&&(S+=";E"+oy(_.f,{r:b,c:w}));break;case"b":S+=_.v?"TRUE":"FALSE";break;case"e":S+=_.w||_.v;break;case"d":S+='"'+(_.w||_.v)+'"';break;case"s":S+='"'+_.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return S}function d(_,E){E.forEach(function(b,w){var S="F;W"+(w+1)+" "+(w+1)+" ";b.hidden?S+="0":(typeof b.width=="number"&&!b.wpx&&(b.wpx=y0(b.width)),typeof b.wpx=="number"&&!b.wch&&(b.wch=_0(b.wpx)),typeof b.wch=="number"&&(S+=Math.round(b.wch))),S.charAt(S.length-1)!=" "&&_.push(S)})}function m(_,E){E.forEach(function(b,w){var S="F;";b.hidden?S+="M0;":b.hpt?S+="M"+20*b.hpt+";":b.hpx&&(S+="M"+20*w0(b.hpx)+";"),S.length>2&&_.push(S+"R"+(w+1))})}function y(_,E){var b=["ID;PWXL;N;E"],w=[],S=er(_["!ref"]),M,j=Array.isArray(_),F=`\r
`;b.push("P;PGeneral"),b.push("F;P0;DG0G8;M255"),_["!cols"]&&d(b,_["!cols"]),_["!rows"]&&m(b,_["!rows"]),b.push("B;Y"+(S.e.r-S.s.r+1)+";X"+(S.e.c-S.s.c+1)+";D"+[S.s.c,S.s.r,S.e.c,S.e.r].join(" "));for(var G=S.s.r;G<=S.e.r;++G)for(var W=S.s.c;W<=S.e.c;++W){var B=xt({r:G,c:W});M=j?(_[G]||[])[W]:_[B],!(!M||M.v==null&&(!M.f||M.F))&&w.push(f(M,_,G,W))}return b.join(F)+F+w.join(F)+F+"E"+F}return{to_workbook:u,to_sheet:l,from_sheet:y}}(),W4=function(){function t(s,l){switch(l.type){case"base64":return e(Ba(s),l);case"binary":return e(s,l);case"buffer":return e(Mt&&Buffer.isBuffer(s)?s.toString("binary"):zo(s),l);case"array":return e(Ml(s),l)}throw new Error("Unrecognized type "+l.type)}function e(s,l){for(var u=s.split(`
`),f=-1,d=-1,m=0,y=[];m!==u.length;++m){if(u[m].trim()==="BOT"){y[++f]=[],d=0;continue}if(!(f<0)){var _=u[m].trim().split(","),E=_[0],b=_[1];++m;for(var w=u[m]||"";(w.match(/["]/g)||[]).length&1&&m<u.length-1;)w+=`
`+u[++m];switch(w=w.trim(),+E){case-1:if(w==="BOT"){y[++f]=[],d=0;continue}else if(w!=="EOD")throw new Error("Unrecognized DIF special command "+w);break;case 0:w==="TRUE"?y[f][d]=!0:w==="FALSE"?y[f][d]=!1:isNaN(xi(b))?isNaN(pu(b).getDate())?y[f][d]=b:y[f][d]=Nr(b):y[f][d]=xi(b),++d;break;case 1:w=w.slice(1,w.length-1),w=w.replace(/""/g,'"'),w&&w.match(/^=".*"$/)&&(w=w.slice(2,-1)),y[f][d++]=w!==""?w:null;break}if(w==="EOD")break}}return l&&l.sheetRows&&(y=y.slice(0,l.sheetRows)),y}function r(s,l){return ku(t(s,l),l)}function n(s,l){return Ho(r(s,l),l)}var a=function(){var s=function(f,d,m,y,_){f.push(d),f.push(m+","+y),f.push('"'+_.replace(/"/g,'""')+'"')},l=function(f,d,m,y){f.push(d+","+m),f.push(d==1?'"'+y.replace(/"/g,'""')+'"':y)};return function(f){var d=[],m=er(f["!ref"]),y,_=Array.isArray(f);s(d,"TABLE",0,1,"sheetjs"),s(d,"VECTORS",0,m.e.r-m.s.r+1,""),s(d,"TUPLES",0,m.e.c-m.s.c+1,""),s(d,"DATA",0,0,"");for(var E=m.s.r;E<=m.e.r;++E){l(d,-1,0,"BOT");for(var b=m.s.c;b<=m.e.c;++b){var w=xt({r:E,c:b});if(y=_?(f[E]||[])[b]:f[w],!y){l(d,1,0,"");continue}switch(y.t){case"n":var S=y.w;!S&&y.v!=null&&(S=y.v),S==null?y.f&&!y.F?l(d,1,0,"="+y.f):l(d,1,0,""):l(d,0,S,"V");break;case"b":l(d,0,y.v?1:0,y.v?"TRUE":"FALSE");break;case"s":l(d,1,0,isNaN(y.v)?y.v:'="'+y.v+'"');break;case"d":y.w||(y.w=Va(y.z||mt[14],yn(Nr(y.v)))),l(d,0,y.w,"V");break;default:l(d,1,0,"")}}}l(d,-1,0,"EOD");var M=`\r
`,j=d.join(M);return j}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),X4=function(){function t(y){return y.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(y){return y.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(y,_){for(var E=y.split(`
`),b=-1,w=-1,S=0,M=[];S!==E.length;++S){var j=E[S].trim().split(":");if(j[0]==="cell"){var F=Pr(j[1]);if(M.length<=F.r)for(b=M.length;b<=F.r;++b)M[b]||(M[b]=[]);switch(b=F.r,w=F.c,j[2]){case"t":M[b][w]=t(j[3]);break;case"v":M[b][w]=+j[3];break;case"vtf":var G=j[j.length-1];case"vtc":switch(j[3]){case"nl":M[b][w]=!!+j[4];break;default:M[b][w]=+j[4];break}j[2]=="vtf"&&(M[b][w]=[M[b][w],G])}}}return _&&_.sheetRows&&(M=M.slice(0,_.sheetRows)),M}function n(y,_){return ku(r(y,_),_)}function a(y,_){return Ho(n(y,_),_)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function d(y){if(!y||!y["!ref"])return"";for(var _=[],E=[],b,w="",S=Ea(y["!ref"]),M=Array.isArray(y),j=S.s.r;j<=S.e.r;++j)for(var F=S.s.c;F<=S.e.c;++F)if(w=xt({r:j,c:F}),b=M?(y[j]||[])[F]:y[w],!(!b||b.v==null||b.t==="z")){switch(E=["cell",w,"t"],b.t){case"s":case"str":E.push(e(b.v));break;case"n":b.f?(E[2]="vtf",E[3]="n",E[4]=b.v,E[5]=e(b.f)):(E[2]="v",E[3]=b.v);break;case"b":E[2]="vt"+(b.f?"f":"c"),E[3]="nl",E[4]=b.v?"1":"0",E[5]=e(b.f||(b.v?"TRUE":"FALSE"));break;case"d":var G=yn(Nr(b.v));E[2]="vtc",E[3]="nd",E[4]=""+G,E[5]=b.w||Va(b.z||mt[14],G);break;case"e":continue}_.push(E.join(":"))}return _.push("sheet:c:"+(S.e.c-S.s.c+1)+":r:"+(S.e.r-S.s.r+1)+":tvf:1"),_.push("valueformat:1:text-wiki"),_.join(`
`)}function m(y){return[s,l,u,l,d(y),f].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:m}}(),gu=function(){function t(m,y,_,E,b){b.raw?y[_][E]=m:m===""||(m==="TRUE"?y[_][E]=!0:m==="FALSE"?y[_][E]=!1:isNaN(xi(m))?isNaN(pu(m).getDate())?y[_][E]=m:y[_][E]=Nr(m):y[_][E]=xi(m))}function e(m,y){var _=y||{},E=[];if(!m||m.length===0)return E;for(var b=m.split(/[\r\n]/),w=b.length-1;w>=0&&b[w].length===0;)--w;for(var S=10,M=0,j=0;j<=w;++j)M=b[j].indexOf(" "),M==-1?M=b[j].length:M++,S=Math.max(S,M);for(j=0;j<=w;++j){E[j]=[];var F=0;for(t(b[j].slice(0,S).trim(),E,j,F,_),F=1;F<=(b[j].length-S)/10+1;++F)t(b[j].slice(S+(F-1)*10,S+F*10).trim(),E,j,F,_)}return _.sheetRows&&(E=E.slice(0,_.sheetRows)),E}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(m){for(var y={},_=!1,E=0,b=0;E<m.length;++E)(b=m.charCodeAt(E))==34?_=!_:!_&&b in r&&(y[b]=(y[b]||0)+1);b=[];for(E in y)Object.prototype.hasOwnProperty.call(y,E)&&b.push([y[E],E]);if(!b.length){y=n;for(E in y)Object.prototype.hasOwnProperty.call(y,E)&&b.push([y[E],E])}return b.sort(function(w,S){return w[0]-S[0]||n[w[1]]-n[S[1]]}),r[b.pop()[1]]||44}function s(m,y){var _=y||{},E="",b=_.dense?[]:{},w={s:{c:0,r:0},e:{c:0,r:0}};m.slice(0,4)=="sep="?m.charCodeAt(5)==13&&m.charCodeAt(6)==10?(E=m.charAt(4),m=m.slice(7)):m.charCodeAt(5)==13||m.charCodeAt(5)==10?(E=m.charAt(4),m=m.slice(6)):E=a(m.slice(0,1024)):_&&_.FS?E=_.FS:E=a(m.slice(0,1024));var S=0,M=0,j=0,F=0,G=0,W=E.charCodeAt(0),B=!1,A=0,D=m.charCodeAt(0);m=m.replace(/\r\n/mg,`
`);var k=_.dateNF!=null?CL(_.dateNF):null;function O(){var P=m.slice(F,G),N={};if(P.charAt(0)=='"'&&P.charAt(P.length-1)=='"'&&(P=P.slice(1,-1).replace(/""/g,'"')),P.length===0)N.t="z";else if(_.raw)N.t="s",N.v=P;else if(P.trim().length===0)N.t="s",N.v=P;else if(P.charCodeAt(0)==61)P.charCodeAt(1)==34&&P.charCodeAt(P.length-1)==34?(N.t="s",N.v=P.slice(2,-1).replace(/""/g,'"')):nU(P)?(N.t="n",N.f=P.slice(1)):(N.t="s",N.v=P);else if(P=="TRUE")N.t="b",N.v=!0;else if(P=="FALSE")N.t="b",N.v=!1;else if(!isNaN(j=xi(P)))N.t="n",_.cellText!==!1&&(N.w=P),N.v=j;else if(!isNaN(pu(P).getDate())||k&&P.match(k)){N.z=_.dateNF||mt[14];var R=0;k&&P.match(k)&&(P=NL(P,_.dateNF,P.match(k)||[]),R=1),_.cellDates?(N.t="d",N.v=Nr(P,R)):(N.t="n",N.v=yn(Nr(P,R))),_.cellText!==!1&&(N.w=Va(N.z,N.v instanceof Date?yn(N.v):N.v)),_.cellNF||delete N.z}else N.t="s",N.v=P;if(N.t=="z"||(_.dense?(b[S]||(b[S]=[]),b[S][M]=N):b[xt({c:M,r:S})]=N),F=G+1,D=m.charCodeAt(F),w.e.c<M&&(w.e.c=M),w.e.r<S&&(w.e.r=S),A==W)++M;else if(M=0,++S,_.sheetRows&&_.sheetRows<=S)return!0}e:for(;G<m.length;++G)switch(A=m.charCodeAt(G)){case 34:D===34&&(B=!B);break;case W:case 10:case 13:if(!B&&O())break e;break}return G-F>0&&O(),b["!ref"]=At(w),b}function l(m,y){return!(y&&y.PRN)||y.FS||m.slice(0,4)=="sep="||m.indexOf("	")>=0||m.indexOf(",")>=0||m.indexOf(";")>=0?s(m,y):ku(e(m,y),y)}function u(m,y){var _="",E=y.type=="string"?[0,0,0,0]:py(m,y);switch(y.type){case"base64":_=Ba(m);break;case"binary":_=m;break;case"buffer":y.codepage==65001?_=m.toString("utf8"):y.codepage&&typeof f0<"u"||(_=Mt&&Buffer.isBuffer(m)?m.toString("binary"):zo(m));break;case"array":_=Ml(m);break;case"string":_=m;break;default:throw new Error("Unrecognized type "+y.type)}return E[0]==239&&E[1]==187&&E[2]==191?_=_r(_.slice(3)):y.type!="string"&&y.type!="buffer"&&y.codepage==65001?_=_r(_):y.type=="binary"&&typeof f0<"u",_.slice(0,19)=="socialcalc:version:"?X4.to_sheet(y.type=="string"?_:_r(_),y):l(_,y)}function f(m,y){return Ho(u(m,y),y)}function d(m){for(var y=[],_=er(m["!ref"]),E,b=Array.isArray(m),w=_.s.r;w<=_.e.r;++w){for(var S=[],M=_.s.c;M<=_.e.c;++M){var j=xt({r:w,c:M});if(E=b?(m[w]||[])[M]:m[j],!E||E.v==null){S.push("          ");continue}for(var F=(E.w||(Is(E),E.w)||"").slice(0,10);F.length<10;)F+=" ";S.push(F+(M===0?" ":""))}y.push(S.join(""))}return y.join(`
`)}return{to_workbook:f,to_sheet:u,from_sheet:d}}();function H9(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var a=q4.to_workbook(t,r);return r.WTF=n,a}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return gu.to_workbook(t,e)}}var kl=function(){function t(V,X,Z){if(V){jn(V,V.l||0);for(var te=Z.Enum||J;V.l<V.length;){var fe=V.read_shift(2),Se=te[fe]||te[65535],ke=V.read_shift(2),Ne=V.l+ke,Oe=Se.f&&Se.f(V,ke,Z);if(V.l=Ne,X(Oe,Se,fe))return}}}function e(V,X){switch(X.type){case"base64":return r(Ma(Ba(V)),X);case"binary":return r(Ma(V),X);case"buffer":case"array":return r(V,X)}throw"Unsupported type "+X.type}function r(V,X){if(!V)return V;var Z=X||{},te=Z.dense?[]:{},fe="Sheet1",Se="",ke=0,Ne={},Oe=[],ot=[],ee={s:{r:0,c:0},e:{r:0,c:0}},Pt=Z.sheetRows||0;if(V[2]==0&&(V[3]==8||V[3]==9)&&V.length>=16&&V[14]==5&&V[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(V[2]==2)Z.Enum=J,t(V,function(Ge,tr,Jt){switch(Jt){case 0:Z.vers=Ge,Ge>=4096&&(Z.qpro=!0);break;case 6:ee=Ge;break;case 204:Ge&&(Se=Ge);break;case 222:Se=Ge;break;case 15:case 51:Z.qpro||(Ge[1].v=Ge[1].v.slice(1));case 13:case 14:case 16:Jt==14&&(Ge[2]&112)==112&&(Ge[2]&15)>1&&(Ge[2]&15)<15&&(Ge[1].z=Z.dateNF||mt[14],Z.cellDates&&(Ge[1].t="d",Ge[1].v=Km(Ge[1].v))),Z.qpro&&Ge[3]>ke&&(te["!ref"]=At(ee),Ne[fe]=te,Oe.push(fe),te=Z.dense?[]:{},ee={s:{r:0,c:0},e:{r:0,c:0}},ke=Ge[3],fe=Se||"Sheet"+(ke+1),Se="");var Ct=Z.dense?(te[Ge[0].r]||[])[Ge[0].c]:te[xt(Ge[0])];if(Ct){Ct.t=Ge[1].t,Ct.v=Ge[1].v,Ge[1].z!=null&&(Ct.z=Ge[1].z),Ge[1].f!=null&&(Ct.f=Ge[1].f);break}Z.dense?(te[Ge[0].r]||(te[Ge[0].r]=[]),te[Ge[0].r][Ge[0].c]=Ge[1]):te[xt(Ge[0])]=Ge[1];break}},Z);else if(V[2]==26||V[2]==14)Z.Enum=ge,V[2]==14&&(Z.qpro=!0,V.l=0),t(V,function(Ge,tr,Jt){switch(Jt){case 204:fe=Ge;break;case 22:Ge[1].v=Ge[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ge[3]>ke&&(te["!ref"]=At(ee),Ne[fe]=te,Oe.push(fe),te=Z.dense?[]:{},ee={s:{r:0,c:0},e:{r:0,c:0}},ke=Ge[3],fe="Sheet"+(ke+1)),Pt>0&&Ge[0].r>=Pt)break;Z.dense?(te[Ge[0].r]||(te[Ge[0].r]=[]),te[Ge[0].r][Ge[0].c]=Ge[1]):te[xt(Ge[0])]=Ge[1],ee.e.c<Ge[0].c&&(ee.e.c=Ge[0].c),ee.e.r<Ge[0].r&&(ee.e.r=Ge[0].r);break;case 27:Ge[14e3]&&(ot[Ge[14e3][0]]=Ge[14e3][1]);break;case 1537:ot[Ge[0]]=Ge[1],Ge[0]==ke&&(fe=Ge[1]);break}},Z);else throw new Error("Unrecognized LOTUS BOF "+V[2]);if(te["!ref"]=At(ee),Ne[Se||fe]=te,Oe.push(Se||fe),!ot.length)return{SheetNames:Oe,Sheets:Ne};for(var _t={},Dt=[],nt=0;nt<ot.length;++nt)Ne[Oe[nt]]?(Dt.push(ot[nt]||Oe[nt]),_t[ot[nt]]=Ne[ot[nt]]||Ne[Oe[nt]]):(Dt.push(ot[nt]),_t[ot[nt]]={"!ref":"A1"});return{SheetNames:Dt,Sheets:_t}}function n(V,X){var Z=X||{};if(+Z.codepage>=0&&pi(+Z.codepage),Z.type=="string")throw new Error("Cannot write WK1 to JS string");var te=wa(),fe=er(V["!ref"]),Se=Array.isArray(V),ke=[];Ye(te,0,s(1030)),Ye(te,6,f(fe));for(var Ne=Math.min(fe.e.r,8191),Oe=fe.s.r;Oe<=Ne;++Oe)for(var ot=Jr(Oe),ee=fe.s.c;ee<=fe.e.c;++ee){Oe===fe.s.r&&(ke[ee]=Mr(ee));var Pt=ke[ee]+ot,_t=Se?(V[Oe]||[])[ee]:V[Pt];if(!(!_t||_t.t=="z"))if(_t.t=="n")(_t.v|0)==_t.v&&_t.v>=-32768&&_t.v<=32767?Ye(te,13,E(Oe,ee,_t.v)):Ye(te,14,w(Oe,ee,_t.v));else{var Dt=Is(_t);Ye(te,15,y(Oe,ee,Dt.slice(0,239)))}}return Ye(te,1),te.end()}function a(V,X){var Z=X||{};if(+Z.codepage>=0&&pi(+Z.codepage),Z.type=="string")throw new Error("Cannot write WK3 to JS string");var te=wa();Ye(te,0,l(V));for(var fe=0,Se=0;fe<V.SheetNames.length;++fe)(V.Sheets[V.SheetNames[fe]]||{})["!ref"]&&Ye(te,27,ie(V.SheetNames[fe],Se++));var ke=0;for(fe=0;fe<V.SheetNames.length;++fe){var Ne=V.Sheets[V.SheetNames[fe]];if(!(!Ne||!Ne["!ref"])){for(var Oe=er(Ne["!ref"]),ot=Array.isArray(Ne),ee=[],Pt=Math.min(Oe.e.r,8191),_t=Oe.s.r;_t<=Pt;++_t)for(var Dt=Jr(_t),nt=Oe.s.c;nt<=Oe.e.c;++nt){_t===Oe.s.r&&(ee[nt]=Mr(nt));var Ge=ee[nt]+Dt,tr=ot?(Ne[_t]||[])[nt]:Ne[Ge];if(!(!tr||tr.t=="z"))if(tr.t=="n")Ye(te,23,O(_t,nt,ke,tr.v));else{var Jt=Is(tr);Ye(te,22,A(_t,nt,ke,Jt.slice(0,239)))}}++ke}}return Ye(te,1),te.end()}function s(V){var X=Ce(2);return X.write_shift(2,V),X}function l(V){var X=Ce(26);X.write_shift(2,4096),X.write_shift(2,4),X.write_shift(4,0);for(var Z=0,te=0,fe=0,Se=0;Se<V.SheetNames.length;++Se){var ke=V.SheetNames[Se],Ne=V.Sheets[ke];if(!(!Ne||!Ne["!ref"])){++fe;var Oe=Ea(Ne["!ref"]);Z<Oe.e.r&&(Z=Oe.e.r),te<Oe.e.c&&(te=Oe.e.c)}}return Z>8191&&(Z=8191),X.write_shift(2,Z),X.write_shift(1,fe),X.write_shift(1,te),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(1,1),X.write_shift(1,2),X.write_shift(4,0),X.write_shift(4,0),X}function u(V,X,Z){var te={s:{c:0,r:0},e:{c:0,r:0}};return X==8&&Z.qpro?(te.s.c=V.read_shift(1),V.l++,te.s.r=V.read_shift(2),te.e.c=V.read_shift(1),V.l++,te.e.r=V.read_shift(2),te):(te.s.c=V.read_shift(2),te.s.r=V.read_shift(2),X==12&&Z.qpro&&(V.l+=2),te.e.c=V.read_shift(2),te.e.r=V.read_shift(2),X==12&&Z.qpro&&(V.l+=2),te.s.c==65535&&(te.s.c=te.e.c=te.s.r=te.e.r=0),te)}function f(V){var X=Ce(8);return X.write_shift(2,V.s.c),X.write_shift(2,V.s.r),X.write_shift(2,V.e.c),X.write_shift(2,V.e.r),X}function d(V,X,Z){var te=[{c:0,r:0},{t:"n",v:0},0,0];return Z.qpro&&Z.vers!=20768?(te[0].c=V.read_shift(1),te[3]=V.read_shift(1),te[0].r=V.read_shift(2),V.l+=2):(te[2]=V.read_shift(1),te[0].c=V.read_shift(2),te[0].r=V.read_shift(2)),te}function m(V,X,Z){var te=V.l+X,fe=d(V,X,Z);if(fe[1].t="s",Z.vers==20768){V.l++;var Se=V.read_shift(1);return fe[1].v=V.read_shift(Se,"utf8"),fe}return Z.qpro&&V.l++,fe[1].v=V.read_shift(te-V.l,"cstr"),fe}function y(V,X,Z){var te=Ce(7+Z.length);te.write_shift(1,255),te.write_shift(2,X),te.write_shift(2,V),te.write_shift(1,39);for(var fe=0;fe<te.length;++fe){var Se=Z.charCodeAt(fe);te.write_shift(1,Se>=128?95:Se)}return te.write_shift(1,0),te}function _(V,X,Z){var te=d(V,X,Z);return te[1].v=V.read_shift(2,"i"),te}function E(V,X,Z){var te=Ce(7);return te.write_shift(1,255),te.write_shift(2,X),te.write_shift(2,V),te.write_shift(2,Z,"i"),te}function b(V,X,Z){var te=d(V,X,Z);return te[1].v=V.read_shift(8,"f"),te}function w(V,X,Z){var te=Ce(13);return te.write_shift(1,255),te.write_shift(2,X),te.write_shift(2,V),te.write_shift(8,Z,"f"),te}function S(V,X,Z){var te=V.l+X,fe=d(V,X,Z);if(fe[1].v=V.read_shift(8,"f"),Z.qpro)V.l=te;else{var Se=V.read_shift(2);G(V.slice(V.l,V.l+Se),fe),V.l+=Se}return fe}function M(V,X,Z){var te=X&32768;return X&=-32769,X=(te?V:0)+(X>=8192?X-16384:X),(te?"":"$")+(Z?Mr(X):Jr(X))}var j={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},F=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function G(V,X){jn(V,0);for(var Z=[],te=0,fe="",Se="",ke="",Ne="";V.l<V.length;){var Oe=V[V.l++];switch(Oe){case 0:Z.push(V.read_shift(8,"f"));break;case 1:Se=M(X[0].c,V.read_shift(2),!0),fe=M(X[0].r,V.read_shift(2),!1),Z.push(Se+fe);break;case 2:{var ot=M(X[0].c,V.read_shift(2),!0),ee=M(X[0].r,V.read_shift(2),!1);Se=M(X[0].c,V.read_shift(2),!0),fe=M(X[0].r,V.read_shift(2),!1),Z.push(ot+ee+":"+Se+fe)}break;case 3:if(V.l<V.length){console.error("WK1 premature formula end");return}break;case 4:Z.push("("+Z.pop()+")");break;case 5:Z.push(V.read_shift(2));break;case 6:{for(var Pt="";Oe=V[V.l++];)Pt+=String.fromCharCode(Oe);Z.push('"'+Pt.replace(/"/g,'""')+'"')}break;case 8:Z.push("-"+Z.pop());break;case 23:Z.push("+"+Z.pop());break;case 22:Z.push("NOT("+Z.pop()+")");break;case 20:case 21:Ne=Z.pop(),ke=Z.pop(),Z.push(["AND","OR"][Oe-20]+"("+ke+","+Ne+")");break;default:if(Oe<32&&F[Oe])Ne=Z.pop(),ke=Z.pop(),Z.push(ke+F[Oe]+Ne);else if(j[Oe]){if(te=j[Oe][1],te==69&&(te=V[V.l++]),te>Z.length){console.error("WK1 bad formula parse 0x"+Oe.toString(16)+":|"+Z.join("|")+"|");return}var _t=Z.slice(-te);Z.length-=te,Z.push(j[Oe][0]+"("+_t.join(",")+")")}else return Oe<=7?console.error("WK1 invalid opcode "+Oe.toString(16)):Oe<=24?console.error("WK1 unsupported op "+Oe.toString(16)):Oe<=30?console.error("WK1 invalid opcode "+Oe.toString(16)):Oe<=115?console.error("WK1 unsupported function opcode "+Oe.toString(16)):console.error("WK1 unrecognized opcode "+Oe.toString(16))}}Z.length==1?X[1].f=""+Z[0]:console.error("WK1 bad formula parse |"+Z.join("|")+"|")}function W(V){var X=[{c:0,r:0},{t:"n",v:0},0];return X[0].r=V.read_shift(2),X[3]=V[V.l++],X[0].c=V[V.l++],X}function B(V,X){var Z=W(V);return Z[1].t="s",Z[1].v=V.read_shift(X-4,"cstr"),Z}function A(V,X,Z,te){var fe=Ce(6+te.length);fe.write_shift(2,V),fe.write_shift(1,Z),fe.write_shift(1,X),fe.write_shift(1,39);for(var Se=0;Se<te.length;++Se){var ke=te.charCodeAt(Se);fe.write_shift(1,ke>=128?95:ke)}return fe.write_shift(1,0),fe}function D(V,X){var Z=W(V);Z[1].v=V.read_shift(2);var te=Z[1].v>>1;if(Z[1].v&1)switch(te&7){case 0:te=(te>>3)*5e3;break;case 1:te=(te>>3)*500;break;case 2:te=(te>>3)/20;break;case 3:te=(te>>3)/200;break;case 4:te=(te>>3)/2e3;break;case 5:te=(te>>3)/2e4;break;case 6:te=(te>>3)/16;break;case 7:te=(te>>3)/64;break}return Z[1].v=te,Z}function k(V,X){var Z=W(V),te=V.read_shift(4),fe=V.read_shift(4),Se=V.read_shift(2);if(Se==65535)return te===0&&fe===3221225472?(Z[1].t="e",Z[1].v=15):te===0&&fe===3489660928?(Z[1].t="e",Z[1].v=42):Z[1].v=0,Z;var ke=Se&32768;return Se=(Se&32767)-16446,Z[1].v=(1-ke*2)*(fe*Math.pow(2,Se+32)+te*Math.pow(2,Se)),Z}function O(V,X,Z,te){var fe=Ce(14);if(fe.write_shift(2,V),fe.write_shift(1,Z),fe.write_shift(1,X),te==0)return fe.write_shift(4,0),fe.write_shift(4,0),fe.write_shift(2,65535),fe;var Se=0,ke=0,Ne=0,Oe=0;return te<0&&(Se=1,te=-te),ke=Math.log2(te)|0,te/=Math.pow(2,ke-31),Oe=te>>>0,(Oe&2147483648)==0&&(te/=2,++ke,Oe=te>>>0),te-=Oe,Oe|=2147483648,Oe>>>=0,te*=Math.pow(2,32),Ne=te>>>0,fe.write_shift(4,Ne),fe.write_shift(4,Oe),ke+=16383+(Se?32768:0),fe.write_shift(2,ke),fe}function P(V,X){var Z=k(V);return V.l+=X-14,Z}function N(V,X){var Z=W(V),te=V.read_shift(4);return Z[1].v=te>>6,Z}function R(V,X){var Z=W(V),te=V.read_shift(8,"f");return Z[1].v=te,Z}function he(V,X){var Z=R(V);return V.l+=X-10,Z}function xe(V,X){return V[V.l+X-1]==0?V.read_shift(X,"cstr"):""}function ne(V,X){var Z=V[V.l++];Z>X-1&&(Z=X-1);for(var te="";te.length<Z;)te+=String.fromCharCode(V[V.l++]);return te}function le(V,X,Z){if(!(!Z.qpro||X<21)){var te=V.read_shift(1);V.l+=17,V.l+=1,V.l+=2;var fe=V.read_shift(X-21,"cstr");return[te,fe]}}function He(V,X){for(var Z={},te=V.l+X;V.l<te;){var fe=V.read_shift(2);if(fe==14e3){for(Z[fe]=[0,""],Z[fe][0]=V.read_shift(2);V[V.l];)Z[fe][1]+=String.fromCharCode(V[V.l]),V.l++;V.l++}}return Z}function ie(V,X){var Z=Ce(5+V.length);Z.write_shift(2,14e3),Z.write_shift(2,X);for(var te=0;te<V.length;++te){var fe=V.charCodeAt(te);Z[Z.l++]=fe>127?95:fe}return Z[Z.l++]=0,Z}var J={0:{n:"BOF",f:ln},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:_},14:{n:"NUMBER",f:b},15:{n:"LABEL",f:m},16:{n:"FORMULA",f:S},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:m},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:xe},222:{n:"SHEETNAMELP",f:ne},65535:{n:""}},ge={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:B},23:{n:"NUMBER17",f:k},24:{n:"NUMBER18",f:D},25:{n:"FORMULA19",f:P},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:He},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:N},38:{n:"??"},39:{n:"NUMBER27",f:R},40:{n:"FORMULA28",f:he},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:xe},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:le},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:e}}();function G9(t){var e={},r=t.match(ta),n=0,a=!1;if(r)for(;n!=r.length;++n){var s=Tt(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=Dv[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+s[0])}}return e}var q9=function(){var t=m0("t"),e=m0("rPr");function r(s){var l=s.match(t);if(!l)return{t:"s",v:""};var u={t:"s",v:Zt(l[1])},f=s.match(e);return f&&(u.s=G9(f[1])),u}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(l){return l.replace(n,"").split(a).map(r).filter(function(u){return u.v})}}(),W9=function(){var e=/(\r\n|\n)/g;function r(a,s,l){var u=[];a.u&&u.push("text-decoration: underline;"),a.uval&&u.push("text-underline-style:"+a.uval+";"),a.sz&&u.push("font-size:"+a.sz+"pt;"),a.outline&&u.push("text-effect: outline;"),a.shadow&&u.push("text-shadow: auto;"),s.push('<span style="'+u.join("")+'">'),a.b&&(s.push("<b>"),l.push("</b>")),a.i&&(s.push("<i>"),l.push("</i>")),a.strike&&(s.push("<s>"),l.push("</s>"));var f=a.valign||"";return f=="superscript"||f=="super"?f="sup":f=="subscript"&&(f="sub"),f!=""&&(s.push("<"+f+">"),l.push("</"+f+">")),l.push("</span>"),a}function n(a){var s=[[],a.v,[]];return a.v?(a.s&&r(a.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),X9=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,$9=/<(?:\w+:)?r>/,K9=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function ry(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Zt(_r(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=_r(t),r&&(n.h=zv(n.t))):t.match($9)&&(n.r=_r(t),n.t=Zt(_r((t.replace(K9,"").match(X9)||[]).join("").replace(ta,""))),r&&(n.h=W9(q9(n.r)))),n):{t:""}}var Y9=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Q9=/<(?:\w+:)?(?:si|sstItem)>/g,J9=/<\/(?:\w+:)?(?:si|sstItem)>/;function Z9(t,e){var r=[],n="";if(!t)return r;var a=t.match(Y9);if(a){n=a[2].replace(Q9,"").split(J9);for(var s=0;s!=n.length;++s){var l=ry(n[s].trim(),e);l!=null&&(r[r.length]=l)}a=Tt(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var e7=/^\s|\s$|[\t\n\r]/;function $4(t,e){if(!e.bookSST)return"";var r=[Zr];r[r.length]=$e("sst",null,{xmlns:Wl[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var a=t[n],s="<si>";a.r?s+=a.r:(s+="<t",a.t||(a.t=""),a.t.match(e7)&&(s+=' xml:space="preserve"'),s+=">"+dr(a.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function t7(t){return[t.read_shift(4),t.read_shift(4)]}function r7(t,e){var r=[],n=!1;return Os(t,function(s,l,u){switch(u){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(l.T,!n||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function n7(t,e){return e||(e=Ce(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var a7=mM;function i7(t){var e=wa();Pe(e,159,n7(t));for(var r=0;r<t.length;++r)Pe(e,19,a7(t[r]));return Pe(e,160),e.end()}function K4(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function Ss(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function s7(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Ss(t,4),e.U=Ss(t,4),e.W=Ss(t,4),e}function o7(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},a=t.read_shift(4),s=[];a-- >0;)s.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=s,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function l7(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(o7(t));return e}function c7(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function u7(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Ss(t,4),e.U=Ss(t,4),e.W=Ss(t,4),e}function f7(t){var e=u7(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function Y4(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function Q4(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function h7(t){var e=Ss(t);switch(e.Minor){case 2:return[e.Minor,d7(t)];case 3:return[e.Minor,m7()];case 4:return[e.Minor,p7(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function d7(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=Y4(t,r),a=Q4(t,t.length-t.l);return{t:"Std",h:n,v:a}}function m7(){throw new Error("File is password-protected: ECMA-376 Extensible")}function p7(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(ta,function(s){var l=Tt(s);switch(Qi(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(u){n[u]=l[u]});break;case"<dataIntegrity":n.encryptedHmacKey=l.encryptedHmacKey,n.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(l);break;default:throw l[0]}}),n}function g7(t,e){var r={},n=r.EncryptionVersionInfo=Ss(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var a=t.read_shift(4);return e-=4,r.EncryptionHeader=Y4(t,a),e-=a,r.EncryptionVerifier=Q4(t,e),r}function x7(t){var e={},r=e.EncryptionVersionInfo=Ss(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function ny(t){var e=0,r,n=K4(t),a=n.length+1,s,l,u,f,d;for(r=Oo(a),r[0]=n.length,s=1;s!=a;++s)r[s]=n[s-1];for(s=a-1;s>=0;--s)l=r[s],u=(e&16384)===0?0:1,f=e<<1&32767,d=u|f,e=d^l;return e^52811}var J4=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(l){return(l/2|l*128)&255},a=function(l,u){return n(l^u)},s=function(l){for(var u=e[l.length-1],f=104,d=l.length-1;d>=0;--d)for(var m=l[d],y=0;y!=7;++y)m&64&&(u^=r[f]),m*=2,--f;return u};return function(l){for(var u=K4(l),f=s(u),d=u.length,m=Oo(16),y=0;y!=16;++y)m[y]=0;var _,E,b;for((d&1)===1&&(_=f>>8,m[d]=a(t[0],_),--d,_=f&255,E=u[u.length-1],m[d]=a(E,_));d>0;)--d,_=f>>8,m[d]=a(u[d],_),--d,_=f&255,m[d]=a(u[d],_);for(d=15,b=15-u.length;b>0;)_=f>>8,m[d]=a(t[b],_),--d,--b,_=f&255,m[d]=a(u[d],_),--d,--b;return m}}(),v7=function(t,e,r,n,a){a||(a=e),n||(n=J4(t));var s,l;for(s=0;s!=e.length;++s)l=e[s],l^=n[r],l=(l>>5|l<<3)&255,a[s]=l,++r;return[a,r,n]},y7=function(t){var e=0,r=J4(t);return function(n){var a=v7("",n,e,r);return e=a[1],a[0]}};function _7(t,e,r,n){var a={key:ln(t),verificationBytes:ln(t)};return r.password&&(a.verifier=ny(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=y7(r.password)),a}function w7(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=x7(t):n.Data=g7(t,e),n}function E7(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?w7(t,e-2,n):_7(t,r.biff>=8?e:e-2,r,n),n}var Z4=function(){function t(a,s){switch(s.type){case"base64":return e(Ba(a),s);case"binary":return e(a,s);case"buffer":return e(Mt&&Buffer.isBuffer(a)?a.toString("binary"):zo(a),s);case"array":return e(Ml(a),s)}throw new Error("Unrecognized type "+s.type)}function e(a,s){var l=s||{},u=l.dense?[]:{},f=a.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(m,y){Array.isArray(u)&&(u[y]=[]);for(var _=/\\\w+\b/g,E=0,b,w=-1;b=_.exec(m);){switch(b[0]){case"\\cell":var S=m.slice(E,_.lastIndex-b[0].length);if(S[0]==" "&&(S=S.slice(1)),++w,S.length){var M={v:S,t:"s"};Array.isArray(u)?u[y][w]=M:u[xt({r:y,c:w})]=M}break}E=_.lastIndex}w>d.e.c&&(d.e.c=w)}),u["!ref"]=At(d),u}function r(a,s){return Ho(t(a,s),s)}function n(a){for(var s=["{\\rtf1\\ansi"],l=er(a["!ref"]),u,f=Array.isArray(a),d=l.s.r;d<=l.e.r;++d){s.push("\\trowd\\trautofit1");for(var m=l.s.c;m<=l.e.c;++m)s.push("\\cellx"+(m+1));for(s.push("\\pard\\intbl"),m=l.s.c;m<=l.e.c;++m){var y=xt({r:d,c:m});u=f?(a[d]||[])[m]:a[y],!(!u||u.v==null&&(!u.f||u.F))&&(s.push(" "+(u.w||(Is(u),u.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function T7(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function v0(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function b7(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,a=Math.max(e,r,n),s=Math.min(e,r,n),l=a-s;if(l===0)return[0,0,e];var u=0,f=0,d=a+s;switch(f=l/(d>1?2-d:d),a){case e:u=((r-n)/l+6)%6;break;case r:u=(n-e)/l+2;break;case n:u=(e-r)/l+4;break}return[u/6,f,d/2]}function S7(t){var e=t[0],r=t[1],n=t[2],a=r*2*(n<.5?n:1-n),s=n-a/2,l=[s,s,s],u=6*e,f;if(r!==0)switch(u|0){case 0:case 6:f=a*u,l[0]+=a,l[1]+=f;break;case 1:f=a*(2-u),l[0]+=f,l[1]+=a;break;case 2:f=a*(u-2),l[1]+=a,l[2]+=f;break;case 3:f=a*(4-u),l[1]+=f,l[2]+=a;break;case 4:f=a*(u-4),l[2]+=a,l[0]+=f;break;case 5:f=a*(6-u),l[2]+=f,l[0]+=a;break}for(var d=0;d!=3;++d)l[d]=Math.round(l[d]*255);return l}function vm(t,e){if(e===0)return t;var r=b7(T7(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),v0(S7(r))}var eC=6,k7=15,A7=1,Yn=eC;function y0(t){return Math.floor((t+Math.round(128/Yn)/256)*Yn)}function _0(t){return Math.floor((t-5)/Yn*100+.5)/100}function ym(t){return Math.round((t*Yn+5)/Yn*256)/256}function wx(t){return ym(_0(y0(t)))}function ay(t){var e=Math.abs(t-wx(t)),r=Yn;if(e>.005)for(Yn=A7;Yn<k7;++Yn)Math.abs(t-wx(t))<=e&&(e=Math.abs(t-wx(t)),r=Yn);Yn=r}function Fo(t){t.width?(t.wpx=y0(t.width),t.wch=_0(t.wpx),t.MDW=Yn):t.wpx?(t.wch=_0(t.wpx),t.width=ym(t.wch),t.MDW=Yn):typeof t.wch=="number"&&(t.width=ym(t.wch),t.wpx=y0(t.width),t.MDW=Yn),t.customWidth&&delete t.customWidth}var C7=96,tC=C7;function w0(t){return t*96/tC}function xu(t){return t*tC/96}var N7={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function I7(t,e,r,n){e.Borders=[];var a={},s=!1;(t[0].match(ta)||[]).forEach(function(l){var u=Tt(l);switch(Qi(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},u.diagonalUp&&(a.diagonalUp=Ar(u.diagonalUp)),u.diagonalDown&&(a.diagonalDown=Ar(u.diagonalDown)),e.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+u[0]+" in borders")}})}function R7(t,e,r,n){e.Fills=[];var a={},s=!1;(t[0].match(ta)||[]).forEach(function(l){var u=Tt(l);switch(Qi(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},e.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":u.patternType&&(a.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),u.indexed&&(a.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(a.bgColor.theme=parseInt(u.theme,10)),u.tint&&(a.bgColor.tint=parseFloat(u.tint)),u.rgb&&(a.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),u.theme&&(a.fgColor.theme=parseInt(u.theme,10)),u.tint&&(a.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(a.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+u[0]+" in fills")}})}function D7(t,e,r,n){e.Fonts=[];var a={},s=!1;(t[0].match(ta)||[]).forEach(function(l){var u=Tt(l);switch(Qi(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(a),a={};break;case"<name":u.val&&(a.name=_r(u.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=u.val?Ar(u.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=u.val?Ar(u.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(u.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=u.val?Ar(u.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=u.val?Ar(u.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=u.val?Ar(u.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=u.val?Ar(u.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=u.val?Ar(u.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":u.val&&(a.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(a.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(a.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(a.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=Dv[parseInt(u.val,10)];break;case"<color":if(a.color||(a.color={}),u.auto&&(a.color.auto=Ar(u.auto)),u.rgb)a.color.rgb=u.rgb.slice(-6);else if(u.indexed){a.color.index=parseInt(u.indexed,10);var f=bl[a.color.index];a.color.index==81&&(f=bl[1]),f||(f=bl[1]),a.color.rgb=f[0].toString(16)+f[1].toString(16)+f[2].toString(16)}else u.theme&&(a.color.theme=parseInt(u.theme,10),u.tint&&(a.color.tint=parseFloat(u.tint)),u.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=vm(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+u[0]+" in fonts")}})}function O7(t,e,r){e.NumberFmt=[];for(var n=Wr(mt),a=0;a<n.length;++a)e.NumberFmt[n[a]]=mt[n[a]];var s=t[0].match(ta);if(s)for(a=0;a<s.length;++a){var l=Tt(s[a]);switch(Qi(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=Zt(_r(l.formatCode)),f=parseInt(l.numFmtId,10);if(e.NumberFmt[f]=u,f>0){if(f>392){for(f=392;f>60&&e.NumberFmt[f]!=null;--f);e.NumberFmt[f]=u}$i(u,f)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}function F7(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=$e("numFmt",null,{numFmtId:n,formatCode:dr(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=$e("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var Cd=["numFmtId","fillId","fontId","borderId","xfId"],Nd=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function L7(t,e,r){e.CellXf=[];var n,a=!1;(t[0].match(ta)||[]).forEach(function(s){var l=Tt(s),u=0;switch(Qi(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=l,delete n[0],u=0;u<Cd.length;++u)n[Cd[u]]&&(n[Cd[u]]=parseInt(n[Cd[u]],10));for(u=0;u<Nd.length;++u)n[Nd[u]]&&(n[Nd[u]]=Ar(n[Nd[u]]));if(e.NumberFmt&&n.numFmtId>392){for(u=392;u>60;--u)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[u]){n.numFmtId=u;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var f={};l.vertical&&(f.vertical=l.vertical),l.horizontal&&(f.horizontal=l.horizontal),l.textRotation!=null&&(f.textRotation=l.textRotation),l.indent&&(f.indent=l.indent),l.wrapText&&(f.wrapText=Ar(l.wrapText)),n.alignment=f;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}function M7(t){var e=[];return e[e.length]=$e("cellXfs",null),t.forEach(function(r){e[e.length]=$e("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=$e("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var P7=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,f,d){var m={};if(!u)return m;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var y;return(y=u.match(e))&&O7(y,m,d),(y=u.match(a))&&D7(y,m,f,d),(y=u.match(n))&&R7(y,m,f,d),(y=u.match(s))&&I7(y,m,f,d),(y=u.match(r))&&L7(y,m,d),m}}();function rC(t,e){var r=[Zr,$e("styleSheet",null,{xmlns:Wl[0],"xmlns:vt":gn.vt})],n;return t.SSF&&(n=F7(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=M7(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function j7(t,e){var r=t.read_shift(2),n=Jn(t);return[r,n]}function U7(t,e,r){r||(r=Ce(6+4*e.length)),r.write_shift(2,t),In(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function B7(t,e,r){var n={};n.sz=t.read_shift(2)/20;var a=wM(t);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=t.read_shift(2);switch(s===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var l=t.read_shift(1);l!=0&&(n.underline=l);var u=t.read_shift(1);u>0&&(n.family=u);var f=t.read_shift(1);switch(f>0&&(n.charset=f),t.l++,n.color=_M(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Jn(t),n}function V7(t,e){e||(e=Ce(25+4*32)),e.write_shift(2,t.sz*20),EM(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),pm(t.color,e);var n=0;return n=2,e.write_shift(1,n),In(t.name,e),e.length>e.l?e.slice(0,e.l):e}var z7=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Ex,H7=ea;function hb(t,e){e||(e=Ce(4*3+8*7+16*1)),Ex||(Ex=Xm(z7));var r=Ex[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(pm({auto:1},e),pm({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function G7(t,e){var r=t.l+e,n=t.read_shift(2),a=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:a}}function nC(t,e,r){r||(r=Ce(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Nf(t,e){return e||(e=Ce(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var q7=ea;function W7(t,e){return e||(e=Ce(51)),e.write_shift(1,0),Nf(null,e),Nf(null,e),Nf(null,e),Nf(null,e),Nf(null,e),e.length>e.l?e.slice(0,e.l):e}function X7(t,e){return e||(e=Ce(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),mm(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function $7(t,e,r){var n=Ce(2052);return n.write_shift(4,t),mm(e,n),mm(r,n),n.length>n.l?n.slice(0,n.l):n}function K7(t,e,r){var n={};n.NumberFmt=[];for(var a in mt)n.NumberFmt[a]=mt[a];n.CellXf=[],n.Fonts=[];var s=[],l=!1;return Os(t,function(f,d,m){switch(m){case 44:n.NumberFmt[f[0]]=f[1],$i(f[1],f[0]);break;case 43:n.Fonts.push(f),f.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(f.color.rgb=vm(e.themeElements.clrScheme[f.color.theme].rgb,f.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(f);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:s.push(m),l=!0;break;case 38:s.pop(),l=!1;break;default:if(d.T>0)s.push(m);else if(d.T<0)s.pop();else if(!l||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+m.toString(16))}}),n}function Y7(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&++r}),r!=0&&(Pe(t,615,vi(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&Pe(t,44,U7(a,e[a]))}),Pe(t,616))}}function Q7(t){var e=1;Pe(t,611,vi(e)),Pe(t,43,V7({sz:12,color:{theme:1},name:"Calibri",family:2})),Pe(t,612)}function J7(t){var e=2;Pe(t,603,vi(e)),Pe(t,45,hb({patternType:"none"})),Pe(t,45,hb({patternType:"gray125"})),Pe(t,604)}function Z7(t){var e=1;Pe(t,613,vi(e)),Pe(t,46,W7()),Pe(t,614)}function ej(t){var e=1;Pe(t,626,vi(e)),Pe(t,47,nC({numFmtId:0},65535)),Pe(t,627)}function tj(t,e){Pe(t,617,vi(e.length)),e.forEach(function(r){Pe(t,47,nC(r,0))}),Pe(t,618)}function rj(t){var e=1;Pe(t,619,vi(e)),Pe(t,48,X7({xfId:0,name:"Normal"})),Pe(t,620)}function nj(t){var e=0;Pe(t,505,vi(e)),Pe(t,506)}function aj(t){var e=0;Pe(t,508,$7(e,"TableStyleMedium9","PivotStyleMedium4")),Pe(t,509)}function ij(t,e){var r=wa();return Pe(r,278),Y7(r,t.SSF),Q7(r),J7(r),Z7(r),ej(r),tj(r,e.cellXfs),rj(r),nj(r),aj(r),Pe(r,279),r.end()}var sj=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function oj(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(ta)||[]).forEach(function(a){var s=Tt(a);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[sj.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function lj(){}function cj(){}var uj=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,fj=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,hj=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function dj(t,e,r){e.themeElements={};var n;[["clrScheme",uj,oj],["fontScheme",fj,lj],["fmtScheme",hj,cj]].forEach(function(a){if(!(n=t.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,e,r)})}var mj=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function aC(t,e){(!t||t.length===0)&&(t=iy());var r,n={};if(!(r=t.match(mj)))throw new Error("themeElements not found in theme");return dj(r[0],n,e),n.raw=t,n}function iy(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[Zr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function pj(t,e,r){var n=t.l+e,a=t.read_shift(4);if(a!==124226){if(!r.cellStyles){t.l=n;return}var s=t.slice(t.l);t.l=n;var l;try{l=YA(s,{type:"array"})}catch{return}var u=Pa(l,"theme/theme/theme1.xml",!0);if(u)return aC(u,r)}}function gj(t){return t.read_shift(4)}function xj(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=vj(t,4);break;case 2:e.xclrValue=P4(t);break;case 3:e.xclrValue=gj(t);break;case 4:t.l+=4;break}return t.l+=8,e}function vj(t,e){return ea(t,e)}function yj(t,e){return ea(t,e)}function _j(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=xj(t);break;case 6:n[1]=yj(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function wj(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var a=t.read_shift(2),s=[];a-- >0;)s.push(_j(t,r-t.l));return{ixfe:n,ext:s}}function Ej(t,e){e.forEach(function(r){r[0]})}function Tj(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:Jn(t)}}function bj(t){var e=Ce(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),In(t.name,e),e.slice(0,e.l)}function Sj(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function kj(t){var e=Ce(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function Aj(t,e){var r=Ce(8+2*e.length);return r.write_shift(4,t),In(e,r),r.slice(0,r.l)}function Cj(t){return t.l+=4,t.read_shift(4)!=0}function Nj(t,e){var r=Ce(8);return r.write_shift(4,t),r.write_shift(4,1),r}function Ij(t,e,r){var n={Types:[],Cell:[],Value:[]},a=r||{},s=[],l=!1,u=2;return Os(t,function(f,d,m){switch(m){case 335:n.Types.push({name:f.name});break;case 51:f.forEach(function(y){u==1?n.Cell.push({type:n.Types[y[0]-1].name,index:y[1]}):u==0&&n.Value.push({type:n.Types[y[0]-1].name,index:y[1]})});break;case 337:u=f?1:0;break;case 338:u=2;break;case 35:s.push(m),l=!0;break;case 36:s.pop(),l=!1;break;default:if(!d.T){if(!l||a.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}}),n}function Rj(){var t=wa();return Pe(t,332),Pe(t,334,vi(1)),Pe(t,335,bj({name:"XLDAPR",version:12e4,flags:3496657072})),Pe(t,336),Pe(t,339,Aj(1,"XLDAPR")),Pe(t,52),Pe(t,35,vi(514)),Pe(t,4096,vi(0)),Pe(t,4097,ai(1)),Pe(t,36),Pe(t,53),Pe(t,340),Pe(t,337,Nj(1)),Pe(t,51,kj([[1,0]])),Pe(t,338),Pe(t,333),t.end()}function Dj(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var a=!1,s=2,l;return t.replace(ta,function(u){var f=Tt(u);switch(Qi(f[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:f.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<n.Types.length;++d)n.Types[d].name==f.name&&(l=n.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[f.t-1].name,index:+f.v}):s==0&&n.Value.push({type:n.Types[f.t-1].name,index:+f.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+f.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+f[0]+" in metadata")}return u}),n}function iC(){var t=[Zr];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function Oj(t){var e=[];if(!t)return e;var r=1;return(t.match(ta)||[]).forEach(function(n){var a=Tt(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,e.push(a);break}}),e}function Fj(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=xt(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function Lj(t,e,r){var n=[];return Os(t,function(s,l,u){switch(u){case 63:n.push(s);break;default:if(!l.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function Mj(t,e,r,n){if(!t)return t;var a=n||{},s=!1;Os(t,function(u,f,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!f.T){if(!s||a.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},a)}function Pj(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var Kc=1024;function sC(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[$e("xml",null,{"xmlns:v":Oa.v,"xmlns:o":Oa.o,"xmlns:x":Oa.x,"xmlns:mv":Oa.mv}).replace(/\/>/,">"),$e("o:shapelayout",$e("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),$e("v:shapetype",[$e("v:stroke",null,{joinstyle:"miter"}),$e("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Kc<t*1e3;)Kc+=1e3;return e.forEach(function(s){var l=Pr(s[0]),u={color2:"#BEFF82",type:"gradient"};u.type=="gradient"&&(u.angle="-180");var f=u.type=="gradient"?$e("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=$e("v:fill",f,u),m={on:"t",obscured:"t"};++Kc,a=a.concat(["<v:shape"+p0({id:"_x0000_s"+Kc,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,$e("v:shadow",null,m),$e("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Bn("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),Bn("x:AutoFill","False"),Bn("x:Row",String(l.r)),Bn("x:Column",String(l.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function db(t,e,r,n){var a=Array.isArray(t),s;e.forEach(function(l){var u=Pr(l.ref);if(a?(t[u.r]||(t[u.r]=[]),s=t[u.r][u.c]):s=t[l.ref],!s){s={t:"z"},a?t[u.r][u.c]=s:t[l.ref]=s;var f=er(t["!ref"]||"BDWGO1000001:A1");f.s.r>u.r&&(f.s.r=u.r),f.e.r<u.r&&(f.e.r=u.r),f.s.c>u.c&&(f.s.c=u.c),f.e.c<u.c&&(f.e.c=u.c);var d=At(f);d!==t["!ref"]&&(t["!ref"]=d)}s.c||(s.c=[]);var m={a:l.author,t:l.t,r:l.r,T:r};l.h&&(m.h=l.h);for(var y=s.c.length-1;y>=0;--y){if(!r&&s.c[y].T)return;r&&!s.c[y].T&&s.c.splice(y,1)}if(r&&n){for(y=0;y<n.length;++y)if(m.a==n[y].id){m.a=n[y].name||m.a;break}}s.c.push(m)})}function jj(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var u=l.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&r.push(u[1])}});var s=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var u=l.match(/<(?:\w+:)?comment[^>]*>/);if(u){var f=Tt(u[0]),d={author:f.authorId&&r[f.authorId]||"sheetjsghost",ref:f.ref,guid:f.guid},m=Pr(f.ref);if(!(e.sheetRows&&e.sheetRows<=m.r)){var y=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),_=!!y&&!!y[1]&&ry(y[1])||{r:"",t:"",h:""};d.r=_.r,_.r=="<t></t>"&&(_.t=_.h=""),d.t=(_.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(d.h=_.h),n.push(d)}}}}),n}function oC(t){var e=[Zr,$e("comments",null,{xmlns:Wl[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(a){var s=dr(a.a);r.indexOf(s)==-1&&(r.push(s),e.push("<author>"+s+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),e.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var a=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(f){f.a&&(a=r.indexOf(dr(f.a))),s.push(f.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),s.length<=1)e.push(Bn("t",dr(s[0]||"")));else{for(var l=`Comment:
    `+s[0]+`
`,u=1;u<s.length;++u)l+=`Reply:
    `+s[u]+`
`;e.push(Bn("t",dr(l)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function Uj(t,e){var r=[],n=!1,a={},s=0;return t.replace(ta,function(u,f){var d=Tt(u);switch(Qi(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":s=f+u.length;break;case"</text>":a.t=t.slice(s,f).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return u}),r}function Bj(t,e,r){var n=[Zr,$e("ThreadedComments",null,{xmlns:gn.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(a){var s="";(a[1]||[]).forEach(function(l,u){if(!l.T){delete l.ID;return}l.a&&e.indexOf(l.a)==-1&&e.push(l.a);var f={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};u==0?s=f.id:f.parentId=s,l.ID=f.id,l.a&&(f.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(l.a)).slice(-12)+"}"),n.push($e("threadedComment",Bn("text",l.t||""),f))})}),n.push("</ThreadedComments>"),n.join("")}function Vj(t,e){var r=[],n=!1;return t.replace(ta,function(s){var l=Tt(s);switch(Qi(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return s}),r}function zj(t){var e=[Zr,$e("personList",null,{xmlns:gn.TCMNT,"xmlns:x":Wl[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push($e("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function Hj(t){var e={};e.iauthor=t.read_shift(4);var r=Yl(t);return e.rfx=r.s,e.ref=xt(r.s),t.l+=16,e}function Gj(t,e){return e==null&&(e=Ce(36)),e.write_shift(4,t[1].iauthor),Au(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var qj=Jn;function Wj(t){return In(t.slice(0,54))}function Xj(t,e){var r=[],n=[],a={},s=!1;return Os(t,function(u,f,d){switch(d){case 632:n.push(u);break;case 635:a=u;break;case 637:a.t=u.t,a.h=u.h,a.r=u.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,e.sheetRows&&a.rfx&&e.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!f.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function $j(t){var e=wa(),r=[];return Pe(e,628),Pe(e,630),t.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),Pe(e,632,Wj(a.a)))})}),Pe(e,631),Pe(e,633),t.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var s={s:Pr(n[0]),e:Pr(n[0])};Pe(e,635,Gj([s,a])),a.t&&a.t.length>0&&Pe(e,637,gM(a)),Pe(e,636),delete a.iauthor})}),Pe(e,634),Pe(e,629),e.end()}var Kj="application/vnd.ms-office.vbaProject";function Yj(t){var e=ht.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");ht.utils.cfb_add(e,a,t.FileIndex[n].content)}}),ht.write(e)}function Qj(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&ht.utils.cfb_add(t,a,e.FileIndex[n].content)}})}var lC=["xlsb","xlsm","xlam","biff8","xla"];function Jj(){return{"!type":"dialog"}}function Zj(){return{"!type":"dialog"}}function eU(){return{"!type":"macro"}}function tU(){return{"!type":"macro"}}var ou=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,a,s,l){var u=!1,f=!1;s.length==0?f=!0:s.charAt(0)=="["&&(f=!0,s=s.slice(1,-1)),l.length==0?u=!0:l.charAt(0)=="["&&(u=!0,l=l.slice(1,-1));var d=s.length>0?parseInt(s,10)|0:0,m=l.length>0?parseInt(l,10)|0:0;return u?m+=e.c:--m,f?d+=e.r:--d,a+(u?"":"$")+Mr(m)+(f?"":"$")+Jr(d)}return function(a,s){return e=s,a.replace(t,r)}}(),sy=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,oy=function(){return function(e,r){return e.replace(sy,function(n,a,s,l,u,f){var d=Xv(l)-(s?0:r.c),m=Wv(f)-(u?0:r.r),y=m==0?"":u?m+1:"["+m+"]",_=d==0?"":s?d+1:"["+d+"]";return a+"R"+y+"C"+_})}}();function cC(t,e){return t.replace(sy,function(r,n,a,s,l,u){return n+(a=="$"?a+s:Mr(Xv(s)+e.c))+(l=="$"?l+u:Jr(Wv(u)+e.r))})}function rU(t,e,r){var n=Ea(e),a=n.s,s=Pr(r),l={r:s.r-a.r,c:s.c-a.c};return cC(t,l)}function nU(t){return t.length!=1}function mb(t){return t.replace(/_xlfn\./g,"")}function an(t){t.l+=1}function Lo(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function uC(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return fC(t);r.biff==12&&(n=4)}var a=t.read_shift(n),s=t.read_shift(n),l=Lo(t),u=Lo(t);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:s,c:u[0],cRel:u[1],rRel:u[2]}}}function fC(t){var e=Lo(t),r=Lo(t),n=t.read_shift(1),a=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function aU(t,e,r){if(r.biff<8)return fC(t);var n=t.read_shift(r.biff==12?4:2),a=t.read_shift(r.biff==12?4:2),s=Lo(t),l=Lo(t);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function hC(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return iU(t);var n=t.read_shift(r&&r.biff==12?4:2),a=Lo(t);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function iU(t){var e=Lo(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function sU(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function oU(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return lU(t);var a=t.read_shift(n>=12?4:2),s=t.read_shift(2),l=(s&16384)>>14,u=(s&32768)>>15;if(s&=16383,u==1)for(;a>524287;)a-=1048576;if(l==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:l,rRel:u}}function lU(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,a=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),a==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:a,rRel:n}}function cU(t,e,r){var n=(t[t.l++]&96)>>5,a=uC(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function uU(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var l=uC(t,s,r);return[n,a,l]}function fU(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function hU(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[n,a]}function dU(t,e,r){var n=(t[t.l++]&96)>>5,a=aU(t,e-1,r);return[n,a]}function mU(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function pb(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function pU(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),a=[],s=0;s<=n;++s)a.push(t.read_shift(r&&r.biff==2?1:2));return a}function gU(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function xU(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function vU(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function yU(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function dC(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function _U(t){return t.read_shift(2),dC(t)}function wU(t){return t.read_shift(2),dC(t)}function EU(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=hC(t,0,r);return[n,a]}function TU(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=oU(t,0,r);return[n,a]}function bU(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=hC(t,0,r);return[n,a,s]}function SU(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(r&&r.biff<=3?1:2);return[CB[a],gC[a],n]}function kU(t,e,r){var n=t[t.l++],a=t.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:AU(t);return[a,(s[0]===0?gC:AB)[s[1]]]}function AU(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function CU(t,e,r){t.l+=r&&r.biff==2?3:4}function NU(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function IU(t){return t.l++,Fs[t.read_shift(1)]}function RU(t){return t.l++,t.read_shift(2)}function DU(t){return t.l++,t.read_shift(1)!==0}function OU(t){return t.l++,Qn(t)}function FU(t,e,r){return t.l++,q0(t,e-1,r)}function LU(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Yr(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=Fs[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Qn(t);break;case 2:r[1]=Ql(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function MU(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),a=[],s=0;s!=n;++s)a.push((r.biff==12?Yl:Ym)(t));return a}function PU(t,e,r){var n=0,a=0;r.biff==12?(n=t.read_shift(4),a=t.read_shift(4)):(a=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var s=0,l=[];s!=n&&(l[s]=[]);++s)for(var u=0;u!=a;++u)l[s][u]=LU(t,r.biff);return l}function jU(t,e,r){var n=t.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,s=t.read_shift(a);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,s]}function UU(t,e,r){if(r.biff==5)return BU(t);var n=t.read_shift(1)>>>5&3,a=t.read_shift(2),s=t.read_shift(4);return[n,a,s]}function BU(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function VU(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function zU(t,e,r){var n=t.read_shift(1)>>>5&3,a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function HU(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function GU(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[n,a]}var qU=ea,WU=ea,XU=ea;function X0(t,e,r){return t.l+=2,[sU(t)]}function ly(t){return t.l+=6,[]}var $U=X0,KU=ly,YU=ly,QU=X0;function mC(t){return t.l+=2,[ln(t),t.read_shift(2)&1]}var JU=X0,ZU=mC,eB=ly,tB=X0,rB=X0,nB=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function aB(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),a=t.read_shift(2),s=t.read_shift(2),l=nB[r>>2&31];return{ixti:e,coltype:r&3,rt:l,idx:n,c:a,C:s}}function iB(t){return t.l+=2,[t.read_shift(4)]}function sB(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function oB(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function lB(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function cB(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function uB(t){return t.l+=4,[0,0]}var gb={1:{n:"PtgExp",f:NU},2:{n:"PtgTbl",f:XU},3:{n:"PtgAdd",f:an},4:{n:"PtgSub",f:an},5:{n:"PtgMul",f:an},6:{n:"PtgDiv",f:an},7:{n:"PtgPower",f:an},8:{n:"PtgConcat",f:an},9:{n:"PtgLt",f:an},10:{n:"PtgLe",f:an},11:{n:"PtgEq",f:an},12:{n:"PtgGe",f:an},13:{n:"PtgGt",f:an},14:{n:"PtgNe",f:an},15:{n:"PtgIsect",f:an},16:{n:"PtgUnion",f:an},17:{n:"PtgRange",f:an},18:{n:"PtgUplus",f:an},19:{n:"PtgUminus",f:an},20:{n:"PtgPercent",f:an},21:{n:"PtgParen",f:an},22:{n:"PtgMissArg",f:an},23:{n:"PtgStr",f:FU},26:{n:"PtgSheet",f:sB},27:{n:"PtgEndSheet",f:oB},28:{n:"PtgErr",f:IU},29:{n:"PtgBool",f:DU},30:{n:"PtgInt",f:RU},31:{n:"PtgNum",f:OU},32:{n:"PtgArray",f:mU},33:{n:"PtgFunc",f:SU},34:{n:"PtgFuncVar",f:kU},35:{n:"PtgName",f:jU},36:{n:"PtgRef",f:EU},37:{n:"PtgArea",f:cU},38:{n:"PtgMemArea",f:VU},39:{n:"PtgMemErr",f:qU},40:{n:"PtgMemNoMem",f:WU},41:{n:"PtgMemFunc",f:zU},42:{n:"PtgRefErr",f:HU},43:{n:"PtgAreaErr",f:fU},44:{n:"PtgRefN",f:TU},45:{n:"PtgAreaN",f:dU},46:{n:"PtgMemAreaN",f:lB},47:{n:"PtgMemNoMemN",f:cB},57:{n:"PtgNameX",f:UU},58:{n:"PtgRef3d",f:bU},59:{n:"PtgArea3d",f:uU},60:{n:"PtgRefErr3d",f:GU},61:{n:"PtgAreaErr3d",f:hU},255:{}},fB={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},hB={1:{n:"PtgElfLel",f:mC},2:{n:"PtgElfRw",f:tB},3:{n:"PtgElfCol",f:$U},6:{n:"PtgElfRwV",f:rB},7:{n:"PtgElfColV",f:QU},10:{n:"PtgElfRadical",f:JU},11:{n:"PtgElfRadicalS",f:eB},13:{n:"PtgElfColS",f:KU},15:{n:"PtgElfColSV",f:YU},16:{n:"PtgElfRadicalLel",f:ZU},25:{n:"PtgList",f:aB},29:{n:"PtgSxName",f:iB},255:{}},dB={0:{n:"PtgAttrNoop",f:uB},1:{n:"PtgAttrSemi",f:yU},2:{n:"PtgAttrIf",f:xU},4:{n:"PtgAttrChoose",f:pU},8:{n:"PtgAttrGoto",f:gU},16:{n:"PtgAttrSum",f:CU},32:{n:"PtgAttrBaxcel",f:pb},33:{n:"PtgAttrBaxcel",f:pb},64:{n:"PtgAttrSpace",f:_U},65:{n:"PtgAttrSpaceSemi",f:wU},128:{n:"PtgAttrIfError",f:vU},255:{}};function $0(t,e,r,n){if(n.biff<8)return ea(t,e);for(var a=t.l+e,s=[],l=0;l!==r.length;++l)switch(r[l][0]){case"PtgArray":r[l][1]=PU(t,0,n),s.push(r[l][1]);break;case"PtgMemArea":r[l][2]=MU(t,r[l][1],n),s.push(r[l][2]);break;case"PtgExp":n&&n.biff==12&&(r[l][1][1]=t.read_shift(4),s.push(r[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[l][0]}return e=a-t.l,e!==0&&s.push(ea(t,e)),s}function K0(t,e,r){for(var n=t.l+e,a,s,l=[];n!=t.l;)e=n-t.l,s=t[t.l],a=gb[s]||gb[fB[s]],(s===24||s===25)&&(a=(s===24?hB:dB)[t[t.l+1]]),!a||!a.f?ea(t,e):l.push([a.n,a.f(t,e,r)]);return l}function mB(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],a=[],s=0;s<n.length;++s){var l=n[s];if(l)switch(l[0]){case 2:a.push('"'+l[1].replace(/"/g,'""')+'"');break;default:a.push(l[1])}else a.push("")}e.push(a.join(","))}return e.join(";")}var pB={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function gB(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function pC(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(t[n[0]][0]){case 357:return a=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?a:a+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[n[0]][0][3]?(a=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function xb(t,e,r){var n=pC(t,e,r);return n=="#REF"?n:gB(n,r)}function $n(t,e,r,n,a){var s=a&&a.biff||8,l={s:{c:0,r:0}},u=[],f,d,m,y=0,_=0,E,b="";if(!t[0]||!t[0][0])return"";for(var w=-1,S="",M=0,j=t[0].length;M<j;++M){var F=t[0][M];switch(F[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=u.pop(),d=u.pop(),w>=0){switch(t[0][w][1][0]){case 0:S=zr(" ",t[0][w][1][1]);break;case 1:S=zr("\r",t[0][w][1][1]);break;default:if(S="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][w][1][0])}d=d+S,w=-1}u.push(d+pB[F[0]]+f);break;case"PtgIsect":f=u.pop(),d=u.pop(),u.push(d+" "+f);break;case"PtgUnion":f=u.pop(),d=u.pop(),u.push(d+","+f);break;case"PtgRange":f=u.pop(),d=u.pop(),u.push(d+":"+f);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":m=$f(F[1][1],l,a),u.push(Kf(m,s));break;case"PtgRefN":m=r?$f(F[1][1],r,a):F[1][1],u.push(Kf(m,s));break;case"PtgRef3d":y=F[1][1],m=$f(F[1][2],l,a),b=xb(n,y,a),u.push(b+"!"+Kf(m,s));break;case"PtgFunc":case"PtgFuncVar":var G=F[1][0],W=F[1][1];G||(G=0),G&=127;var B=G==0?[]:u.slice(-G);u.length-=G,W==="User"&&(W=B.shift()),u.push(W+"("+B.join(",")+")");break;case"PtgBool":u.push(F[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(F[1]);break;case"PtgNum":u.push(String(F[1]));break;case"PtgStr":u.push('"'+F[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(F[1]);break;case"PtgAreaN":E=WT(F[1][1],r?{s:r}:l,a),u.push(vx(E,a));break;case"PtgArea":E=WT(F[1][1],l,a),u.push(vx(E,a));break;case"PtgArea3d":y=F[1][1],E=F[1][2],b=xb(n,y,a),u.push(b+"!"+vx(E,a));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":_=F[1][2];var A=(n.names||[])[_-1]||(n[0]||[])[_],D=A?A.Name:"SH33TJSNAME"+String(_);D&&D.slice(0,6)=="_xlfn."&&!a.xlfn&&(D=D.slice(6)),u.push(D);break;case"PtgNameX":var k=F[1][1];_=F[1][2];var O;if(a.biff<=5)k<0&&(k=-k),n[k]&&(O=n[k][_]);else{var P="";if(((n[k]||[])[0]||[])[0]==14849||(((n[k]||[])[0]||[])[0]==1025?n[k][_]&&n[k][_].itab>0&&(P=n.SheetNames[n[k][_].itab-1]+"!"):P=n.SheetNames[_-1]+"!"),n[k]&&n[k][_])P+=n[k][_].Name;else if(n[0]&&n[0][_])P+=n[0][_].Name;else{var N=(pC(n,k,a)||"").split(";;");N[_-1]?P=N[_-1]:P+="SH33TJSERRX"}u.push(P);break}O||(O={Name:"SH33TJSERRY"}),u.push(O.Name);break;case"PtgParen":var R="(",he=")";if(w>=0){switch(S="",t[0][w][1][0]){case 2:R=zr(" ",t[0][w][1][1])+R;break;case 3:R=zr("\r",t[0][w][1][1])+R;break;case 4:he=zr(" ",t[0][w][1][1])+he;break;case 5:he=zr("\r",t[0][w][1][1])+he;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][w][1][0])}w=-1}u.push(R+u.pop()+he);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":m={c:F[1][1],r:F[1][0]};var xe={c:r.c,r:r.r};if(n.sharedf[xt(m)]){var ne=n.sharedf[xt(m)];u.push($n(ne,l,xe,n,a))}else{var le=!1;for(f=0;f!=n.arrayf.length;++f)if(d=n.arrayf[f],!(m.c<d[0].s.c||m.c>d[0].e.c)&&!(m.r<d[0].s.r||m.r>d[0].e.r)){u.push($n(d[1],l,xe,n,a)),le=!0;break}le||u.push(F[1])}break;case"PtgArray":u.push("{"+mB(F[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":w=M;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+F[1].idx+"[#"+F[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(F));default:throw new Error("Unrecognized Formula Token: "+String(F))}var He=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&w>=0&&He.indexOf(t[0][M][0])==-1){F=t[0][w];var ie=!0;switch(F[1][0]){case 4:ie=!1;case 0:S=zr(" ",F[1][1]);break;case 5:ie=!1;case 1:S=zr("\r",F[1][1]);break;default:if(S="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+F[1][0])}u.push((ie?S:"")+u.pop()+(ie?"":S)),w=-1}}if(u.length>1&&a.WTF)throw new Error("bad formula stack");return u[0]}function xB(t,e,r){var n=t.l+e,a=r.biff==2?1:2,s,l=t.read_shift(a);if(l==65535)return[[],ea(t,e-2)];var u=K0(t,l,r);return e!==l+a&&(s=$0(t,e-l-a,u,r)),t.l=n,[u,s]}function vB(t,e,r){var n=t.l+e,a=r.biff==2?1:2,s,l=t.read_shift(a);if(l==65535)return[[],ea(t,e-2)];var u=K0(t,l,r);return e!==l+a&&(s=$0(t,e-l-a,u,r)),t.l=n,[u,s]}function yB(t,e,r,n){var a=t.l+e,s=K0(t,n,r),l;return a!==t.l&&(l=$0(t,a-t.l,s,r)),[s,l]}function _B(t,e,r){var n=t.l+e,a,s=t.read_shift(2),l=K0(t,s,r);return s==65535?[[],ea(t,e-2)]:(e!==s+2&&(a=$0(t,n-s-2,l,r)),[l,a])}function wB(t){var e;if(Es(t,t.l+6)!==65535)return[Qn(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function EB(t){if(t==null){var e=Ce(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return Pl(t);return Pl(0)}function Tx(t,e,r){var n=t.l+e,a=Ji(t);r.biff==2&&++t.l;var s=wB(t),l=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var u=vB(t,n-t.l,r);return{cell:a,val:s[0],formula:u,shared:l>>3&1,tt:s[1]}}function TB(t,e,r,n,a){var s=Ul(e,r,a),l=EB(t.v),u=Ce(6),f=33;u.write_shift(2,f),u.write_shift(4,0);for(var d=Ce(t.bf.length),m=0;m<t.bf.length;++m)d[m]=t.bf[m];var y=Nn([s,l,u,d]);return y}function Qm(t,e,r){var n=t.read_shift(4),a=K0(t,n,r),s=t.read_shift(4),l=s>0?$0(t,s,a,r):null;return[a,l]}var bB=Qm,Jm=Qm,SB=Qm,kB=Qm,AB={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},gC={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},CB={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function vb(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function NB(t){var e="of:="+t.replace(sy,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function bx(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function IB(t){return t.replace(/\./,"!")}var Qf={},lu={},Jf=typeof Map<"u";function cy(t,e,r){var n=0,a=t.length;if(r){if(Jf?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var s=Jf?r.get(e):r[e];n<s.length;++n)if(t[s[n]].t===e)return t.Count++,s[n]}}else for(;n<a;++n)if(t[n].t===e)return t.Count++,n;return t[a]={t:e},t.Count++,t.Unique++,r&&(Jf?(r.has(e)||r.set(e,[]),r.get(e).push(a)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(a))),a}function Zm(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(Yn=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=_0(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=ym(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function Al(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function Go(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],a=60,s=t.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){$i(e.z,a),r.ssf[a]=e.z,r.revssf[e.z]=n=a;break}}for(a=0;a!=s;++a)if(t[a].numFmtId===n)return a;return t[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function xC(t,e,r,n,a,s){try{n.cellNF&&(t.z=mt[e])}catch(u){if(n.WTF)throw u}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Nr(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(mt[e]==null&&$i(AL[e]||"General",e),t.t==="e")t.w=t.w||Fs[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=d0(t.v);else if(t.t==="d"){var l=yn(t.v);(l|0)===l?t.w=l.toString(10):t.w=d0(l)}else{if(t.v===void 0)return"";t.w=Ll(t.v,lu)}else t.t==="d"?t.w=Va(e,yn(t.v),lu):t.w=Va(e,t.v,lu)}catch(u){if(n.WTF)throw u}if(n.cellStyles&&r!=null)try{t.s=s.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=vm(a.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=a.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=vm(a.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=a.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(u){if(n.WTF&&s.Fills)throw u}}}function RB(t,e,r){if(t&&t["!ref"]){var n=er(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function DB(t,e){var r=er(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=At(r))}var OB=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,FB=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,LB=/<(?:\w:)?hyperlink [^>]*>/mg,MB=/"(\w*:\w*)"/,PB=/<(?:\w:)?col\b[^>]*[\/]?>/g,jB=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,UB=/<(?:\w:)?pageMargins[^>]*\/>/g,vC=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,BB=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,VB=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function zB(t,e,r,n,a,s,l){if(!t)return t;n||(n={"!id":{}});var u=e.dense?[]:{},f={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",m="",y=t.match(FB);y?(d=t.slice(0,y.index),m=t.slice(y.index+y[0].length)):d=m=t;var _=d.match(vC);_?uy(_[0],u,a,r):(_=d.match(BB))&&GB(_[0],_[1]||"",u,a,r);var E=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(E>0){var b=d.slice(E,E+50).match(MB);b&&DB(u,b[1])}var w=d.match(VB);w&&w[1]&&nV(w[1],a);var S=[];if(e.cellStyles){var M=d.match(PB);M&&JB(S,M)}y&&sV(y[1],u,e,f,s,l);var j=m.match(jB);j&&(u["!autofilter"]=eV(j[0]));var F=[],G=m.match(OB);if(G)for(E=0;E!=G.length;++E)F[E]=er(G[E].slice(G[E].indexOf('"')+1));var W=m.match(LB);W&&KB(u,W,n);var B=m.match(UB);if(B&&(u["!margins"]=YB(Tt(B[0]))),!u["!ref"]&&f.e.c>=f.s.c&&f.e.r>=f.s.r&&(u["!ref"]=At(f)),e.sheetRows>0&&u["!ref"]){var A=er(u["!ref"]);e.sheetRows<=+A.e.r&&(A.e.r=e.sheetRows-1,A.e.r>f.e.r&&(A.e.r=f.e.r),A.e.r<A.s.r&&(A.s.r=A.e.r),A.e.c>f.e.c&&(A.e.c=f.e.c),A.e.c<A.s.c&&(A.s.c=A.e.c),u["!fullref"]=u["!ref"],u["!ref"]=At(A))}return S.length>0&&(u["!cols"]=S),F.length>0&&(u["!merges"]=F),u}function HB(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+At(t[r])+'"/>';return e+"</mergeCells>"}function uy(t,e,r,n){var a=Tt(t);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=Zt(_r(a.codeName)))}function GB(t,e,r,n,a){uy(t.slice(0,t.indexOf(">")),r,n,a)}function qB(t,e,r,n,a){var s=!1,l={},u=null;if(n.bookType!=="xlsx"&&e.vbaraw){var f=e.SheetNames[r];try{e.Workbook&&(f=e.Workbook.Sheets[r].CodeName||f)}catch{}s=!0,l.codeName=Bi(dr(f))}if(t&&t["!outline"]){var d={summaryBelow:1,summaryRight:1};t["!outline"].above&&(d.summaryBelow=0),t["!outline"].left&&(d.summaryRight=0),u=(u||"")+$e("outlinePr",null,d)}!s&&!u||(a[a.length]=$e("sheetPr",u,l))}var WB=["objects","scenarios","selectLockedCells","selectUnlockedCells"],XB=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function $B(t){var e={sheet:1};return WB.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),XB.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=ny(t.password).toString(16).toUpperCase()),$e("sheetProtection",null,e)}function KB(t,e,r){for(var n=Array.isArray(t),a=0;a!=e.length;++a){var s=Tt(_r(e[a]),!0);if(!s.ref)return;var l=((r||{})["!id"]||[])[s.id];l?(s.Target=l.Target,s.location&&(s.Target+="#"+Zt(s.location))):(s.Target="#"+Zt(s.location),l={Target:s.Target,TargetMode:"Internal"}),s.Rel=l,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var u=er(s.ref),f=u.s.r;f<=u.e.r;++f)for(var d=u.s.c;d<=u.e.c;++d){var m=xt({c:d,r:f});n?(t[f]||(t[f]=[]),t[f][d]||(t[f][d]={t:"z",v:void 0}),t[f][d].l=s):(t[m]||(t[m]={t:"z",v:void 0}),t[m].l=s)}}}function YB(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function QB(t){return Al(t),$e("pageMargins",null,t)}function JB(t,e){for(var r=!1,n=0;n!=e.length;++n){var a=Tt(e[n],!0);a.hidden&&(a.hidden=Ar(a.hidden));var s=parseInt(a.min,10)-1,l=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,ay(a.width)),Fo(a);s<=l;)t[s++]=Ir(a)}}function ZB(t,e){for(var r=["<cols>"],n,a=0;a!=e.length;++a)(n=e[a])&&(r[r.length]=$e("col",null,Zm(a,n)));return r[r.length]="</cols>",r.join("")}function eV(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function tV(t,e,r,n){var a=typeof t.ref=="string"?t.ref:At(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,l=Ea(a);l.s.r==l.e.r&&(l.e.r=Ea(e["!ref"]).e.r,a=At(l));for(var u=0;u<s.length;++u){var f=s[u];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==n){f.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return u==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),$e("autoFilter",null,{ref:a})}var rV=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function nV(t,e){e.Views||(e.Views=[{}]),(t.match(rV)||[]).forEach(function(r,n){var a=Tt(r);e.Views[n]||(e.Views[n]={}),+a.zoomScale&&(e.Views[n].zoom=+a.zoomScale),Ar(a.rightToLeft)&&(e.Views[n].RTL=!0)})}function aV(t,e,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),$e("sheetViews",$e("sheetView",null,a),{})}function iV(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var a="",s=t.t,l=t.v;if(t.t!=="z")switch(t.t){case"b":a=t.v?"1":"0";break;case"n":a=""+t.v;break;case"e":a=Fs[t.v];break;case"d":n&&n.cellDates?a=Nr(t.v,-1).toISOString():(t=Ir(t),t.t="n",a=""+(t.v=yn(Nr(t.v)))),typeof t.z>"u"&&(t.z=mt[14]);break;default:a=t.v;break}var u=Bn("v",dr(a)),f={r:e},d=Go(n.cellXfs,t,n);switch(d!==0&&(f.s=d),t.t){case"n":break;case"d":f.t="d";break;case"b":f.t="b";break;case"e":f.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){u=Bn("v",""+cy(n.Strings,t.v,n.revStrings)),f.t="s";break}f.t="str";break}if(t.t!=s&&(t.t=s,t.v=l),typeof t.f=="string"&&t.f){var m=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;u=$e("f",dr(t.f),m)+(t.v!=null?u:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(f.cm=1),$e("c",u,f)}var sV=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=m0("v"),l=m0("f");return function(f,d,m,y,_,E){for(var b=0,w="",S=[],M=[],j=0,F=0,G=0,W="",B,A,D=0,k=0,O,P,N=0,R=0,he=Array.isArray(E.CellXf),xe,ne=[],le=[],He=Array.isArray(d),ie=[],J={},ge=!1,V=!!m.sheetStubs,X=f.split(e),Z=0,te=X.length;Z!=te;++Z){w=X[Z].trim();var fe=w.length;if(fe!==0){var Se=0;e:for(b=0;b<fe;++b)switch(w[b]){case">":if(w[b-1]!="/"){++b;break e}if(m&&m.cellStyles){if(A=Tt(w.slice(Se,b),!0),D=A.r!=null?parseInt(A.r,10):D+1,k=-1,m.sheetRows&&m.sheetRows<D)continue;J={},ge=!1,A.ht&&(ge=!0,J.hpt=parseFloat(A.ht),J.hpx=xu(J.hpt)),A.hidden=="1"&&(ge=!0,J.hidden=!0),A.outlineLevel!=null&&(ge=!0,J.level=+A.outlineLevel),ge&&(ie[D-1]=J)}break;case"<":Se=b;break}if(Se>=b)break;if(A=Tt(w.slice(Se,b),!0),D=A.r!=null?parseInt(A.r,10):D+1,k=-1,!(m.sheetRows&&m.sheetRows<D)){y.s.r>D-1&&(y.s.r=D-1),y.e.r<D-1&&(y.e.r=D-1),m&&m.cellStyles&&(J={},ge=!1,A.ht&&(ge=!0,J.hpt=parseFloat(A.ht),J.hpx=xu(J.hpt)),A.hidden=="1"&&(ge=!0,J.hidden=!0),A.outlineLevel!=null&&(ge=!0,J.level=+A.outlineLevel),ge&&(ie[D-1]=J)),S=w.slice(b).split(t);for(var ke=0;ke!=S.length&&S[ke].trim().charAt(0)=="<";++ke);for(S=S.slice(ke),b=0;b!=S.length;++b)if(w=S[b].trim(),w.length!==0){if(M=w.match(r),j=b,F=0,G=0,w="<c "+(w.slice(0,1)=="<"?">":"")+w,M!=null&&M.length===2){for(j=0,W=M[1],F=0;F!=W.length&&!((G=W.charCodeAt(F)-64)<1||G>26);++F)j=26*j+G;--j,k=j}else++k;for(F=0;F!=w.length&&w.charCodeAt(F)!==62;++F);if(++F,A=Tt(w.slice(0,F),!0),A.r||(A.r=xt({r:D-1,c:k})),W=w.slice(F),B={t:""},(M=W.match(s))!=null&&M[1]!==""&&(B.v=Zt(M[1])),m.cellFormula){if((M=W.match(l))!=null&&M[1]!==""){if(B.f=Zt(_r(M[1])).replace(/\r\n/g,`
`),m.xlfn||(B.f=mb(B.f)),M[0].indexOf('t="array"')>-1)B.F=(W.match(a)||[])[1],B.F.indexOf(":")>-1&&ne.push([er(B.F),B.F]);else if(M[0].indexOf('t="shared"')>-1){P=Tt(M[0]);var Ne=Zt(_r(M[1]));m.xlfn||(Ne=mb(Ne)),le[parseInt(P.si,10)]=[P,Ne,A.r]}}else(M=W.match(/<f[^>]*\/>/))&&(P=Tt(M[0]),le[P.si]&&(B.f=rU(le[P.si][1],le[P.si][2],A.r)));var Oe=Pr(A.r);for(F=0;F<ne.length;++F)Oe.r>=ne[F][0].s.r&&Oe.r<=ne[F][0].e.r&&Oe.c>=ne[F][0].s.c&&Oe.c<=ne[F][0].e.c&&(B.F=ne[F][1])}if(A.t==null&&B.v===void 0)if(B.f||B.F)B.v=0,B.t="n";else if(V)B.t="z";else continue;else B.t=A.t||"n";switch(y.s.c>k&&(y.s.c=k),y.e.c<k&&(y.e.c=k),B.t){case"n":if(B.v==""||B.v==null){if(!V)continue;B.t="z"}else B.v=parseFloat(B.v);break;case"s":if(typeof B.v>"u"){if(!V)continue;B.t="z"}else O=Qf[parseInt(B.v,10)],B.v=O.t,B.r=O.r,m.cellHTML&&(B.h=O.h);break;case"str":B.t="s",B.v=B.v!=null?_r(B.v):"",m.cellHTML&&(B.h=zv(B.v));break;case"inlineStr":M=W.match(n),B.t="s",M!=null&&(O=ry(M[1]))?(B.v=O.t,m.cellHTML&&(B.h=O.h)):B.v="";break;case"b":B.v=Ar(B.v);break;case"d":m.cellDates?B.v=Nr(B.v,1):(B.v=yn(Nr(B.v,1)),B.t="n");break;case"e":(!m||m.cellText!==!1)&&(B.w=B.v),B.v=_4[B.v];break}if(N=R=0,xe=null,he&&A.s!==void 0&&(xe=E.CellXf[A.s],xe!=null&&(xe.numFmtId!=null&&(N=xe.numFmtId),m.cellStyles&&xe.fillId!=null&&(R=xe.fillId))),xC(B,N,R,m,_,E),m.cellDates&&he&&B.t=="n"&&ql(mt[N])&&(B.t="d",B.v=Km(B.v)),A.cm&&m.xlmeta){var ot=(m.xlmeta.Cell||[])[+A.cm-1];ot&&ot.type=="XLDAPR"&&(B.D=!0)}if(He){var ee=Pr(A.r);d[ee.r]||(d[ee.r]=[]),d[ee.r][ee.c]=B}else d[A.r]=B}}}}ie.length>0&&(d["!rows"]=ie)}}();function oV(t,e,r,n){var a=[],s=[],l=er(t["!ref"]),u="",f,d="",m=[],y=0,_=0,E=t["!rows"],b=Array.isArray(t),w={r:d},S,M=-1;for(_=l.s.c;_<=l.e.c;++_)m[_]=Mr(_);for(y=l.s.r;y<=l.e.r;++y){for(s=[],d=Jr(y),_=l.s.c;_<=l.e.c;++_){f=m[_]+d;var j=b?(t[y]||[])[_]:t[f];j!==void 0&&(u=iV(j,f,t,e))!=null&&s.push(u)}(s.length>0||E&&E[y])&&(w={r:d},E&&E[y]&&(S=E[y],S.hidden&&(w.hidden=1),M=-1,S.hpx?M=w0(S.hpx):S.hpt&&(M=S.hpt),M>-1&&(w.ht=M,w.customHeight=1),S.level&&(w.outlineLevel=S.level)),a[a.length]=$e("row",s.join(""),w))}if(E)for(;y<E.length;++y)E&&E[y]&&(w={r:y+1},S=E[y],S.hidden&&(w.hidden=1),M=-1,S.hpx?M=w0(S.hpx):S.hpt&&(M=S.hpt),M>-1&&(w.ht=M,w.customHeight=1),S.level&&(w.outlineLevel=S.level),a[a.length]=$e("row","",w));return a.join("")}function yC(t,e,r,n){var a=[Zr,$e("worksheet",null,{xmlns:Wl[0],"xmlns:r":gn.r})],s=r.SheetNames[t],l=0,u="",f=r.Sheets[s];f==null&&(f={});var d=f["!ref"]||"A1",m=er(d);if(m.e.c>16383||m.e.r>1048575){if(e.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");m.e.c=Math.min(m.e.c,16383),m.e.r=Math.min(m.e.c,1048575),d=At(m)}n||(n={}),f["!comments"]=[];var y=[];qB(f,r,t,e,a),a[a.length]=$e("dimension",null,{ref:d}),a[a.length]=aV(f,e,t,r),e.sheetFormat&&(a[a.length]=$e("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),f["!cols"]!=null&&f["!cols"].length>0&&(a[a.length]=ZB(f,f["!cols"])),a[l=a.length]="<sheetData/>",f["!links"]=[],f["!ref"]!=null&&(u=oV(f,e),u.length>0&&(a[a.length]=u)),a.length>l+1&&(a[a.length]="</sheetData>",a[l]=a[l].replace("/>",">")),f["!protect"]&&(a[a.length]=$B(f["!protect"])),f["!autofilter"]!=null&&(a[a.length]=tV(f["!autofilter"],f,r,t)),f["!merges"]!=null&&f["!merges"].length>0&&(a[a.length]=HB(f["!merges"]));var _=-1,E,b=-1;return f["!links"].length>0&&(a[a.length]="<hyperlinks>",f["!links"].forEach(function(w){w[1].Target&&(E={ref:w[0]},w[1].Target.charAt(0)!="#"&&(b=hr(n,-1,dr(w[1].Target).replace(/#.*$/,""),Bt.HLINK),E["r:id"]="rId"+b),(_=w[1].Target.indexOf("#"))>-1&&(E.location=dr(w[1].Target.slice(_+1))),w[1].Tooltip&&(E.tooltip=dr(w[1].Tooltip)),a[a.length]=$e("hyperlink",null,E))}),a[a.length]="</hyperlinks>"),delete f["!links"],f["!margins"]!=null&&(a[a.length]=QB(f["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(a[a.length]=Bn("ignoredErrors",$e("ignoredError",null,{numberStoredAsText:1,sqref:d}))),y.length>0&&(b=hr(n,-1,"../drawings/drawing"+(t+1)+".xml",Bt.DRAW),a[a.length]=$e("drawing",null,{"r:id":"rId"+b}),f["!drawing"]=y),f["!comments"].length>0&&(b=hr(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Bt.VML),a[a.length]=$e("legacyDrawing",null,{"r:id":"rId"+b}),f["!legacy"]=b),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function lV(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var a=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=a/20),r}function cV(t,e,r){var n=Ce(145),a=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var s=320;a.hpx?s=w0(a.hpx)*20:a.hpt&&(s=a.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var l=0;a.level&&(l|=a.level),a.hidden&&(l|=16),(a.hpx||a.hpt)&&(l|=32),n.write_shift(1,l),n.write_shift(1,0);var u=0,f=n.l;n.l+=4;for(var d={r:t,c:0},m=0;m<16;++m)if(!(e.s.c>m+1<<10||e.e.c<m<<10)){for(var y=-1,_=-1,E=m<<10;E<m+1<<10;++E){d.c=E;var b=Array.isArray(r)?(r[d.r]||[])[d.c]:r[xt(d)];b&&(y<0&&(y=E),_=E)}y<0||(++u,n.write_shift(4,y),n.write_shift(4,_))}var w=n.l;return n.l=f,n.write_shift(4,u),n.l=w,n.length>n.l?n.slice(0,n.l):n}function uV(t,e,r,n){var a=cV(n,r,e);(a.length>17||(e["!rows"]||[])[n])&&Pe(t,0,a)}var fV=Yl,hV=Au;function dV(){}function mV(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=xM(t),r}function pV(t,e,r){r==null&&(r=Ce(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return pm({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),p4(t,r),r.slice(0,r.l)}function gV(t){var e=oi(t);return[e]}function xV(t,e,r){return r==null&&(r=Ce(8)),Xl(e,r)}function vV(t){var e=$l(t);return[e]}function yV(t,e,r){return r==null&&(r=Ce(4)),Kl(e,r)}function _V(t){var e=oi(t),r=t.read_shift(1);return[e,r,"b"]}function wV(t,e,r){return r==null&&(r=Ce(9)),Xl(e,r),r.write_shift(1,t.v?1:0),r}function EV(t){var e=$l(t),r=t.read_shift(1);return[e,r,"b"]}function TV(t,e,r){return r==null&&(r=Ce(5)),Kl(e,r),r.write_shift(1,t.v?1:0),r}function bV(t){var e=oi(t),r=t.read_shift(1);return[e,r,"e"]}function SV(t,e,r){return r==null&&(r=Ce(9)),Xl(e,r),r.write_shift(1,t.v),r}function kV(t){var e=$l(t),r=t.read_shift(1);return[e,r,"e"]}function AV(t,e,r){return r==null&&(r=Ce(8)),Kl(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function CV(t){var e=oi(t),r=t.read_shift(4);return[e,r,"s"]}function NV(t,e,r){return r==null&&(r=Ce(12)),Xl(e,r),r.write_shift(4,e.v),r}function IV(t){var e=$l(t),r=t.read_shift(4);return[e,r,"s"]}function RV(t,e,r){return r==null&&(r=Ce(8)),Kl(e,r),r.write_shift(4,e.v),r}function DV(t){var e=oi(t),r=Qn(t);return[e,r,"n"]}function OV(t,e,r){return r==null&&(r=Ce(16)),Xl(e,r),Pl(t.v,r),r}function _C(t){var e=$l(t),r=Qn(t);return[e,r,"n"]}function FV(t,e,r){return r==null&&(r=Ce(12)),Kl(e,r),Pl(t.v,r),r}function LV(t){var e=oi(t),r=Qv(t);return[e,r,"n"]}function MV(t,e,r){return r==null&&(r=Ce(12)),Xl(e,r),g4(t.v,r),r}function PV(t){var e=$l(t),r=Qv(t);return[e,r,"n"]}function jV(t,e,r){return r==null&&(r=Ce(8)),Kl(e,r),g4(t.v,r),r}function UV(t){var e=oi(t),r=$v(t);return[e,r,"is"]}function BV(t){var e=oi(t),r=Jn(t);return[e,r,"str"]}function VV(t,e,r){return r==null&&(r=Ce(12+4*t.v.length)),Xl(e,r),In(t.v,r),r.length>r.l?r.slice(0,r.l):r}function zV(t){var e=$l(t),r=Jn(t);return[e,r,"str"]}function HV(t,e,r){return r==null&&(r=Ce(8+4*t.v.length)),Kl(e,r),In(t.v,r),r.length>r.l?r.slice(0,r.l):r}function GV(t,e,r){var n=t.l+e,a=oi(t);a.r=r["!row"];var s=t.read_shift(1),l=[a,s,"b"];if(r.cellFormula){t.l+=2;var u=Jm(t,n-t.l,r);l[3]=$n(u,null,a,r.supbooks,r)}else t.l=n;return l}function qV(t,e,r){var n=t.l+e,a=oi(t);a.r=r["!row"];var s=t.read_shift(1),l=[a,s,"e"];if(r.cellFormula){t.l+=2;var u=Jm(t,n-t.l,r);l[3]=$n(u,null,a,r.supbooks,r)}else t.l=n;return l}function WV(t,e,r){var n=t.l+e,a=oi(t);a.r=r["!row"];var s=Qn(t),l=[a,s,"n"];if(r.cellFormula){t.l+=2;var u=Jm(t,n-t.l,r);l[3]=$n(u,null,a,r.supbooks,r)}else t.l=n;return l}function XV(t,e,r){var n=t.l+e,a=oi(t);a.r=r["!row"];var s=Jn(t),l=[a,s,"str"];if(r.cellFormula){t.l+=2;var u=Jm(t,n-t.l,r);l[3]=$n(u,null,a,r.supbooks,r)}else t.l=n;return l}var $V=Yl,KV=Au;function YV(t,e){return e==null&&(e=Ce(4)),e.write_shift(4,t),e}function QV(t,e){var r=t.l+e,n=Yl(t),a=Kv(t),s=Jn(t),l=Jn(t),u=Jn(t);t.l=r;var f={rfx:n,relId:a,loc:s,display:u};return l&&(f.Tooltip=l),f}function JV(t,e){var r=Ce(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));Au({s:Pr(t[0]),e:Pr(t[0])},r),Yv("rId"+e,r);var n=t[1].Target.indexOf("#"),a=n==-1?"":t[1].Target.slice(n+1);return In(a||"",r),In(t[1].Tooltip||"",r),In("",r),r.slice(0,r.l)}function ZV(){}function ez(t,e,r){var n=t.l+e,a=x4(t),s=t.read_shift(1),l=[a];if(l[2]=s,r.cellFormula){var u=bB(t,n-t.l,r);l[1]=u}else t.l=n;return l}function tz(t,e,r){var n=t.l+e,a=Yl(t),s=[a];if(r.cellFormula){var l=kB(t,n-t.l,r);s[1]=l,t.l=n}else t.l=n;return s}function rz(t,e,r){r==null&&(r=Ce(18));var n=Zm(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return e.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),e.level&&(a|=e.level<<8),r.write_shift(2,a),r}var wC=["left","right","top","bottom","header","footer"];function nz(t){var e={};return wC.forEach(function(r){e[r]=Qn(t)}),e}function az(t,e){return e==null&&(e=Ce(6*8)),Al(t),wC.forEach(function(r){Pl(t[r],e)}),e}function iz(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function sz(t,e,r){r==null&&(r=Ce(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function oz(t){var e=Ce(24);return e.write_shift(4,4),e.write_shift(4,1),Au(t,e),e}function lz(t,e){return e==null&&(e=Ce(16*4+2)),e.write_shift(2,t.password?ny(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function cz(){}function uz(){}function fz(t,e,r,n,a,s,l){if(!t)return t;var u=e||{};n||(n={"!id":{}});var f=u.dense?[]:{},d,m={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=!1,_=!1,E,b,w,S,M,j,F,G,W,B=[];u.biff=12,u["!row"]=0;var A=0,D=!1,k=[],O={},P=u.supbooks||a.supbooks||[[]];if(P.sharedf=O,P.arrayf=k,P.SheetNames=a.SheetNames||a.Sheets.map(function(He){return He.name}),!u.supbooks&&(u.supbooks=P,a.Names))for(var N=0;N<a.Names.length;++N)P[0][N+1]=a.Names[N];var R=[],he=[],xe=!1;E0[16]={n:"BrtShortReal",f:_C};var ne;if(Os(t,function(ie,J,ge){if(!_)switch(ge){case 148:d=ie;break;case 0:E=ie,u.sheetRows&&u.sheetRows<=E.r&&(_=!0),G=Jr(S=E.r),u["!row"]=E.r,(ie.hidden||ie.hpt||ie.level!=null)&&(ie.hpt&&(ie.hpx=xu(ie.hpt)),he[ie.r]=ie);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(b={t:ie[2]},ie[2]){case"n":b.v=ie[1];break;case"s":F=Qf[ie[1]],b.v=F.t,b.r=F.r;break;case"b":b.v=!!ie[1];break;case"e":b.v=ie[1],u.cellText!==!1&&(b.w=Fs[b.v]);break;case"str":b.t="s",b.v=ie[1];break;case"is":b.t="s",b.v=ie[1].t;break}if((w=l.CellXf[ie[0].iStyleRef])&&xC(b,w.numFmtId,null,u,s,l),M=ie[0].c==-1?M+1:ie[0].c,u.dense?(f[S]||(f[S]=[]),f[S][M]=b):f[Mr(M)+G]=b,u.cellFormula){for(D=!1,A=0;A<k.length;++A){var V=k[A];E.r>=V[0].s.r&&E.r<=V[0].e.r&&M>=V[0].s.c&&M<=V[0].e.c&&(b.F=At(V[0]),D=!0)}!D&&ie.length>3&&(b.f=ie[3])}if(m.s.r>E.r&&(m.s.r=E.r),m.s.c>M&&(m.s.c=M),m.e.r<E.r&&(m.e.r=E.r),m.e.c<M&&(m.e.c=M),u.cellDates&&w&&b.t=="n"&&ql(mt[w.numFmtId])){var X=go(b.v);X&&(b.t="d",b.v=new Date(X.y,X.m-1,X.d,X.H,X.M,X.S,X.u))}ne&&(ne.type=="XLDAPR"&&(b.D=!0),ne=void 0);break;case 1:case 12:if(!u.sheetStubs||y)break;b={t:"z",v:void 0},M=ie[0].c==-1?M+1:ie[0].c,u.dense?(f[S]||(f[S]=[]),f[S][M]=b):f[Mr(M)+G]=b,m.s.r>E.r&&(m.s.r=E.r),m.s.c>M&&(m.s.c=M),m.e.r<E.r&&(m.e.r=E.r),m.e.c<M&&(m.e.c=M),ne&&(ne.type=="XLDAPR"&&(b.D=!0),ne=void 0);break;case 176:B.push(ie);break;case 49:ne=((u.xlmeta||{}).Cell||[])[ie-1];break;case 494:var Z=n["!id"][ie.relId];for(Z?(ie.Target=Z.Target,ie.loc&&(ie.Target+="#"+ie.loc),ie.Rel=Z):ie.relId==""&&(ie.Target="#"+ie.loc),S=ie.rfx.s.r;S<=ie.rfx.e.r;++S)for(M=ie.rfx.s.c;M<=ie.rfx.e.c;++M)u.dense?(f[S]||(f[S]=[]),f[S][M]||(f[S][M]={t:"z",v:void 0}),f[S][M].l=ie):(j=xt({c:M,r:S}),f[j]||(f[j]={t:"z",v:void 0}),f[j].l=ie);break;case 426:if(!u.cellFormula)break;k.push(ie),W=u.dense?f[S][M]:f[Mr(M)+G],W.f=$n(ie[1],m,{r:E.r,c:M},P,u),W.F=At(ie[0]);break;case 427:if(!u.cellFormula)break;O[xt(ie[0].s)]=ie[1],W=u.dense?f[S][M]:f[Mr(M)+G],W.f=$n(ie[1],m,{r:E.r,c:M},P,u);break;case 60:if(!u.cellStyles)break;for(;ie.e>=ie.s;)R[ie.e--]={width:ie.w/256,hidden:!!(ie.flags&1),level:ie.level},xe||(xe=!0,ay(ie.w/256)),Fo(R[ie.e+1]);break;case 161:f["!autofilter"]={ref:At(ie)};break;case 476:f["!margins"]=ie;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),ie.name&&(a.Sheets[r].CodeName=ie.name),(ie.above||ie.left)&&(f["!outline"]={above:ie.above,left:ie.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),ie.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:y=!0;break;case 36:y=!1;break;case 37:y=!0;break;case 38:y=!1;break;default:if(!J.T){if(!y||u.WTF)throw new Error("Unexpected record 0x"+ge.toString(16))}}},u),delete u.supbooks,delete u["!row"],!f["!ref"]&&(m.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(f["!ref"]=At(d||m)),u.sheetRows&&f["!ref"]){var le=er(f["!ref"]);u.sheetRows<=+le.e.r&&(le.e.r=u.sheetRows-1,le.e.r>m.e.r&&(le.e.r=m.e.r),le.e.r<le.s.r&&(le.s.r=le.e.r),le.e.c>m.e.c&&(le.e.c=m.e.c),le.e.c<le.s.c&&(le.s.c=le.e.c),f["!fullref"]=f["!ref"],f["!ref"]=At(le))}return B.length>0&&(f["!merges"]=B),R.length>0&&(f["!cols"]=R),he.length>0&&(f["!rows"]=he),f}function hz(t,e,r,n,a,s,l){if(e.v===void 0)return!1;var u="";switch(e.t){case"b":u=e.v?"1":"0";break;case"d":e=Ir(e),e.z=e.z||mt[14],e.v=yn(Nr(e.v)),e.t="n";break;case"n":case"e":u=""+e.v;break;default:u=e.v;break}var f={r,c:n};switch(f.s=Go(a.cellXfs,e,a),e.l&&s["!links"].push([xt(f),e.l]),e.c&&s["!comments"].push([xt(f),e.c]),e.t){case"s":case"str":return a.bookSST?(u=cy(a.Strings,e.v,a.revStrings),f.t="s",f.v=u,l?Pe(t,18,RV(e,f)):Pe(t,7,NV(e,f))):(f.t="str",l?Pe(t,17,HV(e,f)):Pe(t,6,VV(e,f))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?l?Pe(t,13,jV(e,f)):Pe(t,2,MV(e,f)):l?Pe(t,16,FV(e,f)):Pe(t,5,OV(e,f)),!0;case"b":return f.t="b",l?Pe(t,15,TV(e,f)):Pe(t,4,wV(e,f)),!0;case"e":return f.t="e",l?Pe(t,14,AV(e,f)):Pe(t,3,SV(e,f)),!0}return l?Pe(t,12,yV(e,f)):Pe(t,1,xV(e,f)),!0}function dz(t,e,r,n){var a=er(e["!ref"]||"A1"),s,l="",u=[];Pe(t,145);var f=Array.isArray(e),d=a.e.r;e["!rows"]&&(d=Math.max(a.e.r,e["!rows"].length-1));for(var m=a.s.r;m<=d;++m){l=Jr(m),uV(t,e,a,m);var y=!1;if(m<=a.e.r)for(var _=a.s.c;_<=a.e.c;++_){m===a.s.r&&(u[_]=Mr(_)),s=u[_]+l;var E=f?(e[m]||[])[_]:e[s];if(!E){y=!1;continue}y=hz(t,E,m,_,n,e,y)}}Pe(t,146)}function mz(t,e){!e||!e["!merges"]||(Pe(t,177,YV(e["!merges"].length)),e["!merges"].forEach(function(r){Pe(t,176,KV(r))}),Pe(t,178))}function pz(t,e){!e||!e["!cols"]||(Pe(t,390),e["!cols"].forEach(function(r,n){r&&Pe(t,60,rz(n,r))}),Pe(t,391))}function gz(t,e){!e||!e["!ref"]||(Pe(t,648),Pe(t,649,oz(er(e["!ref"]))),Pe(t,650))}function xz(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var a=hr(r,-1,n[1].Target.replace(/#.*$/,""),Bt.HLINK);Pe(t,494,JV(n,a))}}),delete e["!links"]}function vz(t,e,r,n){if(e["!comments"].length>0){var a=hr(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Bt.VML);Pe(t,551,Yv("rId"+a)),e["!legacy"]=a}}function yz(t,e,r,n){if(e["!autofilter"]){var a=e["!autofilter"],s=typeof a.ref=="string"?a.ref:At(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,u=Ea(s);u.s.r==u.e.r&&(u.e.r=Ea(e["!ref"]).e.r,s=At(u));for(var f=0;f<l.length;++f){var d=l[f];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==n){d.Ref="'"+r.SheetNames[n]+"'!"+s;break}}f==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Pe(t,161,Au(er(s))),Pe(t,162)}}function _z(t,e,r){Pe(t,133),Pe(t,137,sz(e,r)),Pe(t,138),Pe(t,134)}function wz(t,e){e["!protect"]&&Pe(t,535,lz(e["!protect"]))}function Ez(t,e,r,n){var a=wa(),s=r.SheetNames[t],l=r.Sheets[s]||{},u=s;try{r&&r.Workbook&&(u=r.Workbook.Sheets[t].CodeName||u)}catch{}var f=er(l["!ref"]||"A1");if(f.e.c>16383||f.e.r>1048575){if(e.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],Pe(a,129),(r.vbaraw||l["!outline"])&&Pe(a,147,pV(u,l["!outline"])),Pe(a,148,hV(f)),_z(a,l,r.Workbook),pz(a,l),dz(a,l,t,e),wz(a,l),yz(a,l,r,t),mz(a,l),xz(a,l,n),l["!margins"]&&Pe(a,476,az(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&gz(a,l),vz(a,l,t,n),Pe(a,130),a.end()}function Tz(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var l=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(e[+l[1]]=r?+l[2]:l[2])});var a=Zt((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[e,a,n]}function bz(t,e,r,n,a,s){var l=s||{"!type":"chart"};if(!t)return s;var u=0,f=0,d="A",m={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(y){var _=Tz(y);m.s.r=m.s.c=0,m.e.c=u,d=Mr(u),_[0].forEach(function(E,b){l[d+Jr(b)]={t:"n",v:E,z:_[1]},f=b}),m.e.r<f&&(m.e.r=f),++u}),u>0&&(l["!ref"]=At(m)),l}function Sz(t,e,r,n,a){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},l,u=t.match(vC);return u&&uy(u[0],s,a,r),(l=t.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=l[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function kz(t,e){t.l+=10;var r=Jn(t);return{name:r}}function Az(t,e,r,n,a){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},l=!1;return Os(t,function(f,d,m){switch(m){case 550:s["!rel"]=f;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),f.name&&(a.Sheets[r].CodeName=f.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!l||e.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}},e),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var fy=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Cz=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Nz=[],Iz=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function yb(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],a=0;a!=e.length;++a){var s=e[a];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=Ar(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function _b(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=Ar(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function EC(t){_b(t.WBProps,fy),_b(t.CalcPr,Iz),yb(t.WBView,Cz),yb(t.Sheets,Nz),lu.date1904=Ar(t.WBProps.date1904)}function Rz(t){return!t.Workbook||!t.Workbook.WBProps?"false":Ar(t.Workbook.WBProps.date1904)?"true":"false"}var Dz="][*?/\\".split("");function TC(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Dz.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function Oz(t,e,r){t.forEach(function(n,a){TC(n);for(var s=0;s<a;++s)if(n==t[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var l=e&&e[a]&&e[a].CodeName||n;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function Fz(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];Oz(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)RB(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var Lz=/<\w+:workbook/;function Mz(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",s={},l=0;if(t.replace(ta,function(f,d){var m=Tt(f);switch(Qi(m[0])){case"<?xml":break;case"<workbook":f.match(Lz)&&(a="xmlns"+f.match(/<(\w+):/)[1]),r.xmlns=m[a];break;case"</workbook>":break;case"<fileVersion":delete m[0],r.AppVersion=m;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":fy.forEach(function(y){if(m[y[0]]!=null)switch(y[2]){case"bool":r.WBProps[y[0]]=Ar(m[y[0]]);break;case"int":r.WBProps[y[0]]=parseInt(m[y[0]],10);break;default:r.WBProps[y[0]]=m[y[0]]}}),m.codeName&&(r.WBProps.CodeName=_r(m.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete m[0],r.WBView.push(m);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(m.state){case"hidden":m.Hidden=1;break;case"veryHidden":m.Hidden=2;break;default:m.Hidden=0}delete m.state,m.name=Zt(_r(m.name)),delete m[0],r.Sheets.push(m);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=_r(m.name),m.comment&&(s.Comment=m.comment),m.localSheetId&&(s.Sheet=+m.localSheetId),Ar(m.hidden||"0")&&(s.Hidden=!0),l=d+f.length;break;case"</definedName>":s.Ref=Zt(_r(t.slice(l,d))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete m[0],r.CalcPr=m;break;case"<calcPr/>":delete m[0],r.CalcPr=m;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+m[0]+" in workbook")}return f}),Wl.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return EC(r),r}function bC(t){var e=[Zr];e[e.length]=$e("workbook",null,{xmlns:Wl[0],"xmlns:r":gn.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(fy.forEach(function(u){t.Workbook.WBProps[u[0]]!=null&&t.Workbook.WBProps[u[0]]!=u[1]&&(n[u[0]]=t.Workbook.WBProps[u[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=$e("workbookPr",null,n);var a=t.Workbook&&t.Workbook.Sheets||[],s=0;if(a&&a[0]&&a[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&!(!a[s]||!a[s].Hidden);++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var l={name:dr(t.SheetNames[s].slice(0,31))};if(l.sheetId=""+(s+1),l["r:id"]="rId"+(s+1),a[s])switch(a[s].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}e[e.length]=$e("sheet",null,l)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(u){var f={name:u.Name};u.Comment&&(f.comment=u.Comment),u.Sheet!=null&&(f.localSheetId=""+u.Sheet),u.Hidden&&(f.hidden="1"),u.Ref&&(e[e.length]=$e("definedName",dr(u.Ref),f))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function Pz(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=p1(t),r.name=Jn(t),r}function jz(t,e){return e||(e=Ce(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),Yv(t.strRelID,e),In(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function Uz(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var a=e>8?Jn(t):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function Bz(t,e){e||(e=Ce(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),p4(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function Vz(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function zz(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var a=t.read_shift(4),s=vM(t),l=SB(t,0,r),u=Kv(t);t.l=n;var f={Name:s,Ptg:l};return a<268435455&&(f.Sheet=a),u&&(f.Comment=u),f}function Hz(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;e||(e={}),e.biff=12;var s=[],l=[[]];return l.SheetNames=[],l.XTI=[],E0[16]={n:"BrtFRTArchID$",f:Vz},Os(t,function(f,d,m){switch(m){case 156:l.SheetNames.push(f.name),r.Sheets.push(f);break;case 153:r.WBProps=f;break;case 39:f.Sheet!=null&&(e.SID=f.Sheet),f.Ref=$n(f.Ptg,null,null,l,e),delete e.SID,delete f.Ptg,s.push(f);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([m,f]):l[0]=[m,f],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(f),l.XTI=l.XTI.concat(f);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(m),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(m),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!d.T){if(!a||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}},e),EC(r),r.Names=s,r.supbooks=l,r}function Gz(t,e){Pe(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};Pe(t,156,jz(a))}Pe(t,144)}function qz(t,e){e||(e=Ce(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return In("SheetJS",e),In(lm.version,e),In(lm.version,e),In("7262",e),e.length>e.l?e.slice(0,e.l):e}function Wz(t,e){e||(e=Ce(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function Xz(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,a=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&s==-1&&(s=n);s>a||(Pe(t,135),Pe(t,158,Wz(a)),Pe(t,136))}}function $z(t,e){var r=wa();return Pe(r,131),Pe(r,128,qz()),Pe(r,153,Bz(t.Workbook&&t.Workbook.WBProps||null)),Xz(r,t),Gz(r,t),Pe(r,132),r.end()}function Kz(t,e,r){return e.slice(-4)===".bin"?Hz(t,r):Mz(t,r)}function Yz(t,e,r,n,a,s,l,u){return e.slice(-4)===".bin"?fz(t,n,r,a,s,l,u):zB(t,n,r,a,s,l,u)}function Qz(t,e,r,n,a,s,l,u){return e.slice(-4)===".bin"?Az(t,n,r,a,s):Sz(t,n,r,a,s)}function Jz(t,e,r,n,a,s,l,u){return e.slice(-4)===".bin"?eU():tU()}function Zz(t,e,r,n,a,s,l,u){return e.slice(-4)===".bin"?Jj():Zj()}function eH(t,e,r,n){return e.slice(-4)===".bin"?K7(t,r,n):P7(t,r,n)}function tH(t,e,r){return aC(t,r)}function rH(t,e,r){return e.slice(-4)===".bin"?r7(t,r):Z9(t,r)}function nH(t,e,r){return e.slice(-4)===".bin"?Xj(t,r):jj(t,r)}function aH(t,e,r){return e.slice(-4)===".bin"?Lj(t):Oj(t)}function iH(t,e,r,n){return r.slice(-4)===".bin"?Mj(t,e,r,n):void 0}function sH(t,e,r){return e.slice(-4)===".bin"?Ij(t,e,r):Dj(t,e,r)}function oH(t,e,r){return(e.slice(-4)===".bin"?$z:bC)(t)}function lH(t,e,r,n,a){return(e.slice(-4)===".bin"?Ez:yC)(t,r,n,a)}function cH(t,e,r){return(e.slice(-4)===".bin"?ij:rC)(t,r)}function uH(t,e,r){return(e.slice(-4)===".bin"?i7:$4)(t,r)}function fH(t,e,r){return(e.slice(-4)===".bin"?$j:oC)(t)}function hH(t){return(t.slice(-4)===".bin"?Rj:iC)()}var SC=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,kC=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function di(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=t.match(SC),s,l,u,f;if(a)for(f=0;f!=a.length;++f)s=a[f].match(kC),(l=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?u="xmlns"+s[1].slice(6):u=s[1].slice(l+1),n[u]=s[2].slice(1,s[2].length-1));return n}function dH(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(SC),a,s,l,u;if(n)for(u=0;u!=n.length;++u)a=n[u].match(kC),(s=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(s+1),r[l]=a[2].slice(1,a[2].length-1));return r}var Zf;function mH(t,e){var r=Zf[t]||Zt(t);return r==="General"?Ll(e):Va(r,e)}function pH(t,e,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Ar(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=Nr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[Zt(e)]=a}function gH(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||Fs[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=d0(t.v):t.w=Ll(t.v):t.w=mH(e||"General",t.v)}catch(s){if(r.WTF)throw s}try{var n=Zf[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&ql(n)){var a=go(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(s){if(r.WTF)throw s}}}function xH(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=N7[n.Pattern]||n.Pattern)}t[e.ID]=e}function vH(t,e,r,n,a,s,l,u,f,d){var m="General",y=n.StyleID,_={};d=d||{};var E=[],b=0;for(y===void 0&&u&&(y=u.StyleID),y===void 0&&l&&(y=l.StyleID);s[y]!==void 0&&(s[y].nf&&(m=s[y].nf),s[y].Interior&&E.push(s[y].Interior),!!s[y].Parent);)y=s[y].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Ar(t);break;case"String":n.t="s",n.r=PT(Zt(t)),n.v=t.indexOf("<")>-1?Zt(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(Nr(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Zt(t):n.v<60&&(n.v=n.v-1),(!m||m=="General")&&(m="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=_4[t],d.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=PT(e||t));break}if(gH(n,m,d),d.cellFormula!==!1)if(n.Formula){var w=Zt(n.Formula);w.charCodeAt(0)==61&&(w=w.slice(1)),n.f=ou(w,a),delete n.Formula,n.ArrayRange=="RC"?n.F=ou("RC:RC",a):n.ArrayRange&&(n.F=ou(n.ArrayRange,a),f.push([er(n.F),n.F]))}else for(b=0;b<f.length;++b)a.r>=f[b][0].s.r&&a.r<=f[b][0].e.r&&a.c>=f[b][0].s.c&&a.c<=f[b][0].e.c&&(n.F=f[b][1]);d.cellStyles&&(E.forEach(function(S){!_.patternType&&S.patternType&&(_.patternType=S.patternType)}),n.s=_),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function yH(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Sx(t,e){var r=e||{};Su();var n=Pf(Hv(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=_r(n));var a=n.slice(0,1024).toLowerCase(),s=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var l=Ir(r);return l.type="string",gu.to_workbook(n,l)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(tr){a.indexOf("<"+tr)>=0&&(s=!0)}),s)return aG(n,r);Zf={"General Number":"General","General Date":mt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":mt[15],"Short Date":mt[14],"Long Time":mt[19],"Medium Time":mt[18],"Short Time":mt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:mt[2],Standard:mt[4],Percent:mt[10],Scientific:mt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,f=[],d,m={},y=[],_=r.dense?[]:{},E="",b={},w={},S=di('<Data ss:Type="String">'),M=0,j=0,F=0,G={s:{r:2e6,c:2e6},e:{r:0,c:0}},W={},B={},A="",D=0,k=[],O={},P={},N=0,R=[],he=[],xe={},ne=[],le,He=!1,ie=[],J=[],ge={},V=0,X=0,Z={Sheets:[],WBProps:{date1904:!1}},te={};g0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var fe="";u=g0.exec(n);)switch(u[3]=(fe=u[3]).toLowerCase()){case"data":if(fe=="data"){if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&f.push([u[3],!0]);break}if(f[f.length-1][1])break;u[1]==="/"?vH(n.slice(M,u.index),A,S,f[f.length-1][0]=="comment"?xe:b,{c:j,r:F},W,ne[j],w,ie,r):(A="",S=di(u[0]),M=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(he.length>0&&(b.c=he),(!r.sheetRows||r.sheetRows>F)&&b.v!==void 0&&(r.dense?(_[F]||(_[F]=[]),_[F][j]=b):_[Mr(j)+Jr(F)]=b),b.HRef&&(b.l={Target:Zt(b.HRef)},b.HRefScreenTip&&(b.l.Tooltip=b.HRefScreenTip),delete b.HRef,delete b.HRefScreenTip),(b.MergeAcross||b.MergeDown)&&(V=j+(parseInt(b.MergeAcross,10)|0),X=F+(parseInt(b.MergeDown,10)|0),k.push({s:{c:j,r:F},e:{c:V,r:X}})),!r.sheetStubs)b.MergeAcross?j=V+1:++j;else if(b.MergeAcross||b.MergeDown){for(var Se=j;Se<=V;++Se)for(var ke=F;ke<=X;++ke)(Se>j||ke>F)&&(r.dense?(_[ke]||(_[ke]=[]),_[ke][Se]={t:"z"}):_[Mr(Se)+Jr(ke)]={t:"z"});j=V+1}else++j;else b=dH(u[0]),b.Index&&(j=+b.Index-1),j<G.s.c&&(G.s.c=j),j>G.e.c&&(G.e.c=j),u[0].slice(-2)==="/>"&&++j,he=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(F<G.s.r&&(G.s.r=F),F>G.e.r&&(G.e.r=F),u[0].slice(-2)==="/>"&&(w=di(u[0]),w.Index&&(F=+w.Index-1)),j=0,++F):(w=di(u[0]),w.Index&&(F=+w.Index-1),ge={},(w.AutoFitHeight=="0"||w.Height)&&(ge.hpx=parseInt(w.Height,10),ge.hpt=w0(ge.hpx),J[F]=ge),w.Hidden=="1"&&(ge.hidden=!0,J[F]=ge));break;case"worksheet":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));y.push(E),G.s.r<=G.e.r&&G.s.c<=G.e.c&&(_["!ref"]=At(G),r.sheetRows&&r.sheetRows<=G.e.r&&(_["!fullref"]=_["!ref"],G.e.r=r.sheetRows-1,_["!ref"]=At(G))),k.length&&(_["!merges"]=k),ne.length>0&&(_["!cols"]=ne),J.length>0&&(_["!rows"]=J),m[E]=_}else G={s:{r:2e6,c:2e6},e:{r:0,c:0}},F=j=0,f.push([u[3],!1]),d=di(u[0]),E=Zt(d.Name),_=r.dense?[]:{},k=[],ie=[],J=[],te={name:E,Hidden:0},Z.Sheets.push(te);break;case"table":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else{if(u[0].slice(-2)=="/>")break;f.push([u[3],!1]),ne=[],He=!1}break;case"style":u[1]==="/"?xH(W,B,r):B=di(u[0]);break;case"numberformat":B.nf=Zt(di(u[0]).Format||"General"),Zf[B.nf]&&(B.nf=Zf[B.nf]);for(var Ne=0;Ne!=392&&mt[Ne]!=B.nf;++Ne);if(Ne==392){for(Ne=57;Ne!=392;++Ne)if(mt[Ne]==null){$i(B.nf,Ne);break}}break;case"column":if(f[f.length-1][0]!=="table")break;if(le=di(u[0]),le.Hidden&&(le.hidden=!0,delete le.Hidden),le.Width&&(le.wpx=parseInt(le.Width,10)),!He&&le.wpx>10){He=!0,Yn=eC;for(var Oe=0;Oe<ne.length;++Oe)ne[Oe]&&Fo(ne[Oe])}He&&Fo(le),ne[le.Index-1||ne.length]=le;for(var ot=0;ot<+le.Span;++ot)ne[ne.length]=Ir(le);break;case"namedrange":if(u[1]==="/")break;Z.Names||(Z.Names=[]);var ee=Tt(u[0]),Pt={Name:ee.Name,Ref:ou(ee.RefersTo.slice(1),{r:0,c:0})};Z.Sheets.length>0&&(Pt.Sheet=Z.Sheets.length-1),Z.Names.push(Pt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?A+=n.slice(D,u.index):D=u.index+u[0].length;break;case"interior":if(!r.cellStyles)break;B.Interior=di(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?HM(O,fe,n.slice(N,u.index)):N=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else f.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));yH(xe),he.push(xe)}else f.push([u[3],!1]),d=di(u[0]),xe={a:d.Author};break;case"autofilter":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var _t=di(u[0]);_["!autofilter"]={ref:ou(_t.Range).replace(/\$/g,"")},f.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&f.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&f.push([u[3],!0]);break;case"null":break;default:if(f.length==0&&u[3]=="document"||f.length==0&&u[3]=="uof")return Sb(n,r);var Dt=!0;switch(f[f.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Dt=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Dt=!1}break;case"excelworkbook":switch(u[3]){case"date1904":Z.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Dt=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:Dt=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(n.slice(N,u.index)){case"SheetHidden":te.Hidden=1;break;case"SheetVeryHidden":te.Hidden=2;break}else N=u.index+u[0].length;break;case"header":_["!margins"]||Al(_["!margins"]={},"xlml"),isNaN(+Tt(u[0]).Margin)||(_["!margins"].header=+Tt(u[0]).Margin);break;case"footer":_["!margins"]||Al(_["!margins"]={},"xlml"),isNaN(+Tt(u[0]).Margin)||(_["!margins"].footer=+Tt(u[0]).Margin);break;case"pagemargins":var nt=Tt(u[0]);_["!margins"]||Al(_["!margins"]={},"xlml"),isNaN(+nt.Top)||(_["!margins"].top=+nt.Top),isNaN(+nt.Left)||(_["!margins"].left=+nt.Left),isNaN(+nt.Right)||(_["!margins"].right=+nt.Right),isNaN(+nt.Bottom)||(_["!margins"].bottom=+nt.Bottom);break;case"displayrighttoleft":Z.Views||(Z.Views=[]),Z.Views[0]||(Z.Views[0]={}),Z.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Dt=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Dt=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Dt=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Dt=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Dt=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Dt=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Dt=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Dt=!1}break;case"smarttags":break;default:Dt=!1;break}if(Dt||u[3].match(/!\[CDATA/))break;if(!f[f.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+f.join("|");if(f[f.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?pH(P,fe,R,n.slice(N,u.index)):(R=u,N=u.index+u[0].length);break}if(r.WTF)throw"Unrecognized tag: "+u[3]+"|"+f.join("|")}var Ge={};return!r.bookSheets&&!r.bookProps&&(Ge.Sheets=m),Ge.SheetNames=y,Ge.Workbook=Z,Ge.SSF=Ir(mt),Ge.Props=O,Ge.Custprops=P,Ge}function E1(t,e){switch(dy(e=e||{}),e.type||"base64"){case"base64":return Sx(Ba(t),e);case"binary":case"buffer":case"file":return Sx(t,e);case"array":return Sx(zo(t),e)}}function _H(t,e){var r=[];return t.Props&&r.push(GM(t.Props,e)),t.Custprops&&r.push(qM(t.Props,t.Custprops)),r.join("")}function wH(){return""}function EH(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,a){var s=[];s.push($e("NumberFormat",null,{"ss:Format":dr(mt[n.numFmtId])}));var l={"ss:ID":"s"+(21+a)};r.push($e("Style",s.join(""),l))}),$e("Styles",r.join(""))}function AC(t){return $e("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+oy(t.Ref,{r:0,c:0})})}function TH(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var a=e[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(AC(a)))}return $e("Names",r.join(""))}function bH(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,s=[],l=0;l<a.length;++l){var u=a[l];u.Sheet==r&&(u.Name.match(/^_xlfn\./)||s.push(AC(u)))}return s.join("")}function SH(t,e,r,n){if(!t)return"";var a=[];if(t["!margins"]&&(a.push("<PageSetup>"),t["!margins"].header&&a.push($e("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&a.push($e("Footer",null,{"x:Margin":t["!margins"].footer})),a.push($e("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push($e("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),t["!protect"]&&(a.push(Bn("ProtectContents","True")),t["!protect"].objects&&a.push(Bn("ProtectObjects","True")),t["!protect"].scenarios&&a.push(Bn("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?a.push(Bn("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&a.push(Bn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){t["!protect"][l[0]]&&a.push("<"+l[1]+"/>")})),a.length==0?"":$e("WorksheetOptions",a.join(""),{xmlns:Oa.x})}function kH(t){return t.map(function(e){var r=XL(e.t||""),n=$e("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return $e("Comment",n,{"ss:Author":e.a})}).join("")}function AH(t,e,r,n,a,s,l){if(!t||t.v==null&&t.f==null)return"";var u={};if(t.f&&(u["ss:Formula"]="="+dr(oy(t.f,l))),t.F&&t.F.slice(0,e.length)==e){var f=Pr(t.F.slice(e.length+1));u["ss:ArrayRange"]="RC:R"+(f.r==l.r?"":"["+(f.r-l.r)+"]")+"C"+(f.c==l.c?"":"["+(f.c-l.c)+"]")}if(t.l&&t.l.Target&&(u["ss:HRef"]=dr(t.l.Target),t.l.Tooltip&&(u["x:HRefScreenTip"]=dr(t.l.Tooltip))),r["!merges"])for(var d=r["!merges"],m=0;m!=d.length;++m)d[m].s.c!=l.c||d[m].s.r!=l.r||(d[m].e.c>d[m].s.c&&(u["ss:MergeAcross"]=d[m].e.c-d[m].s.c),d[m].e.r>d[m].s.r&&(u["ss:MergeDown"]=d[m].e.r-d[m].s.r));var y="",_="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":y="Number",_=String(t.v);break;case"b":y="Boolean",_=t.v?"1":"0";break;case"e":y="Error",_=Fs[t.v];break;case"d":y="DateTime",_=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||mt[14]);break;case"s":y="String",_=WL(t.v||"");break}var E=Go(n.cellXfs,t,n);u["ss:StyleID"]="s"+(21+E),u["ss:Index"]=l.c+1;var b=t.v!=null?_:"",w=t.t=="z"?"":'<Data ss:Type="'+y+'">'+b+"</Data>";return(t.c||[]).length>0&&(w+=kH(t.c)),$e("Cell",w,u)}function CH(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=xu(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function NH(t,e,r,n){if(!t["!ref"])return"";var a=er(t["!ref"]),s=t["!merges"]||[],l=0,u=[];t["!cols"]&&t["!cols"].forEach(function(S,M){Fo(S);var j=!!S.width,F=Zm(M,S),G={"ss:Index":M+1};j&&(G["ss:Width"]=y0(F.width)),S.hidden&&(G["ss:Hidden"]="1"),u.push($e("Column",null,G))});for(var f=Array.isArray(t),d=a.s.r;d<=a.e.r;++d){for(var m=[CH(d,(t["!rows"]||[])[d])],y=a.s.c;y<=a.e.c;++y){var _=!1;for(l=0;l!=s.length;++l)if(!(s[l].s.c>y)&&!(s[l].s.r>d)&&!(s[l].e.c<y)&&!(s[l].e.r<d)){(s[l].s.c!=y||s[l].s.r!=d)&&(_=!0);break}if(!_){var E={r:d,c:y},b=xt(E),w=f?(t[d]||[])[y]:t[b];m.push(AH(w,b,t,e,r,n,E))}}m.push("</Row>"),m.length>2&&u.push(m.join(""))}return u.join("")}function IH(t,e,r){var n=[],a=r.SheetNames[t],s=r.Sheets[a],l=s?bH(s,e,t,r):"";return l.length>0&&n.push("<Names>"+l+"</Names>"),l=s?NH(s,e,t,r):"",l.length>0&&n.push("<Table>"+l+"</Table>"),n.push(SH(s,e,t,r)),n.join("")}function RH(t,e){e||(e={}),t.SSF||(t.SSF=Ir(mt)),t.SSF&&(Su(),z0(t.SSF),e.revssf=$m(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],Go(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(_H(t,e)),r.push(wH()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push($e("Worksheet",IH(n,e,t),{"ss:Name":dr(t.SheetNames[n])}));return r[2]=EH(t,e),r[3]=TH(t),Zr+$e("Workbook",r.join(""),{xmlns:Oa.ss,"xmlns:o":Oa.o,"xmlns:x":Oa.x,"xmlns:ss":Oa.ss,"xmlns:dt":Oa.dt,"xmlns:html":Oa.html})}function DH(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=TM(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=bM(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var OH=[60,1084,2066,2165,2175];function FH(t,e,r,n,a){var s=n,l=[],u=r.slice(r.l,r.l+s);if(a&&a.enc&&a.enc.insitu&&u.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(u)}l.push(u),r.l+=s;for(var f=Es(r,r.l),d=T1[f],m=0;d!=null&&OH.indexOf(f)>-1;)s=Es(r,r.l+2),m=r.l+4,f==2066?m+=4:(f==2165||f==2175)&&(m+=12),u=r.slice(m,r.l+4+s),l.push(u),r.l+=4+s,d=T1[f=Es(r,r.l)];var y=Nn(l);jn(y,0);var _=0;y.lens=[];for(var E=0;E<l.length;++E)y.lens.push(_),_+=l[E].length;if(y.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+y.length+" < "+n;return e.f(y,y.length,a)}function Li(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=mt[n])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Fs[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=d0(t.v):t.w=Ll(t.v):t.w=Va(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&n&&t.t=="n"&&ql(mt[n]||String(n))){var a=go(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function Id(t,e,r){return{v:t,ixfe:e,t:r}}function LH(t,e){var r={opts:{}},n={},a=e.dense?[]:{},s={},l={},u=null,f=[],d="",m={},y,_="",E,b,w,S,M={},j=[],F,G,W=[],B=[],A={Sheets:[],WBProps:{date1904:!1},Views:[{}]},D={},k=function(Je){return Je<8?bl[Je]:Je<64&&B[Je-8]||bl[Je]},O=function(Je,ft,Ae){var Me=ft.XF.data;if(!(!Me||!Me.patternType||!Ae||!Ae.cellStyles)){ft.s={},ft.s.patternType=Me.patternType;var Xe;(Xe=v0(k(Me.icvFore)))&&(ft.s.fgColor={rgb:Xe}),(Xe=v0(k(Me.icvBack)))&&(ft.s.bgColor={rgb:Xe})}},P=function(Je,ft,Ae){if(!(ge>1)&&!(Ae.sheetRows&&Je.r>=Ae.sheetRows)){if(Ae.cellStyles&&ft.XF&&ft.XF.data&&O(Je,ft,Ae),delete ft.ixfe,delete ft.XF,y=Je,_=xt(Je),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),Je.r<l.s.r&&(l.s.r=Je.r),Je.c<l.s.c&&(l.s.c=Je.c),Je.r+1>l.e.r&&(l.e.r=Je.r+1),Je.c+1>l.e.c&&(l.e.c=Je.c+1),Ae.cellFormula&&ft.f){for(var Me=0;Me<j.length;++Me)if(!(j[Me][0].s.c>Je.c||j[Me][0].s.r>Je.r)&&!(j[Me][0].e.c<Je.c||j[Me][0].e.r<Je.r)){ft.F=At(j[Me][0]),(j[Me][0].s.c!=Je.c||j[Me][0].s.r!=Je.r)&&delete ft.f,ft.f&&(ft.f=""+$n(j[Me][1],l,Je,ie,N));break}}Ae.dense?(a[Je.r]||(a[Je.r]=[]),a[Je.r][Je.c]=ft):a[_]=ft}},N={enc:!1,sbcch:0,snames:[],sharedf:M,arrayf:j,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(N.password=e.password);var R,he=[],xe=[],ne=[],le=[],He=!1,ie=[];ie.SheetNames=N.snames,ie.sharedf=N.sharedf,ie.arrayf=N.arrayf,ie.names=[],ie.XTI=[];var J=0,ge=0,V=0,X=[],Z=[],te;N.codepage=1200,pi(1200);for(var fe=!1;t.l<t.length-1;){var Se=t.l,ke=t.read_shift(2);if(ke===0&&J===10)break;var Ne=t.l===t.length?0:t.read_shift(2),Oe=T1[ke];if(Oe&&Oe.f){if(e.bookSheets&&J===133&&ke!==133)break;if(J=ke,Oe.r===2||Oe.r==12){var ot=t.read_shift(2);if(Ne-=2,!N.enc&&ot!==ke&&((ot&255)<<8|ot>>8)!==ke)throw new Error("rt mismatch: "+ot+"!="+ke);Oe.r==12&&(t.l+=10,Ne-=10)}var ee={};if(ke===10?ee=Oe.f(t,Ne,N):ee=FH(ke,Oe,t,Ne,N),ge==0&&[9,521,1033,2057].indexOf(J)===-1)continue;switch(ke){case 34:r.opts.Date1904=A.WBProps.date1904=ee;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(N.enc||(t.l=0),N.enc=ee,!e.password)throw new Error("File is password-protected");if(ee.valid==null)throw new Error("Encryption scheme unsupported");if(!ee.valid)throw new Error("Password is incorrect");break;case 92:N.lastuser=ee;break;case 66:var Pt=Number(ee);switch(Pt){case 21010:Pt=1200;break;case 32768:Pt=1e4;break;case 32769:Pt=1252;break}pi(N.codepage=Pt),fe=!0;break;case 317:N.rrtabid=ee;break;case 25:N.winlocked=ee;break;case 439:r.opts.RefreshAll=ee;break;case 12:r.opts.CalcCount=ee;break;case 16:r.opts.CalcDelta=ee;break;case 17:r.opts.CalcIter=ee;break;case 13:r.opts.CalcMode=ee;break;case 14:r.opts.CalcPrecision=ee;break;case 95:r.opts.CalcSaveRecalc=ee;break;case 15:N.CalcRefMode=ee;break;case 2211:r.opts.FullCalc=ee;break;case 129:ee.fDialog&&(a["!type"]="dialog"),ee.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),ee.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:W.push(ee);break;case 430:ie.push([ee]),ie[ie.length-1].XTI=[];break;case 35:case 547:ie[ie.length-1].push(ee);break;case 24:case 536:te={Name:ee.Name,Ref:$n(ee.rgce,l,null,ie,N)},ee.itab>0&&(te.Sheet=ee.itab-1),ie.names.push(te),ie[0]||(ie[0]=[],ie[0].XTI=[]),ie[ie.length-1].push(ee),ee.Name=="_xlnm._FilterDatabase"&&ee.itab>0&&ee.rgce&&ee.rgce[0]&&ee.rgce[0][0]&&ee.rgce[0][0][0]=="PtgArea3d"&&(Z[ee.itab-1]={ref:At(ee.rgce[0][0][1][2])});break;case 22:N.ExternCount=ee;break;case 23:ie.length==0&&(ie[0]=[],ie[0].XTI=[]),ie[ie.length-1].XTI=ie[ie.length-1].XTI.concat(ee),ie.XTI=ie.XTI.concat(ee);break;case 2196:if(N.biff<8)break;te!=null&&(te.Comment=ee[1]);break;case 18:a["!protect"]=ee;break;case 19:ee!==0&&N.WTF&&console.error("Password verifier: "+ee);break;case 133:s[ee.pos]=ee,N.snames.push(ee.name);break;case 10:{if(--ge)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,a["!ref"]=At(l),e.sheetRows&&e.sheetRows<=l.e.r){var _t=l.e.r;l.e.r=e.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=At(l),l.e.r=_t}l.e.r++,l.e.c++}he.length>0&&(a["!merges"]=he),xe.length>0&&(a["!objects"]=xe),ne.length>0&&(a["!cols"]=ne),le.length>0&&(a["!rows"]=le),A.Sheets.push(D)}d===""?m=a:n[d]=a,a=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(N.biff===8&&(N.biff={9:2,521:3,1033:4}[ke]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[ee.BIFFVer]||8),N.biffguess=ee.BIFFVer==0,ee.BIFFVer==0&&ee.dt==4096&&(N.biff=5,fe=!0,pi(N.codepage=28591)),N.biff==8&&ee.BIFFVer==0&&ee.dt==16&&(N.biff=2),ge++)break;if(a=e.dense?[]:{},N.biff<8&&!fe&&(fe=!0,pi(N.codepage=e.codepage||1252)),N.biff<5||ee.BIFFVer==0&&ee.dt==4096){d===""&&(d="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var Dt={pos:t.l-Ne,name:d};s[Dt.pos]=Dt,N.snames.push(d)}else d=(s[Se]||{name:""}).name;ee.dt==32&&(a["!type"]="chart"),ee.dt==64&&(a["!type"]="macro"),he=[],xe=[],N.arrayf=j=[],ne=[],le=[],He=!1,D={Hidden:(s[Se]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(e.dense?(a[ee.r]||[])[ee.c]:a[xt({c:ee.c,r:ee.r})])&&++ee.c,F={ixfe:ee.ixfe,XF:W[ee.ixfe]||{},v:ee.val,t:"n"},V>0&&(F.z=X[F.ixfe>>8&63]),Li(F,e,r.opts.Date1904),P({c:ee.c,r:ee.r},F,e);break;case 5:case 517:F={ixfe:ee.ixfe,XF:W[ee.ixfe],v:ee.val,t:ee.t},V>0&&(F.z=X[F.ixfe>>8&63]),Li(F,e,r.opts.Date1904),P({c:ee.c,r:ee.r},F,e);break;case 638:F={ixfe:ee.ixfe,XF:W[ee.ixfe],v:ee.rknum,t:"n"},V>0&&(F.z=X[F.ixfe>>8&63]),Li(F,e,r.opts.Date1904),P({c:ee.c,r:ee.r},F,e);break;case 189:for(var nt=ee.c;nt<=ee.C;++nt){var Ge=ee.rkrec[nt-ee.c][0];F={ixfe:Ge,XF:W[Ge],v:ee.rkrec[nt-ee.c][1],t:"n"},V>0&&(F.z=X[F.ixfe>>8&63]),Li(F,e,r.opts.Date1904),P({c:nt,r:ee.r},F,e)}break;case 6:case 518:case 1030:{if(ee.val=="String"){u=ee;break}if(F=Id(ee.val,ee.cell.ixfe,ee.tt),F.XF=W[F.ixfe],e.cellFormula){var tr=ee.formula;if(tr&&tr[0]&&tr[0][0]&&tr[0][0][0]=="PtgExp"){var Jt=tr[0][0][1][0],Ct=tr[0][0][1][1],wr=xt({r:Jt,c:Ct});M[wr]?F.f=""+$n(ee.formula,l,ee.cell,ie,N):F.F=((e.dense?(a[Jt]||[])[Ct]:a[wr])||{}).F}else F.f=""+$n(ee.formula,l,ee.cell,ie,N)}V>0&&(F.z=X[F.ixfe>>8&63]),Li(F,e,r.opts.Date1904),P(ee.cell,F,e),u=ee}break;case 7:case 519:if(u)u.val=ee,F=Id(ee,u.cell.ixfe,"s"),F.XF=W[F.ixfe],e.cellFormula&&(F.f=""+$n(u.formula,l,u.cell,ie,N)),V>0&&(F.z=X[F.ixfe>>8&63]),Li(F,e,r.opts.Date1904),P(u.cell,F,e),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{j.push(ee);var _n=xt(ee[0].s);if(E=e.dense?(a[ee[0].s.r]||[])[ee[0].s.c]:a[_n],e.cellFormula&&E){if(!u||!_n||!E)break;E.f=""+$n(ee[1],l,ee[0],ie,N),E.F=At(ee[0])}}break;case 1212:{if(!e.cellFormula)break;if(_){if(!u)break;M[xt(u.cell)]=ee[0],E=e.dense?(a[u.cell.r]||[])[u.cell.c]:a[xt(u.cell)],(E||{}).f=""+$n(ee[0],l,y,ie,N)}}break;case 253:F=Id(f[ee.isst].t,ee.ixfe,"s"),f[ee.isst].h&&(F.h=f[ee.isst].h),F.XF=W[F.ixfe],V>0&&(F.z=X[F.ixfe>>8&63]),Li(F,e,r.opts.Date1904),P({c:ee.c,r:ee.r},F,e);break;case 513:e.sheetStubs&&(F={ixfe:ee.ixfe,XF:W[ee.ixfe],t:"z"},V>0&&(F.z=X[F.ixfe>>8&63]),Li(F,e,r.opts.Date1904),P({c:ee.c,r:ee.r},F,e));break;case 190:if(e.sheetStubs)for(var Dr=ee.c;Dr<=ee.C;++Dr){var mr=ee.ixfe[Dr-ee.c];F={ixfe:mr,XF:W[mr],t:"z"},V>0&&(F.z=X[F.ixfe>>8&63]),Li(F,e,r.opts.Date1904),P({c:Dr,r:ee.r},F,e)}break;case 214:case 516:case 4:F=Id(ee.val,ee.ixfe,"s"),F.XF=W[F.ixfe],V>0&&(F.z=X[F.ixfe>>8&63]),Li(F,e,r.opts.Date1904),P({c:ee.c,r:ee.r},F,e);break;case 0:case 512:ge===1&&(l=ee);break;case 252:f=ee;break;case 1054:if(N.biff==4){X[V++]=ee[1];for(var en=0;en<V+163&&mt[en]!=ee[1];++en);en>=163&&$i(ee[1],V+163)}else $i(ee[1],ee[0]);break;case 30:{X[V++]=ee;for(var jt=0;jt<V+163&&mt[jt]!=ee;++jt);jt>=163&&$i(ee,V+163)}break;case 229:he=he.concat(ee);break;case 93:xe[ee.cmo[0]]=N.lastobj=ee;break;case 438:N.lastobj.TxO=ee;break;case 127:N.lastobj.ImData=ee;break;case 440:for(S=ee[0].s.r;S<=ee[0].e.r;++S)for(w=ee[0].s.c;w<=ee[0].e.c;++w)E=e.dense?(a[S]||[])[w]:a[xt({c:w,r:S})],E&&(E.l=ee[1]);break;case 2048:for(S=ee[0].s.r;S<=ee[0].e.r;++S)for(w=ee[0].s.c;w<=ee[0].e.c;++w)E=e.dense?(a[S]||[])[w]:a[xt({c:w,r:S})],E&&E.l&&(E.l.Tooltip=ee[1]);break;case 28:{if(N.biff<=5&&N.biff>=2)break;E=e.dense?(a[ee[0].r]||[])[ee[0].c]:a[xt(ee[0])];var oe=xe[ee[2]];E||(e.dense?(a[ee[0].r]||(a[ee[0].r]=[]),E=a[ee[0].r][ee[0].c]={t:"z"}):E=a[xt(ee[0])]={t:"z"},l.e.r=Math.max(l.e.r,ee[0].r),l.s.r=Math.min(l.s.r,ee[0].r),l.e.c=Math.max(l.e.c,ee[0].c),l.s.c=Math.min(l.s.c,ee[0].c)),E.c||(E.c=[]),b={a:ee[1],t:oe.TxO.t},E.c.push(b)}break;case 2173:Ej(W[ee.ixfe],ee.ext);break;case 125:{if(!N.cellStyles)break;for(;ee.e>=ee.s;)ne[ee.e--]={width:ee.w/256,level:ee.level||0,hidden:!!(ee.flags&1)},He||(He=!0,ay(ee.w/256)),Fo(ne[ee.e+1])}break;case 520:{var ze={};ee.level!=null&&(le[ee.r]=ze,ze.level=ee.level),ee.hidden&&(le[ee.r]=ze,ze.hidden=!0),ee.hpt&&(le[ee.r]=ze,ze.hpt=ee.hpt,ze.hpx=xu(ee.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Al(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ke]]=ee;break;case 161:a["!margins"]||Al(a["!margins"]={}),a["!margins"].header=ee.header,a["!margins"].footer=ee.footer;break;case 574:ee.RTL&&(A.Views[0].RTL=!0);break;case 146:B=ee;break;case 2198:R=ee;break;case 140:G=ee;break;case 442:d?D.CodeName=ee||D.name:A.WBProps.CodeName=ee||"ThisWorkbook";break}}else Oe||console.error("Missing Info for XLS Record 0x"+ke.toString(16)),t.l+=Ne}return r.SheetNames=Wr(s).sort(function(Ve,Je){return Number(Ve)-Number(Je)}).map(function(Ve){return s[Ve].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&m["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=m)):r.Preamble=m,r.Sheets&&Z.forEach(function(Ve,Je){r.Sheets[r.SheetNames[Je]]["!autofilter"]=Ve}),r.Strings=f,r.SSF=Ir(mt),N.enc&&(r.Encryption=N.enc),R&&(r.Themes=R),r.Metadata={},G!==void 0&&(r.Metadata.Country=G),ie.names.length>0&&(A.Names=ie.names),r.Workbook=A,r}var e0={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function MH(t,e,r){var n=ht.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=tb(n,g1,e0.DSI);for(var s in a)e[s]=a[s]}catch(d){if(r.WTF)throw d}var l=ht.find(t,"/!SummaryInformation");if(l&&l.size>0)try{var u=tb(l,x1,e0.SI);for(var f in u)e[f]==null&&(e[f]=u[f])}catch(d){if(r.WTF)throw d}e.HeadingPairs&&e.TitlesOfParts&&(k4(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function PH(t,e){var r=[],n=[],a=[],s=0,l,u=RT(g1,"n"),f=RT(x1,"n");if(t.Props)for(l=Wr(t.Props),s=0;s<l.length;++s)(Object.prototype.hasOwnProperty.call(u,l[s])?r:Object.prototype.hasOwnProperty.call(f,l[s])?n:a).push([l[s],t.Props[l[s]]]);if(t.Custprops)for(l=Wr(t.Custprops),s=0;s<l.length;++s)Object.prototype.hasOwnProperty.call(t.Props||{},l[s])||(Object.prototype.hasOwnProperty.call(u,l[s])?r:Object.prototype.hasOwnProperty.call(f,l[s])?n:a).push([l[s],t.Custprops[l[s]]]);var d=[];for(s=0;s<a.length;++s)O4.indexOf(a[s][0])>-1||S4.indexOf(a[s][0])>-1||a[s][1]!=null&&d.push(a[s]);n.length&&ht.utils.cfb_add(e,"/SummaryInformation",rb(n,e0.SI,f,x1)),(r.length||d.length)&&ht.utils.cfb_add(e,"/DocumentSummaryInformation",rb(r,e0.DSI,u,g1,d.length?d:null,e0.UDI))}function CC(t,e){e||(e={}),dy(e),Fv(),e.codepage&&Ov(e.codepage);var r,n;if(t.FullPaths){if(ht.find(t,"/encryption"))throw new Error("File is password-protected");r=ht.find(t,"!CompObj"),n=ht.find(t,"/Workbook")||ht.find(t,"/Book")}else{switch(e.type){case"base64":t=Ma(Ba(t));break;case"binary":t=Ma(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}jn(t,0),n={content:t}}var a,s;if(r&&DH(r),e.bookProps&&!e.bookSheets)a={};else{var l=Mt?"buffer":"array";if(n&&n.content)a=LH(n.content,e);else if((s=ht.find(t,"PerfectOffice_MAIN"))&&s.content)a=kl.to_workbook(s.content,(e.type=l,e));else if((s=ht.find(t,"NativeContent_MAIN"))&&s.content)a=kl.to_workbook(s.content,(e.type=l,e));else throw(s=ht.find(t,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&ht.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=Yj(t))}var u={};return t.FullPaths&&MH(t,u,e),a.Props=a.Custprops=u,e.bookFiles&&(a.cfb=t),a}function jH(t,e){var r=e||{},n=ht.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return ht.utils.cfb_add(n,a,NC(t,r)),r.biff==8&&(t.Props||t.Custprops)&&PH(t,n),r.biff==8&&t.vbaraw&&Qj(n,ht.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var E0={0:{f:lV},1:{f:gV},2:{f:LV},3:{f:bV},4:{f:_V},5:{f:DV},6:{f:BV},7:{f:CV},8:{f:XV},9:{f:WV},10:{f:GV},11:{f:qV},12:{f:vV},13:{f:PV},14:{f:kV},15:{f:EV},16:{f:_C},17:{f:zV},18:{f:IV},19:{f:$v},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:zz},40:{},42:{},43:{f:B7},44:{f:j7},45:{f:H7},46:{f:q7},47:{f:G7},48:{},49:{f:fM},50:{},51:{f:Sj},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:G4},62:{f:UV},63:{f:Fj},64:{f:cz},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ea,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:iz},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:mV},148:{f:fV,p:16},151:{f:ZV},152:{},153:{f:Uz},154:{},155:{},156:{f:Pz},157:{},158:{},159:{T:1,f:t7},160:{T:-1},161:{T:1,f:Yl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:$V},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Tj},336:{T:-1},337:{f:Cj,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:p1},357:{},358:{},359:{},360:{T:1},361:{},362:{f:H4},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:ez},427:{f:tz},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:nz},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:dV},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:QV},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:p1},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:qj},633:{T:1},634:{T:-1},635:{T:1,f:Hj},636:{T:-1},637:{f:pM},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:kz},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:uz},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},T1={6:{f:Tx},10:{f:io},12:{f:ln},13:{f:ln},14:{f:Yr},15:{f:Yr},16:{f:Qn},17:{f:Yr},18:{f:Yr},19:{f:ln},20:{f:lb},21:{f:lb},23:{f:H4},24:{f:ub},25:{f:Yr},26:{},27:{},28:{f:u9},29:{},34:{f:Yr},35:{f:cb},38:{f:Qn},39:{f:Qn},40:{f:Qn},41:{f:Qn},42:{f:Yr},43:{f:Yr},47:{f:E7},49:{f:PP},51:{f:ln},60:{},61:{f:DP},64:{f:Yr},65:{f:MP},66:{f:ln},77:{},80:{},81:{},82:{},85:{f:ln},89:{},90:{},91:{},92:{f:wP},93:{f:d9},94:{},95:{f:Yr},96:{},97:{},99:{f:Yr},125:{f:G4},128:{f:JP},129:{f:TP},130:{f:ln},131:{f:Yr},132:{f:Yr},133:{f:bP},134:{},140:{f:w9},141:{f:ln},144:{},146:{f:b9},151:{},152:{},153:{},154:{},155:{},156:{f:ln},157:{},158:{},160:{f:R9},161:{f:A9},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:$P},190:{f:KP},193:{f:io},197:{},198:{},199:{},200:{},201:{},202:{f:Yr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:ln},220:{},221:{f:Yr},222:{},224:{f:QP},225:{f:_P},226:{f:io},227:{},229:{f:f9},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:kP},253:{f:UP},255:{f:CP},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:F4},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Yr},353:{f:io},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:n9},431:{f:Yr},432:{},433:{},434:{},437:{},438:{f:g9},439:{f:Yr},440:{f:x9},441:{},442:{f:W0},443:{},444:{f:ln},445:{},446:{},448:{f:io},449:{f:RP,r:2},450:{f:io},512:{f:ib},513:{f:I9},515:{f:t9},516:{f:VP},517:{f:ob},519:{f:D9},520:{f:NP},523:{},545:{f:fb},549:{f:ab},566:{},574:{f:FP},638:{f:XP},659:{},1048:{},1054:{f:HP},1084:{},1212:{f:o9},2048:{f:y9},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Ad},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:io},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:S9,r:12},2173:{f:wj,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Yr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:s9,r:12},2197:{},2198:{f:pj,r:12},2199:{},2200:{},2201:{},2202:{f:l9,r:12},2203:{f:io},2204:{},2205:{},2206:{},2207:{},2211:{f:IP},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:ln},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:C9},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:T9},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:ib},1:{},2:{f:P9},3:{f:L9},4:{f:F9},5:{f:ob},7:{f:U9},8:{},9:{f:Ad},11:{},22:{f:ln},30:{f:qP},31:{},32:{},33:{f:fb},36:{},37:{f:ab},50:{f:B9},62:{},52:{},67:{},68:{f:ln},69:{},86:{},126:{},127:{f:O9},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:V9},223:{},234:{},354:{},421:{},518:{f:Tx},521:{f:Ad},536:{f:ub},547:{f:cb},561:{},579:{},1030:{f:Tx},1033:{f:Ad},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ye(t,e,r,n){var a=e;if(!isNaN(a)){var s=n||(r||[]).length||0,l=t.next(4);l.write_shift(2,a),l.write_shift(2,s),s>0&&qv(r)&&t.push(r)}}function UH(t,e,r,n){var a=(r||[]).length||0;if(a<=8224)return Ye(t,e,r,a);var s=e;if(!isNaN(s)){for(var l=r.parts||[],u=0,f=0,d=0;d+(l[u]||8224)<=8224;)d+=l[u]||8224,u++;var m=t.next(4);for(m.write_shift(2,s),m.write_shift(2,d),t.push(r.slice(f,f+d)),f+=d;f<a;){for(m=t.next(4),m.write_shift(2,60),d=0;d+(l[u]||8224)<=8224;)d+=l[u]||8224,u++;m.write_shift(2,d),t.push(r.slice(f,f+d)),f+=d}}}function Y0(t,e,r){return t||(t=Ce(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function BH(t,e,r,n){var a=Ce(9);return Y0(a,t,e),L4(r,n||"b",a),a}function VH(t,e,r){var n=Ce(8+2*r.length);return Y0(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function zH(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var a=e.t=="d"?yn(Nr(e.v)):e.v;a==(a|0)&&a>=0&&a<65536?Ye(t,2,j9(r,n,a)):Ye(t,3,M9(r,n,a));return;case"b":case"e":Ye(t,5,BH(r,n,e.v,e.t));return;case"s":case"str":Ye(t,4,VH(r,n,(e.v||"").slice(0,255)));return}Ye(t,1,Y0(null,r,n))}function HH(t,e,r,n){var a=Array.isArray(e),s=er(e["!ref"]||"A1"),l,u="",f=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),l=At(s)}for(var d=s.s.r;d<=s.e.r;++d){u=Jr(d);for(var m=s.s.c;m<=s.e.c;++m){d===s.s.r&&(f[m]=Mr(m)),l=f[m]+u;var y=a?(e[d]||[])[m]:e[l];y&&zH(t,y,d,m)}}}function GH(t,e){for(var r=e||{},n=wa(),a=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==r.sheet&&(a=s);if(a==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Ye(n,r.biff==4?1033:r.biff==3?521:9,ty(t,16,r)),HH(n,t.Sheets[t.SheetNames[a]],a,r),Ye(n,10),n.end()}function qH(t,e,r){Ye(t,49,jP({sz:12,name:"Arial"},r))}function WH(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&Ye(t,1054,GP(a,e[a],r))})}function XH(t,e){var r=Ce(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Ye(t,2151,r),r=Ce(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),B4(er(e["!ref"]||"A1"),r),r.write_shift(4,4),Ye(t,2152,r)}function $H(t,e){for(var r=0;r<16;++r)Ye(t,224,sb({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){Ye(t,224,sb(n,0,e))})}function KH(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];Ye(t,440,v9(n)),n[1].Tooltip&&Ye(t,2048,_9(n))}delete e["!links"]}function YH(t,e){if(e){var r=0;e.forEach(function(n,a){++r<=256&&n&&Ye(t,125,k9(Zm(a,n),a))})}}function QH(t,e,r,n,a){var s=16+Go(a.cellXfs,e,a);if(e.v==null&&!e.bf){Ye(t,513,Ul(r,n,s));return}if(e.bf)Ye(t,6,TB(e,r,n,a,s));else switch(e.t){case"d":case"n":var l=e.t=="d"?yn(Nr(e.v)):e.v;Ye(t,515,r9(r,n,l,s));break;case"b":case"e":Ye(t,517,e9(r,n,e.v,s,a,e.t));break;case"s":case"str":if(a.bookSST){var u=cy(a.Strings,e.v,a.revStrings);Ye(t,253,BP(r,n,u,s))}else Ye(t,516,zP(r,n,(e.v||"").slice(0,255),s,a));break;default:Ye(t,513,Ul(r,n,s))}}function JH(t,e,r){var n=wa(),a=r.SheetNames[t],s=r.Sheets[a]||{},l=(r||{}).Workbook||{},u=(l.Sheets||[])[t]||{},f=Array.isArray(s),d=e.biff==8,m,y="",_=[],E=er(s["!ref"]||"A1"),b=d?65536:16384;if(E.e.c>255||E.e.r>=b){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");E.e.c=Math.min(E.e.c,255),E.e.r=Math.min(E.e.c,b-1)}Ye(n,2057,ty(r,16,e)),Ye(n,13,ai(1)),Ye(n,12,ai(100)),Ye(n,15,fa(!0)),Ye(n,17,fa(!1)),Ye(n,16,Pl(.001)),Ye(n,95,fa(!0)),Ye(n,42,fa(!1)),Ye(n,43,fa(!1)),Ye(n,130,ai(1)),Ye(n,128,ZP()),Ye(n,131,fa(!1)),Ye(n,132,fa(!1)),d&&YH(n,s["!cols"]),Ye(n,512,WP(E,e)),d&&(s["!links"]=[]);for(var w=E.s.r;w<=E.e.r;++w){y=Jr(w);for(var S=E.s.c;S<=E.e.c;++S){w===E.s.r&&(_[S]=Mr(S)),m=_[S]+y;var M=f?(s[w]||[])[S]:s[m];M&&(QH(n,M,w,S,e),d&&M.l&&s["!links"].push([m,M.l]))}}var j=u.CodeName||u.name||a;return d&&Ye(n,574,LP((l.Views||[])[0])),d&&(s["!merges"]||[]).length&&Ye(n,229,h9(s["!merges"])),d&&KH(n,s),Ye(n,442,M4(j)),d&&XH(n,s),Ye(n,10),n.end()}function ZH(t,e,r){var n=wa(),a=(t||{}).Workbook||{},s=a.Sheets||[],l=a.WBProps||{},u=r.biff==8,f=r.biff==5;if(Ye(n,2057,ty(t,5,r)),r.bookType=="xla"&&Ye(n,135),Ye(n,225,u?ai(1200):null),Ye(n,193,eP(2)),f&&Ye(n,191),f&&Ye(n,192),Ye(n,226),Ye(n,92,EP("SheetJS",r)),Ye(n,66,ai(u?1200:1252)),u&&Ye(n,353,ai(0)),u&&Ye(n,448),Ye(n,317,N9(t.SheetNames.length)),u&&t.vbaraw&&Ye(n,211),u&&t.vbaraw){var d=l.CodeName||"ThisWorkbook";Ye(n,442,M4(d))}Ye(n,156,ai(17)),Ye(n,25,fa(!1)),Ye(n,18,fa(!1)),Ye(n,19,ai(0)),u&&Ye(n,431,fa(!1)),u&&Ye(n,444,ai(0)),Ye(n,61,OP()),Ye(n,64,fa(!1)),Ye(n,141,ai(0)),Ye(n,34,fa(Rz(t)=="true")),Ye(n,14,fa(!0)),u&&Ye(n,439,fa(!1)),Ye(n,218,ai(0)),qH(n,t,r),WH(n,t.SSF,r),$H(n,r),u&&Ye(n,352,fa(!1));var m=n.end(),y=wa();u&&Ye(y,140,E9()),u&&r.Strings&&UH(y,252,AP(r.Strings)),Ye(y,10);var _=y.end(),E=wa(),b=0,w=0;for(w=0;w<t.SheetNames.length;++w)b+=(u?12:11)+(u?2:1)*t.SheetNames[w].length;var S=m.length+b+_.length;for(w=0;w<t.SheetNames.length;++w){var M=s[w]||{};Ye(E,133,SP({pos:S,hs:M.Hidden||0,dt:0,name:t.SheetNames[w]},r)),S+=e[w].length}var j=E.end();if(b!=j.length)throw new Error("BS8 "+b+" != "+j.length);var F=[];return m.length&&F.push(m),j.length&&F.push(j),_.length&&F.push(_),Nn(F)}function eG(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=Ir(mt)),t&&t.SSF&&(Su(),z0(t.SSF),r.revssf=$m(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,my(r),r.cellXfs=[],Go(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var a=0;a<t.SheetNames.length;++a)n[n.length]=JH(a,r,t);return n.unshift(ZH(t,n,r)),Nn(n)}function NC(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var a=Ea(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return eG(t,e);case 4:case 3:case 2:return GH(t,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function wb(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var a=t.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=t.match(/<\/table/i),l=a.index,u=s&&s.index||t.length,f=jL(t.slice(l,u),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,m=0,y=0,_=0,E={s:{r:1e7,c:1e7},e:{r:0,c:0}},b=[];for(l=0;l<f.length;++l){var w=f[l].trim(),S=w.slice(0,3).toLowerCase();if(S=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}m=0;continue}if(!(S!="<td"&&S!="<th")){var M=w.split(/<\/t[dh]>/i);for(u=0;u<M.length;++u){var j=M[u].trim();if(j.match(/<t[dh]/i)){for(var F=j,G=0;F.charAt(0)=="<"&&(G=F.indexOf(">"))>-1;)F=F.slice(G+1);for(var W=0;W<b.length;++W){var B=b[W];B.s.c==m&&B.s.r<d&&d<=B.e.r&&(m=B.e.c+1,W=-1)}var A=Tt(j.slice(0,j.indexOf(">")));_=A.colspan?+A.colspan:1,((y=+A.rowspan)>1||_>1)&&b.push({s:{r:d,c:m},e:{r:d+(y||1)-1,c:m+_-1}});var D=A.t||A["data-t"]||"";if(!F.length){m+=_;continue}if(F=ZA(F),E.s.r>d&&(E.s.r=d),E.e.r<d&&(E.e.r=d),E.s.c>m&&(E.s.c=m),E.e.c<m&&(E.e.c=m),!F.length){m+=_;continue}var k={t:"s",v:F};r.raw||!F.trim().length||D=="s"||(F==="TRUE"?k={t:"b",v:!0}:F==="FALSE"?k={t:"b",v:!1}:isNaN(xi(F))?isNaN(pu(F).getDate())||(k={t:"d",v:Nr(F)},r.cellDates||(k={t:"n",v:yn(k.v)}),k.z=r.dateNF||mt[14]):k={t:"n",v:xi(F)}),r.dense?(n[d]||(n[d]=[]),n[d][m]=k):n[xt({r:d,c:m})]=k,m+=_}}}}return n["!ref"]=At(E),b.length&&(n["!merges"]=b),n}function tG(t,e,r,n){for(var a=t["!merges"]||[],s=[],l=e.s.c;l<=e.e.c;++l){for(var u=0,f=0,d=0;d<a.length;++d)if(!(a[d].s.r>r||a[d].s.c>l)&&!(a[d].e.r<r||a[d].e.c<l)){if(a[d].s.r<r||a[d].s.c<l){u=-1;break}u=a[d].e.r-a[d].s.r+1,f=a[d].e.c-a[d].s.c+1;break}if(!(u<0)){var m=xt({r,c:l}),y=n.dense?(t[r]||[])[l]:t[m],_=y&&y.v!=null&&(y.h||zv(y.w||(Is(y),y.w)||""))||"",E={};u>1&&(E.rowspan=u),f>1&&(E.colspan=f),n.editable?_='<span contenteditable="true">'+_+"</span>":y&&(E["data-t"]=y&&y.t||"z",y.v!=null&&(E["data-v"]=y.v),y.z!=null&&(E["data-z"]=y.z),y.l&&(y.l.Target||"#").charAt(0)!="#"&&(_='<a href="'+y.l.Target+'">'+_+"</a>")),E.id=(n.id||"sjs")+"-"+m,s.push($e("td",_,E))}}var b="<tr>";return b+s.join("")+"</tr>"}var rG='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',nG="</body></html>";function aG(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Ho(wb(r[0],e),e);var n=xy();return r.forEach(function(a,s){vy(n,wb(a,e),"Sheet"+(s+1))}),n}function iG(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function IC(t,e){var r=e||{},n=r.header!=null?r.header:rG,a=r.footer!=null?r.footer:nG,s=[n],l=Ea(t["!ref"]);r.dense=Array.isArray(t),s.push(iG(t,l,r));for(var u=l.s.r;u<=l.e.r;++u)s.push(tG(t,l,u,r));return s.push("</table>"+a),s.join("")}function RC(t,e,r){var n=r||{},a=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Pr(n.origin):n.origin;a=l.r,s=l.c}var u=e.getElementsByTagName("tr"),f=Math.min(n.sheetRows||1e7,u.length),d={s:{r:0,c:0},e:{r:a,c:s}};if(t["!ref"]){var m=Ea(t["!ref"]);d.s.r=Math.min(d.s.r,m.s.r),d.s.c=Math.min(d.s.c,m.s.c),d.e.r=Math.max(d.e.r,m.e.r),d.e.c=Math.max(d.e.c,m.e.c),a==-1&&(d.e.r=a=m.e.r+1)}var y=[],_=0,E=t["!rows"]||(t["!rows"]=[]),b=0,w=0,S=0,M=0,j=0,F=0;for(t["!cols"]||(t["!cols"]=[]);b<u.length&&w<f;++b){var G=u[b];if(Eb(G)){if(n.display)continue;E[w]={hidden:!0}}var W=G.children;for(S=M=0;S<W.length;++S){var B=W[S];if(!(n.display&&Eb(B))){var A=B.hasAttribute("data-v")?B.getAttribute("data-v"):B.hasAttribute("v")?B.getAttribute("v"):ZA(B.innerHTML),D=B.getAttribute("data-z")||B.getAttribute("z");for(_=0;_<y.length;++_){var k=y[_];k.s.c==M+s&&k.s.r<w+a&&w+a<=k.e.r&&(M=k.e.c+1-s,_=-1)}F=+B.getAttribute("colspan")||1,((j=+B.getAttribute("rowspan")||1)>1||F>1)&&y.push({s:{r:w+a,c:M+s},e:{r:w+a+(j||1)-1,c:M+s+(F||1)-1}});var O={t:"s",v:A},P=B.getAttribute("data-t")||B.getAttribute("t")||"";A!=null&&(A.length==0?O.t=P||"z":n.raw||A.trim().length==0||P=="s"||(A==="TRUE"?O={t:"b",v:!0}:A==="FALSE"?O={t:"b",v:!1}:isNaN(xi(A))?isNaN(pu(A).getDate())||(O={t:"d",v:Nr(A)},n.cellDates||(O={t:"n",v:yn(O.v)}),O.z=n.dateNF||mt[14]):O={t:"n",v:xi(A)})),O.z===void 0&&D!=null&&(O.z=D);var N="",R=B.getElementsByTagName("A");if(R&&R.length)for(var he=0;he<R.length&&!(R[he].hasAttribute("href")&&(N=R[he].getAttribute("href"),N.charAt(0)!="#"));++he);N&&N.charAt(0)!="#"&&(O.l={Target:N}),n.dense?(t[w+a]||(t[w+a]=[]),t[w+a][M+s]=O):t[xt({c:M+s,r:w+a})]=O,d.e.c<M+s&&(d.e.c=M+s),M+=F}}++w}return y.length&&(t["!merges"]=(t["!merges"]||[]).concat(y)),d.e.r=Math.max(d.e.r,w-1+a),t["!ref"]=At(d),w>=f&&(t["!fullref"]=At((d.e.r=u.length-b+w-1+a,d))),t}function DC(t,e){var r=e||{},n=r.dense?[]:{};return RC(n,t,e)}function sG(t,e){return Ho(DC(t,e),e)}function Eb(t){var e="",r=oG(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function oG(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function lG(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Zt(e.replace(/<[^>]*>/g,""));return[r]}var Tb={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function OC(t,e){var r=e||{},n=Hv(t),a=[],s,l,u={name:""},f="",d=0,m,y,_={},E=[],b=r.dense?[]:{},w,S,M={value:""},j="",F=0,G=[],W=-1,B=-1,A={s:{r:1e6,c:1e7},e:{r:0,c:0}},D=0,k={},O=[],P={},N=0,R=0,he=[],xe=1,ne=1,le=[],He={Names:[]},ie={},J=["",""],ge=[],V={},X="",Z=0,te=!1,fe=!1,Se=0;for(g0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");w=g0.exec(n);)switch(w[3]=w[3].replace(/_.*$/,"")){case"table":case"":w[1]==="/"?(A.e.c>=A.s.c&&A.e.r>=A.s.r?b["!ref"]=At(A):b["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=A.e.r&&(b["!fullref"]=b["!ref"],A.e.r=r.sheetRows-1,b["!ref"]=At(A)),O.length&&(b["!merges"]=O),he.length&&(b["!rows"]=he),m.name=m.||m.name,typeof JSON<"u"&&JSON.stringify(m),E.push(m.name),_[m.name]=b,fe=!1):w[0].charAt(w[0].length-2)!=="/"&&(m=Tt(w[0],!1),W=B=-1,A.s.r=A.s.c=1e7,A.e.r=A.e.c=0,b=r.dense?[]:{},O=[],he=[],fe=!0);break;case"table-row-group":w[1]==="/"?--D:++D;break;case"table-row":case"":if(w[1]==="/"){W+=xe,xe=1;break}if(y=Tt(w[0],!1),y.?W=y.-1:W==-1&&(W=0),xe=+y["number-rows-repeated"]||1,xe<10)for(Se=0;Se<xe;++Se)D>0&&(he[W+Se]={level:D});B=-1;break;case"covered-table-cell":w[1]!=="/"&&++B,r.sheetStubs&&(r.dense?(b[W]||(b[W]=[]),b[W][B]={t:"z"}):b[xt({r:W,c:B})]={t:"z"}),j="",G=[];break;case"table-cell":case"":if(w[0].charAt(w[0].length-2)==="/")++B,M=Tt(w[0],!1),ne=parseInt(M["number-columns-repeated"]||"1",10),S={t:"z",v:null},M.formula&&r.cellFormula!=!1&&(S.f=vb(Zt(M.formula))),(M.||M["value-type"])=="string"&&(S.t="s",S.v=Zt(M["string-value"]||""),r.dense?(b[W]||(b[W]=[]),b[W][B]=S):b[xt({r:W,c:B})]=S),B+=ne-1;else if(w[1]!=="/"){++B,j="",F=0,G=[],ne=1;var ke=xe?W+xe-1:W;if(B>A.e.c&&(A.e.c=B),B<A.s.c&&(A.s.c=B),W<A.s.r&&(A.s.r=W),ke>A.e.r&&(A.e.r=ke),M=Tt(w[0],!1),ge=[],V={},S={t:M.||M["value-type"],v:null},r.cellFormula)if(M.formula&&(M.formula=Zt(M.formula)),M["number-matrix-columns-spanned"]&&M["number-matrix-rows-spanned"]&&(N=parseInt(M["number-matrix-rows-spanned"],10)||0,R=parseInt(M["number-matrix-columns-spanned"],10)||0,P={s:{r:W,c:B},e:{r:W+N-1,c:B+R-1}},S.F=At(P),le.push([P,S.F])),M.formula)S.f=vb(M.formula);else for(Se=0;Se<le.length;++Se)W>=le[Se][0].s.r&&W<=le[Se][0].e.r&&B>=le[Se][0].s.c&&B<=le[Se][0].e.c&&(S.F=le[Se][1]);switch((M["number-columns-spanned"]||M["number-rows-spanned"])&&(N=parseInt(M["number-rows-spanned"],10)||0,R=parseInt(M["number-columns-spanned"],10)||0,P={s:{r:W,c:B},e:{r:W+N-1,c:B+R-1}},O.push(P)),M["number-columns-repeated"]&&(ne=parseInt(M["number-columns-repeated"],10)),S.t){case"boolean":S.t="b",S.v=Ar(M["boolean-value"]);break;case"float":S.t="n",S.v=parseFloat(M.value);break;case"percentage":S.t="n",S.v=parseFloat(M.value);break;case"currency":S.t="n",S.v=parseFloat(M.value);break;case"date":S.t="d",S.v=Nr(M["date-value"]),r.cellDates||(S.t="n",S.v=yn(S.v)),S.z="m/d/yy";break;case"time":S.t="n",S.v=LL(M["time-value"])/86400,r.cellDates&&(S.t="d",S.v=Km(S.v)),S.z="HH:MM:SS";break;case"number":S.t="n",S.v=parseFloat(M.);break;default:if(S.t==="string"||S.t==="text"||!S.t)S.t="s",M["string-value"]!=null&&(j=Zt(M["string-value"]),G=[]);else throw new Error("Unsupported value type "+S.t)}}else{if(te=!1,S.t==="s"&&(S.v=j||"",G.length&&(S.R=G),te=F==0),ie.Target&&(S.l=ie),ge.length>0&&(S.c=ge,ge=[]),j&&r.cellText!==!1&&(S.w=j),te&&(S.t="z",delete S.v),(!te||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=W))for(var Ne=0;Ne<xe;++Ne){if(ne=parseInt(M["number-columns-repeated"]||"1",10),r.dense)for(b[W+Ne]||(b[W+Ne]=[]),b[W+Ne][B]=Ne==0?S:Ir(S);--ne>0;)b[W+Ne][B+ne]=Ir(S);else for(b[xt({r:W+Ne,c:B})]=S;--ne>0;)b[xt({r:W+Ne,c:B+ne})]=Ir(S);A.e.c<=B&&(A.e.c=B)}ne=parseInt(M["number-columns-repeated"]||"1",10),B+=ne-1,ne=0,S={},j="",G=[]}ie={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(w[1]==="/"){if((s=a.pop())[0]!==w[3])throw"Bad state: "+s}else w[0].charAt(w[0].length-2)!=="/"&&a.push([w[3],!0]);break;case"annotation":if(w[1]==="/"){if((s=a.pop())[0]!==w[3])throw"Bad state: "+s;V.t=j,G.length&&(V.R=G),V.a=X,ge.push(V)}else w[0].charAt(w[0].length-2)!=="/"&&a.push([w[3],!1]);X="",Z=0,j="",F=0,G=[];break;case"creator":w[1]==="/"?X=n.slice(Z,w.index):Z=w.index+w[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(w[1]==="/"){if((s=a.pop())[0]!==w[3])throw"Bad state: "+s}else w[0].charAt(w[0].length-2)!=="/"&&a.push([w[3],!1]);j="",F=0,G=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(w[1]==="/"){if(k[u.name]=f,(s=a.pop())[0]!==w[3])throw"Bad state: "+s}else w[0].charAt(w[0].length-2)!=="/"&&(f="",u=Tt(w[0],!1),a.push([w[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":l=Tt(w[0],!1),f+=Tb[w[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":l=Tt(w[0],!1),f+=Tb[w[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(w[0].slice(-2)==="/>")break;if(w[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":f+=n.slice(d,w.index);break}else d=w.index+w[0].length;break;case"named-range":l=Tt(w[0],!1),J=bx(l["cell-range-address"]);var Oe={Name:l.name,Ref:J[0]+"!"+J[1]};fe&&(Oe.Sheet=E.length),He.Names.push(Oe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(w[1]==="/"&&(!M||!M["string-value"])){var ot=lG(n.slice(F,w.index));j=(j.length>0?j+`
`:"")+ot[0]}else Tt(w[0],!1),F=w.index+w[0].length;break;case"s":break;case"database-range":if(w[1]==="/")break;try{J=bx(Tt(w[0])["target-range-address"]),_[J[0]]["!autofilter"]={ref:J[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(w[1]!=="/"){if(ie=Tt(w[0],!1),!ie.href)break;ie.Target=Zt(ie.href),delete ie.href,ie.Target.charAt(0)=="#"&&ie.Target.indexOf(".")>-1?(J=bx(ie.Target.slice(1)),ie.Target="#"+J[0]+"!"+J[1]):ie.Target.match(/^\.\.[\\\/]/)&&(ie.Target=ie.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(w[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(w)}}var ee={Sheets:_,SheetNames:E,Workbook:He};return r.bookSheets&&delete ee.Sheets,ee}function bb(t,e){e=e||{},ni(t,"META-INF/manifest.xml")&&LM(on(t,"META-INF/manifest.xml"),e);var r=Pa(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=OC(_r(r),e);return ni(t,"meta.xml")&&(n.Props=T4(on(t,"meta.xml"))),n}function Sb(t,e){return OC(t,e)}var cG=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+p0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Zr+e}}(),kb=function(){var t=function(s){return dr(s).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,l,u){var f=[];f.push('      <table:table table:name="'+dr(l.SheetNames[u])+`" table:style-name="ta1">
`);var d=0,m=0,y=Ea(s["!ref"]||"A1"),_=s["!merges"]||[],E=0,b=Array.isArray(s);if(s["!cols"])for(m=0;m<=y.e.c;++m)f.push("        <table:table-column"+(s["!cols"][m]?' table:style-name="co'+s["!cols"][m].ods+'"':"")+`></table:table-column>
`);var w="",S=s["!rows"]||[];for(d=0;d<y.s.r;++d)w=S[d]?' table:style-name="ro'+S[d].ods+'"':"",f.push("        <table:table-row"+w+`></table:table-row>
`);for(;d<=y.e.r;++d){for(w=S[d]?' table:style-name="ro'+S[d].ods+'"':"",f.push("        <table:table-row"+w+`>
`),m=0;m<y.s.c;++m)f.push(e);for(;m<=y.e.c;++m){var M=!1,j={},F="";for(E=0;E!=_.length;++E)if(!(_[E].s.c>m)&&!(_[E].s.r>d)&&!(_[E].e.c<m)&&!(_[E].e.r<d)){(_[E].s.c!=m||_[E].s.r!=d)&&(M=!0),j["table:number-columns-spanned"]=_[E].e.c-_[E].s.c+1,j["table:number-rows-spanned"]=_[E].e.r-_[E].s.r+1;break}if(M){f.push(r);continue}var G=xt({r:d,c:m}),W=b?(s[d]||[])[m]:s[G];if(W&&W.f&&(j["table:formula"]=dr(NB(W.f)),W.F&&W.F.slice(0,G.length)==G)){var B=Ea(W.F);j["table:number-matrix-columns-spanned"]=B.e.c-B.s.c+1,j["table:number-matrix-rows-spanned"]=B.e.r-B.s.r+1}if(!W){f.push(e);continue}switch(W.t){case"b":F=W.v?"TRUE":"FALSE",j["office:value-type"]="boolean",j["office:boolean-value"]=W.v?"true":"false";break;case"n":F=W.w||String(W.v||0),j["office:value-type"]="float",j["office:value"]=W.v||0;break;case"s":case"str":F=W.v==null?"":W.v,j["office:value-type"]="string";break;case"d":F=W.w||Nr(W.v).toISOString(),j["office:value-type"]="date",j["office:date-value"]=Nr(W.v).toISOString(),j["table:style-name"]="ce1";break;default:f.push(e);continue}var A=t(F);if(W.l&&W.l.Target){var D=W.l.Target;D=D.charAt(0)=="#"?"#"+IB(D.slice(1)):D,D.charAt(0)!="#"&&!D.match(/^\w+:/)&&(D="../"+D),A=$e("text:a",A,{"xlink:href":D.replace(/&/g,"&amp;")})}f.push("          "+$e("table:table-cell",$e("text:p",A,{}),j)+`
`)}f.push(`        </table:table-row>
`)}return f.push(`      </table:table>
`),f.join("")},a=function(s,l){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var u=0;l.SheetNames.map(function(d){return l.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var m=0;m<d["!cols"].length;++m)if(d["!cols"][m]){var y=d["!cols"][m];if(y.width==null&&y.wpx==null&&y.wch==null)continue;Fo(y),y.ods=u;var _=d["!cols"][m].wpx+"px";s.push('  <style:style style:name="co'+u+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+_+`"/>
`),s.push(`  </style:style>
`),++u}}});var f=0;l.SheetNames.map(function(d){return l.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var m=0;m<d["!rows"].length;++m)if(d["!rows"][m]){d["!rows"][m].ods=f;var y=d["!rows"][m].hpx+"px";s.push('  <style:style style:name="ro'+f+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+y+`"/>
`),s.push(`  </style:style>
`),++f}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(l,u){var f=[Zr],d=p0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),m=p0({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});u.bookType=="fods"?(f.push("<office:document"+d+m+`>
`),f.push(E4().replace(/office:document-meta/g,"office:meta"))):f.push("<office:document-content"+d+`>
`),a(f,l),f.push(`  <office:body>
`),f.push(`    <office:spreadsheet>
`);for(var y=0;y!=l.SheetNames.length;++y)f.push(n(l.Sheets[l.SheetNames[y]],l,y));return f.push(`    </office:spreadsheet>
`),f.push(`  </office:body>
`),u.bookType=="fods"?f.push("</office:document>"):f.push("</office:document-content>"),f.join("")}}();function FC(t,e){if(e.bookType=="fods")return kb(t,e);var r=Uv(),n="",a=[],s=[];return n="mimetype",Rt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Rt(r,n,kb(t,e)),a.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",Rt(r,n,cG(t,e)),a.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",Rt(r,n,Zr+E4()),a.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",Rt(r,n,jM(s)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Rt(r,n,MM(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Bl(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function b1(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):_r(zo(t))}function uG(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Ma(Bi(t))}function fG(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function Mo(t){var e=t.reduce(function(a,s){return a+s.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(a){r.set(a,n),n+=a.length}),r}function Ab(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function hG(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,a=e+13;a>=e;--a)n=n*256+t[a];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function dG(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var s=0;a>=1;++s,a/=256)t[e+s]=a&255;t[e+15]|=r>=0?0:128}function T0(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function fr(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function Gr(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function ar(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],a=T0(t,r),s=a&7;a=Math.floor(a/8);var l=0,u;if(a==0)break;switch(s){case 0:{for(var f=r[0];t[r[0]++]>=128;);u=t.slice(f,r[0])}break;case 5:l=4,u=t.slice(r[0],r[0]+l),r[0]+=l;break;case 1:l=8,u=t.slice(r[0],r[0]+l),r[0]+=l;break;case 2:l=T0(t,r),u=t.slice(r[0],r[0]+l),r[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(n))}var d={data:u,type:s};e[a]==null?e[a]=[d]:e[a].push(d)}return e}function Mn(t){var e=[];return t.forEach(function(r,n){r.forEach(function(a){a.data&&(e.push(fr(n*8+a.type)),a.type==2&&e.push(fr(a.data.length)),e.push(a.data))})}),Mo(e)}function hy(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function ti(t){for(var e,r=[],n=[0];n[0]<t.length;){var a=T0(t,n),s=ar(t.slice(n[0],n[0]+a));n[0]+=a;var l={id:Gr(s[1][0].data),messages:[]};s[2].forEach(function(u){var f=ar(u.data),d=Gr(f[3][0].data);l.messages.push({meta:f,data:t.slice(n[0],n[0]+d)}),n[0]+=d}),(e=s[3])!=null&&e[0]&&(l.merge=Gr(s[3][0].data)>>>0>0),r.push(l)}return r}function Bc(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:fr(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:fr(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(l){a.push(l.data),l.meta[3]=[{type:0,data:fr(l.data.length)}],n[2].push({data:Mn(l.meta),type:2})});var s=Mn(n);e.push(fr(s.length)),e.push(s),a.forEach(function(l){return e.push(l)})}),Mo(e)}function mG(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=T0(e,r),a=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var l=e[r[0]++]>>2;if(l<60)++l;else{var u=l-59;l=e[r[0]],u>1&&(l|=e[r[0]+1]<<8),u>2&&(l|=e[r[0]+2]<<16),u>3&&(l|=e[r[0]+3]<<24),l>>>=0,l++,r[0]+=u}a.push(e.slice(r[0],r[0]+l)),r[0]+=l;continue}else{var f=0,d=0;if(s==1?(d=(e[r[0]]>>2&7)+4,f=(e[r[0]++]&224)<<3,f|=e[r[0]++]):(d=(e[r[0]++]>>2)+1,s==2?(f=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(f=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Mo(a)],f==0)throw new Error("Invalid offset 0");if(f>a[0].length)throw new Error("Invalid offset beyond length");if(d>=f)for(a.push(a[0].slice(-f)),d-=f;d>=a[a.length-1].length;)a.push(a[a.length-1]),d-=a[a.length-1].length;a.push(a[0].slice(-f,-f+d))}}var m=Mo(a);if(m.length!=n)throw new Error("Unexpected length: ".concat(m.length," != ").concat(n));return m}function ri(t){for(var e=[],r=0;r<t.length;){var n=t[r++],a=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(mG(n,t.slice(r,r+a))),r+=a}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Mo(e)}function Vc(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),a=new Uint8Array(4);e.push(a);var s=fr(n),l=s.length;e.push(s),n<=60?(l++,e.push(new Uint8Array([n-1<<2]))):n<=256?(l+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(l+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(l+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(l+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),l+=n,a[0]=0,a[1]=l&255,a[2]=l>>8&255,a[3]=l>>16&255,r+=n}return Mo(e)}function pG(t,e,r,n){var a=Bl(t),s=a.getUint32(4,!0),l=(n>1?12:8)+Ab(s&(n>1?3470:398))*4,u=-1,f=-1,d=NaN,m=new Date(2001,0,1);s&512&&(u=a.getUint32(l,!0),l+=4),l+=Ab(s&(n>1?12288:4096))*4,s&16&&(f=a.getUint32(l,!0),l+=4),s&32&&(d=a.getFloat64(l,!0),l+=8),s&64&&(m.setTime(m.getTime()+a.getFloat64(l,!0)*1e3),l+=8);var y;switch(t[2]){case 0:break;case 2:y={t:"n",v:d};break;case 3:y={t:"s",v:e[f]};break;case 5:y={t:"d",v:m};break;case 6:y={t:"b",v:d>0};break;case 7:y={t:"n",v:d/86400};break;case 8:y={t:"e",v:0};break;case 9:if(u>-1)y={t:"s",v:r[u]};else if(f>-1)y={t:"s",v:e[f]};else if(!isNaN(d))y={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return y}function gG(t,e,r){var n=Bl(t),a=n.getUint32(8,!0),s=12,l=-1,u=-1,f=NaN,d=NaN,m=new Date(2001,0,1);a&1&&(f=hG(t,s),s+=16),a&2&&(d=n.getFloat64(s,!0),s+=8),a&4&&(m.setTime(m.getTime()+n.getFloat64(s,!0)*1e3),s+=8),a&8&&(u=n.getUint32(s,!0),s+=4),a&16&&(l=n.getUint32(s,!0),s+=4);var y;switch(t[1]){case 0:break;case 2:y={t:"n",v:f};break;case 3:y={t:"s",v:e[u]};break;case 5:y={t:"d",v:m};break;case 6:y={t:"b",v:d>0};break;case 7:y={t:"n",v:d/86400};break;case 8:y={t:"e",v:0};break;case 9:if(l>-1)y={t:"s",v:r[l]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)));break;case 10:y={t:"n",v:f};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)))}return y}function kx(t,e){var r=new Uint8Array(32),n=Bl(r),a=12,s=0;switch(r[0]=5,t.t){case"n":r[1]=2,dG(r,a,t.v),s|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,t.v?1:0,!0),s|=2,a+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(a,e.indexOf(t.v),!0),s|=8,a+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,s,!0),r.slice(0,a)}function Ax(t,e){var r=new Uint8Array(32),n=Bl(r),a=12,s=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(a,t.v,!0),s|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,t.v?1:0,!0),s|=32,a+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(a,e.indexOf(t.v),!0),s|=16,a+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,s,!0),r.slice(0,a)}function xG(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return pG(t,e,r,t[0]);case 5:return gG(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Xn(t){var e=ar(t);return T0(e[1][0].data)}function Cb(t,e){var r=ar(e.data),n=Gr(r[1][0].data),a=r[3],s=[];return(a||[]).forEach(function(l){var u=ar(l.data),f=Gr(u[1][0].data)>>>0;switch(n){case 1:s[f]=b1(u[3][0].data);break;case 8:{var d=t[Xn(u[9][0].data)][0],m=ar(d.data),y=t[Xn(m[1][0].data)][0],_=Gr(y.meta[1][0].data);if(_!=2001)throw new Error("2000 unexpected reference to ".concat(_));var E=ar(y.data);s[f]=E[3].map(function(b){return b1(b.data)}).join("")}break}}),s}function vG(t,e){var r,n,a,s,l,u,f,d,m,y,_,E,b,w,S=ar(t),M=Gr(S[1][0].data)>>>0,j=Gr(S[2][0].data)>>>0,F=((n=(r=S[8])==null?void 0:r[0])==null?void 0:n.data)&&Gr(S[8][0].data)>0||!1,G,W;if((s=(a=S[7])==null?void 0:a[0])!=null&&s.data&&e!=0)G=(u=(l=S[7])==null?void 0:l[0])==null?void 0:u.data,W=(d=(f=S[6])==null?void 0:f[0])==null?void 0:d.data;else if((y=(m=S[4])==null?void 0:m[0])!=null&&y.data&&e!=1)G=(E=(_=S[4])==null?void 0:_[0])==null?void 0:E.data,W=(w=(b=S[3])==null?void 0:b[0])==null?void 0:w.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var B=F?4:1,A=Bl(G),D=[],k=0;k<G.length/2;++k){var O=A.getUint16(k*2,!0);O<65535&&D.push([k,O])}if(D.length!=j)throw"Expected ".concat(j," cells, found ").concat(D.length);var P=[];for(k=0;k<D.length-1;++k)P[D[k][0]]=W.subarray(D[k][1]*B,D[k+1][1]*B);return D.length>=1&&(P[D[D.length-1][0]]=W.subarray(D[D.length-1][1]*B)),{R:M,cells:P}}function yG(t,e){var r,n=ar(e.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?Gr(n[7][0].data)>>>0>0?1:0:-1,s=hy(n[5],function(l){return vG(l,a)});return{nrows:Gr(n[4][0].data)>>>0,data:s.reduce(function(l,u){return l[u.R]||(l[u.R]=[]),u.cells.forEach(function(f,d){if(l[u.R][d])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(d));l[u.R][d]=f}),l},[])}}function _G(t,e,r){var n,a=ar(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Gr(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(Gr(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=At(s);var l=ar(a[4][0].data),u=Cb(t,t[Xn(l[4][0].data)][0]),f=(n=l[17])!=null&&n[0]?Cb(t,t[Xn(l[17][0].data)][0]):[],d=ar(l[3][0].data),m=0;d[1].forEach(function(y){var _=ar(y.data),E=t[Xn(_[2][0].data)][0],b=Gr(E.meta[1][0].data);if(b!=6002)throw new Error("6001 unexpected reference to ".concat(b));var w=yG(t,E);w.data.forEach(function(S,M){S.forEach(function(j,F){var G=xt({r:m+M,c:F}),W=xG(j,u,f);W&&(r[G]=W)})}),m+=w.nrows})}function wG(t,e){var r=ar(e.data),n={"!ref":"A1"},a=t[Xn(r[2][0].data)],s=Gr(a[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return _G(t,a[0],n),n}function EG(t,e){var r,n=ar(e.data),a={name:(r=n[1])!=null&&r[0]?b1(n[1][0].data):"",sheets:[]},s=hy(n[2],Xn);return s.forEach(function(l){t[l].forEach(function(u){var f=Gr(u.meta[1][0].data);f==6e3&&a.sheets.push(wG(t,u))})}),a}function TG(t,e){var r=xy(),n=ar(e.data),a=hy(n[1],Xn);if(a.forEach(function(s){t[s].forEach(function(l){var u=Gr(l.meta[1][0].data);if(u==2){var f=EG(t,l);f.sheets.forEach(function(d,m){vy(r,d,m==0?f.name:f.name+"_"+m,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Cx(t){var e,r,n,a,s={},l=[];if(t.FullPaths.forEach(function(f){if(f.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(f){if(f.name.match(/\.iwa$/)){var d;try{d=ri(f.content)}catch(y){return console.log("?? "+f.content.length+" "+(y.message||y))}var m;try{m=ti(d)}catch(y){return console.log("## "+(y.message||y))}m.forEach(function(y){s[y.id]=y.messages,l.push(y.id)})}}),!l.length)throw new Error("File has no messages");var u=((a=(n=(r=(e=s==null?void 0:s[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Gr(s[1][0].meta[1][0].data)==1&&s[1][0];if(u||l.forEach(function(f){s[f].forEach(function(d){var m=Gr(d.meta[1][0].data)>>>0;if(m==1)if(!u)u=d;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return TG(s,u)}function bG(t,e,r){var n,a,s,l;if(!((n=t[6])!=null&&n[0])||!((a=t[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var u=((l=(s=t[8])==null?void 0:s[0])==null?void 0:l.data)&&Gr(t[8][0].data)>0||!1;if(u)throw"Math only works with normal offsets";for(var f=0,d=Bl(t[7][0].data),m=0,y=[],_=Bl(t[4][0].data),E=0,b=[],w=0;w<e.length;++w){if(e[w]==null){d.setUint16(w*2,65535,!0),_.setUint16(w*2,65535);continue}d.setUint16(w*2,m,!0),_.setUint16(w*2,E,!0);var S,M;switch(typeof e[w]){case"string":S=kx({t:"s",v:e[w]},r),M=Ax({t:"s",v:e[w]},r);break;case"number":S=kx({t:"n",v:e[w]},r),M=Ax({t:"n",v:e[w]},r);break;case"boolean":S=kx({t:"b",v:e[w]},r),M=Ax({t:"b",v:e[w]},r);break;default:throw new Error("Unsupported value "+e[w])}y.push(S),m+=S.length,b.push(M),E+=M.length,++f}for(t[2][0].data=fr(f);w<t[7][0].data.length/2;++w)d.setUint16(w*2,65535,!0),_.setUint16(w*2,65535,!0);return t[6][0].data=Mo(y),t[3][0].data=Mo(b),f}function SG(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Ea(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(At(n)));var s=wm(r,{range:n,header:1}),l=["~Sh33tJ5~"];s.forEach(function(X){return X.forEach(function(Z){typeof Z=="string"&&l.push(Z)})});var u={},f=[],d=ht.read(e.numbers,{type:"base64"});d.FileIndex.map(function(X,Z){return[X,d.FullPaths[Z]]}).forEach(function(X){var Z=X[0],te=X[1];if(Z.type==2&&Z.name.match(/\.iwa/)){var fe=Z.content,Se=ri(fe),ke=ti(Se);ke.forEach(function(Ne){f.push(Ne.id),u[Ne.id]={deps:[],location:te,type:Gr(Ne.messages[0].meta[1][0].data)}})}}),f.sort(function(X,Z){return X-Z});var m=f.filter(function(X){return X>1}).map(function(X){return[X,fr(X)]});d.FileIndex.map(function(X,Z){return[X,d.FullPaths[Z]]}).forEach(function(X){var Z=X[0];if(X[1],!!Z.name.match(/\.iwa/)){var te=ti(ri(Z.content));te.forEach(function(fe){fe.messages.forEach(function(Se){m.forEach(function(ke){fe.messages.some(function(Ne){return Gr(Ne.meta[1][0].data)!=11006&&fG(Ne.data,ke[1])})&&u[ke[0]].deps.push(fe.id)})})})}});for(var y=ht.find(d,u[1].location),_=ti(ri(y.content)),E,b=0;b<_.length;++b){var w=_[b];w.id==1&&(E=w)}var S=Xn(ar(E.messages[0].data)[1][0].data);for(y=ht.find(d,u[S].location),_=ti(ri(y.content)),b=0;b<_.length;++b)w=_[b],w.id==S&&(E=w);for(S=Xn(ar(E.messages[0].data)[2][0].data),y=ht.find(d,u[S].location),_=ti(ri(y.content)),b=0;b<_.length;++b)w=_[b],w.id==S&&(E=w);for(S=Xn(ar(E.messages[0].data)[2][0].data),y=ht.find(d,u[S].location),_=ti(ri(y.content)),b=0;b<_.length;++b)w=_[b],w.id==S&&(E=w);var M=ar(E.messages[0].data);{M[6][0].data=fr(n.e.r+1),M[7][0].data=fr(n.e.c+1);var j=Xn(M[46][0].data),F=ht.find(d,u[j].location),G=ti(ri(F.content));{for(var W=0;W<G.length&&G[W].id!=j;++W);if(G[W].id!=j)throw"Bad ColumnRowUIDMapArchive";var B=ar(G[W].messages[0].data);B[1]=[],B[2]=[],B[3]=[];for(var A=0;A<=n.e.c;++A){var D=[];D[1]=D[2]=[{type:0,data:fr(A+420690)}],B[1].push({type:2,data:Mn(D)}),B[2].push({type:0,data:fr(A)}),B[3].push({type:0,data:fr(A)})}B[4]=[],B[5]=[],B[6]=[];for(var k=0;k<=n.e.r;++k)D=[],D[1]=D[2]=[{type:0,data:fr(k+726270)}],B[4].push({type:2,data:Mn(D)}),B[5].push({type:0,data:fr(k)}),B[6].push({type:0,data:fr(k)});G[W].messages[0].data=Mn(B)}F.content=Vc(Bc(G)),F.size=F.content.length,delete M[46];var O=ar(M[4][0].data);{O[7][0].data=fr(n.e.r+1);var P=ar(O[1][0].data),N=Xn(P[2][0].data);F=ht.find(d,u[N].location),G=ti(ri(F.content));{if(G[0].id!=N)throw"Bad HeaderStorageBucket";var R=ar(G[0].messages[0].data);for(k=0;k<s.length;++k){var he=ar(R[2][0].data);he[1][0].data=fr(k),he[4][0].data=fr(s[k].length),R[2][k]={type:R[2][0].type,data:Mn(he)}}G[0].messages[0].data=Mn(R)}F.content=Vc(Bc(G)),F.size=F.content.length;var xe=Xn(O[2][0].data);F=ht.find(d,u[xe].location),G=ti(ri(F.content));{if(G[0].id!=xe)throw"Bad HeaderStorageBucket";for(R=ar(G[0].messages[0].data),A=0;A<=n.e.c;++A)he=ar(R[2][0].data),he[1][0].data=fr(A),he[4][0].data=fr(n.e.r+1),R[2][A]={type:R[2][0].type,data:Mn(he)};G[0].messages[0].data=Mn(R)}F.content=Vc(Bc(G)),F.size=F.content.length;var ne=Xn(O[4][0].data);(function(){for(var X=ht.find(d,u[ne].location),Z=ti(ri(X.content)),te,fe=0;fe<Z.length;++fe){var Se=Z[fe];Se.id==ne&&(te=Se)}var ke=ar(te.messages[0].data);{ke[3]=[];var Ne=[];l.forEach(function(ee,Pt){Ne[1]=[{type:0,data:fr(Pt)}],Ne[2]=[{type:0,data:fr(1)}],Ne[3]=[{type:2,data:uG(ee)}],ke[3].push({type:2,data:Mn(Ne)})})}te.messages[0].data=Mn(ke);var Oe=Bc(Z),ot=Vc(Oe);X.content=ot,X.size=X.content.length})();var le=ar(O[3][0].data);{var He=le[1][0];delete le[2];var ie=ar(He.data);{var J=Xn(ie[2][0].data);(function(){for(var X=ht.find(d,u[J].location),Z=ti(ri(X.content)),te,fe=0;fe<Z.length;++fe){var Se=Z[fe];Se.id==J&&(te=Se)}var ke=ar(te.messages[0].data);{delete ke[6],delete le[7];var Ne=new Uint8Array(ke[5][0].data);ke[5]=[];for(var Oe=0,ot=0;ot<=n.e.r;++ot){var ee=ar(Ne);Oe+=bG(ee,s[ot],l),ee[1][0].data=fr(ot),ke[5].push({data:Mn(ee),type:2})}ke[1]=[{type:0,data:fr(n.e.c+1)}],ke[2]=[{type:0,data:fr(n.e.r+1)}],ke[3]=[{type:0,data:fr(Oe)}],ke[4]=[{type:0,data:fr(n.e.r+1)}]}te.messages[0].data=Mn(ke);var Pt=Bc(Z),_t=Vc(Pt);X.content=_t,X.size=X.content.length})()}He.data=Mn(ie)}O[3][0].data=Mn(le)}M[4][0].data=Mn(O)}E.messages[0].data=Mn(M);var ge=Bc(_),V=Vc(ge);return y.content=V,y.size=y.content.length,d}function LC(t){return function(r){for(var n=0;n!=t.length;++n){var a=t[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function dy(t){LC([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function my(t){LC([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function kG(t){return Bt.WS.indexOf(t)>-1?"sheet":t==Bt.CS?"chart":t==Bt.DS?"dialog":t==Bt.MS?"macro":t&&t.length?t:"sheet"}function AG(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,kG(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function CG(t,e,r,n,a,s,l,u,f,d,m,y){try{s[n]=Yf(Pa(t,r,!0),e);var _=on(t,e),E;switch(u){case"sheet":E=Yz(_,e,a,f,s[n],d,m,y);break;case"chart":if(E=Qz(_,e,a,f,s[n],d,m,y),!E||!E["!drawel"])break;var b=Uf(E["!drawel"].Target,e),w=x0(b),S=Pj(Pa(t,b,!0),Yf(Pa(t,w,!0),b)),M=Uf(S,b),j=x0(M);E=bz(Pa(t,M,!0),M,f,Yf(Pa(t,j,!0),M),d,E);break;case"macro":E=Jz(_,e,a,f,s[n],d,m,y);break;case"dialog":E=Zz(_,e,a,f,s[n],d,m,y);break;default:throw new Error("Unrecognized sheet type "+u)}l[n]=E;var F=[];s&&s[n]&&Wr(s[n]).forEach(function(G){var W="";if(s[n][G].Type==Bt.CMNT){W=Uf(s[n][G].Target,e);var B=nH(on(t,W,!0),W,f);if(!B||!B.length)return;db(E,B,!1)}s[n][G].Type==Bt.TCMNT&&(W=Uf(s[n][G].Target,e),F=F.concat(Uj(on(t,W,!0),f)))}),F&&F.length&&db(E,F,!0,f.people||[])}catch(G){if(f.WTF)throw G}}function Za(t){return t.charAt(0)=="/"?t.slice(1):t}function NG(t,e){if(Su(),e=e||{},dy(e),ni(t,"META-INF/manifest.xml")||ni(t,"objectdata.xml"))return bb(t,e);if(ni(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Cx<"u"){if(t.FileIndex)return Cx(t);var r=ht.utils.cfb_new();return FT(t).forEach(function(he){Rt(r,he,BL(t,he))}),Cx(r)}throw new Error("Unsupported NUMBERS file")}if(!ni(t,"[Content_Types].xml"))throw ni(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):ni(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=FT(t),a=OM(Pa(t,"[Content_Types].xml")),s=!1,l,u;if(a.workbooks.length===0&&(u="xl/workbook.xml",on(t,u,!0)&&a.workbooks.push(u)),a.workbooks.length===0){if(u="xl/workbook.bin",!on(t,u,!0))throw new Error("Could not find workbook");a.workbooks.push(u),s=!0}a.workbooks[0].slice(-3)=="bin"&&(s=!0);var f={},d={};if(!e.bookSheets&&!e.bookProps){if(Qf=[],a.sst)try{Qf=rH(on(t,Za(a.sst)),a.sst,e)}catch(he){if(e.WTF)throw he}e.cellStyles&&a.themes.length&&(f=tH(Pa(t,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],e)),a.style&&(d=eH(on(t,Za(a.style)),a.style,f,e))}a.links.map(function(he){try{var xe=Yf(Pa(t,x0(Za(he))),he);return iH(on(t,Za(he)),xe,he,e)}catch{}});var m=Kz(on(t,Za(a.workbooks[0])),a.workbooks[0],e),y={},_="";a.coreprops.length&&(_=on(t,Za(a.coreprops[0]),!0),_&&(y=T4(_)),a.extprops.length!==0&&(_=on(t,Za(a.extprops[0]),!0),_&&BM(_,y,e)));var E={};(!e.bookSheets||e.bookProps)&&a.custprops.length!==0&&(_=Pa(t,Za(a.custprops[0]),!0),_&&(E=zM(_,e)));var b={};if((e.bookSheets||e.bookProps)&&(m.Sheets?l=m.Sheets.map(function(xe){return xe.name}):y.Worksheets&&y.SheetNames.length>0&&(l=y.SheetNames),e.bookProps&&(b.Props=y,b.Custprops=E),e.bookSheets&&typeof l<"u"&&(b.SheetNames=l),e.bookSheets?b.SheetNames:e.bookProps))return b;l={};var w={};e.bookDeps&&a.calcchain&&(w=aH(on(t,Za(a.calcchain)),a.calcchain));var S=0,M={},j,F;{var G=m.Sheets;y.Worksheets=G.length,y.SheetNames=[];for(var W=0;W!=G.length;++W)y.SheetNames[W]=G[W].name}var B=s?"bin":"xml",A=a.workbooks[0].lastIndexOf("/"),D=(a.workbooks[0].slice(0,A+1)+"_rels/"+a.workbooks[0].slice(A+1)+".rels").replace(/^\//,"");ni(t,D)||(D="xl/_rels/workbook."+B+".rels");var k=Yf(Pa(t,D,!0),D.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(e.xlmeta=sH(on(t,Za(a.metadata[0])),a.metadata[0],e)),(a.people||[]).length>=1&&(e.people=Vj(on(t,Za(a.people[0])),e)),k&&(k=AG(k,m.Sheets));var O=on(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(S=0;S!=y.Worksheets;++S){var P="sheet";if(k&&k[S]?(j="xl/"+k[S][1].replace(/[\/]?xl\//,""),ni(t,j)||(j=k[S][1]),ni(t,j)||(j=D.replace(/_rels\/.*$/,"")+k[S][1]),P=k[S][2]):(j="xl/worksheets/sheet"+(S+1-O)+"."+B,j=j.replace(/sheet0\./,"sheet.")),F=j.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(S!=e.sheets)continue e;break;case"string":if(y.SheetNames[S].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var N=!1,R=0;R!=e.sheets.length;++R)typeof e.sheets[R]=="number"&&e.sheets[R]==S&&(N=1),typeof e.sheets[R]=="string"&&e.sheets[R].toLowerCase()==y.SheetNames[S].toLowerCase()&&(N=1);if(!N)continue e}}CG(t,j,F,y.SheetNames[S],S,M,l,P,e,m,f,d)}return b={Directory:a,Workbook:m,Props:y,Custprops:E,Deps:w,Sheets:l,SheetNames:y.SheetNames,Strings:Qf,Styles:d,Themes:f,SSF:Ir(mt)},e&&e.bookFiles&&(t.files?(b.keys=n,b.files=t.files):(b.keys=[],b.files={},t.FullPaths.forEach(function(he,xe){he=he.replace(/^Root Entry[\/]/,""),b.keys.push(he),b.files[he]=t.FileIndex[xe]}))),e&&e.bookVBA&&(a.vba.length>0?b.vbaraw=on(t,Za(a.vba[0]),!0):a.defaults&&a.defaults.bin===Kj&&(b.vbaraw=on(t,"xl/vbaProject.bin",!0))),b}function IG(t,e){var r=e||{},n="Workbook",a=ht.find(t,n);try{if(n="/!DataSpaces/Version",a=ht.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(s7(a.content),n="/!DataSpaces/DataSpaceMap",a=ht.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=l7(a.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=ht.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=c7(a.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=ht.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);f7(a.content)}catch{}if(n="/EncryptionInfo",a=ht.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var u=h7(a.content);if(n="/EncryptedPackage",a=ht.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],a.content,r.password||"",r);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function RG(t,e){return e.bookType=="ods"?FC(t,e):e.bookType=="numbers"?SG(t,e):e.bookType=="xlsb"?DG(t,e):OG(t,e)}function DG(t,e){Kc=1024,t&&!t.SSF&&(t.SSF=Ir(mt)),t&&t.SSF&&(Su(),z0(t.SSF),e.revssf=$m(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Jf?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=lC.indexOf(e.bookType)>-1,a=Zv();my(e=e||{});var s=Uv(),l="",u=0;if(e.cellXfs=[],Go(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),l="docProps/core.xml",Rt(s,l,b4(t.Props,e)),a.coreprops.push(l),hr(e.rels,2,l,Bt.CORE_PROPS),l="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var f=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&f.push(t.SheetNames[d]);t.Props.SheetNames=f}for(t.Props.Worksheets=t.Props.SheetNames.length,Rt(s,l,A4(t.Props)),a.extprops.push(l),hr(e.rels,3,l,Bt.EXT_PROPS),t.Custprops!==t.Props&&Wr(t.Custprops||{}).length>0&&(l="docProps/custom.xml",Rt(s,l,C4(t.Custprops)),a.custprops.push(l),hr(e.rels,4,l,Bt.CUST_PROPS)),u=1;u<=t.SheetNames.length;++u){var m={"!id":{}},y=t.Sheets[t.SheetNames[u-1]],_=(y||{})["!type"]||"sheet";switch(_){case"chart":default:l="xl/worksheets/sheet"+u+"."+r,Rt(s,l,lH(u-1,l,e,t,m)),a.sheets.push(l),hr(e.wbrels,-1,"worksheets/sheet"+u+"."+r,Bt.WS[0])}if(y){var E=y["!comments"],b=!1,w="";E&&E.length>0&&(w="xl/comments"+u+"."+r,Rt(s,w,fH(E,w)),a.comments.push(w),hr(m,-1,"../comments"+u+"."+r,Bt.CMNT),b=!0),y["!legacy"]&&b&&Rt(s,"xl/drawings/vmlDrawing"+u+".vml",sC(u,y["!comments"])),delete y["!comments"],delete y["!legacy"]}m["!id"].rId1&&Rt(s,x0(l),su(m))}return e.Strings!=null&&e.Strings.length>0&&(l="xl/sharedStrings."+r,Rt(s,l,uH(e.Strings,l,e)),a.strs.push(l),hr(e.wbrels,-1,"sharedStrings."+r,Bt.SST)),l="xl/workbook."+r,Rt(s,l,oH(t,l)),a.workbooks.push(l),hr(e.rels,1,l,Bt.WB),l="xl/theme/theme1.xml",Rt(s,l,iy(t.Themes,e)),a.themes.push(l),hr(e.wbrels,-1,"theme/theme1.xml",Bt.THEME),l="xl/styles."+r,Rt(s,l,cH(t,l,e)),a.styles.push(l),hr(e.wbrels,-1,"styles."+r,Bt.STY),t.vbaraw&&n&&(l="xl/vbaProject.bin",Rt(s,l,t.vbaraw),a.vba.push(l),hr(e.wbrels,-1,"vbaProject.bin",Bt.VBA)),l="xl/metadata."+r,Rt(s,l,hH(l)),a.metadata.push(l),hr(e.wbrels,-1,"metadata."+r,Bt.XLMETA),Rt(s,"[Content_Types].xml",w4(a,e)),Rt(s,"_rels/.rels",su(e.rels)),Rt(s,"xl/_rels/workbook."+r+".rels",su(e.wbrels)),delete e.revssf,delete e.ssf,s}function OG(t,e){Kc=1024,t&&!t.SSF&&(t.SSF=Ir(mt)),t&&t.SSF&&(Su(),z0(t.SSF),e.revssf=$m(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Jf?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=lC.indexOf(e.bookType)>-1,a=Zv();my(e=e||{});var s=Uv(),l="",u=0;if(e.cellXfs=[],Go(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),l="docProps/core.xml",Rt(s,l,b4(t.Props,e)),a.coreprops.push(l),hr(e.rels,2,l,Bt.CORE_PROPS),l="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var f=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&f.push(t.SheetNames[d]);t.Props.SheetNames=f}t.Props.Worksheets=t.Props.SheetNames.length,Rt(s,l,A4(t.Props)),a.extprops.push(l),hr(e.rels,3,l,Bt.EXT_PROPS),t.Custprops!==t.Props&&Wr(t.Custprops||{}).length>0&&(l="docProps/custom.xml",Rt(s,l,C4(t.Custprops)),a.custprops.push(l),hr(e.rels,4,l,Bt.CUST_PROPS));var m=["SheetJ5"];for(e.tcid=0,u=1;u<=t.SheetNames.length;++u){var y={"!id":{}},_=t.Sheets[t.SheetNames[u-1]],E=(_||{})["!type"]||"sheet";switch(E){case"chart":default:l="xl/worksheets/sheet"+u+"."+r,Rt(s,l,yC(u-1,e,t,y)),a.sheets.push(l),hr(e.wbrels,-1,"worksheets/sheet"+u+"."+r,Bt.WS[0])}if(_){var b=_["!comments"],w=!1,S="";if(b&&b.length>0){var M=!1;b.forEach(function(j){j[1].forEach(function(F){F.T==!0&&(M=!0)})}),M&&(S="xl/threadedComments/threadedComment"+u+"."+r,Rt(s,S,Bj(b,m,e)),a.threadedcomments.push(S),hr(y,-1,"../threadedComments/threadedComment"+u+"."+r,Bt.TCMNT)),S="xl/comments"+u+"."+r,Rt(s,S,oC(b)),a.comments.push(S),hr(y,-1,"../comments"+u+"."+r,Bt.CMNT),w=!0}_["!legacy"]&&w&&Rt(s,"xl/drawings/vmlDrawing"+u+".vml",sC(u,_["!comments"])),delete _["!comments"],delete _["!legacy"]}y["!id"].rId1&&Rt(s,x0(l),su(y))}return e.Strings!=null&&e.Strings.length>0&&(l="xl/sharedStrings."+r,Rt(s,l,$4(e.Strings,e)),a.strs.push(l),hr(e.wbrels,-1,"sharedStrings."+r,Bt.SST)),l="xl/workbook."+r,Rt(s,l,bC(t)),a.workbooks.push(l),hr(e.rels,1,l,Bt.WB),l="xl/theme/theme1.xml",Rt(s,l,iy(t.Themes,e)),a.themes.push(l),hr(e.wbrels,-1,"theme/theme1.xml",Bt.THEME),l="xl/styles."+r,Rt(s,l,rC(t,e)),a.styles.push(l),hr(e.wbrels,-1,"styles."+r,Bt.STY),t.vbaraw&&n&&(l="xl/vbaProject.bin",Rt(s,l,t.vbaraw),a.vba.push(l),hr(e.wbrels,-1,"vbaProject.bin",Bt.VBA)),l="xl/metadata."+r,Rt(s,l,iC()),a.metadata.push(l),hr(e.wbrels,-1,"metadata."+r,Bt.XLMETA),m.length>1&&(l="xl/persons/person.xml",Rt(s,l,zj(m)),a.people.push(l),hr(e.wbrels,-1,"persons/person.xml",Bt.PEOPLE)),Rt(s,"[Content_Types].xml",w4(a,e)),Rt(s,"_rels/.rels",su(e.rels)),Rt(s,"xl/_rels/workbook."+r+".rels",su(e.wbrels)),delete e.revssf,delete e.ssf,s}function py(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Ba(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function FG(t,e){return ht.find(t,"EncryptedPackage")?IG(t,e):CC(t,e)}function LG(t,e){var r,n=t,a=e||{};return a.type||(a.type=Mt&&Buffer.isBuffer(t)?"buffer":"base64"),r=YA(n,a),NG(r,a)}function MC(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return E1(t.slice(r),e);default:break e}return gu.to_workbook(t,e)}function MG(t,e){var r="",n=py(t,e);switch(e.type){case"base64":r=Ba(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=Ml(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=_r(r)),e.type="binary",MC(r,e)}function PG(t,e){var r=t;return e.type=="base64"&&(r=Ba(r)),r=f0.utils.decode(1200,r.slice(2),"str"),e.type="binary",MC(r,e)}function jG(t){return t.match(/[^\x00-\x7F]/)?Bi(t):t}function Nx(t,e,r,n){return n?(r.type="string",gu.to_workbook(t,r)):gu.to_workbook(e,r)}function _m(t,e){Fv();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return _m(new Uint8Array(t),(r=Ir(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,a=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),lu={},r.dateNF&&(lu.dateNF=r.dateNF),r.type||(r.type=Mt&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Mt?"buffer":"binary",n=DL(t),typeof Uint8Array<"u"&&!Mt&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=jG(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),u=new Uint8Array(l);if(u.foo="bar",!u.foo)return r=Ir(r),r.type="array",_m(Lv(n),r)}switch((a=py(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return FG(ht.read(n,r),r);break;case 9:if(a[1]<=8)return CC(n,r);break;case 60:return E1(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return H9(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return W4.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?LG(n,r):Nx(t,n,r,s);case 239:return a[3]===60?E1(n,r):Nx(t,n,r,s);case 255:if(a[1]===254)return PG(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return kl.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return kl.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return w1.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return Z4.to_workbook(n,r);break;case 10:case 13:case 32:return MG(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return z9.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?w1.to_workbook(n,r):Nx(t,n,r,s)}function PC(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return H0(e.file,ht.write(t,{type:Mt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return ht.write(t,e)}function UG(t,e){var r=Ir(e||{}),n=RG(t,r);return BG(n,r)}function BG(t,e){var r={},n=Mt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var a=t.FullPaths?ht.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(e.type=="binary"||e.type=="base64")return a;a=new Uint8Array(Wm(a))}return e.password&&typeof encrypt_agile<"u"?PC(encrypt_agile(a,e.password),e):e.type==="file"?H0(e.file,a):e.type=="string"?_r(a):a}function VG(t,e){var r=e||{},n=jH(t,r);return PC(n,r)}function Pi(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return h0(Bi(n));case"binary":return Bi(n);case"string":return t;case"file":return H0(e.file,n,"utf8");case"buffer":return Mt?Ds(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Pi(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function zG(t,e){switch(e.type){case"base64":return h0(t);case"binary":return t;case"string":return t;case"file":return H0(e.file,t,"binary");case"buffer":return Mt?Ds(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Rd(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?h0(r):e.type=="string"?_r(r):r;case"file":return H0(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function jC(t,e){Fv(),Fz(t);var r=Ir(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=jC(t,r);return r.type="array",Wm(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=t.SheetNames.indexOf(r.sheet),!t.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Pi(RH(t,r),r);case"slk":case"sylk":return Pi(q4.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"htm":case"html":return Pi(IC(t.Sheets[t.SheetNames[a]],r),r);case"txt":return zG(UC(t.Sheets[t.SheetNames[a]],r),r);case"csv":return Pi(gy(t.Sheets[t.SheetNames[a]],r),r,"\uFEFF");case"dif":return Pi(W4.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"dbf":return Rd(w1.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"prn":return Pi(gu.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"rtf":return Pi(Z4.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"eth":return Pi(X4.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"fods":return Pi(FC(t,r),r);case"wk1":return Rd(kl.sheet_to_wk1(t.Sheets[t.SheetNames[a]],r),r);case"wk3":return Rd(kl.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Rd(NC(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),VG(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return UG(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function HG(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function GG(t,e,r){var n={};return n.type="file",n.file=e,HG(n),jC(t,n)}function qG(t,e,r,n,a,s,l,u){var f=Jr(r),d=u.defval,m=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),y=!0,_=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(_,"__rowNum__",{value:r,enumerable:!1})}catch{_.__rowNum__=r}else _.__rowNum__=r;if(!l||t[r])for(var E=e.s.c;E<=e.e.c;++E){var b=l?t[r][E]:t[n[E]+f];if(b===void 0||b.t===void 0){if(d===void 0)continue;s[E]!=null&&(_[s[E]]=d);continue}var w=b.v;switch(b.t){case"z":if(w==null)break;continue;case"e":w=w==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+b.t)}if(s[E]!=null){if(w==null)if(b.t=="e"&&w===null)_[s[E]]=null;else if(d!==void 0)_[s[E]]=d;else if(m&&w===null)_[s[E]]=null;else continue;else _[s[E]]=m&&(b.t!=="n"||b.t==="n"&&u.rawNumbers!==!1)?w:Is(b,w,u);w!=null&&(y=!1)}}return{row:_,isempty:y}}function wm(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,s=[],l=0,u="",f={s:{r:0,c:0},e:{r:0,c:0}},d=e||{},m=d.range!=null?d.range:t["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)?n=3:d.header==null&&(n=0),typeof m){case"string":f=er(m);break;case"number":f=er(t["!ref"]),f.s.r=m;break;default:f=m}n>0&&(a=0);var y=Jr(f.s.r),_=[],E=[],b=0,w=0,S=Array.isArray(t),M=f.s.r,j=0,F={};S&&!t[M]&&(t[M]=[]);var G=d.skipHidden&&t["!cols"]||[],W=d.skipHidden&&t["!rows"]||[];for(j=f.s.c;j<=f.e.c;++j)if(!(G[j]||{}).hidden)switch(_[j]=Mr(j),r=S?t[M][j]:t[_[j]+y],n){case 1:s[j]=j-f.s.c;break;case 2:s[j]=_[j];break;case 3:s[j]=d.header[j-f.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),u=l=Is(r,null,d),w=F[l]||0,!w)F[l]=1;else{do u=l+"_"+w++;while(F[u]);F[l]=w,F[u]=1}s[j]=u}for(M=f.s.r+a;M<=f.e.r;++M)if(!(W[M]||{}).hidden){var B=qG(t,f,M,_,n,s,S,d);(B.isempty===!1||(n===1?d.blankrows!==!1:d.blankrows))&&(E[b++]=B.row)}return E.length=b,E}var Nb=/"/g;function WG(t,e,r,n,a,s,l,u){for(var f=!0,d=[],m="",y=Jr(r),_=e.s.c;_<=e.e.c;++_)if(n[_]){var E=u.dense?(t[r]||[])[_]:t[n[_]+y];if(E==null)m="";else if(E.v!=null){f=!1,m=""+(u.rawNumbers&&E.t=="n"?E.v:Is(E,null,u));for(var b=0,w=0;b!==m.length;++b)if((w=m.charCodeAt(b))===a||w===s||w===34||u.forceQuotes){m='"'+m.replace(Nb,'""')+'"';break}m=="ID"&&(m='"ID"')}else E.f!=null&&!E.F?(f=!1,m="="+E.f,m.indexOf(",")>=0&&(m='"'+m.replace(Nb,'""')+'"')):m="";d.push(m)}return u.blankrows===!1&&f?null:d.join(l)}function gy(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var a=er(t["!ref"]),s=n.FS!==void 0?n.FS:",",l=s.charCodeAt(0),u=n.RS!==void 0?n.RS:`
`,f=u.charCodeAt(0),d=new RegExp((s=="|"?"\\|":s)+"+$"),m="",y=[];n.dense=Array.isArray(t);for(var _=n.skipHidden&&t["!cols"]||[],E=n.skipHidden&&t["!rows"]||[],b=a.s.c;b<=a.e.c;++b)(_[b]||{}).hidden||(y[b]=Mr(b));for(var w=0,S=a.s.r;S<=a.e.r;++S)(E[S]||{}).hidden||(m=WG(t,a,S,y,l,f,s,n),m!=null&&(n.strip&&(m=m.replace(d,"")),(m||n.blankrows!==!1)&&r.push((w++?u:"")+m)));return delete n.dense,r.join("")}function UC(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=gy(t,e);return r}function XG(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var a=er(t["!ref"]),s="",l=[],u,f=[],d=Array.isArray(t);for(u=a.s.c;u<=a.e.c;++u)l[u]=Mr(u);for(var m=a.s.r;m<=a.e.r;++m)for(s=Jr(m),u=a.s.c;u<=a.e.c;++u)if(e=l[u]+s,r=d?(t[m]||[])[u]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}f[f.length]=e+"="+n}return f}function BC(t,e,r){var n=r||{},a=+!n.skipHeader,s=t||{},l=0,u=0;if(s&&n.origin!=null)if(typeof n.origin=="number")l=n.origin;else{var f=typeof n.origin=="string"?Pr(n.origin):n.origin;l=f.r,u=f.c}var d,m={s:{c:0,r:0},e:{c:u,r:l+e.length-1+a}};if(s["!ref"]){var y=er(s["!ref"]);m.e.c=Math.max(m.e.c,y.e.c),m.e.r=Math.max(m.e.r,y.e.r),l==-1&&(l=y.e.r+1,m.e.r=l+e.length-1+a)}else l==-1&&(l=0,m.e.r=e.length-1+a);var _=n.header||[],E=0;e.forEach(function(w,S){Wr(w).forEach(function(M){(E=_.indexOf(M))==-1&&(_[E=_.length]=M);var j=w[M],F="z",G="",W=xt({c:u+E,r:l+S+a});d=b0(s,W),j&&typeof j=="object"&&!(j instanceof Date)?s[W]=j:(typeof j=="number"?F="n":typeof j=="boolean"?F="b":typeof j=="string"?F="s":j instanceof Date?(F="d",n.cellDates||(F="n",j=yn(j)),G=n.dateNF||mt[14]):j===null&&n.nullError&&(F="e",j=0),d?(d.t=F,d.v=j,delete d.w,delete d.R,G&&(d.z=G)):s[W]=d={t:F,v:j},G&&(d.z=G))})}),m.e.c=Math.max(m.e.c,u+_.length-1);var b=Jr(l);if(a)for(E=0;E<_.length;++E)s[Mr(E+u)+b]={t:"s",v:_[E]};return s["!ref"]=At(m),s}function $G(t,e){return BC(null,t,e)}function b0(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Pr(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?b0(t,xt(e)):b0(t,xt({r:e,c:r||0}))}function KG(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function xy(){return{SheetNames:[],Sheets:{}}}function vy(t,e,r,n){var a=1;if(!r)for(;a<=65535&&t.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var l=s&&s[1]||r;for(++a;a<=65535&&t.SheetNames.indexOf(r=l+a)!=-1;++a);}if(TC(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function YG(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=KG(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function QG(t,e){return t.z=e,t}function VC(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function JG(t,e,r){return VC(t,"#"+e,r)}function ZG(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function eq(t,e,r,n){for(var a=typeof e!="string"?e:er(e),s=typeof e=="string"?e:At(e),l=a.s.r;l<=a.e.r;++l)for(var u=a.s.c;u<=a.e.c;++u){var f=b0(t,l,u);f.t="n",f.F=s,delete f.v,l==a.s.r&&u==a.s.c&&(f.f=r,n&&(f.D=!0))}return t}var Yc={encode_col:Mr,encode_row:Jr,encode_cell:xt,encode_range:At,decode_col:Xv,decode_row:Wv,split_cell:uM,decode_cell:Pr,decode_range:Ea,format_cell:Is,sheet_add_aoa:m4,sheet_add_json:BC,sheet_add_dom:RC,aoa_to_sheet:ku,json_to_sheet:$G,table_to_sheet:DC,table_to_book:sG,sheet_to_csv:gy,sheet_to_txt:UC,sheet_to_json:wm,sheet_to_html:IC,sheet_to_formulae:XG,sheet_to_row_object_array:wm,sheet_get_cell:b0,book_new:xy,book_append_sheet:vy,book_set_sheet_visibility:YG,cell_set_number_format:QG,cell_set_hyperlink:VC,cell_set_internal_link:JG,cell_add_comment:ZG,sheet_set_array_formula:eq,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Ix=["Unidade","Licena","N-Ano","Descrio","rgo licenciador","FCEI-N do processo","Data emisso","Vencimento","Observao"],tq=({open:t,onClose:e,branches:r,licenseTypes:n,onAddBranch:a,onImport:s})=>{const l=je.useRef(null),[u,f]=je.useState(!1),[d,m]=je.useState(null),y=()=>{const b=Yc.aoa_to_sheet([Ix]),w=Yc.book_new();Yc.book_append_sheet(w,b,"Licenas"),GG(w,"modelo_licencas.xlsx")},_=async b=>{var S,M;const w=(S=b.target.files)==null?void 0:S[0];if(w){f(!0),m(null);try{const j=await w.arrayBuffer(),F=_m(j),G=F.Sheets[F.SheetNames[0]],W=Yc.sheet_to_json(G,{header:1,defval:""});if(!W.length||W[0].length<Ix.length){m("Arquivo invlido ou colunas insuficientes."),f(!1);return}const B=W[0].map(O=>O.trim());if(JSON.stringify(B)!==JSON.stringify(Ix)){m("As colunas do arquivo no correspondem ao modelo."),f(!1);return}const A=W.slice(1).filter(O=>O.some(P=>P)),D={};for(const O of A){const P=(M=O[0])==null?void 0:M.trim();if(!P)continue;let N=r.find(R=>R.name.trim().toLowerCase()===P.toLowerCase());if(!N&&!D[P]){const he=await a({name:P,cnpj:"",address:"",city:"",state:"",contact:"",status:"Ativa"});D[P]=typeof he=="string"?he:""}else N&&(D[P]=N.id)}const k=A.map(O=>{var xe;const P=n.find(ne=>ne.name===O[1]),N=E(O[7]);let R="",he="";if(P&&N){const ne=new Date(N+"T00:00:00");if(ne.setDate(ne.getDate()-(P.renewalProtocolDays||0)),R=isNaN(ne.getTime())?"":ne.toISOString().slice(0,10),R&&P.processStartDays){const le=new Date(R+"T00:00:00");le.setDate(le.getDate()-(P.processStartDays||0)),he=isNaN(le.getTime())?"":le.toISOString().slice(0,10)}}return{unitId:D[(xe=O[0])==null?void 0:xe.trim()]||"",licenseType:O[1],numberYear:O[2],description:O[3],licensingAgency:O[4],processNumber:O[5],issueDate:E(O[6]),originalExpiryDate:N,prorrogaDate:R,processStartDate:he,observation:O[8],active:!0,inactiveObservation:""}});if(k.some(O=>!O.unitId||!O.licenseType)){m("Algumas linhas esto sem Unidade ou Licena."),f(!1);return}await s(k),m("Licenas importadas com sucesso!")}catch(j){m("Erro ao importar: "+j.message)}f(!1)}};function E(b){if(!b)return"";if(typeof b=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(b))return b;if(typeof b=="number"){const w=GA.parse_date_code(b);if(!w)return"";const S=String(w.m).padStart(2,"0"),M=String(w.d).padStart(2,"0");return`${w.y}-${S}-${M}`}return""}return t?x.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-30",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 w-full max-w-md relative",children:[x.jsx("button",{className:"absolute top-2 right-2 text-gray-400 hover:text-gray-700",onClick:e,children:""}),x.jsx("h3",{className:"text-lg font-bold mb-4",children:"Importar Licenas"}),x.jsxs("div",{className:"space-y-4",children:[x.jsx("button",{onClick:y,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Baixar modelo Excel"}),x.jsx("div",{children:x.jsx("input",{type:"file",accept:".xlsx,.xls",ref:l,onChange:_,disabled:u,className:"block w-full text-sm text-gray-700"})}),u&&x.jsx("div",{className:"text-blue-600",children:"Importando..."}),d&&x.jsx("div",{className:"text-sm text-center",style:{color:d.includes("sucesso")?"green":"red"},children:d})]})]})}):null},rq=({license:t,open:e,onClose:r,onUpdate:n,branches:a,licenseTypes:s})=>{const[l,u]=je.useState("details"),[f,d]=je.useState(!1),[m,y]=je.useState(null),[_,E]=je.useState(!1),[b,w]=je.useState(null),[S,M]=je.useState(!1),j=async N=>{if(!(!N.attachments||N.attachments.length===0)){M(!0);try{const R=[];for(const ne of N.attachments)try{if(ne.storagePath){const le=nu(au,ne.storagePath);await $5(le),R.push(ne)}else R.push(ne)}catch{console.log(`Arquivo deletado detectado: ${ne.fileName}`)}const he=R.length>0,xe=N.fileUrl&&R.length<N.attachments.length;if(R.length<N.attachments.length||xe){const ne={...N,attachments:R,...he&&{fileUrl:"",fileName:""}};y(ne),n(ne)}}catch(R){console.error("Erro ao verificar anexos:",R)}finally{M(!1)}}};if(je.useEffect(()=>{t&&e&&(y(t),j(t))},[t,e]),!e||!t)return null;const F=N=>{var R;return((R=a.find(he=>he.id===N))==null?void 0:R.name)||"Desconhecida"},G=N=>{const R=new Date;R.setHours(0,0,0,0);const xe=new Date(N+"T00:00:00").getTime()-R.getTime();return Math.ceil(xe/(1e3*60*60*24))},W=(N=t)=>{if(!N.active)return x.jsx("span",{className:"px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-100 text-gray-800",children:"Desativada"});const R=G(N.originalExpiryDate),he=s.find(ne=>ne.name===N.licenseType),xe=he?(he.renewalProtocolDays||0)+(he.processStartDays||0):180;return R<0?x.jsxs("span",{className:"px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800",children:["Vencida h ",Math.abs(R)," dia(s)"]}):R<=xe?x.jsxs("span",{className:"px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800",children:["Vence em ",R," dia(s)"]}):x.jsx("span",{className:"px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:"Vigente"})},B=(N,R)=>{m&&y({...m,[N]:R})},A=()=>{m&&(n(m),d(!1))},D=async N=>{if(N.target.files&&N.target.files[0]&&m){const R=N.target.files[0];E(!0);try{const he=`licenses/${m.id}/${Date.now()}_${R.name}`,xe=nu(au,he),ne=await Nv(xe,R),le=await Iv(ne.ref),He={id:Date.now().toString(),fileName:R.name,fileUrl:le,uploadedAt:new Date().toISOString(),storagePath:he},ie=m.attachments||[];y({...m,attachments:[...ie,He]})}catch(he){console.error("Erro ao fazer upload do arquivo:",he),alert("Erro ao fazer upload do arquivo.")}finally{E(!1),N.target.value=""}}},k=async N=>{if(!(!m||!window.confirm("Tem certeza que deseja excluir este anexo?"))){w(N.id);try{if(N.storagePath)try{const he=nu(au,N.storagePath);await CA(he)}catch(he){console.warn("Arquivo j foi deletado ou no existe no Storage:",he)}const R=(m.attachments||[]).filter(he=>he.id!==N.id);y({...m,attachments:R})}catch(R){console.error("Erro ao deletar arquivo:",R),alert("Erro ao deletar o arquivo.")}finally{w(null)}}},O=m||t,P=((O==null?void 0:O.attachments)||[]).filter(N=>N!=null);return x.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:x.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col",children:[x.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-start",children:[x.jsxs("div",{children:[x.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:O.licenseType}),x.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:O.numberYear})]}),x.jsxs("div",{className:"flex items-center gap-2",children:[!f&&x.jsx("button",{onClick:()=>d(!0),className:"px-3 py-1 bg-blue-500 text-white rounded text-sm font-medium hover:bg-blue-600 transition-colors",children:" Editar"}),x.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",children:x.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),x.jsxs("div",{className:"px-6 border-b border-gray-200 dark:border-gray-700 flex gap-4",children:[x.jsx("button",{onClick:()=>u("details"),className:`py-3 px-1 border-b-2 font-medium text-sm transition-colors ${l==="details"?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-300"}`,children:"Detalhes"}),x.jsxs("button",{onClick:()=>u("attachments"),className:`py-3 px-1 border-b-2 font-medium text-sm transition-colors ${l==="attachments"?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-300"}`,children:["Anexos ",P.length>0&&`(${P.length})`,S&&x.jsx("span",{className:"ml-1 animate-spin",children:""})]})]}),x.jsx("div",{className:"flex-1 overflow-y-auto px-6 py-4",children:l==="details"?x.jsxs("div",{className:"space-y-6",children:[x.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[x.jsxs("div",{children:[x.jsx("h3",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Status"}),x.jsx("div",{className:"mt-2",children:W(O)})]}),x.jsxs("div",{children:[x.jsx("h3",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Categoria"}),f?x.jsxs("select",{value:O.category||"Ambiental",onChange:N=>B("category",N.target.value),className:"mt-2 p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm",children:[x.jsx("option",{value:"Ambiental",children:"Ambiental"}),x.jsx("option",{value:"SGA",children:"SGA"})]}):x.jsx("p",{className:"mt-2 text-sm font-medium text-gray-900 dark:text-white",children:O.category||"Ambiental"})]})]}),x.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[x.jsxs("div",{children:[x.jsx("h3",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Unidade/Filial"}),f?x.jsxs("select",{value:O.unitId,onChange:N=>B("unitId",N.target.value),className:"mt-2 p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm w-full",children:[x.jsx("option",{value:"",children:"Selecione uma unidade"}),a.map(N=>x.jsx("option",{value:N.id,children:N.name},N.id))]}):x.jsx("p",{className:"mt-2 text-sm font-medium text-gray-900 dark:text-white",children:F(O.unitId)})]}),x.jsxs("div",{children:[x.jsx("h3",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Tipo de Licena"}),f?x.jsxs("select",{value:O.licenseType,onChange:N=>B("licenseType",N.target.value),className:"mt-2 p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm w-full",children:[x.jsx("option",{value:"",children:"Selecione um tipo"}),s.map(N=>x.jsx("option",{value:N.name,children:N.name},N.id))]}):x.jsx("p",{className:"mt-2 text-sm font-medium text-gray-900 dark:text-white",children:O.licenseType})]})]}),x.jsxs("div",{children:[x.jsx("h3",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"N/Ano"}),f?x.jsx("input",{type:"text",value:O.numberYear,onChange:N=>B("numberYear",N.target.value),className:"mt-2 w-full p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm"}):x.jsx("p",{className:"mt-2 text-sm font-medium text-gray-900 dark:text-white",children:O.numberYear})]}),x.jsxs("div",{children:[x.jsx("h3",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Descrio"}),f?x.jsx("textarea",{value:O.description,onChange:N=>B("description",N.target.value),rows:3,className:"mt-2 w-full p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm"}):x.jsx("p",{className:"mt-2 text-sm text-gray-900 dark:text-white",children:O.description||"-"})]}),x.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[x.jsxs("div",{children:[x.jsx("h3",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"rgo Licenciador"}),f?x.jsx("input",{type:"text",value:O.licensingAgency,onChange:N=>B("licensingAgency",N.target.value),className:"mt-2 w-full p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm"}):x.jsx("p",{className:"mt-2 text-sm text-gray-900 dark:text-white",children:O.licensingAgency||"-"})]}),x.jsxs("div",{children:[x.jsx("h3",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Responsvel"}),f?x.jsx("input",{type:"text",value:O.responsible||"",onChange:N=>B("responsible",N.target.value),className:"mt-2 w-full p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm"}):x.jsx("p",{className:"mt-2 text-sm text-gray-900 dark:text-white",children:O.responsible||"-"})]})]}),x.jsxs("div",{children:[x.jsx("h3",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"N do Processo (FCEI)"}),f?x.jsx("input",{type:"text",value:O.processNumber,onChange:N=>B("processNumber",N.target.value),className:"mt-2 w-full p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm"}):x.jsx("p",{className:"mt-2 text-sm text-gray-900 dark:text-white",children:O.processNumber||"-"})]}),x.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[x.jsxs("div",{children:[x.jsx("h3",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Data de Emisso"}),f?x.jsx("input",{type:"date",value:O.issueDate,onChange:N=>B("issueDate",N.target.value),className:"mt-2 w-full p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm"}):x.jsx("p",{className:"mt-2 text-sm text-gray-900 dark:text-white",children:O.issueDate?new Date(O.issueDate+"T00:00:00").toLocaleDateString("pt-BR"):"-"})]}),x.jsxs("div",{children:[x.jsx("h3",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Data de Vencimento"}),f?x.jsx("input",{type:"date",value:O.originalExpiryDate,onChange:N=>B("originalExpiryDate",N.target.value),className:"mt-2 w-full p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm"}):x.jsx("p",{className:"mt-2 text-sm text-gray-900 dark:text-white",children:O.originalExpiryDate?new Date(O.originalExpiryDate+"T00:00:00").toLocaleDateString("pt-BR"):"-"})]})]}),x.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[x.jsxs("div",{children:[x.jsx("h3",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Prazo Prorrogao"}),f?x.jsx("input",{type:"date",value:O.prorrogaDate,onChange:N=>B("prorrogaDate",N.target.value),className:"mt-2 w-full p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm"}):x.jsx("p",{className:"mt-2 text-sm text-gray-900 dark:text-white",children:O.prorrogaDate?new Date(O.prorrogaDate+"T00:00:00").toLocaleDateString("pt-BR"):"-"})]}),x.jsxs("div",{children:[x.jsx("h3",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Incio do Processo"}),f?x.jsx("input",{type:"date",value:O.processStartDate,onChange:N=>B("processStartDate",N.target.value),className:"mt-2 w-full p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm"}):x.jsx("p",{className:"mt-2 text-sm text-gray-900 dark:text-white",children:O.processStartDate?new Date(O.processStartDate+"T00:00:00").toLocaleDateString("pt-BR"):"-"})]})]}),f&&x.jsxs("div",{className:"flex items-center gap-2 p-3 bg-gray-50 dark:bg-gray-700/50 rounded",children:[x.jsx("input",{type:"checkbox",id:"active",checked:O.active,onChange:N=>B("active",N.target.checked),className:"accent-blue-600"}),x.jsx("label",{htmlFor:"active",className:"text-sm font-medium text-gray-900 dark:text-white",children:"Licena Vigente"})]}),x.jsxs("div",{children:[x.jsx("h3",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Observao"}),f?x.jsx("textarea",{value:O.observation,onChange:N=>B("observation",N.target.value),rows:2,className:"mt-2 w-full p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm"}):x.jsx("p",{className:"mt-2 text-sm text-gray-900 dark:text-white",children:O.observation||"-"})]}),!O.active&&x.jsxs("div",{children:[x.jsx("h3",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Motivo da Desativao"}),f?x.jsx("textarea",{value:O.inactiveObservation||"",onChange:N=>B("inactiveObservation",N.target.value),rows:2,className:"mt-2 w-full p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm"}):x.jsx("p",{className:"mt-2 text-sm text-gray-900 dark:text-white",children:O.inactiveObservation||"-"})]})]}):x.jsxs("div",{className:"space-y-4",children:[f&&x.jsx("div",{className:"border-2 border-dashed border-blue-300 dark:border-blue-700 rounded-lg p-6 text-center hover:border-blue-400 dark:hover:border-blue-600 transition-colors",children:x.jsxs("label",{className:"cursor-pointer block",children:[x.jsxs("div",{className:"flex flex-col items-center gap-2",children:[x.jsx("svg",{className:"w-8 h-8 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),x.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:_?"Enviando...":"Clique para adicionar anexo"}),x.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"ou arraste um arquivo aqui"})]}),x.jsx("input",{type:"file",onChange:D,disabled:_,className:"hidden"})]})}),P.length>0?x.jsx("div",{className:"space-y-2",children:P.map(N=>x.jsxs("div",{className:"border border-gray-200 dark:border-gray-600 rounded-lg p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[x.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[x.jsx("div",{className:"text-2xl flex-shrink-0",children:""}),x.jsxs("div",{className:"min-w-0",children:[x.jsx("a",{href:N.fileUrl,download:N.fileName,target:"_blank",rel:"noopener noreferrer",className:"text-sm font-medium text-blue-600 dark:text-blue-400 hover:underline truncate block",children:N.fileName}),x.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:new Date(N.uploadedAt).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})})]})]}),x.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0 ml-4",children:[x.jsx("a",{href:N.fileUrl,download:N.fileName,target:"_blank",rel:"noopener noreferrer",className:"p-2 rounded-lg bg-blue-100 dark:bg-blue-900/50 text-blue-600 dark:text-blue-400 hover:bg-blue-200 dark:hover:bg-blue-900 transition-colors",title:"Baixar",children:x.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})})}),f&&x.jsx("button",{onClick:()=>k(N),disabled:b===N.id,className:"p-2 rounded-lg bg-red-100 dark:bg-red-900/50 text-red-600 dark:text-red-400 hover:bg-red-200 dark:hover:bg-red-900 transition-colors disabled:opacity-50",title:"Excluir",children:x.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},N.id))}):x.jsxs("div",{className:"border border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-8 text-center",children:[x.jsx("div",{className:"text-4xl mb-2",children:""}),x.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Nenhum arquivo anexado a esta licena"})]})]})}),x.jsx("div",{className:"px-6 py-4 border-t border-gray-200 dark:border-gray-700 flex justify-end gap-2",children:f?x.jsxs(x.Fragment,{children:[x.jsx("button",{onClick:()=>{d(!1),y(t)},className:"px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-900 dark:text-white rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors font-medium",children:"Cancelar"}),x.jsx("button",{onClick:A,className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors font-medium",children:"Salvar Alteraes"})]}):x.jsx("button",{onClick:r,className:"px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-900 dark:text-white rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors font-medium",children:"Fechar"})})]})})},Rx={unitId:"",licenseType:"",numberYear:"",description:"",licensingAgency:"",processNumber:"",issueDate:"",originalExpiryDate:"",prorrogaDate:"",processStartDate:"",observation:"",active:!0,inactiveObservation:"",category:"Ambiental",responsible:"",fileUrl:"",fileName:""},zC=[{label:"Unidade",key:"unitId",visible:!0},{label:"Licena",key:"licenseType",visible:!0},{label:"N/Ano",key:"numberYear",visible:!0},{label:"Descrio",key:"description",visible:!0},{label:"rgo Licenciador",key:"licensingAgency",visible:!0},{label:"FCEI-N do Processo",key:"processNumber",visible:!0},{label:"Responsvel",key:"responsible",visible:!0},{label:"Arquivo",key:"fileUrl",visible:!0},{label:"Data Emisso",key:"issueDate",visible:!0},{label:"Data Vencimento",key:"originalExpiryDate",visible:!0},{label:"Prazo Prorrogao",key:"prorrogaDate",visible:!0},{label:"Incio Processo",key:"processStartDate",visible:!0},{label:"Alerta",key:"alert",visible:!0},{label:"Observao",key:"observation",visible:!0},{label:"Aes",key:"actions",visible:!0}];function nq(){const t=localStorage.getItem("licenseTableColumns");return t?JSON.parse(t):zC}const Ib=({licenses:t,branches:e,licenseTypes:r,onAddLicense:n,onUpdateLicense:a,onDeleteLicense:s,onAddBranch:l,category:u="Ambiental"})=>{const[f,d]=je.useState(Rx),[m,y]=je.useState(!1),[_,E]=je.useState(null),[b,w]=je.useState(!1),[S,M]=je.useState({branchId:"",licenseType:"",onlyAlert:!1}),[j,F]=je.useState({key:"originalExpiryDate",direction:"asc"}),[G,W]=je.useState(!1),[B,A]=je.useState(!1),[D,k]=je.useState(nq()),[O,P]=je.useState(()=>{const oe=localStorage.getItem("licenseTableColWidths");return oe?JSON.parse(oe):{}}),[N,R]=je.useState(!1),[he,xe]=je.useState(null),[ne,le]=je.useState(!1);je.useEffect(()=>{localStorage.setItem("licenseTableColumns",JSON.stringify(D))},[D]),je.useEffect(()=>{localStorage.setItem("licenseTableColWidths",JSON.stringify(O))},[O]);function He(oe){k(ze=>ze.map((Ve,Je)=>Je===oe?{...Ve,visible:!Ve.visible}:Ve))}function ie(oe,ze){k(Ve=>{const Je=[...Ve],[ft]=Je.splice(oe,1);return Je.splice(ze,0,ft),Je})}function J(){k(zC)}const ge=()=>{E(null),d({...Rx,category:u}),y(!0)},V=()=>{y(!1),E(null),d(Rx)},X=oe=>{const{name:ze,value:Ve}=oe.target;d(Je=>{let ft={...Je,[ze]:Ve};if(ze==="originalExpiryDate"||ze==="licenseType"){const Ae=r.find(Xe=>Xe.name===(ze==="licenseType"?Ve:Je.licenseType)),Me=ze==="originalExpiryDate"?Ve:Je.originalExpiryDate;if(Ae&&Me){const Xe=new Date(Me+"T00:00:00");if(Xe.setDate(Xe.getDate()-(Ae.renewalProtocolDays||0)),ft.prorrogaDate=isNaN(Xe.getTime())?"":Xe.toISOString().slice(0,10),ft.prorrogaDate&&Ae.processStartDays){const ct=new Date(ft.prorrogaDate+"T00:00:00");ct.setDate(ct.getDate()-(Ae.processStartDays||0)),ft.processStartDate=isNaN(ct.getTime())?"":ct.toISOString().slice(0,10)}else ft.processStartDate=""}else ft.prorrogaDate="",ft.processStartDate=""}return ft})},Z=oe=>{if(oe.preventDefault(),!f.unitId||!f.licenseType){alert("Por favor, selecione uma unidade e um tipo de licena.");return}_?a({...f,id:_.id}):n(f),V()},te=oe=>{var ze;return((ze=e.find(Ve=>Ve.id===oe))==null?void 0:ze.name)||"Desconhecida"},fe=oe=>{const ze=new Date;ze.setHours(0,0,0,0);const Je=new Date(oe+"T00:00:00").getTime()-ze.getTime();return Math.ceil(Je/(1e3*60*60*24))},Se=oe=>{F(ze=>ze.key===oe?{key:oe,direction:ze.direction==="asc"?"desc":"asc"}:{key:oe,direction:"asc"})};function ke(oe,ze){if(["issueDate","originalExpiryDate","prorrogaDate","processStartDate"].includes(ze))return oe[ze]?new Date(oe[ze]):new Date(0);if(ze==="alert"){const Ve=fe(oe.originalExpiryDate),Je=r.find(Ae=>Ae.name===oe.licenseType),ft=Je?(Je.renewalProtocolDays||0)+(Je.processStartDays||0):180;return Ve<0?0:Ve<=ft?1:2}return(oe[ze]||"").toString().toLowerCase()}function Ne(oe,ze){P(Ve=>({...Ve,[oe]:Math.max(80,ze)}))}const Oe=[...e].sort((oe,ze)=>oe.name.localeCompare(ze.name)),ot=[...r].sort((oe,ze)=>oe.name.localeCompare(ze.name)),_t=[...t.filter(oe=>oe.active).filter(oe=>(!S.branchId||oe.unitId===S.branchId)&&(!S.licenseType||oe.licenseType===S.licenseType)&&(!S.onlyAlert||ke(oe,"alert")!==2)&&(u==="Ambiental"?!oe.category||oe.category==="Ambiental":oe.category===u))].sort((oe,ze)=>{const Ve=ke(oe,j.key),Je=ke(ze,j.key);return Ve<Je?j.direction==="asc"?-1:1:Ve>Je?j.direction==="asc"?1:-1:0}),Dt=(oe,ze)=>{const Ve=fe(oe),Je=r.find(Ae=>Ae.name===ze),ft=Je?(Je.renewalProtocolDays||0)+(Je.processStartDays||0):180;return Ve<0?x.jsxs("span",{className:"px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800",children:["Vencida h ",Math.abs(Ve)," dia(s)"]}):Ve<=ft?x.jsxs("span",{className:"px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800",children:["Vence em ",Ve," dia(s)"]}):x.jsx("span",{className:"px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:"Ativa"})},[nt,Ge]=je.useState(null),[tr,Jt]=je.useState(!1);function Ct(oe,ze){if(tr){oe.preventDefault();return}Ge(ze),oe.dataTransfer.effectAllowed="move"}function wr(oe,ze){oe.preventDefault(),oe.dataTransfer.dropEffect="move"}function _n(oe,ze){if(oe.preventDefault(),nt===null||nt===ze)return;const Ve=D.filter(Xe=>Xe.visible),Je=Ve[nt],ft=Ve[ze],Ae=D.findIndex(Xe=>Xe.key===Je.key),Me=D.findIndex(Xe=>Xe.key===ft.key);ie(Ae,Me),Ge(null)}const Dr=async oe=>{if(oe.target.files&&oe.target.files[0]){const ze=oe.target.files[0];R(!0);try{const Ve=nu(au,`licenses/${Date.now()}_${ze.name}`),Je=await Nv(Ve,ze),ft=await Iv(Je.ref);d(Ae=>({...Ae,fileUrl:ft,fileName:ze.name}))}catch(Ve){console.error("Error uploading file: ",Ve),alert("Erro ao fazer upload do arquivo.")}finally{R(!1)}}},mr=oe=>{xe(oe),le(!0)},en=()=>{le(!1),xe(null)},jt=async oe=>{await a(oe)};return zb.useEffect(()=>{if(he&&ne){const oe=t.find(ze=>ze.id===he.id);oe&&xe(oe)}},[t,ne]),x.jsxs("div",{className:"space-y-6",children:[x.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg",children:[x.jsxs("div",{className:"flex justify-between items-center mb-4",children:[x.jsxs("h2",{className:"text-2xl font-bold text-gray-700 dark:text-white flex items-center gap-2",children:[_?"Editar Licena":"Cadastro de Licenas",x.jsx("button",{type:"button",onClick:()=>w(oe=>!oe),className:"ml-2 p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition",children:x.jsx(IA,{})}),x.jsx("button",{type:"button",onClick:()=>A(!0),className:"ml-2 p-2 rounded hover:bg-gray-100 transition",title:"Configurar colunas",children:x.jsx(Z5,{})})]}),x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx("button",{type:"button",onClick:()=>W(!0),className:"p-2 rounded hover:bg-gray-100 transition",title:"Importar planilha",children:x.jsx(RA,{})}),x.jsx("button",{onClick:m?V:ge,className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white font-semibold rounded-lg hover:bg-blue-600 transition-transform transform hover:scale-105",children:m?"Fechar Formulrio":x.jsxs(x.Fragment,{children:[x.jsx(El,{})," Nova Licena"]})})]})]}),b&&x.jsxs("div",{className:"mb-4 bg-gray-50 dark:bg-gray-700/60 border border-gray-200 dark:border-gray-600 rounded-lg p-4 flex flex-col md:flex-row gap-4 items-center",children:[x.jsxs("div",{className:"flex flex-col",children:[x.jsx("label",{className:"text-xs font-semibold text-gray-600 dark:text-gray-200 mb-1",children:"Filtrar por Filial"}),x.jsxs("select",{value:S.branchId,onChange:oe=>M(ze=>({...ze,branchId:oe.target.value})),className:"p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-100",children:[x.jsx("option",{value:"",children:"Todas"}),Oe.map(oe=>x.jsx("option",{value:oe.id,children:oe.name},oe.id))]})]}),x.jsxs("div",{className:"flex flex-col",children:[x.jsx("label",{className:"text-xs font-semibold text-gray-600 dark:text-gray-200 mb-1",children:"Filtrar por Tipo de Licena"}),x.jsxs("select",{value:S.licenseType,onChange:oe=>M(ze=>({...ze,licenseType:oe.target.value})),className:"p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-100",children:[x.jsx("option",{value:"",children:"Todas"}),ot.map(oe=>x.jsx("option",{value:oe.name,children:oe.name},oe.id))]})]}),x.jsxs("div",{className:"flex flex-col",children:[x.jsx("label",{className:"text-xs font-semibold text-gray-600 dark:text-gray-200 mb-1",children:""}),x.jsxs("label",{className:"inline-flex items-center text-sm text-gray-700 dark:text-gray-200",children:[x.jsx("input",{type:"checkbox",checked:S.onlyAlert,onChange:oe=>M(ze=>({...ze,onlyAlert:oe.target.checked})),className:"mr-2 accent-blue-600"}),"Mostrar apenas licenas em alerta"]})]}),x.jsx("button",{onClick:()=>M({branchId:"",licenseType:"",onlyAlert:!1}),className:"mt-4 md:mt-6 px-4 py-2 bg-gray-300 dark:bg-gray-600 text-gray-700 dark:text-gray-100 rounded hover:bg-gray-400 dark:hover:bg-gray-500 transition",children:"Limpar Filtros"})]}),m&&x.jsxs("form",{onSubmit:Z,className:"grid grid-cols-1 md:grid-cols-2 gap-6 animate-fade-in",children:[x.jsxs("div",{className:"flex flex-col",children:[x.jsx("label",{htmlFor:"unitId",className:"mb-1 font-semibold text-gray-600",children:"Unidade"}),x.jsxs("select",{name:"unitId",id:"unitId",value:f.unitId,onChange:X,required:!0,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition",children:[x.jsx("option",{value:"",disabled:!0,children:"Selecione uma Filial"}),Oe.map(oe=>x.jsx("option",{value:oe.id,children:oe.name},oe.id))]})]}),x.jsxs("div",{className:"flex flex-col",children:[x.jsx("label",{htmlFor:"licenseType",className:"mb-1 font-semibold text-gray-600",children:"Licena"}),x.jsxs("select",{name:"licenseType",id:"licenseType",value:f.licenseType,onChange:X,required:!0,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition",children:[x.jsx("option",{value:"",disabled:!0,children:"Selecione o tipo"}),ot.map(oe=>x.jsx("option",{value:oe.name,children:oe.name},oe.id))]})]}),x.jsxs("div",{className:"flex flex-col",children:[x.jsx("label",{htmlFor:"numberYear",className:"mb-1 font-semibold text-gray-600",children:"N/Ano"}),x.jsx("input",{type:"text",name:"numberYear",id:"numberYear",value:f.numberYear,onChange:X,required:!0,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition"})]}),x.jsxs("div",{className:"flex flex-col",children:[x.jsx("label",{htmlFor:"description",className:"mb-1 font-semibold text-gray-600",children:"Descrio"}),x.jsx("textarea",{name:"description",id:"description",value:f.description,onChange:X,rows:2,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition"})]}),x.jsxs("div",{className:"flex flex-col",children:[x.jsx("label",{htmlFor:"licensingAgency",className:"mb-1 font-semibold text-gray-600",children:"rgo Licenciador"}),x.jsx("input",{type:"text",name:"licensingAgency",id:"licensingAgency",value:f.licensingAgency,onChange:X,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition"})]}),x.jsxs("div",{className:"flex flex-col",children:[x.jsx("label",{htmlFor:"processNumber",className:"mb-1 font-semibold text-gray-600",children:"FCEI-N do Processo"}),x.jsx("input",{type:"text",name:"processNumber",id:"processNumber",value:f.processNumber,onChange:X,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition"})]}),x.jsxs("div",{className:"flex flex-col",children:[x.jsx("label",{htmlFor:"responsible",className:"mb-1 font-semibold text-gray-600",children:"Responsvel"}),x.jsx("input",{type:"text",name:"responsible",id:"responsible",value:f.responsible||"",onChange:X,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition"})]}),x.jsxs("div",{className:"flex flex-col",children:[x.jsx("label",{htmlFor:"file",className:"mb-1 font-semibold text-gray-600",children:"Anexar Arquivo"}),x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx("input",{type:"file",id:"file",onChange:Dr,className:"p-2 border border-gray-300 rounded-lg w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100",disabled:N}),N&&x.jsx("span",{className:"text-sm text-blue-500",children:"Enviando..."})]}),f.fileName&&x.jsxs("span",{className:"text-xs text-green-600 mt-1",children:["Arquivo atual: ",f.fileName]})]}),x.jsxs("div",{className:"flex flex-col",children:[x.jsx("label",{htmlFor:"issueDate",className:"mb-1 font-semibold text-gray-600",children:"Data Emisso"}),x.jsx("input",{type:"date",name:"issueDate",id:"issueDate",value:f.issueDate,onChange:X,required:!0,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition"})]}),x.jsxs("div",{className:"flex flex-col",children:[x.jsx("label",{htmlFor:"originalExpiryDate",className:"mb-1 font-semibold text-gray-600",children:"Data Vencimento"}),x.jsx("input",{type:"date",name:"originalExpiryDate",id:"originalExpiryDate",value:f.originalExpiryDate,onChange:X,required:!0,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition"})]}),x.jsxs("div",{className:"flex flex-col",children:[x.jsx("label",{htmlFor:"prorrogaDate",className:"mb-1 font-semibold text-gray-600",children:"Prazo para Prorrogao"}),x.jsx("input",{type:"date",name:"prorrogaDate",id:"prorrogaDate",value:f.prorrogaDate,onChange:X,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition"})]}),x.jsxs("div",{className:"flex flex-col",children:[x.jsx("label",{htmlFor:"processStartDate",className:"mb-1 font-semibold text-gray-600",children:"Incio do Processo"}),x.jsx("input",{type:"date",name:"processStartDate",id:"processStartDate",value:f.processStartDate,onChange:X,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition"})]}),x.jsxs("div",{className:"flex items-center md:col-span-2",children:[x.jsx("input",{type:"checkbox",id:"active",name:"active",checked:f.active,onChange:oe=>d(ze=>({...ze,active:oe.target.checked,inactiveObservation:oe.target.checked?"":ze.inactiveObservation})),className:"mr-2"}),x.jsx("label",{htmlFor:"active",className:"font-semibold text-gray-600",children:"Licena Vigente"})]}),!f.active&&x.jsxs("div",{className:"md:col-span-2 flex flex-col",children:[x.jsx("label",{htmlFor:"inactiveObservation",className:"mb-1 font-semibold text-gray-600",children:"Observao da Desativao"}),x.jsx("textarea",{name:"inactiveObservation",id:"inactiveObservation",value:f.inactiveObservation,onChange:X,rows:2,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition",required:!f.active})]}),x.jsxs("div",{className:"md:col-span-2 flex flex-col",children:[x.jsx("label",{htmlFor:"observation",className:"mb-1 font-semibold text-gray-600",children:"Observao"}),x.jsx("textarea",{name:"observation",id:"observation",value:f.observation,onChange:X,rows:2,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition"})]}),x.jsxs("div",{className:"md:col-span-2 flex justify-end gap-4",children:[x.jsx("button",{type:"button",onClick:V,className:"px-6 py-3 bg-gray-500 text-white font-bold rounded-lg hover:bg-gray-600 transition-colors",children:"Cancelar"}),x.jsx("button",{type:"submit",className:"px-6 py-3 bg-green-500 text-white font-bold rounded-lg hover:bg-green-600 transition-colors",children:_?"Salvar Alteraes":"Salvar Licena"})]})]})]}),x.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg",children:[x.jsx("h2",{className:"text-2xl font-bold text-gray-700 dark:text-white mb-4",children:"Licenas Registradas"}),x.jsx("div",{className:"overflow-x-auto table-scrollbar",style:{transform:"rotateX(180deg)"},children:x.jsxs("table",{className:"min-w-full bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700 table-fixed",style:{transform:"rotateX(180deg)"},children:[x.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:x.jsx("tr",{children:D.filter(oe=>oe.visible).map((oe,ze)=>x.jsxs("th",{draggable:oe.key!=="actions"&&!tr,onDragStart:Ve=>Ct(Ve,ze),onDragOver:Ve=>wr(Ve),onDrop:Ve=>_n(Ve,ze),className:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider select-none relative group border-r border-transparent hover:border-gray-300 transition-colors ${nt===ze?"opacity-50 bg-gray-100":""}`,style:{width:O[oe.key]?O[oe.key]+"px":void 0,minWidth:80,cursor:oe.key!=="actions"?"grab":"default"},onClick:oe.key&&oe.key!=="alert"&&oe.key!=="actions"?()=>Se(oe.key):void 0,children:[x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsx("span",{className:"truncate",title:oe.label,children:oe.label}),oe.key&&j.key===oe.key&&x.jsx("span",{className:"ml-1 flex-shrink-0",children:j.direction==="asc"?"":""})]}),oe.key!=="actions"&&oe.key!=="alert"&&x.jsx("div",{className:"absolute right-0 top-0 h-full w-4 cursor-col-resize hover:bg-blue-400/20 z-10 flex justify-end",onMouseDown:Ve=>{Ve.stopPropagation(),Ve.preventDefault(),Jt(!0);const Je=Ve.clientX,ft=Ve.currentTarget.parentElement;if(!ft)return;const Ae=ft.offsetWidth;function Me(ct){Ne(String(oe.key),Ae+(ct.clientX-Je))}function Xe(){Jt(!1),window.removeEventListener("mousemove",Me),window.removeEventListener("mouseup",Xe)}window.addEventListener("mousemove",Me),window.addEventListener("mouseup",Xe)},title:"Arraste para redimensionar",children:x.jsx("div",{className:"w-1 h-full bg-transparent hover:bg-blue-400 transition-colors"})})]},oe.key))})}),x.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:_t.map((oe,ze)=>x.jsx("tr",{onClick:()=>mr(oe),className:"bg-white dark:bg-gray-800 transition-all duration-200 ease-out hover:bg-gray-50 hover:shadow-md hover:-translate-y-0.5 dark:hover:bg-gray-700 cursor-pointer",children:D.filter(Ve=>Ve.visible).map((Ve,Je)=>{switch(Ve.key){case"unitId":return x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white overflow-hidden text-ellipsis",children:te(oe.unitId)},Ve.key);case"licenseType":return x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300 overflow-hidden text-ellipsis",children:oe.licenseType},Ve.key);case"numberYear":return x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300 overflow-hidden text-ellipsis",children:oe.numberYear},Ve.key);case"description":return x.jsx("td",{className:"px-6 py-4 whitespace-normal text-sm text-gray-600 dark:text-gray-300 overflow-hidden text-ellipsis",children:oe.description},Ve.key);case"licensingAgency":return x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300 overflow-hidden text-ellipsis",children:oe.licensingAgency},Ve.key);case"processNumber":return x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300 overflow-hidden text-ellipsis",children:oe.processNumber},Ve.key);case"responsible":return x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300 overflow-hidden text-ellipsis",children:oe.responsible||"-"},Ve.key);case"fileUrl":const ft=(oe.attachments||[]).filter(Me=>Me&&Me.fileUrl),Ae=ft.length>0?ft[0]:null;return x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300 overflow-hidden text-ellipsis",children:Ae?x.jsxs("a",{href:Ae.fileUrl,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline flex items-center gap-1",children:[" ",x.jsx("span",{className:"truncate max-w-[100px]",children:Ae.fileName})]}):oe.fileUrl?x.jsxs("a",{href:oe.fileUrl,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline flex items-center gap-1",children:[" ",x.jsx("span",{className:"truncate max-w-[100px]",children:oe.fileName||"Arquivo"})]}):"-"},Ve.key);case"issueDate":return x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300 overflow-hidden text-ellipsis",children:oe.issueDate?new Date(oe.issueDate+"T00:00:00").toLocaleDateString("pt-BR"):""},Ve.key);case"originalExpiryDate":return x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300 overflow-hidden text-ellipsis",children:oe.originalExpiryDate?new Date(oe.originalExpiryDate+"T00:00:00").toLocaleDateString("pt-BR"):""},Ve.key);case"prorrogaDate":return x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300 overflow-hidden text-ellipsis",children:oe.prorrogaDate?new Date(oe.prorrogaDate+"T00:00:00").toLocaleDateString("pt-BR"):""},Ve.key);case"processStartDate":return x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300 overflow-hidden text-ellipsis",children:oe.processStartDate?new Date(oe.processStartDate+"T00:00:00").toLocaleDateString("pt-BR"):""},Ve.key);case"alert":return x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:Dt(oe.originalExpiryDate,oe.licenseType)},Ve.key);case"observation":return x.jsx("td",{className:"px-6 py-4 whitespace-normal text-sm text-gray-600 dark:text-gray-300 overflow-hidden text-ellipsis",children:oe.active?oe.observation:oe.inactiveObservation},Ve.key);case"actions":return x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx("button",{onClick:()=>mr(oe),className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300 transition-colors",children:x.jsx(To,{})}),x.jsx("button",{onClick:()=>s(oe.id),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300 transition-colors",children:x.jsx(Tl,{})})]})},Ve.key);default:return null}})},oe.id))})]})})]}),x.jsx(tq,{open:G,onClose:()=>W(!1),branches:e,licenseTypes:r,onAddBranch:l,onImport:async oe=>{for(const ze of oe)await n(ze);W(!1)}}),x.jsx(rq,{license:he,open:ne,onClose:en,onUpdate:jt,branches:e,licenseTypes:r}),B&&x.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-30",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 w-full max-w-md relative",children:[x.jsx("button",{className:"absolute top-2 right-2 text-gray-400 hover:text-gray-700",onClick:()=>A(!1),children:""}),x.jsx("h3",{className:"text-lg font-bold mb-4",children:"Configurar Colunas"}),x.jsx("div",{className:"space-y-2",children:D.map((oe,ze)=>x.jsxs("div",{className:"flex items-center gap-2 cursor-move",draggable:!0,onDragStart:Ve=>Ve.dataTransfer.setData("colIdx",String(ze)),onDrop:Ve=>{Ve.preventDefault(),ie(Number(Ve.dataTransfer.getData("colIdx")),ze)},onDragOver:Ve=>Ve.preventDefault(),children:[x.jsx("input",{type:"checkbox",checked:oe.visible,onChange:()=>He(ze),id:`col-${oe.key}`}),x.jsx("label",{htmlFor:`col-${oe.key}`,children:oe.label}),x.jsx("span",{className:"ml-auto text-gray-400",children:""})]},oe.key))}),x.jsx("button",{onClick:J,className:"mt-4 px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400 transition",children:"Restaurar padro"})]})})]})},Dx={name:"",renewalProtocolDays:0,processStartDays:0},aq=({licenseTypes:t,onAddLicenseType:e,onUpdateLicenseType:r,onDeleteLicenseType:n})=>{const[a,s]=je.useState(Dx),[l,u]=je.useState(!1),[f,d]=je.useState(null),[m,y]=je.useState({key:"name",direction:"asc"}),_=()=>{d(null),s(Dx),u(!0)},E=G=>{d(G);const{id:W,...B}=G;s(B),u(!0)},b=()=>{u(!1),d(null),s(Dx)},w=G=>{const{name:W,value:B}=G.target;s(A=>({...A,[W]:G.target.type==="number"?parseInt(B,10)||0:B}))},S=G=>{G.preventDefault(),f?r({...a,id:f.id}):e(a),b()},M=G=>{y(W=>W.key===G?{key:G,direction:W.direction==="asc"?"desc":"asc"}:{key:G,direction:"asc"})};function j(G,W){return(G[W]||"").toString().toLowerCase()}const F=[...t].sort((G,W)=>{const B=j(G,m.key),A=j(W,m.key);return B<A?m.direction==="asc"?-1:1:B>A?m.direction==="asc"?1:-1:0});return x.jsxs("div",{className:"space-y-6",children:[x.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg dark:bg-gray-900 dark:border dark:border-gray-700",children:[x.jsxs("div",{className:"flex justify-between items-center mb-4",children:[x.jsx("h2",{className:"text-2xl font-bold text-gray-700 dark:text-gray-200",children:f?"Editar Tipo de Licena":"Cadastro de Tipos de Licena"}),x.jsx("button",{onClick:l?b:_,className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white font-semibold rounded-lg hover:bg-blue-600 transition-transform transform hover:scale-105",children:l?"Fechar Formulrio":x.jsxs(x.Fragment,{children:[x.jsx(El,{})," Novo Tipo de Licena"]})})]}),l&&x.jsxs("form",{onSubmit:S,className:"grid grid-cols-1 md:grid-cols-3 gap-6 animate-fade-in",children:[x.jsxs("div",{className:"flex flex-col",children:[x.jsx("label",{htmlFor:"name",className:"mb-1 font-semibold text-gray-600 dark:text-gray-300",children:"Tipo de Licena"}),x.jsx("input",{type:"text",id:"name",name:"name",value:a.name,onChange:w,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition",required:!0})]}),x.jsxs("div",{className:"flex flex-col",children:[x.jsx("label",{htmlFor:"renewalProtocolDays",className:"mb-1 font-semibold text-gray-600 dark:text-gray-300",children:"Prazo para Protocolo (dias)"}),x.jsx("input",{type:"number",id:"renewalProtocolDays",name:"renewalProtocolDays",value:a.renewalProtocolDays,onChange:w,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition",required:!0})]}),x.jsxs("div",{className:"flex flex-col",children:[x.jsx("label",{htmlFor:"processStartDays",className:"mb-1 font-semibold text-gray-600 dark:text-gray-300",children:"Prazo para Incio (dias)"}),x.jsx("input",{type:"number",id:"processStartDays",name:"processStartDays",value:a.processStartDays,onChange:w,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition",required:!0})]}),x.jsxs("div",{className:"md:col-span-3 flex justify-end gap-4",children:[x.jsx("button",{type:"button",onClick:b,className:"px-6 py-3 bg-gray-500 text-white font-bold rounded-lg hover:bg-gray-600 transition-colors",children:"Cancelar"}),x.jsx("button",{type:"submit",className:"px-6 py-3 bg-green-500 text-white font-bold rounded-lg hover:bg-green-600 transition-colors",children:f?"Salvar Alteraes":"Salvar Tipo"})]})]})]}),x.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg dark:bg-gray-900 dark:border dark:border-gray-700",children:[x.jsx("h2",{className:"text-2xl font-bold text-gray-700 dark:text-gray-200 mb-4",children:"Tipos de Licena Registrados"}),x.jsx("div",{className:"overflow-x-auto",children:x.jsxs("table",{className:"min-w-full bg-white divide-y divide-gray-200 dark:bg-gray-900 dark:divide-gray-700",children:[x.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:x.jsx("tr",{children:[{label:"Tipo de Licena",key:"name"},{label:"Prazo Protocolo (dias)",key:"renewalProtocolDays"},{label:"Prazo Incio (dias)",key:"processStartDays"},{label:"Aes",key:""}].map(G=>x.jsxs("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer select-none",onClick:G.key?()=>M(G.key):void 0,children:[G.label,G.key&&m.key===G.key&&x.jsx("span",{className:"ml-1",children:m.direction==="asc"?"":""})]},G.label))})}),x.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:F.map(G=>x.jsxs("tr",{className:"bg-white dark:bg-gray-900 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-100",children:G.name}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:G.renewalProtocolDays}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:G.processStartDays}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx("button",{onClick:()=>E(G),className:"text-blue-600 hover:text-blue-900 transition-colors",children:x.jsx(To,{})}),x.jsx("button",{onClick:()=>n(G.id),className:"text-red-600 hover:text-red-900 transition-colors",children:x.jsx(Tl,{})})]})})]},G.id))})]})})]})]})},Ox={name:"",cnpj:"",address:"",city:"",state:"",contact:"",status:"Ativa"},iq=({branches:t,onAddBranch:e,onUpdateBranch:r,onDeleteBranch:n})=>{const[a,s]=je.useState(Ox),[l,u]=je.useState(!1),[f,d]=je.useState(null),[m,y]=je.useState({key:"name",direction:"asc"}),_=()=>{d(null),s(Ox),u(!0)},E=W=>{d(W);const{id:B,...A}=W;s(A),u(!0)},b=()=>{u(!1),d(null),s(Ox)},w=W=>{const{name:B,value:A}=W.target;s(D=>({...D,[B]:A}))},S=W=>{if(W.preventDefault(),!a.name){alert("Por favor, preencha o nome da filial.");return}f?r({...a,id:f.id}):e(a),b()},M=W=>{y(B=>B.key===W?{key:W,direction:B.direction==="asc"?"desc":"asc"}:{key:W,direction:"asc"})};function j(W,B){return(W[B]||"").toString().toLowerCase()}const F=[...t].sort((W,B)=>{const A=j(W,m.key),D=j(B,m.key);return A<D?m.direction==="asc"?-1:1:A>D?m.direction==="asc"?1:-1:0}),G=W=>{switch(W){case"Ativa":return"bg-green-100 text-green-800";case"Vencida":return"bg-red-100 text-red-800";case"Em Renovao":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}};return x.jsxs("div",{className:"space-y-6",children:[x.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg dark:bg-gray-900 dark:border dark:border-gray-700",children:[x.jsxs("div",{className:"flex justify-between items-center mb-4",children:[x.jsx("h2",{className:"text-2xl font-bold text-gray-700 dark:text-gray-200",children:f?"Editar Filial":"Cadastro de Filiais"}),x.jsx("button",{onClick:l?b:_,className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white font-semibold rounded-lg hover:bg-blue-600 transition-transform transform hover:scale-105",children:l?"Fechar Formulrio":x.jsxs(x.Fragment,{children:[x.jsx(El,{})," Nova Filial"]})})]}),l&&x.jsxs("form",{onSubmit:S,className:"grid grid-cols-1 md:grid-cols-2 gap-6 animate-fade-in",children:[x.jsxs("div",{className:"flex flex-col",children:[x.jsx("label",{htmlFor:"name",className:"mb-1 font-semibold text-gray-600 dark:text-gray-300",children:"Nome da Filial"}),x.jsx("input",{type:"text",id:"name",name:"name",value:a.name,onChange:w,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition",required:!0})]}),x.jsxs("div",{className:"flex flex-col",children:[x.jsx("label",{htmlFor:"cnpj",className:"mb-1 font-semibold text-gray-600 dark:text-gray-300",children:"CNPJ"}),x.jsx("input",{type:"text",id:"cnpj",name:"cnpj",value:a.cnpj,onChange:w,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition"})]}),x.jsxs("div",{className:"flex flex-col",children:[x.jsx("label",{htmlFor:"address",className:"mb-1 font-semibold text-gray-600 dark:text-gray-300",children:"Endereo"}),x.jsx("input",{type:"text",id:"address",name:"address",value:a.address,onChange:w,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition"})]}),x.jsxs("div",{className:"flex flex-col",children:[x.jsx("label",{htmlFor:"city",className:"mb-1 font-semibold text-gray-600 dark:text-gray-300",children:"Cidade"}),x.jsx("input",{type:"text",id:"city",name:"city",value:a.city,onChange:w,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition"})]}),x.jsxs("div",{className:"flex flex-col",children:[x.jsx("label",{htmlFor:"state",className:"mb-1 font-semibold text-gray-600 dark:text-gray-300",children:"Estado"}),x.jsx("input",{type:"text",id:"state",name:"state",value:a.state,onChange:w,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition"})]}),x.jsxs("div",{className:"flex flex-col",children:[x.jsx("label",{htmlFor:"contact",className:"mb-1 font-semibold text-gray-600 dark:text-gray-300",children:"Contato"}),x.jsx("input",{type:"text",id:"contact",name:"contact",value:a.contact,onChange:w,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition"})]}),x.jsxs("div",{className:"flex flex-col",children:[x.jsx("label",{htmlFor:"status",className:"mb-1 font-semibold text-gray-600 dark:text-gray-300",children:"Situao"}),x.jsxs("select",{name:"status",id:"status",value:a.status,onChange:w,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition",children:[x.jsx("option",{value:"Ativa",children:"Ativa"}),x.jsx("option",{value:"Vencida",children:"Vencida"}),x.jsx("option",{value:"Em Renovao",children:"Em Renovao"})]})]}),x.jsxs("div",{className:"md:col-span-2 flex justify-end gap-4",children:[x.jsx("button",{type:"button",onClick:b,className:"px-6 py-3 bg-gray-500 text-white font-bold rounded-lg hover:bg-gray-600 transition-colors",children:"Cancelar"}),x.jsx("button",{type:"submit",className:"px-6 py-3 bg-green-500 text-white font-bold rounded-lg hover:bg-green-600 transition-colors",children:f?"Salvar Alteraes":"Salvar Filial"})]})]})]}),x.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg dark:bg-gray-900 dark:border dark:border-gray-700",children:[x.jsx("h2",{className:"text-2xl font-bold text-gray-700 dark:text-gray-200 mb-4",children:"Filiais Registradas"}),x.jsx("div",{className:"overflow-x-auto",children:x.jsxs("table",{className:"min-w-full bg-white divide-y divide-gray-200 dark:bg-gray-900 dark:divide-gray-700",children:[x.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:x.jsx("tr",{children:[{label:"Nome",key:"name"},{label:"CNPJ",key:"cnpj"},{label:"Endereo",key:"address"},{label:"Cidade",key:"city"},{label:"Estado",key:"state"},{label:"Contato",key:"contact"},{label:"Situao",key:"status"},{label:"Aes",key:""}].map(W=>x.jsxs("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer select-none",onClick:W.key?()=>M(W.key):void 0,children:[W.label,W.key&&m.key===W.key&&x.jsx("span",{className:"ml-1",children:m.direction==="asc"?"":""})]},W.label))})}),x.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:F.map(W=>x.jsxs("tr",{className:"bg-white dark:bg-gray-900 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-100",children:W.name}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:W.cnpj}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:W.address}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:W.city}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:W.state}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:W.contact}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:x.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${G(W.status)}`,children:W.status})}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx("button",{onClick:()=>E(W),className:"text-blue-600 hover:text-blue-900 transition-colors",children:x.jsx(To,{})}),x.jsx("button",{onClick:()=>n(W.id),className:"text-red-600 hover:text-red-900 transition-colors",children:x.jsx(Tl,{})})]})})]},W.id))})]})})]})]})},sq=({licenses:t,branches:e,licenseTypes:r,onUpdateLicense:n})=>{const[a,s]=je.useState(null),[l,u]=je.useState(null),[f,d]=je.useState({key:"originalExpiryDate",direction:"asc"}),[m,y]=je.useState(!1),[_,E]=je.useState({branchId:"",licenseType:""}),b=k=>{var O;return((O=e.find(P=>P.id===k))==null?void 0:O.name)||"Desconhecida"},w=k=>{s(k),u(k)},S=()=>{s(null),u(null)},M=k=>{const{name:O,value:P,type:N,checked:R}=k.target;u(he=>he?{...he,[O]:N==="checkbox"?R:P}:null)},j=k=>{k.preventDefault(),l&&(n(l),S())},F=k=>{d(O=>O.key===k?{key:k,direction:O.direction==="asc"?"desc":"asc"}:{key:k,direction:"asc"})};function G(k,O){return["issueDate","originalExpiryDate","prorrogaDate","processStartDate"].includes(O)?k[O]?new Date(k[O]):new Date(0):(k[O]||"").toString().toLowerCase()}const W=[...e].sort((k,O)=>k.name.localeCompare(O.name)),B=[...r].sort((k,O)=>k.name.localeCompare(O.name)),D=[...t.filter(k=>(!_.branchId||k.unitId===_.branchId)&&(!_.licenseType||k.licenseType===_.licenseType))].sort((k,O)=>{const P=G(k,f.key),N=G(O,f.key);return P<N?f.direction==="asc"?-1:1:P>N?f.direction==="asc"?1:-1:0});return x.jsxs("div",{className:"space-y-6",children:[x.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg dark:bg-gray-900 dark:border dark:border-gray-700",children:[x.jsxs("h2",{className:"text-2xl font-bold text-gray-700 dark:text-white mb-4 flex items-center gap-2",children:["Licenas Desativadas",x.jsx("button",{type:"button",onClick:()=>y(k=>!k),className:"ml-2 p-2 rounded hover:bg-gray-100 transition",children:x.jsx(IA,{})})]}),m&&x.jsxs("div",{className:"mb-4 bg-gray-50 border border-gray-200 rounded-lg p-4 flex flex-col md:flex-row gap-4 items-center",children:[x.jsxs("div",{className:"flex flex-col",children:[x.jsx("label",{className:"text-xs font-semibold text-gray-600 dark:text-gray-300 mb-1",children:"Filtrar por Filial"}),x.jsxs("select",{value:_.branchId,onChange:k=>E(O=>({...O,branchId:k.target.value})),className:"p-2 border border-gray-300 rounded",children:[x.jsx("option",{value:"",children:"Todas"}),W.map(k=>x.jsx("option",{value:k.id,children:k.name},k.id))]})]}),x.jsxs("div",{className:"flex flex-col",children:[x.jsx("label",{className:"text-xs font-semibold text-gray-600 dark:text-gray-300 mb-1",children:"Filtrar por Tipo de Licena"}),x.jsxs("select",{value:_.licenseType,onChange:k=>E(O=>({...O,licenseType:k.target.value})),className:"p-2 border border-gray-300 rounded",children:[x.jsx("option",{value:"",children:"Todas"}),B.map(k=>x.jsx("option",{value:k.name,children:k.name},k.id))]})]}),x.jsx("button",{onClick:()=>E({branchId:"",licenseType:""}),className:"mt-4 md:mt-6 px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400 transition",children:"Limpar Filtros"})]}),x.jsx("div",{className:"overflow-x-auto",children:x.jsxs("table",{className:"min-w-full bg-white divide-y divide-gray-200 dark:bg-gray-900 dark:divide-gray-700",children:[x.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:x.jsx("tr",{children:[{label:"Unidade",key:"unitId"},{label:"Licena",key:"licenseType"},{label:"N/Ano",key:"numberYear"},{label:"Descrio",key:"description"},{label:"rgo Licenciador",key:"licensingAgency"},{label:"FCEI-N do Processo",key:"processNumber"},{label:"Data Emisso",key:"issueDate"},{label:"Data Vencimento",key:"originalExpiryDate"},{label:"Prazo Prorrogao",key:"prorrogaDate"},{label:"Incio Processo",key:"processStartDate"},{label:"Observao da Desativao",key:"inactiveObservation"},{label:"Aes",key:""}].map(k=>x.jsxs("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer select-none",onClick:k.key?()=>F(k.key):void 0,children:[k.label,k.key&&f.key===k.key&&x.jsx("span",{className:"ml-1",children:f.direction==="asc"?"":""})]},k.label))})}),x.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:D.map(k=>x.jsxs("tr",{className:"bg-white dark:bg-gray-900 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-100",children:b(k.unitId)}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:k.licenseType}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:k.numberYear}),x.jsx("td",{className:"px-6 py-4 whitespace-normal text-sm text-gray-600 dark:text-gray-300 max-w-xs",children:k.description}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:k.licensingAgency}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:k.processNumber}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:k.issueDate?new Date(k.issueDate+"T00:00:00").toLocaleDateString("pt-BR"):""}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:k.originalExpiryDate?new Date(k.originalExpiryDate+"T00:00:00").toLocaleDateString("pt-BR"):""}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:k.prorrogaDate?new Date(k.prorrogaDate+"T00:00:00").toLocaleDateString("pt-BR"):""}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:k.processStartDate?new Date(k.processStartDate+"T00:00:00").toLocaleDateString("pt-BR"):""}),x.jsx("td",{className:"px-6 py-4 whitespace-normal text-sm text-red-600 max-w-xs",children:k.inactiveObservation}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:x.jsx("button",{onClick:()=>w(k),className:"text-blue-600 hover:text-blue-900 transition-colors",children:x.jsx(To,{})})})]},k.id))})]})})]}),a&&l&&x.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg dark:bg-gray-900 dark:border dark:border-gray-700 mt-6",children:[x.jsx("h3",{className:"text-xl font-bold text-gray-700 mb-4",children:"Editar Licena Desativada"}),x.jsxs("form",{onSubmit:j,className:"grid grid-cols-1 md:grid-cols-2 gap-6 animate-fade-in",children:[x.jsxs("div",{className:"flex flex-col",children:[x.jsx("label",{htmlFor:"inactiveObservation",className:"mb-1 font-semibold text-gray-600 dark:text-gray-300",children:"Observao da Desativao"}),x.jsx("textarea",{name:"inactiveObservation",id:"inactiveObservation",value:l.inactiveObservation||"",onChange:M,rows:2,className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition",required:!0})]}),x.jsxs("div",{className:"flex items-center md:col-span-2",children:[x.jsx("input",{type:"checkbox",id:"active",name:"active",checked:l.active,onChange:M,className:"mr-2"}),x.jsx("label",{htmlFor:"active",className:"font-semibold text-gray-600 dark:text-gray-300",children:"Reativar Licena"})]}),x.jsxs("div",{className:"md:col-span-2 flex justify-end gap-4",children:[x.jsx("button",{type:"button",onClick:S,className:"px-6 py-3 bg-gray-500 text-white font-bold rounded-lg hover:bg-gray-600 transition-colors",children:"Cancelar"}),x.jsx("button",{type:"submit",className:"px-6 py-3 bg-green-500 text-white font-bold rounded-lg hover:bg-green-600 transition-colors",children:"Salvar Alteraes"})]})]})]})]})},oq="/licencas/assets/meioambiental-Cjp3hbnE.jpeg",lq=({onLogin:t})=>{const[e,r]=je.useState(""),[n,a]=je.useState(""),[s,l]=je.useState(""),[u,f]=je.useState(!1),d=async m=>{m.preventDefault(),f(!0),l("");try{await bF(Mf,e,n),t()}catch{l("Usurio ou senha invlidos, ou usurio no autorizado.")}finally{f(!1)}};return x.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-cover bg-center bg-no-repeat relative",style:{backgroundImage:`url(${oq})`},children:[x.jsx("div",{className:"absolute inset-0 bg-black/50"}),x.jsxs("form",{onSubmit:d,className:"relative z-10 bg-white/95 backdrop-blur-sm p-8 rounded-xl shadow-2xl w-full max-w-sm space-y-6",children:[x.jsx("h2",{className:"text-2xl font-bold text-center text-gray-700",children:"Login"}),x.jsxs("div",{className:"flex flex-col gap-2",children:[x.jsx("label",{htmlFor:"email",className:"font-semibold text-gray-600",children:"E-mail"}),x.jsx("input",{id:"email",type:"email",value:e,onChange:m=>r(m.target.value),className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition",required:!0,autoFocus:!0})]}),x.jsxs("div",{className:"flex flex-col gap-2",children:[x.jsx("label",{htmlFor:"password",className:"font-semibold text-gray-600",children:"Senha"}),x.jsx("input",{id:"password",type:"password",value:n,onChange:m=>a(m.target.value),className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent transition",required:!0})]}),s&&x.jsx("div",{className:"text-red-600 text-sm text-center",children:s}),x.jsx("button",{type:"submit",className:"w-full py-3 bg-blue-500 text-white font-bold rounded-lg hover:bg-blue-600 transition-colors",disabled:u,children:u?"Entrando...":"Entrar"})]})]})},S1=({className:t="h-6 w-6"})=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),k1=({className:t="h-6 w-6"})=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),HC=({className:t="h-6 w-6"})=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),cq=({licenses:t,branches:e,licenseTypes:r})=>{const n=t.filter(w=>w.active);t.filter(w=>!w.active);const a=new Date;a.setHours(0,0,0,0);const s=w=>{const M=new Date(w+"T00:00:00").getTime()-a.getTime();return Math.ceil(M/(1e3*60*60*24))},l=n.map(w=>{const S=s(w.originalExpiryDate),M=r.find(G=>G.name===w.licenseType),j=M?(M.renewalProtocolDays||0)+(M.processStartDays||0):180;let F="ok";return S<0?F="expired":S<=j&&(F="warning"),{...w,days:S,status:F}}),u=n.length,f=l.filter(w=>w.status==="expired").length,d=l.filter(w=>w.status==="warning").length,m=e.length,y=l.sort((w,S)=>w.days-S.days).slice(0,10),_=r.map(w=>{const S=n.filter(M=>M.licenseType===w.name).length;return{...w,count:S}}).filter(w=>w.count>0).sort((w,S)=>S.count-w.count),E=e.map(w=>{const S=n.filter(M=>M.unitId===w.id).length;return{...w,count:S}}).filter(w=>w.count>0).sort((w,S)=>S.count-w.count),b=({title:w,value:S,icon:M,color:j,bgColor:F})=>x.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 flex items-center justify-between border border-gray-100 dark:border-gray-700",children:[x.jsxs("div",{children:[x.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:w}),x.jsx("p",{className:"text-3xl font-bold text-gray-800 dark:text-white mt-2",children:S})]}),x.jsx("div",{className:`p-3 rounded-full ${F} ${j}`,children:M})]});return x.jsxs("div",{className:"space-y-6 animate-fade-in",children:[x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[x.jsx(b,{title:"Licenas Ativas",value:u,icon:x.jsx(S1,{className:"h-8 w-8"}),color:"text-blue-700",bgColor:"bg-blue-100 dark:bg-blue-900/20"}),x.jsx(b,{title:"Em Alerta",value:d,icon:x.jsx(k1,{className:"h-8 w-8"}),color:"text-yellow-700",bgColor:"bg-yellow-100 dark:bg-yellow-900/20"}),x.jsx(b,{title:"Vencidas (Ativas)",value:f,icon:x.jsx(k1,{className:"h-8 w-8"}),color:"text-red-700",bgColor:"bg-red-100 dark:bg-red-900/20"}),x.jsx(b,{title:"Filiais",value:m,icon:x.jsx(HC,{className:"h-8 w-8"}),color:"text-green-700",bgColor:"bg-green-100 dark:bg-green-900/20"})]}),x.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[x.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 p-6",children:[x.jsx("h3",{className:"text-lg font-bold text-gray-800 dark:text-white mb-4",children:"Prximos Vencimentos"}),x.jsx("div",{className:"overflow-x-auto",style:{transform:"rotateX(180deg)"},children:x.jsxs("table",{className:"min-w-full",style:{transform:"rotateX(180deg)"},children:[x.jsx("thead",{children:x.jsxs("tr",{className:"text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-b border-gray-200 dark:border-gray-700",children:[x.jsx("th",{className:"pb-3",children:"Filial"}),x.jsx("th",{className:"pb-3",children:"Licena"}),x.jsx("th",{className:"pb-3",children:"Vencimento"}),x.jsx("th",{className:"pb-3",children:"Status"})]})}),x.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:y.length>0?y.map(w=>{var S;return x.jsxs("tr",{children:[x.jsx("td",{className:"py-3 text-sm text-gray-700 dark:text-gray-300",children:(S=e.find(M=>M.id===w.unitId))==null?void 0:S.name}),x.jsx("td",{className:"py-3 text-sm text-gray-700 dark:text-gray-300",children:w.licenseType}),x.jsx("td",{className:"py-3 text-sm text-gray-700 dark:text-gray-300",children:new Date(w.originalExpiryDate+"T00:00:00").toLocaleDateString("pt-BR")}),x.jsx("td",{className:"py-3",children:x.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${w.status==="expired"?"bg-red-100 text-red-800 dark:bg-red-900/90 dark:text-red-200":w.status==="warning"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/90 dark:text-yellow-200":"bg-green-100 text-green-800 dark:bg-green-900/90 dark:text-green-200"}`,children:w.status==="expired"?"Vencida":`${w.days} dias`})})]},w.id)}):x.jsx("tr",{children:x.jsx("td",{colSpan:4,className:"py-4 text-center text-gray-500 text-sm",children:"Nenhuma licena prxima do vencimento."})})})]})})]}),x.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 p-6",children:[x.jsx("h3",{className:"text-lg font-bold text-gray-800 dark:text-white mb-4",children:"Distribuies"}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[x.jsxs("div",{children:[x.jsx("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3",children:"Por Tipo"}),x.jsx("div",{className:"space-y-4 max-h-[620px] overflow-y-auto pr-2",children:_.map(w=>{const S=Math.round(w.count/u*100)||0;return x.jsxs("div",{children:[x.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[x.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:w.name}),x.jsxs("span",{className:"text-gray-500 dark:text-gray-400",children:[w.count," (",S,"%)"]})]}),x.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-400 rounded-full h-2",children:x.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${S}%`}})})]},w.id)})})]}),x.jsxs("div",{children:[x.jsx("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3",children:"Por Filial"}),x.jsx("div",{className:"space-y-4 max-h-[620px] overflow-y-auto pr-2",children:E.map(w=>{const S=Math.round(w.count/u*100)||0;return x.jsxs("div",{children:[x.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[x.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:w.name}),x.jsxs("span",{className:"text-gray-500 dark:text-gray-400",children:[w.count," (",S,"%)"]})]}),x.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-400 rounded-full h-2",children:x.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${S}%`}})})]},w.id)})})]})]})]})]})]})},Fx=[{id:"dashboard",label:"Dashboard"},{id:"licenses",label:"Licenas Vigentes"},{id:"sgaLicenses",label:"Licenas SGA"},{id:"deactivatedLicenses",label:"Licenas Vencidas"},{id:"licenseTypes",label:"Tipos de Licena"},{id:"branches",label:"Filiais"},{id:"laoConditions",label:"Condicionantes LAO"},{id:"users",label:"Usurios"}],uq=({branches:t=[],licenseTypes:e=[]})=>{const[r,n]=je.useState([]),[a,s]=je.useState(!0),[l,u]=je.useState(!1),[f,d]=je.useState(null),[m,y]=je.useState({allowedScreens:[],visibleBranchIds:[],visibleLicenseTypes:[],name:"",email:"",password:"",role:"colaborador"}),[_,E]=je.useState(""),b=R=>{y(he=>{const xe=new Set(he.allowedScreens);return xe.has(R)?xe.delete(R):xe.add(R),{...he,allowedScreens:Array.from(xe)}})},w=R=>{y(he=>{const xe=new Set(he.visibleBranchIds);return xe.has(R)?xe.delete(R):xe.add(R),{...he,visibleBranchIds:Array.from(xe)}})},S=()=>{y(R=>{if(!t||t.length===0)return R;const he=t.map(ne=>ne.id),xe=R.visibleBranchIds.length===he.length;return{...R,visibleBranchIds:xe?[]:he}})},M=R=>{y(he=>{const xe=new Set(he.visibleLicenseTypes);return xe.has(R)?xe.delete(R):xe.add(R),{...he,visibleLicenseTypes:Array.from(xe)}})},j=()=>{y(R=>{if(!e||e.length===0)return R;const he=e.map(ne=>ne.name),xe=R.visibleLicenseTypes.length===he.length;return{...R,visibleLicenseTypes:xe?[]:he}})},[F,G]=je.useState(""),W=Rs(kr,"users"),B=async()=>{s(!0);try{const he=(await la(W)).docs.map(xe=>({...xe.data(),id:xe.id}));n(he)}catch(R){console.error("Error fetching users:",R)}finally{s(!1)}};je.useEffect(()=>{B()},[]);const A=R=>{const{name:he,value:xe}=R.target;y(ne=>{let le={...ne,[he]:xe};if(he==="role"&&xe==="admin"){const He=Fx.map(ie=>ie.id);le={...le,allowedScreens:He,visibleBranchIds:t.map(ie=>ie.id),visibleLicenseTypes:e.map(ie=>ie.name)}}return le})},D=()=>{y({name:"",email:"",password:"",role:"colaborador",allowedScreens:[],visibleBranchIds:[],visibleLicenseTypes:[]}),d(null),E(""),G(""),u(!1)},k=async R=>{if(R.preventDefault(),E(""),G(""),m.role==="admin"&&(m.allowedScreens=Fx.map(he=>he.id),m.visibleBranchIds=t.map(he=>he.id),m.visibleLicenseTypes=e.map(he=>he.name)),f)try{const he=ca(kr,"users",f.id);await oo(he,{allowedScreens:m.allowedScreens||[],visibleBranchIds:m.visibleBranchIds||[],visibleLicenseTypes:m.visibleLicenseTypes||[],name:m.name,role:m.role}),G("Usurio atualizado com sucesso!"),B(),setTimeout(D,1500)}catch(he){E("Erro ao atualizar usurio: "+he.message)}else{if(!m.password||m.password.length<6){E("A senha deve ter pelo menos 6 caracteres.");return}try{const he=F1(NA,"Secondary"),xe=hA(he),le=(await TF(xe,m.email,m.password)).user.uid;await f1(xe),await eR(he),await so(W,{uid:le,name:m.name,email:m.email,role:m.role,allowedScreens:m.allowedScreens||[],visibleBranchIds:m.visibleBranchIds||[],visibleLicenseTypes:m.visibleLicenseTypes||[],active:!0,createdAt:new Date().toISOString()}),G("Usurio criado com sucesso!"),B(),setTimeout(D,1500)}catch(he){console.error(he),he.code==="auth/email-already-in-use"?E("Este e-mail j est em uso."):E("Erro ao criar usurio: "+he.message)}}},O=R=>{d(R),y({name:R.name,email:R.email,password:"",role:R.role,allowedScreens:R.allowedScreens||[],visibleBranchIds:R.visibleBranchIds||[],visibleLicenseTypes:R.visibleLicenseTypes||[]}),u(!0)},P=async R=>{if(window.confirm("Tem certeza que deseja excluir este usurio? O acesso dele ser revogado."))try{await jd(ca(kr,"users",R)),B()}catch(he){alert("Erro ao excluir usurio: "+he.message)}},N=async R=>{try{const he=ca(kr,"users",R.id);await oo(he,{active:!R.active}),B()}catch(he){alert("Erro ao alterar status: "+he.message)}};return x.jsxs("div",{className:"space-y-6 animate-fade-in",children:[x.jsxs("div",{className:"flex justify-between items-center",children:[x.jsx("h2",{className:"text-xl font-semibold text-gray-800 dark:text-white",children:"Gerenciamento de Usurios"}),x.jsxs("button",{onClick:()=>{D(),u(!0)},className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-sm",children:[x.jsx(El,{className:"h-5 w-5 mr-2"}),"Novo Usurio"]})]}),x.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden",children:x.jsx("div",{className:"overflow-x-auto",children:x.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[x.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700/90",children:x.jsxs("tr",{children:[x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Nome"}),x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Email"}),x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Funo"}),x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Status"}),x.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Aes"})]})}),x.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:a?x.jsx("tr",{children:x.jsx("td",{colSpan:5,className:"px-6 py-4 text-center text-black dark:text-gray-400",children:"Carregando..."})}):r.length===0?x.jsx("tr",{children:x.jsx("td",{colSpan:5,className:"px-6 py-4 text-center text-black dark:text-gray-400",children:"Nenhum usurio encontrado."})}):r.map(R=>x.jsxs("tr",{className:"bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700/90 transition-colors",children:[x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:R.name}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-black dark:text-gray-300",children:R.email}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-black dark:text-gray-300",children:x.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${R.role==="admin"?"bg-purple-100 text-purple-800 dark:bg-purple-900/90 dark:text-purple-200":"bg-blue-100 text-blue-800 dark:bg-blue-900/90 dark:text-blue-200"}`,children:R.role==="admin"?"Administrador":"Colaborador"})}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:x.jsx("button",{onClick:()=>N(R),className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full cursor-pointer ${R.active?"bg-green-100 text-green-800 dark:bg-green-900/90 dark:text-green-200":"bg-red-100 text-red-800 dark:bg-red-900/90 dark:text-red-200"}`,children:R.active?"Ativo":"Inativo"})}),x.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[x.jsx("button",{onClick:()=>O(R),className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300 mr-3",children:x.jsx(To,{className:"h-5 w-5"})}),x.jsx("button",{onClick:()=>P(R.id),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300",children:x.jsx(Tl,{className:"h-5 w-5"})})]})]},R.id))})]})})}),l&&x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:x.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-xl max-w-md w-full p-6 animate-fade-in",children:[x.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4",children:f?"Editar Usurio":"Novo Usurio"}),_&&x.jsx("div",{className:"mb-4 p-3 bg-red-100 text-red-700 rounded-lg text-sm",children:_}),F&&x.jsx("div",{className:"mb-4 p-3 bg-green-100 text-green-700 rounded-lg text-sm",children:F}),x.jsxs("form",{onSubmit:k,className:"space-y-4",children:[x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Nome"}),x.jsx("input",{type:"text",name:"name",value:m.name,onChange:A,className:"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 outline-none",required:!0})]}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Email"}),x.jsx("input",{type:"email",name:"email",value:m.email,onChange:A,className:"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 outline-none disabled:opacity-50",required:!0,disabled:!!f})]}),!f&&x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Senha"}),x.jsx("input",{type:"password",name:"password",value:m.password,onChange:A,className:"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 outline-none",required:!f,minLength:6})]}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Funo"}),x.jsxs("select",{name:"role",value:m.role,onChange:A,className:"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 outline-none",children:[x.jsx("option",{value:"colaborador",children:"Colaborador"}),x.jsx("option",{value:"admin",children:"Administrador"})]})]}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Permisses (telas)"}),x.jsx("div",{className:"grid grid-cols-2 gap-2",children:Fx.map(R=>x.jsxs("label",{className:"inline-flex items-center gap-2",children:[x.jsx("input",{type:"checkbox",checked:m.allowedScreens.includes(R.id),onChange:()=>b(R.id),disabled:m.role==="admin"}),x.jsx("span",{className:"text-sm",children:R.label})]},R.id))})]}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Acesso por Filial"}),x.jsx("div",{className:"flex items-center gap-2 mb-2",children:x.jsxs("label",{className:"inline-flex items-center gap-2",children:[x.jsx("input",{type:"checkbox",checked:t.length>0&&m.visibleBranchIds.length===t.length,onChange:S}),x.jsx("span",{className:"text-sm font-medium",children:"Selecionar todos"})]})}),x.jsx("div",{className:"grid grid-cols-1 max-h-32 overflow-y-auto gap-2 p-1 border rounded",children:t.map(R=>x.jsxs("label",{className:"inline-flex items-center gap-2",children:[x.jsx("input",{type:"checkbox",checked:m.visibleBranchIds.includes(R.id),onChange:()=>w(R.id),disabled:m.role==="admin"}),x.jsx("span",{className:"text-sm",children:R.name})]},R.id))})]}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Acesso por Tipo de Licena"}),x.jsx("div",{className:"flex items-center gap-2 mb-2",children:x.jsxs("label",{className:"inline-flex items-center gap-2",children:[x.jsx("input",{type:"checkbox",checked:e.length>0&&m.visibleLicenseTypes.length===e.length,onChange:j}),x.jsx("span",{className:"text-sm font-medium",children:"Selecionar todos"})]})}),x.jsx("div",{className:"grid grid-cols-1 max-h-32 overflow-y-auto gap-2 p-1 border rounded",children:e.map(R=>x.jsxs("label",{className:"inline-flex items-center gap-2",children:[x.jsx("input",{type:"checkbox",checked:m.visibleLicenseTypes.includes(R.name),onChange:()=>M(R.name),disabled:m.role==="admin"}),x.jsx("span",{className:"text-sm",children:R.name})]},R.id))})]}),x.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[x.jsx("button",{type:"button",onClick:D,className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:"Cancelar"}),x.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:f?"Salvar Alteraes":"Criar Usurio"})]})]})]})})]})},fq={mensal:1,bimestral:2,trimestral:3,semestral:6,anual:12};function Hr(t){return t.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim().replace(/\s+/g," ")}function t0(t,e){return`${Hr(t)}::${Hr(e)}`}function S0(t){if(!t)return null;const e=t.split("-").map(Number);return e.length!==3||e.some(Number.isNaN)?null:new Date(e[0],e[1]-1,e[2])}function A1(t){const e=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0");return`${e}-${r}-${n}`}function ys(t){const e=S0(t);return e?e.toLocaleDateString("pt-BR"):""}function Rb(t){if(!t)return null;if(t instanceof Date)return A1(t);if(typeof t=="number"){const e=new Date(Date.UTC(1899,11,30)),r=Math.round(t*24*60*60*1e3),n=new Date(e.getTime()+r);return Number.isNaN(n.getTime())?null:A1(new Date(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate()))}if(typeof t=="string"){const e=t.trim();if(!e)return null;if(e.match(/^(\d{4})-(\d{2})-(\d{2})$/))return e;const n=e.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/);if(n){const a=Number(n[1]),s=Number(n[2]),l=Number(n[3]);if(a>0&&a<=31&&s>0&&s<=12)return`${l}-${String(s).padStart(2,"0")}-${String(a).padStart(2,"0")}`}}return null}function hq(t){const e=Hr(t);if(!e)return{preset:"anual"};if(e.includes("mensal"))return{preset:"mensal"};if(e.includes("bimestral"))return{preset:"bimestral"};if(e.includes("trimestral"))return{preset:"trimestral"};if(e.includes("semestral"))return{preset:"semestral"};if(e.includes("anual"))return{preset:"anual"};const r=e.match(/(\d+)\s*(mes|meses|m)/);if(r){const n=Number(r[1]);if(!Number.isNaN(n)&&n>0)return{preset:"custom",customMonthsInterval:n}}return{preset:"anual"}}function Db(t,e){return t==="custom"?!e||e<=0?null:e:fq[t]}function C1(t,e){const r=t.getFullYear(),n=t.getMonth(),a=t.getDate(),s=new Date(r,n+e,1),l=new Date(s.getFullYear(),s.getMonth()+1,0),u=Math.min(a,l.getDate());return new Date(s.getFullYear(),s.getMonth(),u)}function dq(t,e,r,n){const a=S0(t||null),s=S0(e);if(!a||!s||r<=0)return[];const l=[];let u=C1(a,r);for(;u.getTime()<=s.getTime()&&(u.getFullYear()===n&&l.push(A1(u)),!(u.getFullYear()>n&&u.getTime()>s.getTime()));)u=C1(u,r);return l}function mq(t,e,r){return e<r.getFullYear()?!0:e>r.getFullYear()?!1:t<r.getMonth()}const pq=new Set(["capa","lai","cronograma","plan1"]);function GC(t){return Array.from(new Set(t)).sort((e,r)=>e.localeCompare(r))}function qC(t){return t.length===0?null:t.reduce((e,r)=>r>e?r:e,t[0])}function WC(t){const e=t.split(`
`).map(r=>r.trim()).filter(Boolean);return e.length===0?t.trim():e[0]}function gq(t){const e=t.split(`
`).map(a=>a.trim()).filter(Boolean);if(e.length>1)return e.slice(1).join(" ");const r=e[0]||"",n=WC(r);return r.replace(n,"").trim()}function Ob(t,e){const r=[...t];for(const n of e)r.some(s=>Hr(s.key)===Hr(n.key)&&Hr(s.value)===Hr(n.value))||r.push({...n,id:`${n.id}-${r.length}`,order:r.length});return r.map((n,a)=>({...n,order:a}))}function xq(t,e){const r=t.findIndex(u=>Hr(u.name)===Hr(e.name));if(r<0)return[...t,e];const n=t[r],a=GC([...n.inspections,...e.inspections]),s={...n,frequencyPreset:e.frequencyPreset||n.frequencyPreset,customMonthsInterval:e.customMonthsInterval||n.customMonthsInterval,inspections:a,lastInspectionDate:qC(a),notes:n.notes||e.notes},l=[...t];return l[r]=s,l}function vq(t){const e=_m(t,{cellDates:!0}),r=[],n=[];for(const _ of e.SheetNames){if(pq.has(Hr(_)))continue;const E=e.Sheets[_],b=Yc.sheet_to_json(E,{header:1,defval:""});if(b.length===0)continue;let w="",S="",M="",j="",F="",G="",W="";const B=[];if(b.forEach((k,O)=>{const P=String(k[0]??"").trim();if(!P)return;const N=k[1],R=String(N??"").trim(),he=Hr(P),xe=Rb(N);if(he==="empreendimento"){w=R;return}if(he==="processo"){M=R;return}if(he==="fcei"){j=R;return}if(he==="codam"){F=R;return}if(he.includes("licenca")){S=R;return}if(he.includes("emissao")){G=xe||R;return}if(he==="validade"){W=xe||R;return}R&&B.push({id:`detail-${Hr(_)}-${O}`,key:P,value:R,order:B.length})}),!w&&!S&&B.length===0)continue;const A=S||`LAO ${_}`,D=w||_;n.push({importKey:t0(A,D),laoNumber:A,title:`${A} ${D}`.trim(),empreendimento:D,processNumber:M||void 0,fcei:j||void 0,codam:F||void 0,issueDate:G||void 0,validityDate:W||void 0,details:B,conditions:[]})}const a=e.Sheets.Capa||e.Sheets.capa;if(!a)return{items:n,parserErrors:["Aba Capa no encontrada no arquivo."]};const s=Yc.sheet_to_json(a,{header:1,defval:""}),l=new Map;let u="",f="",d="";for(let _=1;_<s.length;_+=1){const E=s[_],b=String(E[0]??"").trim(),w=String(E[1]??"").trim(),S=String(E[2]??"").trim();if(b&&Hr(b).includes("lao")){u=b,f=WC(b),d=gq(b)||f;const A=t0(f,d);l.has(A)||l.set(A,{importKey:A,laoNumber:f,title:u.replace(/\n+/g," ").trim(),empreendimento:d,details:[],conditions:[]});continue}if(!w||!f)continue;const M=t0(f,d),j=l.get(M);if(!j)continue;const F=hq(S),G=[];for(let A=3;A<=14;A+=1){const D=Rb(E[A]);D&&G.push(D)}const W=GC(G),B={name:w,frequencyPreset:F.preset,customMonthsInterval:F.customMonthsInterval,inspections:W,lastInspectionDate:qC(W)};j.conditions=xq(j.conditions,B),l.set(M,j)}const m=Array.from(l.values());for(const _ of n){const E=l.get(_.importKey);if(E){E.processNumber=E.processNumber||_.processNumber,E.fcei=E.fcei||_.fcei,E.codam=E.codam||_.codam,E.issueDate=E.issueDate||_.issueDate,E.validityDate=E.validityDate||_.validityDate,E.details=Ob(E.details,_.details);continue}const b=m.find(w=>Hr(w.empreendimento)===Hr(_.empreendimento));if(b){b.processNumber=b.processNumber||_.processNumber,b.fcei=b.fcei||_.fcei,b.codam=b.codam||_.codam,b.issueDate=b.issueDate||_.issueDate,b.validityDate=b.validityDate||_.validityDate,b.details=Ob(b.details,_.details);continue}l.set(_.importKey,_)}return{items:Array.from(l.values()).filter(_=>!_.laoNumber||!_.empreendimento?(r.push(`Registro ignorado por falta de LAO/Empreendimento: "${_.title}"`),!1):_.validityDate?!0:(r.push(`LAO "${_.laoNumber}" sem validade definida no detalhamento.`),!1)),parserErrors:r}}function yq(t){const r=["tipo;lao;empreendimento;motivo",...t.pendingItems.map(l=>`pendencia;${l.laoNumber};${l.empreendimento};${l.reason}`),...t.importErrors.map(l=>`erro;;;${l}`),...t.parserErrors.map(l=>`parser;;;${l}`)].join(`
`),n=new Blob([r],{type:"text/csv;charset=utf-8;"}),a=URL.createObjectURL(n),s=document.createElement("a");s.href=a,s.download=`relatorio-importacao-lao-${Date.now()}.csv`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(a)}const _q=({open:t,onClose:e,onImportParsed:r})=>{const n=je.useRef(null),[a,s]=je.useState(!1),[l,u]=je.useState(null),[f,d]=je.useState(null),m=async y=>{var E;const _=(E=y.target.files)==null?void 0:E[0];if(_){s(!0),d(null),u(null);try{const b=await _.arrayBuffer(),w=vq(b),S=await r(w.items,w.parserErrors);u(S),d("Importao concluda.")}catch(b){d(`Erro ao importar: ${b.message}`)}finally{s(!1),n.current&&(n.current.value="")}}};return t?x.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-4",children:x.jsxs("div",{className:"w-full max-w-2xl rounded-xl bg-white p-6 shadow-xl dark:bg-gray-800",children:[x.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[x.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-white",children:"Importar Workbook de LAO"}),x.jsx("button",{onClick:e,className:"rounded p-1 text-gray-400 hover:bg-gray-100 hover:text-gray-600 dark:hover:bg-gray-700",children:""})]}),x.jsxs("p",{className:"mb-4 text-sm text-gray-600 dark:text-gray-300",children:["Formato suportado: planilha com aba ",x.jsx("strong",{children:"Capa"})," e abas de detalhamento por empreendimento."]}),x.jsx("div",{className:"mb-4",children:x.jsx("input",{ref:n,type:"file",accept:".xlsx,.xls",onChange:m,disabled:a,className:"block w-full text-sm text-gray-700 dark:text-gray-200"})}),a&&x.jsx("div",{className:"mb-4 rounded bg-blue-50 px-3 py-2 text-sm text-blue-700",children:"Processando importao..."}),f&&x.jsx("div",{className:"mb-4 rounded bg-gray-50 px-3 py-2 text-sm text-gray-700 dark:bg-gray-700 dark:text-gray-100",children:f}),l&&x.jsxs("div",{className:"space-y-3 rounded-lg border border-gray-200 p-4 dark:border-gray-700",children:[x.jsx("h4",{className:"font-semibold text-gray-800 dark:text-white",children:"Resultado da importao"}),x.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm text-gray-700 dark:text-gray-200",children:[x.jsxs("div",{children:["LAOs criadas: ",l.created]}),x.jsxs("div",{children:["LAOs atualizadas: ",l.updated]}),x.jsxs("div",{children:["Condicionantes criadas: ",l.conditionCreated]}),x.jsxs("div",{children:["Condicionantes atualizadas: ",l.conditionUpdated]}),x.jsxs("div",{children:["Vistorias criadas: ",l.inspectionsCreated]}),x.jsxs("div",{children:["Vistorias ignoradas: ",l.inspectionsSkipped]}),x.jsxs("div",{children:["Pendncias de filial: ",l.pendingBranch]})]}),x.jsx("div",{className:"flex gap-2",children:x.jsx("button",{onClick:()=>yq(l),className:"rounded bg-slate-600 px-3 py-2 text-sm font-medium text-white hover:bg-slate-700",children:"Baixar relatrio"})}),(l.importErrors.length>0||l.parserErrors.length>0)&&x.jsx("div",{className:"max-h-40 overflow-y-auto rounded bg-red-50 p-2 text-xs text-red-700",children:[...l.parserErrors,...l.importErrors].map((y,_)=>x.jsxs("div",{children:[" ",y]},`${y}-${_}`))})]})]})}):null},Lx=["JAN","FEV","MAR","ABR","MAI","JUN","JUL","AGO","SET","OUT","NOV","DEZ"],XC=[{value:"mensal",label:"Mensal"},{value:"bimestral",label:"Bimestral"},{value:"trimestral",label:"Trimestral"},{value:"semestral",label:"Semestral"},{value:"anual",label:"Anual"},{value:"custom",label:"Personalizada"}];function Fb(t){var e;if(t.frequencyPreset==="custom"){const r=t.customMonthsInterval||0;return r>0?`Personalizada (${r} meses)`:"Personalizada"}return((e=XC.find(r=>r.value===t.frequencyPreset))==null?void 0:e.label)||t.frequencyPreset}function If(t){return{id:`detail-${Date.now()}-${t}`,key:"",value:"",order:t}}function Lb(t,e,r){return`${t}-${r}-${e}`}function Mx(t){return t.length===0?null:t.reduce((e,r)=>r>e?r:e,t[0])}const wq=({laos:t,conditions:e,inspections:r,branches:n,canEdit:a,onAddLao:s,onUpdateLao:l,onDeleteLao:u,onAddCondition:f,onUpdateCondition:d,onDeleteCondition:m,onAddInspection:y})=>{var li;const _=new Date().getFullYear(),[E,b]=je.useState(_),[w,S]=je.useState("all"),[M,j]=je.useState(""),[F,G]=je.useState(""),[W,B]=je.useState(!1),[A,D]=je.useState(null),[k,O]=je.useState(!1),[P,N]=je.useState(!1),[R,he]=je.useState(null),[xe,ne]=je.useState(null),[le,He]=je.useState(""),[ie,J]=je.useState(""),[ge,V]=je.useState(!1),[X,Z]=je.useState(!1),[te,fe]=je.useState(null),[Se,ke]=je.useState({laoNumber:"",title:"",empreendimento:"",branchId:"",category:"Ambiental",processNumber:"",fcei:"",codam:"",issueDate:"",validityDate:"",details:[If(0)],attachments:[],active:!0,createdAt:"",updatedAt:""}),[Ne,Oe]=je.useState({laoId:"",name:"",frequencyPreset:"mensal",customMonthsInterval:0,lastInspectionDate:"",notes:"",active:!0,createdAt:"",updatedAt:""}),ot=je.useMemo(()=>{const se=new Map;return t.forEach(Ue=>se.set(Ue.id,Ue)),se},[t]),ee=je.useMemo(()=>{const se=new Map;return e.forEach(Ue=>{const Qe=se.get(Ue.laoId)||[];Qe.push(Ue),se.set(Ue.laoId,Qe)}),se.forEach(Ue=>Ue.sort((Qe,lt)=>Qe.name.localeCompare(lt.name,"pt-BR",{sensitivity:"base"}))),se},[e]),Pt=je.useMemo(()=>{const se=new Map;return r.forEach(Ue=>{const Qe=new Date(`${Ue.inspectionDate}T00:00:00`);if(Qe.getFullYear()!==E)return;const lt=Lb(Ue.conditionId,Qe.getMonth(),E),st=se.get(lt)||[];st.push(Ue),se.set(lt,st)}),se.forEach(Ue=>Ue.sort((Qe,lt)=>Qe.inspectionDate.localeCompare(lt.inspectionDate))),se},[r,E]),_t=je.useMemo(()=>{const se=new Map;return e.forEach(Ue=>{const Qe=ot.get(Ue.laoId);if(!Qe||!Ue.lastInspectionDate){se.set(Ue.id,[]);return}const lt=Db(Ue.frequencyPreset,Ue.customMonthsInterval);if(!lt){se.set(Ue.id,[]);return}se.set(Ue.id,dq(Ue.lastInspectionDate,Qe.validityDate,lt,E))}),se},[e,ot,E]),Dt=je.useMemo(()=>{const se=Hr(F);return[...t].filter(Ue=>{if(w!=="all"&&Ue.category!==w||M&&Ue.branchId!==M)return!1;if(!se)return!0;const Qe=`${Ue.laoNumber} ${Ue.title} ${Ue.empreendimento}`;return Hr(Qe).includes(se)?!0:(ee.get(Ue.id)||[]).some(st=>Hr(st.name).includes(se))}).sort((Ue,Qe)=>`${Ue.laoNumber} ${Ue.empreendimento}`.localeCompare(`${Qe.laoNumber} ${Qe.empreendimento}`,"pt-BR",{sensitivity:"base"}))},[M,w,ee,t,F]),nt=je.useMemo(()=>{var Ur,Ot;if(!te)return null;const se=e.filter(et=>et.laoId===te.id&&et.active).sort((et,bt)=>et.name.localeCompare(bt.name,"pt-BR",{sensitivity:"base"})),Ue=r.filter(et=>et.laoId===te.id).sort((et,bt)=>bt.inspectionDate.localeCompare(et.inspectionDate)),Qe=((Ur=n.find(et=>et.id===te.branchId))==null?void 0:Ur.name)||"-",lt=new Map;Ue.forEach(et=>{const bt=lt.get(et.conditionId)||[];bt.push(et),lt.set(et.conditionId,bt)});const st=se.map(et=>{const bt=lt.get(et.id)||[],Ht=[...et.lastInspectionDate?[et.lastInspectionDate]:[],...bt.map(Nt=>Nt.inspectionDate)];return{condition:et,inspectionsCount:bt.length,lastInspection:Mx(Ht)}}),Fr=Ue.filter(et=>et.inspectionDate.startsWith(`${E}-`)).length,wn=st.filter(et=>et.inspectionsCount===0&&!et.condition.lastInspectionDate).length;return{lao:te,branchName:Qe,totalConditions:se.length,totalInspections:Ue.length,totalThisYear:Fr,withoutInspectionCount:wn,latestInspection:((Ot=Ue[0])==null?void 0:Ot.inspectionDate)||null,conditionSummary:st,recentInspections:Ue.slice(0,10).map(et=>{var bt;return{...et,conditionName:((bt=se.find(Ht=>Ht.id===et.conditionId))==null?void 0:bt.name)||"Condicionante no encontrada"}}),attachments:te.attachments||[]}},[n,e,r,te,E]),Ge=()=>{D(null),ke({laoNumber:"",title:"",empreendimento:"",branchId:"",category:"Ambiental",processNumber:"",fcei:"",codam:"",issueDate:"",validityDate:"",details:[If(0)],attachments:[],active:!0,createdAt:"",updatedAt:""})},tr=()=>{Ge(),B(!0)},Jt=se=>{D(se),ke({...se,branchId:se.branchId||"",details:se.details.length>0?se.details:[If(0)],attachments:se.attachments||[]}),B(!0)},Ct=se=>{const{name:Ue,value:Qe,type:lt}=se.target;ke(st=>({...st,[Ue]:lt==="checkbox"?se.target.checked:Qe}))},wr=(se,Ue,Qe)=>{ke(lt=>({...lt,details:lt.details.map((st,Fr)=>Fr===se?{...st,[Ue]:Qe}:st)}))},_n=()=>{ke(se=>({...se,details:[...se.details,If(se.details.length)]}))},Dr=se=>{ke(Ue=>{const Qe=Ue.details.filter((lt,st)=>st!==se);return{...Ue,details:Qe.length>0?Qe.map((lt,st)=>({...lt,order:st})):[If(0)]}})},mr=(se,Ue)=>{ke(Qe=>{const lt=se+Ue;if(lt<0||lt>=Qe.details.length)return Qe;const st=[...Qe.details],[Fr]=st.splice(se,1);return st.splice(lt,0,Fr),{...Qe,details:st.map((wn,Ur)=>({...wn,order:Ur}))}})},en=async se=>{if(!se.target.files||se.target.files.length===0)return;const Ue=se.target.files[0];O(!0);try{const lt=`laos/${(A==null?void 0:A.id)||`new-${Date.now()}`}/${Date.now()}_${Ue.name}`,st=nu(au,lt),Fr=await Nv(st,Ue),wn=await Iv(Fr.ref),Ur={id:`${Date.now()}-${Math.random().toString(36).slice(2,7)}`,fileName:Ue.name,fileUrl:wn,uploadedAt:new Date().toISOString(),storagePath:lt};ke(Ot=>({...Ot,attachments:[...Ot.attachments||[],Ur]}))}catch(Qe){alert(`Erro ao anexar arquivo: ${Qe.message}`)}finally{O(!1),se.target.value=""}},jt=async se=>{try{se.storagePath&&await CA(nu(au,se.storagePath))}catch(Ue){console.warn("Falha ao remover arquivo do storage:",Ue)}ke(Ue=>({...Ue,attachments:(Ue.attachments||[]).filter(Qe=>Qe.id!==se.id)}))},oe=async()=>{if(!Se.laoNumber.trim()||!Se.empreendimento.trim()){alert("Informe LAO e Empreendimento.");return}if(!Se.validityDate){alert("Informe a validade da LAO.");return}const se=new Date().toISOString(),Ue=Se.details.filter(Qe=>Qe.key.trim()&&Qe.value.trim()).map((Qe,lt)=>({...Qe,id:Qe.id||`detail-${Date.now()}-${lt}`,order:lt}));A?await l({...A,...Se,branchId:Se.branchId||null,details:Ue,attachments:Se.attachments||[],updatedAt:se}):await s({...Se,branchId:Se.branchId||null,details:Ue,attachments:Se.attachments||[],createdAt:se,updatedAt:se}),B(!1),Ge()},ze=async se=>{window.confirm("Deseja excluir esta LAO e suas condicionantes?")&&await u(se)},Ve=()=>{he(null),Oe({laoId:"",name:"",frequencyPreset:"mensal",customMonthsInterval:0,lastInspectionDate:"",notes:"",active:!0,createdAt:"",updatedAt:""})},Je=se=>{Ve(),Oe(Ue=>({...Ue,laoId:se})),N(!0)},ft=se=>{he(se),Oe({...se,customMonthsInterval:se.customMonthsInterval||0,lastInspectionDate:se.lastInspectionDate||"",notes:se.notes||""}),N(!0)},Ae=se=>{const{name:Ue,value:Qe,type:lt}=se.target;Oe(st=>({...st,[Ue]:lt==="checkbox"?se.target.checked:Qe}))},Me=async()=>{if(!Ne.laoId||!Ne.name.trim()){alert("Selecione a LAO e informe a condicionante.");return}if(Ne.frequencyPreset==="custom"&&(!Ne.customMonthsInterval||Ne.customMonthsInterval<=0)){alert("Informe um intervalo vlido para frequncia personalizada.");return}const se=new Date().toISOString(),Ue={...Ne,lastInspectionDate:Ne.lastInspectionDate||null,notes:Ne.notes||"",createdAt:(R==null?void 0:R.createdAt)||se,updatedAt:se};if(Ne.frequencyPreset==="custom"?Ue.customMonthsInterval=Number(Ne.customMonthsInterval||0):delete Ue.customMonthsInterval,R){const Qe={...R,...Ue,createdAt:R.createdAt,updatedAt:se};Ue.frequencyPreset!=="custom"&&delete Qe.customMonthsInterval,await d(Qe)}else await f({...Ue,createdAt:se,updatedAt:se});N(!1),Ve()},Xe=async se=>{window.confirm("Deseja excluir esta condicionante?")&&await m(se)},ct=(se,Ue,Qe,lt)=>{if(!a)return;const st=`${E}-${String(Qe+1).padStart(2,"0")}-01`;ne({lao:se,condition:Ue,monthIndex:Qe,defaultDate:lt||Ue.lastInspectionDate||st}),He(lt||Ue.lastInspectionDate||st),J("")},sr=async()=>{if(!(!xe||!le)){V(!0);try{if(!await y({laoId:xe.lao.id,conditionId:xe.condition.id,inspectionDate:le,note:ie.trim()||void 0,source:"manual",createdAt:new Date().toISOString()})){alert("J existe vistoria nessa data para esta condicionante.");return}const Ue=xe.condition.lastInspectionDate||"";(!Ue||le>Ue)&&await d({...xe.condition,lastInspectionDate:le,updatedAt:new Date().toISOString()}),ne(null),He(""),J("")}finally{V(!1)}}},Or=async(se,Ue)=>{const Qe={created:0,updated:0,pendingBranch:0,conditionCreated:0,conditionUpdated:0,inspectionsCreated:0,inspectionsSkipped:0,parserErrors:Ue,importErrors:[],pendingItems:[]};let lt=[...t],st=[...e],Fr=[...r];const wn=Ot=>{const et=Hr(Ot),bt=n.find(Ht=>Hr(Ht.name)===et);return(bt==null?void 0:bt.id)||null},Ur=(Ot,et,bt)=>({laoId:Ot,name:et.name.trim(),frequencyPreset:et.frequencyPreset,...et.frequencyPreset==="custom"?{customMonthsInterval:Number(et.customMonthsInterval||0)}:{},lastInspectionDate:et.lastInspectionDate||Mx(et.inspections)||null,notes:et.notes||"",active:!0,createdAt:bt,updatedAt:bt});for(const Ot of se)try{const et=new Date().toISOString(),bt=t0(Ot.laoNumber,Ot.empreendimento),Ht=wn(Ot.empreendimento);Ht||(Qe.pendingBranch+=1,Qe.pendingItems.push({laoNumber:Ot.laoNumber,empreendimento:Ot.empreendimento,reason:"Filial no encontrada automaticamente"}));let Nt=lt.find(pr=>t0(pr.laoNumber,pr.empreendimento)===bt);const Ta={laoNumber:Ot.laoNumber,title:Ot.title||`${Ot.laoNumber} ${Ot.empreendimento}`.trim(),empreendimento:Ot.empreendimento,branchId:Ht,category:"Ambiental",processNumber:Ot.processNumber||"",fcei:Ot.fcei||"",codam:Ot.codam||"",issueDate:Ot.issueDate||"",validityDate:Ot.validityDate||"",details:Ot.details.map((pr,L)=>({...pr,id:pr.id||`detail-import-${Date.now()}-${L}`,order:L})),attachments:(Nt==null?void 0:Nt.attachments)||[],active:!0,createdAt:(Nt==null?void 0:Nt.createdAt)||et,updatedAt:et};if(!Ta.validityDate){Qe.importErrors.push(`LAO "${Ot.laoNumber}" ignorada: validade obrigatria ausente.`);continue}if(Nt){const pr={...Nt,...Ta,attachments:Nt.attachments||[],createdAt:Nt.createdAt};await l(pr),Qe.updated+=1,Nt=pr,lt=lt.map(L=>L.id===(Nt==null?void 0:Nt.id)?Nt:L)}else Nt={id:await s(Ta),...Ta},lt.push(Nt),Qe.created+=1;if(!Nt)continue;for(const pr of Ot.conditions){const L=Hr(pr.name),K=st.find(Y=>Y.laoId===Nt.id&&Hr(Y.name)===L),H=Ur(Nt.id,pr,et);let q=(K==null?void 0:K.id)||"";if(K){const Y=Mx([...K.lastInspectionDate?[K.lastInspectionDate]:[],...pr.lastInspectionDate?[pr.lastInspectionDate]:[],...pr.inspections].filter(Boolean)),de={...K,...H,createdAt:K.createdAt,lastInspectionDate:Y,updatedAt:et};await d(de),Qe.conditionUpdated+=1,q=de.id,st=st.map(Te=>Te.id===de.id?de:Te)}else{const Y=await f(H);Qe.conditionCreated+=1,q=Y,st.push({id:Y,...H})}const Q=Array.from(new Set(pr.inspections)).sort((Y,de)=>Y.localeCompare(de));for(const Y of Q){if(Fr.some(ce=>ce.conditionId===q&&ce.inspectionDate===Y)){Qe.inspectionsSkipped+=1;continue}const Te=await y({laoId:Nt.id,conditionId:q,inspectionDate:Y,source:"import",createdAt:et});if(!Te){Qe.inspectionsSkipped+=1;continue}Qe.inspectionsCreated+=1,Fr.push({id:Te,laoId:Nt.id,conditionId:q,inspectionDate:Y,source:"import",createdAt:et})}}}catch(et){Qe.importErrors.push(`Falha ao importar "${Ot.laoNumber}": ${et.message}`)}return Qe},fn=new Date,Rn=[...n].sort((se,Ue)=>se.name.localeCompare(Ue.name,"pt-BR",{sensitivity:"base"}));return x.jsxs("div",{className:"space-y-6",children:[x.jsxs("div",{className:"rounded-xl bg-white p-6 shadow-lg dark:bg-gray-800",children:[x.jsxs("div",{className:"mb-4 flex flex-wrap items-center justify-between gap-3",children:[x.jsx("h2",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:"Condicionantes LAO"}),x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx("button",{type:"button",onClick:()=>Z(!0),className:"rounded-lg bg-slate-600 px-3 py-2 text-sm font-semibold text-white hover:bg-slate-700",children:x.jsxs("span",{className:"inline-flex items-center gap-2",children:[x.jsx(RA,{}),"Importar Workbook"]})}),a&&x.jsx("button",{type:"button",onClick:tr,className:"rounded-lg bg-blue-600 px-4 py-2 text-sm font-semibold text-white hover:bg-blue-700",children:x.jsxs("span",{className:"inline-flex items-center gap-2",children:[x.jsx(El,{}),"Nova LAO"]})})]})]}),x.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-5",children:[x.jsxs("div",{className:"flex flex-col",children:[x.jsx("label",{className:"mb-1 text-xs font-semibold text-slate-700 dark:text-gray-200",children:"Ano"}),x.jsx("input",{type:"number",min:2e3,max:2100,value:E,onChange:se=>b(Number(se.target.value)||_),className:"rounded border border-slate-400 bg-white p-2 text-slate-900 placeholder:text-slate-500 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-900 dark:text-white"})]}),x.jsxs("div",{className:"flex flex-col",children:[x.jsx("label",{className:"mb-1 text-xs font-semibold text-slate-700 dark:text-gray-200",children:"Categoria"}),x.jsxs("select",{value:w,onChange:se=>S(se.target.value),className:"rounded border border-slate-400 bg-white p-2 text-slate-900 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-900 dark:text-white",children:[x.jsx("option",{value:"all",children:"Todas"}),x.jsx("option",{value:"Ambiental",children:"Ambiental"}),x.jsx("option",{value:"SGA",children:"SGA"})]})]}),x.jsxs("div",{className:"flex flex-col",children:[x.jsx("label",{className:"mb-1 text-xs font-semibold text-slate-700 dark:text-gray-200",children:"Filial"}),x.jsxs("select",{value:M,onChange:se=>j(se.target.value),className:"rounded border border-slate-400 bg-white p-2 text-slate-900 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-900 dark:text-white",children:[x.jsx("option",{value:"",children:"Todas"}),Rn.map(se=>x.jsx("option",{value:se.id,children:se.name},se.id))]})]}),x.jsxs("div",{className:"md:col-span-2 flex flex-col",children:[x.jsx("label",{className:"mb-1 text-xs font-semibold text-slate-700 dark:text-gray-200",children:"Busca (LAO ou condicionante)"}),x.jsx("input",{type:"text",value:F,onChange:se=>G(se.target.value),placeholder:"Digite para buscar...",className:"rounded border border-slate-400 bg-white p-2 text-slate-900 placeholder:text-slate-500 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-900 dark:text-white"})]})]})]}),x.jsx("div",{className:"rounded-xl bg-white p-6 shadow-lg dark:bg-gray-800",children:x.jsx("div",{className:"overflow-x-auto",children:x.jsxs("table",{className:"min-w-[1500px] table-fixed border-collapse bg-white dark:bg-gray-800",children:[x.jsx("thead",{children:x.jsxs("tr",{children:[x.jsx("th",{className:"w-72 border border-slate-500 bg-slate-700 px-3 py-2 text-left text-xs font-semibold uppercase tracking-wide !text-slate-50 dark:border-gray-600 dark:bg-gray-700 dark:!text-gray-100",children:"LAO"}),x.jsx("th",{className:"w-80 border border-slate-500 bg-slate-700 px-3 py-2 text-left text-xs font-semibold uppercase tracking-wide !text-slate-50 dark:border-gray-600 dark:bg-gray-700 dark:!text-gray-100",children:"Condicionante"}),x.jsx("th",{className:"w-44 border border-slate-500 bg-slate-700 px-3 py-2 text-left text-xs font-semibold uppercase tracking-wide !text-slate-50 dark:border-gray-600 dark:bg-gray-700 dark:!text-gray-100",children:"Frequncia"}),Lx.map(se=>x.jsx("th",{className:"w-24 border border-slate-500 bg-slate-700 px-2 py-2 text-center text-xs font-semibold uppercase tracking-wide !text-slate-50 dark:border-gray-600 dark:bg-gray-700 dark:!text-gray-100",children:se},se))]})}),x.jsxs("tbody",{children:[Dt.length===0&&x.jsx("tr",{children:x.jsx("td",{colSpan:15,className:"border border-slate-300 bg-white px-4 py-8 text-center text-sm text-slate-600 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-400",children:"Nenhuma LAO encontrada para os filtros selecionados."})}),Dt.map(se=>{var lt;const Ue=(ee.get(se.id)||[]).filter(st=>st.active),Qe=((lt=n.find(st=>st.id===se.branchId))==null?void 0:lt.name)||"-";return Ue.length===0?x.jsxs("tr",{children:[x.jsx("td",{className:"border border-slate-300 bg-white px-3 py-3 align-top dark:border-gray-700 dark:bg-gray-800",children:x.jsxs("div",{className:"space-y-2",children:[x.jsx("button",{type:"button",onClick:()=>fe(se),className:"text-left text-sm font-semibold text-blue-700 underline-offset-2 hover:underline dark:text-blue-300",title:"Abrir detalhes da LAO",children:se.laoNumber}),x.jsx("div",{className:"text-xs font-medium text-slate-800 dark:text-gray-200",children:se.empreendimento}),x.jsxs("div",{className:"text-xs text-slate-600 dark:text-gray-400",children:["Validade: ",ys(se.validityDate)," | Filial:"," ",Qe]}),a&&x.jsxs("div",{className:"flex gap-2",children:[x.jsx("button",{onClick:()=>Jt(se),className:"text-blue-600 hover:text-blue-800",title:"Editar LAO",children:x.jsx(To,{})}),x.jsx("button",{onClick:()=>Je(se.id),className:"text-green-600 hover:text-green-800",title:"Nova condicionante",children:x.jsx(El,{})}),x.jsx("button",{onClick:()=>ze(se.id),className:"text-red-600 hover:text-red-800",title:"Excluir LAO",children:x.jsx(Tl,{})})]})]})}),x.jsx("td",{colSpan:14,className:"border border-slate-300 bg-white px-3 py-3 text-sm text-slate-600 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-400",children:"Nenhuma condicionante cadastrada."})]},se.id):Ue.map((st,Fr)=>{const wn=_t.get(st.id)||[],Ur=!!st.lastInspectionDate,Ot=Db(st.frequencyPreset,st.customMonthsInterval),et=S0(st.lastInspectionDate||null),bt=S0(se.validityDate),Ht=et&&Ot?C1(et,Ot):null,Nt=!!Ht&&!!bt&&Ht.getTime()>bt.getTime();return x.jsxs("tr",{children:[Fr===0&&x.jsx("td",{rowSpan:Ue.length,className:"border border-slate-300 bg-white px-3 py-3 align-top dark:border-gray-700 dark:bg-gray-800",children:x.jsxs("div",{className:"space-y-2",children:[x.jsx("button",{type:"button",onClick:()=>fe(se),className:"text-left text-sm font-semibold text-blue-700 underline-offset-2 hover:underline dark:text-blue-300",title:"Abrir detalhes da LAO",children:se.laoNumber}),x.jsx("div",{className:"text-xs font-semibold text-slate-800 dark:text-gray-200",children:se.empreendimento}),x.jsx("div",{className:"text-xs text-slate-600 dark:text-gray-400",children:se.title}),x.jsxs("div",{className:"text-xs text-slate-600 dark:text-gray-400",children:["Emisso: ",ys(se.issueDate||"")||"-"]}),x.jsxs("div",{className:"text-xs text-slate-600 dark:text-gray-400",children:["Validade: ",ys(se.validityDate)]}),x.jsxs("div",{className:"text-xs text-slate-600 dark:text-gray-400",children:["Filial: ",Qe]}),a&&x.jsxs("div",{className:"flex gap-2",children:[x.jsx("button",{onClick:()=>Jt(se),className:"text-blue-600 hover:text-blue-800",title:"Editar LAO",children:x.jsx(To,{})}),x.jsx("button",{onClick:()=>Je(se.id),className:"text-green-600 hover:text-green-800",title:"Nova condicionante",children:x.jsx(El,{})}),x.jsx("button",{onClick:()=>ze(se.id),className:"text-red-600 hover:text-red-800",title:"Excluir LAO",children:x.jsx(Tl,{})})]})]})}),x.jsx("td",{className:"border border-slate-300 bg-white px-3 py-2 align-top dark:border-gray-700 dark:bg-gray-800",children:x.jsxs("div",{className:"flex items-start justify-between gap-2",children:[x.jsx("span",{className:"text-sm font-medium text-slate-900 dark:text-gray-100",children:st.name}),a&&x.jsxs("span",{className:"flex gap-2",children:[x.jsx("button",{onClick:()=>ft(st),className:"text-blue-600 hover:text-blue-800",title:"Editar condicionante",children:x.jsx(To,{})}),x.jsx("button",{onClick:()=>Xe(st.id),className:"text-red-600 hover:text-red-800",title:"Excluir condicionante",children:x.jsx(Tl,{})})]})]})}),x.jsxs("td",{className:"border border-slate-300 bg-white px-3 py-2 align-top dark:border-gray-700 dark:bg-gray-800",children:[x.jsx("div",{className:"text-sm font-medium text-slate-800 dark:text-gray-200",children:Fb(st)}),x.jsxs("div",{className:"mt-1 text-xs text-slate-600 dark:text-gray-400",children:["ltima vistoria:"," ",st.lastInspectionDate?ys(st.lastInspectionDate):"pendente"]}),!Ur&&x.jsx("div",{className:"mt-1 rounded bg-yellow-100 px-2 py-1 text-xs text-yellow-800",children:"Sem ltima vistoria"}),Ur&&Nt&&x.jsx("div",{className:"mt-1 rounded bg-amber-100 px-2 py-1 text-xs text-amber-800",children:"Sem previso: validade encerra antes da prxima vistoria"})]}),Lx.map((Ta,pr)=>{const L=Pt.get(Lb(st.id,pr,E))||[],K=wn.find(Y=>new Date(`${Y}T00:00:00`).getMonth()===pr)||null,H=L.length>0;let q="empty";H?q="done":K&&(q=mq(pr,E,fn)?"overdue":"planned");const Q=q==="done"?"bg-emerald-600 text-white":q==="planned"?"bg-sky-300 text-sky-950 dark:bg-blue-900/40 dark:text-blue-100":q==="overdue"?"bg-rose-300 text-rose-950 dark:bg-red-900/40 dark:text-red-100":"bg-white text-slate-500 dark:bg-gray-900 dark:text-gray-500";return x.jsx("td",{onClick:()=>ct(se,st,pr,K),className:`border border-slate-300 px-1 py-2 text-center text-xs font-semibold align-top dark:border-gray-700 ${a?"cursor-pointer hover:ring-1 hover:ring-blue-400":""} ${Q}`,title:a?"Clique para registrar vistoria":void 0,children:H?x.jsxs("div",{className:"space-y-1",children:[L.slice(0,2).map(Y=>x.jsx("div",{children:ys(Y.inspectionDate).slice(0,5)},Y.id)),L.length>2&&x.jsxs("div",{children:["+",L.length-2]})]}):K?x.jsx("span",{children:ys(K).slice(0,5)}):x.jsx("span",{children:"-"})},`${st.id}-${pr}`)})]},`${se.id}-${st.id}`)})})]})]})})}),nt&&x.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-4",children:x.jsxs("div",{className:"max-h-[90vh] w-full max-w-6xl overflow-y-auto rounded-xl bg-white p-6 shadow-xl dark:bg-gray-800",children:[x.jsxs("div",{className:"mb-5 flex flex-wrap items-start justify-between gap-3",children:[x.jsxs("div",{children:[x.jsxs("h3",{className:"text-xl font-bold text-slate-900 dark:text-white",children:[nt.lao.laoNumber," - ",nt.lao.empreendimento]}),x.jsxs("p",{className:"mt-1 text-sm text-slate-600 dark:text-gray-300",children:[nt.lao.title||"Sem ttulo"," | Filial: ",nt.branchName]})]}),x.jsx("button",{type:"button",onClick:()=>fe(null),className:"rounded bg-gray-200 px-3 py-2 text-sm text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-100 dark:hover:bg-gray-600",children:"Fechar"})]}),x.jsxs("div",{className:"mb-5 grid grid-cols-2 gap-3 md:grid-cols-5",children:[x.jsxs("div",{className:"rounded border border-slate-300 bg-slate-50 p-3 dark:border-gray-700 dark:bg-gray-900",children:[x.jsx("div",{className:"text-xs font-semibold uppercase text-slate-500 dark:text-gray-400",children:"Condicionantes"}),x.jsx("div",{className:"mt-1 text-xl font-bold text-slate-900 dark:text-white",children:nt.totalConditions})]}),x.jsxs("div",{className:"rounded border border-slate-300 bg-slate-50 p-3 dark:border-gray-700 dark:bg-gray-900",children:[x.jsx("div",{className:"text-xs font-semibold uppercase text-slate-500 dark:text-gray-400",children:"Vistorias totais"}),x.jsx("div",{className:"mt-1 text-xl font-bold text-slate-900 dark:text-white",children:nt.totalInspections})]}),x.jsxs("div",{className:"rounded border border-slate-300 bg-slate-50 p-3 dark:border-gray-700 dark:bg-gray-900",children:[x.jsxs("div",{className:"text-xs font-semibold uppercase text-slate-500 dark:text-gray-400",children:["Vistorias em ",E]}),x.jsx("div",{className:"mt-1 text-xl font-bold text-slate-900 dark:text-white",children:nt.totalThisYear})]}),x.jsxs("div",{className:"rounded border border-slate-300 bg-slate-50 p-3 dark:border-gray-700 dark:bg-gray-900",children:[x.jsx("div",{className:"text-xs font-semibold uppercase text-slate-500 dark:text-gray-400",children:"ltima vistoria geral"}),x.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900 dark:text-white",children:nt.latestInspection?ys(nt.latestInspection):"Sem registros"})]}),x.jsxs("div",{className:"rounded border border-slate-300 bg-slate-50 p-3 dark:border-gray-700 dark:bg-gray-900",children:[x.jsx("div",{className:"text-xs font-semibold uppercase text-slate-500 dark:text-gray-400",children:"Sem vistoria"}),x.jsx("div",{className:"mt-1 text-xl font-bold text-amber-700 dark:text-amber-300",children:nt.withoutInspectionCount})]})]}),x.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-2",children:[x.jsxs("div",{className:"rounded border border-slate-300 p-4 dark:border-gray-700",children:[x.jsx("h4",{className:"mb-3 font-semibold text-slate-900 dark:text-white",children:"Itens da LAO"}),nt.conditionSummary.length===0?x.jsx("p",{className:"text-sm text-slate-600 dark:text-gray-300",children:"Nenhuma condicionante cadastrada."}):x.jsx("div",{className:"overflow-x-auto",children:x.jsxs("table",{className:"w-full min-w-[520px] border-collapse",children:[x.jsx("thead",{children:x.jsxs("tr",{children:[x.jsx("th",{className:"border border-slate-300 bg-slate-100 px-2 py-1 text-left text-xs font-semibold uppercase text-slate-700 dark:border-gray-700 dark:bg-gray-700 dark:text-gray-100",children:"Item"}),x.jsx("th",{className:"border border-slate-300 bg-slate-100 px-2 py-1 text-left text-xs font-semibold uppercase text-slate-700 dark:border-gray-700 dark:bg-gray-700 dark:text-gray-100",children:"Frequncia"}),x.jsx("th",{className:"border border-slate-300 bg-slate-100 px-2 py-1 text-left text-xs font-semibold uppercase text-slate-700 dark:border-gray-700 dark:bg-gray-700 dark:text-gray-100",children:"ltima vistoria"}),x.jsx("th",{className:"border border-slate-300 bg-slate-100 px-2 py-1 text-center text-xs font-semibold uppercase text-slate-700 dark:border-gray-700 dark:bg-gray-700 dark:text-gray-100",children:"Total"})]})}),x.jsx("tbody",{children:nt.conditionSummary.map(se=>x.jsxs("tr",{children:[x.jsx("td",{className:"border border-slate-300 px-2 py-1 text-sm text-slate-900 dark:border-gray-700 dark:text-gray-100",children:se.condition.name}),x.jsx("td",{className:"border border-slate-300 px-2 py-1 text-sm text-slate-700 dark:border-gray-700 dark:text-gray-200",children:Fb(se.condition)}),x.jsx("td",{className:"border border-slate-300 px-2 py-1 text-sm text-slate-700 dark:border-gray-700 dark:text-gray-200",children:se.lastInspection?ys(se.lastInspection):"Sem vistoria"}),x.jsx("td",{className:"border border-slate-300 px-2 py-1 text-center text-sm font-semibold text-slate-800 dark:border-gray-700 dark:text-gray-100",children:se.inspectionsCount})]},se.condition.id))})]})})]}),x.jsxs("div",{className:"rounded border border-slate-300 p-4 dark:border-gray-700",children:[x.jsx("h4",{className:"mb-3 font-semibold text-slate-900 dark:text-white",children:"Resumo de vistorias"}),nt.recentInspections.length===0?x.jsx("p",{className:"text-sm text-slate-600 dark:text-gray-300",children:"Sem registros de vistoria."}):x.jsx("div",{className:"space-y-2",children:nt.recentInspections.map(se=>x.jsxs("div",{className:"rounded border border-slate-200 bg-slate-50 px-3 py-2 dark:border-gray-700 dark:bg-gray-900",children:[x.jsxs("div",{className:"text-sm font-semibold text-slate-900 dark:text-white",children:[ys(se.inspectionDate)," - ",se.conditionName]}),x.jsxs("div",{className:"text-xs text-slate-600 dark:text-gray-300",children:["Origem: ",se.source==="import"?"Importao":"Manual",se.note?` | Obs: ${se.note}`:""]})]},se.id))})]})]}),x.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 lg:grid-cols-2",children:[x.jsxs("div",{className:"rounded border border-slate-300 p-4 dark:border-gray-700",children:[x.jsx("h4",{className:"mb-3 font-semibold text-slate-900 dark:text-white",children:"Anexos"}),nt.attachments.length===0?x.jsx("p",{className:"text-sm text-slate-600 dark:text-gray-300",children:"Nenhum anexo cadastrado."}):x.jsx("div",{className:"space-y-2",children:nt.attachments.map(se=>x.jsx("a",{href:se.fileUrl,target:"_blank",rel:"noopener noreferrer",className:"block rounded border border-slate-200 bg-slate-50 px-3 py-2 text-sm text-blue-700 hover:underline dark:border-gray-700 dark:bg-gray-900 dark:text-blue-300",children:se.fileName},se.id))})]}),x.jsxs("div",{className:"rounded border border-slate-300 p-4 dark:border-gray-700",children:[x.jsx("h4",{className:"mb-3 font-semibold text-slate-900 dark:text-white",children:"Detalhes da LAO"}),(li=nt.lao.details)!=null&&li.length?x.jsx("div",{className:"space-y-2",children:[...nt.lao.details].sort((se,Ue)=>se.order-Ue.order).map(se=>x.jsxs("div",{className:"rounded border border-slate-200 bg-slate-50 px-3 py-2 dark:border-gray-700 dark:bg-gray-900",children:[x.jsx("div",{className:"text-xs font-semibold uppercase text-slate-500 dark:text-gray-400",children:se.key}),x.jsx("div",{className:"text-sm text-slate-900 dark:text-gray-100",children:se.value})]},se.id))}):x.jsx("p",{className:"text-sm text-slate-600 dark:text-gray-300",children:"Sem detalhes adicionais cadastrados."})]})]})]})}),W&&x.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-4",children:x.jsxs("div",{className:"max-h-[90vh] w-full max-w-4xl overflow-y-auto rounded-xl bg-white p-6 shadow-xl dark:bg-gray-800",children:[x.jsx("h3",{className:"mb-4 text-xl font-bold text-gray-800 dark:text-white",children:A?"Editar LAO":"Nova LAO"}),x.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[x.jsxs("div",{className:"flex flex-col",children:[x.jsx("label",{className:"mb-1 text-sm font-medium",children:"Nmero da LAO"}),x.jsx("input",{name:"laoNumber",value:Se.laoNumber,onChange:Ct,className:"rounded border border-gray-300 p-2 dark:border-gray-600 dark:bg-gray-900 dark:text-white"})]}),x.jsxs("div",{className:"flex flex-col md:col-span-2",children:[x.jsx("label",{className:"mb-1 text-sm font-medium",children:"Ttulo"}),x.jsx("input",{name:"title",value:Se.title,onChange:Ct,className:"rounded border border-gray-300 p-2 dark:border-gray-600 dark:bg-gray-900 dark:text-white"})]}),x.jsxs("div",{className:"flex flex-col md:col-span-2",children:[x.jsx("label",{className:"mb-1 text-sm font-medium",children:"Empreendimento"}),x.jsx("input",{name:"empreendimento",value:Se.empreendimento,onChange:Ct,className:"rounded border border-gray-300 p-2 dark:border-gray-600 dark:bg-gray-900 dark:text-white"})]}),x.jsxs("div",{className:"flex flex-col",children:[x.jsx("label",{className:"mb-1 text-sm font-medium",children:"Filial"}),x.jsxs("select",{name:"branchId",value:Se.branchId||"",onChange:Ct,className:"rounded border border-gray-300 p-2 dark:border-gray-600 dark:bg-gray-900 dark:text-white",children:[x.jsx("option",{value:"",children:"Sem vnculo"}),Rn.map(se=>x.jsx("option",{value:se.id,children:se.name},se.id))]})]}),x.jsxs("div",{className:"flex flex-col",children:[x.jsx("label",{className:"mb-1 text-sm font-medium",children:"Categoria"}),x.jsxs("select",{name:"category",value:Se.category,onChange:Ct,className:"rounded border border-gray-300 p-2 dark:border-gray-600 dark:bg-gray-900 dark:text-white",children:[x.jsx("option",{value:"Ambiental",children:"Ambiental"}),x.jsx("option",{value:"SGA",children:"SGA"})]})]}),x.jsxs("div",{className:"flex flex-col",children:[x.jsx("label",{className:"mb-1 text-sm font-medium",children:"Processo"}),x.jsx("input",{name:"processNumber",value:Se.processNumber,onChange:Ct,className:"rounded border border-gray-300 p-2 dark:border-gray-600 dark:bg-gray-900 dark:text-white"})]}),x.jsxs("div",{className:"flex flex-col",children:[x.jsx("label",{className:"mb-1 text-sm font-medium",children:"FCEI"}),x.jsx("input",{name:"fcei",value:Se.fcei,onChange:Ct,className:"rounded border border-gray-300 p-2 dark:border-gray-600 dark:bg-gray-900 dark:text-white"})]}),x.jsxs("div",{className:"flex flex-col",children:[x.jsx("label",{className:"mb-1 text-sm font-medium",children:"CODAM"}),x.jsx("input",{name:"codam",value:Se.codam,onChange:Ct,className:"rounded border border-gray-300 p-2 dark:border-gray-600 dark:bg-gray-900 dark:text-white"})]}),x.jsxs("div",{className:"flex flex-col",children:[x.jsx("label",{className:"mb-1 text-sm font-medium",children:"Emisso"}),x.jsx("input",{type:"date",name:"issueDate",value:Se.issueDate||"",onChange:Ct,className:"rounded border border-gray-300 p-2 dark:border-gray-600 dark:bg-gray-900 dark:text-white"})]}),x.jsxs("div",{className:"flex flex-col",children:[x.jsx("label",{className:"mb-1 text-sm font-medium",children:"Validade"}),x.jsx("input",{type:"date",name:"validityDate",value:Se.validityDate,onChange:Ct,className:"rounded border border-gray-300 p-2 dark:border-gray-600 dark:bg-gray-900 dark:text-white"})]}),x.jsxs("div",{className:"flex items-center gap-2 pt-6",children:[x.jsx("input",{id:"laoActive",type:"checkbox",name:"active",checked:Se.active,onChange:Ct}),x.jsx("label",{htmlFor:"laoActive",className:"text-sm font-medium",children:"LAO ativa"})]})]}),x.jsxs("div",{className:"mt-6 rounded border border-gray-200 p-4 dark:border-gray-700",children:[x.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[x.jsx("h4",{className:"font-semibold text-gray-800 dark:text-white",children:"Detalhes (chave/valor)"}),x.jsx("button",{type:"button",onClick:_n,className:"rounded bg-slate-600 px-3 py-1 text-sm text-white hover:bg-slate-700",children:"Adicionar detalhe"})]}),x.jsx("div",{className:"space-y-2",children:Se.details.map((se,Ue)=>x.jsxs("div",{className:"grid grid-cols-12 gap-2",children:[x.jsx("input",{value:se.key,onChange:Qe=>wr(Ue,"key",Qe.target.value),placeholder:"Campo",className:"col-span-4 rounded border border-gray-300 p-2 text-sm dark:border-gray-600 dark:bg-gray-900 dark:text-white"}),x.jsx("input",{value:se.value,onChange:Qe=>wr(Ue,"value",Qe.target.value),placeholder:"Valor",className:"col-span-6 rounded border border-gray-300 p-2 text-sm dark:border-gray-600 dark:bg-gray-900 dark:text-white"}),x.jsxs("div",{className:"col-span-2 flex items-center justify-end gap-1",children:[x.jsx("button",{type:"button",onClick:()=>mr(Ue,-1),className:"rounded bg-gray-200 px-2 py-1 text-xs hover:bg-gray-300",children:""}),x.jsx("button",{type:"button",onClick:()=>mr(Ue,1),className:"rounded bg-gray-200 px-2 py-1 text-xs hover:bg-gray-300",children:""}),x.jsx("button",{type:"button",onClick:()=>Dr(Ue),className:"rounded bg-red-100 px-2 py-1 text-xs text-red-700 hover:bg-red-200",children:""})]})]},se.id))})]}),x.jsxs("div",{className:"mt-6 rounded border border-gray-200 p-4 dark:border-gray-700",children:[x.jsx("h4",{className:"mb-3 font-semibold text-gray-800 dark:text-white",children:"Anexos"}),x.jsx("input",{type:"file",onChange:en,disabled:k,className:"mb-3 block w-full text-sm"}),k&&x.jsx("p",{className:"mb-3 text-sm text-blue-600",children:"Enviando anexo..."}),x.jsx("div",{className:"space-y-2",children:(Se.attachments||[]).map(se=>x.jsxs("div",{className:"flex items-center justify-between rounded border border-gray-200 px-3 py-2 dark:border-gray-700",children:[x.jsx("a",{href:se.fileUrl,target:"_blank",rel:"noopener noreferrer",className:"truncate text-sm text-blue-600 hover:underline",children:se.fileName}),x.jsx("button",{type:"button",onClick:()=>jt(se),className:"text-xs text-red-600 hover:text-red-800",children:"Remover"})]},se.id))})]}),x.jsxs("div",{className:"mt-6 flex justify-end gap-2",children:[x.jsx("button",{type:"button",onClick:()=>{B(!1),Ge()},className:"rounded bg-gray-300 px-4 py-2 text-sm text-gray-700 hover:bg-gray-400",children:"Cancelar"}),x.jsx("button",{type:"button",onClick:oe,className:"rounded bg-green-600 px-4 py-2 text-sm font-semibold text-white hover:bg-green-700",children:"Salvar LAO"})]})]})}),P&&x.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-4",children:x.jsxs("div",{className:"w-full max-w-xl rounded-xl bg-white p-6 shadow-xl dark:bg-gray-800",children:[x.jsx("h3",{className:"mb-4 text-xl font-bold text-gray-800 dark:text-white",children:R?"Editar Condicionante":"Nova Condicionante"}),x.jsxs("div",{className:"space-y-3",children:[x.jsxs("div",{className:"flex flex-col",children:[x.jsx("label",{className:"mb-1 text-sm font-medium",children:"LAO"}),x.jsxs("select",{name:"laoId",value:Ne.laoId,onChange:Ae,className:"rounded border border-gray-300 p-2 dark:border-gray-600 dark:bg-gray-900 dark:text-white",children:[x.jsx("option",{value:"",children:"Selecione..."}),t.map(se=>x.jsxs("option",{value:se.id,children:[se.laoNumber," - ",se.empreendimento]},se.id))]})]}),x.jsxs("div",{className:"flex flex-col",children:[x.jsx("label",{className:"mb-1 text-sm font-medium",children:"Condicionante"}),x.jsx("input",{name:"name",value:Ne.name,onChange:Ae,className:"rounded border border-gray-300 p-2 dark:border-gray-600 dark:bg-gray-900 dark:text-white"})]}),x.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[x.jsxs("div",{className:"flex flex-col",children:[x.jsx("label",{className:"mb-1 text-sm font-medium",children:"Frequncia"}),x.jsx("select",{name:"frequencyPreset",value:Ne.frequencyPreset,onChange:Ae,className:"rounded border border-gray-300 p-2 dark:border-gray-600 dark:bg-gray-900 dark:text-white",children:XC.map(se=>x.jsx("option",{value:se.value,children:se.label},se.value))})]}),Ne.frequencyPreset==="custom"&&x.jsxs("div",{className:"flex flex-col",children:[x.jsx("label",{className:"mb-1 text-sm font-medium",children:"Intervalo (meses)"}),x.jsx("input",{type:"number",name:"customMonthsInterval",min:1,value:Ne.customMonthsInterval||0,onChange:Ae,className:"rounded border border-gray-300 p-2 dark:border-gray-600 dark:bg-gray-900 dark:text-white"})]})]}),x.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[x.jsxs("div",{className:"flex flex-col",children:[x.jsx("label",{className:"mb-1 text-sm font-medium",children:"ltima vistoria"}),x.jsx("input",{type:"date",name:"lastInspectionDate",value:Ne.lastInspectionDate||"",onChange:Ae,className:"rounded border border-gray-300 p-2 dark:border-gray-600 dark:bg-gray-900 dark:text-white"})]}),x.jsxs("div",{className:"flex items-center gap-2 pt-7",children:[x.jsx("input",{id:"conditionActive",type:"checkbox",name:"active",checked:Ne.active,onChange:Ae}),x.jsx("label",{htmlFor:"conditionActive",className:"text-sm font-medium",children:"Condicionante ativa"})]})]}),x.jsxs("div",{className:"flex flex-col",children:[x.jsx("label",{className:"mb-1 text-sm font-medium",children:"Observaes"}),x.jsx("textarea",{name:"notes",value:Ne.notes||"",onChange:Ae,rows:3,className:"rounded border border-gray-300 p-2 dark:border-gray-600 dark:bg-gray-900 dark:text-white"})]})]}),x.jsxs("div",{className:"mt-6 flex justify-end gap-2",children:[x.jsx("button",{type:"button",onClick:()=>{N(!1),Ve()},className:"rounded bg-gray-300 px-4 py-2 text-sm text-gray-700 hover:bg-gray-400",children:"Cancelar"}),x.jsx("button",{type:"button",onClick:Me,className:"rounded bg-green-600 px-4 py-2 text-sm font-semibold text-white hover:bg-green-700",children:"Salvar condicionante"})]})]})}),xe&&x.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-4",children:x.jsxs("div",{className:"w-full max-w-md rounded-xl bg-white p-6 shadow-xl dark:bg-gray-800",children:[x.jsx("h3",{className:"mb-2 text-lg font-bold text-gray-800 dark:text-white",children:"Registrar vistoria"}),x.jsxs("p",{className:"mb-4 text-sm text-gray-600 dark:text-gray-300",children:[xe.lao.laoNumber,"  ",xe.condition.name," (",Lx[xe.monthIndex],"/",E,")"]}),x.jsxs("div",{className:"space-y-3",children:[x.jsxs("div",{className:"flex flex-col",children:[x.jsx("label",{className:"mb-1 text-sm font-medium",children:"Data da vistoria"}),x.jsx("input",{type:"date",value:le,onChange:se=>He(se.target.value),className:"rounded border border-gray-300 p-2 dark:border-gray-600 dark:bg-gray-900 dark:text-white"})]}),x.jsxs("div",{className:"flex flex-col",children:[x.jsx("label",{className:"mb-1 text-sm font-medium",children:"Observao"}),x.jsx("textarea",{value:ie,onChange:se=>J(se.target.value),rows:3,className:"rounded border border-gray-300 p-2 dark:border-gray-600 dark:bg-gray-900 dark:text-white"})]})]}),x.jsxs("div",{className:"mt-6 flex justify-end gap-2",children:[x.jsx("button",{type:"button",onClick:()=>ne(null),className:"rounded bg-gray-300 px-4 py-2 text-sm text-gray-700 hover:bg-gray-400",children:"Cancelar"}),x.jsx("button",{type:"button",disabled:ge,onClick:sr,className:"rounded bg-blue-600 px-4 py-2 text-sm font-semibold text-white hover:bg-blue-700 disabled:opacity-60",children:ge?"Salvando...":"Salvar vistoria"})]})]})}),x.jsx(_q,{open:X,onClose:()=>Z(!1),onImportParsed:Or})]})},Mb=({className:t="h-6 w-6"})=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})}),Eq=({className:t="h-6 w-6"})=>x.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"}),x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 5a2 2 0 012-2h4a2 2 0 012 2v6H8V5z"})]}),Tq=({className:t="h-6 w-6"})=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),bq="/licencas/assets/ambiental-C3pQG8id.svg",Sq=Rs(kr,"units"),Pb=Rs(kr,"licenses"),jb=Rs(kr,"licenseTypes"),Ub=Rs(kr,"branches"),Bb=Rs(kr,"laos"),Px=Rs(kr,"laoConditions"),zc=Rs(kr,"laoInspections"),yl=t=>Array.isArray(t)?t.map(e=>yl(e)):t&&typeof t=="object"&&!(t instanceof Date)?Object.fromEntries(Object.entries(t).filter(([,e])=>e!==void 0).map(([e,r])=>[e,yl(r)])):t,kq=()=>{var Ve,Je,ft;const[t,e]=je.useState("dashboard"),[r,n]=je.useState([]),[a,s]=je.useState([]),[l,u]=je.useState([]),[f,d]=je.useState([]),[m,y]=je.useState([]),[_,E]=je.useState([]),[b,w]=je.useState([]),[S,M]=je.useState(!0),[j,F]=je.useState(null),[G,W]=je.useState(null),[B,A]=je.useState(null),[D,k]=je.useState(!0),[O,P]=je.useState(!0),[N,R]=je.useState(()=>typeof window<"u"&&localStorage.getItem("theme")||"light");je.useEffect(()=>{typeof window>"u"||(N==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),localStorage.setItem("theme",N))},[N]);const he=()=>{R(Ae=>Ae==="light"?"dark":"light")},xe=je.useCallback(async()=>{const Me=(await la(Sq)).docs.map(Xe=>({...Xe.data(),id:Xe.id}));n(Me)},[]),ne=je.useCallback(async()=>{const Me=(await la(Pb)).docs.map(Xe=>{const ct=Xe.data();let sr=ct.attachments||[];return(ct.fileUrl||ct.fileName)&&sr.length===0&&ct.fileUrl&&(sr=[{id:Date.now().toString(),fileName:ct.fileName||"Arquivo",fileUrl:ct.fileUrl,uploadedAt:new Date().toISOString()}]),{...ct,id:Xe.id,attachments:sr}});s(Me)},[]),le=je.useCallback(async()=>{const Me=(await la(jb)).docs.map(Xe=>({...Xe.data(),id:Xe.id}));u(Me)},[]),He=je.useCallback(async()=>{const Me=(await la(Ub)).docs.map(Xe=>({...Xe.data(),id:Xe.id}));d(Me)},[]),ie=je.useCallback(async()=>{const Me=(await la(Bb)).docs.map(Xe=>({...Xe.data(),id:Xe.id}));y(Me)},[]),J=je.useCallback(async()=>{const Me=(await la(Px)).docs.map(Xe=>({...Xe.data(),id:Xe.id}));E(Me)},[]),ge=je.useCallback(async()=>{const Me=(await la(zc)).docs.map(Xe=>({...Xe.data(),id:Xe.id}));w(Me)},[]);if(je.useEffect(()=>{(async()=>{M(!0);try{await Promise.all([xe(),ne(),le(),He(),ie(),J(),ge()])}catch(Me){console.error("Failed to fetch data from Firebase:",Me)}finally{M(!1)}})()},[xe,ne,le,He,ie,J,ge]),je.useEffect(()=>{const Ae=AF(Mf,Me=>{F(Me),k(!1)});return()=>Ae()},[]),je.useEffect(()=>{(async()=>{var Me,Xe;if(j){const ct=Rs(kr,"users"),sr=Pc(ct,jc("uid","==",j.uid)),Or=await la(sr);if(Or.empty)if((await la(ct)).empty){const Rn=await so(ct,{uid:j.uid,name:j.displayName||((Me=j.email)==null?void 0:Me.split("@")[0])||"Admin",email:j.email,role:"admin",active:!0,allowedScreens:["dashboard","licenses","sgaLicenses","deactivatedLicenses","licenseTypes","branches","laoConditions","users"],visibleBranchIds:[],visibleLicenseTypes:[],createdAt:new Date().toISOString()});W("admin"),A({id:Rn.id,uid:j.uid,name:j.displayName||((Xe=j.email)==null?void 0:Xe.split("@")[0])||"Admin",email:j.email,role:"admin",active:!0,allowedScreens:["dashboard","licenses","sgaLicenses","deactivatedLicenses","licenseTypes","branches","laoConditions","users"]})}else W("colaborador"),A({id:"",uid:j.uid,name:j.displayName||"",email:j.email||"",role:"colaborador",active:!0,allowedScreens:["dashboard"]});else{const fn=Or.docs[0].data();A({id:Or.docs[0].id,...fn}),W(fn.role)}}else W(null)})()},[j]),D)return x.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:x.jsxs("div",{className:"text-center",children:[x.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-blue-600 mx-auto"}),x.jsx("p",{className:"mt-4 text-xl font-semibold text-gray-700",children:"Verificando autenticao..."})]})});if(!j)return x.jsx(lq,{onLogin:()=>F(Mf.currentUser)});const V=async Ae=>{const Me={...Ae,attachments:Ae.attachments||[]};await so(Pb,Me),await ne()},X=async Ae=>{const{id:Me,...Xe}=Ae,ct={...Xe,attachments:Xe.attachments||[]},sr=ca(kr,"licenses",Me);await oo(sr,ct),await ne()},Z=async Ae=>{const Me=ca(kr,"licenses",Ae);await jd(Me),await ne()},te=async Ae=>{const Me={...Ae,renewalProtocolDays:Number(Ae.renewalProtocolDays)||0,processStartDays:Number(Ae.processStartDays)||0};await so(jb,Me),await le()},fe=async Ae=>{const{id:Me,...Xe}=Ae,ct={...Xe,renewalProtocolDays:Number(Xe.renewalProtocolDays)||0,processStartDays:Number(Xe.processStartDays)||0},sr=ca(kr,"licenseTypes",Me);await oo(sr,ct),await le()},Se=async Ae=>{const Me=ca(kr,"licenseTypes",Ae);await jd(Me),await le()},ke=async Ae=>{const Me=await so(Ub,Ae);return await He(),Me.id},Ne=async Ae=>{const{id:Me,...Xe}=Ae,ct=ca(kr,"branches",Me);await oo(ct,{...Xe}),await He()},Oe=async Ae=>{const Me=ca(kr,"branches",Ae);await jd(Me),await He()},ot=async Ae=>{const Me=await so(Bb,yl(Ae));return await ie(),Me.id},ee=async Ae=>{const{id:Me,...Xe}=Ae,ct=ca(kr,"laos",Me);await oo(ct,yl({...Xe})),await ie()},Pt=async Ae=>{const Me=YE(kr),Xe=ca(kr,"laos",Ae);Me.delete(Xe);const ct=Pc(Px,jc("laoId","==",Ae));(await la(ct)).forEach(Rn=>{Me.delete(Rn.ref)});const Or=Pc(zc,jc("laoId","==",Ae));(await la(Or)).forEach(Rn=>{Me.delete(Rn.ref)}),await Me.commit(),await Promise.all([ie(),J(),ge()])},_t=async Ae=>{const Me=yl(Ae);Ae.frequencyPreset!=="custom"?delete Me.customMonthsInterval:Me.customMonthsInterval=Number(Ae.customMonthsInterval||0);const Xe=await so(Px,Me);return await J(),Xe.id},Dt=async Ae=>{const{id:Me,...Xe}=Ae,ct=ca(kr,"laoConditions",Me),sr=yl({...Xe});Xe.frequencyPreset!=="custom"?sr.customMonthsInterval=SO():sr.customMonthsInterval=Number(Xe.customMonthsInterval||0),await oo(ct,sr),await J()},nt=async Ae=>{const Me=YE(kr),Xe=ca(kr,"laoConditions",Ae);Me.delete(Xe);const ct=Pc(zc,jc("conditionId","==",Ae));(await la(ct)).forEach(Or=>{Me.delete(Or.ref)}),await Me.commit(),await Promise.all([J(),ge()])},Ge=async Ae=>{const Me=Pc(zc,jc("conditionId","==",Ae)),Xe=await la(Me);let ct=null;Xe.forEach(Or=>{const fn=Or.data().inspectionDate;fn&&(!ct||fn>ct)&&(ct=fn)});const sr=ca(kr,"laoConditions",Ae);await oo(sr,{lastInspectionDate:ct,updatedAt:new Date().toISOString()})},tr=async Ae=>{const Me=Pc(zc,jc("conditionId","==",Ae.conditionId));if((await la(Me)).docs.some(Or=>Or.data().inspectionDate===Ae.inspectionDate))return null;const sr=await so(zc,yl(Ae));return await Ge(Ae.conditionId),await Promise.all([ge(),J()]),sr.id},Jt=({icon:Ae,label:Me,active:Xe,onClick:ct})=>x.jsxs("li",{onClick:ct,className:"flex items-center cursor-pointer p-3 rounded-lg transition-colors duration-200 mb-1 hover:bg-slate-700",style:Xe?{backgroundColor:"#3b82f6",color:"#ffffff"}:{color:"#94a3b8"},children:[x.jsx("div",{className:"mr-3",style:Xe?{color:"#ffffff"}:{color:"#94a3b8"},children:Ae}),x.jsx("span",{className:"whitespace-nowrap",children:Me})]}),Ct=Ae=>{var Me;return G==="admin"?!0:!!((Me=B==null?void 0:B.allowedScreens)!=null&&Me.includes(Ae))};if(S)return x.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:x.jsxs("div",{className:"text-center",children:[x.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-blue-600 mx-auto"}),x.jsx("p",{className:"mt-4 text-xl font-semibold text-gray-700",children:"Carregando dados..."})]})});const wr=G==="admin"||!B?a:a.filter(Ae=>{const Me=!(B!=null&&B.visibleBranchIds)||B.visibleBranchIds.length===0||B.visibleBranchIds.includes(Ae.unitId),Xe=!(B!=null&&B.visibleLicenseTypes)||B.visibleLicenseTypes.length===0||B.visibleLicenseTypes.includes(Ae.licenseType);return Me&&Xe}),_n=G==="admin"||!B?f:f.filter(Ae=>!(B!=null&&B.visibleBranchIds)||B.visibleBranchIds.length===0||B.visibleBranchIds.includes(Ae.id)),Dr=G==="admin"||!B?l:l.filter(Ae=>!(B!=null&&B.visibleLicenseTypes)||B.visibleLicenseTypes.length===0||B.visibleLicenseTypes.includes(Ae.name)),mr=G==="admin"||!B?m:m.filter(Ae=>Ae.branchId?!(B!=null&&B.visibleBranchIds)||B.visibleBranchIds.length===0?!0:B.visibleBranchIds.includes(Ae.branchId):!1),en=new Set(mr.map(Ae=>Ae.id)),jt=_.filter(Ae=>en.has(Ae.laoId)),oe=new Set(jt.map(Ae=>Ae.id)),ze=b.filter(Ae=>oe.has(Ae.conditionId));return x.jsxs("div",{className:`flex min-h-screen bg-gray-100 text-gray-800 ${N==="dark"?"dark bg-gray-900 text-gray-100":""}`,children:[x.jsx("button",{onClick:()=>P(!O),className:"fixed top-1/2 -translate-y-1/2 p-1.5 rounded-full bg-slate-600 hover:bg-slate-500 transition-all duration-300 text-white shadow-lg z-30",style:{left:O?"240px":"8px"},"aria-label":O?"Recolher sidebar":"Expandir sidebar",children:x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 12h16M4 18h16"})})}),x.jsx("aside",{className:`${O?"w-64":"w-0"} flex flex-col sticky top-0 h-screen shrink-0 z-20 transition-all duration-300 overflow-hidden`,style:{backgroundColor:"#1e293b"},children:x.jsxs("div",{className:`${O?"opacity-100":"opacity-0"} flex flex-col h-full transition-opacity duration-200`,children:[x.jsx("div",{className:"h-32 flex items-center justify-center shrink-0 p-4 border-b border-slate-700/50",children:x.jsx("img",{src:bq,alt:"Logo Ambiental",className:"max-h-full max-w-full object-contain"})}),x.jsx("nav",{className:"flex-1 py-4 overflow-hidden",children:x.jsxs("ul",{className:"px-3 space-y-1",children:[Ct("dashboard")&&x.jsx(Jt,{icon:x.jsx(Eq,{}),label:"Dashboard",active:t==="dashboard",onClick:()=>e("dashboard")}),Ct("licenses")&&x.jsx(Jt,{icon:x.jsx(S1,{}),label:"Licenas Vigentes",active:t==="licenses",onClick:()=>e("licenses")}),Ct("sgaLicenses")&&x.jsx(Jt,{icon:x.jsx(S1,{}),label:"Licenas SGA",active:t==="sgaLicenses",onClick:()=>e("sgaLicenses")}),Ct("deactivatedLicenses")&&x.jsx(Jt,{icon:x.jsx(k1,{}),label:"Licenas Vencidas",active:t==="deactivatedLicenses",onClick:()=>e("deactivatedLicenses")}),Ct("licenseTypes")&&x.jsx(Jt,{icon:x.jsx(Mb,{}),label:"Tipos de Licena",active:t==="licenseTypes",onClick:()=>e("licenseTypes")}),Ct("branches")&&x.jsx(Jt,{icon:x.jsx(HC,{}),label:"Filiais",active:t==="branches",onClick:()=>e("branches")}),Ct("laoConditions")&&x.jsx(Jt,{icon:x.jsx(Mb,{}),label:"Condicionantes LAO",active:t==="laoConditions",onClick:()=>e("laoConditions")}),Ct("users")&&x.jsx(Jt,{icon:x.jsx(Tq,{}),label:"Usurios",active:t==="users",onClick:()=>e("users")})]})}),x.jsx("div",{className:"p-4 shrink-0",children:x.jsxs("div",{className:"flex items-center p-2 rounded-lg cursor-pointer transition-colors hover:bg-slate-700",onClick:()=>f1(Mf),title:"Clique para sair",children:[x.jsx("div",{className:"h-10 w-10 rounded-full bg-blue-500 flex items-center justify-center text-white font-bold text-lg shrink-0",children:((Ve=B==null?void 0:B.name)==null?void 0:Ve.charAt(0).toUpperCase())||((Je=j==null?void 0:j.email)==null?void 0:Je.charAt(0).toUpperCase())}),x.jsxs("div",{className:"ml-3 overflow-hidden",children:[x.jsx("p",{className:"text-white font-medium text-sm truncate",children:(B==null?void 0:B.name)||((ft=j==null?void 0:j.email)==null?void 0:ft.split("@")[0])}),x.jsx("p",{className:"text-slate-400 text-xs truncate",children:j==null?void 0:j.email})]})]})})]})}),x.jsxs("div",{className:"flex-1 flex flex-col min-h-screen min-w-0",children:[x.jsxs("header",{className:"h-14 flex items-center justify-between px-6 sticky top-0 z-10",style:{backgroundColor:"#1e293b"},children:[x.jsx("div",{className:"flex items-center gap-4 min-w-[200px]"}),x.jsx("h1",{className:"text-lg font-semibold text-white",children:"Gesto de Licenas Ambientais"}),x.jsxs("div",{className:"flex items-center gap-2 min-w-[200px] justify-end",children:[x.jsx("button",{onClick:he,className:"p-2 rounded-lg hover:bg-slate-700 transition-colors text-white","aria-label":"Alternar tema",children:N==="dark"?x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}):x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})})}),x.jsx("button",{onClick:()=>f1(Mf),className:"px-4 py-1.5 bg-red-500 hover:bg-red-600 text-white text-sm font-medium rounded-lg transition-colors",children:"Sair"})]})]}),x.jsx("main",{className:"flex-1 p-6 lg:p-8 overflow-x-hidden",children:x.jsxs("div",{className:"w-full",children:[t==="dashboard"&&x.jsx(cq,{licenses:wr,branches:f,licenseTypes:l}),t==="licenses"&&x.jsx(Ib,{licenses:wr,branches:_n,licenseTypes:Dr,onAddLicense:V,onUpdateLicense:X,onDeleteLicense:Z,onAddBranch:ke,category:"Ambiental"}),t==="sgaLicenses"&&x.jsx(Ib,{licenses:wr,branches:_n,licenseTypes:Dr,onAddLicense:V,onUpdateLicense:X,onDeleteLicense:Z,onAddBranch:ke,category:"SGA"}),t==="deactivatedLicenses"&&x.jsx(sq,{licenses:wr.filter(Ae=>!Ae.active),branches:_n,licenseTypes:Dr,onUpdateLicense:X}),t==="licenseTypes"&&x.jsx(aq,{licenseTypes:l,onAddLicenseType:te,onUpdateLicenseType:fe,onDeleteLicenseType:Se}),t==="branches"&&x.jsx(iq,{branches:f,onAddBranch:ke,onUpdateBranch:Ne,onDeleteBranch:Oe}),t==="laoConditions"&&x.jsx(wq,{laos:mr,conditions:jt,inspections:ze,branches:_n,canEdit:Ct("laoConditions"),onAddLao:ot,onUpdateLao:ee,onDeleteLao:Pt,onAddCondition:_t,onUpdateCondition:Dt,onDeleteCondition:nt,onAddInspection:tr}),t==="users"&&x.jsx(uq,{branches:f,licenseTypes:l})]})}),x.jsx("footer",{className:"text-center text-gray-500 py-6 text-sm border-t border-gray-200 dark:border-gray-800 mt-auto bg-white dark:bg-gray-800",children:x.jsxs("p",{children:[" ",new Date().getFullYear()," Gesto Ambiental. Todos os direitos reservados."]})})]})]})},$C=document.getElementById("root");if(!$C)throw new Error("Could not find root element to mount to");const Aq=N3.createRoot($C);Aq.render(x.jsx(zb.StrictMode,{children:x.jsx(kq,{})}));
